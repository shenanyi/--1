define("adapter-min.js", function(require, module, exports){
var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

!function i(a, c, u) {
  function s(t, e) {
    if (!c[t]) {
      if (!a[t]) {
        var n = "function" == typeof require && require;if (!e && n) return n(t, !0);if (l) return l(t, !0);var r = new Error("Cannot find module '" + t + "'");throw r.code = "MODULE_NOT_FOUND", r;
      }var o = c[t] = { exports: {} };a[t][0].call(o.exports, function (e) {
        return s(a[t][1][e] || e);
      }, o, o.exports, i, a, c, u);
    }return c[t].exports;
  }for (var l = "function" == typeof require && require, e = 0; e < u.length; e++) {
    s(u[e]);
  }return s;
}({ 1: [function (e, t, n) {}, {}], 2: [function (e, t, n) {
    "use strict";
    var r = window.fsUtils,
        o = r.getUserDataPath,
        i = r.readJsonSync,
        c = r.makeDirSync,
        a = r.writeFileSync,
        s = r.copyFile,
        l = r.downloadFile,
        u = r.writeFile,
        f = r.deleteFile,
        d = r.rmdirSync,
        p = r.unzip,
        h = !1,
        m = null,
        g = !1,
        y = [],
        v = [],
        b = !1,
        w = /the maximum size of the file storage/,
        _ = 0,
        E = /^https?:\/\/.*/,
        x = { cacheDir: "gamecaches", cachedFileName: "cacheList.json", cacheEnabled: !0, autoClear: !0, cacheInterval: 500, deleteInterval: 500, writeFileInterval: 2e3, outOfStorage: !1, tempFiles: null, cachedFiles: null, cacheQueue: {}, version: "1.0", getCache: function getCache(e) {
        return this.cachedFiles.has(e) ? this.cachedFiles.get(e).url : "";
      }, getTemp: function getTemp(e) {
        return this.tempFiles.has(e) ? this.tempFiles.get(e) : "";
      }, init: function init() {
        this.cacheDir = o() + "/" + this.cacheDir;var e = this.cacheDir + "/" + this.cachedFileName,
            t = i(e);t instanceof Error || !t.version ? (t instanceof Error || d(this.cacheDir, !0), this.cachedFiles = new cc.AssetManager.Cache(), c(this.cacheDir, !0), a(e, JSON.stringify({ files: this.cachedFiles._map, version: this.version }), "utf8")) : this.cachedFiles = new cc.AssetManager.Cache(t.files), this.tempFiles = new cc.AssetManager.Cache();
      }, updateLastTime: function updateLastTime(e) {
        this.cachedFiles.has(e) && (this.cachedFiles.get(e).lastTime = Date.now());
      }, _write: function _write() {
        g = !(m = null), u(this.cacheDir + "/" + this.cachedFileName, JSON.stringify({ files: this.cachedFiles._map, version: this.version }), "utf8", function () {
          g = !1;for (var e = 0, t = v.length; e < t; e++) {
            v[e]();
          }v.length = 0, v.push.apply(v, y), y.length = 0;
        });
      }, writeCacheFile: function writeCacheFile(e) {
        m ? e && v.push(e) : (m = setTimeout(this._write.bind(this), this.writeFileInterval), !0 === g ? e && y.push(e) : e && v.push(e));
      }, _cache: function _cache() {
        var t = this;for (var n in this.cacheQueue) {
          var e = function e(_e) {
            if (h = !1, _e) {
              if (w.test(_e.message)) return t.outOfStorage = !0, void (t.autoClear && t.clearLRU());
            } else t.cachedFiles.add(n, { bundle: a, url: u, lastTime: c }), delete t.cacheQueue[n], t.writeCacheFile();cc.js.isEmptyObject(t.cacheQueue) || (h = !0, setTimeout(t._cache.bind(t), t.cacheInterval));
          },
              r = this.cacheQueue[n],
              o = r.srcUrl,
              i = r.isCopy,
              a = r.cacheBundleRoot,
              c = Date.now().toString(),
              u = "",
              u = a ? "".concat(this.cacheDir, "/").concat(a, "/").concat(c).concat(_++).concat(cc.path.extname(n)) : "".concat(this.cacheDir, "/").concat(c).concat(_++).concat(cc.path.extname(n));return void (i ? s(o, u, e) : l(o, u, null, e));
        }h = !1;
      }, cacheFile: function cacheFile(e, t, n, r, o) {
        !(n = void 0 !== n ? n : this.cacheEnabled) || this.cacheQueue[e] || this.cachedFiles.has(e) || (this.cacheQueue[e] = { srcUrl: t, cacheBundleRoot: r, isCopy: o }, h || (h = !0, this.outOfStorage ? h = !1 : setTimeout(this._cache.bind(this), this.cacheInterval)));
      }, clearCache: function clearCache() {
        var t = this;d(this.cacheDir, !0), this.cachedFiles = new cc.AssetManager.Cache(), c(this.cacheDir, !0);var e = this.cacheDir + "/" + this.cachedFileName;this.outOfStorage = !1, a(e, JSON.stringify({ files: this.cachedFiles._map, version: this.version }), "utf8"), cc.assetManager.bundles.forEach(function (e) {
          E.test(e.base) && t.makeBundleFolder(e.name);
        });
      }, clearLRU: function clearLRU() {
        if (!b) {
          b = !0;var n = [],
              r = this;if (this.cachedFiles.forEach(function (e, t) {
            "internal" !== e.bundle && (r._isZipFile(t) && cc.assetManager.bundles.has(e.bundle) || n.push({ originUrl: t, url: e.url, lastTime: e.lastTime }));
          }), n.sort(function (e, t) {
            return e.lastTime - t.lastTime;
          }), n.length = Math.floor(this.cachedFiles.count / 3), 0 !== n.length) {
            for (var e = 0, t = n.length; e < t; e++) {
              this.cachedFiles.remove(n[e].originUrl);
            }this.writeCacheFile(function () {
              setTimeout(function e() {
                var t = n.pop();r._isZipFile(t.originUrl) ? (d(t.url, !0), r._deleteFileCB()) : f(t.url, r._deleteFileCB.bind(r)), 0 < n.length ? setTimeout(e, r.deleteInterval) : b = !1;
              }, r.deleteInterval);
            });
          }
        }
      }, removeCache: function removeCache(e) {
        var t, n;this.cachedFiles.has(e) && (n = (t = this).cachedFiles.remove(e).url, this.writeCacheFile(function () {
          t._isZipFile(e) ? (d(n, !0), t._deleteFileCB()) : f(n, t._deleteFileCB.bind(t));
        }));
      }, _deleteFileCB: function _deleteFileCB(e) {
        e || (this.outOfStorage = !1);
      }, makeBundleFolder: function makeBundleFolder(e) {
        c(this.cacheDir + "/" + e, !0);
      }, unzipAndCacheBundle: function unzipAndCacheBundle(t, e, n, r) {
        var o = Date.now().toString(),
            i = "".concat(this.cacheDir, "/").concat(n, "/").concat(o).concat(_++),
            a = this;c(i, !0), p(e, i, function (e) {
          return e ? (d(i, !0), void (r && r(e))) : (a.cachedFiles.add(t, { bundle: n, url: i, lastTime: o }), a.writeCacheFile(), void (r && r(null, i)));
        });
      }, _isZipFile: function _isZipFile(e) {
        return ".zip" === e.slice(-4);
      } };cc.assetManager.cacheManager = t.exports = x;
  }, {}], 3: [function (e, t, n) {
    "use strict";
    var o,
        i,
        f = e("../cache-manager"),
        r = window.fsUtils,
        d = r.fs,
        p = r.downloadFile,
        a = r.readText,
        c = r.readArrayBuffer,
        u = r.readJson,
        h = r.loadSubpackage,
        m = r.getUserDataPath,
        g = /^https?:\/\/.*/,
        s = cc.assetManager.downloader,
        l = cc.assetManager.parser,
        y = cc.assetManager.presets,
        v = __globalAdapter.isSubContext;s.maxConcurrency = 8, s.maxRequestsPerFrame = 64, y.scene.maxConcurrency = 10, y.scene.maxRequestsPerFrame = 64;var b = {},
        w = {};function _(e, t, n) {
      "function" == typeof t && (n = t, t = null), g.test(e) ? n && n(new Error("Can not load remote scripts")) : (__cocos_require__(e), n && n(null));
    }function E(e, t, n) {
      "function" == typeof t && (n = t, t = null);var r = document.createElement("audio");r.src = e, n && n(null, r);
    }function x(r, t, o, e, i) {
      var n = F(r, o);n.inLocal ? t(n.url, o, i) : n.inCache ? (f.updateLastTime(r), t(n.url, o, function (e, t) {
        e && f.removeCache(r), i(e, t);
      })) : p(r, null, o.header, e, function (e, n) {
        e ? i(e, null) : t(n, o, function (e, t) {
          e || (f.tempFiles.add(r, n), f.cacheFile(r, n, o.cacheEnabled, o.__cacheBundleRoot__, !0)), i(e, t);
        });
      });
    }function S(e, t, n) {
      c(e, n);
    }function T(e, t, n) {
      a(e, n);
    }function N(e, t, n) {
      u(e, n);
    }var O = v ? function (e, t, n) {
      e = (e = F(e, t).url).slice(o.length + 1);var r = __cocos_require__(cc.path.changeExtname(e, ".js"));n && n(null, r);
    } : function (e, t, n) {
      x(e, N, t, t.onFileProgress, n);
    },
        M = v ? function (e, t, n) {
      n(null, "Arial");
    } : function (e, t, n) {
      n(null, __globalAdapter.loadFont(e) || "Arial");
    };function C(e, t, n) {
      n(null, e);
    }function A(e, t, n) {
      x(e, C, t, t.onFileProgress, n);
    }function D(e, n, r) {
      c(e, function (e, t) {
        return e ? r(e) : void I(t, n, r);
      });
    }function P(e, n, r) {
      c(e, function (e, t) {
        return e ? r(e) : void R(t, n, r);
      });
    }var I = l.parsePVRTex,
        R = l.parsePKMTex;var j = v ? function (e, t, n) {
      n(null, e = F(e, t).url);
    } : A;s.downloadDomAudio = E, s.downloadScript = _, l.parsePVRTex = D, l.parsePKMTex = P, s.register({ ".js": _, ".mp3": A, ".ogg": A, ".wav": A, ".m4a": A, ".png": j, ".jpg": j, ".bmp": j, ".jpeg": j, ".gif": j, ".ico": j, ".tiff": j, ".image": j, ".webp": j, ".pvr": A, ".pkm": A, ".font": A, ".eot": A, ".ttf": A, ".woff": A, ".svg": A, ".ttc": A, ".txt": A, ".xml": A, ".vsh": A, ".fsh": A, ".atlas": A, ".tmx": A, ".tsx": A, ".plist": A, ".fnt": A, ".json": O, ".ExportJson": A, ".binary": A, ".bin": A, ".dbbin": A, ".skel": A, ".mp4": A, ".avi": A, ".mov": A, ".mpg": A, ".mpeg": A, ".rm": A, ".rmvb": A, bundle: function bundle(e, u, s) {
        var t,
            l,
            n,
            r = cc.path.basename(e),
            o = u.version || cc.assetManager.downloader.bundleVers[r];b[r] ? (n = "subpackages/".concat(r, "/config.").concat(o ? o + "." : "", "json"), h(r, u.onFileProgress, function (e) {
          e ? s(e, null) : O(n, u, function (e, t) {
            t && (t.base = "subpackages/".concat(r, "/")), s(e, t);
          });
        })) : (g.test(e) || !v && e.startsWith(m()) ? (l = e, t = "src/scripts/".concat(r, "/index.js"), f.makeBundleFolder(r)) : w[r] ? (l = "".concat(i, "remote/").concat(r), t = "src/scripts/".concat(r, "/index.js"), f.makeBundleFolder(r)) : (l = "assets/".concat(r), t = "assets/".concat(r, "/index.js")), __cocos_require__(t), u.__cacheBundleRoot__ = r, n = "".concat(l, "/config.").concat(o ? o + "." : "", "json"), O(n, u, function (e, o) {
          var t, n, r, i, a, c;e ? s && s(e) : o.isZip ? (t = o.zipVersion, n = "".concat(l, "/res.").concat(t ? t + "." : "", "zip"), r = n, i = u, a = function a(e, t) {
            var n, r;e ? s && s(e) : (o.base = t + "/res/", (n = cc.sys).platform === n.ALIPAY_GAME && n.os === n.OS_ANDROID && (r = t + "res/", d.accessSync({ path: r }) && (o.base = r)), s && s(null, o));
          }, (c = f.cachedFiles.get(r)) ? (f.updateLastTime(r), a && a(null, c.url)) : g.test(r) ? p(r, null, i.header, i.onFileProgress, function (e, t) {
            e ? a && a(e) : f.unzipAndCacheBundle(r, t, i.__cacheBundleRoot__, a);
          }) : f.unzipAndCacheBundle(r, r, i.__cacheBundleRoot__, a)) : (o.base = l + "/", s && s(null, o));
        }));
      }, default: function _default(e, t, n) {
        x(e, T, t, t.onFileProgress, n);
      } }), l.register({ ".png": s.downloadDomImage, ".jpg": s.downloadDomImage, ".bmp": s.downloadDomImage, ".jpeg": s.downloadDomImage, ".gif": s.downloadDomImage, ".ico": s.downloadDomImage, ".tiff": s.downloadDomImage, ".image": s.downloadDomImage, ".webp": s.downloadDomImage, ".pvr": D, ".pkm": P, ".font": M, ".eot": M, ".ttf": M, ".woff": M, ".svg": M, ".ttc": M, ".mp3": E, ".ogg": E, ".wav": E, ".m4a": E, ".txt": T, ".xml": T, ".vsh": T, ".fsh": T, ".atlas": T, ".tmx": T, ".tsx": T, ".fnt": T, ".plist": function plist(e, t, r) {
        a(e, function (e, t) {
          var n = null;e || (n = cc.plistParser.parse(t)) || (e = new Error("parse failed")), r && r(e, n);
        });
      }, ".binary": S, ".bin": S, ".dbbin": S, ".skel": S, ".ExportJson": N });var L,
        F = v ? function (e, t) {
      return g.test(e) || (e = o + "/" + e), { url: e };
    } : function (e, t) {
      var n,
          r,
          o = !1,
          i = !1;return !e.startsWith(m()) && g.test(e) ? t.reload || ((n = f.cachedFiles.get(e)) ? (i = !0, e = n.url) : (r = f.tempFiles.get(e)) && (o = !0, e = r)) : o = !0, { url: e, inLocal: o, inCache: i };
    };v ? (L = cc.assetManager.init, cc.assetManager.init = function (e) {
      L.call(cc.assetManager, e), o = e.subContextRoot || "";
    }) : (cc.assetManager.transformPipeline.append(function (e) {
      for (var t = e.output = e.input, n = 0, r = t.length; n < r; n++) {
        var o = t[n],
            i = o.options;if (o.config) i.__cacheBundleRoot__ = o.config.name;else {
          if ("bundle" === o.ext) continue;i.cacheEnabled = void 0 !== i.cacheEnabled && i.cacheEnabled;
        }
      }
    }), L = cc.assetManager.init, cc.assetManager.init = function (e) {
      L.call(cc.assetManager, e), e.subpackages && e.subpackages.forEach(function (e) {
        return b[e] = "subpackages/" + e;
      }), e.remoteBundles && e.remoteBundles.forEach(function (e) {
        return w[e] = !0;
      }), (i = e.server || "") && !i.endsWith("/") && (i += "/"), f.init();
    });
  }, { "../cache-manager": 2 }], 4: [function (e, t, n) {
    "use strict";
    var r,
        o = cc._Audio;o && (r = o.prototype.getDuration, Object.assign(o.prototype, { _createElement: function _createElement() {
        var e = this._src._nativeAsset;this._element || (this._element = __globalAdapter.createInnerAudioContext()), this._element.src = e.src;
      }, destroy: function destroy() {
        this._element && (this._element.destroy(), this._element = null);
      }, setCurrentTime: function setCurrentTime(e) {
        var t = this;this._src && this._src._ensureLoaded(function () {
          t._element.seek(e);
        });
      }, stop: function stop() {
        var e = this;this._src && this._src._ensureLoaded(function () {
          e._element.seek(0), e._element.stop(), e._unbindEnded(), e.emit("stop"), e._state = o.State.STOPPED;
        });
      }, _bindEnded: function _bindEnded() {
        var e = this._element;e && e.onEnded && e.onEnded(this._onended);
      }, _unbindEnded: function _unbindEnded() {
        var e = this._element;e && e.offEnded && e.offEnded();
      }, getDuration: function getDuration() {
        return r.call(this) || (this._element ? this._element.duration : 0);
      }, _touchToPlay: function _touchToPlay() {}, _forceUpdatingState: function _forceUpdatingState() {} }));
  }, {}], 5: [function (e, t, n) {
    "use strict";
    cc && cc.audioEngine && (cc.audioEngine._maxAudioInstance = 10);
  }, {}], 6: [function (e, t, n) {
    "use strict";
    var r = cc.internal.inputManager,
        o = window.__globalAdapter;Object.assign(r, { setAccelerometerEnabled: function setAccelerometerEnabled(e) {
        var t = cc.director.getScheduler();t.enableForTarget(this), e ? (this._registerAccelerometerEvent(), t.scheduleUpdate(this)) : (this._unregisterAccelerometerEvent(), t.unscheduleUpdate(this));
      }, _registerAccelerometerEvent: function _registerAccelerometerEvent() {
        this._accelCurTime = 0;var t = this;this._acceleration = new cc.Acceleration(), o.startAccelerometer(function (e) {
          t._acceleration.x = e.x, t._acceleration.y = e.y, t._acceleration.z = e.y;
        });
      }, _unregisterAccelerometerEvent: function _unregisterAccelerometerEvent() {
        this._accelCurTime = 0, o.stopAccelerometer();
      } });
  }, {}], 7: [function (e, t, n) {
    "use strict";
    function r() {
      s.call(this), this._eventListeners = { onKeyboardInput: null, onKeyboardConfirm: null, onKeyboardComplete: null };
    }var o, i, a, c, u, s;cc && cc.EditBox && (o = cc.EditBox, i = cc.js, a = o.KeyboardReturnType, u = c = null, s = o._ImplClass, i.extend(r, s), o._ImplClass = r, Object.assign(r.prototype, { init: function init(e) {
        e ? this._delegate = e : cc.error("EditBox init failed");
      }, beginEditing: function beginEditing() {
        var t = this;this._editing || this._ensureKeyboardHide(function () {
          var e = t._delegate;t._showKeyboard(), t._registerKeyboardEvent(), t._editing = !0, u = t, e.editBoxEditingDidBegan();
        });
      }, endEditing: function endEditing() {
        this._hideKeyboard();var e = this._eventListeners;e.onKeyboardComplete && e.onKeyboardComplete();
      }, _registerKeyboardEvent: function _registerKeyboardEvent() {
        var n = this,
            r = this._delegate,
            e = this._eventListeners;e.onKeyboardInput = function (e) {
          r._string !== e.value && r.editBoxTextChanged(e.value);
        }, e.onKeyboardConfirm = function (e) {
          r.editBoxEditingReturn();var t = n._eventListeners;t.onKeyboardComplete && t.onKeyboardComplete();
        }, e.onKeyboardComplete = function () {
          n._editing = !1, u = null, n._unregisterKeyboardEvent(), r.editBoxEditingDidEnded();
        }, __globalAdapter.onKeyboardInput(e.onKeyboardInput), __globalAdapter.onKeyboardConfirm(e.onKeyboardConfirm), __globalAdapter.onKeyboardComplete(e.onKeyboardComplete);
      }, _unregisterKeyboardEvent: function _unregisterKeyboardEvent() {
        var e = this._eventListeners;e.onKeyboardInput && (__globalAdapter.offKeyboardInput(e.onKeyboardInput), e.onKeyboardInput = null), e.onKeyboardConfirm && (__globalAdapter.offKeyboardConfirm(e.onKeyboardConfirm), e.onKeyboardConfirm = null), e.onKeyboardComplete && (__globalAdapter.offKeyboardComplete(e.onKeyboardComplete), e.onKeyboardComplete = null);
      }, _otherEditing: function _otherEditing() {
        return !!u && u !== this && u._editing;
      }, _ensureKeyboardHide: function _ensureKeyboardHide(e) {
        var t = this._otherEditing();if (!t && !c) return e();c && clearTimeout(c), t && u.endEditing(), c = setTimeout(function () {
          c = null, e();
        }, 600);
      }, _showKeyboard: function _showKeyboard() {
        var e = this._delegate,
            t = e.inputMode === o.InputMode.ANY,
            n = e.maxLength < 0 ? 65535 : e.maxLength;__globalAdapter.showKeyboard({ defaultValue: e._string, maxLength: n, multiple: t, confirmHold: !1, confirmType: function (e) {
            switch (e) {case a.DEFAULT:case a.DONE:
                return "done";case a.SEND:
                return "send";case a.SEARCH:
                return "search";case a.GO:
                return "go";case a.NEXT:
                return "next";}return "done";
          }(e.returnType), success: function success() {}, fail: function fail(e) {
            cc.warn(e.errMsg);
          } });
      }, _hideKeyboard: function _hideKeyboard() {
        __globalAdapter.hideKeyboard({ success: function success() {}, fail: function fail(e) {
            cc.warn(e.errMsg);
          } });
      } }));
  }, {}], 8: [function (e, t, n) {
    "use strict";
    var r = cc.internal.inputManager,
        o = cc.renderer,
        i = cc.game,
        a = cc.dynamicAtlasManager,
        c = i.run;Object.assign(i, { _banRunningMainLoop: __globalAdapter.isSubContext, _firstSceneLaunched: !1, run: function run() {
        var e = this;cc.director.once(cc.Director.EVENT_AFTER_SCENE_LAUNCH, function () {
          e._firstSceneLaunched = !0;
        }), c.apply(this, arguments);
      }, setFrameRate: function setFrameRate(e) {
        this.config.frameRate = e, __globalAdapter.setPreferredFramesPerSecond ? __globalAdapter.setPreferredFramesPerSecond(e) : (this._intervalId && window.cancelAnimFrame(this._intervalId), this._intervalId = 0, this._paused = !0, this._setAnimFrame(), this._runMainLoop());
      }, _runMainLoop: function _runMainLoop() {
        var e, _t, n, r, o, i;this._banRunningMainLoop || (n = (e = this).config, r = cc.director, o = !0, i = n.frameRate, cc.debug.setDisplayStats(n.showFPS), _t = function t() {
          if (!e._paused) {
            if (e._intervalId = window.requestAnimFrame(_t), 30 === i && !__globalAdapter.setPreferredFramesPerSecond && (o = !o)) return;r.mainLoop();
          }
        }, e._intervalId = window.requestAnimFrame(_t), e._paused = !1);
      }, _initRenderer: function _initRenderer() {
        var e, t;this._rendererInitialized || (this.frame = this.container = document.createElement("DIV"), e = __globalAdapter.isSubContext ? window.sharedCanvas || __globalAdapter.getSharedCanvas() : canvas, this.canvas = e, this._determineRenderType(), this.renderType === this.RENDER_TYPE_WEBGL && (t = { stencil: !0, antialias: cc.macro.ENABLE_WEBGL_ANTIALIAS, alpha: cc.macro.ENABLE_TRANSPARENT_CANVAS, preserveDrawingBuffer: !1 }, o.initWebGL(e, t), this._renderContext = o.device._gl, !cc.macro.CLEANUP_IMAGE_CACHE && a && (a.enabled = !0)), this._renderContext || (this.renderType = this.RENDER_TYPE_CANVAS, o.initCanvas(e), this._renderContext = o.device._ctx), this._rendererInitialized = !0);
      }, _initEvents: function _initEvents() {
        this.config.registerSystemEvent && r.registerSystemEvent(this.canvas);var t = !1;function e() {
          t || (t = !0, i.emit(i.EVENT_HIDE));
        }function n(e) {
          t && (t = !1, i.emit(i.EVENT_SHOW, e));
        }__globalAdapter.onAudioInterruptionEnd && __globalAdapter.onAudioInterruptionEnd(n), __globalAdapter.onAudioInterruptionBegin && __globalAdapter.onAudioInterruptionBegin(e), __globalAdapter.onShow && __globalAdapter.onShow(n), __globalAdapter.onHide && __globalAdapter.onHide(e), this.on(i.EVENT_HIDE, function () {
          i.pause();
        }), this.on(i.EVENT_SHOW, function () {
          i.resume();
        });
      }, end: function end() {} });
  }, {}], 9: [function (e, t, n) {
    "use strict";
    var r = cc.internal.inputManager,
        o = { left: 0, top: 0, width: window.innerWidth, height: window.innerHeight };r && Object.assign(r, { _updateCanvasBoundingRect: function _updateCanvasBoundingRect() {}, registerSystemEvent: function registerSystemEvent() {
        if (!this._isRegisterEvent) {
          this._glView = cc.view;var n = this,
              r = { onTouchStart: this.handleTouchesBegin, onTouchMove: this.handleTouchesMove, onTouchEnd: this.handleTouchesEnd, onTouchCancel: this.handleTouchesCancel };for (var e in r) {
            !function (e) {
              var t = r[e];__globalAdapter[e](function (e) {
                e.changedTouches && t.call(n, n.getTouchesByEvent(e, o));
              });
            }(e);
          }this._isRegisterEvent = !0;
        }
      } });
  }, {}], 10: [function (e, t, n) {
    "use strict";
    Object.assign(cc.screen, { autoFullScreen: function autoFullScreen() {} });
  }, {}], 11: [function (e, t, n) {
    "use strict";
    var r = cc.Texture2D;r && Object.assign(r.prototype, { initWithElement: function initWithElement(e) {
        e && (this._image = e, this.handleLoadedTexture());
      } });
  }, {}], 12: [function (e, t, n) {
    "use strict";
    t.exports = function (e, t) {
      t = t || __globalAdapter.getSystemInfoSync(), e.isNative = !1, e.isBrowser = !1, e.isMobile = !0, e.language = t.language.substr(0, 2), e.languageCode = t.language.toLowerCase();var n = t.system.toLowerCase(),
          r = t.platform;"android" === (r = r.toLowerCase()) ? e.os = e.OS_ANDROID : "ios" === r && (e.os = e.OS_IOS), "android p" === n && (n = "android p 9.0");var o = /[\d\.]+/.exec(n);e.osVersion = o ? o[0] : n, e.osMainVersion = parseInt(e.osVersion), e.browserType = null, e.browserVersion = null;var i = t.windowWidth,
          a = t.windowHeight,
          c = t.pixelRatio || 1;e.windowPixelResolution = { width: c * i, height: c * a }, e.localStorage = window.localStorage;var u = !__globalAdapter.isSubContext,
          s = !1;try {
        s = document.createElement("canvas").toDataURL("image/webp").startsWith("data:image/webp");
      } catch (e) {}e.capabilities = { canvas: !0, opengl: !!u, webp: s }, e.__audioSupport = { ONLY_ONE: !1, WEB_AUDIO: !1, DELAY_CREATE_CTX: !1, format: [".mp3"] };
    };
  }, {}], 13: [function (e, t, n) {
    "use strict";
    t.exports = function (e) {
      e._setupContainer = function (e, t, n) {
        var r,
            o = e._devicePixelRatio = 1;e.isRetinaEnabled() && (o = e._devicePixelRatio = Math.min(e._maxPixelRatio, window.devicePixelRatio || 1)), __globalAdapter.isSubContext || (t *= o, n *= o, (r = cc.game.canvas).width === t && r.height === n || (r.width = t, r.height = n));
      };
    };
  }, {}], 14: [function (e, t, n) {
    "use strict";
    t.exports = function (e) {
      Object.assign(e, { _adjustViewportMeta: function _adjustViewportMeta() {}, setRealPixelResolution: function setRealPixelResolution(e, t, n) {
          this.setDesignResolutionSize(e, t, n);
        }, enableAutoFullScreen: function enableAutoFullScreen() {
          cc.warn("cc.view.enableAutoFullScreen() is not supported on minigame platform.");
        }, isAutoFullScreenEnabled: function isAutoFullScreenEnabled() {
          return !1;
        }, setCanvasSize: function setCanvasSize() {
          cc.warn("cc.view.setCanvasSize() is not supported on minigame platform.");
        }, setFrameSize: function setFrameSize() {
          cc.warn("frame size is readonly on minigame platform.");
        }, _initFrameSize: function _initFrameSize() {
          var e,
              t = this._frameSize;__globalAdapter.isSubContext ? (e = window.sharedCanvas || __globalAdapter.getSharedCanvas(), t.width = e.width, t.height = e.height) : (t.width = window.innerWidth, t.height = window.innerHeight);
        } });
    };
  }, {}], 15: [function (e, t, n) {
    "use strict";
    var r = window.__globalAdapter;Object.assign(r, { adaptSys: e("./BaseSystemInfo"), adaptView: e("./View"), adaptContainerStrategy: e("./ContainerStrategy") });
  }, { "./BaseSystemInfo": 12, "./ContainerStrategy": 13, "./View": 14 }], 16: [function (e, t, n) {
    "use strict";
    e("./Audio"), e("./AudioEngine"), e("./DeviceMotionEvent"), e("./Editbox"), e("./Game"), e("./InputManager"), e("./AssetManager"), e("./Screen"), e("./Texture2D"), e("./misc");
  }, { "./AssetManager": 3, "./Audio": 4, "./AudioEngine": 5, "./DeviceMotionEvent": 6, "./Editbox": 7, "./Game": 8, "./InputManager": 9, "./Screen": 10, "./Texture2D": 11, "./misc": 17 }], 17: [function (e, t, n) {
    "use strict";
    cc.macro.DOWNLOAD_MAX_CONCURRENT = 10;
  }, {}], 18: [function (e, t, n) {
    "use strict";
    t.exports = { cloneMethod: function cloneMethod(e, t, n, r) {
        t[n] && (e[r = r || n] = t[n].bind(t));
      } };
  }, {}], 19: [function (e, t, n) {
    "use strict";
    function r(e) {
      this.options = e || { locator: {} };
    }function l() {
      this.cdata = !1;
    }function f(e, t) {
      t.lineNumber = e.lineNumber, t.columnNumber = e.columnNumber;
    }function d(e) {
      if (e) return "\n@" + (e.systemId || "") + "#[line:" + e.lineNumber + ",col:" + e.columnNumber + "]";
    }function o(e, t, n) {
      return "string" == typeof e ? e.substr(t, n) : e.length >= t + n || t ? new java.lang.String(e, t, n) + "" : e;
    }function p(e, t) {
      e.currentElement ? e.currentElement.appendChild(t) : e.doc.appendChild(t);
    }r.prototype.parseFromString = function (e, t) {
      var n = this.options,
          r = new m(),
          o = n.domBuilder || new l(),
          i = n.errorHandler,
          a = n.locator,
          c = n.xmlns || {},
          u = /\/x?html?$/.test(t),
          s = u ? h.entityMap : { lt: "<", gt: ">", amp: "&", quot: '"', apos: "'" };return a && o.setDocumentLocator(a), r.errorHandler = function (r, e, o) {
        if (!r) {
          if (e instanceof l) return e;r = e;
        }var i = {},
            a = r instanceof Function;function t(t) {
          var n = r[t];!n && a && (n = 2 == r.length ? function (e) {
            r(t, e);
          } : r), i[t] = n ? function (e) {
            n("[xmldom " + t + "]\t" + e + d(o));
          } : function () {};
        }return o = o || {}, t("warning"), t("error"), t("fatalError"), i;
      }(i, o, a), r.domBuilder = n.domBuilder || o, u && (c[""] = "http://www.w3.org/1999/xhtml"), c.xml = c.xml || "http://www.w3.org/XML/1998/namespace", e ? r.parse(e, c, s) : r.errorHandler.error("invalid doc source"), o.doc;
    }, l.prototype = { startDocument: function startDocument() {
        this.doc = new i().createDocument(null, null, null), this.locator && (this.doc.documentURI = this.locator.systemId);
      }, startElement: function startElement(e, t, n, r) {
        var o = this.doc,
            i = o.createElementNS(e, n || t),
            a = r.length;p(this, i), this.currentElement = i, this.locator && f(this.locator, i);for (var c = 0; c < a; c++) {
          var e = r.getURI(c),
              u = r.getValue(c),
              n = r.getQName(c),
              s = o.createAttributeNS(e, n);this.locator && f(r.getLocator(c), s), s.value = s.nodeValue = u, i.setAttributeNode(s);
        }
      }, endElement: function endElement() {
        var e = this.currentElement;e.tagName;this.currentElement = e.parentNode;
      }, startPrefixMapping: function startPrefixMapping() {}, endPrefixMapping: function endPrefixMapping() {}, processingInstruction: function processingInstruction(e, t) {
        var n = this.doc.createProcessingInstruction(e, t);this.locator && f(this.locator, n), p(this, n);
      }, ignorableWhitespace: function ignorableWhitespace() {}, characters: function characters(e, t, n) {
        var r;(e = o.apply(this, arguments)) && (r = this.cdata ? this.doc.createCDATASection(e) : this.doc.createTextNode(e), this.currentElement ? this.currentElement.appendChild(r) : /^\s*$/.test(e) && this.doc.appendChild(r), this.locator && f(this.locator, r));
      }, skippedEntity: function skippedEntity() {}, endDocument: function endDocument() {
        this.doc.normalize();
      }, setDocumentLocator: function setDocumentLocator(e) {
        (this.locator = e) && (e.lineNumber = 0);
      }, comment: function comment(e, t, n) {
        e = o.apply(this, arguments);var r = this.doc.createComment(e);this.locator && f(this.locator, r), p(this, r);
      }, startCDATA: function startCDATA() {
        this.cdata = !0;
      }, endCDATA: function endCDATA() {
        this.cdata = !1;
      }, startDTD: function startDTD(e, t, n) {
        var r,
            o = this.doc.implementation;o && o.createDocumentType && (r = o.createDocumentType(e, t, n), this.locator && f(this.locator, r), p(this, r));
      }, warning: function warning(e) {
        console.warn("[xmldom warning]\t" + e, d(this.locator));
      }, error: function error(e) {
        console.error("[xmldom error]\t" + e, d(this.locator));
      }, fatalError: function fatalError(e) {
        throw console.error("[xmldom fatalError]\t" + e, d(this.locator)), e;
      } }, "endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g, function (e) {
      l.prototype[e] = function () {
        return null;
      };
    });var h = e("./entities"),
        m = e("./sax").XMLReader,
        i = n.DOMImplementation = e("./dom").DOMImplementation;n.XMLSerializer = e("./dom").XMLSerializer, n.DOMParser = r;
  }, { "./dom": 20, "./entities": 21, "./sax": 22 }], 20: [function (e, t, n) {
    "use strict";
    function d(e) {
      return (d = "function" == typeof Symbol && "symbol" == _typeof(Symbol.iterator) ? function (e) {
        return typeof e === "undefined" ? "undefined" : _typeof(e);
      } : function (e) {
        return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e === "undefined" ? "undefined" : _typeof(e);
      })(e);
    }function r(e, t) {
      for (var n in e) {
        t[n] = e[n];
      }
    }function o(e, t) {
      var n = e.prototype;if (!(n instanceof t)) {
        var r = function r() {};for (var o in r.prototype = t.prototype, r = new r(), n) {
          r[o] = n[o];
        }e.prototype = n = r;
      }n.constructor != e && ("function" != typeof e && console.error("unknow Class:" + e), n.constructor = e);
    }var y = "http://www.w3.org/1999/xhtml",
        i = {},
        v = i.ELEMENT_NODE = 1,
        b = i.ATTRIBUTE_NODE = 2,
        w = i.TEXT_NODE = 3,
        _ = i.CDATA_SECTION_NODE = 4,
        E = i.ENTITY_REFERENCE_NODE = 5,
        x = (i.ENTITY_NODE = 6, i.PROCESSING_INSTRUCTION_NODE = 7),
        S = i.COMMENT_NODE = 8,
        T = i.DOCUMENT_NODE = 9,
        N = i.DOCUMENT_TYPE_NODE = 10,
        O = i.DOCUMENT_FRAGMENT_NODE = 11,
        a = (i.NOTATION_NODE = 12, {}),
        c = {};a.INDEX_SIZE_ERR = (c[1] = "Index size error", 1), a.DOMSTRING_SIZE_ERR = (c[2] = "DOMString size error", 2), a.HIERARCHY_REQUEST_ERR = (c[3] = "Hierarchy request error", 3), a.WRONG_DOCUMENT_ERR = (c[4] = "Wrong document", 4), a.INVALID_CHARACTER_ERR = (c[5] = "Invalid character", 5), a.NO_DATA_ALLOWED_ERR = (c[6] = "No data allowed", 6), a.NO_MODIFICATION_ALLOWED_ERR = (c[7] = "No modification allowed", 7), a.NOT_FOUND_ERR = (c[8] = "Not found", 8), a.NOT_SUPPORTED_ERR = (c[9] = "Not supported", 9), a.INUSE_ATTRIBUTE_ERR = (c[10] = "Attribute in use", 10), a.INVALID_STATE_ERR = (c[11] = "Invalid state", 11), a.SYNTAX_ERR = (c[12] = "Syntax error", 12), a.INVALID_MODIFICATION_ERR = (c[13] = "Invalid modification", 13), a.NAMESPACE_ERR = (c[14] = "Invalid namespace", 14), a.INVALID_ACCESS_ERR = (c[15] = "Invalid access", 15);function u(e, t) {
      var n;return t instanceof Error ? n = t : (n = this, Error.call(this, c[e]), this.message = c[e], Error.captureStackTrace && Error.captureStackTrace(this, u)), n.code = e, t && (this.message = this.message + ": " + t), n;
    }function p() {}function s(e, t) {
      this._node = e, this._refresh = t, l(this);
    }function l(e) {
      var t = e._node._inc || e._node.ownerDocument._inc;if (e._inc != t) {
        var n = e._refresh(e._node);for (var r in Z(e, "length", n.length), n) {
          e[r] = n[r];
        }e._inc = t;
      }
    }function h() {}function f(e, t) {
      for (var n = e.length; n--;) {
        if (e[n] === t) return n;
      }
    }function m(e, t, n, r) {
      var o, i, a, c;r ? t[f(t, r)] = n : t[t.length++] = n, !e || (o = (n.ownerElement = e).ownerDocument) && (r && I(o, e, r), a = e, c = n, (i = o) && i._inc++, "http://www.w3.org/2000/xmlns/" == c.namespaceURI && (a._nsMap[c.prefix ? c.localName : ""] = c.value));
    }function g(e, t, n) {
      var r = f(t, n);if (!(0 <= r)) throw u(8, new Error(e.tagName + "@" + n));for (var o, i = t.length - 1; r < i;) {
        t[r] = t[++r];
      }t.length = i, !e || (o = e.ownerDocument) && (I(o, e, n), n.ownerElement = null);
    }function M(e) {
      if (this._features = {}, e) for (var t in e) {
        this._features = e[t];
      }
    }function C() {}function A(e) {
      return ("<" == e ? "&lt;" : ">" == e && "&gt;") || "&" == e && "&amp;" || '"' == e && "&quot;" || "&#" + e.charCodeAt() + ";";
    }function D(e, t) {
      if (t(e)) return 1;if (e = e.firstChild) do {
        if (D(e, t)) return 1;
      } while (e = e.nextSibling);
    }function P() {}function I(e, t, n) {
      e && e._inc++, "http://www.w3.org/2000/xmlns/" == n.namespaceURI && delete t._nsMap[n.prefix ? n.localName : ""];
    }function R(e, t, n) {
      if (e && e._inc) {
        e._inc++;var r = t.childNodes;if (n) r[r.length++] = n;else {
          for (var o = t.firstChild, i = 0; o;) {
            o = (r[i++] = o).nextSibling;
          }r.length = i;
        }
      }
    }function j(e, t) {
      var n = t.previousSibling,
          r = t.nextSibling;return n ? n.nextSibling = r : e.firstChild = r, r ? r.previousSibling = n : e.lastChild = n, R(e.ownerDocument, e), t;
    }function L(e, t, n) {
      var r = t.parentNode;if (r && r.removeChild(t), t.nodeType === O) {
        var o = t.firstChild;if (null == o) return t;var i = t.lastChild;
      } else o = i = t;var a = n ? n.previousSibling : e.lastChild;for (o.previousSibling = a, i.nextSibling = n, a ? a.nextSibling = o : e.firstChild = o, null == n ? e.lastChild = i : n.previousSibling = i; o.parentNode = e, o !== i && (o = o.nextSibling);) {}return R(e.ownerDocument || e, e), t.nodeType == O && (t.firstChild = t.lastChild = null), t;
    }function F() {
      this._nsMap = {};
    }function k() {}function H() {}function B() {}function U() {}function W() {}function V() {}function K() {}function G() {}function q() {}function z() {}function $() {}function X() {}function Y(e, t) {
      var n,
          r = [],
          o = 9 == this.nodeType && this.documentElement || this,
          i = o.prefix,
          a = o.namespaceURI;return a && null == i && null == (i = o.lookupPrefix(a)) && (n = [{ namespace: a, prefix: null }]), Q(this, r, e, t, n), r.join("");
    }function J(e, t, n) {
      var r = e.prefix || "",
          o = e.namespaceURI;if ((r || o) && ("xml" !== r || "http://www.w3.org/XML/1998/namespace" !== o) && "http://www.w3.org/2000/xmlns/" != o) {
        for (var i = n.length; i--;) {
          var a = n[i];if (a.prefix == r) return a.namespace != o;
        }return 1;
      }
    }function Q(e, t, n, r, o) {
      if (r) {
        if (!(e = r(e))) return;if ("string" == typeof e) return void t.push(e);
      }switch (e.nodeType) {case v:
          o = o || [];var i = e.attributes,
              a = i.length,
              c = e.firstChild,
              u = e.tagName;n = y === e.namespaceURI || n, t.push("<", u);for (var s = 0; s < a; s++) {
            "xmlns" == (l = i.item(s)).prefix ? o.push({ prefix: l.localName, namespace: l.value }) : "xmlns" == l.nodeName && o.push({ prefix: "", namespace: l.value });
          }for (var l, f, d, p, s = 0; s < a; s++) {
            J(l = i.item(s), 0, o) && (f = l.prefix || "", d = l.namespaceURI, p = f ? " xmlns:" + f : " xmlns", t.push(p, '="', d, '"'), o.push({ prefix: f, namespace: d })), Q(l, t, n, r, o);
          }if (J(e, 0, o) && (f = e.prefix || "", d = e.namespaceURI, p = f ? " xmlns:" + f : " xmlns", t.push(p, '="', d, '"'), o.push({ prefix: f, namespace: d })), c || n && !/^(?:meta|link|img|br|hr|input)$/i.test(u)) {
            if (t.push(">"), n && /^script$/i.test(u)) for (; c;) {
              c.data ? t.push(c.data) : Q(c, t, n, r, o), c = c.nextSibling;
            } else for (; c;) {
              Q(c, t, n, r, o), c = c.nextSibling;
            }t.push("</", u, ">");
          } else t.push("/>");return;case T:case O:
          for (c = e.firstChild; c;) {
            Q(c, t, n, r, o), c = c.nextSibling;
          }return;case b:
          return t.push(" ", e.name, '="', e.value.replace(/[<&"]/g, A), '"');case w:
          return t.push(e.data.replace(/[<&]/g, A));case _:
          return t.push("<![CDATA[", e.data, "]]>");case S:
          return t.push("\x3c!--", e.data, "--\x3e");case N:
          var h,
              m = e.publicId,
              g = e.systemId;return t.push("<!DOCTYPE ", e.name), void (m ? (t.push(' PUBLIC "', m), g && "." != g && t.push('" "', g), t.push('">')) : g && "." != g ? t.push(' SYSTEM "', g, '">') : ((h = e.internalSubset) && t.push(" [", h, "]"), t.push(">")));case x:
          return t.push("<?", e.target, " ", e.data, "?>");case E:
          return t.push("&", e.nodeName, ";");default:
          t.push("??", e.nodeName);}
    }function Z(e, t, n) {
      e[t] = n;
    }u.prototype = Error.prototype, r(a, u), p.prototype = { length: 0, item: function item(e) {
        return this[e] || null;
      }, toString: function toString(e, t) {
        for (var n = [], r = 0; r < this.length; r++) {
          Q(this[r], n, e, t);
        }return n.join("");
      } }, s.prototype.item = function (e) {
      return l(this), this[e];
    }, o(s, p), h.prototype = { length: 0, item: p.prototype.item, getNamedItem: function getNamedItem(e) {
        for (var t = this.length; t--;) {
          var n = this[t];if (n.nodeName == e) return n;
        }
      }, setNamedItem: function setNamedItem(e) {
        var t = e.ownerElement;if (t && t != this._ownerElement) throw new u(10);var n = this.getNamedItem(e.nodeName);return m(this._ownerElement, this, e, n), n;
      }, setNamedItemNS: function setNamedItemNS(e) {
        var t,
            n = e.ownerElement;if (n && n != this._ownerElement) throw new u(10);return t = this.getNamedItemNS(e.namespaceURI, e.localName), m(this._ownerElement, this, e, t), t;
      }, removeNamedItem: function removeNamedItem(e) {
        var t = this.getNamedItem(e);return g(this._ownerElement, this, t), t;
      }, removeNamedItemNS: function removeNamedItemNS(e, t) {
        var n = this.getNamedItemNS(e, t);return g(this._ownerElement, this, n), n;
      }, getNamedItemNS: function getNamedItemNS(e, t) {
        for (var n = this.length; n--;) {
          var r = this[n];if (r.localName == t && r.namespaceURI == e) return r;
        }return null;
      } }, M.prototype = { hasFeature: function hasFeature(e, t) {
        var n = this._features[e.toLowerCase()];return !(!n || t && !(t in n));
      }, createDocument: function createDocument(e, t, n) {
        var r,
            o = new P();return o.implementation = this, o.childNodes = new p(), (o.doctype = n) && o.appendChild(n), t && (r = o.createElementNS(e, t), o.appendChild(r)), o;
      }, createDocumentType: function createDocumentType(e, t, n) {
        var r = new V();return r.name = e, r.nodeName = e, r.publicId = t, r.systemId = n, r;
      } }, C.prototype = { firstChild: null, lastChild: null, previousSibling: null, nextSibling: null, attributes: null, parentNode: null, childNodes: null, ownerDocument: null, nodeValue: null, namespaceURI: null, prefix: null, localName: null, insertBefore: function insertBefore(e, t) {
        return L(this, e, t);
      }, replaceChild: function replaceChild(e, t) {
        this.insertBefore(e, t), t && this.removeChild(t);
      }, removeChild: function removeChild(e) {
        return j(this, e);
      }, appendChild: function appendChild(e) {
        return this.insertBefore(e, null);
      }, hasChildNodes: function hasChildNodes() {
        return null != this.firstChild;
      }, cloneNode: function cloneNode(e) {
        return function e(t, n, r) {
          var o = new n.constructor();for (var i in n) {
            var a = n[i];"object" != d(a) && a != o[i] && (o[i] = a);
          }n.childNodes && (o.childNodes = new p());o.ownerDocument = t;switch (o.nodeType) {case v:
              var c = n.attributes,
                  u = o.attributes = new h(),
                  s = c.length;u._ownerElement = o;for (var l = 0; l < s; l++) {
                o.setAttributeNode(e(t, c.item(l), !0));
              }break;case b:
              r = !0;}if (r) for (var f = n.firstChild; f;) {
            o.appendChild(e(t, f, r)), f = f.nextSibling;
          }return o;
        }(this.ownerDocument || this, this, e);
      }, normalize: function normalize() {
        for (var e = this.firstChild; e;) {
          var t = e.nextSibling;t && t.nodeType == w && e.nodeType == w ? (this.removeChild(t), e.appendData(t.data)) : (e.normalize(), e = t);
        }
      }, isSupported: function isSupported(e, t) {
        return this.ownerDocument.implementation.hasFeature(e, t);
      }, hasAttributes: function hasAttributes() {
        return 0 < this.attributes.length;
      }, lookupPrefix: function lookupPrefix(e) {
        for (var t = this; t;) {
          var n = t._nsMap;if (n) for (var r in n) {
            if (n[r] == e) return r;
          }t = t.nodeType == b ? t.ownerDocument : t.parentNode;
        }return null;
      }, lookupNamespaceURI: function lookupNamespaceURI(e) {
        for (var t = this; t;) {
          var n = t._nsMap;if (n && e in n) return n[e];t = t.nodeType == b ? t.ownerDocument : t.parentNode;
        }return null;
      }, isDefaultNamespace: function isDefaultNamespace(e) {
        return null == this.lookupPrefix(e);
      } }, r(i, C), r(i, C.prototype), P.prototype = { nodeName: "#document", nodeType: T, doctype: null, documentElement: null, _inc: 1, insertBefore: function insertBefore(e, t) {
        if (e.nodeType != O) return null == this.documentElement && e.nodeType == v && (this.documentElement = e), L(this, e, t), e.ownerDocument = this, e;for (var n = e.firstChild; n;) {
          var r = n.nextSibling;this.insertBefore(n, t), n = r;
        }return e;
      }, removeChild: function removeChild(e) {
        return this.documentElement == e && (this.documentElement = null), j(this, e);
      }, importNode: function importNode(e, t) {
        return function e(t, n, r) {
          var o;switch (n.nodeType) {case v:
              (o = n.cloneNode(!1)).ownerDocument = t;case O:
              break;case b:
              r = !0;}o = o || n.cloneNode(!1);o.ownerDocument = t;o.parentNode = null;if (r) for (var i = n.firstChild; i;) {
            o.appendChild(e(t, i, r)), i = i.nextSibling;
          }return o;
        }(this, e, t);
      }, getElementById: function getElementById(t) {
        var n = null;return D(this.documentElement, function (e) {
          if (e.nodeType == v && e.getAttribute("id") == t) return n = e, !0;
        }), n;
      }, createElement: function createElement(e) {
        var t = new F();return t.ownerDocument = this, t.nodeName = e, t.tagName = e, t.childNodes = new p(), (t.attributes = new h())._ownerElement = t;
      }, createDocumentFragment: function createDocumentFragment() {
        var e = new z();return e.ownerDocument = this, e.childNodes = new p(), e;
      }, createTextNode: function createTextNode(e) {
        var t = new B();return t.ownerDocument = this, t.appendData(e), t;
      }, createComment: function createComment(e) {
        var t = new U();return t.ownerDocument = this, t.appendData(e), t;
      }, createCDATASection: function createCDATASection(e) {
        var t = new W();return t.ownerDocument = this, t.appendData(e), t;
      }, createProcessingInstruction: function createProcessingInstruction(e, t) {
        var n = new $();return n.ownerDocument = this, n.tagName = n.target = e, n.nodeValue = n.data = t, n;
      }, createAttribute: function createAttribute(e) {
        var t = new k();return t.ownerDocument = this, t.name = e, t.nodeName = e, t.localName = e, t.specified = !0, t;
      }, createEntityReference: function createEntityReference(e) {
        var t = new q();return t.ownerDocument = this, t.nodeName = e, t;
      }, createElementNS: function createElementNS(e, t) {
        var n = new F(),
            r = t.split(":"),
            o = n.attributes = new h();return n.childNodes = new p(), n.ownerDocument = this, n.nodeName = t, n.tagName = t, n.namespaceURI = e, 2 == r.length ? (n.prefix = r[0], n.localName = r[1]) : n.localName = t, o._ownerElement = n;
      }, createAttributeNS: function createAttributeNS(e, t) {
        var n = new k(),
            r = t.split(":");return n.ownerDocument = this, n.nodeName = t, n.name = t, n.namespaceURI = e, n.specified = !0, 2 == r.length ? (n.prefix = r[0], n.localName = r[1]) : n.localName = t, n;
      } }, o(P, C), P.prototype.getElementsByTagName = (F.prototype = { nodeType: v, hasAttribute: function hasAttribute(e) {
        return null != this.getAttributeNode(e);
      }, getAttribute: function getAttribute(e) {
        var t = this.getAttributeNode(e);return t && t.value || "";
      }, getAttributeNode: function getAttributeNode(e) {
        return this.attributes.getNamedItem(e);
      }, setAttribute: function setAttribute(e, t) {
        var n = this.ownerDocument.createAttribute(e);n.value = n.nodeValue = "" + t, this.setAttributeNode(n);
      }, removeAttribute: function removeAttribute(e) {
        var t = this.getAttributeNode(e);t && this.removeAttributeNode(t);
      }, appendChild: function appendChild(e) {
        return e.nodeType === O ? this.insertBefore(e, null) : function (e, t) {
          var n = t.parentNode;n && (r = e.lastChild, n.removeChild(t), r = e.lastChild);var r = e.lastChild;return t.parentNode = e, t.previousSibling = r, t.nextSibling = null, r ? r.nextSibling = t : e.firstChild = t, e.lastChild = t, R(e.ownerDocument, e, t), t;
        }(this, e);
      }, setAttributeNode: function setAttributeNode(e) {
        return this.attributes.setNamedItem(e);
      }, setAttributeNodeNS: function setAttributeNodeNS(e) {
        return this.attributes.setNamedItemNS(e);
      }, removeAttributeNode: function removeAttributeNode(e) {
        return this.attributes.removeNamedItem(e.nodeName);
      }, removeAttributeNS: function removeAttributeNS(e, t) {
        var n = this.getAttributeNodeNS(e, t);n && this.removeAttributeNode(n);
      }, hasAttributeNS: function hasAttributeNS(e, t) {
        return null != this.getAttributeNodeNS(e, t);
      }, getAttributeNS: function getAttributeNS(e, t) {
        var n = this.getAttributeNodeNS(e, t);return n && n.value || "";
      }, setAttributeNS: function setAttributeNS(e, t, n) {
        var r = this.ownerDocument.createAttributeNS(e, t);r.value = r.nodeValue = "" + n, this.setAttributeNode(r);
      }, getAttributeNodeNS: function getAttributeNodeNS(e, t) {
        return this.attributes.getNamedItemNS(e, t);
      }, getElementsByTagName: function getElementsByTagName(r) {
        return new s(this, function (t) {
          var n = [];return D(t, function (e) {
            e === t || e.nodeType != v || "*" !== r && e.tagName != r || n.push(e);
          }), n;
        });
      }, getElementsByTagNameNS: function getElementsByTagNameNS(r, o) {
        return new s(this, function (t) {
          var n = [];return D(t, function (e) {
            e === t || e.nodeType !== v || "*" !== r && e.namespaceURI !== r || "*" !== o && e.localName != o || n.push(e);
          }), n;
        });
      } }).getElementsByTagName, P.prototype.getElementsByTagNameNS = F.prototype.getElementsByTagNameNS, o(F, C), k.prototype.nodeType = b, o(k, C), H.prototype = { data: "", substringData: function substringData(e, t) {
        return this.data.substring(e, e + t);
      }, appendData: function appendData(e) {
        e = this.data + e, this.nodeValue = this.data = e, this.length = e.length;
      }, insertData: function insertData(e, t) {
        this.replaceData(e, 0, t);
      }, appendChild: function appendChild() {
        throw new Error(c[3]);
      }, deleteData: function deleteData(e, t) {
        this.replaceData(e, t, "");
      }, replaceData: function replaceData(e, t, n) {
        n = this.data.substring(0, e) + n + this.data.substring(e + t), this.nodeValue = this.data = n, this.length = n.length;
      } }, o(H, C), B.prototype = { nodeName: "#text", nodeType: w, splitText: function splitText(e) {
        var t = (n = this.data).substring(e),
            n = n.substring(0, e);this.data = this.nodeValue = n, this.length = n.length;var r = this.ownerDocument.createTextNode(t);return this.parentNode && this.parentNode.insertBefore(r, this.nextSibling), r;
      } }, o(B, H), U.prototype = { nodeName: "#comment", nodeType: S }, o(U, H), W.prototype = { nodeName: "#cdata-section", nodeType: _ }, o(W, H), V.prototype.nodeType = N, o(V, C), K.prototype.nodeType = 12, o(K, C), G.prototype.nodeType = 6, o(G, C), q.prototype.nodeType = E, o(q, C), z.prototype.nodeName = "#document-fragment", z.prototype.nodeType = O, o(z, C), $.prototype.nodeType = x, o($, C), X.prototype.serializeToString = function (e, t, n) {
      return Y.call(e, t, n);
    }, C.prototype.toString = Y;try {
      Object.defineProperty && (Object.defineProperty(s.prototype, "length", { get: function get() {
          return l(this), this.$$length;
        } }), Object.defineProperty(C.prototype, "textContent", { get: function get() {
          return function e(t) {
            switch (t.nodeType) {case v:case O:
                var n = [];for (t = t.firstChild; t;) {
                  7 !== t.nodeType && 8 !== t.nodeType && n.push(e(t)), t = t.nextSibling;
                }return n.join("");default:
                return t.nodeValue;}
          }(this);
        }, set: function set(e) {
          switch (this.nodeType) {case v:case O:
              for (; this.firstChild;) {
                this.removeChild(this.firstChild);
              }(e || String(e)) && this.appendChild(this.ownerDocument.createTextNode(e));break;default:
              this.data = e, this.value = e, this.nodeValue = e;}
        } }), Z = function Z(e, t, n) {
        e["$$" + t] = n;
      });
    } catch (e) {}n.DOMImplementation = M, n.XMLSerializer = X;
  }, {}], 21: [function (e, t, n) {
    "use strict";
    n.entityMap = { lt: "<", gt: ">", amp: "&", quot: '"', apos: "'", Agrave: "", Aacute: "", Acirc: "", Atilde: "", Auml: "", Aring: "", AElig: "", Ccedil: "", Egrave: "", Eacute: "", Ecirc: "", Euml: "", Igrave: "", Iacute: "", Icirc: "", Iuml: "", ETH: "", Ntilde: "", Ograve: "", Oacute: "", Ocirc: "", Otilde: "", Ouml: "", Oslash: "", Ugrave: "", Uacute: "", Ucirc: "", Uuml: "", Yacute: "", THORN: "", szlig: "", agrave: "", aacute: "", acirc: "", atilde: "", auml: "", aring: "", aelig: "", ccedil: "", egrave: "", eacute: "", ecirc: "", euml: "", igrave: "", iacute: "", icirc: "", iuml: "", eth: "", ntilde: "", ograve: "", oacute: "", ocirc: "", otilde: "", ouml: "", oslash: "", ugrave: "", uacute: "", ucirc: "", uuml: "", yacute: "", thorn: "", yuml: "", nbsp: " ", iexcl: "", cent: "", pound: "", curren: "", yen: "", brvbar: "", sect: "", uml: "", copy: "", ordf: "", laquo: "", not: "", shy: "", reg: "", macr: "", deg: "", plusmn: "", sup2: "", sup3: "", acute: "", micro: "", para: "", middot: "", cedil: "", sup1: "", ordm: "", raquo: "", frac14: "", frac12: "", frac34: "", iquest: "", times: "", divide: "", forall: "", part: "", exist: "", empty: "", nabla: "", isin: "", notin: "", ni: "", prod: "", sum: "", minus: "", lowast: "", radic: "", prop: "", infin: "", ang: "", and: "", or: "", cap: "", cup: "", int: "", there4: "", sim: "", cong: "", asymp: "", ne: "", equiv: "", le: "", ge: "", sub: "", sup: "", nsub: "", sube: "", supe: "", oplus: "", otimes: "", perp: "", sdot: "", Alpha: "", Beta: "", Gamma: "", Delta: "", Epsilon: "", Zeta: "", Eta: "", Theta: "", Iota: "", Kappa: "", Lambda: "", Mu: "", Nu: "", Xi: "", Omicron: "", Pi: "", Rho: "", Sigma: "", Tau: "", Upsilon: "", Phi: "", Chi: "", Psi: "", Omega: "", alpha: "", beta: "", gamma: "", delta: "", epsilon: "", zeta: "", eta: "", theta: "", iota: "", kappa: "", lambda: "", mu: "", nu: "", xi: "", omicron: "", pi: "", rho: "", sigmaf: "", sigma: "", tau: "", upsilon: "", phi: "", chi: "", psi: "", omega: "", thetasym: "", upsih: "", piv: "", OElig: "", oelig: "", Scaron: "", scaron: "", Yuml: "", fnof: "", circ: "", tilde: "", ensp: "", emsp: "", thinsp: "", zwnj: "", zwj: "", lrm: "", rlm: "", ndash: "", mdash: "", lsquo: "", rsquo: "", sbquo: "", ldquo: "", rdquo: "", bdquo: "", dagger: "", Dagger: "", bull: "", hellip: "", permil: "", prime: "", Prime: "", lsaquo: "", rsaquo: "", oline: "", euro: "", trade: "", larr: "", uarr: "", rarr: "", darr: "", harr: "", crarr: "", lceil: "", rceil: "", lfloor: "", rfloor: "", loz: "", spades: "", clubs: "", hearts: "", diams: "" };
  }, {}], 22: [function (e, t, n) {
    "use strict";
    var r = /[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,
        o = new RegExp("[\\-\\.0-9" + r.source.slice(1, -1) + "\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),
        i = new RegExp("^" + r.source + o.source + "*(?::" + r.source + o.source + "*)?$"),
        A = 0,
        D = 1,
        P = 2,
        I = 3,
        R = 4,
        j = 5,
        L = 6,
        F = 7;function a() {}function k(e, t) {
      return t.lineNumber = e.lineNumber, t.columnNumber = e.columnNumber, t;
    }function H(e, t, n) {
      for (var r = e.tagName, o = null, i = e.length; i--;) {
        var a = e[i],
            c = a.qName,
            u = a.value,
            s = 0 < (f = c.indexOf(":")) ? (l = a.prefix = c.slice(0, f), d = c.slice(f + 1), "xmlns" === l && d) : (l = null, "xmlns" === (d = c) && "");a.localName = d, !1 !== s && (null == o && (o = {}, h(n, n = {})), n[s] = o[s] = u, a.uri = "http://www.w3.org/2000/xmlns/", t.startPrefixMapping(s, u));
      }for (var l, i = e.length; i--;) {
        (l = (a = e[i]).prefix) && ("xml" === l && (a.uri = "http://www.w3.org/XML/1998/namespace"), "xmlns" !== l && (a.uri = n[l || ""]));
      }var f,
          d = 0 < (f = r.indexOf(":")) ? (l = e.prefix = r.slice(0, f), e.localName = r.slice(f + 1)) : (l = null, e.localName = r),
          p = e.uri = n[l || ""];if (t.startElement(p, d, r, e), !e.closed) return e.currentNSMap = n, e.localNSMap = o, 1;if (t.endElement(p, d, r), o) for (l in o) {
        t.endPrefixMapping(l);
      }
    }function h(e, t) {
      for (var n in e) {
        t[n] = e[n];
      }
    }function B(e) {}a.prototype = { parse: function parse(e, t, n) {
        var r = this.domBuilder;r.startDocument(), h(t, t = {}), function (n, e, r, o, i) {
          function a(e) {
            var t = e.slice(1, -1);return t in r ? r[t] : "#" === t.charAt(0) ? function (e) {
              if (65535 < e) {
                var t = 55296 + ((e -= 65536) >> 10),
                    n = 56320 + (1023 & e);return String.fromCharCode(t, n);
              }return String.fromCharCode(e);
            }(parseInt(t.substr(1).replace("x", "0x"))) : (i.error("entity not found:" + e), e);
          }function t(e) {
            var t;h < e && (t = n.substring(h, e).replace(/&#?\w+;/g, a), f && c(h), o.characters(t, 0, e - h), h = e);
          }function c(e, t) {
            for (; s <= e && (t = l.exec(n));) {
              u = t.index, s = u + t[0].length, f.lineNumber++;
            }f.columnNumber = e - u + 1;
          }var u = 0,
              s = 0,
              l = /.*(?:\r\n?|\n)|.*$/g,
              f = o.locator,
              d = [{ currentNSMap: e }],
              p = {},
              h = 0;for (;;) {
            try {
              var m,
                  g,
                  y = n.indexOf("<", h);if (y < 0) return n.substr(h).match(/^\s*$/) || (m = o.doc, g = m.createTextNode(n.substr(h)), m.appendChild(g), o.currentElement = g);switch (h < y && t(y), n.charAt(y + 1)) {case "/":
                  var v = n.indexOf(">", y + 3),
                      b = n.substring(y + 2, v),
                      w = d.pop();v < 0 ? (b = n.substring(y + 2).replace(/[\s<].*/, ""), i.error("end tag name: " + b + " is not complete:" + w.tagName), v = y + 1 + b.length) : b.match(/\s</) && (b = b.replace(/[\s<].*/, ""), i.error("end tag name: " + b + " maybe not complete"), v = y + 1 + b.length);var _ = w.localNSMap,
                      E = w.tagName == b;if (E || w.tagName && w.tagName.toLowerCase() == b.toLowerCase()) {
                    if (o.endElement(w.uri, w.localName, b), _) for (var x in _) {
                      o.endPrefixMapping(x);
                    }E || i.fatalError("end tag name: " + b + " is not match the current start tagName:" + w.tagName);
                  } else d.push(w);v++;break;case "?":
                  f && c(y), v = function (e, t, n) {
                    var r = e.indexOf("?>", t);if (r) {
                      var o = e.substring(t, r).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if (o) {
                        o[0].length;return n.processingInstruction(o[1], o[2]), r + 2;
                      }return -1;
                    }return -1;
                  }(n, y, o);break;case "!":
                  f && c(y), v = function (e, t, n, r) {
                    switch (e.charAt(t + 2)) {case "-":
                        if ("-" !== e.charAt(t + 3)) return -1;var o = e.indexOf("--\x3e", t + 4);return t < o ? (n.comment(e, t + 4, o - t - 4), o + 3) : (r.error("Unclosed comment"), -1);default:
                        if ("CDATA[" == e.substr(t + 3, 6)) {
                          o = e.indexOf("]]>", t + 9);return n.startCDATA(), n.characters(e, t + 9, o - t - 9), n.endCDATA(), o + 3;
                        }var i = function (e, t) {
                          var n,
                              r = [],
                              o = /'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;o.lastIndex = t, o.exec(e);for (; n = o.exec(e);) {
                            if (r.push(n), n[1]) return r;
                          }
                        }(e, t),
                            a = i.length;if (1 < a && /!doctype/i.test(i[0][0])) {
                          var c = i[1][0],
                              u = 3 < a && /^public$/i.test(i[2][0]) && i[3][0],
                              s = 4 < a && i[4][0],
                              l = i[a - 1];return n.startDTD(c, u && u.replace(/^(['"])(.*?)\1$/, "$2"), s && s.replace(/^(['"])(.*?)\1$/, "$2")), n.endDTD(), l.index + l[0].length;
                        }}return -1;
                  }(n, y, o, i);break;default:
                  f && c(y);var S = new B(),
                      T = d[d.length - 1].currentNSMap,
                      v = function (e, t, n, r, o, i) {
                    var a,
                        c = ++t,
                        u = A;for (;;) {
                      var s = e.charAt(c);switch (s) {case "=":
                          if (u === D) a = e.slice(t, c), u = I;else {
                            if (u !== P) throw new Error("attribute equal must after attrName");u = I;
                          }break;case "'":case '"':
                          if (u === I || u === D) {
                            if (u === D && (i.warning('attribute value must after "="'), a = e.slice(t, c)), t = c + 1, !(0 < (c = e.indexOf(s, t)))) throw new Error("attribute value no end '" + s + "' match");l = e.slice(t, c).replace(/&#?\w+;/g, o), n.add(a, l, t - 1), u = j;
                          } else {
                            if (u != R) throw new Error('attribute value must after "="');l = e.slice(t, c).replace(/&#?\w+;/g, o), n.add(a, l, t), i.warning('attribute "' + a + '" missed start quot(' + s + ")!!"), t = c + 1, u = j;
                          }break;case "/":
                          switch (u) {case A:
                              n.setTagName(e.slice(t, c));case j:case L:case F:
                              u = F, n.closed = !0;case R:case D:case P:
                              break;default:
                              throw new Error("attribute invalid close char('/')");}break;case "":
                          return i.error("unexpected end of input"), u == A && n.setTagName(e.slice(t, c)), c;case ">":
                          switch (u) {case A:
                              n.setTagName(e.slice(t, c));case j:case L:case F:
                              break;case R:case D:
                              "/" === (l = e.slice(t, c)).slice(-1) && (n.closed = !0, l = l.slice(0, -1));case P:
                              u === P && (l = a), u == R ? (i.warning('attribute "' + l + '" missed quot(")!!'), n.add(a, l.replace(/&#?\w+;/g, o), t)) : ("http://www.w3.org/1999/xhtml" === r[""] && l.match(/^(?:disabled|checked|selected)$/i) || i.warning('attribute "' + l + '" missed value!! "' + l + '" instead!!'), n.add(l, l, t));break;case I:
                              throw new Error("attribute value missed!!");}return c;case "":
                          s = " ";default:
                          if (s <= " ") switch (u) {case A:
                              n.setTagName(e.slice(t, c)), u = L;break;case D:
                              a = e.slice(t, c), u = P;break;case R:
                              var l = e.slice(t, c).replace(/&#?\w+;/g, o);i.warning('attribute "' + l + '" missed quot(")!!'), n.add(a, l, t);case j:
                              u = L;} else switch (u) {case P:
                              n.tagName;"http://www.w3.org/1999/xhtml" === r[""] && a.match(/^(?:disabled|checked|selected)$/i) || i.warning('attribute "' + a + '" missed value!! "' + a + '" instead2!!'), n.add(a, a, t), t = c, u = D;break;case j:
                              i.warning('attribute space is required"' + a + '"!!');case L:
                              u = D, t = c;break;case I:
                              u = R, t = c;break;case F:
                              throw new Error("elements closed character '/' and '>' must be connected to");}}c++;
                    }
                  }(n, y, S, T, a, i),
                      N = S.length;if (!S.closed && function (e, t, n, r) {
                    var o = r[n];null == o && ((o = e.lastIndexOf("</" + n + ">")) < t && (o = e.lastIndexOf("</" + n)), r[n] = o);return o < t;
                  }(n, v, S.tagName, p) && (S.closed = !0, r.nbsp || i.warning("unclosed xml attribute")), f && N) {
                    for (var O = k(f, {}), M = 0; M < N; M++) {
                      var C = S[M];c(C.offset), C.locator = k(f, {});
                    }o.locator = O, H(S, o, T) && d.push(S), o.locator = f;
                  } else H(S, o, T) && d.push(S);"http://www.w3.org/1999/xhtml" !== S.uri || S.closed ? v++ : v = function (e, t, n, r, o) {
                    if (/^(?:script|textarea)$/i.test(n)) {
                      var i = e.indexOf("</" + n + ">", t),
                          a = e.substring(t + 1, i);if (/[&<]/.test(a)) return (/^script$/i.test(n) || (a = a.replace(/&#?\w+;/g, r)), o.characters(a, 0, a.length), i
                      );
                    }return t + 1;
                  }(n, v, S.tagName, a, o);}
            } catch (e) {
              i.error("element parse error: " + e), v = -1;
            }h < v ? h = v : t(Math.max(y, h) + 1);
          }
        }(e, t, n, r, this.errorHandler), r.endDocument();
      } }, B.prototype = { setTagName: function setTagName(e) {
        if (!i.test(e)) throw new Error("invalid tagName:" + e);this.tagName = e;
      }, add: function add(e, t, n) {
        if (!i.test(e)) throw new Error("invalid attribute:" + e);this[this.length++] = { qName: e, value: t, offset: n };
      }, length: 0, getLocalName: function getLocalName(e) {
        return this[e].localName;
      }, getLocator: function getLocator(e) {
        return this[e].locator;
      }, getQName: function getQName(e) {
        return this[e].qName;
      }, getURI: function getURI(e) {
        return this[e].uri;
      }, getValue: function getValue(e) {
        return this[e].value;
      } }, n.XMLReader = a;
  }, {}], 23: [function (e, t, n) {
    "use strict";
    var r = GameGlobal,
        o = r.__globalAdapter = {};Object.assign(o, { init: function init() {
        e("./wrapper/builtin"), r.DOMParser = e("../../common/xmldom/dom-parser").DOMParser, e("./wrapper/unify"), e("./wrapper/fs-utils"), e("../../common/engine/globalAdapter"), e("./wrapper/systemInfo");
      }, adaptEngine: function adaptEngine() {
        e("./wrapper/error-reporter"), e("../../common/engine"), e("./wrapper/engine"), e("./wrapper/sub-context-adapter");
      } });
  }, { "../../common/engine": 16, "../../common/engine/globalAdapter": 15, "../../common/xmldom/dom-parser": 19, "./wrapper/builtin": 46, "./wrapper/engine": 52, "./wrapper/error-reporter": 54, "./wrapper/fs-utils": 55, "./wrapper/sub-context-adapter": 1, "./wrapper/systemInfo": 56, "./wrapper/unify": 57 }], 24: [function (e, t, n) {
    "use strict";
    Object.defineProperty(n, "__esModule", { value: !0 }), n.default = void 0;var r,
        i = (r = e("./HTMLAudioElement")) && r.__esModule ? r : { default: r };function c(e) {
      return (c = "function" == typeof Symbol && "symbol" == _typeof(Symbol.iterator) ? function (e) {
        return typeof e === "undefined" ? "undefined" : _typeof(e);
      } : function (e) {
        return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e === "undefined" ? "undefined" : _typeof(e);
      })(e);
    }function a(e, t) {
      for (var n = 0; n < t.length; n++) {
        var r = t[n];r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, r.key, r);
      }
    }function u(e, t, n) {
      return (u = "undefined" != typeof Reflect && Reflect.get ? Reflect.get : function (e, t, n) {
        var r = function (e, t) {
          for (; !Object.prototype.hasOwnProperty.call(e, t) && null !== (e = f(e));) {}return e;
        }(e, t);if (r) {
          var o = Object.getOwnPropertyDescriptor(r, t);return o.get ? o.get.call(n) : o.value;
        }
      })(e, t, n || e);
    }function s(e, t) {
      return (s = Object.setPrototypeOf || function (e, t) {
        return e.__proto__ = t, e;
      })(e, t);
    }function l(i) {
      var a = function () {
        if ("undefined" == typeof Reflect || !Reflect.construct) return !1;if (Reflect.construct.sham) return !1;if ("function" == typeof Proxy) return !0;try {
          return Date.prototype.toString.call(Reflect.construct(Date, [], function () {})), !0;
        } catch (e) {
          return !1;
        }
      }();return function () {
        var e,
            t,
            n,
            r,
            o = f(i);return t = a ? (e = f(this).constructor, Reflect.construct(o, arguments, e)) : o.apply(this, arguments), n = this, !(r = t) || "object" !== c(r) && "function" != typeof r ? function (e) {
          if (void 0 !== e) return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        }(n) : r;
      };
    }function f(e) {
      return (f = Object.setPrototypeOf ? Object.getPrototypeOf : function (e) {
        return e.__proto__ || Object.getPrototypeOf(e);
      })(e);
    }var d = 0,
        p = 1,
        h = 2,
        m = 3,
        g = 4,
        y = 1,
        v = {},
        o = function () {
      !function (e, t) {
        if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function");e.prototype = Object.create(t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } }), t && s(e, t);
      }(o, i["default"]);var e,
          t,
          n,
          r = l(o);function o(e) {
        var t;!function (e, t) {
          if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
        }(this, o), (t = r.call(this))._$sn = y++, t.HAVE_NOTHING = d, t.HAVE_METADATA = p, t.HAVE_CURRENT_DATA = h, t.HAVE_FUTURE_DATA = m, t.HAVE_ENOUGH_DATA = g, t.readyState = d;var n = wx.createInnerAudioContext();return v[t._$sn] = n, t._canplayEvents = ["load", "loadend", "canplay", "canplaythrough", "loadedmetadata"], n.onCanplay(function () {
          t._loaded = !0, t.readyState = t.HAVE_CURRENT_DATA, t._canplayEvents.forEach(function (e) {
            t.dispatchEvent({ type: e });
          });
        }), n.onPlay(function () {
          t._paused = v[t._$sn].paused, t.dispatchEvent({ type: "play" });
        }), n.onPause(function () {
          t._paused = v[t._$sn].paused, t.dispatchEvent({ type: "pause" });
        }), n.onEnded(function () {
          t._paused = v[t._$sn].paused, !1 === v[t._$sn].loop && t.dispatchEvent({ type: "ended" }), t.readyState = g;
        }), n.onError(function () {
          t._paused = v[t._$sn].paused, t.dispatchEvent({ type: "error" });
        }), e ? t.src = e : t._src = "", t._loop = n.loop, t._autoplay = n.autoplay, t._paused = n.paused, t._volume = n.volume, t._muted = !1, t;
      }return e = o, (t = [{ key: "addEventListener", value: function value(e, t, n) {
          var r = 2 < arguments.length && void 0 !== n ? n : {};u(f(o.prototype), "addEventListener", this).call(this, e, t, r), e = String(e).toLowerCase(), this._loaded && -1 !== this._canplayEvents.indexOf(e) && this.dispatchEvent({ type: e });
        } }, { key: "load", value: function value() {} }, { key: "play", value: function value() {
          v[this._$sn].play();
        } }, { key: "resume", value: function value() {
          v[this._$sn].resume();
        } }, { key: "pause", value: function value() {
          v[this._$sn].pause();
        } }, { key: "stop", value: function value() {
          v[this._$sn].stop();
        } }, { key: "destroy", value: function value() {
          v[this._$sn].destroy();
        } }, { key: "canPlayType", value: function value(e) {
          var t = 0 < arguments.length && void 0 !== e ? e : "";return "string" == typeof t && (-1 < t.indexOf("audio/mpeg") || t.indexOf("audio/mp4")) ? "probably" : "";
        } }, { key: "cloneNode", value: function value() {
          var e = new o();return e.loop = this.loop, e.autoplay = this.autoplay, e.src = this.src, e;
        } }, { key: "currentTime", get: function get() {
          return v[this._$sn].currentTime;
        }, set: function set(e) {
          v[this._$sn].seek(e);
        } }, { key: "duration", get: function get() {
          return v[this._$sn].duration;
        } }, { key: "src", get: function get() {
          return this._src;
        }, set: function set(e) {
          this._src = e, this._loaded = !1, this.readyState = this.HAVE_NOTHING, v[this._$sn].src = e;
        } }, { key: "loop", get: function get() {
          return this._loop;
        }, set: function set(e) {
          this._loop = e, v[this._$sn].loop = e;
        } }, { key: "autoplay", get: function get() {
          return this.autoplay;
        }, set: function set(e) {
          this._autoplay = e, v[this._$sn].autoplay = e;
        } }, { key: "paused", get: function get() {
          return this._paused;
        } }, { key: "volume", get: function get() {
          return this._volume;
        }, set: function set(e) {
          this._volume = e, this._muted || (v[this._$sn].volume = e);
        } }, { key: "muted", get: function get() {
          return this._muted;
        }, set: function set(e) {
          this._muted = e, v[this._$sn].volume = e ? 0 : this._volume;
        } }]) && a(e.prototype, t), n && a(e, n), o;
    }();n.default = o, t.exports = n.default;
  }, { "./HTMLAudioElement": 32 }], 25: [function (e, t, n) {
    "use strict";
    Object.defineProperty(n, "__esModule", { value: !0 }), n.default = function () {
      var e = wx.createCanvas();e.type = "canvas";e.getContext;return e.getBoundingClientRect = function () {
        return { top: 0, left: 0, width: window.innerWidth, height: window.innerHeight };
      }, e.style = { top: "0px", left: "0px", width: r.innerWidth + "px", height: r.innerHeight + "px" }, e.addEventListener = function (e, t) {
        var n = 2 < arguments.length && void 0 !== arguments[2] ? arguments[2] : {};document.addEventListener(e, t, n);
      }, e.removeEventListener = function (e, t) {
        document.removeEventListener(e, t);
      }, e.dispatchEvent = function () {
        var e = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : {};console.log("canvas.dispatchEvent", e.type, e);
      }, Object.defineProperty(e, "clientWidth", { enumerable: !0, get: function get() {
          return r.innerWidth;
        } }), Object.defineProperty(e, "clientHeight", { enumerable: !0, get: function get() {
          return r.innerHeight;
        } }), e;
    };var r = e("./WindowProperties");t.exports = n.default;
  }, { "./WindowProperties": 43 }], 26: [function (e, t, n) {
    "use strict";
    Object.defineProperty(n, "__esModule", { value: !0 }), n.default = void 0;var r,
        o = (r = e("./Node")) && r.__esModule ? r : { default: r };function c(e) {
      return (c = "function" == typeof Symbol && "symbol" == _typeof(Symbol.iterator) ? function (e) {
        return typeof e === "undefined" ? "undefined" : _typeof(e);
      } : function (e) {
        return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e === "undefined" ? "undefined" : _typeof(e);
      })(e);
    }function i(e, t) {
      return (i = Object.setPrototypeOf || function (e, t) {
        return e.__proto__ = t, e;
      })(e, t);
    }function a(i) {
      var a = function () {
        if ("undefined" == typeof Reflect || !Reflect.construct) return !1;if (Reflect.construct.sham) return !1;if ("function" == typeof Proxy) return !0;try {
          return Date.prototype.toString.call(Reflect.construct(Date, [], function () {})), !0;
        } catch (e) {
          return !1;
        }
      }();return function () {
        var e,
            t,
            n,
            r,
            o = u(i);return t = a ? (e = u(this).constructor, Reflect.construct(o, arguments, e)) : o.apply(this, arguments), n = this, !(r = t) || "object" !== c(r) && "function" != typeof r ? function (e) {
          if (void 0 !== e) return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        }(n) : r;
      };
    }function u(e) {
      return (u = Object.setPrototypeOf ? Object.getPrototypeOf : function (e) {
        return e.__proto__ || Object.getPrototypeOf(e);
      })(e);
    }var s = function () {
      !function (e, t) {
        if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function");e.prototype = Object.create(t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } }), t && i(e, t);
      }(n, o["default"]);var t = a(n);function n() {
        var e;return function (e, t) {
          if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
        }(this, n), (e = t.call(this)).className = "", e.children = [], e;
      }return n;
    }();n.default = s, t.exports = n.default;
  }, { "./Node": 40 }], 27: [function (e, t, n) {
    "use strict";
    Object.defineProperty(n, "__esModule", { value: !0 }), n.default = void 0;n.default = function e() {
      !function (e, t) {
        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
      }(this, e);
    }, t.exports = n.default;
  }, {}], 28: [function (e, t, n) {
    "use strict";
    Object.defineProperty(n, "__esModule", { value: !0 }), n.default = void 0;var r = e("../util/index.js");function o(e) {
      !function (e, t) {
        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
      }(this, o), this.touches = [], this.targetTouches = [], this.changedTouches = [], this.preventDefault = r.noop, this.stopPropagation = r.noop, this.type = e, this.target = window.canvas, this.currentTarget = window.canvas;
    }function i(n) {
      return function (e) {
        var t = new o(n);t.touches = e.touches, t.targetTouches = Array.prototype.slice.call(e.touches), t.changedTouches = e.changedTouches, t.timeStamp = e.timeStamp, document.dispatchEvent(t);
      };
    }n.default = o, wx.onTouchStart(i("touchstart")), wx.onTouchMove(i("touchmove")), wx.onTouchEnd(i("touchend")), wx.onTouchCancel(i("touchcancel")), t.exports = n.default;
  }, { "../util/index.js": 50 }], 29: [function (e, t, n) {
    "use strict";
    Object.defineProperty(n, "__esModule", { value: !0 }), Object.defineProperty(n, "TouchEvent", { enumerable: !0, get: function get() {
        return r.default;
      } }), Object.defineProperty(n, "MouseEvent", { enumerable: !0, get: function get() {
        return o.default;
      } });var r = i(e("./TouchEvent")),
        o = i(e("./MouseEvent"));function i(e) {
      return e && e.__esModule ? e : { default: e };
    }
  }, { "./MouseEvent": 27, "./TouchEvent": 28 }], 30: [function (e, t, n) {
    "use strict";
    function o(e, t) {
      for (var n = 0; n < t.length; n++) {
        var r = t[n];r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, r.key, r);
      }
    }Object.defineProperty(n, "__esModule", { value: !0 }), n.default = void 0;var i = new WeakMap(),
        r = function () {
      function e() {
        !function (e, t) {
          if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
        }(this, e), i.set(this, {});
      }var t, n, r;return t = e, (n = [{ key: "addEventListener", value: function value(e, t, n) {
          var r = 2 < arguments.length && void 0 !== n ? n : {},
              o = i.get(this);o || (o = {}, i.set(this, o)), o[e] || (o[e] = []), o[e].push(t), r.capture, r.once, r.passive;
        } }, { key: "removeEventListener", value: function value(e, t) {
          var n = i.get(this);if (n) {
            var r = n[e];if (r && 0 < r.length) for (var o = r.length; o--;) {
              if (r[o] === t) {
                r.splice(o, 1);break;
              }
            }
          }
        } }, { key: "dispatchEvent", value: function value(e) {
          var t = 0 < arguments.length && void 0 !== e ? e : {},
              n = i.get(this)[t.type];if (n) for (var r = 0; r < n.length; r++) {
            n[r](t);
          }
        } }]) && o(t.prototype, n), r && o(t, r), e;
    }();n.default = r, t.exports = n.default;
  }, {}], 31: [function (e, t, n) {
    "use strict";
    function o(e, t) {
      for (var n = 0; n < t.length; n++) {
        var r = t[n];r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, r.key, r);
      }
    }Object.defineProperty(n, "__esModule", { value: !0 }), n.default = void 0;var r = function () {
      function e() {
        !function (e, t) {
          if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
        }(this, e);
      }var t, n, r;return t = e, (n = [{ key: "construct", value: function value() {} }]) && o(t.prototype, n), r && o(t, r), e;
    }();n.default = r, t.exports = n.default;
  }, {}], 32: [function (e, t, n) {
    "use strict";
    Object.defineProperty(n, "__esModule", { value: !0 }), n.default = void 0;var r,
        o = (r = e("./HTMLMediaElement")) && r.__esModule ? r : { default: r };function c(e) {
      return (c = "function" == typeof Symbol && "symbol" == _typeof(Symbol.iterator) ? function (e) {
        return typeof e === "undefined" ? "undefined" : _typeof(e);
      } : function (e) {
        return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e === "undefined" ? "undefined" : _typeof(e);
      })(e);
    }function i(e, t) {
      return (i = Object.setPrototypeOf || function (e, t) {
        return e.__proto__ = t, e;
      })(e, t);
    }function a(i) {
      var a = function () {
        if ("undefined" == typeof Reflect || !Reflect.construct) return !1;if (Reflect.construct.sham) return !1;if ("function" == typeof Proxy) return !0;try {
          return Date.prototype.toString.call(Reflect.construct(Date, [], function () {})), !0;
        } catch (e) {
          return !1;
        }
      }();return function () {
        var e,
            t,
            n,
            r,
            o = u(i);return t = a ? (e = u(this).constructor, Reflect.construct(o, arguments, e)) : o.apply(this, arguments), n = this, !(r = t) || "object" !== c(r) && "function" != typeof r ? function (e) {
          if (void 0 !== e) return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        }(n) : r;
      };
    }function u(e) {
      return (u = Object.setPrototypeOf ? Object.getPrototypeOf : function (e) {
        return e.__proto__ || Object.getPrototypeOf(e);
      })(e);
    }var s = function () {
      !function (e, t) {
        if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function");e.prototype = Object.create(t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } }), t && i(e, t);
      }(t, o["default"]);var e = a(t);function t() {
        return function (e, t) {
          if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
        }(this, t), e.call(this, "audio");
      }return t;
    }();n.default = s, t.exports = n.default;
  }, { "./HTMLMediaElement": 36 }], 33: [function (e, t, n) {
    "use strict";
    Object.defineProperty(n, "__esModule", { value: !0 }), n.default = void 0;var r = o(e("./Canvas"));o(e("./HTMLElement"));function o(e) {
      return e && e.__esModule ? e : { default: e };
    }GameGlobal.screencanvas = GameGlobal.screencanvas || new r.default();var i = GameGlobal.screencanvas.constructor;n.default = i, t.exports = n.default;
  }, { "./Canvas": 25, "./HTMLElement": 34 }], 34: [function (e, t, n) {
    "use strict";
    Object.defineProperty(n, "__esModule", { value: !0 }), n.default = void 0;var r,
        i = (r = e("./Element")) && r.__esModule ? r : { default: r },
        a = e("./util/index.js"),
        c = e("./WindowProperties");function u(e) {
      return (u = "function" == typeof Symbol && "symbol" == _typeof(Symbol.iterator) ? function (e) {
        return typeof e === "undefined" ? "undefined" : _typeof(e);
      } : function (e) {
        return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e === "undefined" ? "undefined" : _typeof(e);
      })(e);
    }function s(e, t) {
      for (var n = 0; n < t.length; n++) {
        var r = t[n];r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, r.key, r);
      }
    }function l(e, t) {
      return (l = Object.setPrototypeOf || function (e, t) {
        return e.__proto__ = t, e;
      })(e, t);
    }function f(i) {
      var a = function () {
        if ("undefined" == typeof Reflect || !Reflect.construct) return !1;if (Reflect.construct.sham) return !1;if ("function" == typeof Proxy) return !0;try {
          return Date.prototype.toString.call(Reflect.construct(Date, [], function () {})), !0;
        } catch (e) {
          return !1;
        }
      }();return function () {
        var e,
            t,
            n,
            r,
            o = d(i);return t = a ? (e = d(this).constructor, Reflect.construct(o, arguments, e)) : o.apply(this, arguments), n = this, !(r = t) || "object" !== u(r) && "function" != typeof r ? function (e) {
          if (void 0 !== e) return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        }(n) : r;
      };
    }function d(e) {
      return (d = Object.setPrototypeOf ? Object.getPrototypeOf : function (e) {
        return e.__proto__ || Object.getPrototypeOf(e);
      })(e);
    }var o = function () {
      !function (e, t) {
        if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function");e.prototype = Object.create(t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } }), t && l(e, t);
      }(o, i["default"]);var e,
          t,
          n,
          r = f(o);function o() {
        var e,
            t = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : "";return function (e, t) {
          if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
        }(this, o), (e = r.call(this)).className = "", e.childern = [], e.style = { width: "".concat(c.innerWidth, "px"), height: "".concat(c.innerHeight, "px") }, e.insertBefore = a.noop, e.innerHTML = "", e.tagName = t.toUpperCase(), e;
      }return e = o, (t = [{ key: "setAttribute", value: function value(e, t) {
          this[e] = t;
        } }, { key: "getAttribute", value: function value(e) {
          return this[e];
        } }, { key: "getBoundingClientRect", value: function value() {
          return { top: 0, left: 0, width: c.innerWidth, height: c.innerHeight };
        } }, { key: "focus", value: function value() {} }, { key: "clientWidth", get: function get() {
          var e = parseInt(this.style.fontSize, 10) * this.innerHTML.length;return Number.isNaN(e) ? 0 : e;
        } }, { key: "clientHeight", get: function get() {
          var e = parseInt(this.style.fontSize, 10);return Number.isNaN(e) ? 0 : e;
        } }]) && s(e.prototype, t), n && s(e, n), o;
    }();n.default = o, t.exports = n.default;
  }, { "./Element": 26, "./WindowProperties": 43, "./util/index.js": 50 }], 35: [function (e, t, n) {
    "use strict";
    Object.defineProperty(n, "__esModule", { value: !0 }), n.default = void 0;var r;(r = e("./HTMLElement")) && r.__esModule;var o = wx.createImage().constructor;n.default = o, t.exports = n.default;
  }, { "./HTMLElement": 34 }], 36: [function (e, t, n) {
    "use strict";
    Object.defineProperty(n, "__esModule", { value: !0 }), n.default = void 0;var r,
        i = (r = e("./HTMLElement")) && r.__esModule ? r : { default: r };function c(e) {
      return (c = "function" == typeof Symbol && "symbol" == _typeof(Symbol.iterator) ? function (e) {
        return typeof e === "undefined" ? "undefined" : _typeof(e);
      } : function (e) {
        return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e === "undefined" ? "undefined" : _typeof(e);
      })(e);
    }function a(e, t) {
      for (var n = 0; n < t.length; n++) {
        var r = t[n];r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, r.key, r);
      }
    }function u(e, t) {
      return (u = Object.setPrototypeOf || function (e, t) {
        return e.__proto__ = t, e;
      })(e, t);
    }function s(i) {
      var a = function () {
        if ("undefined" == typeof Reflect || !Reflect.construct) return !1;if (Reflect.construct.sham) return !1;if ("function" == typeof Proxy) return !0;try {
          return Date.prototype.toString.call(Reflect.construct(Date, [], function () {})), !0;
        } catch (e) {
          return !1;
        }
      }();return function () {
        var e,
            t,
            n,
            r,
            o = l(i);return t = a ? (e = l(this).constructor, Reflect.construct(o, arguments, e)) : o.apply(this, arguments), n = this, !(r = t) || "object" !== c(r) && "function" != typeof r ? function (e) {
          if (void 0 !== e) return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        }(n) : r;
      };
    }function l(e) {
      return (l = Object.setPrototypeOf ? Object.getPrototypeOf : function (e) {
        return e.__proto__ || Object.getPrototypeOf(e);
      })(e);
    }var o = function () {
      !function (e, t) {
        if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function");e.prototype = Object.create(t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } }), t && u(e, t);
      }(o, i["default"]);var e,
          t,
          n,
          r = s(o);function o(e) {
        return function (e, t) {
          if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
        }(this, o), r.call(this, e);
      }return e = o, (t = [{ key: "addTextTrack", value: function value() {} }, { key: "captureStream", value: function value() {} }, { key: "fastSeek", value: function value() {} }, { key: "load", value: function value() {} }, { key: "pause", value: function value() {} }, { key: "play", value: function value() {} }]) && a(e.prototype, t), n && a(e, n), o;
    }();n.default = o, t.exports = n.default;
  }, { "./HTMLElement": 34 }], 37: [function (e, t, n) {
    "use strict";
    Object.defineProperty(n, "__esModule", { value: !0 }), n.default = void 0;var r,
        o = (r = e("./HTMLMediaElement")) && r.__esModule ? r : { default: r };function c(e) {
      return (c = "function" == typeof Symbol && "symbol" == _typeof(Symbol.iterator) ? function (e) {
        return typeof e === "undefined" ? "undefined" : _typeof(e);
      } : function (e) {
        return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e === "undefined" ? "undefined" : _typeof(e);
      })(e);
    }function i(e, t) {
      return (i = Object.setPrototypeOf || function (e, t) {
        return e.__proto__ = t, e;
      })(e, t);
    }function a(i) {
      var a = function () {
        if ("undefined" == typeof Reflect || !Reflect.construct) return !1;if (Reflect.construct.sham) return !1;if ("function" == typeof Proxy) return !0;try {
          return Date.prototype.toString.call(Reflect.construct(Date, [], function () {})), !0;
        } catch (e) {
          return !1;
        }
      }();return function () {
        var e,
            t,
            n,
            r,
            o = u(i);return t = a ? (e = u(this).constructor, Reflect.construct(o, arguments, e)) : o.apply(this, arguments), n = this, !(r = t) || "object" !== c(r) && "function" != typeof r ? function (e) {
          if (void 0 !== e) return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        }(n) : r;
      };
    }function u(e) {
      return (u = Object.setPrototypeOf ? Object.getPrototypeOf : function (e) {
        return e.__proto__ || Object.getPrototypeOf(e);
      })(e);
    }var s = function () {
      !function (e, t) {
        if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function");e.prototype = Object.create(t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } }), t && i(e, t);
      }(t, o["default"]);var e = a(t);function t() {
        return function (e, t) {
          if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
        }(this, t), e.call(this, "video");
      }return t;
    }();n.default = s, t.exports = n.default;
  }, { "./HTMLMediaElement": 36 }], 38: [function (e, t, n) {
    "use strict";
    Object.defineProperty(n, "__esModule", { value: !0 }), n.default = function () {
      return wx.createImage();
    };var r;(r = e("./HTMLImageElement")) && r.__esModule;t.exports = n.default;
  }, { "./HTMLImageElement": 35 }], 39: [function (e, t, n) {
    "use strict";
    Object.defineProperty(n, "__esModule", { value: !0 }), n.default = void 0;n.default = function e() {
      !function (e, t) {
        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
      }(this, e);
    }, t.exports = n.default;
  }, {}], 40: [function (e, t, n) {
    "use strict";
    Object.defineProperty(n, "__esModule", { value: !0 }), n.default = void 0;var r,
        i = (r = e("./EventTarget.js")) && r.__esModule ? r : { default: r };function c(e) {
      return (c = "function" == typeof Symbol && "symbol" == _typeof(Symbol.iterator) ? function (e) {
        return typeof e === "undefined" ? "undefined" : _typeof(e);
      } : function (e) {
        return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e === "undefined" ? "undefined" : _typeof(e);
      })(e);
    }function a(e, t) {
      for (var n = 0; n < t.length; n++) {
        var r = t[n];r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, r.key, r);
      }
    }function u(e, t) {
      return (u = Object.setPrototypeOf || function (e, t) {
        return e.__proto__ = t, e;
      })(e, t);
    }function s(i) {
      var a = function () {
        if ("undefined" == typeof Reflect || !Reflect.construct) return !1;if (Reflect.construct.sham) return !1;if ("function" == typeof Proxy) return !0;try {
          return Date.prototype.toString.call(Reflect.construct(Date, [], function () {})), !0;
        } catch (e) {
          return !1;
        }
      }();return function () {
        var e,
            t,
            n,
            r,
            o = l(i);return t = a ? (e = l(this).constructor, Reflect.construct(o, arguments, e)) : o.apply(this, arguments), n = this, !(r = t) || "object" !== c(r) && "function" != typeof r ? function (e) {
          if (void 0 !== e) return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
        }(n) : r;
      };
    }function l(e) {
      return (l = Object.setPrototypeOf ? Object.getPrototypeOf : function (e) {
        return e.__proto__ || Object.getPrototypeOf(e);
      })(e);
    }var o = function () {
      !function (e, t) {
        if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function");e.prototype = Object.create(t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } }), t && u(e, t);
      }(o, i["default"]);var e,
          t,
          n,
          r = s(o);function o() {
        var e;return function (e, t) {
          if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
        }(this, o), (e = r.call(this)).childNodes = [], e;
      }return e = o, (t = [{ key: "appendChild", value: function value(e) {
          this.childNodes.push(e);
        } }, { key: "cloneNode", value: function value() {
          var e = Object.create(this);return Object.assign(e, this), e;
        } }, { key: "removeChild", value: function value(t) {
          var e = this.childNodes.findIndex(function (e) {
            return e === t;
          });return -1 < e ? this.childNodes.splice(e, 1) : null;
        } }]) && a(e.prototype, t), n && a(e, n), o;
    }();n.default = o, t.exports = n.default;
  }, { "./EventTarget.js": 30 }], 41: [function (e, t, n) {
    "use strict";
    Object.defineProperty(n, "__esModule", { value: !0 }), n.default = void 0;n.default = function e() {
      !function (e, t) {
        if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
      }(this, e);
    }, t.exports = n.default;
  }, {}], 42: [function (e, t, n) {
    "use strict";
    function r(e, t) {
      for (var n = 0; n < t.length; n++) {
        var r = t[n];r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, r.key, r);
      }
    }Object.defineProperty(n, "__esModule", { value: !0 }), n.default = void 0;var i = new WeakMap(),
        o = function () {
      function o(e) {
        var t = this,
            n = 1 < arguments.length && void 0 !== arguments[1] ? arguments[1] : [];if (!function (e, t) {
          if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
        }(this, o), this.binaryType = "", this.bufferedAmount = 0, this.extensions = "", this.onclose = null, this.onerror = null, this.onmessage = null, this.onopen = null, this.protocol = "", this.readyState = 3, "string" != typeof e || !/(^ws:\/\/)|(^wss:\/\/)/.test(e)) throw new TypeError("Failed to construct 'WebSocket': The URL '".concat(e, "' is invalid"));this.url = e, this.readyState = o.CONNECTING;var r = wx.connectSocket({ url: e, protocols: Array.isArray(n) ? n : [n], tcpNoDelay: !0 });return i.set(this, r), r.onClose(function (e) {
          t.readyState = o.CLOSED, "function" == typeof t.onclose && t.onclose(e);
        }), r.onMessage(function (e) {
          "function" == typeof t.onmessage && t.onmessage(e);
        }), r.onOpen(function () {
          t.readyState = o.OPEN, "function" == typeof t.onopen && t.onopen();
        }), r.onError(function (e) {
          "function" == typeof t.onerror && t.onerror(new Error(e.errMsg));
        }), this;
      }var e, t, n;return e = o, (t = [{ key: "close", value: function value(e, t) {
          this.readyState = o.CLOSING, i.get(this).close({ code: e, reason: t });
        } }, { key: "send", value: function value(e) {
          if (!("string" == typeof e || e instanceof ArrayBuffer || ArrayBuffer.isView(e))) throw new TypeError("Failed to send message: The data ".concat(e, " is invalid"));i.get(this).send({ data: e });
        } }]) && r(e.prototype, t), n && r(e, n), o;
    }();(n.default = o).CONNECTING = 0, o.OPEN = 1, o.CLOSING = 2, o.CLOSED = 3, t.exports = n.default;
  }, {}], 43: [function (e, t, n) {
    "use strict";
    Object.defineProperty(n, "__esModule", { value: !0 }), n.ontouchend = n.ontouchmove = n.ontouchstart = n.performance = n.screen = n.devicePixelRatio = n.innerHeight = n.innerWidth = void 0;var r = wx.getSystemInfoSync(),
        o = r.screenWidth,
        i = r.screenHeight,
        a = r.devicePixelRatio;n.devicePixelRatio = a;var c = o,
        u = i,
        s = { width: o, height: i, availWidth: n.innerWidth = c, availHeight: n.innerHeight = u, availLeft: 0, availTop: 0 };n.screen = s;var l = { now: Date.now };n.performance = l;n.ontouchstart = null;n.ontouchmove = null;n.ontouchend = null;
  }, {}], 44: [function (e, t, n) {
    "use strict";
    Object.defineProperty(n, "__esModule", { value: !0 }), n.default = void 0;var r,
        o = (r = e("./EventTarget.js")) && r.__esModule ? r : { default: r };function c(e) {
      return (c = "function" == typeof Symbol && "symbol" == _typeof(Symbol.iterator) ? function (e) {
        return typeof e === "undefined" ? "undefined" : _typeof(e);
      } : function (e) {
        return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e === "undefined" ? "undefined" : _typeof(e);
      })(e);
    }function i(e, t) {
      for (var n = 0; n < t.length; n++) {
        var r = t[n];r.enumerable = r.enumerable || !1, r.configurable = !0, "value" in r && (r.writable = !0), Object.defineProperty(e, r.key, r);
      }
    }function a(e, t) {
      return (a = Object.setPrototypeOf || function (e, t) {
        return e.__proto__ = t, e;
      })(e, t);
    }function s(i) {
      var a = function () {
        if ("undefined" == typeof Reflect || !Reflect.construct) return !1;if (Reflect.construct.sham) return !1;if ("function" == typeof Proxy) return !0;try {
          return Date.prototype.toString.call(Reflect.construct(Date, [], function () {})), !0;
        } catch (e) {
          return !1;
        }
      }();return function () {
        var e,
            t,
            n,
            r,
            o = u(i);return t = a ? (e = u(this).constructor, Reflect.construct(o, arguments, e)) : o.apply(this, arguments), n = this, !(r = t) || "object" !== c(r) && "function" != typeof r ? l(n) : r;
      };
    }function l(e) {
      if (void 0 === e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;
    }function u(e) {
      return (u = Object.setPrototypeOf ? Object.getPrototypeOf : function (e) {
        return e.__proto__ || Object.getPrototypeOf(e);
      })(e);
    }var f = new WeakMap(),
        d = new WeakMap(),
        p = new WeakMap(),
        h = new WeakMap(),
        m = new WeakMap();function g(e) {
      if ("function" == typeof this["on".concat(e)]) {
        for (var t = arguments.length, n = new Array(1 < t ? t - 1 : 0), r = 1; r < t; r++) {
          n[r - 1] = arguments[r];
        }this["on".concat(e)].apply(this, n);
      }
    }function y(e) {
      this.readyState = e, g.call(this, "readystatechange");
    }var v = function () {
      !function (e, t) {
        if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function");e.prototype = Object.create(t && t.prototype, { constructor: { value: e, writable: !0, configurable: !0 } }), t && a(e, t);
      }(u, o["default"]);var e,
          t,
          n,
          r = s(u);function u() {
        var e;return function (e, t) {
          if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function");
        }(this, u), (e = r.call(this)).timeout = 0, e.onabort = null, e.onerror = null, e.onload = null, e.onloadstart = null, e.onprogress = null, e.ontimeout = null, e.onloadend = null, e.onreadystatechange = null, e.readyState = 0, e.response = null, e.responseText = null, e.responseType = "", e.responseXML = null, e.status = 0, e.statusText = "", e.upload = {}, e.withCredentials = !1, p.set(l(e), { "content-type": "application/x-www-form-urlencoded" }), h.set(l(e), {}), e;
      }return e = u, (t = [{ key: "abort", value: function value() {
          var e = m.get(this);e && e.abort();
        } }, { key: "getAllResponseHeaders", value: function value() {
          var t = h.get(this);return Object.keys(t).map(function (e) {
            return "".concat(e, ": ").concat(t[e]);
          }).join("\n");
        } }, { key: "getResponseHeader", value: function value(e) {
          return h.get(this)[e];
        } }, { key: "open", value: function value(e, t) {
          d.set(this, e), f.set(this, t), y.call(this, u.OPENED);
        } }, { key: "overrideMimeType", value: function value() {} }, { key: "send", value: function value(e) {
          var c = this,
              t = 0 < arguments.length && void 0 !== e ? e : "";if (this.readyState !== u.OPENED) throw new Error("Failed to execute 'send' on 'XMLHttpRequest': The object's state must be OPENED.");var n = wx.request({ data: t, url: f.get(this), method: d.get(this), header: p.get(this), dataType: "other", responseType: "arraybuffer" === this.responseType ? "arraybuffer" : "text", timeout: this.timeout || void 0, success: function success(e) {
              var t = e.data,
                  n = e.statusCode,
                  r = e.header;switch (c.status = n, h.set(c, r), g.call(c, "loadstart"), y.call(c, u.HEADERS_RECEIVED), y.call(c, u.LOADING), c.responseType) {case "json":
                  c.responseText = t;try {
                    c.response = JSON.parse(t);
                  } catch (e) {
                    c.response = null;
                  }break;case "":case "text":
                  c.responseText = c.response = t;break;case "arraybuffer":
                  c.response = t, c.responseText = "";for (var o = new Uint8Array(t), i = o.byteLength, a = 0; a < i; a++) {
                    c.responseText += String.fromCharCode(o[a]);
                  }break;default:
                  c.response = null;}y.call(c, u.DONE), g.call(c, "load"), g.call(c, "loadend");
            }, fail: function fail(e) {
              var t = e.errMsg;-1 !== t.indexOf("abort") ? g.call(c, "abort") : -1 !== t.indexOf("timeout") ? g.call(c, "timeout") : g.call(c, "error", t), g.call(c, "loadend");
            } });m.set(this, n);
        } }, { key: "setRequestHeader", value: function value(e, t) {
          var n = p.get(this);n[e] = t, p.set(this, n);
        } }, { key: "addEventListener", value: function value(e, t) {
          var n;"function" == typeof t && (n = this, this["on" + e] = function (e) {
            t.call(n, e);
          });
        } }]) && i(e.prototype, t), n && i(e, n), u;
    }();(n.default = v).UNSEND = 0, v.OPENED = 1, v.HEADERS_RECEIVED = 2, v.LOADING = 3, v.DONE = 4, t.exports = n.default;
  }, { "./EventTarget.js": 30 }], 45: [function (e, t, n) {
    "use strict";
    function a(e) {
      return (a = "function" == typeof Symbol && "symbol" == _typeof(Symbol.iterator) ? function (e) {
        return typeof e === "undefined" ? "undefined" : _typeof(e);
      } : function (e) {
        return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e === "undefined" ? "undefined" : _typeof(e);
      })(e);
    }Object.defineProperty(n, "__esModule", { value: !0 }), n.default = void 0;var r = function (e) {
      if (e && e.__esModule) return e;if (null === e || "object" !== a(e) && "function" != typeof e) return { default: e };var t = f();if (t && t.has(e)) return t.get(e);var n = {},
          r = Object.defineProperty && Object.getOwnPropertyDescriptor;for (var o in e) {
        var i;Object.prototype.hasOwnProperty.call(e, o) && ((i = r ? Object.getOwnPropertyDescriptor(e, o) : null) && (i.get || i.set) ? Object.defineProperty(n, o, i) : n[o] = e[o]);
      }n.default = e, t && t.set(e, n);return n;
    }(e("./window")),
        o = l(e("./HTMLElement")),
        i = l(e("./HTMLVideoElement")),
        c = l(e("./Image")),
        u = l(e("./Audio")),
        s = l(e("./Canvas"));function l(e) {
      return e && e.__esModule ? e : { default: e };
    }function f() {
      if ("function" != typeof WeakMap) return null;var e = new WeakMap();return f = function f() {
        return e;
      }, e;
    }e("./EventIniter/index.js");var d = {},
        p = { readyState: "complete", visibilityState: "visible", documentElement: r, hidden: !1, style: {}, location: r.location, ontouchstart: null, ontouchmove: null, ontouchend: null, head: new o.default("head"), body: new o.default("body"), createElement: function createElement(e) {
        return "canvas" === e ? new s.default() : "audio" === e ? new u.default() : "img" === e ? new c.default() : "video" === e ? new i.default() : new o.default(e);
      }, createElementNS: function createElementNS(e, t) {
        return this.createElement(t);
      }, getElementById: function getElementById(e) {
        return e === r.canvas.id ? r.canvas : null;
      }, getElementsByTagName: function getElementsByTagName(e) {
        return "head" === e ? [p.head] : "body" === e ? [p.body] : "canvas" === e ? [r.canvas] : [];
      }, getElementsByName: function getElementsByName(e) {
        return "head" === e ? [p.head] : "body" === e ? [p.body] : "canvas" === e ? [r.canvas] : [];
      }, querySelector: function querySelector(e) {
        return "head" === e ? p.head : "body" === e ? p.body : "canvas" === e || e === "#".concat(r.canvas.id) ? r.canvas : null;
      }, querySelectorAll: function querySelectorAll(e) {
        return "head" === e ? [p.head] : "body" === e ? [p.body] : "canvas" === e ? [r.canvas] : [];
      }, addEventListener: function addEventListener(e, t) {
        d[e] || (d[e] = []), d[e].push(t);
      }, removeEventListener: function removeEventListener(e, t) {
        var n = d[e];if (n && 0 < n.length) for (var r = n.length; r--;) {
          if (n[r] === t) {
            n.splice(r, 1);break;
          }
        }
      }, dispatchEvent: function dispatchEvent(e) {
        var t = d[e.type];if (t) for (var n = 0; n < t.length; n++) {
          t[n](e);
        }
      } };n.default = p, t.exports = n.default;
  }, { "./Audio": 24, "./Canvas": 25, "./EventIniter/index.js": 29, "./HTMLElement": 34, "./HTMLVideoElement": 37, "./Image": 38, "./window": 51 }], 46: [function (e, t, n) {
    "use strict";
    function a(e) {
      return (a = "function" == typeof Symbol && "symbol" == _typeof(Symbol.iterator) ? function (e) {
        return typeof e === "undefined" ? "undefined" : _typeof(e);
      } : function (e) {
        return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e === "undefined" ? "undefined" : _typeof(e);
      })(e);
    }var c = function (e) {
      if (e && e.__esModule) return e;if (null === e || "object" !== a(e) && "function" != typeof e) return { default: e };var t = s();if (t && t.has(e)) return t.get(e);var n = {},
          r = Object.defineProperty && Object.getOwnPropertyDescriptor;for (var o in e) {
        var i;Object.prototype.hasOwnProperty.call(e, o) && ((i = r ? Object.getOwnPropertyDescriptor(e, o) : null) && (i.get || i.set) ? Object.defineProperty(n, o, i) : n[o] = e[o]);
      }n.default = e, t && t.set(e, n);return n;
    }(e("./window")),
        u = r(e("./document"));r(e("./HTMLElement"));function r(e) {
      return e && e.__esModule ? e : { default: e };
    }function s() {
      if ("function" != typeof WeakMap) return null;var e = new WeakMap();return s = function s() {
        return e;
      }, e;
    }var l = GameGlobal;GameGlobal.__isAdapterInjected || (GameGlobal.__isAdapterInjected = !0, function () {
      c.document = u.default, c.addEventListener = function (e, t) {
        c.document.addEventListener(e, t);
      }, c.removeEventListener = function (e, t) {
        c.document.removeEventListener(e, t);
      }, c.dispatchEvent = c.document.dispatchEvent;var e = wx.getSystemInfoSync().platform;if ("undefined" == typeof __devtoolssubcontext && "devtools" === e) {
        for (var t in c) {
          var n = Object.getOwnPropertyDescriptor(l, t);n && !0 !== n.configurable || Object.defineProperty(window, t, { value: c[t] });
        }for (var r in c.document) {
          var o = Object.getOwnPropertyDescriptor(l.document, r);o && !0 !== o.configurable || Object.defineProperty(l.document, r, { value: c.document[r] });
        }window.parent = window;
      } else {
        for (var i in c) {
          l[i] = c[i];
        }l.window = c, window = l, window.top = window.parent = window;
      }
    }());
  }, { "./HTMLElement": 34, "./document": 45, "./window": 51 }], 47: [function (e, t, n) {
    "use strict";
    Object.defineProperty(n, "__esModule", { value: !0 }), n.default = void 0;var r = { get length() {
        return wx.getStorageInfoSync().keys.length;
      }, key: function key(e) {
        return wx.getStorageInfoSync().keys[e];
      }, getItem: function getItem(e) {
        return wx.getStorageSync(e);
      }, setItem: function setItem(e, t) {
        return wx.setStorageSync(e, t);
      }, removeItem: function removeItem(e) {
        wx.removeStorageSync(e);
      }, clear: function clear() {
        wx.clearStorageSync();
      } };n.default = r, t.exports = n.default;
  }, {}], 48: [function (e, t, n) {
    "use strict";
    Object.defineProperty(n, "__esModule", { value: !0 }), n.default = void 0;var r = { href: "game.js", reload: function reload() {} };n.default = r, t.exports = n.default;
  }, {}], 49: [function (e, t, n) {
    "use strict";
    Object.defineProperty(n, "__esModule", { value: !0 }), n.default = void 0;var r = e("./util/index.js"),
        o = wx.getSystemInfoSync();console.log(o);var i = o.system,
        a = o.platform,
        c = o.language,
        u = o.version,
        s = -1 !== i.toLowerCase().indexOf("android") ? "Android; CPU ".concat(i) : "iPhone; CPU iPhone OS ".concat(i, " like Mac OS X"),
        l = "Mozilla/5.0 (".concat(s, ") AppleWebKit/603.1.30 (KHTML, like Gecko) Mobile/14E8301 MicroMessenger/").concat(u, " MiniGame NetType/WIFI Language/").concat(c),
        f = { platform: a, language: c, appVersion: "5.0 (".concat(s, ") AppleWebKit/601.1.46 (KHTML, like Gecko) Version/9.0 Mobile/13B143 Safari/601.1"), userAgent: l, onLine: !0, geolocation: { getCurrentPosition: r.noop, watchPosition: r.noop, clearWatch: r.noop } };wx.onNetworkStatusChange && wx.onNetworkStatusChange(function (e) {
      f.onLine = e.isConnected;
    }), n.default = f, t.exports = n.default;
  }, { "./util/index.js": 50 }], 50: [function (e, t, n) {
    "use strict";
    Object.defineProperty(n, "__esModule", { value: !0 }), n.noop = function () {};
  }, {}], 51: [function (e, t, n) {
    "use strict";
    Object.defineProperty(n, "__esModule", { value: !0 });var r = { canvas: !0, setTimeout: !0, setInterval: !0, clearTimeout: !0, clearInterval: !0, requestAnimationFrame: !0, cancelAnimationFrame: !0, navigator: !0, XMLHttpRequest: !0, WebSocket: !0, Image: !0, ImageBitmap: !0, Audio: !0, FileReader: !0, HTMLElement: !0, HTMLImageElement: !0, HTMLCanvasElement: !0, HTMLMediaElement: !0, HTMLAudioElement: !0, HTMLVideoElement: !0, WebGLRenderingContext: !0, TouchEvent: !0, MouseEvent: !0, DeviceMotionEvent: !0, localStorage: !0, location: !0 };Object.defineProperty(n, "navigator", { enumerable: !0, get: function get() {
        return i.default;
      } }), Object.defineProperty(n, "XMLHttpRequest", { enumerable: !0, get: function get() {
        return a.default;
      } }), Object.defineProperty(n, "WebSocket", { enumerable: !0, get: function get() {
        return c.default;
      } }), Object.defineProperty(n, "Image", { enumerable: !0, get: function get() {
        return u.default;
      } }), Object.defineProperty(n, "ImageBitmap", { enumerable: !0, get: function get() {
        return s.default;
      } }), Object.defineProperty(n, "Audio", { enumerable: !0, get: function get() {
        return l.default;
      } }), Object.defineProperty(n, "FileReader", { enumerable: !0, get: function get() {
        return f.default;
      } }), Object.defineProperty(n, "HTMLElement", { enumerable: !0, get: function get() {
        return d.default;
      } }), Object.defineProperty(n, "HTMLImageElement", { enumerable: !0, get: function get() {
        return p.default;
      } }), Object.defineProperty(n, "HTMLCanvasElement", { enumerable: !0, get: function get() {
        return h.default;
      } }), Object.defineProperty(n, "HTMLMediaElement", { enumerable: !0, get: function get() {
        return m.default;
      } }), Object.defineProperty(n, "HTMLAudioElement", { enumerable: !0, get: function get() {
        return g.default;
      } }), Object.defineProperty(n, "HTMLVideoElement", { enumerable: !0, get: function get() {
        return y.default;
      } }), Object.defineProperty(n, "WebGLRenderingContext", { enumerable: !0, get: function get() {
        return v.default;
      } }), Object.defineProperty(n, "TouchEvent", { enumerable: !0, get: function get() {
        return b.TouchEvent;
      } }), Object.defineProperty(n, "MouseEvent", { enumerable: !0, get: function get() {
        return b.MouseEvent;
      } }), Object.defineProperty(n, "DeviceMotionEvent", { enumerable: !0, get: function get() {
        return b.DeviceMotionEvent;
      } }), Object.defineProperty(n, "localStorage", { enumerable: !0, get: function get() {
        return w.default;
      } }), Object.defineProperty(n, "location", { enumerable: !0, get: function get() {
        return _.default;
      } }), n.cancelAnimationFrame = n.requestAnimationFrame = n.clearInterval = n.clearTimeout = n.setInterval = n.setTimeout = n.canvas = void 0;var o = x(e("./Canvas")),
        i = x(e("./navigator")),
        a = x(e("./XMLHttpRequest")),
        c = x(e("./WebSocket")),
        u = x(e("./Image")),
        s = x(e("./ImageBitmap")),
        l = x(e("./Audio")),
        f = x(e("./FileReader")),
        d = x(e("./HTMLElement")),
        p = x(e("./HTMLImageElement")),
        h = x(e("./HTMLCanvasElement")),
        m = x(e("./HTMLMediaElement")),
        g = x(e("./HTMLAudioElement")),
        y = x(e("./HTMLVideoElement")),
        v = x(e("./WebGLRenderingContext")),
        b = e("./EventIniter/index.js"),
        w = x(e("./localStorage")),
        _ = x(e("./location")),
        E = e("./WindowProperties");function x(e) {
      return e && e.__esModule ? e : { default: e };
    }Object.keys(E).forEach(function (e) {
      "default" !== e && "__esModule" !== e && (Object.prototype.hasOwnProperty.call(r, e) || Object.defineProperty(n, e, { enumerable: !0, get: function get() {
          return E[e];
        } }));
    }), GameGlobal.screencanvas = GameGlobal.screencanvas || new o.default();var S = GameGlobal.screencanvas;n.canvas = S;var T = GameGlobal,
        N = T.setTimeout,
        O = T.setInterval,
        M = T.clearTimeout,
        C = T.clearInterval,
        A = T.requestAnimationFrame,
        D = T.cancelAnimationFrame;n.cancelAnimationFrame = D, n.requestAnimationFrame = A, n.clearInterval = C, n.clearTimeout = M, n.setInterval = O, n.setTimeout = N;
  }, { "./Audio": 24, "./Canvas": 25, "./EventIniter/index.js": 29, "./FileReader": 31, "./HTMLAudioElement": 32, "./HTMLCanvasElement": 33, "./HTMLElement": 34, "./HTMLImageElement": 35, "./HTMLMediaElement": 36, "./HTMLVideoElement": 37, "./Image": 38, "./ImageBitmap": 39, "./WebGLRenderingContext": 41, "./WebSocket": 42, "./WindowProperties": 43, "./XMLHttpRequest": 44, "./localStorage": 47, "./location": 48, "./navigator": 49 }], 52: [function (e, t, n) {
    "use strict";
    e("./VideoPlayer"), e("./pc-adapter");
  }, { "./VideoPlayer": 1, "./pc-adapter": 53 }], 53: [function (e, t, n) {
    "use strict";
    var r = wx.getSystemInfoSync(),
        i = cc.internal.inputManager,
        a = cc.internal.eventManager,
        c = cc.Event.EventKeyboard,
        u = cc.Event.EventMouse,
        o = { backspace: 8, tab: 9, enter: 13, shift: 16, control: 17, alt: 18, pause: 19, capslock: 20, escape: 27, " ": 32, pageup: 33, pagedown: 34, end: 35, home: 36, arrowleft: 37, arrowup: 38, arrowright: 39, arrowdown: 40, insert: 45, a: 65, b: 66, c: 67, d: 68, e: 69, f: 70, g: 71, h: 72, i: 73, j: 74, k: 75, l: 76, m: 77, n: 78, o: 79, p: 80, q: 81, r: 82, s: 83, t: 84, u: 85, v: 86, w: 87, x: 88, y: 89, z: 90, "*": 106, "+": 107, "-": 109, "/": 111, f1: 112, f2: 113, f3: 114, f4: 115, f5: 116, f6: 117, f7: 118, f8: 119, f9: 120, f10: 121, f11: 122, f12: 123, numlock: 144, scrolllock: 145, ";": 186, "=": 187, ",": 188, ".": 190, "`": 192, "[": 219, "\\": 220, "]": 221, "'": 222 },
        s = { Delete: 46, Digit0: 48, Digit1: 49, Digit2: 50, Digit3: 51, Digit4: 52, Digit5: 53, Digit6: 54, Digit7: 55, Digit8: 56, Digit9: 57, Numpad0: 96, Numpad1: 97, Numpad2: 98, Numpad3: 99, Numpad4: 100, Numpad5: 101, Numpad6: 102, Numpad7: 103, Numpad8: 104, Numpad9: 105, NumpadDecimal: 110 };function l(e) {
      var t = e.key.toLowerCase(),
          n = e.code;return (/^\d$/.test(t) || "delete" === t ? s[n] : o[t] || 0
      );
    }__globalAdapter.isSubContext || "windows" !== r.platform || (i.registerSystemEvent = function () {
      var o;function e(e, n, r) {
        wx[e](function (e) {
          var t = i.getMouseEvent(e, o, n);t.setButton(e.button || 0), r(e, t), a.dispatchEvent(t);
        });
      }this._isRegisterEvent || (this._glView = cc.view, wx.onKeyDown(function (e) {
        return a.dispatchEvent(new c(l(e), !0));
      }), wx.onKeyUp(function (e) {
        return a.dispatchEvent(new c(l(e), !1));
      }), o = { top: 0, left: 0, width: window.innerWidth, height: window.innerHeight }, e("onMouseDown", u.DOWN, function (e, t) {
        i._mousePressed = !0, i.handleTouchesBegin([i.getTouchByXY(e.x, e.y, o)]);
      }), e("onMouseUp", u.UP, function (e, t) {
        i._mousePressed = !1, i.handleTouchesEnd([i.getTouchByXY(e.x, e.y, o)]);
      }), e("onMouseMove", u.MOVE, function (e, t) {
        i.handleTouchesMove([i.getTouchByXY(e.x, e.y, o)]), i._mousePressed || t.setButton(null);
      }), e("onWheel", u.SCROLL, function (e, t) {
        t.setScrollData(0, -e.deltaY);
      }), this._isRegisterEvent = !0);
    });
  }, {}], 54: [function (e, t, n) {
    "use strict";
    wx.onError && wx.onError(function e(t) {
      wx.offError && wx.offError(e);var n,
          r,
          o,
          i,
          a = Math.random() < .01;!__globalAdapter.isSubContext && a && (!(n = wx.getSystemInfoSync()) || (r = cc.Canvas.instance.node) && ((o = new cc.Node()).color = cc.Color.BLACK, i = o.addComponent(cc.Label), o.height = r.height - 60, o.width = r.width - 60, i.overflow = cc.Label.Overflow.SHRINK, i.horizontalAlign = cc.Label.HorizontalAlign.LEFT, i.verticalAlign = cc.Label.VerticalAlign.TOP, i.fontSize = 24, i.string = "Please send this screenshot to the game developer\nPlatform: WeChat " + n.version + "\nEngine: Cocos Creator v" + window.CocosEngine + "\nDevice: " + n.brand + " " + n.model + " System: " + n.system + "\nError:\n" + t.message, cc.LabelOutline && (o.addComponent(cc.LabelOutline).color = cc.Color.WHITE), o.once("touchend", function () {
        o.destroy(), setTimeout(function () {
          cc.director.resume();
        }, 1e3);
      }), o.parent = r, cc.director.pause()));
    });
  }, {}], 55: [function (e, t, n) {
    "use strict";
    var o = wx.getFileSystemManager ? wx.getFileSystemManager() : null,
        c = { fs: o, getUserDataPath: function getUserDataPath() {
        return wx.env.USER_DATA_PATH;
      }, checkFsValid: function checkFsValid() {
        return !!o || (console.warn("can not get the file system!"), !1);
      }, deleteFile: function deleteFile(t, n) {
        o.unlink({ filePath: t, success: function success() {
            n && n(null);
          }, fail: function fail(e) {
            console.warn("Delete file failed: path: ".concat(t, " message: ").concat(e.errMsg)), n && n(new Error(e.errMsg));
          } });
      }, downloadFile: function downloadFile(t, e, n, r, o) {
        var i = { url: t, success: function success(e) {
            200 === e.statusCode ? o && o(null, e.tempFilePath || e.filePath) : (e.filePath && c.deleteFile(e.filePath), console.warn("Download file failed: path: ".concat(t, " message: ").concat(e.statusCode)), o && o(new Error(e.statusCode), null));
          }, fail: function fail(e) {
            console.warn("Download file failed: path: ".concat(t, " message: ").concat(e.errMsg)), o && o(new Error(e.errMsg), null);
          } };e && (i.filePath = e), n && (i.header = n);var a = wx.downloadFile(i);r && a.onProgressUpdate(r);
      }, saveFile: function saveFile(t, e, n) {
        wx.saveFile({ tempFilePath: t, filePath: e, success: function success() {
            n && n(null);
          }, fail: function fail(e) {
            console.warn("Save file failed: path: ".concat(t, " message: ").concat(e.errMsg)), n && n(new Error(e.errMsg));
          } });
      }, copyFile: function copyFile(t, e, n) {
        o.copyFile({ srcPath: t, destPath: e, success: function success() {
            n && n(null);
          }, fail: function fail(e) {
            console.warn("Copy file failed: path: ".concat(t, " message: ").concat(e.errMsg)), n && n(new Error(e.errMsg));
          } });
      }, writeFile: function writeFile(t, e, n, r) {
        o.writeFile({ filePath: t, encoding: n, data: e, success: function success() {
            r && r(null);
          }, fail: function fail(e) {
            console.warn("Write file failed: path: ".concat(t, " message: ").concat(e.errMsg)), r && r(new Error(e.errMsg));
          } });
      }, writeFileSync: function writeFileSync(t, e, n) {
        try {
          return o.writeFileSync(t, e, n), null;
        } catch (e) {
          return console.warn("Write file failed: path: ".concat(t, " message: ").concat(e.message)), new Error(e.message);
        }
      }, readFile: function readFile(t, e, n) {
        o.readFile({ filePath: t, encoding: e, success: function success(e) {
            n && n(null, e.data);
          }, fail: function fail(e) {
            console.warn("Read file failed: path: ".concat(t, " message: ").concat(e.errMsg)), n && n(new Error(e.errMsg), null);
          } });
      }, readDir: function readDir(t, n) {
        o.readdir({ dirPath: t, success: function success(e) {
            n && n(null, e.files);
          }, fail: function fail(e) {
            console.warn("Read directory failed: path: ".concat(t, " message: ").concat(e.errMsg)), n && n(new Error(e.errMsg), null);
          } });
      }, readText: function readText(e, t) {
        c.readFile(e, "utf8", t);
      }, readArrayBuffer: function readArrayBuffer(e, t) {
        c.readFile(e, "", t);
      }, readJson: function readJson(r, o) {
        c.readFile(r, "utf8", function (t, e) {
          var n = null;if (!t) try {
            n = JSON.parse(e);
          } catch (e) {
            console.warn("Read json failed: path: ".concat(r, " message: ").concat(e.message)), t = new Error(e.message);
          }o && o(t, n);
        });
      }, readJsonSync: function readJsonSync(t) {
        try {
          var e = o.readFileSync(t, "utf8");return JSON.parse(e);
        } catch (e) {
          return console.warn("Read json failed: path: ".concat(t, " message: ").concat(e.message)), new Error(e.message);
        }
      }, makeDirSync: function makeDirSync(t, e) {
        try {
          return o.mkdirSync(t, e), null;
        } catch (e) {
          return console.warn("Make directory failed: path: ".concat(t, " message: ").concat(e.message)), new Error(e.message);
        }
      }, rmdirSync: function rmdirSync(t, e) {
        try {
          o.rmdirSync(t, e);
        } catch (e) {
          return console.warn("rm directory failed: path: ".concat(t, " message: ").concat(e.message)), new Error(e.message);
        }
      }, exists: function exists(e, t) {
        o.access({ path: e, success: function success() {
            t && t(!0);
          }, fail: function fail() {
            t && t(!1);
          } });
      }, loadSubpackage: function loadSubpackage(t, e, n) {
        var r = wx.loadSubpackage({ name: t, success: function success() {
            n && n();
          }, fail: function fail(e) {
            console.warn("Load Subpackage failed: path: ".concat(t, " message: ").concat(e.errMsg)), n && n(new Error("Failed to load subpackage ".concat(t, ": ").concat(e.errMsg)));
          } });return e && r.onProgressUpdate(e), r;
      }, unzip: function unzip(t, e, n) {
        o.unzip({ zipFilePath: t, targetPath: e, success: function success() {
            n && n(null);
          }, fail: function fail(e) {
            console.warn("unzip failed: path: ".concat(t, " message: ").concat(e.errMsg)), n && n(new Error("unzip failed: " + e.errMsg));
          } });
      } };window.fsUtils = t.exports = c;
  }, {}], 56: [function (e, t, n) {
    "use strict";
    var a = window.__globalAdapter,
        r = wx.getSystemInfoSync(),
        o = a.adaptSys;Object.assign(a, { adaptSys: function adaptSys(e) {
        var t;o.call(this, e), "windows" === r.platform ? (e.isMobile = !1, e.os = e.OS_WINDOWS) : a.isDevTool && (-1 < (t = r.system.toLowerCase()).indexOf("android") ? e.os = e.OS_ANDROID : -1 < t.indexOf("ios") && (e.os = e.OS_IOS)), wx.getOpenDataContext ? e.platform = e.WECHAT_GAME : e.platform = e.WECHAT_GAME_SUB, e.glExtension = function (e) {
          return "OES_texture_float" !== e && !!cc.renderer.device.ext(e);
        }, e.getSafeAreaRect = function () {
          var e = cc.view,
              t = a.getSafeArea(),
              n = e.getFrameSize(),
              r = new cc.Vec2(t.left, t.bottom),
              o = new cc.Vec2(t.right, t.top),
              i = { left: 0, top: 0, width: n.width, height: n.height };return e.convertToLocationInView(r.x, r.y, i, r), e.convertToLocationInView(o.x, o.y, i, o), e._convertPointWithScale(r), e._convertPointWithScale(o), cc.rect(r.x, r.y, o.x - r.x, o.y - r.y);
        };
      } });
  }, {}], 57: [function (e, t, n) {
    "use strict";
    var u,
        s,
        r,
        l,
        f,
        o,
        a,
        i = e("../../../common/utils");window.__globalAdapter && (u = window.__globalAdapter, r = (s = wx.getSystemInfoSync()).windowWidth, l = s.windowHeight, f = l < r, u.isSubContext = void 0 === wx.getOpenDataContext, u.isDevTool = "devtools" === s.platform, i.cloneMethod(u, wx, "getSystemInfoSync"), i.cloneMethod(u, wx, "onTouchStart"), i.cloneMethod(u, wx, "onTouchMove"), i.cloneMethod(u, wx, "onTouchEnd"), i.cloneMethod(u, wx, "onTouchCancel"), i.cloneMethod(u, wx, "createInnerAudioContext"), i.cloneMethod(u, wx, "onAudioInterruptionEnd"), i.cloneMethod(u, wx, "onAudioInterruptionBegin"), i.cloneMethod(u, wx, "createVideo"), i.cloneMethod(u, wx, "setPreferredFramesPerSecond"), i.cloneMethod(u, wx, "showKeyboard"), i.cloneMethod(u, wx, "hideKeyboard"), i.cloneMethod(u, wx, "updateKeyboard"), i.cloneMethod(u, wx, "onKeyboardInput"), i.cloneMethod(u, wx, "onKeyboardConfirm"), i.cloneMethod(u, wx, "onKeyboardComplete"), i.cloneMethod(u, wx, "offKeyboardInput"), i.cloneMethod(u, wx, "offKeyboardConfirm"), i.cloneMethod(u, wx, "offKeyboardComplete"), i.cloneMethod(u, wx, "getOpenDataContext"), i.cloneMethod(u, wx, "onMessage"), i.cloneMethod(u, wx, "getSharedCanvas"), i.cloneMethod(u, wx, "loadFont"), i.cloneMethod(u, wx, "onShow"), i.cloneMethod(u, wx, "onHide"), i.cloneMethod(u, wx, "onError"), i.cloneMethod(u, wx, "offError"), o = !1, a = 1, wx.onDeviceOrientationChange && wx.onDeviceOrientationChange(function (e) {
      "landscape" === e.value ? a = 1 : "landscapeReverse" === e.value && (a = -1);
    }), Object.assign(u, { startAccelerometer: function startAccelerometer(i) {
        o ? wx.startAccelerometer && wx.startAccelerometer({ fail: function fail(e) {
            console.error("start accelerometer failed", e);
          } }) : (o = !0, wx.onAccelerometerChange && wx.onAccelerometerChange(function (e) {
          var t,
              n = {},
              r = e.x,
              o = e.y;f && (t = r, r = -o, o = t), n.x = r * a, n.y = o * a, n.z = e.z, i && i(n);
        }));
      }, stopAccelerometer: function stopAccelerometer() {
        wx.stopAccelerometer && wx.stopAccelerometer({ fail: function fail(e) {
            console.error("stop accelerometer failed", e);
          } });
      } }), u.getSafeArea = function () {
      var e,
          t = s.safeArea,
          n = t.top,
          r = t.left,
          o = t.bottom,
          i = t.right,
          a = t.width,
          c = t.height;return "ios" === s.platform && !u.isDevTool && f && (n = l - (e = [i, n, r, o, a, c])[0], r = e[1], o = l - e[2], i = e[3], c = e[4], a = e[5]), { top: n, left: r, bottom: o, right: i, width: a, height: c };
    });
  }, { "../../../common/utils": 18 }] }, {}, [23]);
});
define("assets/internal/index.js", function(require, module, exports){
(function r(e, n, t) {
  function i(u, f) {
    if (!n[u]) {
      if (!e[u]) {
        var _ = u.split("/");if (_ = _[_.length - 1], !e[_]) {
          var p = "function" == typeof __require && __require;if (!f && p) return p(_, !0);if (o) return o(_, !0);throw new Error("Cannot find module '" + u + "'");
        }u = _;
      }var a = n[u] = { exports: {} };e[u][0].call(a.exports, function (r) {
        return i(e[u][1][r] || r);
      }, a, a.exports, r, e, n, t);
    }return n[u].exports;
  }for (var o = "function" == typeof __require && __require, u = 0; u < t.length; u++) {
    i(t[u]);
  }return i;
})({}, {}, []);
});
define("assets/main/index.js", function(require, module, exports){
var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

window.__require = function t(e, n, o) {
  function i(a, s) {
    if (!n[a]) {
      if (!e[a]) {
        var c = a.split("/");if (c = c[c.length - 1], !e[c]) {
          var l = "function" == typeof __require && __require;if (!s && l) return l(c, !0);if (r) return r(c, !0);throw new Error("Cannot find module '" + a + "'");
        }a = c;
      }var u = n[a] = { exports: {} };e[a][0].call(u.exports, function (t) {
        return i(e[a][1][t] || t);
      }, u, u.exports, t, e, n, o);
    }return n[a].exports;
  }for (var r = "function" == typeof __require && __require, a = 0; a < o.length; a++) {
    i(o[a]);
  }return i;
}({ AbsConfig: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "12bde76KGJFSr//o4VoXRSJ", "AbsConfig"), Object.defineProperty(n, "__esModule", { value: !0 });var o = t("./ConfigManager"),
        i = t("../Core/TextConfigRead"),
        r = function () {
      function t(t) {
        if (this._dicList = null, this._list = null, null != t) {
          this._dicList = new Map(), this._list = new Array();for (var e = new i.default(o.default.ins.getConfigString(t.cfgFile)), n = e.children.length, r = 0; r < n; r++) {
            var a = new t(e.children[r]);this._dicList.set(a.id, a), this._list.push(a);
          }
        }
      }return t.prototype.getItem = function (t) {
        return this._dicList.has(t) ? this._dicList.get(t) : null;
      }, t.prototype.getConfMap = function () {
        return this._dicList;
      }, t.prototype.getConfList = function () {
        return this._list;
      }, t.prototype.getListItem = function (t) {
        return this._list[t];
      }, t.prototype.getList = function () {
        return this._list;
      }, t;
    }();n.default = r, cc._RF.pop();
  }, { "../Core/TextConfigRead": "TextConfigRead", "./ConfigManager": "ConfigManager" }], AbsDashController: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "5694bmtdfVD4YMDACgQZh43", "AbsDashController");var _o,
        i = this && this.__extends || (_o = function o(t, e) {
      return (_o = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("../../Common/Util/ComponentUtil"),
        a = t("../Config/GameConfig"),
        s = t("../../Common/Util/MathUtil"),
        c = t("./HeroActor"),
        l = t("./StageActor"),
        u = t("./MusicController"),
        f = t("../Manager/GameManager"),
        d = t("./HitSkyEffect"),
        h = t("./HitEffect"),
        p = t("../../Common/Sdks/GameSDK"),
        _ = t("../../Common/Manager/Logger"),
        m = t("../Manager/CommandController"),
        g = function (t) {
      function e(e) {
        var n = t.call(this) || this;return n._stages = [], n._score = 0, n._scoreRatio = 1, n._type = 0, n._hitGold = 0, n._rhythmTime = 0, n._reviveSafeTime = 0, n._stepIdx = 0, n._offsetPara = 0, n._stageLayoutIdx = Math.random() > .5 ? 1 : 3, n._nextStageLayout = 0, n._moveFx = 1, n._jiaoziIdx = 8 + s.default.randomInt(0, 5), n.initNodes(e), n._musicCtrl = u.MusicController.ins, n.lockCamera(!0), n;
      }return i(e, t), e.prototype.firstStart = function () {
        this._firstStart || (_.default.log("=>  firstStart"), m.default.fbStart(null, null), this._firstStart = !0);
      }, Object.defineProperty(e.prototype, "stepIdx", { get: function get() {
          return this._stepIdx;
        }, enumerable: !1, configurable: !0 }), e.prototype.initNodes = function (t) {
        var e = t.getChildByName("sceneNode");this._scene = new cc.Node(), this._camera = r.default.getComponent(cc.Camera, t, "camera"), this._camera.node.eulerAngles = cc.v3(-17.5, 0, 0), this._uiCamera = r.default.getComponent(cc.Camera, t, "skyCamera"), this._hero = c.default.ins, this._hero.eulerAngles = cc.v3(0, 180, 0), this._tipsNode = r.default.getNode(t, "tips"), this._tipsNode.y = -430, this._tipsNode.active = !0, this._hero.parent != e && (this._hero.removeFromParent(), e.addChild(this._hero)), e.addChild(this._scene);
      }, e.prototype.initScene = function () {
        this._rhythm = this._musicCtrl.rhythms, this._index = 0, this._stepIdx = a.default.ShowStageNum;for (var t = 0; t < a.default.ShowStageNum; t++) {
          var e = this.createStage(this._rhythm[t], t);e.actorId = t, this._scene.addChild(e), this._stages.push(e), e.appear();
        }this._isInited = !0, this.initSceneComplete();
      }, e.prototype.autoRun = function () {
        this._tipsNode.active = !1, this._running = !0, this._musicCtrl.setCurrentTime(0), this._musicCtrl.mute = !1, this._musicCtrl.rewind(), this.firstStart(), this.nextRhythm();
      }, e.prototype.initSceneComplete = function () {}, e.prototype.startGame = function () {}, e.prototype.lockCamera = function (t) {
        void 0 === t && (t = !1);var e = this._camera.node,
            n = .6 * this._hero.x;t || (n = e.position.x + .1 * (n - e.position.x)), e.position = cc.v3(n, 9, this._hero.z + 20.5);
      }, e.prototype.onTouchStartHandler = function () {
        this._isInited && this._playing && (this._isTouched || (this._running || (this._tipsNode.active = !1, this._running = !0, this._isRevive ? (this._musicCtrl.resume(), this._hero.jump(this._stepTime), this._reviveSafeTime = a.default.ReviveSafeTime) : (this._musicCtrl.setCurrentTime(0), this._musicCtrl.mute = !1, this._musicCtrl.rewind(), this.firstStart(), this.nextRhythm())), this._isTouched = !0));
      }, e.prototype.onTouchMoveHandler = function (t) {
        if (this._isTouched && this._running && !this._hero.isDizzy) {
          var e = this._hero.x + t.getDeltaX() / cc.view.getDesignResolutionSize().width * a.default.MovingDiameter * a.default.MovingDelicacy;this._hero.x = s.default.clamp(e, -a.default.MovingDiameter / 2, a.default.MovingDiameter / 2);
        }
      }, e.prototype.onTouchEndHandler = function () {
        this._isTouched = !1;
      }, e.prototype.update = function (t) {
        if (this._playing && this._running) {
          var e = this._musicCtrl.getCurrentTime();if (this._reviveSafeTime > 0 && (this._reviveSafeTime -= t), this._musicCtrl.update(t), e >= this._rhythmTime) if (this._hero.y = 0, this._isRevive) this._isRevive = !1;else {
            var n = this.getCurStage(this._index - 1);if (n) {
              var o = Math.abs(this._hero.position.x - n.position.x);if (o > 2 * n.size) {
                if (this._reviveSafeTime <= 0) return void this.gameOver(!1);this.hitSkyEffect(cc.v3(this._hero.x, 0, this._hero.z));
              } else {
                if (n.itemType == a.StageItemType.Obstacle) return void this.collide();var i = 3;o < .5 ? i = 1 : o < 1.1 && (i = 2), this.hitEffect(n, i);
              }
            }this.nextStage(), this.nextRhythm();
          }this._hero && (this._hero.update(t), this._hero.z = -e * a.default.CurHeroSpeed, this.lockCamera());
        }
      }, e.prototype.useItem = function () {
        return !0;
      }, e.prototype.revive = function () {
        this._isRevive = !0, this._tipsNode.active = !0, this._running = !1, this._playing = !0;var t = this.getCurStage(this._index - 1);t.removeItem(), t.stopMove(), this._hero.position = t.position.clone(), this._hero.idle(), this.removePastStage(), this._isRevive = !0, this.lockCamera(!0);
      }, e.prototype.collide = function () {
        this._isTouched = !1, this._running = !1, this._playing = !1, this._hero.dump(), this._musicCtrl.pause(), cc.tween(this._hero).to(.13, { position: cc.v3(this._hero.position.x, 3, this._hero.position.z + 3) }).to(.87, { position: cc.v3(this._hero.position.x, -25, this._hero.position.z + 4) }).call(this.fail.bind(this)).start();
      }, e.prototype.gameOver = function (t) {
        this._isTouched = !1, this._running = !1, this._playing = !1, this._hero.idle(), t ? (this._hero.eulerAngles = cc.v3(), this._musicCtrl.pause(), this.win()) : (this._musicCtrl.pause(), cc.tween(this._hero).to(1, { position: cc.v3(this._hero.position.x, -25, this._hero.position.z) }).call(this.fail.bind(this)).start());
      }, e.prototype.destroy = function () {
        this._scene && (this._camera.node.position = cc.v3(0, 6.8, 13), this._camera.node.eulerAngles = cc.v3(-26, 0, 0), this._camera = null, this._stages = null, this._uiCamera = null, this._hero = null, this._tipsNode.active = !1, this._tipsNode = null, this._musicCtrl = null, this._scene.removeFromParent(), this._scene.destroy(), this._scene = null);
      }, e.prototype.createStage = function (t, e) {
        var n = new l.default();return n.position = t > 0 ? cc.v3(this.getOffset(e, t), 0, -t * a.default.CurHeroSpeed) : cc.v3(), n;
      }, e.prototype.getOffset = function (t, e) {
        e > 6 ? a.default.CurStageOffset : a.default.StageStartOffset;return Math.sin(60 * t / 180 * Math.PI), this._offsetPara, 0;
      }, e.prototype.getCurStage = function (t) {
        for (var e, n = [], o = -1, i = 999, r = 0; r < this._stages.length; r++) {
          (e = this._stages[r]) && e.actorId == t && n.push(e);
        }if (n.length > 0) {
          if (1 == n.length) return n[0];for (var a = 0; a < n.length; a++) {
            var s = Math.abs(this._hero.position.x - n[a].position.x);s < i && (i = s, o = a);
          }if (-1 != o) return n[o];
        }return null;
      }, e.prototype.removePastStage = function () {
        for (var t, e = this._stages.length - 1, n = this._hero.position.z + .2; e >= 0;) {
          (t = this._stages[e]).position.z >= n && (this._stages.splice(e, 1), t.parent = null), e--;
        }
      }, e.prototype.hitSkyEffect = function (t) {
        var e = d.default.getEffect();e.group = "stage", e.position = t, this._scene.addChild(e), e.play(), this.hitStage(0);
      }, e.prototype.hitEffect = function (t, e) {
        if (1 == e) {
          var n = h.default.getEffect();n.group = "stage", n.position = t.position.clone(), this._scene.addChild(n), n.play();
        } else {
          var o = d.default.getEffect();o.group = "stage", o.position = t.position.clone(), this._scene.addChild(o), o.play();
        }this._gameFinish || (f.default.jumpNextStep(1 == e, (1 == e || 2 == e) && t.itemType == a.StageItemType.Gold), t.itemType == a.StageItemType.Gold ? (this._hitGold++, this._hitGold % 5 == 0 && this._hitGold) : t.itemType == a.StageItemType.JiaoZi && (a.default.Energy += 10 * this._scoreRatio)), t.removeItem(), p.default.vibrateShort(), this.hitStage(e);
      }, e.prototype.hitStage = function (t) {
        void 0 === t && (t = 0);
      }, e.prototype.nextRhythm = function () {
        var t = this._rhythmTime;this._index >= this._musicCtrl.rhythms.length && (this._musicCtrl.next(), this._nextStageLayout = this._nextStageLayout - this._index, this._index = 0, this._rhythm = this._musicCtrl.rhythms), this._rhythmTime = this._musicCtrl.rhythms[this._index] + this._musicCtrl.getDuration(), this._stepTime = this._rhythmTime - t, this._index++, this._running && this._hero.jump(this._stepTime);
      }, e.prototype.nextLayout = function (t) {
        var e = Math.floor(t),
            n = this._stepIdx + this._offsetPara + e;(1 == this._stageLayoutIdx || 3 == this._stageLayoutIdx) && n % 4 >= 2 ? (this._stageLayoutIdx = e % 10 >= 5 ? 4 : 5, this._nextStageLayout = this._stepIdx + 3, this._obstacleIdx = this._stepIdx + 1) : (this._nextStageLayout = this._stepIdx + 2 + e % 3, this._stageLayoutIdx > 3 ? this._stageLayoutIdx = n % 2 == 0 ? 1 : 3 : 3 == this._stageLayoutIdx ? this._stageLayoutIdx = 0 : this._stageLayoutIdx++);
      }, e.prototype.nextStage = function () {
        var t = this._index + a.default.ShowStageNum - 1,
            e = null,
            n = t;if (a.default.updateDashStep(this._stepIdx, this._offsetPara), t >= this._musicCtrl.rhythms.length ? (e = this._musicCtrl.nextRhythms[t - this._musicCtrl.rhythms.length] + this._musicCtrl.getNextDuration(), n = t - this._musicCtrl.rhythms.length) : e = this._musicCtrl.rhythms[t] + this._musicCtrl.getDuration(), this._stepIdx >= this._nextStageLayout && this.nextLayout(e), null != e) {
          var o = a.default.StageLayouts[this._stageLayoutIdx],
              i = a.default.ObstacleLayouts[a.default.ObstacleLayouts.length - 1];o.length > 1 && this._obstacleIdx == this._stepIdx && (i = 2 == o.length ? a.default.ObstacleLayouts[this._stepIdx % 2] : a.default.ObstacleLayouts[2 + this._stepIdx % 2]);for (var r = 0; r < o.length; r++) {
            var c = this._stages[0],
                l = o[r];null == c || null != c && c.z - this._hero.z < 15 ? (c = this.createStage(e, this._index), this._scene.addChild(c)) : ((c = this._stages.shift()).cleanup(), c.position = cc.v3(this.getOffset(t, e) + 4 * l, 0, -e * a.default.CurHeroSpeed - 10)), c.actorId = n, c.appear(cc.v3(this.getOffset(t, e) + 4 * l, 0, -e * a.default.CurHeroSpeed)), i[r] ? c.addItem(a.StageItemType.Obstacle) : this._stepIdx > 0 && (this._stepIdx % 30 == 0 ? c.addItem(a.StageItemType.Gold) : 1 == this._type && this._stepIdx >= this._jiaoziIdx ? (c.addItem(a.StageItemType.JiaoZi), this._jiaoziIdx = this._stepIdx + s.default.randomInt(8, 13)) : c.removeItem()), c.size = a.default.CurStageSize, 0 != a.default.CurStageSpeed && a.default.CurStageRadius > 0 && 1 == o.length && (c.startMove(a.default.CurStageRadius, a.default.CurStageSpeed, this._moveFx), this._moveFx *= -1), this._stages.push(c);
          }this._stepIdx++;
        }
      }, e.prototype.musicVolume = function (t) {
        void 0 === t && (t = 1), this._musicCtrl && (this._musicCtrl.volume = t);
      }, e.prototype.win = function () {}, e.prototype.fail = function () {}, e;
    }(cc.EventTarget);n.default = g, cc._RF.pop();
  }, { "../../Common/Manager/Logger": "Logger", "../../Common/Sdks/GameSDK": "GameSDK", "../../Common/Util/ComponentUtil": "ComponentUtil", "../../Common/Util/MathUtil": "MathUtil", "../Config/GameConfig": "GameConfig", "../Manager/CommandController": "CommandController", "../Manager/GameManager": "GameManager", "./HeroActor": "HeroActor", "./HitEffect": "HitEffect", "./HitSkyEffect": "HitSkyEffect", "./MusicController": "MusicController", "./StageActor": "StageActor" }], AbsFbOverPanel: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "94143SuRvFMaJu4c8SyF2a5", "AbsFbOverPanel");var _o2,
        i = this && this.__extends || (_o2 = function o(t, e) {
      return (_o2 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o2(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../../Common/Core/GameType"),
        s = t("../../../Common/Manager/Logger"),
        c = t("../../../Common/Manager/MusicManager"),
        l = t("../../../Common/Sdks/GameSDK"),
        u = t("../../../Common/UI/UIManager"),
        f = t("../../../Common/UI/UIPanel"),
        d = t("../../Config/AchieveConfig"),
        h = t("../../Fb/FbPkMatchPanel"),
        p = t("../../Info/PlayerInfo"),
        _ = t("../../Manager/GameManager"),
        m = t("../../Scene/GameScene"),
        g = t("../MainPanel"),
        y = t("../RankPanel"),
        b = t("../RePlayAnswerConfirm"),
        C = t("../../../Common/Sdks/UmaTrackHelper"),
        v = cc._decorator,
        I = v.ccclass,
        M = (v.property, function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return a.UILayerType.PopLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onClose = function () {
        this.unRegisterNetCmd();
      }, e.prototype.registerNetCmd = function () {}, e.prototype.unRegisterNetCmd = function () {}, e.prototype.cmd0x0210Handler = function (t) {
        if (!t.isError) {
          var e = t.body;s.default.log("----------------------------cmd0x0210Handler "), s.default.log(e), u.default.show(b.default, e);
        }
      }, e.prototype.onTouchRankHandler = function () {
        c.default.playEffect(c.default.CLICK), u.default.show(y.default);
      }, e.prototype.onTouchGamerePlayHandler = function () {
        c.default.playEffect(c.default.CLICK), s.default.log("--------------onTouchGamerePlayHandler-------------------"), u.default.close(this), s.default.log(this.data), 0 == this.data.t ? u.default.show(h.default) : (u.default.show(g.default), l.default.shareInvite()), 1 == this.data.t ? C.default.trackEvent("1328") : C.default.trackEvent("1321");
      }, e.prototype.onGetAwardByAd = function () {
        s.default.log("--------------onGetAwardByAd-------------------"), c.default.playEffect(c.default.CLICK), l.default.showVideoAd(this.reviveCall, this, a.VideoAdType.Sport), 1 == this.data.t ? C.default.trackEvent("1326") : C.default.trackEvent("1319");
      }, e.prototype.reviveCall = function () {
        var t = this.data;1 == t.f ? l.default.getUid() == t.win ? _.default.fbPkVideoEnd(1) : _.default.fbPkVideoEnd(0) : _.default.fbPkVideoEnd(2), u.default.close(this), m.default.ins.closeGame(), u.default.show(g.default), 1 == this.data.t ? C.default.trackEvent("1327") : C.default.trackEvent("1320");
      }, e.prototype.upAtlInfo = function (t, e) {
        var n = p.default.ins.acl,
            o = n[0],
            i = n[1],
            r = d.default.ins.getItem(o.id),
            a = d.default.ins.getItem(i.id);t.string = "(" + o.c + "/" + r.target + ")", e.string = "(" + i.c + "/" + a.target + ")";
      }, e.prototype.onTouchCloseHandler = function () {
        s.default.log("--------------onTouchCloseHandler-------------------"), c.default.playEffect(c.default.CLICK), u.default.close(this), u.default.show(g.default);
      }, r([I], e);
    }(f.default));n.default = M, cc._RF.pop();
  }, { "../../../Common/Core/GameType": "GameType", "../../../Common/Manager/Logger": "Logger", "../../../Common/Manager/MusicManager": "MusicManager", "../../../Common/Sdks/GameSDK": "GameSDK", "../../../Common/Sdks/UmaTrackHelper": "UmaTrackHelper", "../../../Common/UI/UIManager": "UIManager", "../../../Common/UI/UIPanel": "UIPanel", "../../Config/AchieveConfig": "AchieveConfig", "../../Fb/FbPkMatchPanel": "FbPkMatchPanel", "../../Info/PlayerInfo": "PlayerInfo", "../../Manager/GameManager": "GameManager", "../../Scene/GameScene": "GameScene", "../MainPanel": "MainPanel", "../RankPanel": "RankPanel", "../RePlayAnswerConfirm": "RePlayAnswerConfirm" }], AbsInfo: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "fc720CQUOhEJ6ETV3hH2nhp", "AbsInfo");var _o3,
        i = this && this.__extends || (_o3 = function o(t, e) {
      return (_o3 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o3(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("../Core/GameType"),
        a = t("../Manager/GlobalEventManager"),
        s = function (t) {
      function e() {
        var e = t.call(this) || this;return e._isDispatch = !1, e;
      }return i(e, t), e.prototype.getCfgData = function (t) {
        if (this._cfgData) return this._cfgData[t];
      }, Object.defineProperty(e.prototype, "isDispatch", { get: function get() {
          return this._isDispatch;
        }, set: function set(t) {
          this._isDispatch = t;
        }, enumerable: !1, configurable: !0 }), e.prototype.eventDispatch = function (t, e, n) {
        void 0 === e && (e = null), void 0 === n && (n = null), this.isDispatch && this.emit(r.InfoEvent.EVENT_CHANGE, [e, n]);
      }, e.prototype.save = function () {
        a.default.dispatchEvent(r.InfoEvent.EVENT_SAVE);
      }, e.prototype.init = function () {}, e.prototype.saveData = function () {}, e.prototype.onNewDayHandler = function () {}, e;
    }(cc.EventTarget);n.default = s, cc._RF.pop();
  }, { "../Core/GameType": "GameType", "../Manager/GlobalEventManager": "GlobalEventManager" }], AbstractSDK: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "580c287ToVGX4jB2jlrYht/", "AbstractSDK"), Object.defineProperty(n, "__esModule", { value: !0 });var o = t("../Core/GameType"),
        i = t("../Manager/GlobalEventManager"),
        r = t("../Manager/SysConfig"),
        a = t("../Manager/TimeManager"),
        s = t("../Util/Base64"),
        c = t("../Util/MathUtil"),
        l = t("../Util/MD5"),
        u = t("../../Game/Tips/GeneralTips"),
        f = t("../Manager/HostManager"),
        d = t("../Manager/DataManager"),
        h = t("../Manager/Logger"),
        p = function () {
      function t(t) {
        this._vip = 0, this._ios = !1, this._roomId = null, this._invoke = !1, this._isShare = !0, this._adOpen = !0, this._adPer = 100, this._adPolicy = 0, this._bannerOpen = !0, this._isAnonymous = !1, this._banner_time = 0, this._shareUrls = ["https://rane-cdn.jwetech.com/share/share5.jpg"], this._shareTitles = ["QQ\u4F1A\u5458\u71C3\u9E45\u5411\u524D\u51B2\u51B2\u51B2\uFF0C\u5FEB\u6765PK\u4E71\u6597\u8D62\u597D\u793C\uFF01"], this._isRecStatus = !1, this._recStartTime = 0, this._recTime = 0, this._sdkId = t;var e = window.location.search,
            n = "";if (e && e.indexOf("?") >= 0) {
          var o = e.substr(1, e.length).split("&"),
              i = o.length;if (i > 0) for (var r = 0; r < i; r++) {
            var a = o[r],
                s = a.indexOf("="),
                c = a.substr(0, s),
                l = a.substr(s + 1, a.length);"uid" == c && (n = l), "roomId" == c && (this._roomId = l);
          }
        }"" != n && (this._uid = n), cc.game.on(cc.game.EVENT_SHOW, this.onShow, this), cc.game.on(cc.game.EVENT_HIDE, this.onHide, this);
      }return t.prototype.getLoginUrl = function () {
        var t = f.default.getHost();return console.log("host:", t), t + r.default.LOGIN_URL;
      }, t.prototype.getLogoutUrl = function () {
        var t = f.default.getHost();return console.log("host:", t), t + r.default.LOGOUT_URL;
      }, t.prototype.initSDK = function () {}, t.prototype.initSdkEnd = function () {}, t.prototype.login = function () {
        i.default.dispatchEvent(o.InitStepEvent.LOGIN_FINISH);
      }, t.prototype.onShow = function () {
        h.default.debug("---------------onShow-----------------");
      }, t.prototype.onHide = function () {
        h.default.debug("---------------onHide-----------------");
      }, t.prototype.loadUserData = function () {
        var t = this.readUserData();if (this._remoteData) for (var e in this._remoteData) {
          t[e] = this._remoteData[e];
        }d.default.init(t);
      }, t.prototype.userKey = function () {
        return l.default.hex_md5(r.default.ID + r.default.NAME + "_" + this._uid);
      }, t.prototype.readUserData = function () {
        var t = cc.sys.localStorage.getItem(this.userKey());return t ? JSON.parse(s.default.decode(t)) : {};
      }, t.prototype.saveUserData = function (t) {
        var e = s.default.encode(JSON.stringify(t));cc.sys.localStorage.setItem(this.userKey(), e);
      }, t.prototype.clearUserData = function () {
        cc.sys.localStorage.removeItem(this.userKey());
      }, t.prototype.saveOpenData = function () {}, t.prototype.logout = function (t) {
        this.saveUserData(t), this.saveOpenData();
      }, Object.defineProperty(t.prototype, "sdkId", { get: function get() {
          return this._sdkId;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "uid", { get: function get() {
          return this._uid;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "nickname", { get: function get() {
          return this._nickname;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "icon", { get: function get() {
          return this._icon;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "vip", { get: function get() {
          return this._vip;
        }, enumerable: !1, configurable: !0 }), t.prototype.isIos = function () {
        return this._ios;
      }, Object.defineProperty(t.prototype, "roomId", { get: function get() {
          return this._roomId;
        }, enumerable: !1, configurable: !0 }), t.prototype.clearRoomId = function () {
        this._roomId = null, this._invoke = !1;
      }, Object.defineProperty(t.prototype, "isShare", { get: function get() {
          return this._isShare;
        }, enumerable: !1, configurable: !0 }), t.prototype.getShareImgUrl = function () {
        var t = c.default.randomInt(this._shareTitles.length - 1);return this._shareUrls[t];
      }, t.prototype.getShareTitleAndImgUrl = function () {
        if (1 == this._shareUrls.length) return [this._shareTitles[0], this._shareUrls[0]];var t = c.default.randomInt(this._shareTitles.length - 1);return [this._shareTitles[t], this._shareUrls[t]];
      }, t.prototype.share = function (t, e, n, o) {
        void 0 === t && (t = null), void 0 === e && (e = null), void 0 === n && (n = null), void 0 === o && (o = null), cc.log("\u5206\u4EAB\u4E2D"), t && e && a.default.add(t, e, 3e3, 1);
      }, t.prototype.getRankData = function (t, e) {
        void 0 === t && (t = null), void 0 === e && (e = null);
      }, t.prototype.showBannerAd = function () {}, t.prototype.hideBannerAd = function () {}, t.prototype.showVideoAd = function (t, e) {
        void 0 === t && (t = null), void 0 === e && (e = null), console.log("--------showVideoAd---------"), t && e && t.call(e);
      }, t.prototype.hideVideoAd = function () {}, t.prototype.postMessage = function () {}, t.prototype.adOpen = function () {
        return !0;
      }, t.prototype.hasInsertAd = function () {
        return !1;
      }, t.prototype.checkRankFunc = function () {
        return !0;
      }, t.prototype.showInsertAd = function () {}, t.prototype.vibrateShort = function () {
        window.navigator.vibrate && window.navigator.vibrate(15);
      }, t.prototype.vibrateLong = function () {
        window.navigator.vibrate && window.navigator.vibrate(400);
      }, t.prototype.navigateToMiniGame = function () {}, t.prototype.isVideoRec = function () {
        return this._isRecStatus;
      }, t.prototype.videoRecStart = function () {
        this.clearRecVideo(), this._isRecStatus = !0, this._recStartTime = a.default.serverTime;
      }, t.prototype.videoRecStop = function (t, e, n) {
        void 0 === t && (t = null), void 0 === e && (e = null), void 0 === n && (n = !1), this._isRecStatus && (this._isRecStatus = !1, this._recTime = a.default.serverTime - this._recStartTime, this._recStartTime = 0, this._recCallBack = t, this._recTarget = e, this._autoShare = n, null != this._recCallBack && null != this._recTarget && (n ? this.shareRecVideo(t, e) : this._recCallBack.call(this._recTarget)));
      }, t.prototype.isExistRecVideo = function () {
        return this._recTime > 3e3;
      }, t.prototype.getRecSecond = function () {
        if (0 == this._recStartTime) return 0;var t = Math.floor((a.default.serverTime - this._recStartTime) / 1e3);return t > 0 ? t : 0;
      }, t.prototype.clearRecVideo = function () {
        this._isRecStatus = !1, this._recStartTime = 0, this._recTime = 0, this._recCallBack = null, this._recTarget = null, this._autoShare = !1, i.default.dispatchEvent(o.SdkEvent.REC_VIDEO_CLEAR);
      }, t.prototype.shareRecVideo = function (t, e) {
        void 0 === t && (t = null), void 0 === e && (e = null), this.showToast("\u529F\u80FD\u4E0D\u5F00\u653E");
      }, Object.defineProperty(t.prototype, "banner_time", { get: function get() {
          return this._banner_time;
        }, enumerable: !1, configurable: !0 }), t.prototype.openUrl = function (t, e) {
        void 0 === e && (e = 0);
      }, t.prototype.showToast = function (t, e) {
        void 0 === e && (e = 2e3), u.default.show(t);
      }, t.prototype.shareInvite = function () {}, t;
    }();n.default = p, cc._RF.pop();
  }, { "../../Game/Tips/GeneralTips": "GeneralTips", "../Core/GameType": "GameType", "../Manager/DataManager": "DataManager", "../Manager/GlobalEventManager": "GlobalEventManager", "../Manager/HostManager": "HostManager", "../Manager/Logger": "Logger", "../Manager/SysConfig": "SysConfig", "../Manager/TimeManager": "TimeManager", "../Util/Base64": "Base64", "../Util/MD5": "MD5", "../Util/MathUtil": "MathUtil" }], AbstractWorker: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "e8f7bolaUNHTrl78kBR03vf", "AbstractWorker"), Object.defineProperty(n, "__esModule", { value: !0 });var o = t("./MsgPackError"),
        i = function () {
      function t(t, e) {
        void 0 === t && (t = null), void 0 === e && (e = 0), this.incomplete = { toString: function toString() {
            return "incomplete";
          } }, this.factory = t, this.priority = e;
      }return Object.defineProperty(t.prototype, "factory", { get: function get() {
          return this._factory;
        }, set: function set(t) {
          this._factory = t;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "priority", { get: function get() {
          return this._priority;
        }, set: function set(t) {
          this._priority != t && (this._priority = t, this.factory && (this.factory.unassign(this), this.factory.assign(this)));
        }, enumerable: !1, configurable: !0 }), t.prototype.checkByte = function () {
        return !1;
      }, t.prototype.checkType = function () {
        return !1;
      }, t.prototype.assembly = function () {
        throw new o.default("The assembly method must be overriden by a subclass.");
      }, t.prototype.disassembly = function () {
        throw new o.default("The disassembly method must be overriden by a subclass.");
      }, t;
    }();n.default = i, cc._RF.pop();
  }, { "./MsgPackError": "MsgPackError" }], AchieveConfig: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "07ba9oXw6RDBaERddU/u97N", "AchieveConfig");var _o4,
        i = this && this.__extends || (_o4 = function o(t, e) {
      return (_o4 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o4(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("../../Common/Config/AbsConfig"),
        a = t("./item/AchieveData"),
        s = function (t) {
      function e() {
        return t.call(this, a.default) || this;
      }return i(e, t), Object.defineProperty(e, "ins", { get: function get() {
          return null == e._ins && (e._ins = new e()), e._ins;
        }, enumerable: !1, configurable: !0 }), e.prototype.getListByType = function (t) {
        for (var e = new Array(), n = this._list.length, o = 0; o < n; o++) {
          var i = this._list[o];i.type == t && e.push(i);
        }return e;
      }, e.prototype.getMaxTarget = function (t, e) {
        for (var n = this.getListByType(t), o = n.length, i = 0; i < o; i++) {
          var r = n[i];if (r.target >= e) return r.target;
        }return 0;
      }, e._ins = null, e.type_sd = 1, e.type_sj = 2, e;
    }(r.default);n.default = s, cc._RF.pop();
  }, { "../../Common/Config/AbsConfig": "AbsConfig", "./item/AchieveData": "AchieveData" }], AchieveData: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "4fc9fHu/wJHfJ9W5hvMp01c", "AchieveData"), Object.defineProperty(n, "__esModule", { value: !0 });var o = function () {
      function t(t) {
        this._id = t.attributes.id, this._name = t.attributes.name, this._type = t.attributes.type, this._target = t.attributes.target, this._spId = t.attributes.spId, this._count = t.attributes.count, this._image = t.attributes.image, this._unit = t.attributes.unit;
      }return Object.defineProperty(t.prototype, "id", { get: function get() {
          return this._id;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "name", { get: function get() {
          return this._name;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "type", { get: function get() {
          return this._type;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "target", { get: function get() {
          return this._target;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "spId", { get: function get() {
          return this._spId;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "count", { get: function get() {
          return this._count;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "image", { get: function get() {
          return this._image;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "unit", { get: function get() {
          return this._unit;
        }, enumerable: !1, configurable: !0 }), t.cfgFile = "achieve", t;
    }();n.default = o, cc._RF.pop();
  }, {}], AchievementPanel: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "84604j2r3VH5Z7WKrn6mgNc", "AchievementPanel");var _o5,
        i = this && this.__extends || (_o5 = function o(t, e) {
      return (_o5 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o5(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Util/ComponentUtil"),
        c = t("../../Common/Manager/MusicManager"),
        l = t("../../Common/Core/GameType"),
        u = t("../../Common/UI/UIManager"),
        f = t("../Manager/CommandController"),
        d = t("../Config/ProductConfig"),
        h = t("../../Common/Manager/Logger"),
        p = t("../Config/AchieveConfig"),
        _ = cc._decorator,
        m = _.ccclass,
        g = (_.property, function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return l.UILayerType.PopLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.start = function () {}, e.prototype.onStart = function () {
        h.default.log("AchievementPanel onStart!!!"), this.contextView = s.default.getNode(this.node, "frame/contextView"), this.btn_close = s.default.getNode(this.node, "frame/btn_close"), this.btn_close.on("touchend", this.onTouchCloseHandler, this), cc.game.on("refreshAchievementList", this.refreshAchievementList, this);
      }, e.prototype.onShow = function () {
        h.default.log("AchievementPanel onShow!!!"), this.refreshAchievementList();
      }, e.prototype.refreshAchievementList = function () {
        var t = this;this.contextView.removeAllChildren(), this.achievement_item = s.default.getNode(this.node, "frame/achievement_item"), f.default.achieveList(function (e) {
          h.default.log(e.l, "\u6210\u5C31\u5217\u8868"), t.achieveList = e.l, t.orderachieveList();
        }, this, function () {});
      }, e.prototype.orderachieveList = function () {
        this.achieveList = this.achieveList.sort(this.compare("id")), h.default.log(this.achieveList), this.achieveListRow = this.group(this.achieveList, 5), h.default.log(this.achieveListRow, "achieveListRow"), this.showAchieveList();
      }, e.prototype.showAchieveList = function () {
        var t = p.default.ins.getList();for (var e in h.default.log(t, "achieveData"), this.achieveListRow) {
          for (var n in this.achieveListRow[e]) {
            if (0 == this.achieveListRow[e][n].f) {
              h.default.log(n, "jjj"), h.default.log("\u672A\u5B8C\u6210");var o = this.achieveListRow[e][n].id,
                  i = p.default.ins.getItem(o),
                  r = this.achieveListRow[e][n].c,
                  a = i.target,
                  s = i.name,
                  c = i.image,
                  l = i.count,
                  u = (g = d.default.ins.getItem(i.spId)).icon,
                  f = g.name;h.default.log(i, "\u6210\u5C31item"), (y = cc.instantiate(this.achievement_item)).active = !0, this.contextView.addChild(y);var _ = { id: o, spId: i.spId, unit: i.unit, icon_bg: null, icon: c, name_label: s, current_points: r, total_points: a, gift_icon: u, gift_count: l, gift_name: f, finished: !1, completed: !1 };y.getComponent("achievement_item").init(_);break;
            }if (1 == this.achieveListRow[e][n].f) {
              h.default.log("\u5B8C\u6210\u672A\u9886\u5956"), o = this.achieveListRow[e][n].id, i = p.default.ins.getItem(o), r = this.achieveListRow[e][n].c, a = i.target, s = i.name, c = i.image, l = i.count, u = (g = d.default.ins.getItem(i.spId)).icon, f = g.name, h.default.log(i, "\u6210\u5C31item"), (y = cc.instantiate(this.achievement_item)).active = !0, this.contextView.addChild(y);var m = { id: o, spId: i.spId, unit: i.unit, icon_bg: null, icon: c, name_label: s, current_points: r, total_points: a, gift_icon: u, gift_count: l, gift_name: f, finished: !0, completed: !1 };y.getComponent("achievement_item").init(m);break;
            }if (2 != this.achieveListRow[e][n].f) ;else if (h.default.log("\u5DF2\u9886\u5956"), n == (this.achieveListRow[e].length - 1).toString()) {
              var g, y;o = this.achieveListRow[e][n].id, i = p.default.ins.getItem(o), r = this.achieveListRow[e][n].c, a = i.target, s = i.name, c = i.image, l = i.count, u = (g = d.default.ins.getItem(i.spId)).icon, f = g.name, h.default.log(i, "\u6210\u5C31item"), (y = cc.instantiate(this.achievement_item)).active = !0, this.contextView.addChild(y);var b = { id: o, spId: i.spId, unit: i.unit, icon_bg: null, icon: c, name_label: s, current_points: r, total_points: a, gift_icon: u, gift_count: l, gift_name: f, finished: !0, completed: !0 };y.getComponent("achievement_item").init(b);
            }
          }
        }
      }, e.prototype.initAchievementItemData = function () {}, e.prototype.onClose = function () {}, e.prototype.onTouchCloseHandler = function () {
        c.default.playEffect(c.default.CLICK), u.default.close(this);
      }, e.prototype.onTouchReceiveGiftHandler = function () {}, e.prototype.compare = function (t) {
        return function (e, n) {
          return e[t] - n[t];
        };
      }, e.prototype.group = function (t, e) {
        for (var n = 0, o = []; n < t.length;) {
          o.push(t.slice(n, n += e));
        }return o;
      }, r([m], e);
    }(a.default));n.default = g, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/Logger": "Logger", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Config/AchieveConfig": "AchieveConfig", "../Config/ProductConfig": "ProductConfig", "../Manager/CommandController": "CommandController" }], ActivePanel: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "f0fb4KRWExPJL5SPRFWr4uc", "ActivePanel");var _o6,
        i = this && this.__extends || (_o6 = function o(t, e) {
      return (_o6 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o6(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Util/ComponentUtil"),
        c = t("../../Common/Manager/MusicManager"),
        l = t("../../Common/Core/GameType"),
        u = t("../../Common/UI/UIManager"),
        f = t("../Fb/FbEndPanel"),
        d = cc._decorator,
        h = d.ccclass,
        p = (d.property, function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return l.UILayerType.TopLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.btn_close = s.default.getComponent(cc.Button, this.node, "frame/btn_close"), this.btn_close.node.on(cc.Node.EventType.TOUCH_END, this.onTouchCloseHandler, this), this.webView = s.default.getComponent(cc.WebView, this.node, "webView");
      }, e.prototype.onShow = function () {
        this.data && (console.log("---------", this.data), this.webView.url = this.data.url, console.log(this.webView));
      }, e.prototype.onClose = function () {
        1 == this.data.t && u.default.callClazzFunc(f.default, "reviveCall");
      }, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), this.btn_close.node.targetOff(this);
      }, e.prototype.onTouchCloseHandler = function () {
        c.default.playEffect(c.default.CLICK), u.default.close(this);
      }, r([h], e);
    }(a.default));n.default = p, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Fb/FbEndPanel": "FbEndPanel" }], AddrInfo: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "c59ddR/HvpBWakpiQ2vBs2w", "AddrInfo");var _o7,
        i = this && this.__extends || (_o7 = function o(t, e) {
      return (_o7 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o7(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = function (t) {
      function e() {
        return t.call(this) || this;
      }return i(e, t), Object.defineProperty(e, "ins", { get: function get() {
          return null == e._ins && (e._ins = new e()), e._ins;
        }, enumerable: !1, configurable: !0 }), e.prototype.init = function (t) {
        null != t && null != t.addr && (this._name = t.addr.name, this._qq = t.addr.qq, this._tel = t.addr.tel, this._addr = t.addr.addr);
      }, e.prototype.saveData = function (t) {
        t.addr = { name: this._name, qq: this._qq, tel: this._tel, addr: this._addr };
      }, Object.defineProperty(e.prototype, "name", { get: function get() {
          return this._name;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "qq", { get: function get() {
          return this._qq;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "tel", { get: function get() {
          return this._tel;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "addr", { get: function get() {
          return this._addr;
        }, enumerable: !1, configurable: !0 }), e.prototype.setAddrInfo = function (t, e, n, o) {
        this._name = t, this._qq = e, this._tel = n, this._addr = o, this.save();
      }, e;
    }(t("../../Common/Info/AbsInfo").default);n.default = r, cc._RF.pop();
  }, { "../../Common/Info/AbsInfo": "AbsInfo" }], ArrayWorker: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "731bbn6qShN6rRxB6sNnWRY", "ArrayWorker");var _o8,
        i = this && this.__extends || (_o8 = function o(t, e) {
      return (_o8 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o8(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = function (t) {
      function e(e, n) {
        return void 0 === e && (e = null), void 0 === n && (n = 0), t.call(this, e, n) || this;
      }return i(e, t), e.prototype.checkByte = function (t) {
        return 144 == (240 & t) || 220 == t || 221 == t;
      }, e.prototype.checkType = function (t) {
        return t instanceof Array;
      }, e.prototype.assembly = function (t, e) {
        var n = t.length;n < 16 ? e.writeByte(144 | n) : n < 65536 ? (e.writeByte(220), e.writeShort(n)) : (e.writeByte(221), e.writeUnsignedInt(n));for (var o = 0; o < n; o++) {
          this.factory.getWorkerByType(t[o]).assembly(t[o], e);
        }
      }, e.prototype.disassembly = function (t, e) {
        var n = -1;144 == (240 & t) ? n = 15 & t : 220 == t && e.bytesAvailable >= 2 ? n = e.readUnsignedShort() : 221 == t && e.bytesAvailable >= 4 && (n = e.readUnsignedInt());var o = [];if (o.length < n) for (var i, r = o.length; r < n && 0 != e.bytesAvailable; r++) {
          i = 255 & e.readByte();var a = this.factory.getWorkerByByte(i).disassembly(i, e);if (a == this.incomplete) break;o.push(a);
        }return o.length == n ? o : this.incomplete;
      }, e;
    }(t("./AbstractWorker").default);n.default = r, cc._RF.pop();
  }, { "./AbstractWorker": "AbstractWorker" }], Base64: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "3a795BHtktOHbZ9y7Br0JrY", "Base64"), Object.defineProperty(n, "__esModule", { value: !0 });var o = function () {
      function t() {}return Object.defineProperty(t, "keystr", { get: function get() {
          return t.KEYSTR;
        }, enumerable: !1, configurable: !0 }), t.encode = function (e) {
        var n,
            o,
            i,
            r,
            a,
            s,
            c,
            l = t.KEYSTR,
            u = "",
            f = 0;for (e = this._utf8_encode(e); f < e.length;) {
          r = (n = e.charCodeAt(f++)) >> 2, a = (3 & n) << 4 | (o = e.charCodeAt(f++)) >> 4, s = (15 & o) << 2 | (i = e.charCodeAt(f++)) >> 6, c = 63 & i, isNaN(o) ? s = c = 64 : isNaN(i) && (c = 64), u = u + l.charAt(r) + l.charAt(a) + l.charAt(s) + l.charAt(c);
        }return u;
      }, t.decode = function (e) {
        var n,
            o,
            i,
            r,
            a,
            s,
            c = t.KEYSTR,
            l = "",
            u = 0;for (e = e.replace(/[^A-Za-z0-9\+\/\=]/g, ""); u < e.length;) {
          n = c.indexOf(e.charAt(u++)) << 2 | (r = c.indexOf(e.charAt(u++))) >> 4, o = (15 & r) << 4 | (a = c.indexOf(e.charAt(u++))) >> 2, i = (3 & a) << 6 | (s = c.indexOf(e.charAt(u++))), l += String.fromCharCode(n), 64 != a && (l += String.fromCharCode(o)), 64 != s && (l += String.fromCharCode(i));
        }return this._utf8_decode(l);
      }, t.decodeBuffer = function (e, n) {
        void 0 === n && (n = !1);for (var o = n ? t.decode(e) : e, i = new ArrayBuffer(o.length), r = new Uint8Array(i), a = 0, s = o.length; a < s; a++) {
          r[a] = o.charCodeAt(a);
        }return r;
      }, t._utf8_encode = function (t) {
        t = t.replace(/\r\n/g, "\n");for (var e = "", n = 0; n < t.length; n++) {
          var o = t.charCodeAt(n);o < 128 ? e += String.fromCharCode(o) : o > 127 && o < 2048 ? (e += String.fromCharCode(o >> 6 | 192), e += String.fromCharCode(63 & o | 128)) : (e += String.fromCharCode(o >> 12 | 224), e += String.fromCharCode(o >> 6 & 63 | 128), e += String.fromCharCode(63 & o | 128));
        }return e;
      }, t._utf8_decode = function (t) {
        for (var e = "", n = 0, o = 0, i = 0, r = 0; n < t.length;) {
          (o = t.charCodeAt(n)) < 128 ? (e += String.fromCharCode(o), n++) : o > 191 && o < 224 ? (i = t.charCodeAt(n + 1), e += String.fromCharCode((31 & o) << 6 | 63 & i), n += 2) : (i = t.charCodeAt(n + 1), r = t.charCodeAt(n + 2), e += String.fromCharCode((15 & o) << 12 | (63 & i) << 6 | 63 & r), n += 3);
        }return e;
      }, t.KEYSTR = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=", t;
    }();n.default = o, cc._RF.pop();
  }, {}], BaseConfig: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "01b12L1qYpMQrx3Ar9pHN6D", "BaseConfig");var _o9,
        i = this && this.__extends || (_o9 = function o(t, e) {
      return (_o9 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o9(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("../../Common/Config/AbsConfig"),
        a = t("./item/BaseData"),
        s = function (t) {
      function e() {
        return t.call(this, a.default) || this;
      }return i(e, t), Object.defineProperty(e, "ins", { get: function get() {
          return null == e._ins && (e._ins = new e()), e._ins;
        }, enumerable: !1, configurable: !0 }), e.prototype.getLottery1 = function () {
        return this.getItem(1).lottery1;
      }, e.prototype.getLottery2 = function () {
        return this.getItem(1).lottery2;
      }, e.prototype.getLotteryGiftCount = function (t) {
        var e = this.getItem(1);return 1 == t ? e.lottery2 : e.lottery1;
      }, e.prototype.getExchangeMoney = function () {
        return this.getItem(1).exchangeMoney;
      }, e._ins = null, e;
    }(r.default);n.default = s, cc._RF.pop();
  }, { "../../Common/Config/AbsConfig": "AbsConfig", "./item/BaseData": "BaseData" }], BaseData: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "81fb2B5znBPl6PsbClPWtZ7", "BaseData"), Object.defineProperty(n, "__esModule", { value: !0 });var o = function () {
      function t(t) {
        this._id = t.attributes.id, this._difficulty = t.attributes.difficulty, this._lottery1 = t.attributes.lottery1, this._lottery2 = t.attributes.lottery2, this._exchangeMoney = t.attributes.exchangeMoney;
      }return Object.defineProperty(t.prototype, "id", { get: function get() {
          return this._id;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "difficulty", { get: function get() {
          return this._difficulty;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "lottery1", { get: function get() {
          return this._lottery1;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "lottery2", { get: function get() {
          return this._lottery2;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "exchangeMoney", { get: function get() {
          return this._exchangeMoney;
        }, enumerable: !1, configurable: !0 }), t.cfgFile = "base", t;
    }();n.default = o, cc._RF.pop();
  }, {}], BinaryWorker: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "e85bfwADwJGsJpNRf9wIcGX", "BinaryWorker");var _o10,
        i = this && this.__extends || (_o10 = function o(t, e) {
      return (_o10 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o10(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("./AbstractWorker"),
        a = t("../../../Common/Core/ByteArray"),
        s = function (t) {
      function e(e, n) {
        return void 0 === e && (e = null), void 0 === n && (n = 0), t.call(this, e, n) || this;
      }return i(e, t), e.prototype.checkByte = function (t) {
        return 196 == t || 197 == t || 198 == t;
      }, e.prototype.checkType = function (t) {
        return t instanceof a.default;
      }, e.prototype.assembly = function (t, e) {
        var n = t,
            o = n.length;o < 256 ? (e.writeByte(196), e.writeByte(n.length)) : o < 65536 ? (e.writeByte(197), e.writeShort(n.length)) : (e.writeByte(198), e.writeUnsignedInt(n.length)), e.writeBytes(n, 0, n.length);
      }, e.prototype.disassembly = function (t, e) {
        var n = -1;if (196 == t && e.bytesAvailable >= 1 ? n = e.readByte() : 197 == t && e.bytesAvailable >= 2 ? n = e.readUnsignedShort() : 198 == t && e.bytesAvailable >= 4 && (n = e.readUnsignedInt()), e.bytesAvailable >= n) {
          var o = new a.default();return n > 0 && e.readBytes(o, 0, n), o;
        }return this.incomplete;
      }, e;
    }(r.default);n.default = s, cc._RF.pop();
  }, { "../../../Common/Core/ByteArray": "ByteArray", "./AbstractWorker": "AbstractWorker" }], BooleanWorker: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "c28837cVPREHrRB5z7zmaGh", "BooleanWorker");var _o11,
        i = this && this.__extends || (_o11 = function o(t, e) {
      return (_o11 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o11(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = function (t) {
      function e(e, n) {
        return void 0 === e && (e = null), void 0 === n && (n = 0), t.call(this, e, n) || this;
      }return i(e, t), e.prototype.checkByte = function (t) {
        return 195 == t || 194 == t;
      }, e.prototype.checkType = function (t) {
        return "boolean" == typeof t;
      }, e.prototype.assembly = function (t, e) {
        e.writeByte(t ? 195 : 194);
      }, e.prototype.disassembly = function (t) {
        return 195 == t;
      }, e;
    }(t("./AbstractWorker").default);n.default = r, cc._RF.pop();
  }, { "./AbstractWorker": "AbstractWorker" }], BuffConfig: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "67b95m5K+dPVpG0G19wzodB", "BuffConfig");var _o12,
        i = this && this.__extends || (_o12 = function o(t, e) {
      return (_o12 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o12(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("../../Common/Config/AbsConfig"),
        a = t("./item/BuffData"),
        s = function (t) {
      function e() {
        return t.call(this, a.default) || this;
      }return i(e, t), Object.defineProperty(e, "ins", { get: function get() {
          return null == e._ins && (e._ins = new e()), e._ins;
        }, enumerable: !1, configurable: !0 }), e._ins = null, e;
    }(r.default);n.default = s, cc._RF.pop();
  }, { "../../Common/Config/AbsConfig": "AbsConfig", "./item/BuffData": "BuffData" }], BuffController: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "b1e44kFnHZI/qXSnq+R3S5C", "BuffController");var _o13,
        i = this && this.__extends || (_o13 = function o(t, e) {
      return (_o13 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o13(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("../../Common/Core/GameType"),
        a = function (t) {
      function e(e) {
        var n = t.call(this) || this;return n._actor = e, n._count = 0, n._buffs = {}, n;
      }return i(e, t), Object.defineProperty(e, "ins", { get: function get() {
          return null == this._ins && (this._ins = new e(null)), this._ins;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "actor", { get: function get() {
          return this._actor;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "buffs", { get: function get() {
          return this._buffs;
        }, enumerable: !1, configurable: !0 }), e.prototype.update = function () {
        for (var t in this._buffs) {
          var e = this._buffs[t];e && e.update();
        }
      }, e.prototype.createBuff = function () {}, e.prototype.addBuff = function (t, e) {
        var n = this.getBuff(t);null == n && (n = this.createBuff(t, e)) && (n.id = t, n.on(r.InfoEvent.EVENT_BUFF_FINISH, this.onBuffFinishHandler, this), this._buffs[t] = n, this._count++), n.reset();
      }, e.prototype.removeBuff = function (t) {
        var e = this.getBuff(t),
            n = !1;return null != e && (e.off(r.InfoEvent.EVENT_BUFF_FINISH, this.onBuffFinishHandler, this), this._buffs[e.id] = null, this._actor.emit(r.InfoEvent.EVENT_REMOVE_BUFF, e), this._count--, n = !0), n;
      }, e.prototype.removeAll = function () {
        for (var t in this._buffs) {
          var e = this._buffs[t];e && e.off(r.InfoEvent.EVENT_BUFF_FINISH, this.onBuffFinishHandler, this);
        }this._count = 0, this._buffs = {};
      }, e.prototype.getBuff = function (t) {
        return this._buffs[t];
      }, e.prototype.onBuffFinishHandler = function (t) {
        this.removeBuff(t.id);
      }, Object.defineProperty(e.prototype, "count", { get: function get() {
          return this._count;
        }, enumerable: !1, configurable: !0 }), e;
    }(cc.EventTarget);n.default = a, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType" }], BuffData: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "adcd1B6PYxGbK51WGnoOjwv", "BuffData"), Object.defineProperty(n, "__esModule", { value: !0 });var o = function () {
      function t(t) {
        this._id = t.attributes.id, this._name = t.attributes.name, this._type = t.attributes.type, this._time = t.attributes.time, this._icon = t.attributes.icon, this._script = t.attributes.script, this._para = t.attributes.para, this._effect = t.attributes.effect;
      }return Object.defineProperty(t.prototype, "id", { get: function get() {
          return this._id;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "name", { get: function get() {
          return this._name;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "type", { get: function get() {
          return this._type;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "time", { get: function get() {
          return this._time;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "icon", { get: function get() {
          return this._icon;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "script", { get: function get() {
          return this._script;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "para", { get: function get() {
          return this._para;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "effect", { get: function get() {
          return this._effect;
        }, enumerable: !1, configurable: !0 }), t.cfgFile = "buff", t;
    }();n.default = o, cc._RF.pop();
  }, {}], BuffInfo: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "14ac8mou+FD67npAkTdbovp", "BuffInfo");var _o14,
        i = this && this.__extends || (_o14 = function o(t, e) {
      return (_o14 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o14(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 }), n.FogBuff = n.DizzyBuff = n.BianPaoBuff = n.SnowballBuff = void 0;var r = t("../../Common/Manager/TimeManager"),
        a = t("../../Common/Core/GameType"),
        s = function (t) {
      function e(e, n, o) {
        void 0 === o && (o = 0);var i = t.call(this) || this;return i.isDispatch = !0, i._actor = e, i._cfgData = n, i._time = 1e3 * (parseInt(n.split(",")[0]) + o), i.reset(), i.start(), i;
      }return i(e, t), e.prototype.start = function () {}, e.prototype.stop = function () {}, Object.defineProperty(e.prototype, "effect", { get: function get() {
          return "";
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "time", { get: function get() {
          return this._time;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "actor", { get: function get() {
          return this._actor;
        }, enumerable: !1, configurable: !0 }), e.prototype.init = function (t) {
        void 0 === t && (t = null);
      }, e.prototype.reset = function () {
        this._curTime = r.default.serverTime + this.time;
      }, Object.defineProperty(e.prototype, "running", { get: function get() {
          return this._curTime >= r.default.serverTime;
        }, enumerable: !1, configurable: !0 }), e.prototype.update = function () {
        this.running ? this.onUpdate() : (this.stop(), this.eventDispatch(a.InfoEvent.EVENT_BUFF_FINISH));
      }, e.prototype.onUpdate = function () {}, Object.defineProperty(e.prototype, "curTime", { get: function get() {
          return Math.max(0, this._curTime - r.default.serverTime);
        }, enumerable: !1, configurable: !0 }), e.prototype.eventDispatch = function (t, e, n) {
        void 0 === e && (e = null), void 0 === n && (n = null), this.isDispatch && this.emit(t, this);
      }, e;
    }(t("../../Common/Info/AbsInfo").default);n.default = s;var c = function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), Object.defineProperty(e.prototype, "effect", { get: function get() {
          return "snowball";
        }, enumerable: !1, configurable: !0 }), e;
    }(s);n.SnowballBuff = c;var l = function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), Object.defineProperty(e.prototype, "effect", { get: function get() {
          return "bianpao";
        }, enumerable: !1, configurable: !0 }), e;
    }(s);n.BianPaoBuff = l;var u = function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), Object.defineProperty(e.prototype, "effect", { get: function get() {
          return "dizzy";
        }, enumerable: !1, configurable: !0 }), e;
    }(s);n.DizzyBuff = u;var f = function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), Object.defineProperty(e.prototype, "effect", { get: function get() {
          return "fog";
        }, enumerable: !1, configurable: !0 }), e;
    }(s);n.FogBuff = f, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Info/AbsInfo": "AbsInfo", "../../Common/Manager/TimeManager": "TimeManager" }], BufferBigEndian: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "71b5aX4YZdF17elU1F1kPG/", "BufferBigEndian"), Object.defineProperty(n, "__esModule", { value: !0 });var o = function () {
      function t() {
        this.buffer = [], this.readOffset = 0;
      }return t.prototype.initWithUint8Array = function (t) {
        for (var e = 0; e < t.length; e++) {
          this.buffer[e] = t[e];
        }this.readOffset = 0;
      }, t.prototype.getUint8 = function () {
        return this.readOffset + 1 > this.buffer.length ? null : this.buffer[this.readOffset++];
      }, t.prototype.pushUint8 = function (t) {
        if (t > 255) throw Error("BufferBigEndian pushUint8 value need <= 255");this.buffer.push(t);
      }, t.prototype.getUint16 = function () {
        return this.readOffset + 2 > this.buffer.length ? null : this.getUint8() << 8 | this.getUint8();
      }, t.prototype.pushUint16 = function (t) {
        this.pushUint8(t >> 8 & 255), this.pushUint8(255 & t);
      }, t.prototype.getUint32 = function () {
        return this.readOffset + 4 > this.buffer.length ? null : 65536 * this.getUint16() + this.getUint16();
      }, t.prototype.pushUint32 = function (t) {
        this.pushUint16(t >> 16 & 65535), this.pushUint16(65535 & t);
      }, t.prototype.pushUnicodeWithUtf8 = function (t) {
        t <= 127 ? this.pushUint8(t) : t <= 255 ? (this.pushUint8(t >> 6 | 192), this.pushUint8(63 & t | 128)) : t <= 65535 ? (this.pushUint8(t >> 12 | 224), this.pushUint8(t >> 6 & 63 | 128), this.pushUint8(63 & t | 128)) : t <= 2097151 ? (this.pushUint8(t >> 18 | 240), this.pushUint8(t >> 12 & 63 | 128), this.pushUint8(t >> 6 & 63 | 128), this.pushUint8(63 & t | 128)) : t <= 67108863 ? (this.pushUint8(t >> 24 | 248), this.pushUint8(t >> 18 & 63 | 128), this.pushUint8(t >> 12 & 63 | 128), this.pushUint8(t >> 6 & 63 | 128), this.pushUint8(63 & t | 128)) : (this.pushUint8(t >> 30 & 1 | 252), this.pushUint8(t >> 24 & 63 | 128), this.pushUint8(t >> 18 & 63 | 128), this.pushUint8(t >> 12 & 63 | 128), this.pushUint8(t >> 6 & 63 | 128), this.pushUint8(63 & t | 128));
      }, t.prototype.getUnicodeWithUtf8 = function () {
        var t,
            e = this.getUint8();if (!e) return null;for (var n = 7; 1 == (e >> n & 1);) {
          n--;
        }t = 0 == (n = 7 - n) ? e : e & Math.pow(2, 7 - n) - 1;for (var o = 1; o < n; o++) {
          t = t << 6 | 63 & this.getUint8();
        }return { unicode: t, len: 0 == n ? 1 : n };
      }, t.prototype.parseUnicodeFromUtf16 = function (t, e) {
        return 55296 == (64512 & t) && 56320 == (64512 & e) ? { unicode: 65536 + ((1023 & t) << 10 | 1023 & e), ok: !0 } : { ok: !1 };
      }, t.prototype.pushStringWithUtf8 = function (t) {
        for (var e = this.buffer.length, n = 0; n < t.length; n++) {
          var o = t.charCodeAt(n);if (o < 128) this.pushUnicodeWithUtf8(o);else if (o < 2048) this.pushUnicodeWithUtf8(o);else {
            var i = t.charCodeAt(n + 1),
                r = this.parseUnicodeFromUtf16(o, i);r.ok ? (this.pushUnicodeWithUtf8(r.unicode), n++) : this.pushUnicodeWithUtf8(o);
          }
        }return this.buffer.length - e;
      }, t.prototype.getStringWithUtf8 = function (t) {
        if (t < 1) return "";if (this.readOffset + t > this.buffer.length) return "";for (var e = "", n = 0; n < t;) {
          var o = this.getUnicodeWithUtf8();if (!o) break;if (n += o.len, o.unicode < 65536) e += String.fromCharCode(o.unicode);else {
            var i = o.unicode - 65536,
                r = i >> 10 | 55296,
                a = 1023 & i | 56320;e += String.fromCharCode(r, a);
          }
        }return e;
      }, t.prototype.pushStringWithUtf16 = function (t) {
        for (var e = this.buffer.length, n = 0; n < t.length; n++) {
          var o = t[n].charCodeAt(0);this.pushUint16(o);
        }return this.buffer.length - e;
      }, t.prototype.getStringWithUtf16 = function (t) {
        if (t < 1) return "";if (this.readOffset + t > this.buffer.length || t % 2 != 0) return "";for (var e = "", n = 0; n < t; n += 2) {
          var o = this.getUint16(),
              i = this.getUint16();e += String.fromCharCode(o, i);
        }return e;
      }, t.prototype.tostring = function () {
        for (var t = "", e = 0; e < this.buffer.length; e++) {
          var n = this.buffer[e].toString(16);t += 1 == n.length ? "0" + n.toUpperCase() : n.toUpperCase();
        }return t;
      }, t.prototype.toUint8Array = function () {
        for (var t = new Uint8Array(this.buffer.length), e = 0; e < this.buffer.length; e++) {
          t[e] = this.buffer[e];
        }return t;
      }, t.prototype.toUtf8String = function () {
        return this.getStringWithUtf8(this.buffer.length);
      }, t.prototype.toJSON = function () {
        var t = this.getStringWithUtf8(this.buffer.length);return JSON.parse(t);
      }, t;
    }();n.default = o, cc._RF.pop();
  }, {}], BufferUtil: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "1e500WXFBFHTbM8N19Pov12", "BufferUtil"), Object.defineProperty(n, "__esModule", { value: !0 });var o = t("../Core/ByteArray"),
        i = function () {
      function t() {}return t.test01 = function (e, n, o) {
        var i = ((o & e) + (n ^ e)) % 255;t._keys.clear(), t._keys.position = 0;for (var r = 0; r < o; r++) {
          e -= (i * o ^ n) % 255, n -= i, i = e % 255, t._keys.writeByte(255 & i);
        }return t._keys.position = 0, t._keys;
      }, t.test02 = function (e, n, o, i) {
        for (var r = t.test01(e, n, o), a = 0; a < o; a++) {
          if (a < i.length) {
            var s = i.readByte(),
                c = r.readByte();i.position -= 1, i.writeByte(255 & (s ^ c));
          }
        }i.position = 0;
      }, t._keys = new o.default(), t._body = new o.default(), t._buff = new o.default(), t;
    }();n.default = i, cc._RF.pop();
  }, { "../Core/ByteArray": "ByteArray" }], ByteArray: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "0d3f4o5uORMZrj6JExxaL+a", "ByteArray"), Object.defineProperty(n, "__esModule", { value: !0 });var o = function () {
      function t(e) {
        this.setArrayBuffer = function (t) {
          this._setArrayBuffer(t);
        }, this.BUFFER_EXT_SIZE = 0, this.EOF_byte = -1, this.EOF_code_point = -1, this._setArrayBuffer(e || new ArrayBuffer(this.BUFFER_EXT_SIZE)), this.endian = t.BIG_ENDIAN;
      }return t.prototype._setArrayBuffer = function (t) {
        this.write_position = t.byteLength, this.data = new DataView(t), this._position = 0;
      }, Object.defineProperty(t.prototype, "buffer", { get: function get() {
          return this.data.buffer;
        }, set: function set(t) {
          this.data = new DataView(t);
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "dataView", { get: function get() {
          return this.data;
        }, set: function set(t) {
          this.data = t, this.write_position = t.byteLength;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "bufferOffset", { get: function get() {
          return this.data.byteOffset;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "position", { get: function get() {
          return this._position;
        }, set: function set(t) {
          this._position = t, this.write_position = t > this.write_position ? t : this.write_position;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "length", { get: function get() {
          return this.write_position;
        }, set: function set(t) {
          this.write_position = t;var e = new Uint8Array(new ArrayBuffer(t)),
              n = this.data.buffer.byteLength;n > t && (this._position = t);var o = Math.min(n, t);e.set(new Uint8Array(this.data.buffer, 0, o)), this.buffer = e.buffer;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "bytesAvailable", { get: function get() {
          return this.data.byteLength - this._position;
        }, enumerable: !1, configurable: !0 }), t.prototype.clear = function () {
        this._setArrayBuffer(new ArrayBuffer(this.BUFFER_EXT_SIZE));
      }, t.prototype.readBoolean = function () {
        return this.validate(t.SIZE_OF_BOOLEAN) ? 0 != this.data.getUint8(this.position++) : null;
      }, t.prototype.readByte = function () {
        return this.validate(t.SIZE_OF_INT8) ? this.data.getInt8(this.position++) : null;
      }, t.prototype.readBytes = function (e, n, o) {
        if (void 0 === n && (n = 0), void 0 === o && (o = 0), 0 == o) o = this.bytesAvailable;else if (!this.validate(o)) return null;e ? e.validateBuffer(n + o) : e = new t(new ArrayBuffer(n + o));for (var i = 0; i < o; i++) {
          e.data.setUint8(i + n, this.data.getUint8(this.position++));
        }
      }, t.prototype.readDouble = function () {
        if (!this.validate(t.SIZE_OF_FLOAT64)) return null;var e = this.data.getFloat64(this.position, this.endian == t.LITTLE_ENDIAN);return this.position += t.SIZE_OF_FLOAT64, e;
      }, t.prototype.readFloat = function () {
        if (!this.validate(t.SIZE_OF_FLOAT32)) return null;var e = this.data.getFloat32(this.position, this.endian == t.LITTLE_ENDIAN);return this.position += t.SIZE_OF_FLOAT32, e;
      }, t.prototype.readInt = function () {
        if (!this.validate(t.SIZE_OF_INT32)) return null;var e = this.data.getInt32(this.position, this.endian == t.LITTLE_ENDIAN);return this.position += t.SIZE_OF_INT32, e;
      }, t.prototype.readShort = function () {
        if (!this.validate(t.SIZE_OF_INT16)) return null;var e = this.data.getInt16(this.position, this.endian == t.LITTLE_ENDIAN);return this.position += t.SIZE_OF_INT16, e;
      }, t.prototype.readUnsignedByte = function () {
        return this.validate(t.SIZE_OF_UINT8) ? this.data.getUint8(this.position++) : null;
      }, t.prototype.readUnsignedInt = function () {
        if (!this.validate(t.SIZE_OF_UINT32)) return null;var e = this.data.getUint32(this.position, this.endian == t.LITTLE_ENDIAN);return this.position += t.SIZE_OF_UINT32, e;
      }, t.prototype.readUnsignedShort = function () {
        if (!this.validate(t.SIZE_OF_UINT16)) return null;var e = this.data.getUint16(this.position, this.endian == t.LITTLE_ENDIAN);return this.position += t.SIZE_OF_UINT16, e;
      }, t.prototype.readUTF = function () {
        if (!this.validate(t.SIZE_OF_UINT16)) return null;var e = this.data.getUint16(this.position, this.endian == t.LITTLE_ENDIAN);return this.position += t.SIZE_OF_UINT16, e > 0 ? this.readUTFBytes(e) : "";
      }, t.prototype.readUTFBytes = function (t) {
        if (!this.validate(t)) return null;var e = new Uint8Array(this.buffer, this.bufferOffset + this.position, t);return this.position += t, this.decodeUTF8(e);
      }, t.prototype.writeBoolean = function (e) {
        this.validateBuffer(t.SIZE_OF_BOOLEAN), this.data.setUint8(this.position++, e ? 1 : 0);
      }, t.prototype.writeByte = function (e) {
        this.validateBuffer(t.SIZE_OF_INT8), this.data.setInt8(this.position++, e);
      }, t.prototype.writeBytes = function (t, e, n) {
        var o;if (void 0 === e && (e = 0), void 0 === n && (n = 0), !(e < 0) && !(n < 0) && (o = 0 == n ? t.length - e : Math.min(t.length - e, n)) > 0) {
          this.validateBuffer(o);for (var i = new DataView(t.buffer), r = o; r > 4; r -= 4) {
            this.data.setUint32(this._position, i.getUint32(e)), this.position += 4, e += 4;
          }for (; r > 0; r--) {
            this.data.setUint8(this.position++, i.getUint8(e++));
          }
        }
      }, t.prototype.writeDouble = function (e) {
        this.validateBuffer(t.SIZE_OF_FLOAT64), this.data.setFloat64(this.position, e, this.endian == t.LITTLE_ENDIAN), this.position += t.SIZE_OF_FLOAT64;
      }, t.prototype.writeFloat = function (e) {
        this.validateBuffer(t.SIZE_OF_FLOAT32), this.data.setFloat32(this.position, e, this.endian == t.LITTLE_ENDIAN), this.position += t.SIZE_OF_FLOAT32;
      }, t.prototype.writeInt = function (e) {
        this.validateBuffer(t.SIZE_OF_INT32), this.data.setInt32(this.position, e, this.endian == t.LITTLE_ENDIAN), this.position += t.SIZE_OF_INT32;
      }, t.prototype.writeShort = function (e) {
        this.validateBuffer(t.SIZE_OF_INT16), this.data.setInt16(this.position, e, this.endian == t.LITTLE_ENDIAN), this.position += t.SIZE_OF_INT16;
      }, t.prototype.writeUnsignedIntpublic = function (e) {
        this.validateBuffer(t.SIZE_OF_UINT32), this.data.setUint32(this.position, e, this.endian == t.LITTLE_ENDIAN), this.position += t.SIZE_OF_UINT32;
      }, t.prototype.writeUnsignedShort = function (e) {
        this.validateBuffer(t.SIZE_OF_UINT16), this.data.setUint16(this.position, e, this.endian == t.LITTLE_ENDIAN), this.position += t.SIZE_OF_UINT16;
      }, t.prototype.writeUnsignedInt = function (e) {
        this.validateBuffer(t.SIZE_OF_UINT32), this.data.setUint32(this.position, e, this.endian == t.LITTLE_ENDIAN), this.position += t.SIZE_OF_UINT32;
      }, t.prototype.writeUTF = function (e) {
        var n = this.encodeUTF8(e),
            o = n.length;this.validateBuffer(t.SIZE_OF_UINT16 + o), this.data.setUint16(this.position, o, this.endian == t.LITTLE_ENDIAN), this.position += t.SIZE_OF_UINT16, this._writeUint8Array(n, !1);
      }, t.prototype.writeUTFBytes = function (t) {
        this._writeUint8Array(this.encodeUTF8(t));
      }, t.prototype.toString = function () {
        return "[ByteArray] length:" + this.length + ", bytesAvailable:" + this.bytesAvailable;
      }, t.prototype._writeUint8Array = function (t, e) {
        void 0 === e && (e = !0), e && this.validateBuffer(this.position + t.length);for (var n = 0; n < t.length; n++) {
          this.data.setUint8(this.position++, t[n]);
        }
      }, t.prototype.validate = function (t) {
        if (this.data.byteLength > 0 && this._position + t <= this.data.byteLength) return !0;
      }, t.prototype.validateBuffer = function (t, e) {
        if (void 0 === e && (e = !1), this.write_position = t > this.write_position ? t : this.write_position, t += this._position, this.data.byteLength < t || e) {
          var n = new Uint8Array(new ArrayBuffer(t + this.BUFFER_EXT_SIZE)),
              o = Math.min(this.data.buffer.byteLength, t + this.BUFFER_EXT_SIZE);n.set(new Uint8Array(this.data.buffer, 0, o)), this.buffer = n.buffer;
        }
      }, t.prototype.encodeUTF8 = function (t) {
        for (var e = 0, n = this.stringToCodePoints(t), o = []; n.length > e;) {
          var i = n[e++];if (this.inRange(i, 55296, 57343)) this.encoderError(i);else if (this.inRange(i, 0, 127)) o.push(i);else {
            var r = void 0,
                a = void 0;for (this.inRange(i, 128, 2047) ? (r = 1, a = 192) : this.inRange(i, 2048, 65535) ? (r = 2, a = 224) : this.inRange(i, 65536, 1114111) && (r = 3, a = 240), o.push(this.div(i, Math.pow(64, r)) + a); r > 0;) {
              var s = this.div(i, Math.pow(64, r - 1));o.push(128 + s % 64), r -= 1;
            }
          }
        }return new Uint8Array(o);
      }, t.prototype.decodeUTF8 = function (t) {
        for (var e, n = 0, o = "", i = 0, r = 0, a = 0, s = 0; t.length > n;) {
          var c = t[n++];if (c == this.EOF_byte) e = 0 != r ? this.decoderError(!1) : this.EOF_code_point;else if (0 == r) this.inRange(c, 0, 127) ? e = c : (this.inRange(c, 194, 223) ? (r = 1, s = 128, i = c - 192) : this.inRange(c, 224, 239) ? (r = 2, s = 2048, i = c - 224) : this.inRange(c, 240, 244) ? (r = 3, s = 65536, i = c - 240) : this.decoderError(!1), i *= Math.pow(64, r), e = null);else if (this.inRange(c, 128, 191)) {
            if (a += 1, i += (c - 128) * Math.pow(64, r - a), a !== r) e = null;else {
              var l = i,
                  u = s;i = 0, r = 0, a = 0, s = 0, e = this.inRange(l, u, 1114111) && !this.inRange(l, 55296, 57343) ? l : this.decoderError(!1, c);
            }
          } else i = 0, r = 0, a = 0, s = 0, n--, e = this.decoderError(!1, c);null !== e && e !== this.EOF_code_point && (e <= 65535 ? e > 0 && (o += String.fromCharCode(e)) : (e -= 65536, o += String.fromCharCode(55296 + (e >> 10 & 1023)), o += String.fromCharCode(56320 + (1023 & e))));
        }return o;
      }, t.prototype.encoderError = function () {}, t.prototype.decoderError = function (t, e) {
        return e || 65533;
      }, t.prototype.inRange = function (t, e, n) {
        return e <= t && t <= n;
      }, t.prototype.div = function (t, e) {
        return Math.floor(t / e);
      }, t.prototype.stringToCodePoints = function (t) {
        for (var e = [], n = 0, o = t.length; n < t.length;) {
          var i = t.charCodeAt(n);if (this.inRange(i, 55296, 57343)) {
            if (this.inRange(i, 56320, 57343)) e.push(65533);else if (n == o - 1) e.push(65533);else {
              var r = t.charCodeAt(n + 1);if (this.inRange(r, 56320, 57343)) {
                var a = 1023 & i,
                    s = 1023 & r;n += 1, e.push(65536 + (a << 10) + s);
              } else e.push(65533);
            }
          } else e.push(i);n += 1;
        }return e;
      }, t.LITTLE_ENDIAN = "littleEndian", t.BIG_ENDIAN = "bigEndian", t.SIZE_OF_BOOLEAN = 1, t.SIZE_OF_INT8 = 1, t.SIZE_OF_INT16 = 2, t.SIZE_OF_INT32 = 4, t.SIZE_OF_UINT8 = 1, t.SIZE_OF_UINT16 = 2, t.SIZE_OF_UINT32 = 4, t.SIZE_OF_FLOAT32 = 4, t.SIZE_OF_FLOAT64 = 8, t;
    }();n.default = o, cc._RF.pop();
  }, {}], ByteUtil: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "7e8f7s5rWRE2ZOnmkg72Rve", "ByteUtil"), Object.defineProperty(n, "__esModule", { value: !0 });var o = function () {
      function t() {}return t.compress = function (t) {
        var e = new Uint8Array(t);return new Zlib.Deflate(e).compress();
      }, t.uncompress = function (t) {
        var e = new Uint8Array(t);return new Zlib.Inflate(e).decompress();
      }, t.test = function () {
        console.log("------------ByteUtil-----test---------");
      }, t;
    }();n.default = o, cc._RF.pop();
  }, {}], CallBackUtils: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "23e18JhlOtGqITTlp0QuHqW", "CallBackUtils"), Object.defineProperty(n, "__esModule", { value: !0 });var o = function () {
      function t(t, e) {
        void 0 === t && (t = null), void 0 === e && (e = null), this.setData(t, e);
      }return t.triggerCallBack = function (t, e, n) {
        void 0 === n && (n = null), null != e && (null != t ? null != n ? e.call(t, n) : e.call(t) : null != n ? e(n) : e());
      }, t.prototype.setData = function (t, e) {
        this.caller = t, this.callBack = e;
      }, t.prototype.trigger = function (e) {
        void 0 === e && (e = null), t.triggerCallBack(this.caller, this.callBack, e);
      }, t.prototype.triggerByReturn = function () {
        return this.callBack.call(this.caller);
      }, t.prototype.destroy = function () {
        this.caller = null, this.callBack = null;
      }, t;
    }();n.default = o, cc._RF.pop();
  }, {}], CoinExchangePanel: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "6f715BuUgZKNqEW+xZTks1h", "CoinExchangePanel");var _o15,
        i = this && this.__extends || (_o15 = function o(t, e) {
      return (_o15 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o15(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Util/ComponentUtil"),
        c = t("../../Common/Manager/MusicManager"),
        l = t("../../Common/Core/GameType"),
        u = t("../../Common/UI/UIManager"),
        f = t("../Manager/CommandController"),
        d = t("../Config/BaseConfig"),
        h = t("../../Common/Manager/Logger"),
        p = t("../Info/PlayerInfo"),
        _ = t("./item/ProInfoCtr"),
        m = t("./ExchangeGiftTips"),
        g = cc._decorator,
        y = g.ccclass,
        b = (g.property, function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return l.UILayerType.PopLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.start = function () {}, e.prototype.onStart = function () {
        h.default.log("CoinExchangePanel onStart!!!"), this.proInfo = s.default.getNode(this.node, "proInfo"), this.proInfoCtr = new _.default(this.proInfo), this.exchange_rate = d.default.ins.getExchangeMoney(), this.btn_exchange = s.default.getComponent(cc.Button, this.node, "frame/exchange/exchange_btn"), this.btn_close = s.default.getNode(this.node, "frame/btn_close"), this.btn_close.on("touchend", this.onTouchCloseHandler, this), this.btn_add = s.default.getComponent(cc.Button, this.node, "frame/exchange/add_img"), this.btn_minus = s.default.getComponent(cc.Button, this.node, "frame/exchange/minus_img"), this.current_coin_label = s.default.getComponent(cc.Label, this.node, "frame/current_coin_label"), this.exchange_tips = s.default.getComponent(cc.Label, this.node, "frame/exchange/exchange_tips"), this.coin_count_label = s.default.getComponent(cc.Label, this.node, "frame/exchange/coin_bg/coin_count"), this.quan_count_label = s.default.getComponent(cc.Label, this.node, "frame/exchange/quan_bg/quan_count"), this.coin_count = 0, this.quan_count = this.coin_count / this.exchange_rate, this.btn_exchange.node.on("touchend", this.onTouchExchangeHandler, this), this.btn_add.node.on("touchend", this.onTouchAddHandler, this), this.btn_minus.node.on("touchend", this.onTouchMinusHandler, this), this.btn_add.node.on("touchstart", this.onTouchStartAddHandler, this), this.btn_minus.node.on("touchstart", this.onTouchStartMinusHandler, this), cc.game.on("exchangeGiftPanelRefresh", this.refreshPanel, this);
      }, e.prototype.onShow = function () {
        this.exchange_tips.string = "\u5151\u6362\u6BD4\u4F8B\uFF1A" + this.exchange_rate + "\u91D1\u5E01=1\u5956\u5238", this.proInfoCtr.onShow(), this.refreshPanel();
      }, e.prototype.onClose = function () {}, e.prototype.refreshPanel = function () {
        this.coin_count = 0, this.quan_count = this.coin_count / this.exchange_rate, this.updateUI();
      }, e.prototype.updateUI = function () {
        this.coin_count_label.string = this.coin_count.toString(), this.quan_count_label.string = this.quan_count.toString(), this.current_coin_label.string = "\u76EE\u524D\u5DF2\u6709" + p.default.ins.money + "\u91D1\u5E01";
      }, e.prototype.onTouchAddHandler = function () {
        c.default.playEffect(c.default.CLICK), this.coin_count += this.exchange_rate, this.coin_count > p.default.ins.money && (this.coin_count -= this.exchange_rate), this.quan_count = this.coin_count / this.exchange_rate, this.updateUI(), this.unscheduleAllCallbacks();
      }, e.prototype.onTouchStartAddHandler = function () {
        this.scheduleOnce(this.longPressAdd, 1);
      }, e.prototype.longPressAdd = function () {
        this.schedule(this.beginLongAdd, .1, cc.macro.REPEAT_FOREVER, .1);
      }, e.prototype.beginLongAdd = function () {
        c.default.playEffect(c.default.CLICK), this.coin_count += this.exchange_rate, this.coin_count > p.default.ins.money && (this.coin_count -= this.exchange_rate), this.quan_count = this.coin_count / this.exchange_rate, this.updateUI();
      }, e.prototype.onTouchMinusHandler = function () {
        c.default.playEffect(c.default.CLICK), this.coin_count -= this.exchange_rate, this.coin_count <= 0 && (this.coin_count = 0), this.quan_count = this.coin_count / this.exchange_rate, this.updateUI(), this.unscheduleAllCallbacks();
      }, e.prototype.onTouchStartMinusHandler = function () {
        this.scheduleOnce(this.longPressMinus, 1);
      }, e.prototype.onTouchCloseHandler = function () {
        c.default.playEffect(c.default.CLICK), u.default.close(this);
      }, e.prototype.longPressMinus = function () {
        this.schedule(this.beginLongMinus, .1, cc.macro.REPEAT_FOREVER, .1);
      }, e.prototype.beginLongMinus = function () {
        c.default.playEffect(c.default.CLICK), this.coin_count -= this.exchange_rate, this.coin_count <= 0 && (this.coin_count += this.exchange_rate), this.quan_count = this.coin_count / this.exchange_rate, this.updateUI();
      }, e.prototype.onTouchExchangeHandler = function () {
        var t = this;c.default.playEffect(c.default.CLICK), this.btn_exchange.interactable = !1, f.default.exchangeGift(this.quan_count, function (e) {
          h.default.log(e), h.default.log("\u82B1\u8D39" + t.coin_count + "\u91D1\u5E01\u5151\u6362" + t.quan_count + "\u5956\u5238"), p.default.ins.money -= t.coin_count, p.default.ins.giftCoupon += t.quan_count, t.btn_exchange.interactable = !0, t.current_coin_label.string = "\u76EE\u524D\u5DF2\u6709" + p.default.ins.money + "\u91D1\u5E01";var n = { content: "\u672C\u6B21\u5151\u6362" + t.quan_count + "\u5956\u5238" };u.default.show(m.default, n);
        }, this, function (e) {
          h.default.error("\u5151\u6362\u5956\u5238\u5931\u8D25\uFF01\uFF01", e), t.btn_exchange.interactable = !0;
        });
      }, r([y], e);
    }(a.default));n.default = b, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/Logger": "Logger", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Config/BaseConfig": "BaseConfig", "../Info/PlayerInfo": "PlayerInfo", "../Manager/CommandController": "CommandController", "./ExchangeGiftTips": "ExchangeGiftTips", "./item/ProInfoCtr": "ProInfoCtr" }], CommandController: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "d61d7j9U6pELJB79EpMSEoc", "CommandController"), Object.defineProperty(n, "__esModule", { value: !0 });var o = t("../../Common/Sdks/GameSDK"),
        i = t("../../Common/Util/MD5"),
        r = t("../../Common/Manager/SysConfig"),
        a = t("../../Common/Util/NetUtil"),
        s = t("../../Common/Manager/HostManager"),
        c = t("../../Common/Manager/Logger"),
        l = t("../Info/FbInfo"),
        u = function () {
      function t() {}return t.makeSign = function (e) {
        var n = { uid: o.default.getUid(), ts: t.getCommandSeq(), params: JSON.stringify(e) };return n.sign = i.default.hex_md5(n.uid + n.ts.toString() + n.params + r.default.CLIENT_KEY), n;
      }, t.commandPost = function (e, n, i, r, l) {
        var u = t.makeSign(n),
            f = s.default.getHost() + e;c.default.log("command input:", f, n), a.default.encodePost(f, u, function (t) {
          if (c.default.log("command return:", f, t), t && null != t.errCode) return 3 != t.errCode && o.default.showToast(t.errMsg), void (l && r && l.call(r, t));i && r && i.call(r, t);
        }, this);
      }, t.getCommandSeq = function () {
        return this._commandSeq++, this._commandSeq;
      }, t.nickname = function (e, n, o, i, r, a) {
        var s = { nickname: e, avatarUrl: n, encryptedData: o, iv: i };t.commandPost("/login/nickname", s, r, a);
      }, t.fbStart = function (e, n) {
        t.commandPost("/game/fbStart", {}, e, n);
      }, t.fbSingle = function (e, n, o) {
        var i = { score: l.default.ins.currentScore, step: l.default.ins.step };t.commandPost("/game/fbSingle", i, e, n, o);
      }, t.fbSingleVideo = function (e, n) {
        var o = { score: l.default.ins.currentScore, step: l.default.ins.step };t.commandPost("/game/fbSingleVideo", o, e, n);
      }, t.fbPk = function (e, n, o, i) {
        var r = { win: e, score: l.default.ins.currentScore, step: l.default.ins.step };t.commandPost("/game/fbPk", r, n, o, i);
      }, t.fbPkVideo = function (e, n, o) {
        var i = { win: e, score: l.default.ins.currentScore, step: l.default.ins.step };t.commandPost("/game/fbPkVideo", i, n, o);
      }, t.getLotteryInfo = function (e, n) {
        var i = { ios: o.default.isIos() };t.commandPost("/game/getLotteryInfo", i, e, n);
      }, t.lotteryStart = function (e, n, i) {
        var r = { t: e, ios: o.default.isIos() };t.commandPost("/game/lotteryStart", r, n, i);
      }, t.lotteryEnd = function (e, n, i, r, a, s) {
        var c = { ios: o.default.isIos() };i && (c.name = i), r && (c.qq = r), a && (c.tel = a), s && (c.addr = s), t.commandPost("/game/lotteryEnd", c, e, n);
      }, t.exchange = function (e, n, o, i, r, a, s) {
        var c = { id: e };i && (c.name = i), r && (c.qq = r), a && (c.tel = a), s && (c.addr = s), t.commandPost("/game/exchange", c, n, o);
      }, t.myExchangeList = function (e, n) {
        t.commandPost("/game/myExchange", {}, e, n);
      }, t.exchangeGift = function (e, n, o, i) {
        var r = { gift: e };t.commandPost("/game/exchangeGift", r, n, o, i);
      }, t.rankRlz = function (e, n, o) {
        t.commandPost("/game/rankRlz", {}, e, n, o);
      }, t.rankPk = function (e, n, o) {
        t.commandPost("/game/rankPk", {}, e, n, o);
      }, t.sign = function (e, n, o, i, r, a) {
        var s = { day: e, video: o, t: n };t.commandPost("/game/sign", s, i, r, a);
      }, t.saveItem = function (e, n, o, i) {
        var r = { item: e };t.commandPost("/game/saveItem", r, n, o, i);
      }, t.buyItem = function (e, n, o, i, r) {
        var a = { spId: e, item: n };t.commandPost("/game/buyItem", a, o, i, r);
      }, t.achieveList = function (e, n, o) {
        t.commandPost("/game/achieveList", {}, e, n, o);
      }, t.achieveReward = function (e, n, o, i) {
        var r = { id: e };t.commandPost("/game/achieveReward", r, n, o, i);
      }, t._commandSeq = 1, t;
    }();n.default = u, cc._RF.pop();
  }, { "../../Common/Manager/HostManager": "HostManager", "../../Common/Manager/Logger": "Logger", "../../Common/Manager/SysConfig": "SysConfig", "../../Common/Sdks/GameSDK": "GameSDK", "../../Common/Util/MD5": "MD5", "../../Common/Util/NetUtil": "NetUtil", "../Info/FbInfo": "FbInfo" }], ComponentUtil: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "ee094k6LolPCro6qMjRY5RS", "ComponentUtil"), Object.defineProperty(n, "__esModule", { value: !0 });var o = t("../UI/UIPanel"),
        i = function () {
      function t() {}return t.getComponent = function (e, n, o) {
        if (void 0 === o && (o = null), n) {
          if (null == o) return n.getComponent(e);var i = t.getNode(n, o);if (i) return i.getComponent(e);
        }return null;
      }, t.getAllComponents = function (t, e) {
        var n = [];if (e) for (var o, i, r = [e], a = 0; a < r.length;) {
          (i = (o = r[a]).getComponent(t)) && n.push(i), o.children.length > 0 && (r = r.concat(o.children)), a++;
        }return n;
      }, t.getNode = function (t, e) {
        if (void 0 === e && (e = null), t && e) {
          for (var n = e.split("/"), o = t, i = 0; i < n.length && null != o; i++) {
            o = o.getChildByName(n[i]);
          }return o;
        }return null;
      }, t.getUIPanel = function (t) {
        for (var e, n = t.getComponents(cc.Component), i = 0; i < n.length; i++) {
          if ((e = n[i]) && e instanceof o.default) return e;
        }return null;
      }, t.getNodeList = function (e) {
        for (var n = [e], o = e.children, i = 0; i < o.length; i++) {
          var r = t.getNodeList(o[i]);n = n.concat(r);
        }return n;
      }, t.findNode = function (e, n) {
        for (var o = t.getNodeList(n), i = 0; i < o.length; i++) {
          if ((n = o[i]).name == e) return n;
        }return null;
      }, t.setGray = function (e, n) {
        void 0 === n && (n = !0);for (var o = t.getNodeList(e), i = 0; i < o.length; i++) {
          var r = o[i].getComponent(cc.Sprite);r && r.node.isGray != n && (n ? r.setMaterial(0, cc.Material.getBuiltinMaterial("2d-gray-sprite")) : r.setMaterial(0, cc.Material.getBuiltinMaterial("2d-sprite")), r.node.isGray = n);
        }
      }, t.setButtonEnable = function (e, n) {
        for (var o = t.getAllComponents(cc.Button, e), i = 0; i < o.length; i++) {
          o[i].interactable = n;
        }
      }, t.loadResImg = function (t, e) {
        cc.resources.load(e, cc.SpriteFrame, function (n, o) {
          n ? console.log("SpriteFrame", n, e) : t.node && (t.spriteFrame = o);
        });
      }, t.loadRemoteImg = function (t, e, n, o, i) {
        cc.assetManager.loadRemote(e, { ext: ".png" }, function (e, r) {
          if (e) return console.log("err:" + JSON.stringify(e)), void (i && o && i.call(o));t.spriteFrame = new cc.SpriteFrame(r), n && o && n.call(o);
        });
      }, t;
    }();n.default = i, cc._RF.pop();
  }, { "../UI/UIPanel": "UIPanel" }], ConfigManager: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "5aaf0JJJkBNmqAzH08kEJZH", "ConfigManager"), Object.defineProperty(n, "__esModule", { value: !0 });var o = t("../Core/ByteArray"),
        i = function () {
      function t() {}return Object.defineProperty(t, "ins", { get: function get() {
          return null == t._ins && (t._ins = new t()), t._ins;
        }, enumerable: !1, configurable: !0 }), t.prototype.loadRequest = function (t) {
        if (this._files = {}, null != t) {
          var e,
              n,
              i,
              r,
              a,
              s = new o.default(t.slice(0, 1)).readUnsignedByte(),
              c = t.slice(1);(a = s % 2 == 1 ? this.decompress(c) : new o.default(c)).endian = o.default.LITTLE_ENDIAN, a.position = 0, e = a.readInt();for (var l = 0; l < e; l++) {
            n = a.readUTFBytes(32), i = a.readInt(), r = a.readInt(), this._files[n] = { pos: i, size: r };
          }this._buffs = new o.default(), this._buffs.endian = o.default.LITTLE_ENDIAN, this._buffs.position = 0, a.readBytes(this._buffs, 0);
        }
      }, t.prototype.decompress = function (t) {
        var e = new Uint8Array(t),
            n = (e.byteOffset, new Zlib.Inflate(e).decompress());return new o.default(new Uint8Array(n).buffer);
      }, t.prototype.getConfigString = function (t) {
        if (this._files) {
          var e = this._files[t];if (e && this._buffs && e.pos + e.size <= this._buffs.length) return this._buffs.position = e.pos, this._buffs.readUTFBytes(e.size);
        }return "";
      }, t._ins = null, t;
    }();n.default = i, cc._RF.pop();
  }, { "../Core/ByteArray": "ByteArray" }], DataManager: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "7dabfou1EBC4KGe4YAqOzSb", "DataManager"), Object.defineProperty(n, "__esModule", { value: !0 });var o = t("../Core/GameType"),
        i = t("./GlobalEventManager"),
        r = t("./TimeManager"),
        a = t("../../Game/Manager/GameManager"),
        s = t("./Logger"),
        c = function () {
      function t() {}return t.init = function (e) {
        s.default.log(e), null != e && null != e.d && (t.lastTime = e.d), null != e && null != e.sri && (t.select_role_id = e.sri), s.default.log("------DataManager-----------init-----------------"), s.default.log(e), a.default.load(e), i.default.on(o.GlobalEvent.EVENT_NEW_DAY, t.onNewDayHandler, t), i.default.on(o.InfoEvent.EVENT_SAVE, t.save, t), t.initFinish = !0;
      }, t.onNewDayHandler = function () {
        a.default.onNewDayHandler();
      }, Object.defineProperty(t, "getSaveData", { get: function get() {
          var e = t._saveData;return a.default.save(e), e.d = r.default.serverTime, e.sri = t.select_role_id, e;
        }, enumerable: !1, configurable: !0 }), t.logout = function () {
        var e = t.getSaveData;i.default.dispatchEvent(o.SdkEvent.LOGOUT, e);
      }, t.save = function () {
        if (t.initFinish) {
          var e = t.getSaveData;s.default.log("---save-----", e), i.default.dispatchEvent(o.SdkEvent.SAVE_DATA, e);
        }
      }, t.saveOpenData = function () {
        t.initFinish && i.default.dispatchEvent(o.SdkEvent.SAVE_OPEN_DATA);
      }, t._saveData = {}, t.initFinish = !1, t.lastTime = r.default.serverTime, t.select_role_id = 0, t;
    }();n.default = c, cc._RF.pop();
  }, { "../../Game/Manager/GameManager": "GameManager", "../Core/GameType": "GameType", "./GlobalEventManager": "GlobalEventManager", "./Logger": "Logger", "./TimeManager": "TimeManager" }], DebugPanel: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "ef508TnniVJZpK/wdITNplO", "DebugPanel");var _o16,
        i = this && this.__extends || (_o16 = function o(t, e) {
      return (_o16 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o16(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Core/GameType"),
        c = t("../../Common/Util/ComponentUtil"),
        l = t("../../Common/Manager/MusicManager"),
        u = t("../../Common/UI/UIManager"),
        f = t("../Tips/GeneralTips"),
        d = t("../Info/PlayerInfo"),
        h = cc._decorator,
        p = h.ccclass,
        _ = (h.property, function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return s.UILayerType.PopLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.btn_close = c.default.getComponent(cc.Button, this.node, "frame/btn_close"), this.btn_close.node.on(cc.Node.EventType.TOUCH_END, this.onTouchCloseHandler, this), this.btn_submit = c.default.getComponent(cc.Button, this.node, "frame/btn_submit"), this.btn_submit.node.on(cc.Node.EventType.TOUCH_END, this.onTouchSubmitHandler, this), this.editbox = c.default.getComponent(cc.EditBox, this.node, "frame/editbox"), this.lb_out = c.default.getComponent(cc.Label, this.node, "frame/lb_out");
      }, e.prototype.onShow = function () {}, e.prototype.onTouchCloseHandler = function () {
        l.default.playEffect(l.default.CLICK), u.default.close(this);
      }, e.prototype.onTouchSubmitHandler = function () {
        var t = this.editbox.string.split(" ");switch (t[0]) {case "money":
            isNaN(parseInt(t[1])) ? f.default.show("\u53C2\u6570\u65E0\u6548") : d.default.ins.money = parseInt(t[1]);break;case "test":
            f.default.show("XXX\u4E0EXXX\u5728\u4E00\u9053\u83DC\u4E2D\u4F1A\u5F71\u54CD\u53E3\u5473\u5594~");break;default:
            console.log(this.lb_out), f.default.show("\u547D\u4EE4\u65E0\u6548"), u.default.close(this);}
      }, e.prototype.onDestroy = function () {
        this.btn_close.node.targetOff(this), this.btn_submit.node.targetOff(this), this.lb_out = null, t.prototype.onDestroy.call(this);
      }, r([p], e);
    }(a.default));n.default = _, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Info/PlayerInfo": "PlayerInfo", "../Tips/GeneralTips": "GeneralTips" }], ExchangeAddrPanel: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "2c61bLeoo9LJbHW8Ufh+gvd", "ExchangeAddrPanel");var _o17,
        i = this && this.__extends || (_o17 = function o(t, e) {
      return (_o17 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o17(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Util/ComponentUtil"),
        c = t("../../Common/Manager/MusicManager"),
        l = t("../../Common/Core/GameType"),
        u = t("../../Common/UI/UIManager"),
        f = t("./ExchangeConfirm"),
        d = t("../../Common/Sdks/GameSDK"),
        h = t("../Info/AddrInfo"),
        p = cc._decorator,
        _ = p.ccclass,
        m = (p.property, function (t) {
      function e() {
        var e = t.call(this) || this;return e._isForceShade = !0, e;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return l.UILayerType.SubPopLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.btn_close = s.default.getComponent(cc.Button, this.node, "frame/btn_close"), this.btn_close.node.on(cc.Node.EventType.TOUCH_END, this.onTouchCloseHandler, this), this.btn_ok = s.default.getComponent(cc.Button, this.node, "frame/btn_ok"), this.btn_ok.node.on(cc.Node.EventType.TOUCH_END, this.onTouchOkHandler, this), this.edx_name = s.default.getComponent(cc.EditBox, this.node, "frame/edx_name"), this.edx_qq = s.default.getComponent(cc.EditBox, this.node, "frame/edx_qq"), this.edx_tel = s.default.getComponent(cc.EditBox, this.node, "frame/edx_tel"), this.edx_addr = s.default.getComponent(cc.EditBox, this.node, "frame/edx_addr");
      }, e.prototype.onShow = function () {
        this.refresh();
      }, e.prototype.onClose = function () {}, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), this.btn_close.node.targetOff(this), this.btn_ok.node.targetOff(this);
      }, e.prototype.refresh = function () {
        null != h.default.ins.name && (this.edx_name.string = h.default.ins.name), null != h.default.ins.qq && (this.edx_qq.string = h.default.ins.qq), null != h.default.ins.tel && (this.edx_tel.string = h.default.ins.tel), null != h.default.ins.addr && (this.edx_addr.string = h.default.ins.addr);
      }, e.prototype.onTouchCloseHandler = function () {
        c.default.playEffect(c.default.CLICK), u.default.close(this);
      }, e.prototype.onTouchOkHandler = function () {
        c.default.playEffect(c.default.CLICK);var t = this.edx_name.string,
            e = this.edx_qq.string,
            n = this.edx_tel.string,
            o = this.edx_addr.string;"" != t && "" != e && "" != n && "" != o ? (h.default.ins.setAddrInfo(t, e, n, o), u.default.show(f.default, { exchange: this.data.exchange, name: t, qq: e, tel: n, addr: o })) : d.default.showToast("\u8BF7\u586B\u5199\u6B63\u786E\u7684\u6536\u8D27\u4EBA\u4FE1\u606F\uFF0C\u5426\u5219\u65E0\u6CD5\u6536\u5230\u7269\u54C1");
      }, r([_], e);
    }(a.default));n.default = m, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/Sdks/GameSDK": "GameSDK", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Info/AddrInfo": "AddrInfo", "./ExchangeConfirm": "ExchangeConfirm" }], ExchangeConfirm: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "328abY7eudLs5XK+xgGo3CJ", "ExchangeConfirm");var _o18,
        i = this && this.__extends || (_o18 = function o(t, e) {
      return (_o18 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o18(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Util/ComponentUtil"),
        c = t("../../Common/Manager/MusicManager"),
        l = t("../../Common/Core/GameType"),
        u = t("../../Common/UI/UIManager"),
        f = t("../Manager/CommandController"),
        d = t("./ExchangeAddrPanel"),
        h = t("./ItemMessage1"),
        p = t("./ItemMessage"),
        _ = t("../../Common/Sdks/UmaTrackHelper"),
        m = t("../Config/ProductConfig"),
        g = t("../Info/PlayerInfo"),
        y = cc._decorator,
        b = y.ccclass,
        C = (y.property, function (t) {
      function e() {
        var e = t.call(this) || this;return e._isForceShade = !0, e;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return l.UILayerType.SubWindowLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.btn_close = s.default.getComponent(cc.Button, this.node, "frame/btn_close"), this.btn_close.node.on(cc.Node.EventType.TOUCH_END, this.onTouchCloseHandler, this), this.btn_ok = s.default.getComponent(cc.Button, this.node, "frame/btn_ok"), this.btn_ok.node.on(cc.Node.EventType.TOUCH_END, this.onTouchOkHandler, this);
      }, e.prototype.onShow = function () {
        this.refresh();
      }, e.prototype.onClose = function () {}, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), this.btn_close.node.targetOff(this), this.btn_ok.node.targetOff(this);
      }, e.prototype.refresh = function () {}, e.prototype.onTouchCloseHandler = function () {
        c.default.playEffect(c.default.CLICK), u.default.close(this);
      }, e.prototype.onTouchOkHandler = function () {
        c.default.playEffect(c.default.CLICK);var t = this,
            e = this.data.exchange;f.default.exchange(e.exchange.id, function (n) {
          u.default.close(t), u.default.close(d.default), null != n.id && (2 == m.default.ins.getItem(e.exchange.id).type ? u.default.show(h.default, { spId: e.exchange.id }) : u.default.show(p.default, { spId: e.exchange.id }), g.default.ins.giftCoupon = n.gfc, e.useCountChange(n.num), _.default.exchange(e.exchange.id));
        }, this, this.data.name, this.data.qq, this.data.tel, this.data.addr);
      }, r([b], e);
    }(a.default));n.default = C, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/Sdks/UmaTrackHelper": "UmaTrackHelper", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Config/ProductConfig": "ProductConfig", "../Info/PlayerInfo": "PlayerInfo", "../Manager/CommandController": "CommandController", "./ExchangeAddrPanel": "ExchangeAddrPanel", "./ItemMessage": "ItemMessage", "./ItemMessage1": "ItemMessage1" }], ExchangeGiftTips: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "2595cNTaa9Kq4elnNiMyEay", "ExchangeGiftTips");var _o19,
        i = this && this.__extends || (_o19 = function o(t, e) {
      return (_o19 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o19(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 }), n.ExchangeGiftTipsData = void 0;var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Util/ComponentUtil"),
        c = t("../../Common/Manager/MusicManager"),
        l = t("../../Common/Core/GameType"),
        u = t("../../Common/UI/UIManager"),
        f = t("../../Common/Sdks/UmaTrackHelper"),
        d = cc._decorator,
        h = d.ccclass,
        p = (d.property, function () {});n.ExchangeGiftTipsData = p;var _ = function (t) {
      function e() {
        var e = t.call(this) || this;return e._isForceShade = !0, e;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return l.UILayerType.TopLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.btn_close = s.default.getComponent(cc.Button, this.node, "frame/btn_close"), this.btn_close.node.on(cc.Node.EventType.TOUCH_END, this.onTouchCloseHandler, this), this.sp_count_label = s.default.getComponent(cc.Label, this.node, "frame/sp_item/sp_count"), this.sp_icon_sprite = s.default.getComponent(cc.Sprite, this.node, "frame/sp_item/sp_icon"), this.tips_content_label = s.default.getComponent(cc.Label, this.node, "frame/tips_content_label");
      }, e.prototype.onShow = function () {
        f.default.trackEvent("1001"), this.init(this.data);
      }, e.prototype.onClose = function () {}, e.prototype.init = function (t) {
        this.tips_content_label.string = t.content, cc.game.emit("exchangeGiftPanelRefresh");
      }, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), this.btn_close.node.targetOff(this);
      }, e.prototype.onTouchCloseHandler = function () {
        c.default.playEffect(c.default.CLICK), f.default.trackEvent("1002"), u.default.close(this);
      }, r([h], e);
    }(a.default);n.default = _, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/Sdks/UmaTrackHelper": "UmaTrackHelper", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil" }], ExtensionWorker: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "c8a21ZPfdxK97lcK0Z8FkdK", "ExtensionWorker");var _o20,
        i = this && this.__extends || (_o20 = function o(t, e) {
      return (_o20 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o20(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("./MsgPackError"),
        a = function (t) {
      function e(e, n) {
        return void 0 === e && (e = null), void 0 === n && (n = 0), t.call(this, e, n) || this;
      }return i(e, t), e.prototype.checkByte = function (t) {
        return 212 == t || 213 == t || 214 == t || 215 == t || 216 == t || 199 == t || 200 == t || 201 == t;
      }, e.prototype.assembly = function () {
        throw new r.default("Extension format not supported.");
      }, e.prototype.disassembly = function () {
        throw new r.default("Extension format not supported.");
      }, e;
    }(t("./AbstractWorker").default);n.default = a, cc._RF.pop();
  }, { "./AbstractWorker": "AbstractWorker", "./MsgPackError": "MsgPackError" }], FbDogfallPanel: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "07e69UWGxpNxIRNdNhFw9lS", "FbDogfallPanel");var _o21,
        i = this && this.__extends || (_o21 = function o(t, e) {
      return (_o21 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o21(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/Core/GameType"),
        s = t("../../Common/Util/ComponentUtil"),
        c = t("../Info/FbInfo"),
        l = t("./item/FbOverHeadInfo"),
        u = t("../../Common/Sdks/GameSDK"),
        f = t("./base/AbsFbOverPanel"),
        d = t("../../Common/Sdks/UmaTrackHelper"),
        h = cc._decorator,
        p = h.ccclass,
        _ = (h.property, function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return a.UILayerType.PopLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.txt_dec = s.default.getComponent(cc.Label, this.node, "frame/txt_dec"), this.txt_dec1 = s.default.getComponent(cc.Label, this.node, "frame/txt_dec1"), this.txt_cj1 = s.default.getComponent(cc.Label, this.node, "frame/txt_cj1"), this.txt_cj2 = s.default.getComponent(cc.Label, this.node, "frame/txt_cj2"), this.btn_gameEnd = s.default.getNode(this.node, "frame/btn_gameEnd"), this.btn_gamerePlay = s.default.getNode(this.node, "frame/btn_gamerePlay"), this.btn_close = s.default.getNode(this.node, "frame/btn_close"), this.btn_gameEnd.on(cc.Node.EventType.TOUCH_END, this.onTouchGamerePlayHandler, this), this.btn_gamerePlay.on(cc.Node.EventType.TOUCH_END, this.onGetAwardByAd, this), this.btn_close.on(cc.Node.EventType.TOUCH_END, this.onTouchCloseHandler, this), this.btn_rank = s.default.getNode(this.node, "frame/btn_rank"), this.btn_rank.on(cc.Node.EventType.TOUCH_END, this.onTouchRankHandler, this);var t = s.default.getNode(this.node, "frame/left"),
            e = s.default.getNode(this.node, "frame/right");this.head_left = new l.default(t), this.head_right = new l.default(e);
      }, e.prototype.onShow = function () {
        1 == this.data.t ? d.default.trackEvent("1325") : d.default.trackEvent("1318"), this.txt_dec.string = "" + c.default.ins.rewardMoney, this.txt_dec1.string = c.default.ins.rewardPkPoint.toString(), this.upAtlInfo(this.txt_cj1, this.txt_cj2);var t = this.data;this.head_left.setData(t.lscroe, u.default.getIcon()), this.head_right.setData(t.wscore, c.default.ins.otherPlay.icon), this.registerNetCmd();
      }, e.prototype.onClose = function () {}, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), this.head_left.destroy(), this.head_right.destroy(), this.head_left = null, this.head_right = null;
      }, r([p], e);
    }(f.default));n.default = _, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Sdks/GameSDK": "GameSDK", "../../Common/Sdks/UmaTrackHelper": "UmaTrackHelper", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Info/FbInfo": "FbInfo", "./base/AbsFbOverPanel": "AbsFbOverPanel", "./item/FbOverHeadInfo": "FbOverHeadInfo" }], FbEndPanel: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "685f74Lbz9CiLUvv+C/K/HR", "FbEndPanel");var _o22,
        i = this && this.__extends || (_o22 = function o(t, e) {
      return (_o22 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o22(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Manager/MusicManager"),
        c = t("../../Common/Core/GameType"),
        l = t("../Manager/GameManager"),
        u = t("../../Common/UI/UIManager"),
        f = t("../../Common/Sdks/GameSDK"),
        d = t("../../Common/Sdks/UmaTrackHelper"),
        h = t("../Scene/GameScene"),
        p = t("../Info/FbInfo"),
        _ = t("../../Common/Util/ComponentUtil"),
        m = t("../../Common/Manager/Logger"),
        g = t("../Main/item/FbHead"),
        y = t("../Config/RlzConfig"),
        b = t("./FbRewardPanel"),
        C = t("../../Common/Manager/LoadResManager"),
        v = t("../Main/RankPanel"),
        I = cc._decorator,
        M = I.ccclass,
        P = (I.property, function (t) {
      function e() {
        var e = t.call(this) || this;return e._isForceShade = !0, e;
      }var n;return i(e, t), n = e, Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return c.UILayerType.FbEndLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.head0 = _.default.getNode(this.node, "frame/head0"), this.head1 = _.default.getNode(this.node, "frame/head1"), this.txt_uppc = _.default.getComponent(cc.Label, this.node, "frame/txt_uppc"), this.txt_rl_value = _.default.getComponent(cc.Label, this.node, "frame/txt_rl_value"), this.btn_do = _.default.getNode(this.node, "frame/btn_do"), this.btn_ad = _.default.getNode(this.node, "frame/btn_ad"), this.btn_do.on(cc.Node.EventType.TOUCH_END, this.onTouchDoHandler, this), this.btn_ad.on(cc.Node.EventType.TOUCH_END, this.onTouchAdHandler, this), this.headCtr0 = new g.default(this.head0, !0), this.headCtr1 = new g.default(this.head1, !0), this.ad_btn_txt = _.default.getComponent(cc.Sprite, this.node, "frame/btn_ad/Background/ad_btn_txt");var t = f.default.getIcon(),
            e = f.default.getNickname();this.headCtr0.setIcon(t), this.headCtr1.setIcon(t), this.headCtr1.setTxtValue(e), this.btn_rank = _.default.getNode(this.node, "frame/btn_rank"), this.btn_rank.on(cc.Node.EventType.TOUCH_END, this.onTouchRankHandler, this);
      }, e.prototype.onTouchRankHandler = function () {
        s.default.playEffect(s.default.CLICK), u.default.show(v.default);
      }, e.prototype.onTouchDoHandler = function () {
        s.default.playEffect(s.default.CLICK), m.default.log("-------onTouchDoHandler-----------"), s.default.playEffect(s.default.CLICK), u.default.close(this), u.default.show(b.default);
      }, e.prototype.onTouchAdHandler = function () {
        if (s.default.playEffect(s.default.CLICK), m.default.log("-------onTouchAdHandler-----------"), d.default.reviveClick(p.default.ins.reviveCount), p.default.ins.reviveCount >= 2) {
          var t = "\u6211\u7684\u71C3\u529B\u503C\u5DF2\u8FBE" + p.default.ins.score + "\uFF0C\u5FEB\u6765\u4E00\u8D77\u8D62QQ\u4F1A\u5458\u514D\u8D39\u793C\u54C1\uFF01";f.default.share(this.reviveCall, this, t);
        } else f.default.showVideoAd(this.reviveCall, this, c.VideoAdType.Single);
      }, e.prototype.reviveCall = function () {
        f.default.hideBannerAd(), d.default.reviveFinish(p.default.ins.reviveCount), u.default.close(this), p.default.ins.reviveCount += 1, h.default.ins.revive();
      }, e.prototype.onShow = function () {
        this.refresh(), p.default.ins.reviveCount >= 2 ? C.default.loadSprite(this.ad_btn_txt, "Atlas/atlas_gamer_result/share_fh") : C.default.loadSprite(this.ad_btn_txt, "Atlas/atlas_gamer_result/btn_add_fh"), d.default.reviveShow(p.default.ins.reviveCount), f.default.sdkId == c.SdkType.QQ && 0 == l.default.scribeAppMsg && (f.default.sdk.subscribeAppMsg(), l.default.scribeAppMsg = 1), f.default.showBannerAd();var t = p.default.ins.currentScore.toString(),
            e = y.default.ins.getPerByRlz(p.default.ins.currentScore);this.headCtr0.setTxtValue(t), this.txt_rl_value.string = t, this.txt_uppc.string = e + "%";
      }, e.prototype.onClose = function () {
        u.default.close(n);
      }, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), this.headCtr0.destroy(), this.headCtr1.destroy(), this.headCtr0 = null, this.headCtr1 = null;
      }, e.prototype.refresh = function () {}, n = r([M], e);
    }(a.default));n.default = P, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/LoadResManager": "LoadResManager", "../../Common/Manager/Logger": "Logger", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/Sdks/GameSDK": "GameSDK", "../../Common/Sdks/UmaTrackHelper": "UmaTrackHelper", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Config/RlzConfig": "RlzConfig", "../Info/FbInfo": "FbInfo", "../Main/RankPanel": "RankPanel", "../Main/item/FbHead": "FbHead", "../Manager/GameManager": "GameManager", "../Scene/GameScene": "GameScene", "./FbRewardPanel": "FbRewardPanel" }], FbHead: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "7346fD9t41NiarlYZca3qf0", "FbHead");var _o23,
        i = this && this.__extends || (_o23 = function o(t, e) {
      return (_o23 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o23(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("../../../Common/UI/UIItem"),
        a = t("../../../Common/Util/ComponentUtil"),
        s = function (t) {
      function e(e, n) {
        void 0 === n && (n = !0);var o = t.call(this, e) || this;return o.txt_value = n ? a.default.getComponent(cc.Label, o.node, "txt_value") : null, o;
      }return i(e, t), e.prototype.init = function () {
        t.prototype.init.call(this), this.icon_head = a.default.getComponent(cc.Sprite, this.node, "mask/icon_head");
      }, e.prototype.setIcon = function (t) {
        null != t && "" != t && a.default.loadRemoteImg(this.icon_head, t);
      }, e.prototype.setTxtValue = function (t) {
        null == t && (t = "null"), this.txt_value && (this.txt_value.string = t);
      }, e.prototype.destroy = function () {
        t.prototype.destroy.call(this), this.icon_head = null, this.txt_value = null;
      }, e.prototype.setGray = function (t) {
        a.default.setGray(this.icon_head.node, t);
      }, e;
    }(r.default);n.default = s, cc._RF.pop();
  }, { "../../../Common/UI/UIItem": "UIItem", "../../../Common/Util/ComponentUtil": "ComponentUtil" }], FbInfo: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "5434aXWxndAyZ+H77P3Dlf5", "FbInfo");var _o24,
        i = this && this.__extends || (_o24 = function o(t, e) {
      return (_o24 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o24(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("../../Common/Info/AbsInfo"),
        a = t("../../Common/Core/NumValue"),
        s = t("../../Common/UI/UIManager"),
        c = t("../Fb/FbPanel"),
        l = t("../../Common/Sdks/GameSDK"),
        u = t("../../Common/Manager/DataManager"),
        f = t("../../Common/Core/NumValueBase64"),
        d = function (t) {
      function e() {
        var e = t.call(this) || this;return e._isNewRecord = !1, e._score = new a.default(), e._currentScore = new f.default(), e._reviveCount = new a.default(), e._rewardMoney = new a.default(), e._pkPoint = new a.default(), e._rewardPkPoint = new a.default(), e._pkWinNum = 0, e._otherPlay = null, e._otherPKPoint = 0, e._pkPointRank = 0, e._step = new a.default(), e;
      }return i(e, t), Object.defineProperty(e, "ins", { get: function get() {
          return null == e._ins && (e._ins = new e()), e._ins;
        }, enumerable: !1, configurable: !0 }), e.prototype.init = function (t) {
        null != t && (null != t.rlz && (this.score = t.rlz), null != t.pkp && (this.pkPoint = t.pkp), null != t.pkw && (this._pkWinNum = t.pkw), null != t.pkr && (this._pkPointRank = t.pkr));
      }, Object.defineProperty(e.prototype, "pkPointRank", { get: function get() {
          return this._pkPointRank;
        }, set: function set(t) {
          this._pkPointRank = t;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "pkWinNum", { get: function get() {
          return this._pkWinNum;
        }, set: function set(t) {
          this._pkWinNum = t;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "score", { get: function get() {
          return this._score.value;
        }, set: function set(t) {
          this._score.value != t && (this._score.value = t);
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "pkPoint", { get: function get() {
          return this._pkPoint.value;
        }, set: function set(t) {
          this._pkPoint.value != t && (this._pkPoint.value = t, u.default.saveOpenData());
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "rewardPkPoint", { get: function get() {
          return this._rewardPkPoint.value;
        }, set: function set(t) {
          this._rewardPkPoint.value != t && (this._rewardPkPoint.value = t);
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "currentScore", { get: function get() {
          return this._currentScore.value;
        }, set: function set(t) {
          this._currentScore.value != t && (this._currentScore.value = t);
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "reviveCount", { get: function get() {
          return this._reviveCount.value;
        }, set: function set(t) {
          this._reviveCount.value != t && (this._reviveCount.value = t);
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "rewardMoney", { get: function get() {
          return this._rewardMoney.value;
        }, set: function set(t) {
          this._rewardMoney.value != t && (this._rewardMoney.value = t);
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "isNewRecord", { get: function get() {
          return this._isNewRecord;
        }, set: function set(t) {
          this._isNewRecord = t;
        }, enumerable: !1, configurable: !0 }), e.prototype.set_otherPlayBy0205 = function (t) {
        this._otherPlay = null;for (var e = t.length, n = l.default.getUid(), o = 0; o < e; o++) {
          var i = t[o];if (n != i.uid) return void (this._otherPlay = i);
        }
      }, Object.defineProperty(e.prototype, "otherPlay", { get: function get() {
          return this._otherPlay;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "otherPKPoint", { get: function get() {
          return this._otherPKPoint;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "step", { get: function get() {
          return this._step.value;
        }, set: function set(t) {
          this._step.value != t && (this._step.value = t);
        }, enumerable: !1, configurable: !0 }), e.prototype.startGame = function () {
        this.currentScore = 0, this._isNewRecord = !1, this.reviveCount = 0, this.rewardMoney = 0, this.rewardPkPoint = 0, this._otherPKPoint = 0, this.step = 0;
      }, e.prototype.jumpNextStep = function (t, e) {
        void 0 === t && (t = !1), void 0 === e && (e = !1), this.currentScore += 10, t && (this.currentScore += 10), e && (this.currentScore += 10), s.default.callClazzFunc(c.default, "showData");
      }, e.prototype.buildScore = function () {
        this.currentScore > this.score && (this.isNewRecord = !0, this.score = this.currentScore);
      }, e;
    }(r.default);n.default = d, cc._RF.pop();
  }, { "../../Common/Core/NumValue": "NumValue", "../../Common/Core/NumValueBase64": "NumValueBase64", "../../Common/Info/AbsInfo": "AbsInfo", "../../Common/Manager/DataManager": "DataManager", "../../Common/Sdks/GameSDK": "GameSDK", "../../Common/UI/UIManager": "UIManager", "../Fb/FbPanel": "FbPanel" }], FbLostPanel: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "50e511KMnFK54Cy5meBVzIR", "FbLostPanel");var _o25,
        i = this && this.__extends || (_o25 = function o(t, e) {
      return (_o25 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o25(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/Core/GameType"),
        s = t("../../Common/Util/ComponentUtil"),
        c = t("../Info/FbInfo"),
        l = t("./item/FbOverHeadInfo"),
        u = t("../../Common/Sdks/GameSDK"),
        f = t("./base/AbsFbOverPanel"),
        d = t("../../Common/Sdks/UmaTrackHelper"),
        h = cc._decorator,
        p = h.ccclass,
        _ = (h.property, function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return a.UILayerType.PopLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.txt_dec = s.default.getComponent(cc.Label, this.node, "frame/txt_dec"), this.txt_dec1 = s.default.getComponent(cc.Label, this.node, "frame/txt_dec1"), this.txt_cj1 = s.default.getComponent(cc.Label, this.node, "frame/txt_cj1"), this.txt_cj2 = s.default.getComponent(cc.Label, this.node, "frame/txt_cj2"), this.btn_gameEnd = s.default.getNode(this.node, "frame/btn_gameEnd"), this.btn_gamerePlay = s.default.getNode(this.node, "frame/btn_gamerePlay"), this.btn_gameEnd.on(cc.Node.EventType.TOUCH_END, this.onTouchGamerePlayHandler, this), this.btn_gamerePlay.on(cc.Node.EventType.TOUCH_END, this.onGetAwardByAd, this), this.btn_close = s.default.getNode(this.node, "frame/btn_close"), this.btn_close.on(cc.Node.EventType.TOUCH_END, this.onTouchCloseHandler, this);var t = s.default.getNode(this.node, "frame/left"),
            e = s.default.getNode(this.node, "frame/right");this.head_left = new l.default(t), this.head_right = new l.default(e), this.btn_rank = s.default.getNode(this.node, "frame/btn_rank"), this.btn_rank.on(cc.Node.EventType.TOUCH_END, this.onTouchRankHandler, this);
      }, e.prototype.onShow = function () {
        1 == this.data.t ? d.default.trackEvent("1325") : d.default.trackEvent("1318"), this.txt_dec.string = "" + c.default.ins.rewardMoney, this.txt_dec1.string = c.default.ins.rewardPkPoint.toString(), this.upAtlInfo(this.txt_cj1, this.txt_cj2);var t = this.data;this.head_left.setData(t.lscroe, u.default.getIcon()), this.head_right.setData(t.wscore, c.default.ins.otherPlay.icon), this.registerNetCmd();
      }, e.prototype.onClose = function () {}, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), this.head_left.destroy(), this.head_right.destroy(), this.head_left = null, this.head_right = null;
      }, r([p], e);
    }(f.default));n.default = _, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Sdks/GameSDK": "GameSDK", "../../Common/Sdks/UmaTrackHelper": "UmaTrackHelper", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Info/FbInfo": "FbInfo", "./base/AbsFbOverPanel": "AbsFbOverPanel", "./item/FbOverHeadInfo": "FbOverHeadInfo" }], FbOverHeadInfo: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "ae45ek/t4NKuIuIaZEY1UGr", "FbOverHeadInfo");var _o26,
        i = this && this.__extends || (_o26 = function o(t, e) {
      return (_o26 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o26(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("../../../Common/UI/UIItem"),
        a = t("../../../Common/Util/ComponentUtil"),
        s = t("./FbHead"),
        c = function (t) {
      function e(e) {
        return t.call(this, e) || this;
      }return i(e, t), e.prototype.init = function () {
        t.prototype.init.call(this), this.mask = a.default.getNode(this.node, "mask"), this.head = new s.default(this.node), this.txt_value = a.default.getComponent(cc.Label, this.node, "txt_value");
      }, e.prototype.setData = function (t, e) {
        this.mask.active = !0, this.head.setIcon(e), this.txt_value.string = t.toString();
      }, e.prototype.destroy = function () {
        t.prototype.destroy.call(this), this.head.destroy(), this.head = null;
      }, e;
    }(r.default);n.default = c, cc._RF.pop();
  }, { "../../../Common/UI/UIItem": "UIItem", "../../../Common/Util/ComponentUtil": "ComponentUtil", "./FbHead": "FbHead" }], FbPanel: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "4690cL4Kx1KI4QaZmcwUh5D", "FbPanel");var _o27,
        i = this && this.__extends || (_o27 = function o(t, e) {
      return (_o27 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o27(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Util/ComponentUtil"),
        c = t("../../Common/Manager/MusicManager"),
        l = t("../../Common/Manager/LoadResManager"),
        u = t("../../Common/Core/GameType"),
        f = t("../Scene/GameScene"),
        d = t("../Info/SetInfo"),
        h = t("../Info/FbInfo"),
        p = t("./item/GameHeadInfo"),
        _ = t("../Net/GameClient"),
        m = t("../../Common/Manager/Logger"),
        g = t("../../Common/Sdks/GameSDK"),
        y = t("../Config/GameConfig"),
        b = t("../Info/ItemsInfo"),
        C = t("../Config/ProductConfig"),
        v = t("../../Common/Manager/TimeManager"),
        I = t("../../Common/Util/MathUtil"),
        M = cc._decorator,
        P = M.ccclass,
        S = (M.property, function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return u.UILayerType.FuncLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.btn_music = s.default.getComponent(cc.Button, this.node, "btn_music"), this.btn_music.node.on(cc.Node.EventType.TOUCH_END, this.onTouchMusicHandler, this), this.sp_music = s.default.getComponent(cc.Sprite, this.btn_music.node, "Background"), this.lb_score = s.default.getComponent(cc.Label, this.node, "tip_rlz/lb_score"), this.tip_rlz = s.default.getNode(this.node, "tip_rlz"), this.tip_pk = s.default.getNode(this.node, "tip_pk"), this._tips = s.default.getNode(this.node, "tips"), this._combo = s.default.getNode(this.node, "tips/combo"), this._imgGood = s.default.getNode(this._tips, "img_good"), this._imgPerfact = s.default.getNode(this._tips, "img_perfact"), this._imgBianshen = s.default.getNode(this._tips, "img_bianshen"), this._useItemTips = s.default.getComponent(cc.Label, this._tips, "use_item"), this._effBg = s.default.getComponent(cc.ParticleSystem3D, this._tips, "eff_bg"), this._effStar = s.default.getComponent(cc.ParticleSystem3D, this._tips, "eff_star"), this._lbContinue = s.default.getComponent(cc.Label, this._tips, "combo/lb_num"), this._imgGood.active = !1, this._imgPerfact.active = !1, this._imgBianshen.active = !1, this._tips.scale = 0, this._tipsTimer = 0, this.resetCombo(), this.notUse = s.default.getNode(this.node, "tip_pk/itemNode/notUse"), this.use = s.default.getNode(this.node, "tip_pk/itemNode/use"), this._itemProgress = s.default.getComponent(cc.Sprite, this.node, "tip_pk/itemNode/use/progress");var t = s.default.getNode(this.node, "tip_pk/head1"),
            e = s.default.getNode(this.node, "tip_pk/head2");this.head_left = new p.default(t), this.head_right = new p.default(e), this._state = s.default.getComponent(cc.Sprite, this.node, "tip_pk/state"), this._itemBtn = s.default.getComponent(cc.Button, this.node, "tip_pk/itemNode"), this._effItemL = s.default.getComponent(cc.Sprite, this.node, "tip_pk/effItemL"), this._effItemR = s.default.getComponent(cc.Sprite, this.node, "tip_pk/effItemR"), this._dieTips = s.default.getNode(this.node, "tip_pk/die_tips"), this._effFront = s.default.getNode(this.node, "tip_pk/effFront"), this.notUse.active = !(null != this._itemData), this._itemIcon = s.default.getComponent(cc.Sprite, this.node, "tip_pk/itemNode/use/icon"), this._itemTitle = s.default.getComponent(cc.Sprite, this.node, "tip_pk/itemNode/title"), this._itemBtn.node.on(cc.Node.EventType.TOUCH_END, this.onUserItemHandler, this), this._ready = s.default.getComponent(cc.Label, this.node, "tip_pk/ready"), this._ready.node.active = !1, this.rlz_bar1 = s.default.getComponent(cc.Sprite, this.node, "tip_pk/head1/jintutiao/bar1"), this.rlz_bar2 = s.default.getComponent(cc.Sprite, this.node, "tip_pk/head2/jintutiao copy/bar2");
      }, e.prototype.registerNetCmd = function () {
        _.default.ins.addPacketDataListener(518, this.on0206Handler, this), _.default.ins.addPacketDataListener(519, this.on0207Handler, this), _.default.ins.addPacketDataListener(521, this.on0209Handler, this);
      }, e.prototype.unRegisterNetCmd = function () {
        _.default.ins.removeAll(this);
      }, e.prototype.on0206Handler = function (t) {
        if (m.default.log("-------------onRoomHandler----------------"), m.default.log(t), !t.isError) {
          var e = t.body,
              n = e.uid,
              o = e.score;g.default.getUid() == n ? this.head_left.upTxtValue(o) : this.head_right.upTxtValue(o), v.default.remove(this.upEffect, this), v.default.add(this.upEffect, this, 200, 1);
        }
      }, e.prototype.upEffect = function () {
        this.head_left.score > this.head_right.score ? 1 != this._frontState && (l.default.loadSprite(this._state, "Atlas/atlas_pk/lingxian"), this._effFront.active = !0, this._effFront.x = this.head_left.x - 39, this._effFront.y = this.head_left.y, this._frontState = 1) : this.head_left.score < this.head_right.score ? 2 != this._frontState && (l.default.loadSprite(this._state, "Atlas/atlas_pk/luohou"), this._effFront.active = !0, this._effFront.x = this.head_right.x + 39, this._effFront.y = this.head_right.y, this._frontState = 2) : (this._state.spriteFrame = null, this._frontState = 0, this._effFront.active = !1);
      }, e.prototype.on0207Handler = function (t) {
        if (!t.isError) {
          var e,
              n,
              o,
              i = C.default.ins.getItem(t.body.itemId),
              r = t.body.uid;g.default.getUid() == r ? (e = cc.v2(this.head_left.x - 39, this.head_left.y), n = cc.v2(this.head_right.x + 39, this.head_right.y), o = this._effItemL, this.useItemTips("\u6254\u51FA" + i.name)) : (e = cc.v2(this.head_right.x + 39, this.head_right.y), n = cc.v2(this.head_left.x - 39, this.head_left.y), o = this._effItemR, this.useItemTips(i.name + "\u88AD\u6765")), l.default.loadSprite(o, "Atlas/atlas_item/" + i.icon), o.node.x = e.x, o.node.y = e.y, o.node.active = !0, cc.tween(o.node).bezierTo(.5, cc.v2(30, 80), cc.v2(30, 80), n).call(function (t) {
            t.active = !1;
          }.bind(this)).start();
        }
      }, e.prototype.on0209Handler = function (t) {
        if (!t.isError) {
          var e = t.body.uid;g.default.getUid() == e ? (this.head_left.setGray(!0), !this._playerDie && this.head_left.score > this.head_right.score && (this._dieTips.active = !0)) : (this._playerDie = !0, this.head_right.setGray(!0));
        }
      }, e.prototype.onShow = function () {
        this.resetCombo(), this.refresh(), this.registerNetCmd(), this.resetBar(), this.cancelPlayerDie();var t = this.data.isSport;this._effItemL.node.active = !1, this._effItemR.node.active = !1, this._effFront.active = !1, this._playerDie = !1, this._frontState = 0, this._canUseItem = !1, this._blStartGame = !1, t ? (s.default.setGray(this._itemBtn.node, !1), this._itemData = C.default.ins.getItem(b.default.ins.getAndUseItemForScene()), this._itemData && b.default.current_use_id > 0 && (this._itemData = C.default.ins.getItem(b.default.current_use_id)), this.tip_rlz.active = !1, this.tip_pk.active = !0, this.head_left.setData(g.default.getNickname(), g.default.getIcon()), this.head_right.setData(h.default.ins.otherPlay.name, h.default.ins.otherPlay.icon), this._ready.node.active = !0, this._dieTips.active = !1, this._state.spriteFrame = null, this._itemProgress.fillRange = 0, this._itemBtn.interactable = !0, this._itemBtn.enabled = !0, this.startReady()) : (this._itemData = null, this.tip_rlz.active = !0, this.tip_pk.active = !1, this._ready.node.active = !1, this._itemBtn.interactable = !1, this._itemBtn.enabled = !1), this.notUse.active = !(null != this._itemData), this.use.active = !this.notUse.active, this.notUse.active && s.default.setGray(this._itemBtn.node, !0), m.default.log(this._itemData, "\u9053\u5177\u6570\u636E"), this.head_left.setGray(!1), this.head_right.setGray(!1), this.refreshItemIcon();
      }, e.prototype.resetBar = function () {
        this.rlz_bar1.fillRange = 0, this.rlz_bar2.fillRange = 0;
      }, e.prototype.startReady = function () {
        this._countdown = 4, this.schedule(this.countdown, 1, 2), this.countdown(4);
      }, e.prototype.countdown = function () {
        this._countdown--, this._ready.node.scale = 0, this._countdown > 0 ? (this._ready.string = this._countdown + "", cc.tween(this._ready.node).to(.1, { scale: 1.5 }).start()) : 0 == this._countdown && (this._ready.string = this._countdown + "", cc.tween(this._ready.node).to(.1, { scale: 1 }).delay(.8).to(.1, { scale: 0 }).call(this.startGame.bind(this)).start());
      }, e.prototype.startGame = function () {
        this._blStartGame = !0, this._ready.node.active = !1, f.default.ins.startGame(), this.refreshItemIcon(), this.schedule(this.updateBar, .2, 300, 0);
      }, e.prototype.updateBar = function () {
        this.rlz_bar1.fillRange += 1 / 300, this.rlz_bar2.fillRange += 1 / 300;
      }, e.prototype.refreshItemIcon = function () {
        var t;cc.Tween.stopAllByTarget(this.use), this._itemBtn.node.scale = 1, this._itemData ? (this._itemIcon.node.active = !0, t = "Atlas/atlas_item/" + this._itemData.icon, this._canUseItem ? cc.tween(this.use).to(.2, { scale: 1.2 }).to(.2, { scale: .9 }).union().repeatForever().start() : t = "Atlas/atlas_item/" + this._itemData.icon + "_gray", this._blStartGame ? this._canUseItem ? l.default.loadSprite(this._itemTitle, "Atlas/atlas_pk/txt_ksy") : l.default.loadSprite(this._itemTitle, "Atlas/atlas_pk/txt_cnz") : l.default.loadSprite(this._itemTitle, "Atlas/atlas_pk/txt_dj"), l.default.loadSprite(this._itemIcon, t)) : (this._itemIcon.node.active = !1, l.default.loadSprite(this._itemTitle, "Atlas/atlas_pk/txt_dj"));
      }, e.prototype.onClose = function () {
        this.unRegisterNetCmd();
      }, e.prototype.cancelReady = function () {
        cc.Tween.stopAllByTarget(this._ready.node), this.unschedule(this.countdown), this.unschedule(this.updateBar), this._ready.node.active = !1;
      }, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), this.btn_music.node.targetOff(this), this.head_left.destroy(), this.head_right.destroy(), this.head_left = null, this.head_right = null;
      }, e.prototype.refresh = function () {
        1 == d.default.ins.music ? (f.default.ins.musicVolume(1), l.default.loadSprite(this.sp_music, "Atlas/atlas_main/home_icon_music_on")) : (f.default.ins.musicVolume(0), l.default.loadSprite(this.sp_music, "Atlas/atlas_main/home_icon_music_off")), this.showData();
      }, e.prototype.onTouchMusicHandler = function () {
        c.default.playEffect(c.default.CLICK), 1 == d.default.ins.music ? (d.default.ins.music = 0, l.default.loadSprite(this.sp_music, "Atlas/atlas_main/home_icon_music_off"), f.default.ins.musicVolume(0)) : (d.default.ins.music = 1, l.default.loadSprite(this.sp_music, "Atlas/atlas_main/home_icon_music_on"), f.default.ins.musicVolume(1));
      }, e.prototype.showData = function () {
        this.lb_score.string = h.default.ins.currentScore.toString();
      }, e.prototype.update = function (t) {
        this._tipsTimer > 0 && (this._tipsTimer -= t, this._tipsTimer <= 0 && cc.tween(this._tips).to(.1, { scale: 0 }).start()), this._itemData && (y.default.Energy >= 50 ? this._canUseItem || (this._canUseItem = !0, this.refreshItemIcon()) : this._canUseItem && (this._canUseItem = !1, this.refreshItemIcon()), this._itemProgress.fillRange = I.default.clamp(y.default.Energy / 50, 0, 1));
      }, e.prototype.onUserItemHandler = function () {
        this._itemBtn.enabled && (c.default.playEffect(c.default.CLICK), this._itemData && y.default.Energy >= 50 && f.default.ins.useItem(this._itemData) && (y.default.Energy = 0));
      }, e.prototype.showComboTips = function () {
        this._continueNum++, this._tipsTimer <= 1 && (this._tipsTimer = 1, this._imgBianshen.active = !1, this._useItemTips.node.active = !1, this._tips.scale = 0, this._continueNum % 10 == 0 ? (this._combo.active = !1, this._continueNum / 10 < 2 ? (this._imgPerfact.active = !0, this._imgGood.active = !1) : (this._imgPerfact.active = !1, this._imgGood.active = !0), this._effBg.stop(), this._effBg.play(), this._effStar.stop(), this._effStar.play(), c.default.playEffect(c.default.PERFECT)) : (this._combo.active = !0, this._lbContinue.string = "x" + this._continueNum, this._imgPerfact.active = !1, this._imgGood.active = !1), this._tips.x = 220, cc.tween(this._tips).to(.1, { scale: 1 }).start());
      }, e.prototype.resetCombo = function () {
        this._continueNum = 0;
      }, e.prototype.playerDie = function () {
        this._tipsTimer = 3, this._imgBianshen.active = !0, this._combo.active = !1, this._imgPerfact.active = !1, this._imgGood.active = !1, this._useItemTips.node.active = !1, this._effBg.stop(), this._effBg.play(), this._effStar.stop(), this._effStar.play(), c.default.playEffect(c.default.PERFECT), this._tips.scale = 0, this._tips.x = 0, cc.tween(this._tips).to(.1, { scale: 1 }).start();
      }, e.prototype.useItemTips = function (t) {
        cc.Tween.stopAllByTarget(this._tips), this._tipsTimer = 2, this._imgBianshen.active = !1, this._combo.active = !1, this._imgPerfact.active = !1, this._imgGood.active = !1, this._useItemTips.node.active = !0, this._useItemTips.string = t, this._tips.scale = 0, this._tips.x = 0, cc.tween(this._tips).delay(.3).to(.1, { scale: 1 }).start();
      }, e.prototype.cancelPlayerDie = function () {
        cc.tween(this._tips).to(.1, { scale: 0 }).start();
      }, e.prototype.heroDie = function () {}, r([P], e);
    }(a.default));n.default = S, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/LoadResManager": "LoadResManager", "../../Common/Manager/Logger": "Logger", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/Manager/TimeManager": "TimeManager", "../../Common/Sdks/GameSDK": "GameSDK", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../../Common/Util/MathUtil": "MathUtil", "../Config/GameConfig": "GameConfig", "../Config/ProductConfig": "ProductConfig", "../Info/FbInfo": "FbInfo", "../Info/ItemsInfo": "ItemsInfo", "../Info/SetInfo": "SetInfo", "../Net/GameClient": "GameClient", "../Scene/GameScene": "GameScene", "./item/GameHeadInfo": "GameHeadInfo" }], FbPkInvitePanel: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "c054b0GYAdIKZThJn5g5/TZ", "FbPkInvitePanel");var _o28,
        i = this && this.__extends || (_o28 = function o(t, e) {
      return (_o28 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o28(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Util/ComponentUtil"),
        c = t("../../Common/Core/GameType"),
        l = t("../../Common/UI/UIManager"),
        u = t("../Net/GameClient"),
        f = t("../../Common/Manager/SysConfig"),
        d = t("../../Common/Manager/Logger"),
        h = t("../../Common/Manager/TimeManager"),
        p = t("./item/PKHeadInfo"),
        _ = t("../../Common/Sdks/GameSDK"),
        m = t("../Info/FbInfo"),
        g = t("../Scene/GameScene"),
        y = t("../../Common/Manager/MusicManager"),
        b = t("../Main/MainPanel"),
        C = t("../Main/SignPanel"),
        v = cc._decorator,
        I = v.ccclass,
        M = (v.property, function (t) {
      function e() {
        var e = null !== t && t.apply(this, arguments) || this;return e._countdown = 0, e;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return c.UILayerType.PopLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        d.default.log("---------FbPkInvitePanel---onStart---");var t = s.default.getNode(this.node, "frame/top/hinfo_left"),
            e = s.default.getNode(this.node, "frame/top/hinfo_right");this.head_left = new p.default(t), this.head_right = new p.default(e), this.btn_cancel = s.default.getNode(this.node, "frame/btn_cancel"), this.btn_cancel.on(cc.Node.EventType.TOUCH_END, this.onTouchCancelHandler, this), this.txt_dt = s.default.getComponent(cc.Label, this.node, "frame/txt_dt");
      }, e.prototype.registerNetCmd = function () {
        u.default.ins.addPacketDataListener(257, this.onLoginHandler, this), u.default.ins.addPacketDataListener(258, this.cmd0x0102Handler, this), u.default.ins.addPacketDataListener(516, this.onCancelHandler, this), u.default.ins.addPacketDataListener(517, this.onGameStartHandler, this);
      }, e.prototype.unRegisterNetCmd = function () {
        u.default.ins.removeAll(this);
      }, e.prototype.onTouchCancelHandler = function () {
        d.default.log("---------FbPkInvitePanel---onTouchCancelHandler---"), y.default.playEffect(y.default.CLICK), u.default.ins.connected ? u.default.ins.send(516, {}) : (u.default.ins.cancelReconnect(), this.onCancelHandler(null));
      }, e.prototype.onCancelHandler = function () {
        u.default.ins.close(), l.default.close(this), g.default.ins.closeGame(), l.default.show(b.default);
      }, e.prototype.onShow = function () {
        l.default.close(C.default), this.registerNetCmd(), this._roomId = _.default.getRoomId(), d.default.log("FbPkInvitePanel show roomId:", this._roomId), this.refresh(), this.head_left.onShow(), this.head_right.onShow(), this.head_left.setData(_.default.getNickname(), m.default.ins.pkWinNum, _.default.getIcon(), m.default.ins.pkPointRank), this.schedule(this.countdown, 1, 9999), this._countdown = 0, this.countdown(), this.btn_cancel.active = !1;
      }, e.prototype.countdown = function () {
        d.default.log("---------------countdown " + this._countdown), this._countdown++, this.txt_dt.string = "\u7B49\u5F85\u65F6\u95F4\uFF1A" + this._countdown + "\u79D2", this.btn_cancel.active || 10 != this._countdown || (this.btn_cancel.active = !0);
      }, e.prototype.onClose = function () {
        this.unscheduleAllCallbacks(), this.unRegisterNetCmd(), this._roomId = null, this._body = null, _.default.clearRoomId(), h.default.removeTarget(this);
      }, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this);
      }, e.prototype.refresh = function () {
        u.default.ins.connected ? (u.default.ins.close(), h.default.add(function () {
          u.default.ins.connect(f.default.SOCKET_HOST);
        }, this, 500, 1)) : u.default.ins.connect(f.default.SOCKET_HOST);
      }, e.prototype.cmd0x0102Handler = function (t) {
        l.default.close(this), _.default.showToast(t.body.m);
      }, e.prototype.onLoginHandler = function () {
        u.default.ins.send(515, { rid: this._roomId });
      }, e.prototype.onGameStartHandler = function (t) {
        t.isError || (this._body = t.body, m.default.ins.set_otherPlayBy0205(this._body.l), this.setOtherHeadInfo(), this.ready());
      }, e.prototype.ready = function () {
        g.default.ins.startSport(this._body), l.default.close(this);
      }, e.prototype.setOtherHeadInfo = function () {
        var t = m.default.ins.otherPlay;this.head_right.setData(t.name, t.pkw, t.icon, t.pkr);
      }, r([I], e);
    }(a.default));n.default = M, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/Logger": "Logger", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/Manager/SysConfig": "SysConfig", "../../Common/Manager/TimeManager": "TimeManager", "../../Common/Sdks/GameSDK": "GameSDK", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Info/FbInfo": "FbInfo", "../Main/MainPanel": "MainPanel", "../Main/SignPanel": "SignPanel", "../Net/GameClient": "GameClient", "../Scene/GameScene": "GameScene", "./item/PKHeadInfo": "PKHeadInfo" }], FbPkMatchPanel: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "65710nRhM5GbqAKTDWVpagd", "FbPkMatchPanel");var _o29,
        i = this && this.__extends || (_o29 = function o(t, e) {
      return (_o29 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o29(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Util/ComponentUtil"),
        c = t("../../Common/Manager/MusicManager"),
        l = t("../../Common/Core/GameType"),
        u = t("../../Common/UI/UIManager"),
        f = t("../Net/GameClient"),
        d = t("../../Common/Manager/SysConfig"),
        h = t("../../Common/Manager/Logger"),
        p = t("../../Common/Manager/TimeManager"),
        _ = t("../Scene/GameScene"),
        m = t("../../Common/Util/MTween"),
        g = t("./item/PKHeadInfo"),
        y = t("../../Common/Sdks/GameSDK"),
        b = t("../Info/FbInfo"),
        C = t("../Main/MainPanel"),
        v = t("./FbPanel"),
        I = t("../../Common/Sdks/UmaTrackHelper"),
        M = t("../Main/SignPanel"),
        P = t("../../Common/Manager/GlobalEventManager"),
        S = cc._decorator,
        T = S.ccclass,
        U = (S.property, function (t) {
      function e() {
        var e = null !== t && t.apply(this, arguments) || this;return e.stateTweem = null, e;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return l.UILayerType.PopLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.btn_cancel = s.default.getComponent(cc.Button, this.node, "frame/state1/btn_cancel"), this.btn_cancel.node.on(cc.Node.EventType.TOUCH_END, this.onTouchCancelHandler, this), this.btn_cancel.node.active = !1, this.state1 = s.default.getNode(this.node, "frame/state1"), this.state2 = s.default.getNode(this.node, "frame/state2"), this.state2_ct = s.default.getNode(this.state2, "ct"), this.stateTweem = new m.default();var t = s.default.getNode(this.node, "frame/top/hinfo_left"),
            e = s.default.getNode(this.node, "frame/top/hinfo_right");this.timer = s.default.getComponent(cc.Label, this.node, "frame/timer"), this.head_left = new g.default(t), this.head_right = new g.default(e);
      }, e.prototype.registerNetCmd = function () {
        f.default.ins.addPacketDataListener(257, this.onLoginHandler, this), f.default.ins.addPacketDataListener(258, this.cmd0x0102Handler, this), f.default.ins.addPacketDataListener(513, this.onRoomHandler, this), f.default.ins.addPacketDataListener(516, this.onCancelHandler, this), f.default.ins.addPacketDataListener(517, this.onGameStartHandler, this);
      }, e.prototype.unRegisterNetCmd = function () {
        f.default.ins.removeAll(this);
      }, e.prototype.onShow = function () {
        u.default.close(M.default), this.registerNetCmd(), this.state1.active = !0, this.state2.active = !1, this.head_left.onShow(), this.head_right.onShow(), this.head_left.setData(y.default.getNickname(), b.default.ins.pkWinNum, y.default.getIcon(), b.default.ins.pkPointRank), u.default.close(v.default), this.refresh(), this.timer_count = 0, this.timer.string = "\u7B49\u5F85\u65F6\u95F4\uFF1A" + this.timer_count + "\u79D2", this.schedule(this.addTime, 1, cc.macro.REPEAT_FOREVER, 0);
      }, e.prototype.addTime = function () {
        this.timer_count += 1, this.timer.string = "\u7B49\u5F85\u65F6\u95F4\uFF1A" + this.timer_count + "\u79D2";
      }, e.prototype.onClose = function () {
        this.unRegisterNetCmd(), this._roomId = null, this._body = null, this.unschedule(this.addTime), P.default.off(l.GameEvent.Hide, this.onHideHandler, this);
      }, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), this.btn_cancel.node.targetOff(this);
      }, e.prototype.refresh = function () {
        f.default.ins.connect(d.default.SOCKET_HOST);
      }, e.prototype.onTouchCancelHandler = function () {
        c.default.playEffect(c.default.CLICK), I.default.trackEvent("1322"), f.default.ins.connected ? f.default.ins.send(516, {}) : (f.default.ins.cancelReconnect(), this.onCancelHandler(null));
      }, e.prototype.cmd0x0102Handler = function () {
        u.default.close(this);
      }, e.prototype.onLoginHandler = function () {
        f.default.ins.send(513, {});
      }, e.prototype.onRoomHandler = function (t) {
        h.default.log("-------------onRoomHandler----------------"), h.default.log(t), this._roomId = t.body.rid, this.btn_cancel.node.active = !0, h.default.log(this._roomId);
      }, e.prototype.onCancelHandler = function () {
        f.default.ins.close(), u.default.close(this), _.default.ins.closeGame(), u.default.show(C.default);
      }, e.prototype.onGameStartHandler = function (t) {
        t.isError || (this._body = t.body, b.default.ins.set_otherPlayBy0205(this._body.l), this.state1.active = !1, this.state2.active = !0, this.timer.string = "", this.setOtherHeadInfo(), this.state2_ct.scaleX = .001, this.state2_ct.scaleY = .001, this.stateTweem.to(this.state2_ct, { scaleX: 1, scaleY: 1 }, 100, m.MEase.linearInOut, this, this._stateTweemComplete), p.default.add(this.toState3Hd, this, 700, 1), P.default.on(l.GameEvent.Hide, this.onHideHandler, this));
      }, e.prototype.onHideHandler = function () {
        p.default.remove(this.toState3Hd, this), this.stateTweem.stop(), this._body ? (f.default.ins.addPacketDataListener(521, this.cmd0x0209Handler, this), f.default.ins.send(521, { rid: this._body.rid })) : (u.default.close(this), u.default.show(C.default));
      }, e.prototype.cmd0x0209Handler = function () {
        f.default.ins.removePacketDataListener(521, this.cmd0x0209Handler, this), f.default.ins.close(), u.default.close(this), u.default.show(C.default);
      }, e.prototype.setOtherHeadInfo = function () {
        var t = b.default.ins.otherPlay;null == t && (t = { name: "", pkw: 0, icon: "", pkr: 0 }), this.head_right.setData(t.name, t.pkw, t.icon, t.pkr);
      }, e.prototype.update = function () {
        this.stateTweem && this.stateTweem.update();
      }, e.prototype._stateTweemComplete = function () {
        p.default.add(this.toState3Hd, this, 500, 1);
      }, e.prototype.toState3Hd = function () {
        this.state2.active && (this.state1.active = !1, this.state2.active = !1, _.default.ins.startSport(this._body), u.default.close(this));
      }, r([T], e);
    }(a.default));n.default = U, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/GlobalEventManager": "GlobalEventManager", "../../Common/Manager/Logger": "Logger", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/Manager/SysConfig": "SysConfig", "../../Common/Manager/TimeManager": "TimeManager", "../../Common/Sdks/GameSDK": "GameSDK", "../../Common/Sdks/UmaTrackHelper": "UmaTrackHelper", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../../Common/Util/MTween": "MTween", "../Info/FbInfo": "FbInfo", "../Main/MainPanel": "MainPanel", "../Main/SignPanel": "SignPanel", "../Net/GameClient": "GameClient", "../Scene/GameScene": "GameScene", "./FbPanel": "FbPanel", "./item/PKHeadInfo": "PKHeadInfo" }], FbRewardPanel: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "72cd92/6V1PBJpmSVMk1SFK", "FbRewardPanel");var _o30,
        i = this && this.__extends || (_o30 = function o(t, e) {
      return (_o30 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o30(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Manager/MusicManager"),
        c = t("../../Common/Core/GameType"),
        l = t("../Manager/GameManager"),
        u = t("../../Common/UI/UIManager"),
        f = t("../../Common/Sdks/GameSDK"),
        d = t("../../Common/Sdks/UmaTrackHelper"),
        h = t("../Scene/GameScene"),
        p = t("../Info/FbInfo"),
        _ = t("../../Common/Util/ComponentUtil"),
        m = t("../../Common/Manager/Logger"),
        g = t("../Main/MainPanel"),
        y = t("../Main/item/FbHead"),
        b = t("../Config/RlzConfig"),
        C = t("../Lottery/LotteryPanel"),
        v = t("./FbPanel"),
        I = t("../Main/RankPanel"),
        M = cc._decorator,
        P = M.ccclass,
        S = (M.property, function (t) {
      function e() {
        var e = t.call(this) || this;return e._isForceShade = !0, e;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return c.UILayerType.FbEndLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.head0 = _.default.getNode(this.node, "frame/head0"), this.head1 = _.default.getNode(this.node, "frame/head1"), this.txt_uppc = _.default.getComponent(cc.Label, this.node, "frame/txt_uppc"), this.txt_rl_value = _.default.getComponent(cc.Label, this.node, "frame/txt_rl_value"), this.txt_award = _.default.getComponent(cc.Label, this.node, "frame/txt_award"), this.btn_do = _.default.getNode(this.node, "frame/btn_do"), this.btn_ad = _.default.getNode(this.node, "frame/btn_ad"), this.btn_close = _.default.getNode(this.node, "frame/btn_close"), this.btn_do.on(cc.Node.EventType.TOUCH_END, this.onTouchDoHandler, this), this.btn_ad.on(cc.Node.EventType.TOUCH_END, this.onTouchAdHandler, this), this.btn_close.on(cc.Node.EventType.TOUCH_END, this.onTouchCloseHandler, this), this.headCtr0 = new y.default(this.head0, !0), this.headCtr1 = new y.default(this.head1, !0);var t = f.default.getIcon(),
            e = f.default.getNickname();this.headCtr0.setIcon(t), this.headCtr1.setIcon(t), this.headCtr1.setTxtValue(e), this.btn_rank = _.default.getNode(this.node, "frame/btn_rank"), this.btn_rank.on(cc.Node.EventType.TOUCH_END, this.onTouchRankHandler, this);
      }, e.prototype.onTouchRankHandler = function () {
        s.default.playEffect(s.default.CLICK), u.default.show(I.default);
      }, e.prototype.onTouchDoHandler = function () {
        s.default.playEffect(s.default.CLICK), m.default.log("-------onTouchDoHandler-----------"), u.default.close(this), h.default.ins.closeGame(), u.default.show(g.default), d.default.trackEvent("1314"), u.default.show(C.default);
      }, e.prototype.onTouchAdHandler = function () {
        s.default.playEffect(s.default.CLICK), m.default.log("-------onTouchAdHandler-----------"), d.default.reviveClick(p.default.ins.reviveCount), p.default.ins.reviveCount >= 2 ? f.default.share(this.reviveCall, this) : f.default.showVideoAd(this.reviveCall, this, c.VideoAdType.Single);
      }, e.prototype.reviveCall = function () {
        f.default.hideBannerAd(), l.default.fbSingleVideoEnd(), u.default.close(this), h.default.ins.closeGame(), u.default.show(g.default), d.default.trackEvent("1313");
      }, e.prototype.onTouchCloseHandler = function () {
        f.default.hideBannerAd(), u.default.close(this), h.default.ins.closeGame(), u.default.show(g.default);
      }, e.prototype.onShow = function () {
        this.refresh(), l.default.fbSingleEnd(this.txt_award), d.default.reviveShow(p.default.ins.reviveCount), f.default.sdkId == c.SdkType.QQ && 0 == l.default.scribeAppMsg && (f.default.sdk.subscribeAppMsg(), l.default.scribeAppMsg = 1), f.default.showBannerAd();var t = p.default.ins.currentScore.toString(),
            e = b.default.ins.getPerByRlz(p.default.ins.currentScore);this.headCtr0.setTxtValue(t), this.txt_rl_value.string = t, this.txt_uppc.string = e + "%", m.default.log("-------------------lb_score " + t);
      }, e.prototype.onClose = function () {
        u.default.close(v.default);
      }, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), this.headCtr0.destroy(), this.headCtr1.destroy(), this.headCtr0 = null, this.headCtr1 = null;
      }, e.prototype.refresh = function () {}, r([P], e);
    }(a.default));n.default = S, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/Logger": "Logger", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/Sdks/GameSDK": "GameSDK", "../../Common/Sdks/UmaTrackHelper": "UmaTrackHelper", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Config/RlzConfig": "RlzConfig", "../Info/FbInfo": "FbInfo", "../Lottery/LotteryPanel": "LotteryPanel", "../Main/MainPanel": "MainPanel", "../Main/RankPanel": "RankPanel", "../Main/item/FbHead": "FbHead", "../Manager/GameManager": "GameManager", "../Scene/GameScene": "GameScene", "./FbPanel": "FbPanel" }], FbWinPanel: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "1d05b6eB2tM6Y1ublp6lGly", "FbWinPanel");var _o31,
        i = this && this.__extends || (_o31 = function o(t, e) {
      return (_o31 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o31(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/Core/GameType"),
        s = t("../../Common/Util/ComponentUtil"),
        c = t("../Info/FbInfo"),
        l = t("./item/FbOverHeadInfo"),
        u = t("../../Common/Sdks/GameSDK"),
        f = t("./base/AbsFbOverPanel"),
        d = t("../../Common/Sdks/UmaTrackHelper"),
        h = cc._decorator,
        p = h.ccclass,
        _ = (h.property, function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return a.UILayerType.PopLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.txt_dec = s.default.getComponent(cc.Label, this.node, "frame/txt_dec"), this.txt_dec1 = s.default.getComponent(cc.Label, this.node, "frame/txt_dec1"), this.txt_cj1 = s.default.getComponent(cc.Label, this.node, "frame/txt_cj1"), this.txt_cj2 = s.default.getComponent(cc.Label, this.node, "frame/txt_cj2"), this.btn_gameEnd = s.default.getNode(this.node, "frame/btn_gameEnd"), this.btn_gamerePlay = s.default.getNode(this.node, "frame/btn_gamerePlay"), this.btn_gameEnd.on(cc.Node.EventType.TOUCH_END, this.onTouchGamerePlayHandler, this), this.btn_gamerePlay.on(cc.Node.EventType.TOUCH_END, this.onGetAwardByAd, this), this.btn_close = s.default.getNode(this.node, "frame/btn_close"), this.btn_close.on(cc.Node.EventType.TOUCH_END, this.onTouchCloseHandler, this);var t = s.default.getNode(this.node, "frame/left"),
            e = s.default.getNode(this.node, "frame/right");this.head_left = new l.default(t), this.head_right = new l.default(e), this.btn_rank = s.default.getNode(this.node, "frame/btn_rank"), this.btn_rank.on(cc.Node.EventType.TOUCH_END, this.onTouchRankHandler, this);
      }, e.prototype.onShow = function () {
        1 == this.data.t ? d.default.trackEvent("1325") : d.default.trackEvent("1318"), this.txt_dec.string = c.default.ins.rewardMoney + "", c.default.ins.rewardPkPoint > 0 ? this.txt_dec1.string = "+ " + c.default.ins.rewardPkPoint.toString() : this.txt_dec1.string = c.default.ins.rewardPkPoint.toString(), this.upAtlInfo(this.txt_cj1, this.txt_cj2);var t = this.data;this.head_left.setData(t.wscore, u.default.getIcon()), this.head_right.setData(t.lscroe, c.default.ins.otherPlay.icon), this.registerNetCmd();
      }, e.prototype.onClose = function () {}, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), this.head_left.destroy(), this.head_right.destroy(), this.head_left = null, this.head_right = null;
      }, r([p], e);
    }(f.default));n.default = _, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Sdks/GameSDK": "GameSDK", "../../Common/Sdks/UmaTrackHelper": "UmaTrackHelper", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Info/FbInfo": "FbInfo", "./base/AbsFbOverPanel": "AbsFbOverPanel", "./item/FbOverHeadInfo": "FbOverHeadInfo" }], FeedbackPanel: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "7ccc5oJVjlCfpYKiWev6vkr", "FeedbackPanel");var _o32,
        i = this && this.__extends || (_o32 = function o(t, e) {
      return (_o32 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o32(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Util/ComponentUtil"),
        c = t("../../Common/Manager/MusicManager"),
        l = t("../../Common/Core/GameType"),
        u = t("../../Common/UI/UIManager"),
        f = t("../../Common/Sdks/GameSDK"),
        d = cc._decorator,
        h = d.ccclass,
        p = (d.property, function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return l.UILayerType.PopLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.btn_close = s.default.getComponent(cc.Button, this.node, "frame/btn_close"), this.btn_close.node.on(cc.Node.EventType.TOUCH_END, this.onTouchCloseHandler, this), this.icon_head = s.default.getComponent(cc.Sprite, this.node, "frame/sp_head/mask/icon_head"), this.lb_uid = s.default.getComponent(cc.Label, this.node, "frame/lb_uid");
      }, e.prototype.onShow = function () {
        this.lb_uid.string = f.default.getUid();var t = f.default.getIcon();if (null != t) {
          var e = this;cc.assetManager.loadRemote(t, { ext: ".png" }, function (t, n) {
            var o = new cc.SpriteFrame(n);e.icon_head.spriteFrame = o;
          });
        }
      }, e.prototype.onClose = function () {}, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), this.btn_close.node.targetOff(this);
      }, e.prototype.onTouchCloseHandler = function () {
        c.default.playEffect(c.default.CLICK), u.default.close(this);
      }, r([h], e);
    }(a.default));n.default = p, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/Sdks/GameSDK": "GameSDK", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil" }], FightUtil: [function (t, e) {
    "use strict";
    cc._RF.push(e, "fffeawFx/9PBb6IfEAtKm4J", "FightUtil"), cc._RF.pop();
  }, {}], GameClient: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "232c9R3Q8pEKLhasizstuHJ", "GameClient");var _o33,
        i = this && this.__extends || (_o33 = function o(t, e) {
      return (_o33 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o33(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("../../Common/Util/StringUtil"),
        a = t("./Buffer/TcpBuffer"),
        s = t("../../Common/Core/ByteArray"),
        c = t("./PacketDataEvent"),
        l = t("../../Common/Manager/Logger"),
        u = t("../../Common/Sdks/GameSDK"),
        f = t("../../Common/Manager/SysConfig"),
        d = t("../../Common/Core/GameType"),
        h = t("../../Common/Manager/TimeManager"),
        p = t("../../Common/Util/MD5"),
        _ = t("../Info/FbInfo"),
        m = t("../../Common/Manager/GlobalEventManager"),
        g = function (t) {
      function e() {
        var e = t.call(this) || this;return e._stamp = Math.floor(1e3 * Math.random()), e;
      }return i(e, t), Object.defineProperty(e, "ins", { get: function get() {
          return null == e._ins && (e._ins = new e()), e._ins;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "connected", { get: function get() {
          return this._connected;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "connecting", { get: function get() {
          return this._connecting;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "host", { get: function get() {
          return this._host;
        }, enumerable: !1, configurable: !0 }), e.prototype.connect = function (t) {
        this._connecting || (this._host = t, this.disposeSocket(), this._socket = this.createSocket(this._host), this._isReconnect = !0, this._connected = !1, this._connecting = !0, this._tickCount = 0);
      }, e.prototype.reconnect = function () {
        this._host && (this.disposeSocket(), this._socket = this.createSocket(this._host), this._connected = !1, this._connecting = !0, this._tickCount = 0);
      }, e.prototype.close = function () {
        this._socket && this._connected ? this.send(260) : this._close();
      }, e.prototype._close = function () {
        this._isReconnect = !1, this._socket && (this.disposeSocket(), this._connected = !1, this._connecting = !1);
      }, e.prototype.createSocket = function (t) {
        var e = new WebSocket(t);return e.binaryType = "arraybuffer", e.onopen = this.onSocketOpen.bind(this), e.onerror = this.onSocketError.bind(this), e.onclose = this.onSocketClose.bind(this), e.onmessage = this.onReceiveMessage.bind(this), e;
      }, e.prototype.tick = function () {
        this._connected && this._isReconnect && (this._tickCount < 2 ? (this._tickCount++, this.send(e.TICKCMD)) : this.disposeSocket());
      }, e.prototype.cancelReconnect = function () {
        this._isReconnect && (this._isReconnect = !1, h.default.remove(this.tick, this));
      }, e.prototype.disposeSocket = function () {
        null != this._socket && ((this._connected || this._connecting) && this._socket.close(), this._socket = null);
      }, e.prototype.onReceiveMessage = function (t) {
        var n = new s.default(t.data);if (n.length > 0) {
          var o = a.default.test04(n),
              i = new c.default(o.cmd, o.stamp, o.body);this.log(1, o.cmd, o.stamp, o.body), this.dispatchEvent(i), o.cmd == e.TICKCMD && (this._tickCount = 0), 258 == o.cmd && this._close();
        }
      }, e.prototype.testServerClose = function () {
        var t = new c.default(260, 0, {});this.dispatchEvent(t);
      }, e.prototype.onSocketError = function () {
        l.default.log(">>> onSocketError"), m.default.dispatchEvent(d.SocketEvent.error);
      }, e.prototype.onSocketOpen = function () {
        this._connected = !0, this._connecting = !1, l.default.log(">>> onSocketOpen"), l.default.log(">>> host:", this._host), this.dispatchEvent(new cc.Event(d.SocketEvent.open, !1)), h.default.add(this.tick, this, e.TICKTIME), h.default.add(this.login, this, 100, 1);
      }, e.prototype.onSocketClose = function () {
        this.disposeSocket(), this._connected = !1, this._connecting = !1, l.default.log(">>> onSocketClose"), h.default.removeTarget(this), this._isReconnect ? this.reconnect() : m.default.dispatchEvent(d.SocketEvent.close);
      }, e.prototype.send = function (t, e) {
        if (void 0 === e && (e = null), this._connected && this._socket) {
          var n = this._stamp++,
              o = null != e ? e : {},
              i = a.default.test03(t, n, o);return this._socket.send(i.buffer), this.log(0, t, n, o), n;
        }return -1;
      }, e.prototype.addPacketDataListener = function (t, e, n) {
        this.on(this.formatCmdName(t), e, n);
      }, e.prototype.removePacketDataListener = function (t, e, n) {
        this.off(this.formatCmdName(t), e, n);
      }, e.prototype.formatCmdName = function (t) {
        return "cmd:0x" + r.default.toString(t, 16, 4).toUpperCase();
      }, e.prototype.log = function (t, n, o, i) {
        if (n != e.TICKCMD && f.default.DEBUG) {
          var r = this.getCurTime();switch (t) {case 0:
              r += " >>>\u524D\u7AEF\uFF1A";break;case 1:
              r += " <<<\u540E\u53F0\uFF1A";break;default:
              return;}r += this.formatCmdName(n) + " stamp:" + o + " body:" + JSON.stringify(null != i ? i : {}), l.default.log(r);
        }
      }, e.prototype.getCurTime = function () {
        var t = new Date();return r.default.toString(t.getHours(), 10, 2) + ":" + r.default.toString(t.getMinutes(), 10, 2) + ":" + r.default.toString(t.getSeconds(), 10, 2) + "." + r.default.toString(t.getMilliseconds(), 10, 3);
      }, e.prototype.login = function () {
        var t = {};t.uid = u.default.getUid(), t.name = u.default.getNickname(), t.icon = u.default.getIcon(), t.vip = u.default.getVip(), t.pkw = _.default.ins.pkWinNum, t.pkr = _.default.ins.pkPointRank, t.sign = p.default.hex_md5(t.uid + f.default.CLIENT_KEY), this.send(257, t);
      }, e.TICKTIME = 5e3, e.TICKCMD = 259, e.CLOSECMD = 259, e;
    }(cc.EventTarget);n.default = g, cc._RF.pop();
  }, { "../../Common/Core/ByteArray": "ByteArray", "../../Common/Core/GameType": "GameType", "../../Common/Manager/GlobalEventManager": "GlobalEventManager", "../../Common/Manager/Logger": "Logger", "../../Common/Manager/SysConfig": "SysConfig", "../../Common/Manager/TimeManager": "TimeManager", "../../Common/Sdks/GameSDK": "GameSDK", "../../Common/Util/MD5": "MD5", "../../Common/Util/StringUtil": "StringUtil", "../Info/FbInfo": "FbInfo", "./Buffer/TcpBuffer": "TcpBuffer", "./PacketDataEvent": "PacketDataEvent" }], GameConfig: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "cef1f21Nf9HFZjKiA5WXNfB", "GameConfig"), Object.defineProperty(n, "__esModule", { value: !0 }), n.StageItemType = n.DashEvent = void 0;var o = t("../../Common/Util/MathUtil"),
        i = t("../Manager/GameManager");(n.DashEvent || (n.DashEvent = {})).EVENT_CLOSE = "EVENT_DASH_CLOSE", function (t) {
      t[t.Normal = 0] = "Normal", t[t.Gold = 1] = "Gold", t[t.JiaoZi = 2] = "JiaoZi", t[t.Obstacle = 3] = "Obstacle";
    }(n.StageItemType || (n.StageItemType = {}));var r = function () {
      function t() {}return t.updateDashStep = function (e, n) {
        var r = Math.abs(Math.cos(n + e)),
            a = o.default.clamp(t.DIFFICULTY_MIN + e * i.default.difficulty, t.DIFFICULTY_MIN, t.DIFFICULTY_MAX),
            s = a / t.DIFFICULTY_MAX,
            c = 0;o.default.randomInt(t.DIFFICULTY_MIN, t.DIFFICULTY_MAX) < a && (c = 1 + 1.5 * s), t.CurStageOffset = t.StageOffset + c;var l = !1,
            u = n > 0 ? 200 : 60,
            f = n > 0 ? 10 : o.default.randomInt(1, 4);e > u ? e % f == 0 && (l = !0) : e > 30 && e <= u && e % (2 * f) == 0 && (l = !0), l ? (t.CurStageSpeed = .04 + .03 * s, t.CurStageRadius = 3 + 1 * s) : (t.CurStageSpeed = 0, t.CurStageRadius = 0);var d = .8;t.DIFFICULTY_MAX * r < a && (d = .6 + .2 * (1 - s)), t.CurStageSize = d, t.CurStageOffset = .001;
      }, t.resetDashStep = function (e) {
        void 0 === e && (e = 0), t.CurHeroSpeed = t.HeroSpeed + e, t.Energy = 0, t.CurStageOffset = t.StageOffset, t.CurStageSpeed = 0, t.CurStageRadius = 0, t.CurStageSize = .8;
      }, t.SAFETY = !0, t.HeroSpeed = 20, t.Gravity = .049, t.StageOffset = 2, t.StageSpeed = .05, t.StartsafeTime = 1, t.StageStartOffset = 1, t.ShowStageNum = 6, t.ReviveSafeTime = 2, t.MovingDiameter1 = 12, t.MovingDelicacy1 = 1.8, t.MovingDiameter = 16, t.MovingDelicacy = 1.8, t.DIFFICULTY_MIN = 1, t.DIFFICULTY_MAX = 1e3, t.StageLayouts = [[-1], [0], [1], [0], [-1, 1], [-1, 0, 1]], t.ObstacleLayouts = [[1, 0], [0, 1], [1, 1, 0], [0, 1, 1], []], t;
    }();n.default = r, cc._RF.pop();
  }, { "../../Common/Util/MathUtil": "MathUtil", "../Manager/GameManager": "GameManager" }], GameHeadInfo: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "e79399S04hF0YZi9zQSkggK", "GameHeadInfo");var _o34,
        i = this && this.__extends || (_o34 = function o(t, e) {
      return (_o34 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o34(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("../../../Common/UI/UIItem"),
        a = t("../../../Common/Util/ComponentUtil"),
        s = t("../../Main/item/FbHead"),
        c = function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), e.prototype.init = function () {
        this.head = new s.default(this.node), this.txt_value = a.default.getComponent(cc.Label, this.node, "txt_value");
      }, e.prototype.onShow = function () {}, e.prototype.setData = function (t, e) {
        this.head.setIcon(e), this.txt_value.string = "0", this._score = 0;
      }, e.prototype.upTxtValue = function (t) {
        this.txt_value.string = t.toString(), this._score = t;
      }, Object.defineProperty(e.prototype, "score", { get: function get() {
          return this._score;
        }, enumerable: !1, configurable: !0 }), e.prototype.destroy = function () {
        t.prototype.destroy.call(this), this.head.destroy(), this.head = null;
      }, e.prototype.setGray = function (t) {
        this.head && this.head.setGray(t);
      }, e;
    }(r.default);n.default = c, cc._RF.pop();
  }, { "../../../Common/UI/UIItem": "UIItem", "../../../Common/Util/ComponentUtil": "ComponentUtil", "../../Main/item/FbHead": "FbHead" }], GameInitManager: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "e6bb0dqiqRAgLY9UXU/iLiL", "GameInitManager"), Object.defineProperty(n, "__esModule", { value: !0 });var o = t("./GlobalEventManager"),
        i = t("../Core/GameType"),
        r = t("./TimeManager"),
        a = t("../Sdks/GameSDK"),
        s = t("../UI/UIManager"),
        c = t("../../Game/Main/LoadingPanel"),
        l = t("./LoadResManager"),
        u = t("../../Game/Main/MainPanel"),
        f = t("./DataManager"),
        d = function () {
      function t() {}return t.init = function () {
        window.onbeforeunload = function () {
          f.default.logout();
        }, o.default.on(i.InitStepEvent.NET_ERROR, t.onNetErrorHandler, t), o.default.on(i.InitStepEvent.INIT_SDK_FINISH, t.onInitSdkFinishHandler, t), o.default.on(i.InitStepEvent.LOGIN_FINISH, t.onLoginFinishHandler, t), o.default.on(i.InitStepEvent.LOAD_RES_FINISH, t.onLoadResFinishHandler, t), r.default.start(), a.default.init();
      }, t.onNetErrorHandler = function () {}, t.onInitSdkFinishHandler = function () {
        a.default.login();
      }, t.onLoginFinishHandler = function () {
        l.default.start();
      }, t.onLoadResFinishHandler = function () {
        t.enterMainPanel();
      }, t.enterMainPanel = function () {
        s.default.remove(c.default), s.default.show(u.default), o.default.targetOff(t);
      }, t;
    }();n.default = d, cc._RF.pop();
  }, { "../../Game/Main/LoadingPanel": "LoadingPanel", "../../Game/Main/MainPanel": "MainPanel", "../Core/GameType": "GameType", "../Sdks/GameSDK": "GameSDK", "../UI/UIManager": "UIManager", "./DataManager": "DataManager", "./GlobalEventManager": "GlobalEventManager", "./LoadResManager": "LoadResManager", "./TimeManager": "TimeManager" }], GameManager: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "416c6xUq3JFsbynOy2A5Bgl", "GameManager"), Object.defineProperty(n, "__esModule", { value: !0 });var o = t("./CommandController"),
        i = t("../Info/AddrInfo"),
        r = t("../Info/SetInfo"),
        a = t("../../Common/Manager/DataManager"),
        s = t("../Info/PlayerInfo"),
        c = t("../Info/FbInfo"),
        l = t("../../Common/UI/UIManager"),
        u = t("../Info/SignInfo"),
        f = t("../Info/ItemsInfo"),
        d = t("../Main/MainPanel"),
        h = function () {
      function t() {}return t.load = function (t) {
        this.sign8 = t.sign8, s.default.ins.init(t), i.default.ins.init(t), r.default.ins.init(t), c.default.ins.init(t), u.default.ins.init(t), f.default.ins.init(t), null != t && null != t.diff && (this._difficulty = t.diff), null == this.sign8 && (this.sign8 = 0), a.default.saveOpenData();
      }, t.save = function (t) {
        i.default.ins.saveData(t), r.default.ins.saveData(t);
      }, t.onNewDayHandler = function () {
        s.default.ins.onNewDayHandler();
      }, Object.defineProperty(t, "difficulty", { get: function get() {
          return this._difficulty;
        }, enumerable: !1, configurable: !0 }), t.startGame = function () {
        c.default.ins.startGame();
      }, t.jumpNextStep = function (t, e) {
        void 0 === t && (t = !1), void 0 === e && (e = !1), c.default.ins.jumpNextStep(t, e);
      }, t.buildScore = function () {
        c.default.ins.buildScore(), c.default.ins.isNewRecord && (a.default.save(), a.default.saveOpenData());
      }, t.fbSingleEnd = function (e) {
        o.default.fbSingle(function (t) {
          c.default.ins.score = t.score, c.default.ins.rewardMoney = t.amoney, s.default.ins.money = t.money, e.string = "\u672C\u5C40\u91D1\u5E01\uFF1A" + t.amoney;
        }, t);
      }, t.fbSingleVideoEnd = function () {
        o.default.fbSingleVideo(function (t) {
          c.default.ins.score = t.score, c.default.ins.rewardMoney = t.amoney, s.default.ins.money = t.money;
        }, t);
      }, t.fbPkEnd = function (e, n, i) {
        o.default.fbPk(e, function (t) {
          c.default.ins.pkPoint = t.pkp, c.default.ins.pkWinNum = t.pkw, c.default.ins.rewardPkPoint = t.apkp, c.default.ins.rewardMoney = t.amoney, c.default.ins.pkPointRank = t.pkr, s.default.ins.money = t.money, s.default.ins.acl = t.acl, l.default.show(n, i);
        }, t, function () {
          l.default.show(d.default);
        });
      }, t.fbPkVideoEnd = function (e) {
        o.default.fbPkVideo(e, function (t) {
          c.default.ins.pkPoint = t.pkp, c.default.ins.pkWinNum = t.pkw, c.default.ins.rewardPkPoint = t.apkp, c.default.ins.rewardMoney = t.amoney, c.default.ins.pkPointRank = t.pkr, s.default.ins.money = t.money, s.default.ins.acl = null;
        }, t);
      }, t.MAX_GIFT_COUPON = 50, t.MAX_REVIVE_COUNT = 3, t._difficulty = 1, t.scribeAppMsg = 0, t.sign8 = 0, t;
    }();n.default = h, cc._RF.pop();
  }, { "../../Common/Manager/DataManager": "DataManager", "../../Common/UI/UIManager": "UIManager", "../Info/AddrInfo": "AddrInfo", "../Info/FbInfo": "FbInfo", "../Info/ItemsInfo": "ItemsInfo", "../Info/PlayerInfo": "PlayerInfo", "../Info/SetInfo": "SetInfo", "../Info/SignInfo": "SignInfo", "../Main/MainPanel": "MainPanel", "./CommandController": "CommandController" }], GameSDK: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "26d73c2zH1OOYsoKbZxT220", "GameSDK"), Object.defineProperty(n, "__esModule", { value: !0 });var o = t("../Manager/SysConfig"),
        i = t("./SdkDefault"),
        r = t("../Manager/GlobalEventManager"),
        a = t("../Core/GameType"),
        s = t("./SdkQQ"),
        c = t("../../Game/Info/SetInfo"),
        l = function () {
      function t() {}return Object.defineProperty(t, "sdk", { get: function get() {
          return t._sdk;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t, "sdkId", { get: function get() {
          return t._sdkId;
        }, enumerable: !1, configurable: !0 }), t.init = function () {
        window.qq ? t._sdkId = a.SdkType.QQ : t._sdkId = o.default.SDK, console.log("sdk:", t._sdkId), t.initSDK();
      }, t.initSDK = function () {
        switch (t.sdkId) {case a.SdkType.QQ:
            t._sdk = new s.default();break;default:
            t._sdk = new i.default();}t.sdk.initSDK(), r.default.on(a.SdkEvent.SAVE_DATA, t.saveDataHandler, t), r.default.on(a.SdkEvent.SAVE_OPEN_DATA, t.saveOpenDataHandler, t), r.default.on(a.SdkEvent.LOGOUT, t.logoutHandler, t);
      }, t.getUid = function () {
        return t.sdk.uid;
      }, t.getNickname = function () {
        return t.sdk.nickname;
      }, t.getIcon = function () {
        return t.sdk.icon;
      }, t.getVip = function () {
        return t.sdk.vip;
      }, t.login = function () {
        t.sdk && t.sdk.login();
      }, t.loadUserData = function () {
        t.sdk.loadUserData();
      }, t.logoutHandler = function (e) {
        if (t.sdk) {
          var n = e[0];t.sdk.logout(n);
        }
      }, t.saveDataHandler = function (e) {
        if (t.sdk) {
          var n = e[0];t.sdk.saveUserData(n);
        }
      }, t.saveOpenDataHandler = function () {
        t.sdk && t.sdk.saveOpenData();
      }, t.getRankData = function (e, n) {
        void 0 === e && (e = null), void 0 === n && (n = null), t.sdk && t.sdk.getRankData(e, n);
      }, t.postMessage = function (e) {
        t.sdk && t.sdk.postMessage(e);
      }, t.isShare = function () {
        return !!t.sdk && t.sdk.isShare;
      }, t.share = function (e, n, o, i) {
        void 0 === e && (e = null), void 0 === n && (n = null), void 0 === o && (o = null), void 0 === i && (i = null), t.sdk && t.sdk.share(e, n, o, i);
      }, t.showBannerAd = function () {
        t.sdk;
      }, t.hideBannerAd = function () {}, t.showVideoAd = function (e, n, o) {
        void 0 === e && (e = null), void 0 === n && (n = null), t.sdk && t.sdk.showVideoAd(e, n, o);
      }, t.hideVideoAd = function () {
        t.sdk.hideVideoAd();
      }, t.adOpen = function () {
        return t.sdk.adOpen();
      }, t.hasInsertAd = function () {
        return !!t.sdk && t.sdk.hasInsertAd();
      }, t.showInsertAd = function () {
        t.sdk.showInsertAd();
      }, t.vibrateShort = function () {
        1 == c.default.ins.vibrate && t.sdk.vibrateShort();
      }, t.vibrateLong = function () {
        1 == c.default.ins.vibrate && t.sdk.vibrateLong();
      }, t.navigateToMiniGame = function (e) {
        t.sdk.navigateToMiniGame(e);
      }, t.isVideoRec = function () {
        return t.sdk.isVideoRec();
      }, t.videoRecStart = function () {
        t.sdk.videoRecStart();
      }, t.videoRecStop = function (e, n, o) {
        void 0 === e && (e = null), void 0 === n && (n = null), void 0 === o && (o = !1), t.sdk.videoRecStop(e, n, o);
      }, t.shareRecVideo = function (e, n) {
        void 0 === e && (e = null), void 0 === n && (n = null), t.sdk.shareRecVideo(e, n);
      }, t.clearRecVideo = function () {
        t.sdk.clearRecVideo();
      }, t.isExistRecVideo = function () {
        return t.sdk.isExistRecVideo();
      }, t.getRecSecond = function () {
        return t.sdk.getRecSecond();
      }, t.getBannerTime = function () {
        return t.sdk.banner_time;
      }, t.getShareImgUrl = function () {
        return t.sdk.getShareImgUrl();
      }, t.openUrl = function (e, n) {
        void 0 === n && (n = 0), t.sdk.openUrl(e, n);
      }, t.isIos = function () {
        return t.sdk.isIos();
      }, t.showToast = function (e, n) {
        void 0 === n && (n = 2e3), t.sdk.showToast(e, n);
      }, t.shareInvite = function () {
        t.sdk.shareInvite();
      }, t.getRoomId = function () {
        return t.sdk.roomId;
      }, t.clearRoomId = function () {
        t.sdk.clearRoomId();
      }, t;
    }();n.default = l, cc._RF.pop();
  }, { "../../Game/Info/SetInfo": "SetInfo", "../Core/GameType": "GameType", "../Manager/GlobalEventManager": "GlobalEventManager", "../Manager/SysConfig": "SysConfig", "./SdkDefault": "SdkDefault", "./SdkQQ": "SdkQQ" }], GameScene: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "d3b445CbE5IgbCw94VHo6pn", "GameScene");var _o35,
        i = this && this.__extends || (_o35 = function o(t, e) {
      return (_o35 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o35(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../Dash/HeroActor"),
        s = t("../../Common/Manager/LoadResManager"),
        c = t("../Dash/MusicController"),
        l = t("../Dash/SingleController"),
        u = t("../Dash/SportController"),
        f = t("../../Common/Manager/MusicManager"),
        d = t("../../Common/UI/UIManager"),
        h = t("../Manager/GameManager"),
        p = t("../Fb/FbPanel"),
        _ = t("../Main/MainPanel"),
        m = t("../../Common/Util/ComponentUtil"),
        g = t("../../Common/Manager/Logger"),
        y = t("../Config/RoleConfig"),
        b = t("../../Common/Manager/DataManager"),
        C = t("../Dash/ItemActor"),
        v = cc._decorator,
        I = v.ccclass,
        M = (v.property, function (t) {
      function e() {
        var e = t.call(this) || this;return n._ins = e, e;
      }var n;return i(e, t), n = e, Object.defineProperty(e, "ins", { get: function get() {
          return this._ins;
        }, enumerable: !1, configurable: !0 }), e.prototype.start = function () {
        this._camera = m.default.getComponent(cc.Camera, this.node, "camera"), this._sceneNode = m.default.getNode(this.node, "sceneNode"), this._effSnow = m.default.getNode(this.node, "eff_snow"), this._effSnow.active = !0, c.MusicController.ins.init(0), a.default.ins.is3DNode = !0, g.default.log("----------------GameScene-- start "), 0 == b.default.select_role_id && (b.default.select_role_id = y.default.def_id, b.default.save()), a.default.ins.data = b.default.select_role_id, C.ItemEffectActor.init(), this._sceneNode.addChild(a.default.ins), this.initStage(), this.resetCamera();
      }, e.prototype.resetCamera = function () {
        this._camera.node.position = cc.v3(0, 6.8, 13), this._camera.node.eulerAngles = cc.v3(-26, 0, 0);
      }, Object.defineProperty(e.prototype, "stepIdx", { get: function get() {
          return this._dashCtrl ? (g.default.log("------------------this._dashCtrl.stepIdx " + this._dashCtrl.stepIdx), this._dashCtrl.stepIdx) : (g.default.log("------------------stepIdx 0"), 0);
        }, enumerable: !1, configurable: !0 }), e.prototype.initStage = function () {
        s.default.getPrefab("Prefab/stage");var t = this;s.default.bundle.load("Prefab/stage", cc.Prefab, function (e, n) {
          t.initStageComplete(n);
        });
      }, e.prototype.initStageComplete = function (t) {
        var e;(e = cc.instantiate(t)).is3DNode = !0, e.group = "planet", e.active = !0, e.position = cc.Vec3.ZERO, e.scale = 1, this._sceneNode.addChild(e), this._stage = e;
      }, e.prototype.registerTouchListen = function () {
        var t = this.node.getChildByName("TouchNode");t && !t.hasEventListener(cc.Node.EventType.TOUCH_START) && (t.on(cc.Node.EventType.TOUCH_START, this.onTouchStartHandler, this), t.on(cc.Node.EventType.TOUCH_MOVE, this.onTouchMoveHandler, this), t.on(cc.Node.EventType.TOUCH_CANCEL, this.onTouchEndHandler, this), t.on(cc.Node.EventType.TOUCH_END, this.onTouchEndHandler, this));
      }, e.prototype.unregisterTouchListen = function () {
        this.node.getChildByName("TouchNode").targetOff(this);
      }, e.prototype.musicVolume = function (t) {
        void 0 === t && (t = 1), this._dashCtrl && this._dashCtrl.musicVolume(t);
      }, e.prototype.update = function (t) {
        this._dashCtrl && this._dashCtrl.update(t);
      }, e.prototype.onTouchStartHandler = function (t) {
        this._dashCtrl && this._dashCtrl.onTouchStartHandler(t);
      }, e.prototype.onTouchMoveHandler = function (t) {
        this._dashCtrl && this._dashCtrl.onTouchMoveHandler(t);
      }, e.prototype.onTouchEndHandler = function (t) {
        this._dashCtrl && this._dashCtrl.onTouchEndHandler(t);
      }, e.prototype.onStartGame = function (t) {
        f.default.pauseBGM(), a.default.ins.data != b.default.select_role_id && (a.default.ins.data = b.default.select_role_id), d.default.close(_.default), h.default.startGame(), d.default.show(p.default, { isSport: t }), this._effSnow.active = !1;
      }, e.prototype.startSingle = function () {
        this._dashCtrl && (this._dashCtrl.destroy(), this._dashCtrl = null), this._dashCtrl = new l.default(this.node), this._stage.scale = 1.5, this.registerTouchListen(), this.onStartGame(!1);
      }, e.prototype.startSport = function (t) {
        void 0 === t && (t = null), this._dashCtrl && (this._dashCtrl.destroy(), this._dashCtrl = null), this._dashCtrl = new u.default(this.node, t), this._stage.scale = 1.5, this.registerTouchListen(), this.onStartGame(!0);
      }, e.prototype.startGame = function () {
        this._dashCtrl && this._dashCtrl.startGame();
      }, e.prototype.revive = function () {
        this._dashCtrl && this._dashCtrl.revive();
      }, e.prototype.useItem = function (t) {
        return !!this._dashCtrl && this._dashCtrl.useItem(t);
      }, e.prototype.closeGame = function () {
        this.unregisterTouchListen(), cc.Tween.stopAllByTarget(a.default.ins), a.default.ins.position = cc.Vec3.ZERO, a.default.ins.eulerAngles = cc.Vec3.ZERO, a.default.ins.idle(), this.resetCamera(), this._effSnow.active = !0, this._stage.scale = 1, this._dashCtrl && (this._dashCtrl.destroy(), this._dashCtrl = null);
      }, n = r([I], e);
    }(cc.Component));n.default = M, cc._RF.pop();
  }, { "../../Common/Manager/DataManager": "DataManager", "../../Common/Manager/LoadResManager": "LoadResManager", "../../Common/Manager/Logger": "Logger", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/UI/UIManager": "UIManager", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Config/RoleConfig": "RoleConfig", "../Dash/HeroActor": "HeroActor", "../Dash/ItemActor": "ItemActor", "../Dash/MusicController": "MusicController", "../Dash/SingleController": "SingleController", "../Dash/SportController": "SportController", "../Fb/FbPanel": "FbPanel", "../Main/MainPanel": "MainPanel", "../Manager/GameManager": "GameManager" }], GameType: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "645f9FnWF5HKqRot1/WK0YM", "GameType"), Object.defineProperty(n, "__esModule", { value: !0 }), n.VideoAdType = n.SocketEvent = n.UIEvent = n.SdkType = n.LoadResType = n.SdkEvent = n.InitStepEvent = n.InfoEvent = n.GlobalEvent = n.ActionType = n.UILayerType = n.GameEvent = n.ActorStatus = n.ActorType = void 0, function (t) {
      t[t.Hero = 1] = "Hero", t[t.Npc = 2] = "Npc", t[t.Animal = 3] = "Animal", t[t.Item = 4] = "Item";
    }(n.ActorType || (n.ActorType = {})), function (t) {
      t[t.Idle = 1] = "Idle", t[t.Run = 2] = "Run";
    }(n.ActorStatus || (n.ActorStatus = {})), function (t) {
      t.Show = "GAME_EVENT_SHOW", t.Hide = "GAME_EVENT_HIDE";
    }(n.GameEvent || (n.GameEvent = {})), function (t) {
      t[t.BackLayer = 1] = "BackLayer", t[t.MainLayer = 2] = "MainLayer", t[t.FuncLayer = 3] = "FuncLayer", t[t.FbEndLayer = 4] = "FbEndLayer", t[t.PopLayer = 5] = "PopLayer", t[t.SubPopLayer = 6] = "SubPopLayer", t[t.SubWindowLayer = 7] = "SubWindowLayer", t[t.GuideLayer = 8] = "GuideLayer", t[t.ADLayer = 9] = "ADLayer", t[t.MoneyLayer = 10] = "MoneyLayer", t[t.NoticeTipsLayer = 11] = "NoticeTipsLayer", t[t.ItemTipsLayer = 12] = "ItemTipsLayer", t[t.DanmuLayar = 13] = "DanmuLayar", t[t.TopLayer = 14] = "TopLayer", t[t.BannerAdLayer = 15] = "BannerAdLayer", t[t.InsertAdLayer = 16] = "InsertAdLayer";
    }(n.UILayerType || (n.UILayerType = {})), function (t) {
      t[t.Normal = 1] = "Normal", t[t.Block = 2] = "Block", t[t.SameBlock = 3] = "SameBlock", t[t.Joint = 4] = "Joint";
    }(n.ActionType || (n.ActionType = {})), function (t) {
      t.EVENT_NEW_DAY = "GBE_EVENT_NEW_DAY", t.LOADING_PROCESS = "LOADING_PROCESS";
    }(n.GlobalEvent || (n.GlobalEvent = {})), function (t) {
      t.EVENT_CHANGE = "IFE_EVENT_CHANGE", t.GIFT_CHANGE = "IFE_GIFT_CHANGE", t.EVENT_SAVE = "IFE_EVENT_SAVE", t.EVENT_BUFF_FINISH = "EVENT_BUFF_FINISH", t.EVENT_REMOVE_BUFF = "EVENT_REMOVE_BUFF", t.EVENT_ADD_BUFF = "EVENT_ADD_BUFF";
    }(n.InfoEvent || (n.InfoEvent = {})), function (t) {
      t.NET_ERROR = "ITE_NET_ERROR", t.INIT_SDK_FINISH = "ITE_INIT_SDK_FINISH", t.LOGIN_FINISH = "ITE_LOGIN_FINISH", t.LOAD_RES_FINISH = "ITE_LOAD_RES_FINISH";
    }(n.InitStepEvent || (n.InitStepEvent = {})), function (t) {
      t.SAVE_DATA = "SDK_SAVE_DATA", t.SAVE_OPEN_DATA = "SDK_SAVE_OPEN_DATA", t.SAVE_OPEN_DATA_COMPLETE = "SDK_SAVE_OPEN_DATA_COMPLETE", t.LOGOUT = "SDK_LOGOUT", t.BANNER_ONERROR = "SDK_BANNER_ONERROR", t.BANNER_ONLOAD = "SDK_BANNER_ONLOAD", t.REC_VIDEO_CLEAR = "REC_VIDEO_CLEAR";
    }(n.SdkEvent || (n.SdkEvent = {})), function (t) {
      t[t.ATLAS = 1] = "ATLAS", t[t.SOUND = 2] = "SOUND", t[t.CONFIG = 3] = "CONFIG", t[t.LOAD_USER_DATA = 4] = "LOAD_USER_DATA", t[t.PREFAB = 5] = "PREFAB", t[t.LOAD_FINISH = 6] = "LOAD_FINISH", t[t.BUNDLE = 7] = "BUNDLE";
    }(n.LoadResType || (n.LoadResType = {})), function (t) {
      t[t.DEFAULT = 0] = "DEFAULT", t[t.WX = 1] = "WX", t[t.TT = 2] = "TT", t[t.OPPO = 3] = "OPPO", t[t.QQ = 4] = "QQ", t[t.MEIZU = 5] = "MEIZU", t[t.SWAM = 6] = "SWAM", t[t.VIVO = 7] = "VIVO", t[t.H4399 = 8] = "H4399", t[t.OPPO_APK = 101] = "OPPO_APK", t[t.VIVO_APK = 102] = "VIVO_APK", t[t.TAP_APK = 103] = "TAP_APK";
    }(n.SdkType || (n.SdkType = {})), function (t) {
      t.EVENT_SHOW = "UI_EVENT_SHOW", t.EVENT_CLOSE = "UI_EVENT_CLOSE";
    }(n.UIEvent || (n.UIEvent = {})), function (t) {
      t.close = "se_evt_close", t.error = "se_evt_error", t.message = "se_evt_message", t.open = "se_evt_open";
    }(n.SocketEvent || (n.SocketEvent = {})), function (t) {
      t[t.Single = 1] = "Single", t[t.Sport = 2] = "Sport", t[t.ItemUpgrade = 3] = "ItemUpgrade", t[t.Sign = 4] = "Sign", t[t.Buqian = 5] = "Buqian";
    }(n.VideoAdType || (n.VideoAdType = {})), cc._RF.pop();
  }, {}], GeneralTips: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "2c292iPshFM+4Iq1jwunhQn", "GeneralTips");var _o36,
        i = this && this.__extends || (_o36 = function o(t, e) {
      return (_o36 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o36(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/UI/UIManager"),
        c = t("../../Common/Manager/TimeManager"),
        l = t("../../Common/Core/GameType"),
        u = cc._decorator,
        f = u.ccclass,
        d = (u.property, function (t) {
      function e() {
        var e = t.call(this) || this;return n._ins = e, e._time = 0, e;
      }var n;return i(e, t), n = e, e.show = function (t, e, o) {
        void 0 === e && (e = null), void 0 === o && (o = cc.Color.WHITE), n.addToTipsList(t, e, o), s.default.show(n);
      }, e.addToTipsList = function (t, e, o) {
        if (null == e) {
          for (var i = 0; i < n._curtips.length; i++) {
            if (n._curtips[i].tips == t) return;
          }for (i = 0; i < n._tipslist.length; i++) {
            if (n._tipslist[i].tips == t) return;
          }
        }n._tipslist.push({ tips: t, color: o, time: e }), n._tipsCount++;
      }, e.push = function (t) {
        t && (t.node.parent = null, n._tipsLabelPool.push(t));
      }, e.shift = function () {
        if (n._tipsLabelPool.length > 0) return n._tipsLabelPool.shift();var t = new cc.Node(),
            e = t.addComponent(cc.Label);return t.addComponent(cc.LabelOutline), e;
      }, e.prototype.onStart = function () {}, e.prototype.update = function () {
        if (n._curtips.length + n._tipslist.length > 0) {
          var t = n._tipslist[0];t && (c.default.localTime, this._time, t.tips, this._time = c.default.localTime, this.next()), c.default.localTime - this._time > 300 && (this._time = c.default.localTime, this.next());
        } else s.default.close(this);
      }, e.prototype.next = function () {
        if (n._tipslist.length > 0) {
          var t = n._tipslist.shift(),
              e = n.shift();e.string = t.tips, e.node.position = new cc.Vec3(0, 100, 0), e.node.color = t.color;var o = e.getComponent(cc.LabelOutline);o.color = t.color, o.width = 1, e.node.scale = .5, e.node.parent = this.node, n._curtips.push(t), e.node.color, cc.tween(e.node).to(2, { scale: 1.2, position: new cc.Vec3(0, 300, 0) }, { easing: "linear" }).call(function () {
            n._curtips.shift(), n.push(e);
          }).start();
        }
      }, Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return l.UILayerType.TopLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), n._ins = null, n._tipslist = [], n._tipsLabelPool = [], n._curtips = [];
      }, e._tipslist = [], e._tipsCount = 0, e._tipsLabelPool = [], e._curtips = [], n = r([f], e);
    }(a.default));n.default = d, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/TimeManager": "TimeManager", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel" }], GlobalEventManager: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "bdf24BswGZIBb1QdM9APskz", "GlobalEventManager");var _o37,
        i = this && this.__extends || (_o37 = function o(t, e) {
      return (_o37 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o37(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), Object.defineProperty(e, "ins", { get: function get() {
          return null == e._ins && (e._ins = new e()), e._ins;
        }, enumerable: !1, configurable: !0 }), e.on = function (t, n, o) {
        return e.ins.on(t, n, o);
      }, e.off = function (t, n, o) {
        e.ins.off(t, n, o);
      }, e.targetOff = function (t) {
        e.ins.targetOff(t);
      }, e.once = function (t, n, o) {
        e.ins.once(t, n, o);
      }, e.dispatchEvent = function (t) {
        for (var n = [], o = 1; o < arguments.length; o++) {
          n[o - 1] = arguments[o];
        }e.ins.emit(t, n);
      }, e;
    }(cc.EventTarget);n.default = r, cc._RF.pop();
  }, {}], HeroActor: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "711e1htrkBJgZUUZdKlmGzq", "HeroActor");var _o38,
        i = this && this.__extends || (_o38 = function o(t, e) {
      return (_o38 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o38(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../Config/GameConfig"),
        s = t("../../Common/Util/MathUtil"),
        c = t("../../Common/Manager/LoadResManager"),
        l = t("../../Common/Util/ComponentUtil"),
        u = t("../Config/RoleConfig"),
        f = t("../../Common/Manager/Logger"),
        d = t("./ItemActor"),
        h = cc._decorator,
        p = h.ccclass,
        _ = (h.property, function (t) {
      function e() {
        var e = t.call(this) || this;return e.group = "actor", e.is3DNode = !0, e._dizzyTime = -1, e;
      }var n;return i(e, t), n = e, Object.defineProperty(e, "ins", { get: function get() {
          return null == n._ins && (n._ins = new n()), this._ins;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "locator", { get: function get() {
          return this._locator;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "animState", { get: function get() {
          return this._aState;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "isThrow", { get: function get() {
          return this._isThrow;
        }, enumerable: !1, configurable: !0 }), e.prototype.initModel = function (t) {
        this._model && this._model.removeFromParent();var e = cc.instantiate(t);this._locator = l.default.findNode("locator", e), this._animation = e.getComponent(cc.Animation), this.addChild(e), this._model = e;
      }, Object.defineProperty(e.prototype, "data", { get: function get() {
          return this._data;
        }, set: function set(t) {
          if (f.default.log("-------- HeroActor data id " + t), this._data != t) {
            this._data = t;var e = "Prefab/" + u.default.ins.getItem(t).model,
                n = this;c.default.bundle.load(e, cc.Prefab, function (t, e) {
              n.initModel(e);
            });
          }
        }, enumerable: !1, configurable: !0 }), e.prototype.update = function (t) {
        this._dizzyTime > 0 ? (this._dizzyTime -= t, this._dizzyEffect && (this._dizzyEffect.position = this.position, this._dizzyEffect.setSiblingIndex(this._dizzyEffect.parent.childrenCount))) : this._dizzyEffect && (this._dizzyEffect.stop(), this._dizzyEffect = null), (this._isJump || this._isThrow) && (this._jumpHeight = Math.max(0, this._jumpHeight + this._jumpSpeed), this.y = s.default.clamp(this._jumpHeight, 0, 6), this._jumpSpeed -= this._gravity, this._isThrow ? this._aState.time >= this._aState.duration && (this._isThrow = !1) : (this._falling || this._aState && this._aState.time >= this._aState.duration && (this._animation.play("stay" + s.default.randomInt(1, 12)), this._falling = !0), this._jumpSpeed < 0 && !this._falling && (this._animation && this._animation.play("fall" + s.default.randomInt(1, 4)), this._falling = !0)));
      }, e.prototype.jump = function (t) {
        this._gravity = a.default.Gravity, t > .35 && (this._gravity *= .175 / t), this._space = t * a.default.CurHeroSpeed, this._jumpTime = t, this._jumpHeight = 0, this._jumpSpeed = (Math.ceil(this._space / (a.default.CurHeroSpeed / 60)) - 1) * this._gravity / 2, this._isJump = !0, this._staying = !1, this._falling = !1, this.y = 0, this._isThrow || (this._aState = this._animation.play("jump" + s.default.randomInt(1, 3)), this._model.eulerAngles = cc.Vec3.ZERO);
      }, e.prototype.idle = function () {
        this._isJump = !1, this._isThrow = !1, this._animation.play("idle"), this._model.eulerAngles = cc.Vec3.ZERO;
      }, e.prototype.dump = function () {
        this._isJump = !1, this._isThrow = !1, this._animation.play("stay6"), cc.tween(this._model).to(.5, { eulerAngles: cc.v3(-270, 0, 0) }).start();
      }, e.prototype.throw = function () {
        this._isThrow || (this._isThrow = !0, this._aState = this._animation.play("throw"), this._model.eulerAngles = cc.Vec3.ZERO);
      }, e.prototype.dizzy = function (t) {
        this._dizzyTime < 0 && null == this._dizzyEffect && (this._dizzyEffect = d.ItemEffectActor.get(t.effect), this.parent.addChild(this._dizzyEffect), this._dizzyEffect.play()), this._dizzyTime = parseInt(t.fun_para) / 1e3;
      }, Object.defineProperty(e.prototype, "isDizzy", { get: function get() {
          return this._dizzyTime > 0;
        }, enumerable: !1, configurable: !0 }), n = r([p], e);
    }(cc.Node));n.default = _, cc._RF.pop();
  }, { "../../Common/Manager/LoadResManager": "LoadResManager", "../../Common/Manager/Logger": "Logger", "../../Common/Util/ComponentUtil": "ComponentUtil", "../../Common/Util/MathUtil": "MathUtil", "../Config/GameConfig": "GameConfig", "../Config/RoleConfig": "RoleConfig", "./ItemActor": "ItemActor" }], HitEffect: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "6ca41ski1tFd5HFDRMB2JoO", "HitEffect");var _o39,
        i = this && this.__extends || (_o39 = function o(t, e) {
      return (_o39 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o39(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 }), n.HitEffectCom = void 0;var a = cc._decorator,
        s = a.ccclass,
        c = (a.property, function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), e.prototype.start = function () {
        var t = this;cc.resources.load("Prefab/hitEffect1", cc.Prefab, function (e, n) {
          var o = cc.instantiate(n);o.position = cc.Vec3.ZERO, t.node.addChild(o), t._particles = o.getComponentsInChildren(cc.ParticleSystem3D), t.play();
        });
      }, e.prototype.update = function (t) {
        this._isPlay && this._particles && (this._timer += t, this._timer > this._particles[0].duration && this.stop());
      }, e.prototype.play = function () {
        this._particles && !this._isPlay && (this._play(), this._isPlay = !0, this._timer = 0);
      }, e.prototype.stop = function () {
        this._particles && this._isPlay && (this._stop(), this._isPlay = !1, l.push(this.node));
      }, e.prototype._play = function () {
        for (var t = 0; t < this._particles.length; t++) {
          this._particles[t].play();
        }
      }, e.prototype._stop = function () {
        for (var t = 0; t < this._particles.length; t++) {
          this._particles[t].stop();
        }
      }, e;
    }(cc.Component));n.HitEffectCom = c;var l = function (t) {
      function e() {
        var e = t.call(this) || this;return e.is3DNode = !0, e._act = e.addComponent(c), e;
      }var n;return i(e, t), n = e, e.getEffect = function () {
        return null != n.pools[0] ? n.pools.shift() : new n();
      }, e.push = function (t) {
        t instanceof n && (t.parent = null, n.pools.push(t));
      }, e.initEffects = function () {
        for (var t = 0; t < 7; t++) {
          n.push(new n());
        }
      }, e.prototype.play = function () {
        this._act && this._act.play();
      }, e.prototype.stop = function () {
        this._act && this._act.stop();
      }, e.pools = [], n = r([s], e);
    }(cc.Node);n.default = l, cc._RF.pop();
  }, {}], HitSkyEffect: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "a610frKfUhC/qu3PWRCwVQW", "HitSkyEffect");var _o40,
        i = this && this.__extends || (_o40 = function o(t, e) {
      return (_o40 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o40(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 }), n.HitSkyEffectCom = void 0;var a = cc._decorator,
        s = a.ccclass,
        c = (a.property, function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), e.prototype.start = function () {
        var t = this;this._duration = 0, cc.resources.load("Prefab/hitEffect2", cc.Prefab, function (e, n) {
          var o = cc.instantiate(n);o.position = cc.Vec3.ZERO, t.node.addChild(o), t._particles = o.getComponentsInChildren(cc.ParticleSystem3D);for (var i = 0; i < t._particles.length; i++) {
            t._duration = Math.max(t._duration, t._particles[i].duration);
          }t.play();
        });
      }, e.prototype.update = function (t) {
        this._isPlay && this._particles && (this._timer += t, this._timer >= this._duration && this.stop());
      }, e.prototype.play = function () {
        this._particles && !this._isPlay && (this._playAll(), this._isPlay = !0, this._timer = 0);
      }, e.prototype.stop = function () {
        this._particles && this._isPlay && (this._stopAll(), this._isPlay = !1, l.push(this.node));
      }, e.prototype._playAll = function () {
        for (var t = 0; t < this._particles.length; t++) {
          this._particles[t].play();
        }
      }, e.prototype._stopAll = function () {
        for (var t = 0; t < this._particles.length; t++) {
          this._particles[t].stop();
        }
      }, e;
    }(cc.Component));n.HitSkyEffectCom = c;var l = function (t) {
      function e() {
        var e = t.call(this) || this;return e.is3DNode = !0, e._act = e.addComponent(c), e;
      }var n;return i(e, t), n = e, e.getEffect = function () {
        return null != n.pools[0] ? n.pools.shift() : new n();
      }, e.push = function (t) {
        t instanceof n && (t.parent = null, n.pools.push(t));
      }, e.prototype.play = function () {
        this._act && this._act.play();
      }, e.prototype.stop = function () {
        this._act && this._act.stop();
      }, e.pools = [], n = r([s], e);
    }(cc.Node);n.default = l, cc._RF.pop();
  }, {}], HostManager: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "740449qfaBPfK+R28DvJKTD", "HostManager"), Object.defineProperty(n, "__esModule", { value: !0 });var o = t("./SysConfig"),
        i = t("../Util/MathUtil"),
        r = function () {
      function t() {}return t.getHost = function () {
        return -1 == this._idx && (this._idx = i.default.randomInt(o.default.SERVER_HOSTS.length - 1)), o.default.SERVER_HOSTS[this._idx];
      }, t._idx = -1, t;
    }();n.default = r, cc._RF.pop();
  }, { "../Util/MathUtil": "MathUtil", "./SysConfig": "SysConfig" }], ItemActor: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "961deiXPT5G4o0BY/fYs2fY", "ItemActor");var _o41,
        i = this && this.__extends || (_o41 = function o(t, e) {
      return (_o41 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o41(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 }), n.ItemEffectActor = n.ItemEffectCom = void 0;var r = t("../../Common/Manager/LoadResManager"),
        a = t("../../Common/Util/ComponentUtil"),
        s = t("../../Common/Util/MathUtil"),
        c = t("../Config/ProductConfig"),
        l = function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), e.prototype.start = function () {
        var t;this._duration = 0, this._particles = this.node.getComponentsInChildren(cc.ParticleSystem3D);for (var e = this.getScale(), n = 0; n < this._particles.length; n++) {
          t = this._particles[n], this._duration = Math.max(this._duration, t.duration), t.startSize.constant *= e, t.startSize.constantMin *= e, t.startSize.constantMax *= e, t.startSpeed.constant *= e, t.startSpeed.constantMin *= e, t.startSpeed.constantMax *= e, t.shapeModule.radius *= e;
        }this.play();
      }, e.prototype.getScale = function () {
        var t = 1;switch (this.node.name) {case "xueqiuEffect2":
            t = 2;break;case "bianpaoEffect1":
            t = 1.2;break;case "bianpaoEffect2":
            t = 2;break;case "miwuEffect1":
            t = .8;break;case "miwuEffect2":
            t = 1.5;}return t;
      }, e.prototype.update = function (t) {
        this._isPlay && this._particles && (this._particles[0].capacity, this._timer += t, this._timer > this._particles[0].duration && this.stop());
      }, e.prototype.play = function () {
        if (this._particles && !this._isPlay) {
          if (this._play(), "bianpaoEffect1" == this.node.name || "bianpaoEffect2" == this.node.name) for (var t = 1; t <= 3; t++) {
            var e = a.default.findNode("eff" + t, this.node);e && (e.x = s.default.randomFloat(-1, 1), e.y = s.default.randomFloat(-1, 1));
          }this._isPlay = !0, this._timer = 0;
        }
      }, e.prototype.stop = function () {
        this._particles && this._isPlay && (this._stop(), this._isPlay = !1, u.push(this.node));
      }, e.prototype._play = function () {
        for (var t = 0; t < this._particles.length; t++) {
          this._particles[t].play();
        }
      }, e.prototype._stop = function () {
        for (var t = 0; t < this._particles.length; t++) {
          this._particles[t].stop();
        }
      }, e;
    }(cc.Component);n.ItemEffectCom = l;var u = function (t) {
      function e(e) {
        var n = t.call(this) || this;n.group = "planet", n.is3DNode = !0, n.name = e;var o = "Prefab/" + e.substr(0, e.length - 1),
            i = n;return cc.resources.load(o, cc.Prefab, function (t, e) {
          t || i.initModel(e);
        }), n;
      }return i(e, t), e.init = function () {
        for (var t, n, o = c.default.ins.getList(), i = 0; i < o.length; i++) {
          3 == (t = o[i]).type && (n = new e(t.effect), e.push(n));
        }
      }, e.get = function (t) {
        var n,
            o = this._pool[t];return (n = null == o || o && o.length < 1 ? new e(t) : o.shift()).removeFromParent(), n;
      }, e.push = function (t) {
        var e = this._pool[t.name];null == e && (e = [], this._pool[t.name] = e), t.removeFromParent(), e.push(t);
      }, e.prototype.initModel = function (t) {
        var e;t instanceof cc.Prefab ? e = cc.instantiate(t) : (e = t).parent && (e = cc.instantiate(t)), this._model = e, this.addChild(e), this._com = this.addComponent(l);
      }, e.prototype.play = function () {
        this._com && this._com.play();
      }, e.prototype.stop = function () {
        this._com && this._com.stop();
      }, e._pool = {}, e;
    }(cc.Node);n.ItemEffectActor = u;var f = function (t) {
      function e(e) {
        var n = t.call(this) || this;n.group = "planet", n.is3DNode = !0, n._data = e;var o = "Prefab/" + e.model,
            i = n;return r.default.bundle.load(o, cc.Prefab, function (t, e) {
          t || i.initModel(e);
        }), n;
      }return i(e, t), e.get = function (t) {
        var n,
            o = this._pool[t.id];return (n = null == o || o && o.length < 1 ? new e(t) : o.shift()).removeFromParent(), n;
      }, e.push = function (t) {
        var e = this._pool[t.data.id];null == e && (e = [], this._pool[t.data.id] = e), t.removeFromParent(), e.push(t);
      }, e.prototype.initModel = function (t) {
        var e;e = cc.instantiate(t), this._model = e, this.addChild(e);
      }, Object.defineProperty(e.prototype, "data", { get: function get() {
          return this._data;
        }, enumerable: !1, configurable: !0 }), e._pool = {}, e;
    }(cc.Node);n.default = f, cc._RF.pop();
  }, { "../../Common/Manager/LoadResManager": "LoadResManager", "../../Common/Util/ComponentUtil": "ComponentUtil", "../../Common/Util/MathUtil": "MathUtil", "../Config/ProductConfig": "ProductConfig" }], ItemMessage1: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "fdc78H0k1NFsIYwWpWHq4ky", "ItemMessage1");var _o42,
        i = this && this.__extends || (_o42 = function o(t, e) {
      return (_o42 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o42(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Util/ComponentUtil"),
        c = t("../../Common/Manager/MusicManager"),
        l = t("../../Common/Core/GameType"),
        u = t("../../Common/UI/UIManager"),
        f = t("../../Common/Manager/LoadResManager"),
        d = t("../Config/ProductConfig"),
        h = cc._decorator,
        p = h.ccclass,
        _ = (h.property, function (t) {
      function e() {
        var e = t.call(this) || this;return e._isForceShade = !0, e;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return l.UILayerType.SubWindowLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.btn_close = s.default.getComponent(cc.Button, this.node, "frame/btn_close"), this.btn_close.node.on(cc.Node.EventType.TOUCH_END, this.onTouchCloseHandler, this), this.sp_item = s.default.getComponent(cc.Sprite, this.node, "frame/sp_item");
      }, e.prototype.onShow = function () {
        this.refresh();
      }, e.prototype.onClose = function () {}, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), this.btn_close.node.targetOff(this);
      }, e.prototype.refresh = function () {
        if (this.sp_item) {
          var t = d.default.ins.getItem(this.data.spId);f.default.loadSprite(this.sp_item, "Atlas/atlas_item/" + t.icon);
        }
      }, e.prototype.onTouchCloseHandler = function () {
        c.default.playEffect(c.default.CLICK), u.default.close(this);
      }, r([p], e);
    }(a.default));n.default = _, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/LoadResManager": "LoadResManager", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Config/ProductConfig": "ProductConfig" }], ItemMessageTips: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "f0d35gFhhRID41YizzrzNtA", "ItemMessageTips");var _o43,
        i = this && this.__extends || (_o43 = function o(t, e) {
      return (_o43 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o43(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Util/ComponentUtil"),
        c = t("../../Common/Manager/MusicManager"),
        l = t("../../Common/Core/GameType"),
        u = t("../../Common/UI/UIManager"),
        f = t("../../Common/Manager/LoadResManager"),
        d = t("./ExchangeAddrPanel"),
        h = t("../Manager/CommandController"),
        p = t("./ItemMessage1"),
        _ = t("./ItemMessage"),
        m = t("../../Common/Sdks/UmaTrackHelper"),
        g = t("../../Common/Util/StringUtil"),
        y = t("../../Common/Sdks/GameSDK"),
        b = t("../Config/ProductConfig"),
        C = t("../Info/PlayerInfo"),
        v = cc._decorator,
        I = v.ccclass,
        M = (v.property, function (t) {
      function e() {
        var e = t.call(this) || this;return e._isForceShade = !0, e;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return l.UILayerType.SubPopLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.btn_close = s.default.getComponent(cc.Button, this.node, "frame/btn_close"), this.btn_close.node.on(cc.Node.EventType.TOUCH_END, this.onTouchCloseHandler, this), this.btn_go = s.default.getComponent(cc.Button, this.node, "frame/btn_go"), this.btn_go.node.on(cc.Node.EventType.TOUCH_END, this.onTouchGoHandler, this), this.sp_txt = s.default.getComponent(cc.Sprite, this.node, "frame/btn_go/Background/sp_txt"), this.sp_item = s.default.getComponent(cc.Sprite, this.node, "frame/sp_item"), this.lb_desc = s.default.getComponent(cc.Label, this.node, "frame/lb_desc");
      }, e.prototype.onShow = function () {
        this.refresh();
      }, e.prototype.onClose = function () {}, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), this.btn_close.node.targetOff(this), this.btn_go.node.targetOff(this);
      }, e.prototype.refresh = function () {
        if (this.sp_item && this.data.UIExchange) {
          var t = this.data.UIExchange,
              e = b.default.ins.getItem(t.exchange.id);f.default.loadSprite(this.sp_item, "Atlas/atlas_item/" + e.icon), this.lb_desc.string = g.default.replaceNewLine(e.desc);var n = s.default.getComponent(cc.Sprite, this.btn_go.node, "Background");0 == t.exchange.total || t.getRemain() > 0 ? (f.default.loadSprite(n, "Atlas/atlas_sub/btn_yellow"), f.default.loadSprite(this.sp_txt, "Atlas/atlas_lottery/txt_dj")) : (f.default.loadSprite(n, "Atlas/atlas_sub/btn_grey"), f.default.loadSprite(this.sp_txt, "Atlas/atlas_lottery/txt_ydw"));
        }
      }, e.prototype.onTouchCloseHandler = function () {
        c.default.playEffect(c.default.CLICK), u.default.close(this);
      }, e.prototype.onTouchGoHandler = function () {
        c.default.playEffect(c.default.CLICK);var t = this.data.UIExchange;if (!(t.exchange.total > 0 && t.getRemain() <= 0)) if (C.default.ins.giftCoupon < t.exchange.giftCoupon) y.default.showToast("\u5956\u5238\u4E0D\u8DB3");else {
          var e = b.default.ins.getItem(t.exchange.id);2 == e.type ? u.default.show(d.default, { exchange: t }) : (h.default.exchange(t.exchange.id, function (n) {
            null != n.id && (2 == e.type ? u.default.show(p.default, { spId: t.exchange.id }) : u.default.show(_.default, { spId: t.exchange.id }), C.default.ins.giftCoupon = n.gfc, t.useCountChange(n.num), m.default.exchange(t.exchange.id));
          }, this), u.default.close(this));
        }
      }, r([I], e);
    }(a.default));n.default = M, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/LoadResManager": "LoadResManager", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/Sdks/GameSDK": "GameSDK", "../../Common/Sdks/UmaTrackHelper": "UmaTrackHelper", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../../Common/Util/StringUtil": "StringUtil", "../Config/ProductConfig": "ProductConfig", "../Info/PlayerInfo": "PlayerInfo", "../Manager/CommandController": "CommandController", "./ExchangeAddrPanel": "ExchangeAddrPanel", "./ItemMessage": "ItemMessage", "./ItemMessage1": "ItemMessage1" }], ItemMessage: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "1d059Q1WRVEEKRdKVcDmIED", "ItemMessage");var _o44,
        i = this && this.__extends || (_o44 = function o(t, e) {
      return (_o44 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o44(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Util/ComponentUtil"),
        c = t("../../Common/Manager/MusicManager"),
        l = t("../../Common/Core/GameType"),
        u = t("../../Common/UI/UIManager"),
        f = t("../../Common/Manager/LoadResManager"),
        d = t("../../Common/Sdks/GameSDK"),
        h = t("../../Common/Manager/SysConfig"),
        p = t("../Config/ProductConfig"),
        _ = t("../../Common/Util/StringUtil"),
        m = cc._decorator,
        g = m.ccclass,
        y = (m.property, function (t) {
      function e() {
        var e = t.call(this) || this;return e._isForceShade = !0, e;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return l.UILayerType.SubWindowLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.btn_close = s.default.getComponent(cc.Button, this.node, "frame/btn_close"), this.btn_close.node.on(cc.Node.EventType.TOUCH_END, this.onTouchCloseHandler, this), this.btn_q = s.default.getComponent(cc.Button, this.node, "frame/btn_q"), this.btn_q.node.on(cc.Node.EventType.TOUCH_END, this.onTouchQHandler, this), this.sp_item = s.default.getComponent(cc.Sprite, this.node, "frame/sp_item"), this.lb_desc1 = s.default.getNode(this.node, "frame/Sprite/lb_desc1"), this.label2 = s.default.getComponent(cc.Label, this.node, "frame/Sprite/lb_desc1/label2"), this.lb_desc2 = s.default.getComponent(cc.Label, this.node, "frame/Sprite/lb_desc2"), this.spTxt = s.default.getComponent(cc.Sprite, this.node, "frame/btn_q/Background/sp_txt");
      }, e.prototype.onShow = function () {
        this.refresh();
      }, e.prototype.onClose = function () {}, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), this.btn_close.node.targetOff(this), this.btn_q.node.targetOff(this);
      }, e.prototype.refresh = function () {
        if (this.sp_item) {
          var t = p.default.ins.getItem(this.data.spId);f.default.loadSprite(this.sp_item, "Atlas/atlas_item/" + t.icon), "" != t.desc ? (this.lb_desc2.string = _.default.replaceNewLine(t.desc), this.lb_desc1.active = !1, this.lb_desc2.node.active = !0) : (this.lb_desc1.active = !0, this.lb_desc2.node.active = !1, d.default.isIos() ? this.label2.string = "2.\u7528\u6237\u6240\u83B7\u5F97\u7684\u62B5\u6263\u5238\u4EC5\u9650\u5728IOS\u5E73\u53F0\u4F7F\u7528\uFF0C\u6709\u6548\u671F\u4E3A7\u5929\uFF1B" : this.label2.string = "2.\u7528\u6237\u6240\u83B7\u5F97\u7684\u62B5\u6263\u5238\u4EC5\u9650\u5728\u5B89\u5353\u5E73\u53F0\u4F7F\u7528\uFF0C\u6709\u6548\u671F\u4E3A7\u5929\uFF1B");
        }this.btn_q && (!this.data.spId || 106 != this.data.spId && 107 != this.data.spId ? f.default.loadSprite(this.spTxt, "Atlas/atlas_sub/pop_text_gw") : f.default.loadSprite(this.spTxt, "Atlas/atlas_sub/get_text_ljsy"));
      }, e.prototype.onTouchCloseHandler = function () {
        c.default.playEffect(c.default.CLICK), u.default.close(this);
      }, e.prototype.onTouchQHandler = function () {
        c.default.playEffect(c.default.CLICK), !this.data.spId || 106 != this.data.spId && 107 != this.data.spId ? d.default.openUrl(h.default.QQ_VIP_URL) : d.default.openUrl(h.default.DKQ_USE_URL);
      }, r([g], e);
    }(a.default));n.default = y, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/LoadResManager": "LoadResManager", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/Manager/SysConfig": "SysConfig", "../../Common/Sdks/GameSDK": "GameSDK", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../../Common/Util/StringUtil": "StringUtil", "../Config/ProductConfig": "ProductConfig" }], ItemsInfo: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "784a7lQ8SBDLo/4OlFoBEcM", "ItemsInfo");var _o45,
        i = this && this.__extends || (_o45 = function o(t, e) {
      return (_o45 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o45(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 }), n.ItemsItem = void 0;var r = t("../../Common/Info/AbsInfo"),
        a = t("../../Common/Manager/GlobalEventManager"),
        s = t("../Manager/CommandController"),
        c = t("../../Common/Core/NumValue"),
        l = function () {
      function t(t) {
        this.setData(t);
      }return t.prototype.setData = function (t) {
        var e = t.split("_");this.id = Number(e[0]), this._am = new c.default(parseInt(e[1])), this.fab = Number(e[2]);
      }, t.prototype.getData = function () {
        return this.id + "_" + this.am + "_" + this.fab;
      }, Object.defineProperty(t.prototype, "am", { get: function get() {
          return this._am.value;
        }, set: function set(t) {
          this._am.value = t;
        }, enumerable: !1, configurable: !0 }), t;
    }();n.ItemsItem = l;var u = function (t) {
      function e() {
        return t.call(this) || this;
      }return i(e, t), Object.defineProperty(e, "ins", { get: function get() {
          return null == e._ins && (e._ins = new e()), e._ins;
        }, enumerable: !1, configurable: !0 }), e.prototype.init = function (t) {
        if (this.items = new Array(), null != t && null != t.item && "" != t.item) for (var e = (o = t.item.split(",")).length, n = 0; n < e; n++) {
          this.items.push(new l(o[n]));
        } else {
          var o;for (e = (o = "301_2_0,303_2_0,305_2_0,307_2_0".split(",")).length, n = 0; n < e; n++) {
            this.items.push(new l(o[n]));
          }this.saveData();
        }
      }, e.prototype.getData = function () {
        for (var t = "", e = this.items.length, n = e - 1, o = 0; o < e; o++) {
          t += o < n ? this.items[o].getData() + "," : this.items[o].getData();
        }return t;
      }, e.prototype.setFab = function (t) {
        for (var e = this.items.length, n = 0; n < e; n++) {
          this.items[n].id == t ? this.items[n].fab = 1 : this.items[n].fab = 0;
        }
      }, e.prototype.disChange = function () {
        a.default.dispatchEvent(e.event_items_change);
      }, e.prototype.addItem = function (t, e, n) {
        var o;void 0 === n && (n = !0);for (var i = this.items.length, r = 0; r < i; r++) {
          if ((o = this.items[r]).id == t) return void o.am++;
        }this.items.push(new l(t + "_" + e + "_0")), n && this.disChange();
      }, e.prototype.removeItem = function (t, e, n) {
        var o;void 0 === e && (e = 1), void 0 === n && (n = !0);for (var i = this.items.length, r = 0; r < i; r++) {
          if ((o = this.items[r]).id == t) return o.am -= e, void (o.am < 0 && (o.am = 0));
        }n && this.disChange();
      }, e.prototype.getItemsItem = function (t) {
        for (var e, n = this.items.length, o = 0; o < n; o++) {
          if ((e = this.items[o]).id == t) return e;
        }return null;
      }, e.prototype.getAndUseItemForScene = function () {
        for (var t, e = this.items.length, n = 0; n < e; n++) {
          if ((t = this.items[n]).am > 0 && 1 == t.fab) return t.am--, this.saveData(), t.id;
        }for (n = 0; n < e; n++) {
          if ((t = this.items[n]).am > 0) return t.am--, this.saveData(), t.id;
        }return 0;
      }, e.prototype.getCurrentItemId = function () {
        for (var t, e = this.items.length, n = 0; n < e; n++) {
          if ((t = this.items[n]).am > 0 && 1 == t.fab) return t.id;
        }for (n = 0; n < e; n++) {
          if ((t = this.items[n]).am > 0) return t.id;
        }return 0;
      }, e.prototype.saveData = function () {
        var t = e.ins.getData();s.default.saveItem(t, this.itemSaveHd, this, this.itemSaveFailHd);
      }, e.prototype.itemSaveHd = function () {
        this.disChange();
      }, e.prototype.itemSaveFailHd = function () {}, e.event_items_change = "event_items_change", e.id_xq = 301, e.id_bp = 303, e.id_st = 305, e.id_mw = 307, e;
    }(r.default);n.default = u, cc._RF.pop();
  }, { "../../Common/Core/NumValue": "NumValue", "../../Common/Info/AbsInfo": "AbsInfo", "../../Common/Manager/GlobalEventManager": "GlobalEventManager", "../Manager/CommandController": "CommandController" }], LoadResManager: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "0a2f3L2kqBFWYjMWjSe9Je5", "LoadResManager"), Object.defineProperty(n, "__esModule", { value: !0 }), n.ResManager = n.ResData = void 0;var o = t("../Core/GameType"),
        i = t("./MusicManager"),
        r = t("./GlobalEventManager"),
        a = t("../Sdks/GameSDK"),
        s = t("../Config/ConfigManager"),
        c = function () {
      function t(t, e, n) {
        void 0 === n && (n = !1), this._url = t, this._type = e, this._isBundle = n;
      }return Object.defineProperty(t.prototype, "url", { get: function get() {
          return this._url;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "type", { get: function get() {
          return this._type;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "isBundle", { get: function get() {
          return this._isBundle;
        }, enumerable: !1, configurable: !0 }), t;
    }();n.ResData = c;var l = function () {
      function t() {}return t.getFood = function (e) {
        return t.FoodUrl + e;
      }, t.getKitchen = function (e) {
        return t.KitchenUrl + e;
      }, t.getPlate = function (e) {
        return t.PlateUrl + e;
      }, t.getRole = function (e) {
        return t.roleUrl + e;
      }, t.getKnife = function (e) {
        return t.KnifeUrl + e;
      }, t.getFlavor = function (e) {
        return t.FlavorUrl + e;
      }, t.getEffect = function (e) {
        return t.EffectUrl + e;
      }, t.getMaterial = function (e) {
        return t.MaterialUrl + e;
      }, t.FoodUrl = "Prefab/food/", t.KitchenUrl = "Prefab/kitchen/", t.PlateUrl = "Prefab/plate/", t.roleUrl = "Prefab/role/", t.KnifeUrl = "Prefab/knife/", t.FlavorUrl = "Prefab/flavor/", t.EffectUrl = "Prefab/effect/", t.MaterialUrl = "Material/", t;
    }();n.ResManager = l;var u = function () {
      function t() {}return t.add = function (t, e, n) {
        void 0 === n && (n = !1), this._resList.push(new c(t, e, n));
      }, t.getPrefab = function (e) {
        return t._prefabs[e];
      }, t.addSpriteAtlas = function (e, n) {
        void 0 === n && (n = !1), t.add(e, o.LoadResType.ATLAS, n);
      }, t.addSound = function (e, n) {
        void 0 === n && (n = !1), t.add(e, o.LoadResType.SOUND, n);
      }, t.addConfig = function (e, n) {
        void 0 === n && (n = !1), t.add(e, o.LoadResType.CONFIG, n);
      }, t.addBundle = function (e) {
        t.add(e, o.LoadResType.BUNDLE);
      }, t.start = function () {
        t.addBundle("remote"), t.add("Config/Config", o.LoadResType.CONFIG), t.add("load_user_data", o.LoadResType.LOAD_USER_DATA), this.addSpriteAtlas("Atlas/atlas_main/auto_atlas_main"), this.addSpriteAtlas("Atlas/atlas_sub/auto_atlas_sub"), t.add(i.default.MUSIC, o.LoadResType.SOUND, !0), t.add("Music/11", o.LoadResType.SOUND, !0), t.add("Music/12", o.LoadResType.SOUND, !0), t.add("Music/13", o.LoadResType.SOUND, !0), t.add(i.default.CLICK, o.LoadResType.SOUND), t.add("Prefab/stage", o.LoadResType.PREFAB, !0), t.add("Prefab/qier1", o.LoadResType.PREFAB, !0), t.add("Prefab/qier2", o.LoadResType.PREFAB, !0), t.add("Prefab/gold", o.LoadResType.PREFAB, !0), this.add("load_finish", o.LoadResType.LOAD_FINISH), this.loadNext(0);
      }, t.loadBundle = function (e, n) {
        cc.assetManager.loadBundle(e, function (e, o) {
          e ? console.log("bundle remote err", e) : (t._bundle = o, t.loadNext(n + 1));
        });
      }, t.sumProcess = function (t, e, n) {
        return (100 * n + 100 * t / e) / (100 * this._resList.length);
      }, t.dispatchProcessEvent = function (e, n, i) {
        var a = t.sumProcess(e, n, i);r.default.dispatchEvent(o.GlobalEvent.LOADING_PROCESS, a);
      }, t.loadAtlas = function (e, n, o) {
        void 0 === o && (o = !1), t.load(o, e, cc.SpriteAtlas, function (e, o) {
          t.dispatchProcessEvent(e, o, n);
        }, function () {
          t.loadNext(n + 1);
        });
      }, t.loadSounds = function (e, n, o) {
        void 0 === o && (o = !1), t.load(o, e, cc.AudioClip, function (e, o) {
          t.dispatchProcessEvent(e, o, n);
        }, function (o, r) {
          o ? console.log("err:", e, o) : (i.default.initSound(e, r), t.loadNext(n + 1));
        });
      }, t.loadConfig = function (e, n, o) {
        void 0 === o && (o = !1), t.load(o, e, cc.BufferAsset, null, function (e, o) {
          e || (s.default.ins.loadRequest(o._buffer), t.dispatchProcessEvent(1, 1, n), t.loadNext(n + 1));
        });
      }, t.loadPrefab = function (e, n, o) {
        void 0 === o && (o = !1), t.load(o, e, cc.Prefab, function (e, o) {
          t.dispatchProcessEvent(e, o, n);
        }, function (o, i) {
          i && (t._prefabs[e] = cc.instantiate(i)), t.loadNext(n + 1);
        });
      }, t.loadFinish = function (e) {
        t.dispatchProcessEvent(1, 1, e), t.loadNext(e + 1), r.default.dispatchEvent(o.InitStepEvent.LOAD_RES_FINISH);
      }, t.loadNext = function (e) {
        if (e < this._resList.length) {
          var n = this._resList[e];switch (n.type) {case o.LoadResType.BUNDLE:
              t.loadBundle(n.url, e);break;case o.LoadResType.ATLAS:
              t.loadAtlas(n.url, e, n.isBundle);break;case o.LoadResType.SOUND:
              t.loadSounds(n.url, e, n.isBundle);break;case o.LoadResType.CONFIG:
              t.loadConfig(n.url, e, n.isBundle);break;case o.LoadResType.LOAD_USER_DATA:
              a.default.loadUserData(), t.dispatchProcessEvent(1, 1, e), t.loadNext(e + 1);break;case o.LoadResType.PREFAB:
              t.loadPrefab(n.url, e, n.isBundle);break;case o.LoadResType.LOAD_FINISH:
              t.loadFinish(e);}
        } else r.default.dispatchEvent(o.GlobalEvent.LOADING_PROCESS, 1);
      }, Object.defineProperty(t, "bundle", { get: function get() {
          return this._bundle;
        }, enumerable: !1, configurable: !0 }), t.load = function (e, n, o, i, r) {
        e ? t.bundle.load(n, o, i, r) : cc.resources.load(n, o, i, r);
      }, t.loadSprite = function (e, n, o) {
        void 0 === o && (o = !1), t.load(o, n, cc.SpriteFrame, null, function (t, o) {
          t ? console.log("SpriteFrame", t, n) : e.node && (e.spriteFrame = o);
        });
      }, t._prefabs = {}, t._resList = [], t;
    }();n.default = u, cc._RF.pop();
  }, { "../Config/ConfigManager": "ConfigManager", "../Core/GameType": "GameType", "../Sdks/GameSDK": "GameSDK", "./GlobalEventManager": "GlobalEventManager", "./MusicManager": "MusicManager" }], LoadingPanel: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "fbabaJvbt9D6qlYSxNE7DNp", "LoadingPanel");var _o46,
        i = this && this.__extends || (_o46 = function o(t, e) {
      return (_o46 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o46(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Util/ComponentUtil"),
        c = t("../../Common/Manager/GlobalEventManager"),
        l = t("../../Common/Core/GameType"),
        u = t("../../Common/Manager/GameInitManager"),
        f = cc._decorator,
        d = f.ccclass,
        h = (f.property, function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), e.prototype.onStart = function () {
        this.load = s.default.getNode(this.node, "load"), this.progressBar = s.default.getComponent(cc.ProgressBar, this.node, "load/progressBar"), this.lb_num = s.default.getComponent(cc.Label, this.node, "load/txt_load/lb_num"), this.load.active = !1, c.default.on(l.GlobalEvent.LOADING_PROCESS, this.progressHandler, this), c.default.on(l.InitStepEvent.LOGIN_FINISH, this.onLoginFinishHandler, this), u.default.init();
      }, e.prototype.onShow = function () {
        this.load.y = -this.node.height / 4;
      }, e.prototype.onClose = function () {}, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), this.progressBar = null, this.bg = null;
      }, e.prototype.progressHandler = function (t) {
        var e = t[0];this.progressBar.progress = e, this.lb_num.string = Math.floor(100 * e) + "%";
      }, e.prototype.onLoginFinishHandler = function () {
        this.load.active = !0;
      }, r([d], e);
    }(a.default));n.default = h, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/GameInitManager": "GameInitManager", "../../Common/Manager/GlobalEventManager": "GlobalEventManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil" }], Logger: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "07ae9Nt4/lJYbXSMnzWrqkt", "Logger");var o = this && this.__spreadArrays || function () {
      for (var t = 0, e = 0, n = arguments.length; e < n; e++) {
        t += arguments[e].length;
      }var o = Array(t),
          i = 0;for (e = 0; e < n; e++) {
        for (var r = arguments[e], a = 0, s = r.length; a < s; a++, i++) {
          o[i] = r[a];
        }
      }return o;
    };Object.defineProperty(n, "__esModule", { value: !0 });var i = t("./SysConfig"),
        r = function () {
      function t() {}return t.log = function (t) {
        for (var e = [], n = 1; n < arguments.length; n++) {
          e[n - 1] = arguments[n];
        }i.default.DEBUG && console.log.apply(console, o([t], e));
      }, t.debug = function (t) {
        for (var e = [], n = 1; n < arguments.length; n++) {
          e[n - 1] = arguments[n];
        }i.default.DEBUG && console.debug.apply(console, o([t], e));
      }, t.warn = function (t) {
        for (var e = [], n = 1; n < arguments.length; n++) {
          e[n - 1] = arguments[n];
        }i.default.DEBUG && console.warn.apply(console, o([t], e));
      }, t.info = function (t) {
        for (var e = [], n = 1; n < arguments.length; n++) {
          e[n - 1] = arguments[n];
        }i.default.DEBUG && console.info.apply(console, o([t], e));
      }, t.error = function (t) {
        for (var e = [], n = 1; n < arguments.length; n++) {
          e[n - 1] = arguments[n];
        }i.default.DEBUG && console.error.apply(console, o([t], e));
      }, t;
    }();n.default = r, cc._RF.pop();
  }, { "./SysConfig": "SysConfig" }], LotteryAddrPanel: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "1da54g/gBdC5pWz8lUB1YeO", "LotteryAddrPanel");var _o47,
        i = this && this.__extends || (_o47 = function o(t, e) {
      return (_o47 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o47(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Util/ComponentUtil"),
        c = t("../../Common/Manager/MusicManager"),
        l = t("../../Common/Core/GameType"),
        u = t("../../Common/UI/UIManager"),
        f = t("../../Common/Sdks/GameSDK"),
        d = t("./LotteryConfirm"),
        h = t("../Info/AddrInfo"),
        p = cc._decorator,
        _ = p.ccclass,
        m = (p.property, function (t) {
      function e() {
        var e = t.call(this) || this;return e._isForceShade = !0, e;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return l.UILayerType.SubPopLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.btn_ok = s.default.getComponent(cc.Button, this.node, "frame/btn_ok"), this.btn_ok.node.on(cc.Node.EventType.TOUCH_END, this.onTouchOkHandler, this), this.edx_name = s.default.getComponent(cc.EditBox, this.node, "frame/edx_name"), this.edx_qq = s.default.getComponent(cc.EditBox, this.node, "frame/edx_qq"), this.edx_tel = s.default.getComponent(cc.EditBox, this.node, "frame/edx_tel"), this.edx_addr = s.default.getComponent(cc.EditBox, this.node, "frame/edx_addr");
      }, e.prototype.onShow = function () {
        this.refresh();
      }, e.prototype.onClose = function () {}, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), this.btn_ok.node.targetOff(this);
      }, e.prototype.refresh = function () {
        null != h.default.ins.name && (this.edx_name.string = h.default.ins.name), null != h.default.ins.qq && (this.edx_qq.string = h.default.ins.qq), null != h.default.ins.tel && (this.edx_tel.string = h.default.ins.tel), null != h.default.ins.addr && (this.edx_addr.string = h.default.ins.addr);
      }, e.prototype.onTouchOkHandler = function () {
        c.default.playEffect(c.default.CLICK);var t = this.edx_name.string,
            e = this.edx_qq.string,
            n = this.edx_tel.string,
            o = this.edx_addr.string;"" != t && "" != e && "" != n && "" != o ? (h.default.ins.setAddrInfo(t, e, n, o), u.default.show(d.default, { spId: this.data.spId, name: t, qq: e, tel: n, addr: o })) : f.default.showToast("\u8BF7\u586B\u5199\u6B63\u786E\u7684\u6536\u8D27\u4EBA\u4FE1\u606F\uFF0C\u5426\u5219\u65E0\u6CD5\u6536\u5230\u7269\u54C1");
      }, r([_], e);
    }(a.default));n.default = m, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/Sdks/GameSDK": "GameSDK", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Info/AddrInfo": "AddrInfo", "./LotteryConfirm": "LotteryConfirm" }], LotteryConfirm: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "b89e6s0gghEjJZPqsFV56xx", "LotteryConfirm");var _o48,
        i = this && this.__extends || (_o48 = function o(t, e) {
      return (_o48 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o48(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Util/ComponentUtil"),
        c = t("../../Common/Manager/MusicManager"),
        l = t("../../Common/Core/GameType"),
        u = t("../../Common/UI/UIManager"),
        f = t("../Manager/CommandController"),
        d = t("./ItemMessage1"),
        h = t("./LotteryAddrPanel"),
        p = cc._decorator,
        _ = p.ccclass,
        m = (p.property, function (t) {
      function e() {
        var e = t.call(this) || this;return e._isForceShade = !0, e;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return l.UILayerType.SubWindowLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.btn_close = s.default.getComponent(cc.Button, this.node, "frame/btn_close"), this.btn_close.node.on(cc.Node.EventType.TOUCH_END, this.onTouchCloseHandler, this), this.btn_ok = s.default.getComponent(cc.Button, this.node, "frame/btn_ok"), this.btn_ok.node.on(cc.Node.EventType.TOUCH_END, this.onTouchOkHandler, this);
      }, e.prototype.onShow = function () {
        this.refresh();
      }, e.prototype.onClose = function () {}, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), this.btn_close.node.targetOff(this), this.btn_ok.node.targetOff(this);
      }, e.prototype.refresh = function () {}, e.prototype.onTouchCloseHandler = function () {
        c.default.playEffect(c.default.CLICK), u.default.close(this);
      }, e.prototype.onTouchOkHandler = function () {
        c.default.playEffect(c.default.CLICK);var t = this;f.default.lotteryEnd(function (e) {
          u.default.close(t), u.default.close(h.default), null != e.id && u.default.show(d.default, { spId: this.data.spId });
        }, this, this.data.name, this.data.qq, this.data.tel, this.data.addr);
      }, r([_], e);
    }(a.default));n.default = m, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Manager/CommandController": "CommandController", "./ItemMessage1": "ItemMessage1", "./LotteryAddrPanel": "LotteryAddrPanel" }], LotteryItemMessage: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "9e233awhQ1NdKC9r3iKfLb7", "LotteryItemMessage");var _o49,
        i = this && this.__extends || (_o49 = function o(t, e) {
      return (_o49 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o49(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Util/ComponentUtil"),
        c = t("../../Common/Manager/MusicManager"),
        l = t("../../Common/Core/GameType"),
        u = t("../../Common/UI/UIManager"),
        f = t("../../Common/Manager/LoadResManager"),
        d = t("../../Common/Util/StringUtil"),
        h = t("./LotteryAddrPanel"),
        p = cc._decorator,
        _ = p.ccclass,
        m = (p.property, function (t) {
      function e() {
        var e = t.call(this) || this;return e._isForceShade = !0, e;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return l.UILayerType.SubWindowLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.btn_q = s.default.getComponent(cc.Button, this.node, "frame/btn_q"), this.btn_q.node.on(cc.Node.EventType.TOUCH_END, this.onTouchQHandler, this), this.sp_item = s.default.getComponent(cc.Sprite, this.node, "frame/sp_item"), this.lb_desc2 = s.default.getComponent(cc.Label, this.node, "frame/Sprite/lb_desc2"), this.spTxt = s.default.getComponent(cc.Sprite, this.node, "frame/btn_q/Background/sp_txt");
      }, e.prototype.onShow = function () {
        this.refresh();
      }, e.prototype.onClose = function () {}, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), this.btn_q.node.targetOff(this);
      }, e.prototype.refresh = function () {
        this.sp_item && (f.default.loadSprite(this.sp_item, "Atlas/atlas_item/" + this.data.lotteryItem.icon), this.lb_desc2.string = d.default.replaceNewLine(this.data.lotteryItem.desc));
      }, e.prototype.onTouchQHandler = function () {
        c.default.playEffect(c.default.CLICK), u.default.close(this), u.default.show(h.default, { lotteryItem: this.data.lotteryItem });
      }, r([_], e);
    }(a.default));n.default = m, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/LoadResManager": "LoadResManager", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../../Common/Util/StringUtil": "StringUtil", "./LotteryAddrPanel": "LotteryAddrPanel" }], LotteryPanel: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "7992aCK1i5DJbOMEwFYAH4E", "LotteryPanel");var _o50,
        i = this && this.__extends || (_o50 = function o(t, e) {
      return (_o50 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o50(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Util/ComponentUtil"),
        c = t("../../Common/Manager/MusicManager"),
        l = t("../../Common/Core/GameType"),
        u = t("../../Common/UI/UIManager"),
        f = t("./UILottery"),
        d = t("./UIExchange"),
        h = t("../../Common/Manager/LoadResManager"),
        p = t("../Manager/CommandController"),
        _ = t("../../Common/Manager/GlobalEventManager"),
        m = t("./ItemMessage"),
        g = t("../Config/BaseConfig"),
        y = t("../../Common/Sdks/GameSDK"),
        b = t("../../Common/Sdks/UmaTrackHelper"),
        C = t("./MyExchangePanel"),
        v = t("./LotteryAddrPanel"),
        I = t("../Config/ProductConfig"),
        M = t("../../Common/Manager/Logger"),
        P = t("../Info/PlayerInfo"),
        S = t("../Main/item/ProInfoCtr"),
        T = cc._decorator,
        U = T.ccclass,
        O = (T.property, function (t) {
      function e() {
        var e = null !== t && t.apply(this, arguments) || this;return e._lotteryType = 0, e._lotteryCount = 0, e;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return l.UILayerType.PopLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.bg = s.default.getComponent(cc.Sprite, this.node, "bg"), this.btn_close = s.default.getComponent(cc.Button, this.node, "frame1/btn_close"), this.btn_close.node.on(cc.Node.EventType.TOUCH_END, this.onTouchCloseHandler, this), this.frame2 = s.default.getNode(this.node, "frame2"), this.frame3 = s.default.getNode(this.node, "frame3"), this.frame3_bg = s.default.getNode(this.node, "frame3/frame3_bg"), this.proInfo = s.default.getNode(this.node, "proInfo"), this.proInfoCtr = new S.default(this.proInfo), this.lb_gift = s.default.getComponent(cc.Label, this.node, "frame2/lb_gift"), this.lottery_list = s.default.getNode(this.node, "frame2/lottery_node/lottery_list"), this.btn_start = s.default.getComponent(cc.Button, this.node, "frame2/lottery_node/btn_start"), this.btn_start.node.on(cc.Node.EventType.TOUCH_END, this.onTouchLotteryStartHandler, this), this.lb_lottery_gift = s.default.getComponent(cc.Label, this.node, "frame2/lottery_node/btn_start/Background/lb_lottery_gift"), this.btn_lottery1 = s.default.getComponent(cc.Button, this.node, "frame2/btn_lottery1"), this.btn_lottery1.node.on(cc.Node.EventType.TOUCH_END, this.onTouchLottery1tHandler, this), this.btn_lottery2 = s.default.getComponent(cc.Button, this.node, "frame2/btn_lottery2"), this.btn_lottery2.node.on(cc.Node.EventType.TOUCH_END, this.onTouchLottery2tHandler, this), this.lb_url = s.default.getComponent(cc.Label, this.node, "frame3/lb_url"), this.lb_url.node.on(cc.Node.EventType.TOUCH_END, this.onTouchUrlHandler, this), this.exchange_list = s.default.getComponent(cc.ScrollView, this.node, "frame3/exchange_list"), this.UIExchange = s.default.getNode(this.node, "frame3/UIExchange"), this._blockNode = s.default.getNode(this.node, "blockNode"), this._blockNode.active = !1, this.lottery_node = s.default.getNode(this.node, "frame2/lottery_node"), this.lottery_node1 = s.default.getNode(this.node, "frame2/lottery_node1"), this.btn_start_sprite = s.default.getComponent(cc.Sprite, this.node, "frame2/lottery_node/btn_start/Background"), this.quan_count = s.default.getComponent(cc.Sprite, this.node, "frame2/lottery_node/btn_start/Background/quan10"), _.default.on(l.InfoEvent.GIFT_CHANGE, this.onGiftChangeHandler, this), h.default.loadSprite(this.bg, "Texture/gift_bg", !0);var t = cc.view.getVisibleSize();this.exchange_list.node.height = this.exchange_list.node.height + (t.height - cc.view.getDesignResolutionSize().height), this.frame3_bg.height = this.exchange_list.node.height + 7;
      }, e.prototype.onShow = function () {
        y.default.hideBannerAd(), this.refresh(), b.default.trackEvent("1201"), this.proInfoCtr.onShow();
      }, e.prototype.onClose = function () {}, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), this.btn_close.node.targetOff(this), this.btn_start.node.targetOff(this), this.btn_lottery1.node.targetOff(this), this.btn_lottery2.node.targetOff(this), this.lb_url.node.targetOff(this), _.default.off(l.InfoEvent.GIFT_CHANGE, this.onGiftChangeHandler, this), this._list = null;
      }, e.prototype.onGiftChangeHandler = function () {
        this.lb_gift.string = "\u6211\u7684\u5956\u5238\uFF1A" + P.default.ins.giftCoupon.toString();
      }, e.prototype.refresh = function () {
        this.onGiftChangeHandler(null);var t = this;p.default.getLotteryInfo(function (e) {
          t._lotteryList1 = e.l1, t._lotteryList2 = e.l2, t._exchangeList = e.el, t.refreshLottery(1), t.refreshExchangeList();
        }, this);
      }, e.prototype.refreshLottery = function (t) {
        var e;this._list = [], this._lotteryType = t, e = 1 == t ? this._lotteryList2 : this._lotteryList1;for (var n = 0; n < this.lottery_list.childrenCount; n++) {
          var o = this.lottery_list.children[n].getComponent(f.default);o.id = e[n].id, o.productData = I.default.ins.getItem(e[n].spId), this._list.push(o);
        }var i = s.default.getComponent(cc.Sprite, this.btn_lottery1.node, "Background"),
            r = s.default.getComponent(cc.Sprite, i.node, "sp_text"),
            a = s.default.getComponent(cc.Sprite, this.btn_lottery2.node, "Background"),
            c = s.default.getComponent(cc.Sprite, a.node, "sp_text");1 == t ? (h.default.loadSprite(i, "Atlas/atlas_lottery/gift_text_bg"), h.default.loadSprite(r, "Atlas/atlas_lottery/gift_text_cjjc"), h.default.loadSprite(a, "Atlas/atlas_lottery/gift_text_bg_sel"), h.default.loadSprite(c, "Atlas/atlas_lottery/gift_text_ptjc_sel"), this.lb_lottery_gift.string = g.default.ins.getLottery2() + "\u5956\u5238/\u6B21") : (h.default.loadSprite(i, "Atlas/atlas_lottery/gift_text_bg_sel"), h.default.loadSprite(r, "Atlas/atlas_lottery/gift_text_cjjc_sel"), h.default.loadSprite(a, "Atlas/atlas_lottery/gift_text_bg"), h.default.loadSprite(c, "Atlas/atlas_lottery/gift_text_ptjc"), this.lb_lottery_gift.string = g.default.ins.getLottery1() + "\u5956\u5238/\u6B21"), this.resetLotteryList();
      }, e.prototype.refreshExchangeList = function () {
        this.exchange_list.content.removeAllChildren(!0);for (var t = 0; t < this._exchangeList.length; t++) {
          var e = cc.instantiate(this.UIExchange).getComponent(d.default);e.exchange = this._exchangeList[t], e.useCount = this._exchangeList[t].num, e.node.active = !0, this.exchange_list.content.addChild(e.node);
        }this.exchange_list.scrollToTop(0);
      }, e.prototype.onTouchCloseHandler = function () {
        c.default.playEffect(c.default.CLICK), u.default.close(this);
      }, e.prototype.onTouchLotteryStartHandler = function () {
        c.default.playEffect(c.default.CLICK);var t = g.default.ins.getLotteryGiftCount(this._lotteryType);if (P.default.ins.giftCoupon < t) y.default.showToast("\u5956\u5238\u4E0D\u8DB3");else {
          this.resetLotteryList();var e = this;p.default.lotteryStart(this._lotteryType, function (t) {
            var n = t.id;P.default.ins.giftCoupon = t.gfc;for (var o = -1, i = 0; i < e._list.length; i++) {
              e._list[i].id == n && (o = i);
            }e._lotteryCount = 2 * e._list.length + o, e.runNextLotteryData(0), e._blockNode.active = !0;
          }, this), 1 == this._lotteryType ? b.default.trackEvent("1204") : b.default.trackEvent("1202");
        }
      }, e.prototype.onTouchLottery1tHandler = function () {
        c.default.playEffect(c.default.CLICK), this.refreshLottery(0), h.default.loadSprite(this.btn_start_sprite, "Atlas/atlas_lottery/gift_btn_cj"), h.default.loadSprite(this.quan_count, "Atlas/atlas_lottery/quan10");
      }, e.prototype.onTouchLottery2tHandler = function () {
        c.default.playEffect(c.default.CLICK), this.refreshLottery(1), h.default.loadSprite(this.btn_start_sprite, "Atlas/atlas_lottery/gift_btn_cj1"), h.default.loadSprite(this.quan_count, "Atlas/atlas_lottery/quan25");
      }, e.prototype.onTouchUrlHandler = function () {
        c.default.playEffect(c.default.CLICK), u.default.show(C.default);
      }, e.prototype.runNextLotteryData = function (t) {
        var e = t % this._list.length,
            n = this._list[e],
            o = this;if (t == this._lotteryCount) {
          n.sp_select.node.active = !0, cc.tween(n).delay(.1).call(function (t) {
            t.sp_select.node.active = !1;
          }).delay(.1).call(function (t) {
            t.sp_select.node.active = !0;
          }).union().repeat(5).start();var i = this._list[e].productData;101 != i.id && (M.default.log(i), 2 == i.type ? u.default.show(v.default, { spId: i.id }) : p.default.lotteryEnd(function () {
            u.default.show(m.default, { spId: i.id });
          }, this)), o._blockNode.active = !1;
        } else {
          n.sp_select.node.active = !0;var r = .01 + .01 * t;cc.tween(n).delay(r).call(function (t) {
            t.sp_select.node.active = !1;
          }).delay(r).call(function () {
            o.runNextLotteryData(t + 1);
          }).union().start();
        }
      }, e.prototype.resetLotteryList = function () {
        for (var t = 0; t < this._list.length; t++) {
          this._list[t].sp_select.node.active = 0 == t;
        }
      }, r([U], e);
    }(a.default));n.default = O, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/GlobalEventManager": "GlobalEventManager", "../../Common/Manager/LoadResManager": "LoadResManager", "../../Common/Manager/Logger": "Logger", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/Sdks/GameSDK": "GameSDK", "../../Common/Sdks/UmaTrackHelper": "UmaTrackHelper", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Config/BaseConfig": "BaseConfig", "../Config/ProductConfig": "ProductConfig", "../Info/PlayerInfo": "PlayerInfo", "../Main/item/ProInfoCtr": "ProInfoCtr", "../Manager/CommandController": "CommandController", "./ItemMessage": "ItemMessage", "./LotteryAddrPanel": "LotteryAddrPanel", "./MyExchangePanel": "MyExchangePanel", "./UIExchange": "UIExchange", "./UILottery": "UILottery" }], MD5: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "a85dcjCtLBE/ZU5IsL5pxcn", "MD5"), Object.defineProperty(n, "__esModule", { value: !0 });var o = function () {
      function t() {
        this.hexcase = 0, this.b64pad = "";
      }return t.hex_md5 = function (e) {
        return new t().hex_md5(e);
      }, t.prototype.hex_md5 = function (t) {
        return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(t)));
      }, t.prototype.b64_md5 = function (t) {
        return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(t)));
      }, t.prototype.any_md5 = function (t, e) {
        return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(t)), e);
      }, t.prototype.hex_hmac_md5 = function (t, e) {
        return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(t), this.str2rstr_utf8(e)));
      }, t.prototype.b64_hmac_md5 = function (t, e) {
        return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(t), this.str2rstr_utf8(e)));
      }, t.prototype.any_hmac_md5 = function (t, e, n) {
        return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(t), this.str2rstr_utf8(e)), n);
      }, t.prototype.md5_vm_test = function () {
        return "900150983cd24fb0d6963f7d28e17f72" == this.hex_md5("abc").toLowerCase();
      }, t.prototype.rstr_md5 = function (t) {
        return this.binl2rstr(this.binl_md5(this.rstr2binl(t), 8 * t.length));
      }, t.prototype.rstr_hmac_md5 = function (t, e) {
        var n = this.rstr2binl(t);n.length > 16 && (n = this.binl_md5(n, 8 * t.length));for (var o = Array(16), i = Array(16), r = 0; r < 16; r++) {
          o[r] = 909522486 ^ n[r], i[r] = 1549556828 ^ n[r];
        }var a = this.binl_md5(o.concat(this.rstr2binl(e)), 512 + 8 * e.length);return this.binl2rstr(this.binl_md5(i.concat(a), 640));
      }, t.prototype.rstr2hex = function (t) {
        try {
          this.hexcase;
        } catch (r) {
          this.hexcase = 0;
        }for (var e, n = this.hexcase ? "0123456789ABCDEF" : "0123456789abcdef", o = "", i = 0; i < t.length; i++) {
          e = t.charCodeAt(i), o += n.charAt(e >>> 4 & 15) + n.charAt(15 & e);
        }return o;
      }, t.prototype.rstr2b64 = function (t) {
        try {
          this.b64pad;
        } catch (a) {
          this.b64pad = "";
        }for (var e = "", n = t.length, o = 0; o < n; o += 3) {
          for (var i = t.charCodeAt(o) << 16 | (o + 1 < n ? t.charCodeAt(o + 1) << 8 : 0) | (o + 2 < n ? t.charCodeAt(o + 2) : 0), r = 0; r < 4; r++) {
            8 * o + 6 * r > 8 * t.length ? e += this.b64pad : e += "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(i >>> 6 * (3 - r) & 63);
          }
        }return e;
      }, t.prototype.rstr2any = function (t, e) {
        var n,
            o,
            i,
            r,
            a,
            s = e.length,
            c = Array(Math.ceil(t.length / 2));for (n = 0; n < c.length; n++) {
          c[n] = t.charCodeAt(2 * n) << 8 | t.charCodeAt(2 * n + 1);
        }var l = Math.ceil(8 * t.length / (Math.log(e.length) / Math.log(2))),
            u = Array(l);for (o = 0; o < l; o++) {
          for (a = Array(), r = 0, n = 0; n < c.length; n++) {
            r = (r << 16) + c[n], r -= (i = Math.floor(r / s)) * s, (a.length > 0 || i > 0) && (a[a.length] = i);
          }u[o] = r, c = a;
        }var f = "";for (n = u.length - 1; n >= 0; n--) {
          f += e.charAt(u[n]);
        }return f;
      }, t.prototype.str2rstr_utf8 = function (t) {
        for (var e, n, o = "", i = -1; ++i < t.length;) {
          e = t.charCodeAt(i), n = i + 1 < t.length ? t.charCodeAt(i + 1) : 0, 55296 <= e && e <= 56319 && 56320 <= n && n <= 57343 && (e = 65536 + ((1023 & e) << 10) + (1023 & n), i++), e <= 127 ? o += String.fromCharCode(e) : e <= 2047 ? o += String.fromCharCode(192 | e >>> 6 & 31, 128 | 63 & e) : e <= 65535 ? o += String.fromCharCode(224 | e >>> 12 & 15, 128 | e >>> 6 & 63, 128 | 63 & e) : e <= 2097151 && (o += String.fromCharCode(240 | e >>> 18 & 7, 128 | e >>> 12 & 63, 128 | e >>> 6 & 63, 128 | 63 & e));
        }return o;
      }, t.prototype.str2rstr_utf16le = function (t) {
        for (var e = "", n = 0; n < t.length; n++) {
          e += String.fromCharCode(255 & t.charCodeAt(n), t.charCodeAt(n) >>> 8 & 255);
        }return e;
      }, t.prototype.str2rstr_utf16be = function (t) {
        for (var e = "", n = 0; n < t.length; n++) {
          e += String.fromCharCode(t.charCodeAt(n) >>> 8 & 255, 255 & t.charCodeAt(n));
        }return e;
      }, t.prototype.rstr2binl = function (t) {
        for (var e = Array(t.length >> 2), n = 0; n < e.length; n++) {
          e[n] = 0;
        }for (n = 0; n < 8 * t.length; n += 8) {
          e[n >> 5] |= (255 & t.charCodeAt(n / 8)) << n % 32;
        }return e;
      }, t.prototype.binl2rstr = function (t) {
        for (var e = "", n = 0; n < 32 * t.length; n += 8) {
          e += String.fromCharCode(t[n >> 5] >>> n % 32 & 255);
        }return e;
      }, t.prototype.binl_md5 = function (t, e) {
        t[e >> 5] |= 128 << e % 32, t[14 + (e + 64 >>> 9 << 4)] = e;for (var n = 1732584193, o = -271733879, i = -1732584194, r = 271733878, a = 0; a < t.length; a += 16) {
          var s = n,
              c = o,
              l = i,
              u = r;n = this.md5_ff(n, o, i, r, t[a + 0], 7, -680876936), r = this.md5_ff(r, n, o, i, t[a + 1], 12, -389564586), i = this.md5_ff(i, r, n, o, t[a + 2], 17, 606105819), o = this.md5_ff(o, i, r, n, t[a + 3], 22, -1044525330), n = this.md5_ff(n, o, i, r, t[a + 4], 7, -176418897), r = this.md5_ff(r, n, o, i, t[a + 5], 12, 1200080426), i = this.md5_ff(i, r, n, o, t[a + 6], 17, -1473231341), o = this.md5_ff(o, i, r, n, t[a + 7], 22, -45705983), n = this.md5_ff(n, o, i, r, t[a + 8], 7, 1770035416), r = this.md5_ff(r, n, o, i, t[a + 9], 12, -1958414417), i = this.md5_ff(i, r, n, o, t[a + 10], 17, -42063), o = this.md5_ff(o, i, r, n, t[a + 11], 22, -1990404162), n = this.md5_ff(n, o, i, r, t[a + 12], 7, 1804603682), r = this.md5_ff(r, n, o, i, t[a + 13], 12, -40341101), i = this.md5_ff(i, r, n, o, t[a + 14], 17, -1502002290), o = this.md5_ff(o, i, r, n, t[a + 15], 22, 1236535329), n = this.md5_gg(n, o, i, r, t[a + 1], 5, -165796510), r = this.md5_gg(r, n, o, i, t[a + 6], 9, -1069501632), i = this.md5_gg(i, r, n, o, t[a + 11], 14, 643717713), o = this.md5_gg(o, i, r, n, t[a + 0], 20, -373897302), n = this.md5_gg(n, o, i, r, t[a + 5], 5, -701558691), r = this.md5_gg(r, n, o, i, t[a + 10], 9, 38016083), i = this.md5_gg(i, r, n, o, t[a + 15], 14, -660478335), o = this.md5_gg(o, i, r, n, t[a + 4], 20, -405537848), n = this.md5_gg(n, o, i, r, t[a + 9], 5, 568446438), r = this.md5_gg(r, n, o, i, t[a + 14], 9, -1019803690), i = this.md5_gg(i, r, n, o, t[a + 3], 14, -187363961), o = this.md5_gg(o, i, r, n, t[a + 8], 20, 1163531501), n = this.md5_gg(n, o, i, r, t[a + 13], 5, -1444681467), r = this.md5_gg(r, n, o, i, t[a + 2], 9, -51403784), i = this.md5_gg(i, r, n, o, t[a + 7], 14, 1735328473), o = this.md5_gg(o, i, r, n, t[a + 12], 20, -1926607734), n = this.md5_hh(n, o, i, r, t[a + 5], 4, -378558), r = this.md5_hh(r, n, o, i, t[a + 8], 11, -2022574463), i = this.md5_hh(i, r, n, o, t[a + 11], 16, 1839030562), o = this.md5_hh(o, i, r, n, t[a + 14], 23, -35309556), n = this.md5_hh(n, o, i, r, t[a + 1], 4, -1530992060), r = this.md5_hh(r, n, o, i, t[a + 4], 11, 1272893353), i = this.md5_hh(i, r, n, o, t[a + 7], 16, -155497632), o = this.md5_hh(o, i, r, n, t[a + 10], 23, -1094730640), n = this.md5_hh(n, o, i, r, t[a + 13], 4, 681279174), r = this.md5_hh(r, n, o, i, t[a + 0], 11, -358537222), i = this.md5_hh(i, r, n, o, t[a + 3], 16, -722521979), o = this.md5_hh(o, i, r, n, t[a + 6], 23, 76029189), n = this.md5_hh(n, o, i, r, t[a + 9], 4, -640364487), r = this.md5_hh(r, n, o, i, t[a + 12], 11, -421815835), i = this.md5_hh(i, r, n, o, t[a + 15], 16, 530742520), o = this.md5_hh(o, i, r, n, t[a + 2], 23, -995338651), n = this.md5_ii(n, o, i, r, t[a + 0], 6, -198630844), r = this.md5_ii(r, n, o, i, t[a + 7], 10, 1126891415), i = this.md5_ii(i, r, n, o, t[a + 14], 15, -1416354905), o = this.md5_ii(o, i, r, n, t[a + 5], 21, -57434055), n = this.md5_ii(n, o, i, r, t[a + 12], 6, 1700485571), r = this.md5_ii(r, n, o, i, t[a + 3], 10, -1894986606), i = this.md5_ii(i, r, n, o, t[a + 10], 15, -1051523), o = this.md5_ii(o, i, r, n, t[a + 1], 21, -2054922799), n = this.md5_ii(n, o, i, r, t[a + 8], 6, 1873313359), r = this.md5_ii(r, n, o, i, t[a + 15], 10, -30611744), i = this.md5_ii(i, r, n, o, t[a + 6], 15, -1560198380), o = this.md5_ii(o, i, r, n, t[a + 13], 21, 1309151649), n = this.md5_ii(n, o, i, r, t[a + 4], 6, -145523070), r = this.md5_ii(r, n, o, i, t[a + 11], 10, -1120210379), i = this.md5_ii(i, r, n, o, t[a + 2], 15, 718787259), o = this.md5_ii(o, i, r, n, t[a + 9], 21, -343485551), n = this.safe_add(n, s), o = this.safe_add(o, c), i = this.safe_add(i, l), r = this.safe_add(r, u);
        }return [n, o, i, r];
      }, t.prototype.md5_cmn = function (t, e, n, o, i, r) {
        return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e, t), this.safe_add(o, r)), i), n);
      }, t.prototype.md5_ff = function (t, e, n, o, i, r, a) {
        return this.md5_cmn(e & n | ~e & o, t, e, i, r, a);
      }, t.prototype.md5_gg = function (t, e, n, o, i, r, a) {
        return this.md5_cmn(e & o | n & ~o, t, e, i, r, a);
      }, t.prototype.md5_hh = function (t, e, n, o, i, r, a) {
        return this.md5_cmn(e ^ n ^ o, t, e, i, r, a);
      }, t.prototype.md5_ii = function (t, e, n, o, i, r, a) {
        return this.md5_cmn(n ^ (e | ~o), t, e, i, r, a);
      }, t.prototype.safe_add = function (t, e) {
        var n = (65535 & t) + (65535 & e);return (t >> 16) + (e >> 16) + (n >> 16) << 16 | 65535 & n;
      }, t.prototype.bit_rol = function (t, e) {
        return t << e | t >>> 32 - e;
      }, t;
    }();n.default = o, cc._RF.pop();
  }, {}], MTween: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "3f71eKKJNRP258JyKEC9dS3", "MTween"), Object.defineProperty(n, "__esModule", { value: !0 }), n.MEase = void 0;var o = t("./CallBackUtils"),
        i = function () {
      function t() {}return t.linearNone = function (t, e, n, o) {
        return n * t / o + e;
      }, t.linearIn = function (t, e, n, o) {
        return n * t / o + e;
      }, t.linearInOut = function (t, e, n, o) {
        return n * t / o + e;
      }, t.linearOut = function (t, e, n, o) {
        return n * t / o + e;
      }, t.bounceIn = function (e, n, o, i) {
        return o - t.bounceOut(i - e, 0, o, i) + n;
      }, t.bounceInOut = function (e, n, o, i) {
        return e < .5 * i ? .5 * t.bounceIn(2 * e, 0, o, i) + n : .5 * t.bounceOut(2 * e - i, 0, o, i) + .5 * o + n;
      }, t.bounceOut = function (t, e, n, o) {
        return (t /= o) < 1 / 2.75 ? 7.5625 * n * t * t + e : t < 2 / 2.75 ? n * (7.5625 * (t -= 1.5 / 2.75) * t + .75) + e : t < 2.5 / 2.75 ? n * (7.5625 * (t -= 2.25 / 2.75) * t + .9375) + e : n * (7.5625 * (t -= 2.625 / 2.75) * t + .984375) + e;
      }, t.backIn = function (t, e, n, o, i) {
        return void 0 === i && (i = 1.70158), n * (t /= o) * t * ((i + 1) * t - i) + e;
      }, t.backInOut = function (t, e, n, o, i) {
        return void 0 === i && (i = 1.70158), (t /= .5 * o) < 1 ? .5 * n * t * t * ((1 + (i *= 1.525)) * t - i) + e : n / 2 * ((t -= 2) * t * ((1 + (i *= 1.525)) * t + i) + 2) + e;
      }, t.backOut = function (t, e, n, o, i) {
        return void 0 === i && (i = 1.70158), n * ((t = t / o - 1) * t * ((i + 1) * t + i) + 1) + e;
      }, t.elasticIn = function (e, n, o, i, r, a) {
        var s;return void 0 === r && (r = 0), void 0 === a && (a = 0), 0 == e ? n : 1 == (e /= i) ? n + o : (a || (a = .3 * i), !r || o > 0 && r < o || o < 0 && r < -o ? (r = o, s = a / 4) : s = a / t.PI2 * Math.asin(o / r), -r * Math.pow(2, 10 * (e -= 1)) * Math.sin((e * i - s) * t.PI2 / a) + n);
      }, t.elasticInOut = function (e, n, o, i, r, a) {
        var s;return void 0 === r && (r = 0), void 0 === a && (a = 0), 0 == e ? n : 2 == (e /= .5 * i) ? n + o : (a || (a = .3 * 1.5 * i), !r || o > 0 && r < o || o < 0 && r < -o ? (r = o, s = a / 4) : s = a / t.PI2 * Math.asin(o / r), e < 1 ? r * Math.pow(2, 10 * (e -= 1)) * Math.sin((e * i - s) * t.PI2 / a) * -.5 + n : r * Math.pow(2, -10 * (e -= 1)) * Math.sin((e * i - s) * t.PI2 / a) * .5 + o + n);
      }, t.elasticOut = function (e, n, o, i, r, a) {
        var s;return void 0 === r && (r = 0), void 0 === a && (a = 0), 0 == e ? n : 1 == (e /= i) ? n + o : (a || (a = .3 * i), !r || o > 0 && r < o || o < 0 && r < -o ? (r = o, s = a / 4) : s = a / t.PI2 * Math.asin(o / r), r * Math.pow(2, -10 * e) * Math.sin((e * i - s) * t.PI2 / a) + o + n);
      }, t.strongIn = function (t, e, n, o) {
        return n * (t /= o) * t * t * t * t + e;
      }, t.strongInOut = function (t, e, n, o) {
        return (t /= .5 * o) < 1 ? .5 * n * t * t * t * t * t + e : .5 * n * ((t -= 2) * t * t * t * t + 2) + e;
      }, t.strongOut = function (t, e, n, o) {
        return n * ((t = t / o - 1) * t * t * t * t + 1) + e;
      }, t.sineInOut = function (t, e, n, o) {
        return .5 * -n * (Math.cos(Math.PI * t / o) - 1) + e;
      }, t.sineIn = function (e, n, o, i) {
        return -o * Math.cos(e / i * t.HALF_PI) + o + n;
      }, t.sineOut = function (e, n, o, i) {
        return o * Math.sin(e / i * t.HALF_PI) + n;
      }, t.quintIn = function (t, e, n, o) {
        return n * (t /= o) * t * t * t * t + e;
      }, t.quintInOut = function (t, e, n, o) {
        return (t /= .5 * o) < 1 ? .5 * n * t * t * t * t * t + e : .5 * n * ((t -= 2) * t * t * t * t + 2) + e;
      }, t.quintOut = function (t, e, n, o) {
        return n * ((t = t / o - 1) * t * t * t * t + 1) + e;
      }, t.quartIn = function (t, e, n, o) {
        return n * (t /= o) * t * t * t + e;
      }, t.quartInOut = function (t, e, n, o) {
        return (t /= .5 * o) < 1 ? .5 * n * t * t * t * t + e : .5 * -n * ((t -= 2) * t * t * t - 2) + e;
      }, t.quartOut = function (t, e, n, o) {
        return -n * ((t = t / o - 1) * t * t * t - 1) + e;
      }, t.cubicIn = function (t, e, n, o) {
        return n * (t /= o) * t * t + e;
      }, t.cubicInOut = function (t, e, n, o) {
        return (t /= .5 * o) < 1 ? .5 * n * t * t * t + e : .5 * n * ((t -= 2) * t * t + 2) + e;
      }, t.cubicOut = function (t, e, n, o) {
        return n * ((t = t / o - 1) * t * t + 1) + e;
      }, t.quadIn = function (t, e, n, o) {
        return n * (t /= o) * t + e;
      }, t.quadInOut = function (t, e, n, o) {
        return (t /= .5 * o) < 1 ? .5 * n * t * t + e : .5 * -n * (--t * (t - 2) - 1) + e;
      }, t.quadOut = function (t, e, n, o) {
        return -n * (t /= o) * (t - 2) + e;
      }, t.expoIn = function (t, e, n, o) {
        return 0 == t ? e : n * Math.pow(2, 10 * (t / o - 1)) + e - .001 * n;
      }, t.expoInOut = function (t, e, n, o) {
        return 0 == t ? e : t == o ? e + n : (t /= .5 * o) < 1 ? .5 * n * Math.pow(2, 10 * (t - 1)) + e : .5 * n * (2 - Math.pow(2, -10 * --t)) + e;
      }, t.expoOut = function (t, e, n, o) {
        return t == o ? e + n : n * (1 - Math.pow(2, -10 * t / o)) + e;
      }, t.circIn = function (t, e, n, o) {
        return -n * (Math.sqrt(1 - (t /= o) * t) - 1) + e;
      }, t.circInOut = function (t, e, n, o) {
        return (t /= .5 * o) < 1 ? .5 * -n * (Math.sqrt(1 - t * t) - 1) + e : .5 * n * (Math.sqrt(1 - (t -= 2) * t) + 1) + e;
      }, t.circOut = function (t, e, n, o) {
        return n * Math.sqrt(1 - (t = t / o - 1) * t) + e;
      }, t.HALF_PI = .5 * Math.PI, t.PI2 = 2 * Math.PI, t;
    }();n.MEase = i;var r = function () {
      function t() {
        this.target = null, this.props = null, this.propsArr = null, this.duration = null, this.ease = null, this.callBack_complete = null, this.callBack_updateEase = null, this.delay = null, this.startTimer = null, this.callBack_complete = new o.default(null, null), this.callBack_updateEase = new o.default(null, null), this._stop = !1;
      }return t.easeNone = function (t, e, n, o) {
        return n * t / o + e;
      }, t.prototype.to = function (e, n, o, i, r, a, s, c) {
        void 0 === i && (i = null), void 0 === r && (r = null), void 0 === a && (a = null), void 0 === s && (s = 0), void 0 === c && (c = null), this.target = e, this.duration = o, this.ease = i || n.ease || t.easeNone, this.callBack_complete.setData(r, a), this.callBack_updateEase.setData(r, c), this.delay = s, this.props = n, this.propsArr = [], this.startTimer = Date.now(), this._stop = !1, this.firstStart();
      }, t.prototype.initProps = function () {
        for (var t in this.props) {
          if ("number" == typeof this.target[t]) {
            var e = this.target[t],
                n = this.props[t];this.propsArr.push([t, e, n - e]);
          }
        }
      }, t.prototype.firstStart = function () {
        this.initProps();
      }, t.prototype.stop = function () {
        this._stop = !0;
      }, t.prototype.update = function () {
        this.updateEase();
      }, t.prototype.updateEase = function () {
        if (!this._stop) {
          var t = Date.now() - this.startTimer - this.delay;if (!(t < 0)) if (t >= this.duration) {
            if (this._stop = !0, null != this.propsArr) for (var e = this.propsArr, n = 0, o = e.length; n < o; n++) {
              var i = e[n];this.target[i[0]] = this.props[i[0]];
            }this.callBack_complete.trigger();
          } else {
            var r = t > 0 ? this.ease(t, 0, 1, this.duration) : 0,
                a = this.propsArr;for (n = 0, o = a.length; n < o; n++) {
              i = a[n], this.target[i[0]] = i[1] + r * i[2];
            }this.callBack_updateEase.trigger(this.target);
          }
        }
      }, t.prototype.destroy = function () {
        this.target = null, this.duration = null, this.ease = null, this.callBack_complete.destroy(), this.callBack_complete = null, this.callBack_updateEase.destroy(), this.callBack_updateEase = null, this.delay = null, this.props = null, this.propsArr = null, this.startTimer = null;
      }, t;
    }();n.default = r, cc._RF.pop();
  }, { "./CallBackUtils": "CallBackUtils" }], MainPanel: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "29080zEtL9P6a8L2XBSy3my", "MainPanel");var _o51,
        i = this && this.__extends || (_o51 = function o(t, e) {
      return (_o51 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o51(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Util/ComponentUtil"),
        c = t("../../Common/Manager/MusicManager"),
        l = t("../../Common/Sdks/GameSDK"),
        u = t("../../Common/Manager/LoadResManager"),
        f = t("../../Common/UI/UIManager"),
        d = t("../Fb/FbPanel"),
        h = t("./RankPanel"),
        p = t("../Lottery/LotteryPanel"),
        _ = t("../../Common/Manager/SysConfig"),
        m = t("./FeedbackPanel"),
        g = t("./SubContextViewController"),
        y = t("./NoticePanel"),
        b = t("../../Common/Sdks/UmaTrackHelper"),
        C = t("../Fb/FbPkMatchPanel"),
        v = t("../Scene/GameScene"),
        I = t("../Info/SetInfo"),
        M = t("../../Common/Manager/Logger"),
        P = t("../Fb/FbPkInvitePanel"),
        S = t("./ShopPanel"),
        T = t("./AchievementPanel"),
        U = t("./SignPanel"),
        O = t("./item/ProInfoCtr"),
        w = t("../Dash/HeroActor"),
        E = t("../Config/RoleConfig"),
        k = t("../../Common/Manager/QueuePanelManager"),
        A = t("../Info/SignInfo"),
        R = t("../../Common/Manager/DataManager"),
        F = t("./UpgradePropConfirm"),
        L = t("../Info/ItemsInfo"),
        D = t("../Dash/MusicController"),
        N = t("../../Common/Manager/TimeManager"),
        x = cc._decorator,
        j = x.ccclass,
        G = (x.property, function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), e.prototype.onStart = function () {
        this.sp_head = s.default.getNode(this.node, "sp_head"), this.sp_head.on(cc.Node.EventType.TOUCH_END, this.onTouchFeedbackHandler, this), this.icon_head = s.default.getComponent(cc.Sprite, this.node, "sp_head/mask/icon_head"), this.proInfo = s.default.getNode(this.node, "proInfo"), this.proInfoCtr = new O.default(this.proInfo), this.btn_music = s.default.getComponent(cc.Button, this.node, "frame/btn_music"), this.btn_music.node.on(cc.Node.EventType.TOUCH_END, this.onTouchMusicHandler, this), this.sp_music = s.default.getComponent(cc.Sprite, this.btn_music.node, "Background"), this.btn_lottery = s.default.getComponent(cc.Button, this.node, "frame/btn_lottery"), this.btn_lottery.node.on(cc.Node.EventType.TOUCH_END, this.onTouchLotteryHandler, this), this.btn_rank = s.default.getComponent(cc.Button, this.node, "frame/btn_rank"), this.btn_rank.node.on(cc.Node.EventType.TOUCH_END, this.onTouchRankHandler, this), this.btn_q = s.default.getComponent(cc.Button, this.node, "frame/btn_q"), this.btn_q.node.on(cc.Node.EventType.TOUCH_END, this.onTouchQHandler, this), this.btn_start = s.default.getComponent(cc.Button, this.node, "btn_start"), this.btn_start.node.on(cc.Node.EventType.TOUCH_END, this.onTouchStartHandler, this), this.btn_pk_friend = s.default.getComponent(cc.Button, this.node, "btn_pk_friend"), this.btn_pk_friend.node.on(cc.Node.EventType.TOUCH_END, this.onTouchPkFriendHandler, this), this.btn_pk_match = s.default.getComponent(cc.Button, this.node, "btn_pk_match"), this.btn_pk_match.node.on(cc.Node.EventType.TOUCH_END, this.onTouchPkMatchHandler, this), this.btn_sign = s.default.getComponent(cc.Button, this.node, "left/btn_sign"), this.btn_sign.node.on(cc.Node.EventType.TOUCH_END, this.onTouchSignHandler, this), this.btn_dj = s.default.getComponent(cc.Button, this.node, "left/btn_dj"), this.btn_dj.node.on(cc.Node.EventType.TOUCH_END, this.onTouchDJHandler, this), this.btn_xbz = s.default.getComponent(cc.Button, this.node, "left/btn_xbz"), this.btn_xbz.node.on(cc.Node.EventType.TOUCH_END, this.onTouchXBZHandler, this), this.btn_cj = s.default.getComponent(cc.Button, this.node, "left/btn_cj"), this.btn_cj.node.on(cc.Node.EventType.TOUCH_END, this.onTouchCJHandler, this), this.btn_left = s.default.getNode(this.node, "role_change/btn_left"), this.btn_left.on(cc.Node.EventType.TOUCH_END, this.onTouchLeftHandler, this), this.btn_right = s.default.getNode(this.node, "role_change/btn_right"), this.btn_right.on(cc.Node.EventType.TOUCH_END, this.onTouchRightHandler, this), this.btn_openVip = s.default.getNode(this.node, "btn_openVip"), this.vip_fab = s.default.getNode(this.node, "vip_fab"), this.btn_openVip.on(cc.Node.EventType.TOUCH_END, this.onTouchOpenVipHandler, this), k.default.init(), I.default.ins.notice != N.default.timeToInt(new Date(N.default.serverTime)) && k.default.add(y.default), c.default.playerBGM(), M.default.log("-----------GameSDK.getRoomId() --------------", l.default.getRoomId()), null != l.default.getRoomId() ? (M.default.log("-----------GameSDK.getRoomId() != null--------11111------"), "match" == l.default.getRoomId() ? k.default.add(C.default) : k.default.add(P.default), b.default.trackEvent("1324")) : A.default.ins.checkCurDaySigned() || k.default.add(U.default), k.default.show(), this.btn_openVip.active = !1, this.vip_fab.active = !1;
      }, e.prototype.onShow = function () {
        D.MusicController.ins.stop(), l.default.hideBannerAd(), c.default.resumeBGM(), this.refresh(), g.default.ins.closeView(), this.proInfoCtr.onShow(), f.default.close(d.default), k.default.isShowing || U.default.isFirst && !A.default.ins.checkCurDaySigned() && f.default.show(U.default);
      }, e.prototype.onClose = function () {}, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), this.btn_music.node.targetOff(this), this.sp_head.targetOff(this), this.btn_lottery.node.targetOff(this), this.btn_rank.node.targetOff(this), this.btn_q.node.targetOff(this), this.btn_start.node.targetOff(this), this.btn_pk_friend.node.targetOff(this), this.btn_pk_match.node.targetOff(this), this.btn_sign.node.targetOff(this);
      }, e.prototype.refresh = function () {
        1 == I.default.ins.music ? u.default.loadSprite(this.sp_music, "Atlas/atlas_main/home_icon_music_on") : u.default.loadSprite(this.sp_music, "Atlas/atlas_main/home_icon_music_off");var t = l.default.getIcon();if (null != t) {
          var e = this;cc.assetManager.loadRemote(t, { ext: ".png" }, function (t, n) {
            var o = new cc.SpriteFrame(n);e.icon_head.spriteFrame = o;
          });
        }
      }, e.prototype.onTouchMusicHandler = function () {
        c.default.playEffect(c.default.CLICK), 1 == I.default.ins.music ? (I.default.ins.music = 0, u.default.loadSprite(this.sp_music, "Atlas/atlas_main/home_icon_music_off")) : (I.default.ins.music = 1, u.default.loadSprite(this.sp_music, "Atlas/atlas_main/home_icon_music_on")), c.default.resetVolume();
      }, e.prototype.onTouchFeedbackHandler = function () {
        c.default.playEffect(c.default.CLICK), f.default.show(m.default);
      }, e.prototype.onTouchSignHandler = function () {
        c.default.playEffect(c.default.CLICK), f.default.show(U.default);
      }, e.prototype.onTouchDJHandler = function () {
        c.default.playEffect(c.default.CLICK), f.default.show(S.default);
      }, e.prototype.onTouchXBZHandler = function () {
        c.default.playEffect(c.default.CLICK), b.default.trackEvent("1315"), l.default.openUrl("https://club.vip.qq.com/vip20rebate/newbili?_wwv=68&_wv=16777221&_proxy=1");
      }, e.prototype.onTouchCJHandler = function () {
        c.default.playEffect(c.default.CLICK), f.default.show(T.default);
      }, e.prototype.onTouchLeftHandler = function () {
        c.default.playEffect(c.default.CLICK);var t = w.default.ins.data,
            e = E.default.ins.get_per_id(t);this.setRoleSelected(e);
      }, e.prototype.onTouchRightHandler = function () {
        c.default.playEffect(c.default.CLICK), M.default.log("----------onTouchRightHandler-----------------");var t = w.default.ins.data,
            e = E.default.ins.get_next_id(t);this.setRoleSelected(e);
      }, e.prototype.onTouchOpenVipHandler = function () {
        M.default.log("------------- onTouchOpenVipHandler ------------------"), l.default.openUrl(_.default.QQ_VIP_URL), b.default.trackEvent("1007");
      }, e.prototype.setRoleSelected = function (t) {
        if (w.default.ins.data = t, this.btn_openVip.active = !1, this.vip_fab.active = !1, 1 == E.default.ins.getItem(t).need_vip) {
          var e = l.default.getVip();M.default.log("-------\x3e vip " + e), 1 == e ? (R.default.select_role_id = t, this.vip_fab.active = !0) : (M.default.log("\u4E0D\u662Fvip \uFF0C\u4E0D\u80FD\u4F7F\u7528"), this.btn_openVip.active = !0);
        } else R.default.select_role_id = t;
      }, e.prototype.onTouchLotteryHandler = function () {
        c.default.playEffect(c.default.CLICK), f.default.show(p.default), b.default.trackEvent("1003");
      }, e.prototype.onTouchRankHandler = function () {
        c.default.playEffect(c.default.CLICK), f.default.show(h.default), b.default.trackEvent("1005");
      }, e.prototype.onTouchQHandler = function () {
        c.default.playEffect(c.default.CLICK), l.default.openUrl(_.default.QQ_VIP_URL), b.default.trackEvent("1007");
      }, e.prototype.onTouchStartHandler = function () {
        c.default.playEffect(c.default.CLICK), v.default.ins.startSingle(), b.default.trackEvent("1011");
      }, e.prototype.onTouchPkFriendHandler = function () {
        c.default.playEffect(c.default.CLICK), l.default.shareInvite(), b.default.trackEvent("1323");
      }, e.prototype.onTouchPkMatchHandler = function () {
        c.default.playEffect(c.default.CLICK), L.default.ins.getCurrentItemId() ? f.default.show(F.default) : f.default.show(C.default), b.default.trackEvent("1317");
      }, r([j], e);
    }(a.default));n.default = G, cc._RF.pop();
  }, { "../../Common/Manager/DataManager": "DataManager", "../../Common/Manager/LoadResManager": "LoadResManager", "../../Common/Manager/Logger": "Logger", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/Manager/QueuePanelManager": "QueuePanelManager", "../../Common/Manager/SysConfig": "SysConfig", "../../Common/Manager/TimeManager": "TimeManager", "../../Common/Sdks/GameSDK": "GameSDK", "../../Common/Sdks/UmaTrackHelper": "UmaTrackHelper", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Config/RoleConfig": "RoleConfig", "../Dash/HeroActor": "HeroActor", "../Dash/MusicController": "MusicController", "../Fb/FbPanel": "FbPanel", "../Fb/FbPkInvitePanel": "FbPkInvitePanel", "../Fb/FbPkMatchPanel": "FbPkMatchPanel", "../Info/ItemsInfo": "ItemsInfo", "../Info/SetInfo": "SetInfo", "../Info/SignInfo": "SignInfo", "../Lottery/LotteryPanel": "LotteryPanel", "../Scene/GameScene": "GameScene", "./AchievementPanel": "AchievementPanel", "./FeedbackPanel": "FeedbackPanel", "./NoticePanel": "NoticePanel", "./RankPanel": "RankPanel", "./ShopPanel": "ShopPanel", "./SignPanel": "SignPanel", "./SubContextViewController": "SubContextViewController", "./UpgradePropConfirm": "UpgradePropConfirm", "./item/ProInfoCtr": "ProInfoCtr" }], MainScene: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "932dbuutoVG158DGEmOk98k", "MainScene");var _o52,
        i = this && this.__extends || (_o52 = function o(t, e) {
      return (_o52 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o52(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/Manager/GlobalEventManager"),
        s = t("../../Common/Core/GameType"),
        c = t("../../Common/UI/UIManager"),
        l = t("../Main/LoadingPanel"),
        u = t("../Main/SubContextViewController"),
        f = t("../Main/MainPanel"),
        d = t("../Fb/FbPanel"),
        h = t("../../Common/Manager/Logger"),
        p = t("./GameScene"),
        _ = cc._decorator,
        m = _.ccclass,
        g = _.property,
        y = function (t) {
      function e() {
        var e = null !== t && t.apply(this, arguments) || this;return e.camera = null, e;
      }return i(e, t), e.prototype.start = function () {
        c.default.preload(f.default), a.default.on(s.InitStepEvent.LOAD_RES_FINISH, this.onLoadResFinishHandler, this), this.node.position = cc.Vec3.ZERO, this.node.eulerAngles = cc.Vec3.ZERO, c.default.init(this.node), h.default.log("mainscene"), c.default.show(l.default);
      }, e.prototype.onLoadResFinishHandler = function () {
        var t = this.node.getChildByName("GameNode");t && (t.addComponent(p.default).uiCamera = this.camera.getComponent(cc.Camera), t.active = !0);var e = this.node.getChildByName("contextView");e && (e.active = !0, e.addComponent(u.default)), a.default.targetOff(this), c.default.preload(d.default);
      }, r([g({ type: cc.Node, tooltip: "CameraNode" })], e.prototype, "camera", void 0), r([m], e);
    }(cc.Component);n.default = y, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/GlobalEventManager": "GlobalEventManager", "../../Common/Manager/Logger": "Logger", "../../Common/UI/UIManager": "UIManager", "../Fb/FbPanel": "FbPanel", "../Main/LoadingPanel": "LoadingPanel", "../Main/MainPanel": "MainPanel", "../Main/SubContextViewController": "SubContextViewController", "./GameScene": "GameScene" }], MapWorker: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "1d75cc7Yv5I3LWoObi4uKpW", "MapWorker");var _o53,
        i = this && this.__extends || (_o53 = function o(t, e) {
      return (_o53 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o53(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 }), n.MapWorker = void 0;var r = function (t) {
      function e(e, n) {
        return void 0 === e && (e = null), void 0 === n && (n = 0), t.call(this, e, n) || this;
      }return i(e, t), e.prototype.checkByte = function (t) {
        return 128 == (240 & t) || 222 == t || 223 == t;
      }, e.prototype.checkType = function (t) {
        return t instanceof Object;
      }, e.prototype.assembly = function (t, e) {
        var n = [];for (var o in t) {
          n.push(o);
        }var i = n.length;i < 16 ? e.writeByte(128 | i) : i < 65536 ? (e.writeByte(222), e.writeShort(i)) : (e.writeByte(223), e.writeUnsignedInt(i));for (var r = 0; r < i; r++) {
          var a = n[r];this.factory.getWorkerByType(a).assembly(a, e), this.factory.getWorkerByType(t[a]).assembly(t[a], e);
        }
      }, e.prototype.disassembly = function (t, e) {
        var n,
            o,
            i,
            r,
            a = -1,
            s = 0,
            c = {},
            l = this.incomplete,
            u = this.incomplete;if (128 == (240 & t) ? a = 15 & t : 222 == t && e.bytesAvailable >= 2 ? a = e.readUnsignedShort() : 223 == t && e.bytesAvailable >= 4 && (a = e.readUnsignedInt()), s < a) for (var f = s; f < a; f++) {
          if (l == this.incomplete) {
            if (!n) {
              if (0 == e.bytesAvailable) break;o = 255 & e.readByte(), n = this.factory.getWorkerByByte(o);
            }l = n.disassembly(o, e);
          }if (l != this.incomplete && u == this.incomplete) {
            if (!i) {
              if (0 == e.bytesAvailable) break;r = 255 & e.readByte(), i = this.factory.getWorkerByByte(r);
            }u = i.disassembly(r, e);
          }if (l == this.incomplete || u == this.incomplete) break;c[l.toString()] = u, n = void 0, i = void 0, l = this.incomplete, u = this.incomplete, s++;
        }return s == a ? c : this.incomplete;
      }, e;
    }(t("./AbstractWorker").default);n.MapWorker = r, cc._RF.pop();
  }, { "./AbstractWorker": "AbstractWorker" }], MathUtil: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "77ad7NnkJ5Nn4STXAUiDspe", "MathUtil"), Object.defineProperty(n, "__esModule", { value: !0 });var o = function () {
      function t() {}return t.randomInt = function (t, e) {
        if (void 0 === e && (e = null), null != e) {
          var n = e - t;return Math.round(t + Math.random() * n);
        }return Math.round(Math.random() * t);
      }, t.randomFloat = function (t, e) {
        if (void 0 === e && (e = null), null != e) {
          var n = e - t;return t + Math.random() * n;
        }return Math.random() * t;
      }, t.randomArray = function (e) {
        if (e) for (var n, o, i = e.length - 1, r = 0; r < i; r++) {
          o = t.randomInt(r + 1, i), n = e[r], e[r] = e[o], e[o] = n;
        }
      }, t.clamp = function (t, e, n) {
        var o = t;return t < e ? o = e : t > n && (o = n), o;
      }, t.lerp = function (e, n, o) {
        return e + (n - e) * t.clamp(o, 0, 1);
      }, t.lerpAngle = function (e, n, o) {
        var i = t.repeat(n - e, 360);return i > 180 && (i -= 360), cc.v2(0, 0), e + i * t.clamp(o, 0, 1);
      }, t.repeat = function (t, e) {
        return t - Math.floor(t / e) * e;
      }, t.distance = function (t, e, n, o) {
        return Math.sqrt(Math.pow(t - n, 2) + Math.pow(e - o, 2));
      }, t.to = function (t, e, n, o) {
        var i = t + o * Math.cos(n),
            r = e + o * Math.sin(n);return cc.v2(i, r);
      }, t.splitInt = function (e, n) {
        for (var o = new Array(n), i = Math.floor(e / n + 1), r = e - i * n, a = r / n, s = 0; s < n; s++) {
          var c = s < n - 1 ? t.randomInt(0, a) : r;r -= c, o[s] = i + c;
        }return o;
      }, t.splitInt2 = function (t, e, n) {
        void 0 === n && (n = 1);for (var o = new Array(e), i = Math.round(e + 2 * Math.max(0, Math.min(n, 1)) * e + 1), r = Math.floor(t / i), a = t - r * e, s = a / ((e - 1) * e / 2), c = 0; c < e; c++) {
          a -= n = Math.max(1, Math.floor(c < e - 1 ? s * c : a)), o[c] = r + n;
        }return o;
      }, t.makePolygon = function (e, n, o) {
        if (void 0 === n && (n = 2), void 0 === o && (o = 50), e && e.getTextureData) {
          var i = [],
              r = e.width,
              a = e.height;e.getTextureData.prepare();var s,
              c,
              l = e.getTextureData().consumePixmap(),
              u = new Array(1020),
              f = new Array(1020),
              d = new Array(1020),
              h = 0,
              p = 0,
              _ = 0,
              m = -1,
              g = 0,
              y = 0;for (u[0] = 0, f[0] = 0, d[0] = 1, p = 0; p < r; p += n) {
            for (_ = 0; _ < a; _ += 1) {
              if (l.getPixel(p, _) >> 24 != 0) {
                u[h] = p, f[h] = a - _, d[h] = 1, h++, m < 0 && (m = _), g = p, y = _;break;
              }
            }
          }for (_ = 0; _ < a; _ += n) {
            for (p = r - 1; p >= 0; p -= 1) {
              if (l.getPixel(p, _) >> 24 != 0 && _ > y) {
                u[h] = p, f[h] = a - _, d[h] = 1, h++, g = p, y = _;break;
              }
            }
          }for (p = r - 1; p >= 0; p -= n) {
            for (_ = a - 1; _ >= 0; _ -= 1) {
              if (l.getPixel(p, _) >> 24 != 0 && p < g) {
                u[h] = p, f[h] = a - _, d[h] = 1, h++, g = p, y = _;break;
              }
            }
          }for (_ = a - 1; _ >= 0; _ -= n) {
            for (p = 0; p < r; p += 1) {
              if (l.getPixel(p, _) >> 24 != 0 && _ < y && _ > m) {
                u[h] = p, f[h] = a - _, d[h] = 1, h++, g = p, y = _;break;
              }
            }
          }for (var b = 0; b < h - 2; b++) {
            s = t._pointDirection(u[b], f[b], u[b + 1], f[b + 1]), c = t._pointDirection(u[b + 1], f[b + 1], u[b + 2], f[b + 2]), Math.abs(s - c) <= o && (d[b + 1] = 0);
          }for (s = t._pointDirection(u[h - 2], f[h - 2], u[h - 1], f[h - 1]), c = t._pointDirection(u[h - 1], f[h - 1], u[0], f[0]), Math.abs(s - c) <= o && (d[h - 1] = 0), s = t._pointDirection(u[h - 1], f[h - 1], u[0], f[0]), c = t._pointDirection(u[0], f[0], u[1], f[1]), Math.abs(s - c) <= o && (d[0] = 0), b = 0; b < h; b++) {
            if (1 == d[b]) {
              var C = cc.v2(u[b], a - f[b]);i.push(C);
            }
          }return e.getTextureData().disposePixmap(), i;
        }return null;
      }, t._pointDirection = function (t, e, n, o) {
        return 180 * Math.atan2(o - e, n - t) / Math.PI;
      }, t.randomWeight = function (e) {
        for (var n = 0, o = 0; o < e.length; o++) {
          n += e[o];
        }var i = t.randomInt(n),
            r = 0;for (o = 0; o < e.length;) {
          if (i <= (r += e[o])) return o;o += 1;
        }
      }, t.randomAverage = function (e) {
        return null == e || 0 == e.length ? null : e[t.randomInt(e.length - 1)];
      }, t.randomList = function (t, e) {
        if (e > t.length) return t;for (var n = []; n.length < e;) {
          var o = this.randomAverage(t);n.every(function (t) {
            return t != o;
          }) && n.push(o);
        }return n;
      }, t.toRandomList = function (t) {
        for (var e = t.length, n = []; n.length < e;) {
          var o = this.randomAverage(t);n.every(function (t) {
            return t != o;
          }) && n.push(o);
        }return n;
      }, t.convertColor = function (t) {
        var e = t >> 16 & 255,
            n = t >> 8 & 255,
            o = 255 & t;return new cc.Color(e, n, o, 128);
      }, t.convertToWorldSpace = function (t, e) {
        var n = cc.v3(),
            o = cc.mat4();return e.getWorldMatrix(o), cc.Vec3.transformMat4(n, t, o), n;
      }, t;
    }();n.default = o, cc._RF.pop();
  }, {}], MsgPackError: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "6a13bXmNG1J7Y7KB4dO4uyk", "MsgPackError");var _o54,
        i = this && this.__extends || (_o54 = function o(t, e) {
      return (_o54 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o54(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), e;
    }(Error);n.default = r, cc._RF.pop();
  }, {}], MsgPackFlags: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "40c21pxjKBBCK9FcmdkxnrT", "MsgPackFlags"), Object.defineProperty(n, "__esModule", { value: !0 });var o = function () {
      function t() {}return t.READ_STRING_AS_BYTE_ARRAY = 1, t.ACCEPT_LITTLE_ENDIAN = 2, t.SPEC2013_COMPATIBILITY = 4, t;
    }();n.default = o, cc._RF.pop();
  }, {}], MsgPack: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "598b3o4pqdEL6uH/DJ9SvJH", "MsgPack"), Object.defineProperty(n, "__esModule", { value: !0 });var o = t("../../../Common/Core/ByteArray"),
        i = t("./WorkerFactory"),
        r = t("./MsgPackFlags"),
        a = t("./MsgPackError"),
        s = t("./NullWorker"),
        c = t("./WorkerPriority"),
        l = t("./BooleanWorker"),
        u = t("./NumberWorker"),
        f = t("./StringWorker"),
        d = t("./ArrayWorker"),
        h = t("./BinaryWorker"),
        p = t("./MapWorker"),
        _ = function () {
      function t(t, e) {
        void 0 === t && (t = 0), void 0 === e && (e = null), this.incomplete = { toString: function toString() {
            return "incomplete";
          } }, e ? this._factory = e : (this._factory = new i.default(t), this._factory.assign(new s.default(null, c.default.DEFAULT_PRIORITY)), this._factory.assign(new l.default(null, c.default.DEFAULT_PRIORITY)), this._factory.assign(new u.default(null, c.default.DEFAULT_PRIORITY)), this._factory.assign(new f.default(null, c.default.DEFAULT_PRIORITY)), this._factory.assign(new d.default(null, c.default.DEFAULT_PRIORITY)), this._factory.assign(new h.default(null, c.default.DEFAULT_PRIORITY)), this._factory.assign(new p.MapWorker(null, c.default.DEFAULT_PRIORITY)));
      }return Object.defineProperty(t, "VERSION", { get: function get() {
          return "0.0.1";
        }, enumerable: !1, configurable: !0 }), t.write = function (e, n) {
        return void 0 === n && (n = null), new t().write(e, n);
      }, t.read = function (e) {
        return new t().read(e);
      }, Object.defineProperty(t.prototype, "factory", { get: function get() {
          return this._factory;
        }, enumerable: !1, configurable: !0 }), t.prototype.write = function (t, e) {
        void 0 === e && (e = null);var n = this._factory.getWorkerByType(t);return e || (e = new o.default()), this.checkBigEndian(e), n.assembly(t, e), e.position = 0, e;
      }, t.prototype.read = function (t) {
        if (this.checkBigEndian(t), !this.root) {
          if (0 == t.bytesAvailable) return this.incomplete;this.rootByte = 255 & t.readByte(), this.root = this._factory.getWorkerByByte(this.rootByte);
        }var e = this.root.disassembly(this.rootByte, t);return e != this.incomplete && (this.root = void 0), e;
      }, t.prototype.checkBigEndian = function (t) {
        if (t.endian == o.default.LITTLE_ENDIAN && !this._factory.checkFlag(r.default.ACCEPT_LITTLE_ENDIAN)) throw new a.default("Object uses little endian but MessagePack was designed for big endian. To avoid this error use the flag ACCEPT_LITTLE_ENDIAN.");
      }, t;
    }();n.default = _, cc._RF.pop();
  }, { "../../../Common/Core/ByteArray": "ByteArray", "./ArrayWorker": "ArrayWorker", "./BinaryWorker": "BinaryWorker", "./BooleanWorker": "BooleanWorker", "./MapWorker": "MapWorker", "./MsgPackError": "MsgPackError", "./MsgPackFlags": "MsgPackFlags", "./NullWorker": "NullWorker", "./NumberWorker": "NumberWorker", "./StringWorker": "StringWorker", "./WorkerFactory": "WorkerFactory", "./WorkerPriority": "WorkerPriority" }], MusicConfig: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "43f8bnzLu5Jd6t2a/Nzwrew", "MusicConfig");var _o55,
        i = this && this.__extends || (_o55 = function o(t, e) {
      return (_o55 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o55(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("../../Common/Config/AbsConfig"),
        a = t("./item/MusicData"),
        s = function (t) {
      function e() {
        return t.call(this, a.default) || this;
      }return i(e, t), Object.defineProperty(e, "ins", { get: function get() {
          return null == e._ins && (e._ins = new e()), e._ins;
        }, enumerable: !1, configurable: !0 }), e._ins = null, e;
    }(r.default);n.default = s, cc._RF.pop();
  }, { "../../Common/Config/AbsConfig": "AbsConfig", "./item/MusicData": "MusicData" }], MusicController: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "9337fp6lsROXKM7xsWzuDM9", "MusicController");var _o56,
        i = this && this.__extends || (_o56 = function o(t, e) {
      return (_o56 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o56(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 }), n.MusicController = void 0;var r = t("../Config/MusicConfig"),
        a = t("../../Common/Manager/TimeManager"),
        s = t("../../Common/Util/MathUtil"),
        c = t("../../Common/Manager/LoadResManager"),
        l = t("../../Common/Util/StringUtil"),
        u = t("../../Common/Manager/MusicManager"),
        f = function (t) {
      function e() {
        var e = t.call(this) || this;e._duration = 0, e._audioList = [], e._playList = [], e._durations = [], e._rhythms = [], e._audioIdx = 0, e._mute = !1, e._volume = 1, e._isPlaying = !1, e._isInit = !1, e._isPause = !1, e._currentTime = 0, e._duration = 0, e._loadIdx = 0;for (var n = r.default.ins.getList(), o = 0; o < n.length; o++) {
          var i = n[o],
              a = l.default.convertNumberArray(i.rhythm, ",");e._rhythms[o] = a, e._durations[o] = a[a.length - 1];
        }return e;
      }return i(e, t), Object.defineProperty(e, "ins", { get: function get() {
          return null == this._ins && (this._ins = new e()), this._ins;
        }, enumerable: !1, configurable: !0 }), e.prototype.randomMusic = function (t) {
        void 0 === t && (t = 0);var e = r.default.ins.getList(),
            n = [],
            o = [];switch (t) {case 0:
            for (var i = 0; i < e.length; i++) {
              o.push(i);
            }break;case 1:
            for (n = [0, 1, 2]; n.length > 0;) {
              var a = s.default.randomInt(0, n.length - 1);o.push(n[a]), n.splice(a, 1);
            }Math.random() > .5 ? (o.push(3), o.push(4)) : (o.push(4), o.push(3));break;default:
            for (n = [5, 6, 7]; n.length > 0;) {
              a = t % n.length, o.push(n[a]), n.splice(a, 1);
            }}return o;
      }, e.prototype.init = function (t, e, n) {
        void 0 === e && (e = null), void 0 === n && (n = null);var o = r.default.ins.getList();if (this._playList = this.randomMusic(t), this._rhythm = l.default.convertNumberArray(o[this._playList[0]].rhythm, ","), 0 == this._loadIdx) for (; null != this._audioList[this._playList[this._loadIdx]];) {
          this._loadIdx++;
        }this._loadIdx < this._playList.length - 1 ? (this._loadIdx <= 0 && this.loadMusic(), this._callback = e, this._owner = n) : e && e.call(n);
      }, Object.defineProperty(e.prototype, "isInit", { get: function get() {
          return this._isInit;
        }, enumerable: !1, configurable: !0 }), e.prototype.loadMusic = function () {
        var t = r.default.ins.getList(),
            e = this._playList[this._loadIdx],
            n = t[e];if (n) {
          var o = u.default.getAudioClip("Music/" + n.file.substr(0, +n.file.length - 4));if (this._loadIdx++, o) this.initMusic(o, e);else if (null == this._audioList[e]) {
            var i = this,
                a = e;c.default.bundle.load("Music/" + n.file.substr(0, +n.file.length - 4), cc.AudioClip, null, function (t, e) {
              i.initMusic(e, a);
            });
          }
        }
      }, e.prototype.initMusic = function (t, e) {
        this._audioList[e] = t, null == this._audio && (this._audio = new cc.AudioSource(), this._audio.volume = this._volume, this._audio.clip = t, this._audio.stop()), this._playList[0] == e && (this._callback && (this._callback.call(this._owner), this._callback = null, this._owner = null), this._isInit = !0), a.default.add(this.loadMusic, this, 1, 1);
      }, e.prototype.update = function (t) {
        this._isPlaying && this._audio && !this._isPause && (this._currentTime += t);
      }, e.prototype.next = function () {
        this._currentTime = 0, this._duration += this._durations[this.getAudioIndex(this._audioIdx)], this._audioIdx < this._playList.length - 1 ? this._audioIdx++ : this._audioIdx = 0, this._audio.clip = this._audioList[this.getAudioIndex(this._audioIdx)], this._rhythm = this._rhythms[this.getAudioIndex(this._audioIdx)], this._audio.rewind(), this._audio.play(), this._audio.mute || this.emit("next_music");
      }, Object.defineProperty(e.prototype, "rhythms", { get: function get() {
          return this._rhythm;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "nextRhythms", { get: function get() {
          return this._audioIdx >= this._playList.length - 1 ? this._rhythms[this.getAudioIndex(0)] : this._rhythms[this.getAudioIndex(this._audioIdx + 1)];
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "volume", { get: function get() {
          return this._volume;
        }, set: function set(t) {
          this._volume != t && (this._volume = t, this._audio && (this._audio.volume = t));
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "mute", { get: function get() {
          return this._mute;
        }, set: function set(t) {
          this._mute = t, this._audio && (this._audio.mute = t);
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "isPlaying", { get: function get() {
          return this._isPlaying;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "clip", { get: function get() {
          return this._audio ? this._audio.clip : null;
        }, enumerable: !1, configurable: !0 }), e.prototype.setCurrentTime = function (t) {
        this._currentTime = t, this._audio && this._audio.setCurrentTime(t);
      }, e.prototype.getCurrentTime = function () {
        return this._currentTime + this._duration;
      }, e.prototype.playSingle = function (t) {
        this._currentTime = 0, this._audio && (this._audio.play(), isNaN(t) || this._audio.setCurrentTime(t), this._isPlaying = !0, this._isPause = !1);
      }, e.prototype.playLoop = function (t) {
        void 0 === t && (t = null), this._currentTime = 0, this._audio && (this._audio.play(), isNaN(t) || this._audio.setCurrentTime(t), this._isPlaying = !0, this._isPause = !1);
      }, e.prototype.stop = function () {
        if (this._currentTime = 0, this._isPlaying = !1, this._isPause = !1, this._audioIdx = 0, this._duration = 0, this._audio) {
          var t = this.getAudioIndex(0);this._audio.stop(), this._audio.clip = this._audioList[t], this._rhythm = this._rhythms[t];
        }
      }, e.prototype.pause = function () {
        this._isPause = !0, this._audio && this._audio.pause();
      }, e.prototype.resume = function () {
        this._isPause = !1, this._audio && this._audio.resume();
      }, e.prototype.rewind = function () {
        var t = this.getAudioIndex(0);this._currentTime = 0, this._audioIdx = 0, this._duration = 0, this._audio.clip = this._audioList[t], this._rhythm = this._rhythms[t], this._isPause = !1, this._audio && (this._isPlaying = !0, this._audio.rewind(), this._audio.play());
      }, e.prototype.getDuration = function () {
        return this._duration;
      }, e.prototype.getNextDuration = function () {
        var t = s.default.clamp(this.getAudioIndex(this._audioIdx), 0, this._durations.length - 1);return this._duration + this._durations[t];
      }, e.prototype.getAudioIndex = function (t) {
        return this._playList[t];
      }, Object.defineProperty(e.prototype, "audioIdx", { get: function get() {
          return this._audioIdx;
        }, enumerable: !1, configurable: !0 }), e;
    }(cc.EventTarget);n.MusicController = f, cc._RF.pop();
  }, { "../../Common/Manager/LoadResManager": "LoadResManager", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/Manager/TimeManager": "TimeManager", "../../Common/Util/MathUtil": "MathUtil", "../../Common/Util/StringUtil": "StringUtil", "../Config/MusicConfig": "MusicConfig" }], MusicData: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "4d860bpQNdLHYFwfeE67XyA", "MusicData"), Object.defineProperty(n, "__esModule", { value: !0 });var o = function () {
      function t(t) {
        this._id = t.attributes.id, this._name = t.attributes.name, this._timer = t.attributes.timer, this._rhythm = t.attributes.rhythm, this._file = t.attributes.file;
      }return Object.defineProperty(t.prototype, "id", { get: function get() {
          return this._id;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "name", { get: function get() {
          return this._name;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "timer", { get: function get() {
          return this._timer;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "rhythm", { get: function get() {
          return this._rhythm;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "file", { get: function get() {
          return this._file;
        }, enumerable: !1, configurable: !0 }), t.cfgFile = "music", t;
    }();n.default = o, cc._RF.pop();
  }, {}], MusicManager: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "7f98eW7OqFNvbwDrEEWHo+g", "MusicManager"), Object.defineProperty(n, "__esModule", { value: !0 });var o = t("../../Game/Info/SetInfo"),
        i = function () {
      function t() {}return t.initSound = function (e, n) {
        if (null != n) {
          var o = new cc.AudioSource();o.clip = n, t.sounds[e] = o;
        }
      }, t.getAudioClip = function (e) {
        return t.sounds[e] ? t.sounds[e].clip : null;
      }, t.play = function (e, n) {
        void 0 === n && (n = !1);var i = t.sounds[e];null == i ? ((i = new cc.AudioSource()).loop = n, cc.resources.load(e, cc.AudioClip, function (n, r) {
          n || (i.clip = r, i.play(), i.volume = o.default.ins.music, t.sounds[e] = i);
        })) : (i.loop = n, i.play(), i.volume = o.default.ins.music);
      }, t.playEffect = function (e, n) {
        void 0 === e && (e = t.CLICK), void 0 === n && (n = !1), t.play(e, n);
      }, t.stopEffect = function (e) {
        var n = t.sounds[e];null != n && n.stop();
      }, t.playerBGM = function (e, n) {
        void 0 === e && (e = t.MUSIC), void 0 === n && (n = !1), o.default.ins.music > 0 && (n || null != e && this._bgm != e) && (null != this._bgm && this.stopBGM(), this._bgm = e, t.play(this._bgm, !0));
      }, t.stopBGM = function () {
        var e = t.sounds[this._bgm];null != e && (e.stop(), this._bgm = null);
      }, t.pauseBGM = function () {
        var e = t.sounds[this._bgm];null != e && (e.pause(), this._isPause = !0);
      }, t.resumeBGM = function () {
        if (o.default.ins.music > 0 && this._isPause) {
          this._isPause = !1;var e = t.sounds[this._bgm];null != e && e.resume();
        }
      }, t.resetVolume = function () {
        o.default.ins.music > 0 ? t.resumeBGM() : t.pauseBGM();
      }, t.CLICK = "Sounds/click", t.HIT = "Sounds/hit", t.PERFECT = "Sounds/perfect", t.THROW = "Sounds/throw", t.HITTARGET = "Sounds/hittarget", t.MUSIC = "Music/01", t.sounds = {}, t._isPause = !1, t;
    }();n.default = i, cc._RF.pop();
  }, { "../../Game/Info/SetInfo": "SetInfo" }], MyExchangePanel: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "0f6bbXiPyhHtqtcLX10JJnf", "MyExchangePanel");var _o57,
        i = this && this.__extends || (_o57 = function o(t, e) {
      return (_o57 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o57(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Util/ComponentUtil"),
        c = t("../../Common/Manager/MusicManager"),
        l = t("../../Common/Core/GameType"),
        u = t("../../Common/UI/UIManager"),
        f = t("../Manager/CommandController"),
        d = t("./UIExchangeLog"),
        h = cc._decorator,
        p = h.ccclass,
        _ = (h.property, function (t) {
      function e() {
        var e = t.call(this) || this;return e._isForceShade = !0, e;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return l.UILayerType.SubWindowLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.btn_close = s.default.getComponent(cc.Button, this.node, "frame/btn_close"), this.btn_close.node.on(cc.Node.EventType.TOUCH_END, this.onTouchCloseHandler, this), this.scrollview = s.default.getComponent(cc.ScrollView, this.node, "frame/scrollview"), this.UIExchangeLog = s.default.getNode(this.node, "frame/UIExchangeLog");
      }, e.prototype.onShow = function () {
        this.refresh();
      }, e.prototype.onClose = function () {}, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), this.btn_close.node.targetOff(this);
      }, e.prototype.refresh = function () {
        var t = this;this.scrollview.content.removeAllChildren(!0), f.default.myExchangeList(function (e) {
          for (var n = e.l, o = 0; o < n.length; o++) {
            var i = n[o],
                r = cc.instantiate(t.UIExchangeLog).getComponent(d.default);r.data = i, r.node.active = !0, t.scrollview.content.addChild(r.node);
          }t.scrollview.scrollToTop(0);
        }, this);
      }, e.prototype.onTouchCloseHandler = function () {
        c.default.playEffect(c.default.CLICK), u.default.close(this);
      }, r([p], e);
    }(a.default));n.default = _, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Manager/CommandController": "CommandController", "./UIExchangeLog": "UIExchangeLog" }], NetUtil: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "dda96ZV84pAMahYpTF7MxfY", "NetUtil"), Object.defineProperty(n, "__esModule", { value: !0 });var o = t("./StringUtil"),
        i = t("./MathUtil"),
        r = function () {
      function t() {}return t.GET = function (t, e, n, i) {
        void 0 === i && (i = null);var r = new XMLHttpRequest();r.onreadystatechange = function () {
          if (4 == r.readyState) if (r.status >= 200 && r.status < 400) {
            var t = r.responseText;if (t) {
              var e = JSON.parse(t);n.call(i, e);
            } else console.log("\u8FD4\u56DE\u6570\u636E\u4E0D\u5B58\u5728"), n.call(i, { errCode: 0, errMsg: "\u8FD4\u56DE\u6570\u636E\u4E0D\u5B58\u5728" });
          } else console.log("\u8BF7\u6C42\u5931\u8D25-" + r.status), n.call(i, { errCode: 0, errMsg: "\u7F51\u7EDC\u5F02\u5E38\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5" });
        }, r.open("GET", t + "?" + o.default.formatHttpParams(e), !0), r.send();
      }, t.POST = function (t, e, n, i) {
        void 0 === i && (i = null);var r = new XMLHttpRequest();r.onreadystatechange = function () {
          if (4 == r.readyState) if (r.status >= 200 && r.status < 400) {
            var t = r.responseText;if (t) {
              var e = JSON.parse(t);n.call(i, e);
            } else console.log("\u8FD4\u56DE\u6570\u636E\u4E0D\u5B58\u5728"), n.call(i, null);
          } else console.log("\u8BF7\u6C42\u5931\u8D25-" + r.status), n.call(i, { errCode: 0, errMsg: "\u7F51\u7EDC\u5F02\u5E38\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5" });
        }, r.open("POST", t, !0), r.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"), r.send(o.default.formatHttpParams(e));
      }, t.encodePost = function (e, n, r, a) {
        void 0 === a && (a = null);var s = new XMLHttpRequest();s.onreadystatechange = function () {
          if (4 == s.readyState) if (s.status >= 200 && s.status < 400) {
            var e = s.responseText;if (e) {
              var n = JSON.parse(e),
                  o = t.decode(n.t, n.v);r.call(a, o);
            } else console.log("\u8FD4\u56DE\u6570\u636E\u4E0D\u5B58\u5728"), r.call(a, null);
          } else console.log("\u8BF7\u6C42\u5931\u8D25-" + s.status), r.call(a, { errCode: 0, errMsg: "\u7F51\u7EDC\u5F02\u5E38\uFF0C\u8BF7\u7A0D\u540E\u518D\u8BD5" });
        };var c = i.default.randomInt(1e7, 99999999),
            l = { t: c, v: t.encode(c, n) };s.open("POST", e, !0), s.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"), s.send(o.default.formatHttpParams(l));
      }, t.encrypt = function (t, e) {
        for (var n, o = e.length, i = (t ^ o) % 255, r = ((o & i) + (t ^ i)) % 255, a = [], s = 0; s < o; s++) {
          i -= (r * o ^ t) % 255, t -= r, n = 255 & ((n = e[s]) ^ (r = i % 255)), a.push(n);
        }return a;
      }, t.encode = function (e, n) {
        var i = JSON.stringify(n),
            r = t.encrypt(e, o.default.stringToByte(i));return o.default.parseByte2HexStr(r);
      }, t.decode = function (e, n) {
        var i = t.encrypt(e, o.default.parseHexStr2Byte(n)),
            r = o.default.byteToString(i);return JSON.parse(r);
      }, t;
    }();n.default = r, cc._RF.pop();
  }, { "./MathUtil": "MathUtil", "./StringUtil": "StringUtil" }], NoticePanel: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "ea24ffGyYlBlo6IFDf8mPBs", "NoticePanel");var _o58,
        i = this && this.__extends || (_o58 = function o(t, e) {
      return (_o58 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o58(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Util/ComponentUtil"),
        c = t("../../Common/Manager/MusicManager"),
        l = t("../../Common/Core/GameType"),
        u = t("../../Common/UI/UIManager"),
        f = t("../../Common/Sdks/UmaTrackHelper"),
        d = t("../Info/SetInfo"),
        h = t("../../Common/Manager/TimeManager"),
        p = cc._decorator,
        _ = p.ccclass,
        m = (p.property, function (t) {
      function e() {
        var e = t.call(this) || this;return e._isForceShade = !0, e;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return l.UILayerType.SubPopLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.btn_close = s.default.getComponent(cc.Button, this.node, "frame/btn_close"), this.btn_close.node.on(cc.Node.EventType.TOUCH_END, this.onTouchCloseHandler, this);
      }, e.prototype.onShow = function () {
        d.default.ins.notice = h.default.timeToInt(new Date(h.default.serverTime)), f.default.trackEvent("1001");
      }, e.prototype.onClose = function () {}, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), this.btn_close.node.targetOff(this);
      }, e.prototype.onTouchCloseHandler = function () {
        c.default.playEffect(c.default.CLICK), f.default.trackEvent("1002"), u.default.close(this);
      }, r([_], e);
    }(a.default));n.default = m, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/Manager/TimeManager": "TimeManager", "../../Common/Sdks/UmaTrackHelper": "UmaTrackHelper", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Info/SetInfo": "SetInfo" }], NullWorker: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "84ea048qaRPOIhaQF8lhNce", "NullWorker");var _o59,
        i = this && this.__extends || (_o59 = function o(t, e) {
      return (_o59 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o59(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = function (t) {
      function e(e, n) {
        return void 0 === e && (e = null), void 0 === n && (n = 0), t.call(this, e, n) || this;
      }return i(e, t), e.prototype.checkByte = function (t) {
        return 192 == t;
      }, e.prototype.checkType = function (t) {
        return null == t;
      }, e.prototype.assembly = function (t, e) {
        e.writeByte(192);
      }, e.prototype.disassembly = function () {
        return null;
      }, e;
    }(t("./AbstractWorker").default);n.default = r, cc._RF.pop();
  }, { "./AbstractWorker": "AbstractWorker" }], NumValueBase64: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "c135c47QfVKnIyBK5N9HxOe", "NumValueBase64"), Object.defineProperty(n, "__esModule", { value: !0 });var o = t("../Util/Base64"),
        i = t("../Util/MathUtil"),
        r = function () {
      function t(t) {
        void 0 === t && (t = 0), this.value = t;var e = o.default.keystr;this._key = e.substr(0, i.default.randomInt(10, 20));
      }return Object.defineProperty(t.prototype, "value", { get: function get() {
          var t = o.default.decode(this._v).split("_"),
              e = null;if (2 == t.length) {
            var n = t[1];e = parseInt(n);
          }return e;
        }, set: function set(t) {
          var e = this._key + "_" + t;this._v = o.default.encode(e);
        }, enumerable: !1, configurable: !0 }), t;
    }();n.default = r, cc._RF.pop();
  }, { "../Util/Base64": "Base64", "../Util/MathUtil": "MathUtil" }], NumValue: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "b16acf1solDnKUVUL6SVcNn", "NumValue"), Object.defineProperty(n, "__esModule", { value: !0 });var o = function () {
      function t(t) {
        void 0 === t && (t = 0), this.r = .6 * Math.random() + .2, this.value = t;
      }return Object.defineProperty(t.prototype, "value", { get: function get() {
          return this.v1 + this.v2;
        }, set: function set(t) {
          this.v1 = Math.floor(t * this.r), this.v2 = t - this.v1;
        }, enumerable: !1, configurable: !0 }), t;
    }();n.default = o, cc._RF.pop();
  }, {}], NumberWorker: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "35c91Q3EqNNbbvdGiOajpTF", "NumberWorker");var _o60,
        i = this && this.__extends || (_o60 = function o(t, e) {
      return (_o60 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o60(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = function (t) {
      function e(e, n) {
        return void 0 === e && (e = null), void 0 === n && (n = 0), t.call(this, e, n) || this;
      }return i(e, t), e.prototype.checkByte = function (t) {
        return 202 == t || 203 == t || 0 == (128 & t) || 224 == (224 & t) || 204 == t || 205 == t || 206 == t || 208 == t || 209 == t || 210 == t || 207 == t || 211 == t;
      }, e.prototype.checkType = function (t) {
        return "number" == typeof t;
      }, e.prototype.assembly = function (t, e) {
        Math.floor(t) != t ? (e.writeByte(203), e.writeDouble(t)) : t < -32 ? t < -(1 << 31) ? (e.writeByte(211), e.writeInt(Math.floor(t / 4294967296)), e.writeUnsignedInt(t)) : t < -32768 ? (e.writeByte(210), e.writeInt(t)) : t < -128 ? (e.writeByte(209), e.writeShort(t)) : (e.writeByte(208), e.writeByte(t)) : t < 128 ? e.writeByte(t) : t < 256 ? (e.writeByte(204), e.writeByte(t)) : t < 65536 ? (e.writeByte(205), e.writeShort(t)) : t < 1 ? (e.writeByte(206), e.writeUnsignedInt(t)) : (e.writeByte(207), e.writeUnsignedInt(Math.floor(t / 4294967296)), e.writeUnsignedInt(t));
      }, e.prototype.disassembly = function (t, e) {
        return 203 == t && e.bytesAvailable >= 8 ? e.readDouble() : 202 == t && e.bytesAvailable >= 4 ? e.readFloat() : 211 == t && e.bytesAvailable >= 8 ? 4294967296 * e.readInt() + e.readUnsignedInt() : 207 == t && e.bytesAvailable >= 8 ? 4294967296 * e.readUnsignedInt() + e.readUnsignedInt() : 0 == (128 & t) ? t : 224 == (224 & t) ? t - 255 - 1 : 204 == t && e.bytesAvailable >= 1 ? e.readUnsignedByte() : 205 == t && e.bytesAvailable >= 2 ? e.readUnsignedShort() : 206 == t && e.bytesAvailable >= 4 ? e.readUnsignedInt() : 208 == t && e.bytesAvailable >= 1 ? e.readByte() : 209 == t && e.bytesAvailable >= 2 ? e.readShort() : 210 == t && e.bytesAvailable >= 4 ? e.readInt() : 211 == t && e.bytesAvailable >= 8 ? 4294967296 * e.readInt() + e.readUnsignedInt() : 207 == t && e.bytesAvailable >= 8 ? 4294967296 * e.readUnsignedInt() + e.readUnsignedInt() : this.incomplete;
      }, e;
    }(t("./AbstractWorker").default);n.default = r, cc._RF.pop();
  }, { "./AbstractWorker": "AbstractWorker" }], ObjectActor: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "3243a3qnJ9JULblb1K/wUUn", "ObjectActor");var _o61,
        i = this && this.__extends || (_o61 = function o(t, e) {
      return (_o61 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o61(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/Manager/LoadResManager"),
        s = cc._decorator,
        c = s.ccclass,
        l = (s.property, function (t) {
      function e() {
        var e = t.call(this) || this;return e.group = "actor", e.is3DNode = !0, e;
      }return i(e, t), e.prototype.setName = function (t) {
        var e = this;this.name = t, a.default.bundle.load("Prefab/" + t, cc.Prefab, function (t, n) {
          e.initModel(n);
        });
      }, e.prototype.initModel = function (t) {
        var e;e = cc.instantiate(t), this.addChild(e);
      }, r([c], e);
    }(cc.Node));n.default = l, cc._RF.pop();
  }, { "../../Common/Manager/LoadResManager": "LoadResManager" }], PKHeadInfo: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "ae29dBhimdDFbRa1pzvous2", "PKHeadInfo");var _o62,
        i = this && this.__extends || (_o62 = function o(t, e) {
      return (_o62 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o62(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("../../../Common/Manager/Logger"),
        a = t("../../../Common/UI/UIItem"),
        s = t("../../../Common/Util/ComponentUtil"),
        c = t("../../Main/item/FbHead"),
        l = function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), e.prototype.init = function () {
        this.txt_name = s.default.getComponent(cc.Label, this.node, "txt_name"), this.txt_sjnum = s.default.getComponent(cc.Label, this.node, "txt_sjnum"), this.txt_sjrank = s.default.getComponent(cc.Label, this.node, "txt_sjrank"), this.mask = s.default.getNode(this.node, "mask"), this.head = new c.default(this.node), this.txt_sjrank.string = "";
      }, e.prototype.onShow = function () {
        this.txt_name.string = "", this.txt_sjnum.string = "", this.txt_sjrank.string = "", this.mask.active = !1;
      }, e.prototype.setData = function (t, e, n, o) {
        null == e && (e = 0), null == t && (t = "null"), this.txt_name.string = t, this.txt_sjnum.string = e.toString(), this.txt_sjrank.string = 0 == o ? "\u672A\u4E0A\u699C" : o.toString(), r.default.log(o, "rank"), this.mask.active = !0, this.head.setIcon(n);
      }, e.prototype.destroy = function () {
        t.prototype.destroy.call(this), this.head.destroy(), this.head = null;
      }, e;
    }(a.default);n.default = l, cc._RF.pop();
  }, { "../../../Common/Manager/Logger": "Logger", "../../../Common/UI/UIItem": "UIItem", "../../../Common/Util/ComponentUtil": "ComponentUtil", "../../Main/item/FbHead": "FbHead" }], PacketDataEvent: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "89ecdsbdrRFubCNdra98OCM", "PacketDataEvent");var _o63,
        i = this && this.__extends || (_o63 = function o(t, e) {
      return (_o63 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o63(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("../../Common/Util/StringUtil"),
        a = function (t) {
      function e(e, n, o) {
        var i = t.call(this, "cmd:0x" + r.default.toString(e, 16, 4).toUpperCase(), !1) || this;return i._cmd = e, i._stamp = n, i._body = o, i;
      }return i(e, t), Object.defineProperty(e.prototype, "cmd", { get: function get() {
          return this._cmd;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "stamp", { get: function get() {
          return this._stamp;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "body", { get: function get() {
          return this._body;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "isError", { get: function get() {
          return null != this._body && null != this._body.errCode;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "errorCode", { get: function get() {
          return null != this._body && null != this._body.errCode ? this._body.errCode : null;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "error", { get: function get() {
          var t = this._body.errMsg;return null != this._body && 1 != this._body.errCode && null != t ? -1 != t.indexOf("\u6743\u9650") ? null : t : null;
        }, enumerable: !1, configurable: !0 }), e;
    }(cc.Event);n.default = a, cc._RF.pop();
  }, { "../../Common/Util/StringUtil": "StringUtil" }], PlayerInfo: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "23685f8r+dGWoa1Mu0Z/sFp", "PlayerInfo");var _o64,
        i = this && this.__extends || (_o64 = function o(t, e) {
      return (_o64 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o64(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("../../Common/Info/AbsInfo"),
        a = t("../../Common/Core/NumValue"),
        s = t("../../Common/Core/GameType"),
        c = t("../../Common/Manager/Logger"),
        l = function (t) {
      function e() {
        var e = t.call(this) || this;return e._giftCoupon = new a.default(), e._money = new a.default(), e._todayGiftCoupon = new a.default(), e;
      }return i(e, t), Object.defineProperty(e, "ins", { get: function get() {
          return null == e._ins && (e._ins = new e()), e._ins;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "giftCoupon", { get: function get() {
          return this._giftCoupon.value;
        }, set: function set(t) {
          this._giftCoupon.value != t && (this._giftCoupon.value = t, this.emit(s.InfoEvent.EVENT_CHANGE));
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "todayGiftCoupon", { get: function get() {
          return this._todayGiftCoupon.value;
        }, set: function set(t) {
          this._todayGiftCoupon.value != t && (this._todayGiftCoupon.value = t);
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "money", { get: function get() {
          return this._money.value;
        }, set: function set(t) {
          this._money.value != t && (this._money.value = t, c.default.log("--------------money ", t), this.emit(s.InfoEvent.EVENT_CHANGE));
        }, enumerable: !1, configurable: !0 }), e.prototype.init = function (t) {
        t && (null != t.money && (this.money = t.money), null != t.gfc && (this.giftCoupon = t.gfc), null != t.tgfc && (this.todayGiftCoupon = t.tgfc));
      }, e.prototype.onNewDayHandler = function () {
        this.todayGiftCoupon = 0;
      }, e;
    }(r.default);n.default = l, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Core/NumValue": "NumValue", "../../Common/Info/AbsInfo": "AbsInfo", "../../Common/Manager/Logger": "Logger" }], ProInfoCtr: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "e5297fdFKlBh4ilubv3I20p", "ProInfoCtr");var _o65,
        i = this && this.__extends || (_o65 = function o(t, e) {
      return (_o65 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o65(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("../../../Common/Core/GameType"),
        a = t("../../../Common/Manager/Logger"),
        s = t("../../../Common/Manager/MusicManager"),
        c = t("../../../Common/UI/UIItem"),
        l = t("../../../Common/UI/UIManager"),
        u = t("../../../Common/Util/ComponentUtil"),
        f = t("../../Info/PlayerInfo"),
        d = t("../CoinExchangePanel"),
        h = function (t) {
      function e(e) {
        return t.call(this, e) || this;
      }return i(e, t), e.prototype.init = function () {
        t.prototype.init.call(this), this.txt_money = u.default.getComponent(cc.Label, this.node, "minfo/txt_value"), this.txt_jq = u.default.getComponent(cc.Label, this.node, "jinfo/txt_value"), this.btn_add = u.default.getNode(this.node, "jinfo/btn_add"), this.btn_add.on(cc.Node.EventType.TOUCH_END, this.onTouchAddHandler, this), f.default.ins.on(r.InfoEvent.EVENT_CHANGE, this.dataChange, this);
      }, e.prototype.onTouchAddHandler = function () {
        s.default.playEffect(s.default.CLICK), a.default.log("----------onTouchAddHandler-----------------"), l.default.show(d.default);
      }, e.prototype.onShow = function () {
        this.dataChange();
      }, e.prototype.dataChange = function () {
        a.default.log("----------dataChange-----------------"), this.txt_money.string = f.default.ins.money.toString(), this.txt_jq.string = f.default.ins.giftCoupon.toString();
      }, e.prototype.destroy = function () {
        t.prototype.destroy.call(this);
      }, e;
    }(c.default);n.default = h, cc._RF.pop();
  }, { "../../../Common/Core/GameType": "GameType", "../../../Common/Manager/Logger": "Logger", "../../../Common/Manager/MusicManager": "MusicManager", "../../../Common/UI/UIItem": "UIItem", "../../../Common/UI/UIManager": "UIManager", "../../../Common/Util/ComponentUtil": "ComponentUtil", "../../Info/PlayerInfo": "PlayerInfo", "../CoinExchangePanel": "CoinExchangePanel" }], ProductConfig: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "06feaIRXS9HFpRXA78CuTUF", "ProductConfig");var _o66,
        i = this && this.__extends || (_o66 = function o(t, e) {
      return (_o66 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o66(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("../../Common/Config/AbsConfig"),
        a = t("./item/ProductData"),
        s = function (t) {
      function e() {
        return t.call(this, a.default) || this;
      }return i(e, t), Object.defineProperty(e, "ins", { get: function get() {
          return null == e._ins && (e._ins = new e()), e._ins;
        }, enumerable: !1, configurable: !0 }), e._ins = null, e;
    }(r.default);n.default = s, cc._RF.pop();
  }, { "../../Common/Config/AbsConfig": "AbsConfig", "./item/ProductData": "ProductData" }], ProductData: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "c35b0nKfc5LL4Tn6ydYAMzA", "ProductData"), Object.defineProperty(n, "__esModule", { value: !0 });var o = function () {
      function t(t) {
        this._id = t.attributes.id, this._name = t.attributes.name, this._type = t.attributes.type, this._kind = t.attributes.kind, this._icon = t.attributes.icon, this._cmd = t.attributes.cmd, this._cmd_ios = t.attributes.cmd_ios, this._fun_script = t.attributes.fun_script, this._fun_para = t.attributes.fun_para, this._model = t.attributes.model, this._effect = t.attributes.effect, this._desc = t.attributes.desc;
      }return Object.defineProperty(t.prototype, "id", { get: function get() {
          return this._id;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "name", { get: function get() {
          return this._name;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "type", { get: function get() {
          return this._type;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "kind", { get: function get() {
          return this._kind;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "icon", { get: function get() {
          return this._icon;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "cmd", { get: function get() {
          return this._cmd;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "cmd_ios", { get: function get() {
          return this._cmd_ios;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "fun_script", { get: function get() {
          return this._fun_script;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "fun_para", { get: function get() {
          return this._fun_para;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "model", { get: function get() {
          return this._model;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "effect", { get: function get() {
          return this._effect;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "desc", { get: function get() {
          return this._desc;
        }, enumerable: !1, configurable: !0 }), t.cfgFile = "product", t;
    }();n.default = o, cc._RF.pop();
  }, {}], QueuePanelManager: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "e9783oOyIdJtLIuGyCNh+JM", "QueuePanelManager"), Object.defineProperty(n, "__esModule", { value: !0 }), n.QueuePanelItem = void 0;var o = t("../../Common/Manager/GlobalEventManager"),
        i = t("../../Common/UI/UIManager"),
        r = t("../../Common/Manager/TimeManager"),
        a = t("../../Common/Core/GameType"),
        s = function s(t, e, n) {
      void 0 === e && (e = null), void 0 === n && (n = 0), this.clazz = t, this.data = e, this.delay = n;
    };n.QueuePanelItem = s;var c = function () {
      function t() {}return t.init = function () {
        o.default.on(a.UIEvent.EVENT_CLOSE, t.onPanleCloseHandler, t);
      }, t.onPanleCloseHandler = function (e) {
        t._curItem && (e[0] instanceof t._curItem.clazz ? t.show() : t._curItem = null);
      }, t.add = function (e, n, o) {
        void 0 === n && (n = null), void 0 === o && (o = 0);var i = new s(e, n, o);t._list.push(i);
      }, t.show = function () {
        if (t._list.length > 0) {
          var e = t._list.shift();t._curItem = e, e.delay > 0 ? r.default.add(function () {
            i.default.show(e.clazz, e.data);
          }, t, e.delay, 1) : i.default.show(e.clazz, e.data);
        } else t._curItem = null;
      }, t.clear = function () {
        r.default.removeTarget(t), t._list.splice(0, t._list.length), t._curItem = null;
      }, Object.defineProperty(t, "isShowing", { get: function get() {
          return null != t._curItem;
        }, enumerable: !1, configurable: !0 }), t._list = [], t;
    }();n.default = c, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/GlobalEventManager": "GlobalEventManager", "../../Common/Manager/TimeManager": "TimeManager", "../../Common/UI/UIManager": "UIManager" }], RankPanel: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "8dd52IsIFtHbp2om0wVKraN", "RankPanel");var _o67,
        i = this && this.__extends || (_o67 = function o(t, e) {
      return (_o67 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o67(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 }), n.GRankItem = n.RankCtr = n.RankItem = n.GRankDataType = n.GRankType = void 0;var a,
        s,
        c = t("../../Common/UI/UIPanel"),
        l = t("../../Common/Util/ComponentUtil"),
        u = t("../../Common/Manager/MusicManager"),
        f = t("../../Common/Core/GameType"),
        d = t("../../Common/UI/UIManager"),
        h = t("../../Common/Sdks/GameSDK"),
        p = t("../../Common/Sdks/UmaTrackHelper"),
        _ = t("../../Common/UI/UIItem"),
        m = t("./SubContextViewController"),
        g = t("../Manager/CommandController"),
        y = cc._decorator,
        b = y.ccclass;y.property, function (t) {
      t[t.showByData = 1] = "showByData", t[t.showByOpenData = 2] = "showByOpenData";
    }(a = n.GRankType || (n.GRankType = {})), function (t) {
      t[t.none = 0] = "none", t[t.rankRlz = 1] = "rankRlz", t[t.rankPk = 2] = "rankPk";
    }(s = n.GRankDataType || (n.GRankDataType = {}));var C = function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), e.prototype.init = function () {
        this.txt_name = l.default.getComponent(cc.Label, this.node, "txt_name"), this.txt_num = l.default.getComponent(cc.Label, this.node, "txt_num"), this.txt_index = l.default.getComponent(cc.Label, this.node, "txt_index"), this.icon_head = l.default.getComponent(cc.Sprite, this.node, "mask/icon_head"), this.selected = l.default.getNode(this.node, "selected"), this.wsb = l.default.getNode(this.node, "wsb"), this.setSelected(!1);
      }, e.prototype.setSelected = function (t) {
        this.selected.active = t;
      }, e.prototype.onShow = function () {}, e.prototype.onClose = function () {}, e.prototype.setData = function (t, e) {
        this.data = t;var n = t.id,
            o = 0;e == s.rankRlz ? o = t.rlz : e == s.rankPk && (o = t.pkp), null == o && (o = 0);var i = t.nick,
            r = (t.uid, t.atl);null == i && (i = ""), null == r && (r = "null"), n > 0 ? (null != r && "" != r && "null" != r && l.default.loadRemoteImg(this.icon_head, r), this.txt_index.string = 1 == n ? "a" : 2 == n ? "b" : 3 == n ? "c" : n.toString(), this.txt_name.string = i, this.txt_num.string = o.toString(), null != this.wsb && (this.wsb.active = !1)) : (null != this.wsb && (this.wsb.active = !0), this.txt_index.string = "", this.txt_name.string = i, this.txt_num.string = "");
      }, e.prototype.destroy = function () {
        t.prototype.destroy.call(this), this.txt_name = null, this.txt_num = null, this.txt_index = null, this.icon_head = null;
      }, e;
    }(_.default);n.RankItem = C;var v = function (t) {
      function e() {
        var e = null !== t && t.apply(this, arguments) || this;return e.hasGetDataForServer = !1, e;
      }return i(e, t), e.prototype.init = function () {
        this.contextView = l.default.getNode(this.node, "contextView"), this.scrollview = l.default.getComponent(cc.ScrollView, this.node, "scrollview"), this.UItem = l.default.getNode(this.node, "UItem"), this.UItem.active = !1, this.rankItems = Array();var t = l.default.getNode(this.node, "myItem");this._myItem = new C(t);
      }, e.prototype.setCfData = function (t, e, n) {
        this._type = t, this._dataType = n, this._showAndCloseCallId = e;
      }, e.prototype.showRank = function () {
        switch (this._showAndCloseCallId) {case 1:
            m.default.ins.showRank1(this.contextView);break;case 2:
            m.default.ins.showRank2(this.contextView);}
      }, e.prototype.closeRank = function () {
        switch (this._showAndCloseCallId) {case 1:
            m.default.ins.closeRank1(this.contextView);break;case 2:
            m.default.ins.closeRank2(this.contextView);}
      }, e.prototype.initScrollViewData = function (t, e) {
        for (var n = this.rankItems.length, o = 0; o < n; o++) {
          this.rankItems[o].destroy();
        }this.rankItems = new Array(), this.scrollview.content.removeAllChildren();var i = h.default.getUid();for (n = t.length, o = 0; o < n; o++) {
          var r = t[o],
              a = cc.instantiate(this.UItem),
              s = new C(a);s.setData(r, this._dataType), a.active = !0, this.scrollview.content.addChild(a), i == r.uid ? s.setSelected(!0) : s.setSelected(!1);
        }e.nick = h.default.getNickname(), e.atl = h.default.getIcon(), this._myItem.setSelected(!0), this._myItem.setData(e, this._dataType);
      }, e.prototype.onShow = function () {
        switch (this._type) {case a.showByData:
            this.contextView.active = !1, this.scrollview.node.active = !0, this._dataType == s.rankPk ? this.hasGetDataForServer || (g.default.rankPk(this.getRankSuccess, this, this.getRankFail), this.hasGetDataForServer = !0) : this._dataType == s.rankRlz && (this.hasGetDataForServer || (g.default.rankRlz(this.getRankSuccess, this, this.getRankFail), this.hasGetDataForServer = !0));break;case a.showByOpenData:
            this.contextView.active = !0, this.scrollview.node.active = !1, this._myItem.active = !1, this.showRank();}
      }, e.prototype.getRankSuccess = function (t) {
        var e = t.my,
            n = t.l;this.initScrollViewData(n, e);
      }, e.prototype.getRankFail = function () {}, e.prototype.onClose = function () {
        switch (this._type) {case a.showByData:
            break;case a.showByOpenData:
            this.closeRank();}
      }, e.prototype.destroy = function () {
        t.prototype.destroy.call(this);
      }, e;
    }(_.default);n.RankCtr = v;var I = function (t) {
      function e(e, n, o, i, r, a) {
        void 0 === o && (o = -1), void 0 === i && (i = -1), void 0 === r && (r = s.none), void 0 === a && (a = s.none);var c = t.call(this, e) || this;return c.ranks[0].setCfData(n, o, r), c.ranks[1].setCfData(n, i, a), c;
      }return i(e, t), e.prototype.init = function () {
        this.toggleCt = l.default.getComponent(cc.ToggleContainer, this.node, "toggleCt");var t = l.default.getNode(this.node, "rank0"),
            e = l.default.getNode(this.node, "rank1");this.ranks = new Array(), this.ranks.push(new v(t)), this.ranks.push(new v(e)), this.setOnToggleByName("toggle1");
      }, e.prototype.onToggle = function (t) {
        var e = t.node.name;this.setOnToggleByName(e);
      }, e.prototype.setOnToggleByName = function (t) {
        "toggle1" == t ? (this.ranks[0].x = 0, this.ranks[1].x = -2e3, this.ranks[0].onShow()) : "toggle2" == t && (this.ranks[0].x = -2e3, this.ranks[1].x = 0, this.ranks[1].onShow());
      }, e.prototype.onShow = function () {
        this.ranks[0].hasGetDataForServer = !1, this.ranks[1].hasGetDataForServer = !1, this.ranks[0].onShow();
      }, e.prototype.onClose = function () {
        this.ranks[0].onClose(), this.ranks[1].onClose();
      }, e.prototype.destroy = function () {
        t.prototype.destroy.call(this);for (var e = this.ranks.length, n = 0; n < e; n++) {
          this.ranks[n].destroy();
        }this.ranks = null;
      }, e;
    }(_.default);n.GRankItem = I;var M = function (t) {
      function e() {
        var e = t.call(this) || this;return e._isForceShade = !0, e;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return f.UILayerType.SubPopLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.btn_close = l.default.getComponent(cc.Button, this.node, "frame/btn_close"), this.btn_close.node.on(cc.Node.EventType.TOUCH_END, this.onTouchCloseHandler, this), this.toggle = l.default.getComponent(cc.ToggleContainer, this.node, "frame/toggle");var t = l.default.getNode(this.node, "frame/rankG0"),
            e = l.default.getNode(this.node, "frame/rankG1");this.granks = new Array(), this.granks.push(new I(t, a.showByOpenData, 1, 2)), this.granks.push(new I(e, a.showByData, -1, -1, s.rankRlz, s.rankPk)), this._showTg(0);
      }, e.prototype.onToggle = function (t) {
        var e = t.node.name;"toggle1" == e ? this._showTg(0) : "toggle2" == e && this._showTg(1);
      }, e.prototype.onOtherToggle = function (t, e) {
        "rankG0" == e ? this.granks[0].onToggle(t) : "rankG1" == e && this.granks[1].onToggle(t);
      }, e.prototype.onShow = function () {
        h.default.hideBannerAd(), p.default.trackEvent("1101");for (var t = this.granks.length, e = 0; e < t; e++) {
          this.granks[e].onShow();
        }
      }, e.prototype._showTg = function (t) {
        for (var e = this.granks.length, n = 0; n < e; n++) {
          this.granks[n].active = n == t;
        }1 == t && (this.granks[1].onShow(), this.granks[1].ranks[0].onShow());
      }, e.prototype.onClose = function () {
        for (var t = this.granks.length, e = 0; e < t; e++) {
          this.granks[e].onClose();
        }
      }, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), this.btn_close.node.targetOff(this);for (var e = this.granks.length, n = 0; n < e; n++) {
          this.granks[n].destroy();
        }this.granks = null;
      }, e.prototype.onTouchCloseHandler = function () {
        u.default.playEffect(u.default.CLICK), d.default.close(this);
      }, e.prototype.shareCall = function () {}, r([b], e);
    }(c.default);n.default = M, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/Sdks/GameSDK": "GameSDK", "../../Common/Sdks/UmaTrackHelper": "UmaTrackHelper", "../../Common/UI/UIItem": "UIItem", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Manager/CommandController": "CommandController", "./SubContextViewController": "SubContextViewController" }], RePlayAnswerConfirm: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "71e53evCjRIMJMEYi3FYmk5", "RePlayAnswerConfirm");var _o68,
        i = this && this.__extends || (_o68 = function o(t, e) {
      return (_o68 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o68(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Core/GameType"),
        c = t("../../Common/Util/ComponentUtil"),
        l = t("../../Common/Manager/MusicManager"),
        u = t("../../Common/UI/UIManager"),
        f = t("../Net/GameClient"),
        d = cc._decorator,
        h = d.ccclass,
        p = (d.property, function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return s.UILayerType.SubPopLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.btn_close = c.default.getComponent(cc.Button, this.node, "frame/btn_close"), this.btn_close.node.on(cc.Node.EventType.TOUCH_END, this.onTouchCloseHandler, this), this.btn_ok = c.default.getComponent(cc.Button, this.node, "frame/btn_ok"), this.btn_ok.node.on(cc.Node.EventType.TOUCH_END, this.onTouchOKHandler, this);
      }, e.prototype.onShow = function () {
        f.default.ins.addPacketDataListener(529, this.cmd0x0211Handler, this);
      }, e.prototype.onClose = function () {
        f.default.ins.removeAll(this);
      }, e.prototype.onTouchCloseHandler = function () {
        l.default.playEffect(l.default.CLICK), this.answerRePlay(0);
      }, e.prototype.onTouchOKHandler = function () {
        l.default.playEffect(l.default.CLICK), this.answerRePlay(1);
      }, e.prototype.answerRePlay = function (t) {
        f.default.ins.send(529, { rid: this.data.rid, agree: t });
      }, e.prototype.cmd0x0211Handler = function (t) {
        t.isError || (t.body, u.default.close(this));
      }, e.prototype.onDestroy = function () {
        this.btn_close.node.targetOff(this), this.btn_ok.node.targetOff(this), t.prototype.onDestroy.call(this);
      }, r([h], e);
    }(a.default));n.default = p, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Net/GameClient": "GameClient" }], ReceiveGiftTips: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "99915gQso1JpbMDsvuLVZU9", "ReceiveGiftTips");var _o69,
        i = this && this.__extends || (_o69 = function o(t, e) {
      return (_o69 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o69(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 }), n.ReceiveGiftTipsData = n.ReceiveGiftTipType = void 0;var a,
        s = t("../../Common/UI/UIPanel"),
        c = t("../../Common/Util/ComponentUtil"),
        l = t("../../Common/Manager/MusicManager"),
        u = t("../../Common/Core/GameType"),
        f = t("../../Common/UI/UIManager"),
        d = t("../../Common/Sdks/UmaTrackHelper"),
        h = t("../../Common/Manager/LoadResManager"),
        p = cc._decorator,
        _ = p.ccclass;p.property, function (t) {
      t[t.ForSign = 1] = "ForSign", t[t.ForShop = 2] = "ForShop", t[t.ForVideoAD = 3] = "ForVideoAD";
    }(a = n.ReceiveGiftTipType || (n.ReceiveGiftTipType = {}));n.ReceiveGiftTipsData = function () {};var m = function (t) {
      function e() {
        var e = t.call(this) || this;return e._isForceShade = !0, e;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return u.UILayerType.TopLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.btn_close = c.default.getComponent(cc.Button, this.node, "frame/btn_close"), this.btn_close.node.on(cc.Node.EventType.TOUCH_END, this.onTouchCloseHandler, this), this.sp_count_label = c.default.getComponent(cc.Label, this.node, "frame/sp_item/sp_count"), this.sp_icon_sprite = c.default.getComponent(cc.Sprite, this.node, "frame/sp_item/sp_icon"), this.lb_name0 = c.default.getNode(this.node, "frame/lb_name0"), this.lb_name1 = c.default.getNode(this.node, "frame/lb_name1");
      }, e.prototype.onShow = function () {
        d.default.trackEvent("1001"), this.init(this.data);
      }, e.prototype.onClose = function () {}, e.prototype.init = function (t) {
        switch (this.sp_count_label.string = t.name + "X" + t.count, h.default.loadSprite(this.sp_icon_sprite, "Atlas/atlas_item/" + t.icon), t.type) {case a.ForSign:
            this.lb_name0.active = !0, this.lb_name1.active = !1;break;case a.ForShop:
            this.lb_name0.active = !1, this.lb_name1.active = !0;}
      }, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), this.btn_close.node.targetOff(this);
      }, e.prototype.onTouchCloseHandler = function () {
        l.default.playEffect(l.default.CLICK), d.default.trackEvent("1002"), f.default.close(this);
      }, r([_], e);
    }(s.default);n.default = m, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/LoadResManager": "LoadResManager", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/Sdks/UmaTrackHelper": "UmaTrackHelper", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil" }], RlzConfig: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "879105MMSxB9okUZe4zGwBv", "RlzConfig");var _o70,
        i = this && this.__extends || (_o70 = function o(t, e) {
      return (_o70 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o70(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("../../Common/Config/AbsConfig"),
        a = t("./item/RlzData"),
        s = function (t) {
      function e() {
        return t.call(this, a.default) || this;
      }return i(e, t), Object.defineProperty(e, "ins", { get: function get() {
          return null == e._ins && (e._ins = new e()), e._ins;
        }, enumerable: !1, configurable: !0 }), e.prototype.getPerByRlz = function (t) {
        for (var e = this._list.length, n = 0; n < e; n++) {
          var o = this._list[n];if (o.rlz >= t) return o.per;
        }return this._list[0].per;
      }, e._ins = null, e;
    }(r.default);n.default = s, cc._RF.pop();
  }, { "../../Common/Config/AbsConfig": "AbsConfig", "./item/RlzData": "RlzData" }], RlzData: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "61060vGcC9LurnF1SdWmI4A", "RlzData"), Object.defineProperty(n, "__esModule", { value: !0 });var o = function () {
      function t(t) {
        this._id = t.attributes.id, this._rlz = t.attributes.rlz, this._per = t.attributes.per;
      }return Object.defineProperty(t.prototype, "id", { get: function get() {
          return this._id;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "rlz", { get: function get() {
          return this._rlz;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "per", { get: function get() {
          return this._per;
        }, enumerable: !1, configurable: !0 }), t.cfgFile = "rlz", t;
    }();n.default = o, cc._RF.pop();
  }, {}], RoleConfig: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "f6497BkbNVBnJdCdkOgJx7y", "RoleConfig");var _o71,
        i = this && this.__extends || (_o71 = function o(t, e) {
      return (_o71 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o71(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("../../Common/Config/AbsConfig"),
        a = t("../../Common/Manager/Logger"),
        s = t("./item/RoleData"),
        c = function (t) {
      function e() {
        return t.call(this, s.default) || this;
      }return i(e, t), Object.defineProperty(e, "ins", { get: function get() {
          return null == e._ins && (e._ins = new e()), e._ins;
        }, enumerable: !1, configurable: !0 }), e.prototype.get_next_id = function (t) {
        var e = this._list.length;a.default.log("------------get_next_id----0--------- len " + e);for (var n = 0; n < e; n++) {
          if (this._list[n].id == t) return a.default.log("------------get_next_id--i " + n), n < e - 1 ? (a.default.log("------------get_next_id--i+1 " + (n + 1)), this._list[n + 1].id) : (a.default.log("this._list "), a.default.log(this._list), this._list[0].id);
        }return a.default.log("------------get_next_id----0---------"), 0;
      }, e.prototype.get_per_id = function (t) {
        a.default.log("------------get_per_id----curr_id " + t);for (var e = this._list.length, n = 0; n < e; n++) {
          if (this._list[n].id == t) return n > 0 ? this._list[n - 1].id : this._list[e - 1].id;
        }return a.default.log("------------get_per_id----0---------"), 0;
      }, e._ins = null, e.def_id = 1, e;
    }(r.default);n.default = c, cc._RF.pop();
  }, { "../../Common/Config/AbsConfig": "AbsConfig", "../../Common/Manager/Logger": "Logger", "./item/RoleData": "RoleData" }], RoleData: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "85989ZjKlxNsY9eTvrvUB7l", "RoleData"), Object.defineProperty(n, "__esModule", { value: !0 });var o = function () {
      function t(t) {
        this._id = t.attributes.id, this._name = t.attributes.name, this._model = t.attributes.model, this._need_vip = t.attributes.need_vip;
      }return Object.defineProperty(t.prototype, "id", { get: function get() {
          return this._id;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "name", { get: function get() {
          return this._name;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "model", { get: function get() {
          return this._model;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "need_vip", { get: function get() {
          return this._need_vip;
        }, enumerable: !1, configurable: !0 }), t.cfgFile = "role", t;
    }();n.default = o, cc._RF.pop();
  }, {}], SHA1: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "8ffe8bak9lO5otiwmn8OCBk", "SHA1"), Object.defineProperty(n, "__esModule", { value: !0 });var o = function () {
      function t() {
        this.hexcase = 0, this.b64pad = "";
      }return Object.defineProperty(t, "ins", { get: function get() {
          return t._ins || (t._ins = new t()), t._ins;
        }, enumerable: !1, configurable: !0 }), t.prototype.hex_sha1 = function (t) {
        return this.rstr2hex(this.rstr_sha1(this.str2rstr_utf8(t)));
      }, t.prototype.b64_sha1 = function (t) {
        return this.rstr2b64(this.rstr_sha1(this.str2rstr_utf8(t)));
      }, t.prototype.any_sha1 = function (t, e) {
        return this.rstr2any(this.rstr_sha1(this.str2rstr_utf8(t)), e);
      }, t.prototype.hex_hmac_sha1 = function (t, e) {
        return this.rstr2hex(this.rstr_hmac_sha1(this.str2rstr_utf8(t), this.str2rstr_utf8(e)));
      }, t.prototype.b64_hmac_sha1 = function (t, e) {
        return this.rstr2b64(this.rstr_hmac_sha1(this.str2rstr_utf8(t), this.str2rstr_utf8(e)));
      }, t.prototype.any_hmac_sha1 = function (t, e, n) {
        return this.rstr2any(this.rstr_hmac_sha1(this.str2rstr_utf8(t), this.str2rstr_utf8(e)), n);
      }, t.prototype.sha1_vm_test = function () {
        return "a9993e364706816aba3e25717850c26c9cd0d89d" == this.hex_sha1("abc").toLowerCase();
      }, t.prototype.rstr_sha1 = function (t) {
        return this.binb2rstr(this.binb_sha1(this.rstr2binb(t), 8 * t.length));
      }, t.prototype.rstr_hmac_sha1 = function (t, e) {
        var n = this.rstr2binb(t);n.length > 16 && (n = this.binb_sha1(n, 8 * t.length));for (var o = Array(16), i = Array(16), r = 0; r < 16; r++) {
          o[r] = 909522486 ^ n[r], i[r] = 1549556828 ^ n[r];
        }var a = this.binb_sha1(o.concat(this.rstr2binb(e)), 512 + 8 * e.length);return this.binb2rstr(this.binb_sha1(i.concat(a), 672));
      }, t.prototype.rstr2hex = function (t) {
        try {
          this.hexcase;
        } catch (r) {
          this.hexcase = 0;
        }for (var e, n = this.hexcase ? "0123456789ABCDEF" : "0123456789abcdef", o = "", i = 0; i < t.length; i++) {
          e = t.charCodeAt(i), o += n.charAt(e >>> 4 & 15) + n.charAt(15 & e);
        }return o;
      }, t.prototype.rstr2b64 = function (t) {
        try {
          this.b64pad;
        } catch (a) {
          this.b64pad = "";
        }for (var e = "", n = t.length, o = 0; o < n; o += 3) {
          for (var i = t.charCodeAt(o) << 16 | (o + 1 < n ? t.charCodeAt(o + 1) << 8 : 0) | (o + 2 < n ? t.charCodeAt(o + 2) : 0), r = 0; r < 4; r++) {
            8 * o + 6 * r > 8 * t.length ? e += this.b64pad : e += "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(i >>> 6 * (3 - r) & 63);
          }
        }return e;
      }, t.prototype.rstr2any = function (t, e) {
        var n,
            o,
            i,
            r,
            a = e.length,
            s = Array(),
            c = Array(Math.ceil(t.length / 2));for (n = 0; n < c.length; n++) {
          c[n] = t.charCodeAt(2 * n) << 8 | t.charCodeAt(2 * n + 1);
        }for (; c.length > 0;) {
          for (r = Array(), i = 0, n = 0; n < c.length; n++) {
            i = (i << 16) + c[n], i -= (o = Math.floor(i / a)) * a, (r.length > 0 || o > 0) && (r[r.length] = o);
          }s[s.length] = i, c = r;
        }var l = "";for (n = s.length - 1; n >= 0; n--) {
          l += e.charAt(s[n]);
        }var u = Math.ceil(8 * t.length / (Math.log(e.length) / Math.log(2)));for (n = l.length; n < u; n++) {
          l = e[0] + l;
        }return l;
      }, t.prototype.str2rstr_utf8 = function (t) {
        for (var e, n, o = "", i = -1; ++i < t.length;) {
          e = t.charCodeAt(i), n = i + 1 < t.length ? t.charCodeAt(i + 1) : 0, 55296 <= e && e <= 56319 && 56320 <= n && n <= 57343 && (e = 65536 + ((1023 & e) << 10) + (1023 & n), i++), e <= 127 ? o += String.fromCharCode(e) : e <= 2047 ? o += String.fromCharCode(192 | e >>> 6 & 31, 128 | 63 & e) : e <= 65535 ? o += String.fromCharCode(224 | e >>> 12 & 15, 128 | e >>> 6 & 63, 128 | 63 & e) : e <= 2097151 && (o += String.fromCharCode(240 | e >>> 18 & 7, 128 | e >>> 12 & 63, 128 | e >>> 6 & 63, 128 | 63 & e));
        }return o;
      }, t.prototype.str2rstr_utf16le = function (t) {
        for (var e = "", n = 0; n < t.length; n++) {
          e += String.fromCharCode(255 & t.charCodeAt(n), t.charCodeAt(n) >>> 8 & 255);
        }return e;
      }, t.prototype.str2rstr_utf16be = function (t) {
        for (var e = "", n = 0; n < t.length; n++) {
          e += String.fromCharCode(t.charCodeAt(n) >>> 8 & 255, 255 & t.charCodeAt(n));
        }return e;
      }, t.prototype.rstr2binb = function (t) {
        for (var e = Array(t.length >> 2), n = 0; n < e.length; n++) {
          e[n] = 0;
        }for (n = 0; n < 8 * t.length; n += 8) {
          e[n >> 5] |= (255 & t.charCodeAt(n / 8)) << 24 - n % 32;
        }return e;
      }, t.prototype.binb2rstr = function (t) {
        for (var e = "", n = 0; n < 32 * t.length; n += 8) {
          e += String.fromCharCode(t[n >> 5] >>> 24 - n % 32 & 255);
        }return e;
      }, t.prototype.binb_sha1 = function (t, e) {
        t[e >> 5] |= 128 << 24 - e % 32, t[15 + (e + 64 >> 9 << 4)] = e;for (var n = Array(80), o = 1732584193, i = -271733879, r = -1732584194, a = 271733878, s = -1009589776, c = 0; c < t.length; c += 16) {
          for (var l = o, u = i, f = r, d = a, h = s, p = 0; p < 80; p++) {
            n[p] = p < 16 ? t[c + p] : this.bit_rol(n[p - 3] ^ n[p - 8] ^ n[p - 14] ^ n[p - 16], 1);var _ = this.safe_add(this.safe_add(this.bit_rol(o, 5), this.sha1_ft(p, i, r, a)), this.safe_add(this.safe_add(s, n[p]), this.sha1_kt(p)));s = a, a = r, r = this.bit_rol(i, 30), i = o, o = _;
          }o = this.safe_add(o, l), i = this.safe_add(i, u), r = this.safe_add(r, f), a = this.safe_add(a, d), s = this.safe_add(s, h);
        }return [o, i, r, a, s];
      }, t.prototype.sha1_ft = function (t, e, n, o) {
        return t < 20 ? e & n | ~e & o : t < 40 ? e ^ n ^ o : t < 60 ? e & n | e & o | n & o : e ^ n ^ o;
      }, t.prototype.sha1_kt = function (t) {
        return t < 20 ? 1518500249 : t < 40 ? 1859775393 : t < 60 ? -1894007588 : -899497514;
      }, t.prototype.safe_add = function (t, e) {
        var n = (65535 & t) + (65535 & e);return (t >> 16) + (e >> 16) + (n >> 16) << 16 | 65535 & n;
      }, t.prototype.bit_rol = function (t, e) {
        return t << e | t >>> 32 - e;
      }, t;
    }();n.default = o, cc._RF.pop();
  }, {}], SHA256: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "de69c39dExKOpmrKp5bOYzs", "SHA256"), Object.defineProperty(n, "__esModule", { value: !0 });var o = function () {
      function t() {
        this.hexcase = 0, this.b64pad = "", this.sha256_K = new Array(1116352408, 1899447441, -1245643825, -373957723, 961987163, 1508970993, -1841331548, -1424204075, -670586216, 310598401, 607225278, 1426881987, 1925078388, -2132889090, -1680079193, -1046744716, -459576895, -272742522, 264347078, 604807628, 770255983, 1249150122, 1555081692, 1996064986, -1740746414, -1473132947, -1341970488, -1084653625, -958395405, -710438585, 113926993, 338241895, 666307205, 773529912, 1294757372, 1396182291, 1695183700, 1986661051, -2117940946, -1838011259, -1564481375, -1474664885, -1035236496, -949202525, -778901479, -694614492, -200395387, 275423344, 430227734, 506948616, 659060556, 883997877, 958139571, 1322822218, 1537002063, 1747873779, 1955562222, 2024104815, -2067236844, -1933114872, -1866530822, -1538233109, -1090935817, -965641998);
      }return t.hex_sha256 = function (e) {
        return new t().hex_sha256(e);
      }, t.prototype.hex_sha256 = function (t) {
        return this.rstr2hex(this.rstr_sha256(this.str2rstr_utf8(t)));
      }, t.prototype.b64_sha256 = function (t) {
        return this.rstr2b64(this.rstr_sha256(this.str2rstr_utf8(t)));
      }, t.prototype.any_sha256 = function (t, e) {
        return this.rstr2any(this.rstr_sha256(this.str2rstr_utf8(t)), e);
      }, t.prototype.hex_hmac_sha256 = function (t, e) {
        return this.rstr2hex(this.rstr_hmac_sha256(this.str2rstr_utf8(t), this.str2rstr_utf8(e)));
      }, t.prototype.b64_hmac_sha256 = function (t, e) {
        return this.rstr2b64(this.rstr_hmac_sha256(this.str2rstr_utf8(t), this.str2rstr_utf8(e)));
      }, t.prototype.any_hmac_sha256 = function (t, e, n) {
        return this.rstr2any(this.rstr_hmac_sha256(this.str2rstr_utf8(t), this.str2rstr_utf8(e)), n);
      }, t.prototype.sha256_vm_test = function () {
        return "ba7816bf8f01cfea414140de5dae2223b00361a396177a9cb410ff61f20015ad" == this.hex_sha256("abc").toLowerCase();
      }, t.prototype.rstr_sha256 = function (t) {
        return this.binb2rstr(this.binb_sha256(this.rstr2binb(t), 8 * t.length));
      }, t.prototype.rstr_hmac_sha256 = function (t, e) {
        var n = this.rstr2binb(t);n.length > 16 && (n = this.binb_sha256(n, 8 * t.length));for (var o = Array(16), i = Array(16), r = 0; r < 16; r++) {
          o[r] = 909522486 ^ n[r], i[r] = 1549556828 ^ n[r];
        }var a = this.binb_sha256(o.concat(this.rstr2binb(e)), 512 + 8 * e.length);return this.binb2rstr(this.binb_sha256(i.concat(a), 768));
      }, t.prototype.rstr2hex = function (t) {
        try {
          this.hexcase;
        } catch (r) {
          this.hexcase = 0;
        }for (var e, n = this.hexcase ? "0123456789ABCDEF" : "0123456789abcdef", o = "", i = 0; i < t.length; i++) {
          e = t.charCodeAt(i), o += n.charAt(e >>> 4 & 15) + n.charAt(15 & e);
        }return o;
      }, t.prototype.rstr2b64 = function (t) {
        try {
          this.b64pad;
        } catch (a) {
          this.b64pad = "";
        }for (var e = "", n = t.length, o = 0; o < n; o += 3) {
          for (var i = t.charCodeAt(o) << 16 | (o + 1 < n ? t.charCodeAt(o + 1) << 8 : 0) | (o + 2 < n ? t.charCodeAt(o + 2) : 0), r = 0; r < 4; r++) {
            8 * o + 6 * r > 8 * t.length ? e += this.b64pad : e += "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(i >>> 6 * (3 - r) & 63);
          }
        }return e;
      }, t.prototype.rstr2any = function (t, e) {
        var n,
            o,
            i,
            r,
            a = e.length,
            s = Array(),
            c = Array(Math.ceil(t.length / 2));for (n = 0; n < c.length; n++) {
          c[n] = t.charCodeAt(2 * n) << 8 | t.charCodeAt(2 * n + 1);
        }for (; c.length > 0;) {
          for (r = Array(), i = 0, n = 0; n < c.length; n++) {
            i = (i << 16) + c[n], i -= (o = Math.floor(i / a)) * a, (r.length > 0 || o > 0) && (r[r.length] = o);
          }s[s.length] = i, c = r;
        }var l = "";for (n = s.length - 1; n >= 0; n--) {
          l += e.charAt(s[n]);
        }var u = Math.ceil(8 * t.length / (Math.log(e.length) / Math.log(2)));for (n = l.length; n < u; n++) {
          l = e[0] + l;
        }return l;
      }, t.prototype.str2rstr_utf8 = function (t) {
        for (var e, n, o = "", i = -1; ++i < t.length;) {
          e = t.charCodeAt(i), n = i + 1 < t.length ? t.charCodeAt(i + 1) : 0, 55296 <= e && e <= 56319 && 56320 <= n && n <= 57343 && (e = 65536 + ((1023 & e) << 10) + (1023 & n), i++), e <= 127 ? o += String.fromCharCode(e) : e <= 2047 ? o += String.fromCharCode(192 | e >>> 6 & 31, 128 | 63 & e) : e <= 65535 ? o += String.fromCharCode(224 | e >>> 12 & 15, 128 | e >>> 6 & 63, 128 | 63 & e) : e <= 2097151 && (o += String.fromCharCode(240 | e >>> 18 & 7, 128 | e >>> 12 & 63, 128 | e >>> 6 & 63, 128 | 63 & e));
        }return o;
      }, t.prototype.str2rstr_utf16le = function (t) {
        for (var e = "", n = 0; n < t.length; n++) {
          e += String.fromCharCode(255 & t.charCodeAt(n), t.charCodeAt(n) >>> 8 & 255);
        }return e;
      }, t.prototype.str2rstr_utf16be = function (t) {
        for (var e = "", n = 0; n < t.length; n++) {
          e += String.fromCharCode(t.charCodeAt(n) >>> 8 & 255, 255 & t.charCodeAt(n));
        }return e;
      }, t.prototype.rstr2binb = function (t) {
        for (var e = Array(t.length >> 2), n = 0; n < e.length; n++) {
          e[n] = 0;
        }for (n = 0; n < 8 * t.length; n += 8) {
          e[n >> 5] |= (255 & t.charCodeAt(n / 8)) << 24 - n % 32;
        }return e;
      }, t.prototype.binb2rstr = function (t) {
        for (var e = "", n = 0; n < 32 * t.length; n += 8) {
          e += String.fromCharCode(t[n >> 5] >>> 24 - n % 32 & 255);
        }return e;
      }, t.prototype.sha256_S = function (t, e) {
        return t >>> e | t << 32 - e;
      }, t.prototype.sha256_R = function (t, e) {
        return t >>> e;
      }, t.prototype.sha256_Ch = function (t, e, n) {
        return t & e ^ ~t & n;
      }, t.prototype.sha256_Maj = function (t, e, n) {
        return t & e ^ t & n ^ e & n;
      }, t.prototype.sha256_Sigma0256 = function (t) {
        return this.sha256_S(t, 2) ^ this.sha256_S(t, 13) ^ this.sha256_S(t, 22);
      }, t.prototype.sha256_Sigma1256 = function (t) {
        return this.sha256_S(t, 6) ^ this.sha256_S(t, 11) ^ this.sha256_S(t, 25);
      }, t.prototype.sha256_Gamma0256 = function (t) {
        return this.sha256_S(t, 7) ^ this.sha256_S(t, 18) ^ this.sha256_R(t, 3);
      }, t.prototype.sha256_Gamma1256 = function (t) {
        return this.sha256_S(t, 17) ^ this.sha256_S(t, 19) ^ this.sha256_R(t, 10);
      }, t.prototype.sha256_Sigma0512 = function (t) {
        return this.sha256_S(t, 28) ^ this.sha256_S(t, 34) ^ this.sha256_S(t, 39);
      }, t.prototype.sha256_Sigma1512 = function (t) {
        return this.sha256_S(t, 14) ^ this.sha256_S(t, 18) ^ this.sha256_S(t, 41);
      }, t.prototype.sha256_Gamma0512 = function (t) {
        return this.sha256_S(t, 1) ^ this.sha256_S(t, 8) ^ this.sha256_R(t, 7);
      }, t.prototype.sha256_Gamma1512 = function (t) {
        return this.sha256_S(t, 19) ^ this.sha256_S(t, 61) ^ this.sha256_R(t, 6);
      }, t.prototype.binb_sha256 = function (t, e) {
        var n,
            o,
            i,
            r,
            a,
            s,
            c,
            l,
            u,
            f,
            d,
            h,
            p = new Array(1779033703, -1150833019, 1013904242, -1521486534, 1359893119, -1694144372, 528734635, 1541459225),
            _ = new Array(64);for (t[e >> 5] |= 128 << 24 - e % 32, t[15 + (e + 64 >> 9 << 4)] = e, u = 0; u < t.length; u += 16) {
          for (n = p[0], o = p[1], i = p[2], r = p[3], a = p[4], s = p[5], c = p[6], l = p[7], f = 0; f < 64; f++) {
            _[f] = f < 16 ? t[f + u] : this.safe_add(this.safe_add(this.safe_add(this.sha256_Gamma1256(_[f - 2]), _[f - 7]), this.sha256_Gamma0256(_[f - 15])), _[f - 16]), d = this.safe_add(this.safe_add(this.safe_add(this.safe_add(l, this.sha256_Sigma1256(a)), this.sha256_Ch(a, s, c)), this.sha256_K[f]), _[f]), h = this.safe_add(this.sha256_Sigma0256(n), this.sha256_Maj(n, o, i)), l = c, c = s, s = a, a = this.safe_add(r, d), r = i, i = o, o = n, n = this.safe_add(d, h);
          }p[0] = this.safe_add(n, p[0]), p[1] = this.safe_add(o, p[1]), p[2] = this.safe_add(i, p[2]), p[3] = this.safe_add(r, p[3]), p[4] = this.safe_add(a, p[4]), p[5] = this.safe_add(s, p[5]), p[6] = this.safe_add(c, p[6]), p[7] = this.safe_add(l, p[7]);
        }return p;
      }, t.prototype.safe_add = function (t, e) {
        var n = (65535 & t) + (65535 & e);return (t >> 16) + (e >> 16) + (n >> 16) << 16 | 65535 & n;
      }, t;
    }();n.default = o, cc._RF.pop();
  }, {}], SdkDefault: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "5d745jaKulELIbzfkkmeal3", "SdkDefault");var _o72,
        i = this && this.__extends || (_o72 = function o(t, e) {
      return (_o72 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o72(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("../Manager/GlobalEventManager"),
        a = t("../Core/GameType"),
        s = t("./AbstractSDK"),
        c = t("../Manager/SysConfig"),
        l = t("../Manager/TimeManager"),
        u = t("../Util/MathUtil"),
        f = t("../Util/NetUtil"),
        d = t("../Util/MD5"),
        h = t("../../Game/Tips/GeneralTips"),
        p = t("../UI/UIManager"),
        _ = t("../../Game/Main/ActivePanel"),
        m = t("../Manager/Logger"),
        g = t("../../Game/Fb/FbPkInvitePanel"),
        y = t("../../Game/Main/SignPanel"),
        b = function (t) {
      function e() {
        return t.call(this, a.SdkType.DEFAULT) || this;
      }return i(e, t), e.prototype.initSDK = function () {
        t.prototype.initSDK.call(this), this._ios = !1, r.default.dispatchEvent(a.InitStepEvent.INIT_SDK_FINISH);
      }, e.prototype.onShow = function () {
        (null != this._roomId || this._invoke) && (p.default.close(y.default), p.default.show(g.default)), r.default.dispatchEvent(a.GameEvent.Show);
      }, e.prototype.onHide = function () {
        r.default.dispatchEvent(a.GameEvent.Hide);
      }, e.prototype.login = function () {
        this.getAndCheckUid(), m.default.log("uid:", this.uid);var t = this,
            e = { gid: c.default.ID, sdk: this.sdkId, uid: this.uid, ios: this._ios };e.sign = d.default.hex_md5(e.gid + e.sdk + e.uid + c.default.CLIENT_KEY), f.default.encodePost(this.getLoginUrl(), e, function (e) {
          m.default.log("login:" + JSON.stringify(e)), e.uid ? (t._uid = e.uid, e.d ? l.default.upServerTime(e.d) : l.default.upServerTime(l.default.localTime), e.data && (t._remoteData = e.data, m.default.log(t._remoteData, "self._remoteData")), r.default.dispatchEvent(a.InitStepEvent.LOGIN_FINISH)) : h.default.show("\u767B\u5F55\u5931\u8D25");
        }, this);
      }, e.prototype.getAndCheckUid = function () {
        if (null == this._uid || "" == this._uid) {
          var t = cc.sys.localStorage.getItem(c.default.ID + c.default.NAME + "_UID");null == t && (t = l.default.serverTime.toString() + u.default.randomInt(1e3, 9999).toString(), cc.sys.localStorage.setItem(c.default.ID + c.default.NAME + "_UID", t)), this._uid = t;
        }
      }, e.prototype.logout = function (e) {
        t.prototype.logout.call(this, e);var n = { gid: c.default.ID, sdk: this.sdkId, uid: this.uid };n.sign = d.default.hex_md5(n.gid + n.sdk + n.uid + c.default.CLIENT_KEY), f.default.encodePost(this.getLogoutUrl(), n, function (t) {
          m.default.log("logout:" + JSON.stringify(t));
        }, this);
      }, e.prototype.shareRecVideo = function (t, e) {
        void 0 === t && (t = null), void 0 === e && (e = null), t && e && (m.default.log("----------shareRecVideo--------------"), t.call(e, !0), this.clearRecVideo());
      }, e.prototype.navigateToMiniGame = function (t) {
        m.default.log("navigateToMiniGame", t);
      }, e.prototype.openUrl = function (t, e) {
        void 0 === e && (e = 0), p.default.show(_.default, { t: e, url: t });
      }, e.prototype.shareInvite = function () {
        var t = u.default.randomInt(1e3, 9999).toString(),
            e = window.location.origin + "?roomId=" + t;console.log("assist url:", e);var n = c.default.CENTER_HOST + "/api/roomTest";f.default.POST(n, { activity_id: t, uid: this.uid }, function (t) {
          m.default.log(t);
        }, this), this._invoke = !0;
      }, e;
    }(s.default);n.default = b, cc._RF.pop();
  }, { "../../Game/Fb/FbPkInvitePanel": "FbPkInvitePanel", "../../Game/Main/ActivePanel": "ActivePanel", "../../Game/Main/SignPanel": "SignPanel", "../../Game/Tips/GeneralTips": "GeneralTips", "../Core/GameType": "GameType", "../Manager/GlobalEventManager": "GlobalEventManager", "../Manager/Logger": "Logger", "../Manager/SysConfig": "SysConfig", "../Manager/TimeManager": "TimeManager", "../UI/UIManager": "UIManager", "../Util/MD5": "MD5", "../Util/MathUtil": "MathUtil", "../Util/NetUtil": "NetUtil", "./AbstractSDK": "AbstractSDK" }], SdkQQ: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "9bb92rKh6xCFakuGxG08ksX", "SdkQQ");var _o73,
        i = this && this.__extends || (_o73 = function o(t, e) {
      return (_o73 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o73(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("./AbstractSDK"),
        a = t("../Manager/GlobalEventManager"),
        s = t("../Manager/SysConfig"),
        c = t("../Util/MD5"),
        l = t("../Util/NetUtil"),
        u = t("../Util/Base64"),
        f = t("../Core/GameType"),
        d = t("../Manager/TimeManager"),
        h = t("../UI/UIManager"),
        p = t("../../Game/Fb/FbEndPanel"),
        _ = t("../Manager/DataManager"),
        m = t("../../Game/Info/FbInfo"),
        g = t("../../Game/Manager/CommandController"),
        y = t("../Manager/Logger"),
        b = t("../../Game/Fb/FbPkInvitePanel"),
        C = t("../../Game/Fb/FbPkMatchPanel"),
        v = t("./UmaTrackHelper"),
        I = function (t) {
      function e() {
        var e = t.call(this, f.SdkType.QQ) || this;return e.AppID = "1110797565", e.AppSecret = "G3N6eUshKF27h89w", e.adUnitIds = { 1: "af9d664a37aa5006176d86f4ecca7e12", 2: "ff41912165c10195771ac07342bb3b10 ", 3: "d56a76238c4a53815fe81707b35731e6", 4: "aa60166e657c6470c2c1c1e63b22ab8b", 5: "5fd6be911dd88c7d54f99ed9a9bd1c69" }, e.bannerId = "352f49edff390ec6d1de7640790274dc", e.insertAdId = "3dbc9355f0f30a2ac50074bca1f79751", e._shareTime = 0, e._jump = !1, e._openUrlRevive = !1, e;
      }return i(e, t), e.prototype.initSDK = function () {
        if ("undefined" != typeof qq) {
          "ios" == qq.getSystemInfoSync().platform && (this._ios = !0), this.checkRoomId(), qq.showShareMenu({ withShareTicket: !0 });var t = this.getShareTitleAndImgUrl(),
              e = t[0],
              n = t[1];qq.uma.onShareAppMessage(function () {
            return { title: e, imageUrl: n };
          });var o = this;qq.onShow(function (t) {
            if (cc.game.pause(), cc.game.resume(), _.default.initFinish) {
              y.default.log("-----------onShow--------------", o._invoke, t), o.shareCheckCall(), o.navigateToCheckCall(), o.openUrlCheckCall(), o.isIos() || !t.scene || 2072 != t.scene && 4016 != t.scene && 4023 != t.scene && 3030 != t.scene && 2001 != t.scene && 1037 != t.scene || (o._roomId = "match");var e = t.query;e && e.roomId && (o._roomId = e.roomId, y.default.log("-----------onShow--roomId------------", o._roomId)), y.default.log("-----------last--roomId------------", o._roomId), o._invoke ? ("match" != o._roomId ? (y.default.log("-----------onshow FbPkInvitePanel------------", o._roomId), h.default.show(b.default)) : (y.default.log("-----------onshow FbPkMatchPanel------------", o._roomId), h.default.show(C.default)), v.default.trackEvent("1324")) : null != o._roomId && ("match" != o._roomId ? (y.default.log("-----------onshow FbPkInvitePanel------------", o._roomId), h.default.show(b.default)) : (y.default.log("-----------onshow FbPkMatchPanel------------", o._roomId), h.default.show(C.default)), v.default.trackEvent("1324"));
            }a.default.dispatchEvent(f.GameEvent.Show);
          }), qq.onHide(function () {
            a.default.dispatchEvent(f.GameEvent.Hide);
          }), a.default.dispatchEvent(f.InitStepEvent.INIT_SDK_FINISH), this._bannerOpen = !0, this._adOpen = !0;
        }
      }, e.prototype.checkRoomId = function () {
        var t = qq.getLaunchOptionsSync();y.default.log("getLaunchOptionsSync:", t), t && (4016 != t.scene && 2072 != t.scene || (this._roomId = "match"), t.query && t.query.roomId && (this._roomId = t.query.roomId)), y.default.log("getLaunchOptionsSync roomId:", this._roomId);
      }, e.prototype.login = function () {
        if ("undefined" != typeof qq) {
          var t = this;y.default.log("\u5F00\u59CB\u767B\u5F55"), qq.login({ success: function success(e) {
              if (y.default.log("login:" + e.code), e.code) {
                var n = { gid: s.default.ID, sdk: t.sdkId, uid: e.code, ios: t._ios };n.sign = c.default.hex_md5(n.gid + n.sdk + n.uid + s.default.CLIENT_KEY), l.default.encodePost(t.getLoginUrl(), n, function (e) {
                  y.default.log("login:" + JSON.stringify(e)), e.uid ? (t._uid = e.uid, e.d ? d.default.upServerTime(e.d) : d.default.upServerTime(d.default.localTime), e.data && (t._remoteData = e.data), qq.getSetting({ success: function success(e) {
                      y.default.log("--------1-----------", e), e.authSetting["scope.userInfo"] ? (qq.getUserInfo({ success: function success(e) {
                          y.default.log("--------2-----------", e), t.buildUserInfo(e.userInfo);
                        } }), y.default.log("--------3-----------", e)) : (y.default.log("--------4-----------", e), t.createUserInfoButton()), y.default.log("--------5-----------", e);
                    }, fail: function fail(t) {
                      y.default.log("fail:", t);
                    } })) : t.showToast("\u767B\u5F55\u5931\u8D25");
                }, this);
              } else t.showToast("\u767B\u5F55\u5931\u8D25");
            }, fail: function fail(e) {
              console.log(e), t.showToast("\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u662F\u5426\u7545\u901A\u3002");
            } });
        }
      }, e.prototype.logout = function (e) {
        t.prototype.logout.call(this, e);var n = { gid: s.default.ID, sdk: this.sdkId, uid: this.uid };n.sign = c.default.hex_md5(n.gid + n.sdk + n.uid + s.default.CLIENT_KEY), l.default.encodePost(this.getLogoutUrl(), n, function (t) {
          y.default.log("logout:" + JSON.stringify(t));
        }, this);
      }, e.prototype.createUserInfoButton1 = function () {
        var t = this,
            e = cc.view.getFrameSize(),
            n = (e.width - 200) / 2,
            o = 3 * e.height / 5,
            i = qq.createUserInfoButton({ type: "text", text: "\u6388\u6743\u767B\u5F55", style: { left: n, top: o, width: 200, height: 60, lineHeight: 40, backgroundColor: "#056DFF", color: "#000000", textAlign: "center", fontSize: 24, borderRadius: 4 } });i.onTap(function (e) {
          t.buildUserInfo(e.userInfo), i.hide(), i.destroy();
        });
      }, e.prototype.createUserInfoButton = function () {
        var t = cc.view.getFrameSize(),
            e = .81;t.height / t.width > 2 && (e = .75);var n = this,
            o = .74 * t.width,
            i = 153 * o / 529,
            r = (t.width - o) / 2,
            s = t.height * e - i / 2,
            c = cc.url.raw("resources/Texture/auth.png");y.default.log("url:", c), y.default.log(o, i, r, s);var l = qq.createUserInfoButton({ type: "image", image: c, style: { left: r, top: s, width: o, height: i } });l.onTap(function (t) {
          null != t.userInfo ? n.buildUserInfo(t.userInfo) : (y.default.log("--------6-----------", t), a.default.dispatchEvent(f.InitStepEvent.LOGIN_FINISH)), l.hide(), l.destroy();
        });
      }, e.prototype.buildUserInfo = function (t) {
        if (y.default.log("userInfo:", t), t) {
          this._icon = t.avatarUrl, this._nickname = t.nickName;var e = this,
              n = "",
              o = "";qq.getUserInfoExtra({ success: function success(t) {
              y.default.log("getUserInfoExtra success", t), t && t.encryptedData && (n = t.encryptedData, o = t.iv);
            }, fail: function fail(t) {
              y.default.log("getUserInfoExtra fail", t);
            }, complete: function complete() {
              y.default.log("getUserInfoExtra complete", e._vip), g.default.nickname(e._nickname, e._icon, n, o, function (t) {
                t && t.vip && (e._vip = t.vip, y.default.log("-----vip----", e._vip));
              }, this);
            } });
        }a.default.dispatchEvent(f.InitStepEvent.LOGIN_FINISH);
      }, e.prototype.readUserData = function () {
        try {
          var t = this.userKey(),
              e = qq.getStorageSync(t);return JSON.parse(u.default.decode(e));
        } catch (n) {
          return console.log("\u8BFB\u53D6\u6570\u636E\u5931\u8D25" + n), {};
        }
      }, e.prototype.saveUserData = function (t) {
        var e = this.userKey(),
            n = u.default.encode(JSON.stringify(t));return qq.setStorage({ key: e, data: n }), n;
      }, e.prototype.saveOpenData = function () {
        var t = { KVDataList: [{ key: "key1", value: m.default.ins.score.toString() }, { key: "key2", value: m.default.ins.pkPoint.toString() }], success: function success() {}, fail: function fail() {}, complete: function complete() {} };qq.setUserCloudStorage(t);
      }, e.prototype.postMessage = function (t) {
        "undefined" != typeof qq && (null == this._openDataContext && (this._openDataContext = qq.getOpenDataContext()), this._openDataContext && this._openDataContext.postMessage({ type: t, openid: this.uid, score: m.default.ins.score }));
      }, e.prototype.getRankData = function (t, e) {
        void 0 === t && (t = null), void 0 === e && (e = null), this.postMessage("LoadRank");
      }, e.prototype.share = function (t, e, n, o) {
        if (void 0 === t && (t = null), void 0 === e && (e = null), void 0 === n && (n = null), void 0 === o && (o = null), "undefined" != typeof qq && !(this._shareTime > 0)) {
          this._shareTime = Date.now();var i = this.getShareTitleAndImgUrl(),
              r = i[0],
              a = i[1];null != n && (r = n), null != o && (a = o), qq.uma.shareAppMessage({ title: r, query: "", imageUrl: a, success: function success() {
              y.default.log("qq\u5206\u4EAB\u6210\u529F");
            }, fail: function fail() {
              console.log("\u5206\u4EAB\u5931\u8D25");
            } }), t && e ? (this._shareCallBack = t, this._shareTarget = e) : this._shareTime = 0;
        }
      }, e.prototype.shareCheckCall = function () {
        this._shareTime > 0 && (Date.now() - (this._shareTime + 2e3) >= 0 ? this._shareCallBack.call(this._shareTarget) : this.showToast("\u5206\u4EAB\u5931\u8D25\uFF0C\u53EF\u4EE5\u5206\u4EAB\u5230\u522B\u7684\u7FA4\u8BD5\u8BD5\u3002"), this._shareTime = 0);
      }, e.prototype.checkVideoInit = function (t) {
        var e = this,
            n = this;!this._adOpen || null != this._videoAd && t == this._curAdId || (console.log("vadid => ", t), this._videoAd = qq.createRewardedVideoAd({ adUnitId: t }), this._videoAd.onClose(function (t) {
          t && t.isEnded && n._callback && n._target && n._callback.call(n._target, !0);
        }), this._videoAd.onError(function (t) {
          console.log("videoAd onError:" + JSON.stringify(t)), e.showToast("\u6FC0\u52B1\u89C6\u9891\u83B7\u53D6\u5931\u8D25\uFF0C\u8BF7\u7A0D\u540E\u518D\u6765");
        }), this._curAdId = t);
      }, e.prototype.showVideoAd = function (t, e, n) {
        if (void 0 === t && (t = null), void 0 === e && (e = null), "undefined" != typeof qq) if (this.checkVideoInit(this.adUnitIds[n]), this._adOpen) {
          this._callback = t, this._target = e;var o = this;this._videoAd.load().then(function () {
            y.default.log("\u6FC0\u52B1\u89C6\u9891\u52A0\u8F7D\u6210\u529F"), o._videoAd.show().then(function () {}).catch(function () {
              console.log("\u6FC0\u52B1\u89C6\u9891 \u5E7F\u544A\u663E\u793A\u5931\u8D25");
            });
          }).catch(function (t) {
            console.log("\u6FC0\u52B1\u89C6\u9891\u52A0\u8F7D\u5931\u8D25:" + t);
          });
        } else this.showToast("\u529F\u80FD\u6682\u4E0D\u5F00\u653E");
      }, e.prototype.hideVideoAd = function () {}, e.prototype.showBannerAd = function () {
        if ("undefined" != typeof qq) {
          null != this._bannerAd && (this._bannerAd.destroy(), this._bannerAd = null);var t = this,
              e = qq.getSystemInfoSync(),
              n = e.screenWidth,
              o = 9 * n / 16;this._bannerAd = qq.createBannerAd({ adUnitId: t.bannerId, testDemoType: 65, style: { top: e.screenHeight - o / 2 + 10, left: (e.screenWidth - n) / 2, width: n } }), this._bannerAd.onError(function (t) {
            console.log("bannerAd onError", t);
          }), this._bannerAd.onLoad(function () {
            a.default.dispatchEvent(f.SdkEvent.BANNER_ONLOAD);
          }), this._bannerAd.onResize(function (i) {
            var r = i.height;n != i.width && (n = i.width, o = r, t._bannerAd.style.top = e.screenHeight - r / 2 + 10, t._bannerAd.style.left = (e.screenWidth - i.width) / 2);
          }), this._bannerAd.show();
        }
      }, e.prototype.hideBannerAd = function () {
        "undefined" != typeof qq && this._bannerAd && this._bannerAd.hide();
      }, e.prototype.hasInsertAd = function () {
        return !0;
      }, e.prototype.showInsertAd = function () {
        this.hasInsertAd() && this.showNormalInsertAd();
      }, e.prototype.showNormalInsertAd = function () {
        qq.createInterstitialAd && (null == this._insertAd && (this._insertAd = qq.createInterstitialAd({ adUnitId: this.insertAdId }), this._insertAd.load().catch(function (t) {
          console.error("load", t);
        }), this._insertAd.onLoad(function () {}), this._insertAd.onClose(function () {}), this._insertAd.onError(function (t) {
          console.log("error", t);
        })), this._insertAd.show().catch(function (t) {
          console.error("show", t);
        }));
      }, e.prototype.vibrateShort = function () {
        "undefined" != typeof qq && qq.vibrateShort({});
      }, e.prototype.vibrateLong = function () {
        "undefined" != typeof qq && qq.vibrateLong({});
      }, e.prototype.navigateToMiniGame = function (t) {
        var e = this;qq.navigateToMiniProgram({ appId: t.appId, path: "?id=dash", extraData: { foo: "dash" }, envVersion: "release", success: function success() {
            e._jump = !0;
          }, fail: function fail(t) {
            console.log(t);
          }, complete: function complete(t) {
            y.default.log("------complete-----", t);
          } });
      }, e.prototype.navigateToCheckCall = function () {
        this._jump && h.default.callClazzFunc(p.default, "reviveCall"), this._jump = !1;
      }, e.prototype.openUrl = function (t, e) {
        void 0 === e && (e = 0);var n = this;qq.openUrl({ url: t, success: function success(t) {
            y.default.log("-----success---", t), n._openUrlRevive = 1 == e;
          }, fail: function fail(t) {
            n._openUrlRevive = !1, console.log("----fail----", t);
          } });
      }, e.prototype.openUrlCheckCall = function () {
        this._openUrlRevive && h.default.callClazzFunc(p.default, "reviveCall"), this._openUrlRevive = !1;
      }, e.prototype.showToast = function (t, e) {
        void 0 === e && (e = 2e3), qq.showToast({ title: t, icon: "none", duration: e });
      }, e.prototype.subscribeAppMsg = function () {
        qq.requestSubscribeSystemMessage({ msgTypeList: ["SYS_MSG_TYPE_RANK"], success: function success(t) {
            y.default.log("----requestSubscribeSystemMessage----success", t);
          }, fail: function fail(t) {
            console.log("----requestSubscribeSystemMessage----fail", t);
          } });
      }, e.prototype.shareInvite = function () {
        if ("undefined" != typeof qq) {
          var t = this;qq.shareInvite({ success: function success() {
              y.default.log("shareInvite success"), t._invoke = !0;
            }, fail: function fail(e) {
              1 == e.errCode ? console.log("shareInvite--\u7528\u6237\u53D6\u6D88", e) : console.log("shareInvite--\u5176\u4ED6\u9519\u8BEF", e), t._invoke = !1;
            }, complete: function complete() {
              y.default.log("shareInvite completion");
            } });
        }
      }, e;
    }(r.default);n.default = I, cc._RF.pop();
  }, { "../../Game/Fb/FbEndPanel": "FbEndPanel", "../../Game/Fb/FbPkInvitePanel": "FbPkInvitePanel", "../../Game/Fb/FbPkMatchPanel": "FbPkMatchPanel", "../../Game/Info/FbInfo": "FbInfo", "../../Game/Manager/CommandController": "CommandController", "../Core/GameType": "GameType", "../Manager/DataManager": "DataManager", "../Manager/GlobalEventManager": "GlobalEventManager", "../Manager/Logger": "Logger", "../Manager/SysConfig": "SysConfig", "../Manager/TimeManager": "TimeManager", "../UI/UIManager": "UIManager", "../Util/Base64": "Base64", "../Util/MD5": "MD5", "../Util/NetUtil": "NetUtil", "./AbstractSDK": "AbstractSDK", "./UmaTrackHelper": "UmaTrackHelper" }], SetInfo: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "611f15CeXdN8p/CLmM2T76m", "SetInfo");var _o74,
        i = this && this.__extends || (_o74 = function o(t, e) {
      return (_o74 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o74(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = function (t) {
      function e() {
        var e = t.call(this) || this;return e._notice = 0, e._music = 1, e._vibrate = 1, e;
      }return i(e, t), Object.defineProperty(e, "ins", { get: function get() {
          return null == e._ins && (e._ins = new e()), e._ins;
        }, enumerable: !1, configurable: !0 }), e.prototype.init = function (t) {
        null != t && (null != t.set && (this._music = t.set.music, this._vibrate = t.set.vibrate), null != t.notice && (this._notice = t.notice));
      }, e.prototype.saveData = function (t) {
        t.set = { music: this._music, vibrate: this._vibrate }, t.notice = this._notice;
      }, Object.defineProperty(e.prototype, "music", { get: function get() {
          return this._music;
        }, set: function set(t) {
          this._music != t && (this._music = t, this.save());
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "vibrate", { get: function get() {
          return this._vibrate;
        }, set: function set(t) {
          this._vibrate != t && (this._vibrate = t, this.save());
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "notice", { get: function get() {
          return this._notice;
        }, set: function set(t) {
          this._notice != t && (this._notice = t, this.save());
        }, enumerable: !1, configurable: !0 }), e;
    }(t("../../Common/Info/AbsInfo").default);n.default = r, cc._RF.pop();
  }, { "../../Common/Info/AbsInfo": "AbsInfo" }], ShopConfig: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "3e748lFGOxINoM3+NLvqmYx", "ShopConfig");var _o75,
        i = this && this.__extends || (_o75 = function o(t, e) {
      return (_o75 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o75(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("../../Common/Config/AbsConfig"),
        a = t("./item/ShopData"),
        s = function (t) {
      function e() {
        return t.call(this, a.default) || this;
      }return i(e, t), Object.defineProperty(e, "ins", { get: function get() {
          return null == e._ins && (e._ins = new e()), e._ins;
        }, enumerable: !1, configurable: !0 }), e._ins = null, e;
    }(r.default);n.default = s, cc._RF.pop();
  }, { "../../Common/Config/AbsConfig": "AbsConfig", "./item/ShopData": "ShopData" }], ShopData: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "322c9G/r7FByIICHPWWxdWX", "ShopData"), Object.defineProperty(n, "__esModule", { value: !0 });var o = function () {
      function t(t) {
        this._id = t.attributes.id, this._spId = t.attributes.spId, this._price = t.attributes.price;
      }return Object.defineProperty(t.prototype, "id", { get: function get() {
          return this._id;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "spId", { get: function get() {
          return this._spId;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "price", { get: function get() {
          return this._price;
        }, enumerable: !1, configurable: !0 }), t.cfgFile = "shop", t;
    }();n.default = o, cc._RF.pop();
  }, {}], ShopPanel: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "704a0eAqNdIV55sro7hQHWn", "ShopPanel");var _o76,
        i = this && this.__extends || (_o76 = function o(t, e) {
      return (_o76 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o76(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 }), n.ShopItem = void 0;var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Util/ComponentUtil"),
        c = t("../../Common/Manager/MusicManager"),
        l = t("../../Common/Core/GameType"),
        u = t("../../Common/UI/UIManager"),
        f = t("../../Common/UI/UIItem"),
        d = t("../Config/ShopConfig"),
        h = t("../../Common/Manager/LoadResManager"),
        p = t("../Config/ProductConfig"),
        _ = t("../../Common/Sdks/GameSDK"),
        m = t("../Info/PlayerInfo"),
        g = t("../Manager/CommandController"),
        y = t("../Info/ItemsInfo"),
        b = t("../../Common/Manager/GlobalEventManager"),
        C = t("./ReceiveGiftTips"),
        v = cc._decorator,
        I = v.ccclass,
        M = (v.property, function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), e.prototype.init = function () {
        this.cf = this.data, this.pcf = p.default.ins.getItem(this.cf.spId), this.txt_name = s.default.getComponent(cc.Label, this.node, "txt_name"), this.txt_price = s.default.getComponent(cc.Label, this.node, "txt_price"), this.txt_am = s.default.getComponent(cc.Label, this.node, "txt_am"), this.icon = s.default.getComponent(cc.Sprite, this.node, "icon"), this.btn_buy = s.default.getComponent(cc.Button, this.node, "btn_buy"), this.btn_use = s.default.getNode(this.node, "btn_use"), this.nuse = s.default.getNode(this.node, "nuse"), this.useing = s.default.getNode(this.node, "useing"), this.btn_buy.node.on(cc.Node.EventType.TOUCH_END, this.onTouchBuyHandler, this), this.btn_use.on(cc.Node.EventType.TOUCH_END, this.onTouchUseHandler, this), h.default.loadSprite(this.icon, "Atlas/atlas_item/" + this.pcf.icon), this.txt_price.string = this.cf.price.toString(), this.txt_name.string = this.pcf.name, b.default.on(y.default.event_items_change, this.upInfo, this);
      }, e.prototype.onTouchBuyHandler = function () {
        if (c.default.playEffect(c.default.CLICK), m.default.ins.money >= this.cf.price) {
          y.default.ins.addItem(this.pcf.id, 1, !1);var t = y.default.ins.getData();g.default.buyItem(this.pcf.id, t, this._buyComplete, this, this._buyFail);
        } else _.default.showToast("\u91D1\u5E01\u4E0D\u8DB3");
      }, e.prototype._buyComplete = function (t) {
        var e = { name: this.pcf.name, icon: this.pcf.icon, count: 1, type: C.ReceiveGiftTipType.ForShop };u.default.show(C.default, e);var n = t.money;m.default.ins.money = n, y.default.ins.disChange();
      }, e.prototype._buyFail = function () {
        y.default.ins.removeItem(this.pcf.id, 1, !1);
      }, e.prototype.onTouchUseHandler = function () {
        c.default.playEffect(c.default.CLICK), y.default.ins.setFab(this.pcf.id), y.default.ins.saveData();
      }, e.prototype.upInfo = function () {
        var t = y.default.ins.getItemsItem(this.pcf.id);null != t && t.am > 0 ? (1 == t.fab ? (this.btn_use.active = !1, this.useing.active = !0, this.nuse.active = !1) : (this.btn_use.active = !0, this.useing.active = !1, this.nuse.active = !1), t.am > 0 ? this.txt_am.string = "x" + t.am : this.txt_am.string = "") : (this.btn_use.active = !1, this.useing.active = !1, this.nuse.active = !0, this.txt_am.string = "");
      }, e.prototype.destroy = function () {
        t.prototype.destroy.call(this), b.default.targetOff(this);
      }, e;
    }(f.default));n.ShopItem = M;var P = function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return l.UILayerType.PopLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.btn_close = s.default.getComponent(cc.Button, this.node, "frame/btn_close"), this.btn_close.node.on(cc.Node.EventType.TOUCH_END, this.onTouchCloseHandler, this);var t = d.default.ins.getList();this.items = new Array();for (var e = t.length, n = 0; n < e; n++) {
          var o = s.default.getNode(this.node, "frame/item" + n),
              i = new M(o, t[n]);this.items.push(i);
        }
      }, e.prototype.onShow = function () {
        for (var t = this.items.length, e = 0; e < t; e++) {
          this.items[e].upInfo();
        }
      }, e.prototype.onClose = function () {}, e.prototype.onDestroy = function () {
        t.prototype.onDestroy.call(this), this.btn_close.node.targetOff(this);for (var e = this.items.length, n = 0; n < e; n++) {
          this.items[n].destroy();
        }this.items = null;
      }, e.prototype.onTouchCloseHandler = function () {
        c.default.playEffect(c.default.CLICK), u.default.close(this);
      }, r([I], e);
    }(a.default);n.default = P, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/GlobalEventManager": "GlobalEventManager", "../../Common/Manager/LoadResManager": "LoadResManager", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/Sdks/GameSDK": "GameSDK", "../../Common/UI/UIItem": "UIItem", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Config/ProductConfig": "ProductConfig", "../Config/ShopConfig": "ShopConfig", "../Info/ItemsInfo": "ItemsInfo", "../Info/PlayerInfo": "PlayerInfo", "../Manager/CommandController": "CommandController", "./ReceiveGiftTips": "ReceiveGiftTips" }], SignConfig: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "852e5iL8WdA+rzECWQU7oIt", "SignConfig");var _o77,
        i = this && this.__extends || (_o77 = function o(t, e) {
      return (_o77 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o77(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("../../Common/Config/AbsConfig"),
        a = t("./item/SignData"),
        s = function (t) {
      function e() {
        return t.call(this, a.default) || this;
      }return i(e, t), Object.defineProperty(e, "ins", { get: function get() {
          return null == e._ins && (e._ins = new e()), e._ins;
        }, enumerable: !1, configurable: !0 }), e._ins = null, e;
    }(r.default);n.default = s, cc._RF.pop();
  }, { "../../Common/Config/AbsConfig": "AbsConfig", "./item/SignData": "SignData" }], SignData: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "ac4f7reVbdDSq8vjWHApWtG", "SignData"), Object.defineProperty(n, "__esModule", { value: !0 });var o = function () {
      function t(t) {
        this._id = t.attributes.id, this._spId = t.attributes.spId, this._count = t.attributes.count, this._spId8 = t.attributes.spId8, this._count8 = t.attributes.count8;
      }return Object.defineProperty(t.prototype, "id", { get: function get() {
          return this._id;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "spId", { get: function get() {
          return this._spId;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "count", { get: function get() {
          return this._count;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "spId8", { get: function get() {
          return this._spId8;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "count8", { get: function get() {
          return this._count8;
        }, enumerable: !1, configurable: !0 }), t.cfgFile = "sign", t;
    }();n.default = o, cc._RF.pop();
  }, {}], SignInfo: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "f42ca67C8FL2YphxTtmgP/l", "SignInfo");var _o78,
        i = this && this.__extends || (_o78 = function o(t, e) {
      return (_o78 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o78(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("../../Common/Info/AbsInfo"),
        a = t("../../Common/Core/NumValue"),
        s = t("../../Common/Core/GameType"),
        c = t("../../Common/Manager/TimeManager"),
        l = function (t) {
      function e() {
        var e = t.call(this) || this;return e._day = new a.default(), e._time = new a.default(), e;
      }return i(e, t), Object.defineProperty(e, "ins", { get: function get() {
          return null == e._ins && (e._ins = new e()), e._ins;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "day", { get: function get() {
          return this._day.value;
        }, set: function set(t) {
          this._day.value != t && (this._day.value = t);
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "time", { get: function get() {
          return this._time.value;
        }, set: function set(t) {
          this._time.value != t && (this._time.value = t, this.emit(s.InfoEvent.EVENT_CHANGE));
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "list", { get: function get() {
          return this._list;
        }, enumerable: !1, configurable: !0 }), e.prototype.init = function (t) {
        t.sign && (this._list = t.sign, null != t.sign.d && (this.day = t.sign.d), null != t.sign.t && (this.time = t.sign.t));
      }, e.prototype.onNewDayHandler = function () {}, e.prototype.checkCurDaySigned = function () {
        var t = new Date(c.default.serverTime).getDay();return 0 == t && (t = 7), this.list.includes(t);
      }, e;
    }(r.default);n.default = l, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Core/NumValue": "NumValue", "../../Common/Info/AbsInfo": "AbsInfo", "../../Common/Manager/TimeManager": "TimeManager" }], SignPanel: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "55f11mK+HZKmJbQmd47C84w", "SignPanel");var _o79,
        i = this && this.__extends || (_o79 = function o(t, e) {
      return (_o79 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o79(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Util/ComponentUtil"),
        c = t("../../Common/Manager/MusicManager"),
        l = t("../../Common/Core/GameType"),
        u = t("../../Common/UI/UIManager"),
        f = t("../Manager/CommandController"),
        d = t("../../Common/Sdks/GameSDK"),
        h = t("../Config/ProductConfig"),
        p = t("../../Common/Manager/Logger"),
        _ = t("../Info/PlayerInfo"),
        m = t("../Config/SignConfig"),
        g = t("../Info/SignInfo"),
        y = t("../../Common/Manager/TimeManager"),
        b = t("./ReceiveGiftTips"),
        C = t("../../Common/Sdks/UmaTrackHelper"),
        v = t("../Manager/GameManager"),
        I = cc._decorator,
        M = I.ccclass,
        P = (I.property, function (t) {
      function e() {
        var e = t.call(this) || this;return e._isForceShade = !0, e;
      }var n;return i(e, t), n = e, Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return l.UILayerType.SubPopLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        n.isFirst = !1, p.default.log("SignPanel onStart!!!"), this.item_content = s.default.getNode(this.node, "frame/item_content"), this.sign_item = s.default.getNode(this.node, "frame/sign_item"), this.btn_close = s.default.getComponent(cc.Button, this.node, "frame/btn_close"), this.btn_close.node.on(cc.Node.EventType.TOUCH_END, this.onTouchCloseHandler, this), this.btn_receive_gift = s.default.getComponent(cc.Button, this.node, "frame/btn_receive_gift"), this.btn_receive_gift.node.on(cc.Node.EventType.TOUCH_END, this.onTouchReceiveGiftHandler, this), this.btn_double_gift = s.default.getComponent(cc.Button, this.node, "frame/btn_double_gift"), this.btn_double_gift.node.on(cc.Node.EventType.TOUCH_END, this.onTouchDoubleGiftHandler, this), this.day7_is_got = s.default.getNode(this.node, "day7/bg/is_got"), this.day7_particle = s.default.getNode(this.node, "day7/bg/particle"), this.day7_node = s.default.getNode(this.node, "day7/bg"), this.day7_node.on("touchend", this.onDay7NodeClick, this), this.sign_list = m.default.ins.getList(), p.default.log("this.sign_list", this.sign_list), cc.game.on("SignPanelRefresh", this.onShow, this);
      }, e.prototype.onShow = function () {
        this.item_content.removeAllChildren(), p.default.log(g.default.ins.list, "\u7B7E\u5230\u5217\u8868");var t = new Date(y.default.serverTime).getDay();0 == t && (t = 7), p.default.log(t, "\u4ECA\u5929\u662F\u5468\u51E0"), this.today = t, this.isSignedToday = g.default.ins.list.includes(t), g.default.ins.list.includes(8) ? (this.day7_is_got.active = !0, this.day7_particle.active = !1) : 7 == g.default.ins.list.length ? (this.day7_is_got.active = !1, this.day7_particle.active = !0) : (this.day7_is_got.active = !1, this.day7_particle.active = !1);for (var e = 0; e < this.sign_list.length - 1; e++) {
          var n = this.sign_list[e].spId,
              o = e,
              i = h.default.ins.getItem(n),
              r = "Atlas/atlas_item/" + i.icon;p.default.log(r, "icon");var a = i.name + "X" + this.sign_list[e].count,
              s = !1,
              c = !1,
              l = !1,
              u = g.default.ins.list.includes(e + 1);t > e + 1 && u ? s = !0 : t > e + 1 && !u && (l = !0), t == e + 1 && u ? (s = !0, this.btn_receive_gift.interactable = !1, this.btn_double_gift.interactable = !1) : t != e + 1 || u || (c = !0, this.btn_receive_gift.interactable = !0, this.btn_double_gift.interactable = !0, p.default.log("\u661F\u671F" + (e - 0 + 1) + "\u8FD8\u6CA1\u7B7E\u5230"));var f = { days: o, icon: r, name_count: a, show_is_got: s, show_particle: c, show_btn_buqian: l },
              d = cc.instantiate(this.sign_item);d.getComponent("sign_item").init(f), this.item_content.addChild(d);
        }
      }, e.prototype.onClose = function () {}, e.prototype.onTouchCloseHandler = function () {
        c.default.playEffect(c.default.CLICK), u.default.close(this);
      }, e.prototype.onDay7NodeClick = function () {
        var t = this;p.default.log("--------------------- onDay7NodeClick --------------------  "), 7 == g.default.ins.list.length ? f.default.sign(8, 2, !1, function (e) {
          var n = m.default.ins.getItem(8),
              o = n.spId,
              i = n.count;0 != v.default.sign8 && (o = n.spId8, i = n.count8);var r = h.default.ins.getItem(o),
              a = { icon: r.icon, count: i, name: r.name, type: b.ReceiveGiftTipType.ForSign };u.default.show(b.default, a), g.default.ins.init(e), t.onShow();
        }, this) : d.default.showToast("\u9886\u53D6\u6761\u4EF6\u4E0D\u8DB3");
      }, e.prototype.onTouchDoubleGiftHandler = function () {
        if (c.default.playEffect(c.default.CLICK), this.isSignedToday) d.default.sdk.showToast("\u4ECA\u5929\u5DF2\u7B7E\u5230\uFF0C\u660E\u5929\u518D\u6765\u5427\uFF01", 1e3);else {
          var t = this;c.default.playEffect(c.default.CLICK), d.default.showVideoAd(function () {
            t.giveSignReward(2), C.default.trackEvent("1331");
          }, this, l.VideoAdType.Sign);
        }
      }, e.prototype.onTouchReceiveGiftHandler = function () {
        c.default.playEffect(c.default.CLICK), p.default.log("-------------------onTouchReceiveGiftHandler "), this.isSignedToday ? d.default.sdk.showToast("\u4ECA\u5929\u5DF2\u7B7E\u5230\uFF0C\u660E\u5929\u518D\u6765\u5427\uFF01", 1e3) : (this.giveSignReward(1), C.default.trackEvent("1329"));
      }, e.prototype.giveSignReward = function (t) {
        var e = this;if (c.default.playEffect(c.default.CLICK), p.default.log("-------------------giveSignReward--- ", t), this.isSignedToday) d.default.sdk.showToast("\u4ECA\u5929\u5DF2\u7B7E\u5230\uFF0C\u660E\u5929\u518D\u6765\u5427\uFF01", 1e3);else {
          var n = this;c.default.playEffect(c.default.CLICK), g.default.ins.day += 1, g.default.ins.day > 7 && (g.default.ins.day = 1), g.default.ins.time = new Date().getTime(), f.default.sign(this.today, 0, 2 == t, function (o) {
            p.default.log("\u7B7E\u5230\u6210\u529F\uFF01", o), g.default.ins.init(o);var i = n.sign_list[e.today - 1].spId,
                r = h.default.ins.getItem(i),
                a = r.icon,
                s = r.name,
                c = n.sign_list[e.today - 1].count * t,
                l = { icon: a, count: c, name: s, type: b.ReceiveGiftTipType.ForSign };u.default.show(b.default, l), 1 == i && (_.default.ins.money += c), 2 == i && (_.default.ins.giftCoupon += c), n.onShow();
          }, this);
        }
      }, e.isFirst = !0, n = r([M], e);
    }(a.default));n.default = P, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/Logger": "Logger", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/Manager/TimeManager": "TimeManager", "../../Common/Sdks/GameSDK": "GameSDK", "../../Common/Sdks/UmaTrackHelper": "UmaTrackHelper", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Config/ProductConfig": "ProductConfig", "../Config/SignConfig": "SignConfig", "../Info/PlayerInfo": "PlayerInfo", "../Info/SignInfo": "SignInfo", "../Manager/CommandController": "CommandController", "../Manager/GameManager": "GameManager", "./ReceiveGiftTips": "ReceiveGiftTips" }], SingleController: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "072beMNQmxB7IsvYODQoqsm", "SingleController");var _o80,
        i = this && this.__extends || (_o80 = function o(t, e) {
      return (_o80 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o80(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("./AbsDashController"),
        a = t("../Manager/GameManager"),
        s = t("../Info/FbInfo"),
        c = t("../Scene/GameScene"),
        l = t("../../Common/UI/UIManager"),
        u = t("../Fb/FbRewardPanel"),
        f = t("../Fb/FbEndPanel"),
        d = t("../Fb/FbPanel"),
        h = t("../Config/GameConfig"),
        p = function (t) {
      function e(e) {
        var n = t.call(this, e) || this;return h.default.resetDashStep(10), n._musicCtrl.init(1, n.initScene, n), n;
      }return i(e, t), e.prototype.startGame = function () {
        this._musicCtrl.playLoop(), this._musicCtrl.mute = !0, this._playing = !0;
      }, e.prototype.initSceneComplete = function () {
        this.startGame();
      }, e.prototype.hitStage = function (t) {
        void 0 === t && (t = 0), 1 == t ? l.default.callClazzFunc(d.default, "showComboTips") : l.default.callClazzFunc(d.default, "resetCombo");
      }, e.prototype.useItem = function () {
        return !1;
      }, e.prototype.revive = function () {
        t.prototype.revive.call(this), l.default.callClazzFunc(d.default, "resetCombo");
      }, e.prototype.win = function () {}, e.prototype.fail = function () {
        a.default.buildScore(), s.default.ins.step = c.default.ins.stepIdx, s.default.ins.reviveCount >= a.default.MAX_REVIVE_COUNT ? (c.default.ins.closeGame(), l.default.show(u.default)) : l.default.show(f.default);
      }, e;
    }(r.default);n.default = p, cc._RF.pop();
  }, { "../../Common/UI/UIManager": "UIManager", "../Config/GameConfig": "GameConfig", "../Fb/FbEndPanel": "FbEndPanel", "../Fb/FbPanel": "FbPanel", "../Fb/FbRewardPanel": "FbRewardPanel", "../Info/FbInfo": "FbInfo", "../Manager/GameManager": "GameManager", "../Scene/GameScene": "GameScene", "./AbsDashController": "AbsDashController" }], SportController: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "61a2btGUShAjoMoRMnpMYfm", "SportController");var _o81,
        i = this && this.__extends || (_o81 = function o(t, e) {
      return (_o81 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o81(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("./AbsDashController"),
        a = t("../../Common/Util/StringUtil"),
        s = t("../../Common/Sdks/GameSDK"),
        c = t("../Net/GameClient"),
        l = t("../Info/FbInfo"),
        u = t("../../Common/Manager/TimeManager"),
        f = t("../../Common/UI/UIManager"),
        d = t("../Fb/FbPanel"),
        h = t("../Config/GameConfig"),
        p = t("../Scene/GameScene"),
        _ = t("../Main/FbWinPanel"),
        m = t("../Main/FbLostPanel"),
        g = t("../Main/FbDogfallPanel"),
        y = t("../../Common/Manager/Logger"),
        b = t("../Manager/GameManager"),
        C = t("../../Common/Util/MathUtil"),
        v = t("../Config/ProductConfig"),
        I = t("./ItemActor"),
        M = t("../../Common/Manager/MusicManager"),
        P = t("../../Common/Manager/GlobalEventManager"),
        S = t("../../Common/Core/GameType"),
        T = function (t) {
      function e(e, n) {
        var o = t.call(this, e) || this;return h.default.resetDashStep(5), o._type = 1, n.l[0].uid == s.default.getUid() ? (o._fx = -1, o._playerId = n.l[1].uid) : (o._fx = 1, o._playerId = n.l[0].uid), o._roomId = n.rid, o._players = n.l, o._offsetPara = a.default.getCodeTotal(o._roomId), y.default.log(">>> \u623F\u95F4\u7F16\u7801\uFF1A", a.default.getCodeTotal(o._roomId)), o._uptime = u.default.serverTime, o._autoRunTime = 3, o._stageLayoutIdx = o._offsetPara % 2 > 0 ? 1 : 3, o._musicCtrl.init(o._offsetPara, o.initScene, o), o.registerNetCmd(), P.default.on(S.GameEvent.Hide, o.onHideHandler, o), o;
      }return i(e, t), e.prototype.onHideHandler = function () {
        this._tipsNode.active = !1, f.default.callClazzFunc(d.default, "cancelReady"), c.default.ins.send(521, { rid: this._roomId }), this.gameOver(!1);
      }, e.prototype.initSceneComplete = function () {}, e.prototype.startGame = function () {
        this._musicCtrl.playLoop(), this._musicCtrl.mute = !0, this._playing = !0, this._isInited = !0, this.autoRun();
      }, e.prototype.registerNetCmd = function () {
        c.default.ins.addPacketDataListener(258, this.cmd0x0102Handler, this), c.default.ins.addPacketDataListener(518, this.cmd0x0206Handler, this), c.default.ins.addPacketDataListener(519, this.cmd0x0207Handler, this), c.default.ins.addPacketDataListener(520, this.cmd0x0208Handler, this), c.default.ins.addPacketDataListener(521, this.cmd0x0209Handler, this);
      }, e.prototype.unRegisterNetCmd = function () {
        c.default.ins.removeAll(this);
      }, e.prototype.update = function (e) {
        if (t.prototype.update.call(this, e), this._playing && this._running) {
          if (this._hero.isThrow && this._itemNode) if (this._hero.animState.time < this._hero.animState.duration / 2) {
            var n = this._hero.locator,
                o = n.parent.convertToWorldSpaceAR(n.position);o = this._scene.convertToNodeSpaceAR(o), this._itemNode.position = o, this._itemNode.eulerAngles = cc.v3(0, 0, -25), this.isThrowing = !1;
          } else this.isThrowing || this.startThrow();
        } else this._playing && !this._running && null != this._autoRunTime && (this._isTouched ? (this.autoRun(), this._autoRunTime = null) : (this._autoRunTime -= e, this._autoRunTime < 0 && (this.autoRun(), this._autoRunTime = null)));
      }, e.prototype.startThrow = function () {
        cc.tween(this._itemNode).to(.2, { position: cc.v3(this._hero.position.x - 15 * this._fx, this._hero.position.y + 3, this._hero.z - 35), eulerAngles: cc.v3(180 * Math.random(), 180 * Math.random(), 180 * Math.random()) }).call(this.throwFinish.bind(this)).start(), this.isThrowing = !0, M.default.playEffect(M.default.THROW);
      }, e.prototype.throwFinish = function () {
        this._itemNode.position = cc.v3(this._hero.position.x - 15 * this._fx, this._itemNode.y + 3, this._hero.z - 35), this._itemNode.eulerAngles = cc.v3(180 * Math.random(), 180 * Math.random(), 180 * Math.random()), I.default.push(this._itemNode);
      }, e.prototype.startAttack = function (t) {
        t.uid == s.default.getUid() ? (this._itemNode = null, this._hero.throw()) : "" != t.itemId ? this.attackCamera(this._itemNode) : this.attackHero(this._itemNode);
      }, e.prototype.attackHero = function (t) {
        t.position = cc.v3(this._hero.position.x - 13 * this._fx, t.y + 3, this._hero.z - 35), t.eulerAngles = cc.v3(180 * Math.random(), 180 * Math.random(), 180 * Math.random()), cc.tween(t).to(.4, { position: cc.v3(this._hero.position.x, this._hero.position.y + 1, this._hero.position.z - .3 * h.default.CurHeroSpeed), eulerAngles: cc.v3(180 * Math.random(), 180 * Math.random(), 180 * Math.random()) }).call(this.attackFinish.bind(this)).start();
      }, e.prototype.attackCamera = function (t) {
        t.position = cc.v3(this._hero.position.x - 13 * this._fx, t.y + 3, this._hero.z - 35), t.eulerAngles = cc.v3(180 * Math.random(), 180 * Math.random(), 180 * Math.random()), cc.tween(t).to(.4, { position: cc.v3(this._camera.node.position.x + this._fx, this._camera.node.position.y - 1.2, this._camera.node.position.z - .3 * h.default.CurHeroSpeed - 5), eulerAngles: cc.v3(180 * Math.random(), 180 * Math.random(), 180 * Math.random()) }).call(this.attackFinish.bind(this)).start();
      }, e.prototype.attackFinish = function (t) {
        var e = t,
            n = e.data;if (0 == n.kind) {
          var o = this._camera.node.getChildByName("effNode");(i = I.ItemEffectActor.get(e.data.effect)).position = cc.Vec3.ZERO, o && (o.addChild(i), i.play());
        } else if (2 == n.kind) {
          var i;(i = I.ItemEffectActor.get(e.data.effect)).position = cc.v3(this._hero.position.x, 0, this._hero.position.z - 50), this._scene.addChild(i), i.play();
        } else this._hero.dizzy(e.data);M.default.playEffect(M.default.HITTARGET), I.default.push(e);
      }, e.prototype.cmd0x0102Handler = function (t) {
        t.isError || p.default.ins.closeGame();
      }, e.prototype.cmd0x0206Handler = function (t) {
        t.isError || t.body.uid == s.default.getUid() && (this._score = t.body.score, this._scoreRatio = C.default.clamp(1 + this._score / 3e3, 1, 3));
      }, e.prototype.cmd0x0207Handler = function (t) {
        if (!t.isError) {
          var e = v.default.ins.getItem(t.body.itemId),
              n = I.default.get(e);t.body.uid == s.default.getUid() ? (this._itemNode = n, this._hero.throw()) : u.default.add(function () {
            0 == e.kind ? this.attackCamera(n) : this.attackHero(n);
          }, this, 300, 1), this._scene.addChild(n);
        }
      }, e.prototype.cmd0x0208Handler = function (t) {
        if (!t.isError) {
          this._gameFinish = !0;var e = t.body;l.default.ins.step = p.default.ins.stepIdx, f.default.close(d.default), this.unRegisterNetCmd(), c.default.ins.close(), p.default.ins.closeGame(), 1 == t.body.f ? s.default.getUid() == t.body.win ? b.default.fbPkEnd(1, _.default, e) : b.default.fbPkEnd(0, m.default, e) : b.default.fbPkEnd(2, g.default, e);
        }
      }, e.prototype.cmd0x0209Handler = function (t) {
        t.isError || (t.body.uid == this._playerId ? (this._playerDie = !0, f.default.callClazzFunc(d.default, "playerDie")) : f.default.callClazzFunc(d.default, "heroDie"));
      }, e.prototype.hitStage = function (t) {
        void 0 === t && (t = 0), this._gameFinish || (u.default.serverTime - this._uptime > 500 && (c.default.ins.send(518, { rid: this._roomId, score: l.default.ins.currentScore }), this._uptime = u.default.serverTime), 1 == t ? (f.default.callClazzFunc(d.default, "showComboTips"), h.default.Energy += 2.5 * this._scoreRatio) : (f.default.callClazzFunc(d.default, "resetCombo"), h.default.Energy += 1.5 * this._scoreRatio));
      }, e.prototype.revive = function () {
        t.prototype.revive.call(this), f.default.callClazzFunc(d.default, "resetCombo");
      }, e.prototype.win = function () {
        this._gameFinish || (this._uptime = u.default.serverTime, c.default.ins.send(518, { rid: this._roomId, score: l.default.ins.currentScore }));
      }, e.prototype.fail = function () {
        this._uptime = u.default.serverTime, this._gameFinish || (c.default.ins.send(518, { rid: this._roomId, score: l.default.ins.currentScore }), c.default.ins.send(521, { rid: this._roomId }));
      }, e.prototype.useItem = function (t) {
        return !(!(this._playing && this._running && t) || this._hero.isDizzy || this._playerDie || (c.default.ins.send(519, { rid: this._roomId, toUid: this._playerId, itemId: t.id }), 0));
      }, e.prototype.destroy = function () {
        this.unRegisterNetCmd(), P.default.targetOff(this), t.prototype.destroy.call(this);
      }, e;
    }(r.default);n.default = T, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/GlobalEventManager": "GlobalEventManager", "../../Common/Manager/Logger": "Logger", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/Manager/TimeManager": "TimeManager", "../../Common/Sdks/GameSDK": "GameSDK", "../../Common/UI/UIManager": "UIManager", "../../Common/Util/MathUtil": "MathUtil", "../../Common/Util/StringUtil": "StringUtil", "../Config/GameConfig": "GameConfig", "../Config/ProductConfig": "ProductConfig", "../Fb/FbPanel": "FbPanel", "../Info/FbInfo": "FbInfo", "../Main/FbDogfallPanel": "FbDogfallPanel", "../Main/FbLostPanel": "FbLostPanel", "../Main/FbWinPanel": "FbWinPanel", "../Manager/GameManager": "GameManager", "../Net/GameClient": "GameClient", "../Scene/GameScene": "GameScene", "./AbsDashController": "AbsDashController", "./ItemActor": "ItemActor" }], StageActor: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "01065ke1qNH2Y8xnZmWv8qg", "StageActor");var _o82,
        i = this && this.__extends || (_o82 = function o(t, e) {
      return (_o82 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o82(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 }), n.StageActorCom = void 0;var a = t("../../Common/Util/MathUtil"),
        s = t("./ObjectActor"),
        c = t("../../Common/Manager/LoadResManager"),
        l = t("../Config/GameConfig"),
        u = cc._decorator,
        f = u.ccclass,
        d = (u.property, function (t) {
      function e() {
        var e = t.call(this) || this;return e._fx = Math.random() > .5 ? 1 : -1, e;
      }return i(e, t), e.prototype.startMove = function (t, e, n) {
        this._radius = t, this._speed = e, this._isMove = !0, this._fx = n;
      }, e.prototype.stopMove = function () {
        this._isMove = !1;
      }, e.prototype.update = function () {
        this._isMove && ((this.node.x >= Math.abs(this._radius) || this.node.x <= -Math.abs(this._radius)) && (this._fx *= -1), this.node.x += this._fx * this._speed);
      }, r([f], e);
    }(cc.Component));n.StageActorCom = d;var h = function (t) {
      function e() {
        var e = t.call(this) || this;e._itemType = l.StageItemType.Normal, e.group = "planet", e.is3DNode = !0, e._com = e.addComponent(d), e._radius = 0, e._size = 1;var n = e;return c.default.bundle.load("Prefab/stage", cc.Prefab, function (t, e) {
          n.initModel(e);
        }), e;
      }return i(e, t), Object.defineProperty(e.prototype, "size", { get: function get() {
          return this._size;
        }, set: function set(t) {
          this._size = t, this._model && (this._stage.scaleX = this._size, this._stage.scaleZ = this._size, this._shadow.scaleX = this._size, this._shadow.scaleY = this._size, this._shadow.scaleZ = this._size, this._shadow.y = .4 * (this._size - 1), this.setObjectScale());
        }, enumerable: !1, configurable: !0 }), e.prototype.startMove = function (t, e, n) {
        void 0 === n && (n = 0), this._isAppear ? (this._radius = t, this._speed = e, this._fx = n) : (this._com.startMove(t, e, n), this._radius = 0, this._speed = 0);
      }, e.prototype.stopMove = function () {
        this._com.stopMove();
      }, e.prototype.initModel = function (t) {
        var e;e = cc.instantiate(t), this._model = e, this._model.scale = 1.5, this._stage = e.getChildByName("stage"), this._shadow = e.getChildByName("shadow"), this._stage.scaleX = this._size, this._stage.scaleZ = this._size, this._shadow.scaleX = this._size, this._shadow.scaleY = this._size, this._shadow.scaleZ = this._size, this._shadow.y = .4 * (this._size - 1), this.setObjectScale(), this.addChild(e);
      }, e.prototype.setObjectScale = function () {
        this._object && ("obstacle" == this._object.name ? (this._object.scaleX = this._size, this._object.scaleZ = this._size) : (this._object.scaleX = 1, this._object.scaleY = 1, this._object.scaleZ = 1));
      }, e.prototype.addItem = function (t) {
        if (this._itemType != t) {
          var e;switch (this._object && (this._object.removeFromParent(), this._object = null), this._itemType = t, t) {case l.StageItemType.Gold:
              (e = new s.default()).setName("gold");break;case l.StageItemType.Obstacle:
              (e = new s.default()).setName("obstacle");break;case l.StageItemType.JiaoZi:
              (e = new s.default()).setName("jiaozi");}e && (this._object = e, this.addChild(e), this.setObjectScale());
        }
      }, Object.defineProperty(e.prototype, "itemType", { get: function get() {
          return this._itemType;
        }, enumerable: !1, configurable: !0 }), e.prototype.removeItem = function () {
        this._object && (this._object.removeFromParent(), this._object.destroyAllChildren(), this._object.destroy(), this._object = null), this._itemType = l.StageItemType.Normal;
      }, e.prototype.appear = function (t) {
        void 0 === t && (t = null), this.removeItem(), this.stopMove(), this._isAppear = !0, this.scale = 0, t ? cc.tween(this).to(.5, { scale: a.default.randomFloat(1, 1), position: t }).call(this._appearHandler, this).start() : cc.tween(this).to(.5, { scale: a.default.randomFloat(1, 1) }).call(this._appearHandler, this).start();
      }, e.prototype._appearHandler = function () {
        this._isAppear = !1, 0 != this._radius && this.startMove(this._radius, this._speed, this._fx);
      }, e;
    }(cc.Node);n.default = h, cc._RF.pop();
  }, { "../../Common/Manager/LoadResManager": "LoadResManager", "../../Common/Util/MathUtil": "MathUtil", "../Config/GameConfig": "GameConfig", "./ObjectActor": "ObjectActor" }], StringUtil: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "4ee6akJpFhOWKPZYe2qQ0dv", "StringUtil"), Object.defineProperty(n, "__esModule", { value: !0 });var o = t("../Core/ByteArray"),
        i = function () {
      function t() {}return t.toString = function (e, n, o) {
        void 0 === o && (o = -1);var i = e.toString(n),
            r = i.length;return r >= o ? i : t.zeros.substr(0, o - r) + i;
      }, t.formatHttpParams = function (t) {
        var e = "";if (null != t) for (var n in t) {
          e += n + "=" + t[n] + "&";
        }return e.length > 0 && (e = e.substr(0, e.length - 1)), e;
      }, t.convertPoint = function (t, e) {
        var n = t.split(e);if (2 == n.length) {
          var o = parseFloat(n[0]),
              i = parseFloat(n[1]);if (!isNaN(o) && !isNaN(i)) return cc.v2(o, i);
        }return null;
      }, t.convertPointArray = function (e) {
        var n = [];if (null != e && e.length > 0) for (var o = e.split(","), i = 0; i < o.length; i++) {
          var r = t.convertPoint(o[i], "|");n.push(r);
        }return n;
      }, t.convertNumberArray = function (t, e) {
        var n = [];if (null != t && t.length > 0) for (var o = t.split(e), i = 0; i < o.length; i++) {
          var r = parseFloat(o[i]);n.push(r);
        }return n;
      }, t.convertIntArray = function (t, e) {
        var n = [];if (null != t && t.length > 0) for (var o = t.split(e), i = 0; i < o.length; i++) {
          var r = parseInt(o[i]);n.push(r);
        }return n;
      }, t.formatCountdownTime = function (e, n) {
        void 0 === n && (n = 2);var o = Math.max(0, e),
            i = Math.round(o / 1e3),
            r = Math.floor(i / 3600),
            a = Math.floor(i / 60),
            s = i % 60;return 3 == n ? (a = Math.floor((i - 3600 * r) / 60), t.toString(r, 10, 2) + ":" + t.toString(a, 10, 2) + ":" + t.toString(s, 10, 2)) : t.toString(a, 10, 2) + ":" + t.toString(s, 10, 2);
      }, t.formatTime = function (e) {
        var n = new Date(e);return t.toString(n.getMonth() + 1, 10, 2) + "/" + t.toString(n.getDate(), 10, 2) + " " + t.toString(n.getHours(), 10, 2) + ":" + t.toString(n.getMinutes(), 10, 2) + "." + t.toString(n.getSeconds(), 10, 2);
      }, t.getCurrentTime = function (t) {
        return void 0 === t && (t = 3), new Date(), "";
      }, t.replaceNewLine = function (t) {
        for (var e = t.split("\\n"), n = "", o = 0; o < e.length; o++) {
          e[o].length > 0 && (o < e.length - 1 ? n += e[o] + "\n" : n += e[o]);
        }return n;
      }, t.getStringLength = function (t) {
        var e = 0;if (t) for (var n = 0; n < t.length; n++) {
          e += t.charCodeAt(n) > 255 ? 1 : .5;
        }return e;
      }, t.formatUnitNumber = function (t, e) {
        if (void 0 === e && (e = !0), e) {
          if (t > 1e6) return Math.floor(t / 1e6 * 10) / 10 + "m";if (t > 1e3) return Math.floor(t / 1e3 * 10) / 10 + "k";
        }return t + "";
      }, t.linkStrings = function (t, e) {
        void 0 === e && (e = ",");var n = null,
            o = t.length;if (o > 0) {
          n = "";for (var i = 0; i < o; i++) {
            n += t[i], i < o - 1 && (n += e);
          }
        }return n;
      }, t.stringToByte = function (t) {
        var e,
            n,
            o = new Array();e = t.length;for (var i = 0; i < e; i++) {
          (n = t.charCodeAt(i)) >= 65536 && n <= 1114111 ? (o.push(n >> 18 & 7 | 240), o.push(n >> 12 & 63 | 128), o.push(n >> 6 & 63 | 128), o.push(63 & n | 128)) : n >= 2048 && n <= 65535 ? (o.push(n >> 12 & 15 | 224), o.push(n >> 6 & 63 | 128), o.push(63 & n | 128)) : n >= 128 && n <= 2047 ? (o.push(n >> 6 & 31 | 192), o.push(63 & n | 128)) : o.push(255 & n);
        }return o;
      }, t.byteToString = function (t) {
        if ("string" == typeof t) return t;for (var e = new o.default(), n = [], i = 0; i < t.length; i++) {
          n.push(t[i]);
        }return e.decodeUTF8(n);
      }, t.parseHexStr2Byte = function (t) {
        var e = 0,
            n = t.length;if (n % 2 != 0) return null;n /= 2;for (var o = [], i = 0; i < n; i++) {
          var r = t.substr(e, 2),
              a = parseInt(r, 16);o.push(a), e += 2;
        }return o;
      }, t.parseByte2HexStr = function (t) {
        for (var e = "", n = 0; n < t.length; n++) {
          var o = t[n].toString(16);1 == o.length && (o = "0" + o), e += o;
        }return e;
      }, t.getCodeTotal = function (t) {
        for (var e = 0, n = 0; n < t.length; n++) {
          var o = Math.abs(t.charCodeAt(n));e += o, o > 58 && e++;
        }return e;
      }, t.zeros = "00000000000000000000000000000000000000000000000000000000000", t;
    }();n.default = i, cc._RF.pop();
  }, { "../Core/ByteArray": "ByteArray" }], StringWorker: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "c324azkCwtLEKdno0lO5V+U", "StringWorker");var _o83,
        i = this && this.__extends || (_o83 = function o(t, e) {
      return (_o83 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o83(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    });Object.defineProperty(n, "__esModule", { value: !0 });var r = t("../../../Common/Core/ByteArray"),
        a = t("./MsgPackFlags"),
        s = function (t) {
      function e(e, n) {
        return void 0 === e && (e = null), void 0 === n && (n = 0), t.call(this, e, n) || this;
      }return i(e, t), e.prototype.checkByte = function (t) {
        return 160 == (224 & t) || 217 == t || 218 == t || 219 == t;
      }, e.prototype.checkType = function (t) {
        return "string" == typeof t;
      }, e.prototype.assembly = function (t, e) {
        var n = new r.default();n.writeUTFBytes(t.toString()), n.length < 32 ? e.writeByte(160 | n.length) : !this.factory.checkFlag(a.default.SPEC2013_COMPATIBILITY) && n.length < 256 ? (e.writeByte(217), e.writeByte(n.length)) : n.length < 65536 ? (e.writeByte(218), e.writeShort(n.length)) : (e.writeByte(219), e.writeUnsignedInt(n.length)), e.writeBytes(n, 0, n.length);
      }, e.prototype.disassembly = function (t, e) {
        var n = -1;if (160 == (224 & t) ? n = 31 & t : 217 == t && e.bytesAvailable >= 1 ? n = e.readUnsignedByte() : 218 == t && e.bytesAvailable >= 2 ? n = e.readUnsignedShort() : 219 == t && e.bytesAvailable >= 4 && (n = e.readUnsignedInt()), e.bytesAvailable >= n) {
          var o = new r.default();return n > 0 && e.readBytes(o, 0, n), o.length > 0 ? this.factory.checkFlag(a.default.READ_STRING_AS_BYTE_ARRAY) ? o : o.readUTFBytes(n) : this.factory.checkFlag(a.default.READ_STRING_AS_BYTE_ARRAY) ? o : "";
        }return this.incomplete;
      }, e;
    }(t("./AbstractWorker").default);n.default = s, cc._RF.pop();
  }, { "../../../Common/Core/ByteArray": "ByteArray", "./AbstractWorker": "AbstractWorker", "./MsgPackFlags": "MsgPackFlags" }], SubContextViewController: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "04302TaApdACqy6cd0LqzMw", "SubContextViewController");var _o84,
        i = this && this.__extends || (_o84 = function o(t, e) {
      return (_o84 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o84(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/Sdks/GameSDK"),
        s = t("../../Common/Core/GameType"),
        c = t("../../Common/Manager/Logger"),
        l = cc._decorator,
        u = l.ccclass,
        f = (l.property, function (t) {
      function e() {
        var e = t.call(this) || this;return n._ins = e, e;
      }var n;return i(e, t), n = e, Object.defineProperty(e, "ins", { get: function get() {
          return this._ins;
        }, enumerable: !1, configurable: !0 }), e.prototype.start = function () {
        this._contextView = this.node.getComponent(cc.SubContextView), this._contextView.node.active = !1;
      }, e.prototype.hasContextView = function () {
        return a.default.sdkId == s.SdkType.QQ;
      }, e.prototype.showRank1 = function (t) {
        c.default.log("-----------showRank1---------------"), this.hasContextView() && (this._contextView.node.parent = null, this._contextView.node.width = 488, this._contextView.node.height = 600, t.addChild(this.node), a.default.postMessage("loadRank1"), this._contextView.node.active = !0, this._contextView.reset());
      }, e.prototype.closeRank1 = function (t) {
        c.default.log("-----------closeRank1---------------"), this.hasContextView() && (a.default.postMessage("closeRank1"), this._contextView.node.active = !1, t.removeChild(this._contextView.node, !0));
      }, e.prototype.showRank2 = function (t) {
        c.default.log("-----------showRank2---------------"), this.hasContextView() && (this._contextView.node.parent = null, this._contextView.node.width = 488, this._contextView.node.height = 600, t.addChild(this.node), a.default.postMessage("loadRank2"), this._contextView.node.active = !0, this._contextView.reset());
      }, e.prototype.closeRank2 = function (t) {
        c.default.log("-----------closeRank2---------------"), this.hasContextView() && (a.default.postMessage("closeRank2"), this._contextView.node.active = !1, t.removeChild(this._contextView.node, !0));
      }, e.prototype.closeView = function () {
        this._contextView && (this._contextView.node.active = !1);
      }, n = r([u], e);
    }(cc.Component));n.default = f, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/Logger": "Logger", "../../Common/Sdks/GameSDK": "GameSDK" }], SysConfig: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "34f892YQsVBxaWaNWDq05mg", "SysConfig"), Object.defineProperty(n, "__esModule", { value: !0 });var o = t("../Core/GameType"),
        i = function () {
      function t() {}return t.ID = "201", t.NAME = "dash", t.SERVER_HOSTS = ["https://rane.jwetech.com:8080/", "https://rane.jwetech.com:9080/"], t.SOCKET_HOST = "wss://rane.jwetech.com:9081", t.CENTER_HOST = "https://dev.h58game.com:8101/invoke", t.LOGIN_URL = "/login/login", t.LOGOUT_URL = "/login/logout", t.CLIENT_KEY = "472770f9e581cffb09349f422af57c5d", t.SDK = o.SdkType.DEFAULT, t.DEBUG = !1, t.QQ_VIP_URL = "https://club.vip.qq.com/index?_wv=16778247&_wwv=68&_nav_bgclr=ffffff&_nav_titleclr=ffffff&_nav_txtclr=ffffff&_nav_alpha=0&pay_src=10&_wvx=10&_proxy=1&trace_detail=base64-eyJhcHBpZCI6InZhYl9jb21tIiwicGFnZV9pZCI6IjU5OSIsIml0ZW1faWQiOiI0MTQwMzEiLCJpdGVtX3R5cGUiOiI1In0=&h5costreport=1", t.QQ_20_URL = "https://club.vip.qq.com/vip20main?_wv=16777218&_wwv=8192&_proxy=1&from=vipcenter", t.QQ_20_URL_IOS = "https://club.vip.qq.com/vip20main?_wv=16777218&_wwv=8192&_proxy=1&from=vipcenter", t.DKQ_USE_URL = "https://h5.vip.qq.com/p/pay/wallet?aid=mvip.p.dx.vip_rexqc&channel=mqq", t.B_URL = "https://club.vip.qq.com/vip20rebate/bili?_proxy=1&_wwv=68&_wv=16777221", t.QQ_MUSIC_URL = "https://act.qzone.qq.com/vip/meteor/blockly/p/5897x550f2?_proxy=1&_wwv=68&_wv=16777221", t.QQ_VIDEO_URL = "https://act.qzone.qq.com/vip/meteor/blockly/p/5628x596a0?_proxy=1&_wwv=68&_wv=16777221", t;
    }();n.default = i, cc._RF.pop();
  }, { "../Core/GameType": "GameType" }], TcpBuffer: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "5dfaazTI1JDGoKpB5iYv2FX", "TcpBuffer"), Object.defineProperty(n, "__esModule", { value: !0 });var o = t("../../../Common/Core/ByteArray"),
        i = t("../msgpack/MsgPack"),
        r = function () {
      function t() {}return t.test01 = function (e, n, o) {
        var i = ((o & e) + (n ^ e)) % 255;t._keys.clear(), t._keys.position = 0;for (var r = 0; r < o; r++) {
          e -= (i * o ^ n) % 255, n -= i, i = e % 255, t._keys.writeByte(255 & i);
        }return t._keys.position = 0, t._keys;
      }, t.test02 = function (e, n, o, i) {
        for (var r = t.test01(e, n, o), a = 0; a < o; a++) {
          if (a < i.length) {
            var s = i.readByte(),
                c = r.readByte();i.position -= 1, i.writeByte(255 & (s ^ c));
          }
        }i.position = 0;
      }, t.test03 = function (e, n, o) {
        return t._body.clear(), t._body.position = 0, t._buff.clear(), t._buff.position = 0, i.default.write(o, t._body), t.test02(e, n, t._body.length, t._body), t._buff.writeInt(t._body.length + 9), t._buff.writeInt(e), t._buff.writeInt(n), t._buff.writeByte(0), t._buff.writeBytes(t._body, 0, t._body.length), t._buff;
      }, t.test04 = function (e) {
        e.position = 0, e.readInt();var n = e.readInt(),
            r = e.readInt(),
            a = e.readByte();if (t._body.clear(), t._body.position = 0, e.readBytes(t._body, 0), 1 == a) {
          var s = new Zlib.Inflate(new Uint8Array(t._body.buffer)).decompress();t._body = new o.default(new Uint8Array(s).buffer);
        }return t.test02(n, r, t._body.length, t._body), { cmd: n, stamp: r, body: i.default.read(t._body) };
      }, t._keys = new o.default(), t._body = new o.default(), t._buff = new o.default(), t;
    }();n.default = r, cc._RF.pop();
  }, { "../../../Common/Core/ByteArray": "ByteArray", "../msgpack/MsgPack": "MsgPack" }], TextConfigNode: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "387d1pS3IVJ65PcMu8XOwzy", "TextConfigNode"), Object.defineProperty(n, "__esModule", { value: !0 });var o = function () {
      function t(t, e, n) {
        for (var o in this._attributes = {}, t) {
          var i = t[o];this._attributes[o] = this.getValue(i, e, n);
        }
      }return Object.defineProperty(t.prototype, "attributes", { get: function get() {
          return this._attributes;
        }, enumerable: !1, configurable: !0 }), t.prototype.getValue = function (t, e, n) {
        if (t >= 0) {
          var o = e[t],
              i = n[t],
              r = parseFloat(i);if (o.indexOf("Array") >= 0) return this.convertArray(o, i);switch (o) {case "int":case "num":case "float":
              return isNaN(r) ? 0 : r;case "bool":case "boolean":
              return r > 0;case "string":
              return i;case "vec2":case "Vec2":case "cc.vec2":case "cc.Vec2":
              return this.convertVec2(i);case "vec3":case "Vec3":case "cc.vec3":case "cc.Vec3":
              return this.convertVec3(i);case "size":case "Size":case "cc.size":case "cc.Size":
              return this.convertSize(i);default:
              return isNaN(r) ? i : r;}
        }return i;
      }, t.prototype.convertArray = function (t, e) {
        void 0 === e && (e = "");var n = t.indexOf("<"),
            o = t.lastIndexOf(">"),
            i = t.substring(n + 1, o);if (-1 != i.indexOf("Array")) {
          var r;switch (n = i.indexOf("<"), o = i.lastIndexOf(">"), i = i.substring(n + 1, o)) {case "int":
              r = this.convertIntArray;break;case "float":case "num":
              r = this.convertNumberArray;break;case "bool":case "boolean":
              r = this.convertBooleanArray;break;default:
              r = this.convertStringArray;}for (var a = e.split(","), s = [], c = 0; c < a.length; c++) {
            var l = r(a[c], "|");s.push(l);
          }return s;
        }switch (i) {case "int":
            return this.convertIntArray(e);case "float":case "num":
            return this.convertNumberArray(e);case "bool":case "boolean":
            return this.convertBooleanArray(e);case "vec2":case "Vec2":case "cc.vec2":case "cc.Vec2":
            return this.convertVec2Array(e);case "vec3":case "Vec3":case "cc.vec3":case "cc.Vec3":
            return this.convertVec3Array(e);case "size":case "Size":case "cc.size":case "cc.Size":
            return this.convertSizeArray(e);}return this.convertStringArray(e);
      }, t.prototype.convertVec2 = function (t, e) {
        void 0 === e && (e = ",");var n = t.split(e);return n.length >= 2 ? cc.v2(parseFloat(n[0]), parseFloat(n[1])) : cc.v2();
      }, t.prototype.convertVec3 = function (t, e) {
        void 0 === e && (e = ",");var n = t.split(e);return n.length >= 3 ? cc.v3(parseFloat(n[0]), parseFloat(n[1]), parseFloat(n[2])) : cc.v3();
      }, t.prototype.convertSize = function (t, e) {
        void 0 === e && (e = ",");var n = t.split(e);return n.length >= 2 ? cc.size(parseFloat(n[0]), parseFloat(n[1])) : cc.size(0, 0);
      }, t.prototype.convertNumberArray = function (t, e) {
        void 0 === e && (e = ",");for (var n = t.split(e), o = [], i = 0; i < n.length; i++) {
          o.push(parseFloat(n[i]));
        }return o;
      }, t.prototype.convertIntArray = function (t, e) {
        void 0 === e && (e = ",");for (var n = t.split(e), o = [], i = 0; i < n.length; i++) {
          o.push(parseInt(n[i]));
        }return o;
      }, t.prototype.convertBooleanArray = function (t, e) {
        void 0 === e && (e = ",");for (var n = t.split(e), o = [], i = 0; i < n.length; i++) {
          o.push(parseInt(n[i]) > 0);
        }return o;
      }, t.prototype.convertStringArray = function (t, e) {
        return void 0 === e && (e = ","), t.split(e);
      }, t.prototype.convertVec2Array = function (t, e, n) {
        void 0 === e && (e = ","), void 0 === n && (n = "|");for (var o, i = t.split(e), r = [], a = 0; a < i.length; a++) {
          (o = i[a].split(n)).length >= 2 && r.push(cc.v2(parseFloat(o[0]), parseFloat(o[1])));
        }return r;
      }, t.prototype.convertVec3Array = function (t, e, n) {
        void 0 === e && (e = ","), void 0 === n && (n = "|");for (var o, i = t.split(e), r = [], a = 0; a < i.length; a++) {
          (o = i[a].split(n)).length >= 3 && r.push(cc.v3(parseFloat(o[0]), parseFloat(o[1]), parseFloat(o[2])));
        }return r;
      }, t.prototype.convertSizeArray = function (t, e, n) {
        void 0 === e && (e = ","), void 0 === n && (n = "|");for (var o, i = t.split(e), r = [], a = 0; a < i.length; a++) {
          (o = i[a].split(n)).length >= 2 && r.push(cc.size(parseFloat(o[0]), parseFloat(o[1])));
        }return r;
      }, t;
    }();n.default = o, cc._RF.pop();
  }, {}], TextConfigRead: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "acdecLs7i9EU48J7uwOvTya", "TextConfigRead"), Object.defineProperty(n, "__esModule", { value: !0 });var o = t("./TextConfigNode"),
        i = function () {
      function t(t, e) {
        void 0 === e && (e = !0), this.read(t, e);
      }return t.getNewlineSymbol = function (e) {
        for (var n = 0; n < t.NewlineCharacter.length; n++) {
          if (-1 != e.indexOf(t.NewlineCharacter[n])) return t.NewlineCharacter[n];
        }return null;
      }, t.prototype.read = function (t, e) {
        if (void 0 === e && (e = !0), this._names = {}, this._types = [], this._children = [], null != t) {
          var n,
              i = t.split("\r\n"),
              r = 0;if (i.length > 0) {
            if (n = i[r++].split("\t"), e) {
              for (var a = 0; a < n.length; a++) {
                this._names[n[a]] = a;
              }var s = i[r++];s && (this._types = s.split("\t"));
            } else this._types = i;for (a = r; a < i.length; a++) {
              this._children.push(new o.default(this._names, this._types, i[a].split("\t")));
            }
          }
        }
      }, Object.defineProperty(t.prototype, "children", { get: function get() {
          return this._children;
        }, enumerable: !1, configurable: !0 }), t.prototype.dispose = function () {
        this._names = null, this._types.length = 0, this._types = null, this._children.length = 0, this._children = null;
      }, t.NewlineCharacter = ["\r\n", "\n", "\r"], t;
    }();n.default = i, cc._RF.pop();
  }, { "./TextConfigNode": "TextConfigNode" }], TimeManager: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "c5012TBLYZMq6jl48HAm4KO", "TimeManager"), Object.defineProperty(n, "__esModule", { value: !0 });var o = t("./GlobalEventManager"),
        i = t("../Core/GameType"),
        r = function () {
      function t(t, e, n, o) {
        void 0 === n && (n = 0), void 0 === o && (o = -1), this._time = 0, this._func = t, this._owner = e, this._delay = n, this._repeat = o;
      }return t.prototype.update = function (t) {
        0 != this._repeat && (this._time += t, this._time >= this.delay && (this._time = 0, this._func.call(this._owner, Math.max(t, this._delay)), this._repeat > 0 && this._repeat--));
      }, Object.defineProperty(t.prototype, "finshed", { get: function get() {
          return 0 == this._repeat;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "time", { get: function get() {
          return this._time;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "owner", { get: function get() {
          return this._owner;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "func", { get: function get() {
          return this._func;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "delay", { get: function get() {
          return this._delay;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "repeat", { get: function get() {
          return this._repeat;
        }, enumerable: !1, configurable: !0 }), t;
    }(),
        a = function () {
      function t() {}return t.start = function () {
        null == t._interval && (t._localTime = Date.now(), t._interval = setInterval(t.update, t.DELAYTIME));
      }, t.stop = function () {
        t._interval && (t._localTime = Date.now(), clearInterval(t._interval), t._interval = null, t._adds = [], t._remvoes = [], t._times = []);
      }, Object.defineProperty(t, "delayTime", { get: function get() {
          return t._delayTime;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t, "localTime", { get: function get() {
          return t._localTime;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t, "serverTime", { get: function get() {
          return this._severTime ? this._severTime + (t.localTime - this._upServerTime) : t._localTime;
        }, enumerable: !1, configurable: !0 }), t.checkNewDay = function () {
        if (t._serverDate) {
          var e = t.serverTime;if (e >= t._checkNewDayTime) {
            var n = new Date(e);if (t._checkNewDayTime = e + t.CHECKDAYTIME, n.getDate() - t._serverDate.getDate() > 0) return t._serverDate = n, !0;
          }
        }return !1;
      }, t.update = function () {
        if (t._interval) {
          var e = Date.now(),
              n = e - t._localTime;Math.abs(n) < 2e3 && (t._delayTime = n, t.onUpdate(n)), t._localTime = e;
        }
      }, t.onUpdate = function (e) {
        t._remove(), t._add();for (var n = 0; n < t._times.length; n++) {
          var r = t._times[n];r && (r.update(e), r.finshed && this.remove(r.func, r.owner));
        }t.checkNewDay() && o.default.dispatchEvent(i.GlobalEvent.EVENT_NEW_DAY);
      }, t.add = function (e, n, o, i) {
        void 0 === o && (o = 0), void 0 === i && (i = -1), n && e && t._adds.push(new r(e, n, o, i));
      }, t.remove = function (e, n) {
        if (n && e) {
          var o = { owner: n, func: e };t._remvoes.push(o);
        }
      }, t.removeTarget = function (e) {
        if (e) {
          var n = { owner: e };t._remvoes.push(n);
        }
      }, t._findFunc = function (e) {
        if (e) for (var n = 0; n < t._times.length; n++) {
          var o = t._times[n];if (e.owner == o.owner && (null == e.func || null != e.func && e.func == o.func)) return n;
        }return -1;
      }, t._add = function () {
        if (t._adds.length > 0) {
          for (var e = 0; e < t._adds.length; e++) {
            var n = t._adds[e];-1 == t._findFunc(n) && t._times.push(n);
          }t._adds = [];
        }
      }, t._remove = function () {
        if (t._remvoes.length > 0) {
          for (var e = 0; e < t._remvoes.length; e++) {
            var n = t._remvoes[e],
                o = t._findFunc(n);o > -1 && t._times.splice(o, 1);
          }t._remvoes = [];
        }
      }, t.upServerTime = function (e) {
        t._upServerTime = Date.now(), t._severTime = e, t._serverDate = new Date(e), t._checkNewDayTime = t.serverTime + t.CHECKDAYTIME;
      }, t.isCurrentDay = function (e) {
        if (0 == e) return !1;var n = new Date(t.serverTime),
            o = new Date(e);return n.getFullYear() == o.getFullYear() && n.getMonth() == o.getMonth() && n.getDay() == o.getDay();
      }, t.timeToInt = function (t) {
        return 1e4 * t.getFullYear() + 100 * (t.getMonth() + 1) + t.getDate();
      }, t.FRAME_RATE = 60, t.DELAYTIME = 1e3 / t.FRAME_RATE, t.CHECKDAYTIME = 5e3, t._localTime = 0, t._delayTime = 0, t._adds = [], t._remvoes = [], t._times = [], t;
    }();n.default = a, cc._RF.pop();
  }, { "../Core/GameType": "GameType", "./GlobalEventManager": "GlobalEventManager" }], UIExchangeLog: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "862ddOH8eBBypo/vDDfu5hV", "UIExchangeLog");var _o85,
        i = this && this.__extends || (_o85 = function o(t, e) {
      return (_o85 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o85(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/Util/ComponentUtil"),
        s = cc._decorator,
        c = s.ccclass,
        l = (s.property, function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), e.prototype.onLoad = function () {
        this.lb_time = a.default.getComponent(cc.Label, this.node, "lb_time"), this.lb_item = a.default.getComponent(cc.Label, this.node, "lb_item");
      }, e.prototype.onEnable = function () {
        this.refresh();
      }, e.prototype.onDisable = function () {}, e.prototype.onDestroy = function () {}, Object.defineProperty(e.prototype, "data", { get: function get() {
          return this._data;
        }, set: function set(t) {
          this._data = t;
        }, enumerable: !1, configurable: !0 }), e.prototype.refresh = function () {
        this._data && (this.lb_time.string = this._data.t, this.lb_item.string = this._data.item_name);
      }, r([c], e);
    }(cc.Component));n.default = l, cc._RF.pop();
  }, { "../../Common/Util/ComponentUtil": "ComponentUtil" }], UIExchange: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "a56afbRWvNGzrs9Lxh3dDWS", "UIExchange");var _o86,
        i = this && this.__extends || (_o86 = function o(t, e) {
      return (_o86 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o86(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/Util/ComponentUtil"),
        s = t("../../Common/Manager/MusicManager"),
        c = t("../../Common/UI/UIManager"),
        l = t("../../Common/Manager/LoadResManager"),
        u = t("./ItemMessageTips"),
        f = t("../Config/ProductConfig"),
        d = cc._decorator,
        h = d.ccclass,
        p = (d.property, function (t) {
      function e() {
        var e = null !== t && t.apply(this, arguments) || this;return e._useCount = 0, e;
      }return i(e, t), e.prototype.onLoad = function () {
        this.lb_name = a.default.getComponent(cc.Label, this.node, "lb_name"), this.sp_floor = a.default.getComponent(cc.Sprite, this.node, "sp_floor"), this.sp_icon = a.default.getComponent(cc.Sprite, this.node, "sp_floor/sp_icon"), this.sp_limit = a.default.getComponent(cc.Sprite, this.node, "sp_floor/sp_limit"), this.lb_gift = a.default.getComponent(cc.Label, this.node, "lb_gift"), this.btn_exchange = a.default.getComponent(cc.Button, this.node, "btn_exchange"), this.btn_exchange.node.on(cc.Node.EventType.TOUCH_END, this.onTouchHandler, this), this.lb_remain = a.default.getComponent(cc.Label, this.node, "lb_remain"), this.node.on(cc.Node.EventType.TOUCH_END, this.onTouchHandler, this);
      }, e.prototype.onEnable = function () {
        this.refresh();
      }, e.prototype.onDisable = function () {}, e.prototype.onDestroy = function () {
        this.btn_exchange.node.targetOff(this), this.node.targetOff(this), this._exchange = null;
      }, Object.defineProperty(e.prototype, "exchange", { get: function get() {
          return this._exchange;
        }, set: function set(t) {
          this._exchange = t;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "useCount", { get: function get() {
          return this._useCount;
        }, set: function set(t) {
          this._useCount = t;
        }, enumerable: !1, configurable: !0 }), e.prototype.getRemain = function () {
        var t = this.exchange.total - this._useCount;return t < 0 ? 0 : t;
      }, e.prototype.refresh = function () {
        if (this._exchange) {
          var t = f.default.ins.getItem(this._exchange.id);l.default.loadSprite(this.sp_icon, "Atlas/atlas_item/" + t.icon), this.lb_name.string = t.name, this.lb_gift.string = this.exchange.giftCoupon + "\u5956\u5238", 2 == this._exchange.type ? (this.sp_limit.node.active = !0, this.lb_remain.node.active = !0, this.lb_remain.string = "\u603B\u5269\u4F59\uFF1A" + this.getRemain().toString()) : 1 == this._exchange.type ? (this.sp_limit.node.active = !0, this.lb_remain.node.active = !0, this.lb_remain.string = "\u4ECA\u65E5\u5269\u4F59\uFF1A" + this.getRemain().toString()) : (this.sp_limit.node.active = !1, this.lb_remain.node.active = !1);var e = a.default.getComponent(cc.Sprite, this.btn_exchange.node, "Background");0 == this.exchange.total || this.getRemain() > 0 ? (l.default.loadSprite(e, "Atlas/atlas_lottery/gift_btn_dh"), this.btn_exchange.interactable = !0) : (l.default.loadSprite(e, "Atlas/atlas_lottery/gift_btn_dh_disab"), this.btn_exchange.interactable = !1);
        }
      }, e.prototype.onTouchHandler = function () {
        s.default.playEffect(s.default.CLICK), c.default.show(u.default, { UIExchange: this });
      }, e.prototype.useCountChange = function (t) {
        this.useCount = t, this.refresh();
      }, r([h], e);
    }(cc.Component));n.default = p, cc._RF.pop();
  }, { "../../Common/Manager/LoadResManager": "LoadResManager", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/UI/UIManager": "UIManager", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Config/ProductConfig": "ProductConfig", "./ItemMessageTips": "ItemMessageTips" }], UIItem: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "e5173v0tcdLHY01i5FoioI5", "UIItem"), Object.defineProperty(n, "__esModule", { value: !0 });var o = function () {
      function t(t, e) {
        void 0 === e && (e = null), this.node = t, this.data = e, this.node.active = !0, this.init();
      }return t.prototype.init = function () {}, Object.defineProperty(t.prototype, "active", { get: function get() {
          return this.node.active;
        }, set: function set(t) {
          this.node.active = t;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "x", { get: function get() {
          return this.node.x;
        }, set: function set(t) {
          this.node.x = t;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(t.prototype, "y", { get: function get() {
          return this.node.y;
        }, set: function set(t) {
          this.node.y = t;
        }, enumerable: !1, configurable: !0 }), t.prototype.destroy = function () {
        this.node = null;
      }, t;
    }();n.default = o, cc._RF.pop();
  }, {}], UILottery: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "44201RD5QZHIqrGAGBumq9K", "UILottery");var _o87,
        i = this && this.__extends || (_o87 = function o(t, e) {
      return (_o87 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o87(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../Common/Util/ComponentUtil"),
        s = t("../../Common/Manager/LoadResManager"),
        c = t("../../Common/Sdks/GameSDK"),
        l = cc._decorator,
        u = l.ccclass,
        f = (l.property, function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), e.prototype.onLoad = function () {
        this.sp_select = a.default.getComponent(cc.Sprite, this.node, "sp_select"), this.sp_icon = a.default.getComponent(cc.Sprite, this.node, "sp_icon");
      }, e.prototype.onEnable = function () {
        this._productData && (106 == this._productData.id && c.default.isIos() ? s.default.loadSprite(this.sp_icon, "Atlas/atlas_item/" + this._productData.icon + "_ios") : s.default.loadSprite(this.sp_icon, "Atlas/atlas_item/" + this._productData.icon));
      }, e.prototype.onDisable = function () {}, Object.defineProperty(e.prototype, "id", { get: function get() {
          return this._id;
        }, set: function set(t) {
          this._id = t;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "productData", { get: function get() {
          return this._productData;
        }, set: function set(t) {
          this._productData = t, this.sp_icon && s.default.loadSprite(this.sp_icon, "Atlas/atlas_item/" + this._productData.icon);
        }, enumerable: !1, configurable: !0 }), r([u], e);
    }(cc.Component));n.default = f, cc._RF.pop();
  }, { "../../Common/Manager/LoadResManager": "LoadResManager", "../../Common/Sdks/GameSDK": "GameSDK", "../../Common/Util/ComponentUtil": "ComponentUtil" }], UIManager: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "9ce19ZnaYdBFKyn/nlrZ870", "UIManager"), Object.defineProperty(n, "__esModule", { value: !0 });var o = t("../Core/GameType"),
        i = t("../Util/ComponentUtil"),
        r = function () {
      function t() {}return t.init = function (e) {
        if (void 0 === e && (e = null), null == t.node) for (var n in t.uiLayers = [], t.node = new cc.Node(), o.UILayerType) {
          if ("string" == typeof n && !isNaN(parseInt(n))) {
            var i = new cc.Node();i.name = "UILayerType_" + n, t.node.addChild(i);var r = i.addComponent(cc.Widget);r.alignMode = cc.Widget.AlignMode.ALWAYS, r.isAlignLeft = !0, r.isAlignBottom = !0, r.left = 0, r.bottom = 0, r.target = t.node, i.setContentSize(0, 0), t.uiLayers[parseInt(n)] = i;
          }
        }t.node.parent && (t.node.parent.removeChild(t.node), t.node.parent = null), e && e.addChild(t.node), t.scene = e;var a = cc.view.getFrameSize();this.ASPECT_RATIO = a.height / a.width;
      }, t.remove = function (e) {
        var n = t.getClazzName(e),
            o = t.clazzMap[n];if (o) {
          var i = t.getLayerNode(o.layerType);i && (t.removeLayerChildren(i), i.removeChild(o.node)), t.clazzMap[n] = null, o.close(), o.destroy();
        }
      }, t.isShow = function (e) {
        var n = t.getClazzName(e),
            o = t.clazzMap[n];return !!o && o.isShow;
      }, t.add = function (e, n) {
        t.clazzMap[e] = n;
      }, t.preload = function (e) {
        var n = t.getClazzName(e);null != n && null == t.clazzMap[n] && cc.resources.load("Panel/" + n, null, function (e, o) {
          if (e) cc.error(e.message || e);else if (null == t.clazzMap[n]) {
            var r = cc.instantiate(o),
                a = i.default.getUIPanel(r);t.clazzMap[n] = a;
          }
        });
      }, t.show = function (e, n) {
        void 0 === n && (n = null);var o,
            r = t.getClazzName(e);null != r && (null == t.clazzMap[r] ? cc.resources.load("Panel/" + r, null, function (e, a) {
          if (e) cc.error(e.message || e);else {
            if (null == t.clazzMap[r]) {
              var s = cc.instantiate(a);o = i.default.getUIPanel(s), t.clazzMap[r] = o;
            } else o = t.clazzMap[r];t.addToLayer(o, n);
          }
        }) : (o = t.clazzMap[r], t.addToLayer(o, n)));
      }, t.close = function (e) {
        var n = t.getClazzName(e),
            o = t.clazzMap[n];o && (o.close(), null != o.node.parent && (o.node.parent = null));
      }, t.getClazzName = function (t) {
        return cc.js.getClassName(t);
      }, t.getPanel = function (e) {
        return t.clazzMap[e];
      }, t.addToLayer = function (e, n) {
        if (void 0 === n && (n = null), e && e.node && null == e.node.parent) {
          var o = t.getLayerNode(e.layerType);o && (t.removeLayerChildren(o), o.addChild(e.node), e.show(n));
        }
      }, t.clearLayer = function (e) {
        var n = t.getLayerNode(e);n && t.removeLayerChildren(n);
      }, t.removeLayerChildren = function (e) {
        if (e) {
          var n = e.children;if (n) for (var o, r = 0; r < n.length; r++) {
            (o = i.default.getUIPanel(n[r])) && t.close(o);
          }e.removeAllChildren();
        }
      }, t.getLayerNode = function (e) {
        return t.uiLayers[e];
      }, t.callClazzFunc = function (e, n) {
        for (var o = [], i = 2; i < arguments.length; i++) {
          o[i - 2] = arguments[i];
        }var r = t.getClazzName(e),
            a = t.clazzMap[r];a && a[n] && (o ? o.length > 1 ? a[n](o) : a[n](o[0]) : a[n]());
      }, t.clazzMap = {}, t.ASPECT_RATIO = 1.7, t;
    }();n.default = r, cc._RF.pop();
  }, { "../Core/GameType": "GameType", "../Util/ComponentUtil": "ComponentUtil" }], UIPanel: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "e49a9xtf95LJrznHAlbiN6L", "UIPanel");var _o88,
        i = this && this.__extends || (_o88 = function o(t, e) {
      return (_o88 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o88(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../Core/GameType"),
        s = t("../Core/GameType"),
        c = t("../Manager/GlobalEventManager"),
        l = cc._decorator,
        u = l.ccclass,
        f = (l.property, function (t) {
      function e() {
        var e = t.call(this) || this;return e._isShade = !0, e._isForceShade = !1, e._isInit = !1, e._isShow = !1, e;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return a.UILayerType.MainLayer;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "uiName", { get: function get() {
          return this.node ? this.node.name : this.name;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "isInit", { get: function get() {
          return this._isInit;
        }, enumerable: !1, configurable: !0 }), e.prototype.onLoad = function () {
        var t = cc.view.getVisibleSize();this.node.x = 0, this.node.y = 0, this.node.setContentSize(t.width, t.height);
      }, e.prototype.onEnable = function () {}, Object.defineProperty(e.prototype, "isShow", { get: function get() {
          return this._isInit && this._isShow;
        }, enumerable: !1, configurable: !0 }), Object.defineProperty(e.prototype, "data", { get: function get() {
          return this._data;
        }, enumerable: !1, configurable: !0 }), e.prototype.clearData = function () {
        this._data = null;
      }, e.prototype.start = function () {}, e.prototype.show = function (t) {
        this._data = t, this._isInit ? this.shadeResize() : (this._isInit = !0, this.initShade(), this.onStart()), this._isShow || (this._isShow = !0, this.onShow(), c.default.dispatchEvent(s.UIEvent.EVENT_SHOW, this));
      }, e.prototype.close = function () {
        this._isShow && (this._isShow = !1, this.onClose(), c.default.dispatchEvent(s.UIEvent.EVENT_CLOSE, this));
      }, e.prototype.onStart = function () {}, e.prototype.onShow = function () {}, e.prototype.onClose = function () {}, e.prototype.onDestroy = function () {}, e.prototype.initShade = function () {
        if (this._isForceShade || this._isShade && this.layerType == a.UILayerType.PopLayer) if (null == this._shade) {
          this._shade = new cc.Node(), this.node.insertChild(this._shade, 0), this.node.addComponent(cc.BlockInputEvents);var t = this;cc.resources.load("Atlas/atlas_sub/icon_color", cc.SpriteFrame, function (e, n) {
            var o = t._shade.addComponent(cc.Sprite);o.spriteFrame = n, o.node.color = new cc.Color(0, 0, 0), o.node.opacity = 196, t.shadeResize();
          });
        } else this.shadeResize();
      }, e.prototype.shadeResize = function () {
        this._shade && (this._shade.width = cc.view.getVisibleSize().width, this._shade.height = cc.view.getVisibleSize().height);
      }, r([u], e);
    }(cc.Component));n.default = f, cc._RF.pop();
  }, { "../Core/GameType": "GameType", "../Manager/GlobalEventManager": "GlobalEventManager" }], UmaTrackHelper: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "d0dcfhdWyVD4aKesXHXA6L2", "UmaTrackHelper"), Object.defineProperty(n, "__esModule", { value: !0 });var o = t("./GameSDK"),
        i = t("../Core/GameType"),
        r = function () {
      function t() {}return t.trackEvent = function (t) {
        o.default.sdkId == i.SdkType.QQ && qq.uma.trackEvent(t);
      }, t.exchange = function (e) {
        switch (e) {case 201:
            t.trackEvent("1206");break;case 202:
            t.trackEvent("1207");break;case 203:
            t.trackEvent("1208");break;case 204:
            t.trackEvent("1209");break;case 205:
            t.trackEvent("1210");break;case 206:
            t.trackEvent("1211");break;case 207:
            t.trackEvent("1212");break;case 208:
            t.trackEvent("1213");break;case 209:
            t.trackEvent("1214");break;case 210:
            t.trackEvent("1215");}
      }, t.reviveShow = function (e) {
        0 == e ? t.trackEvent("1302") : 1 == e ? t.trackEvent("1305") : 2 == e && t.trackEvent("1308");
      }, t.reviveClick = function (e) {
        0 == e ? t.trackEvent("1303") : 1 == e ? t.trackEvent("1306") : 2 == e && t.trackEvent("1309");
      }, t.reviveFinish = function (e) {
        0 == e ? t.trackEvent("1304") : 1 == e ? t.trackEvent("1307") : 2 == e && t.trackEvent("1310");
      }, t;
    }();n.default = r, cc._RF.pop();
  }, { "../Core/GameType": "GameType", "./GameSDK": "GameSDK" }], UpgradePropConfirm: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "f7735yxvztK6oCOcWjSJ6rZ", "UpgradePropConfirm");var _o89,
        i = this && this.__extends || (_o89 = function o(t, e) {
      return (_o89 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o89(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 }), n.WatchVideoAdConfirmData = void 0;var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Core/GameType"),
        c = t("../../Common/Util/ComponentUtil"),
        l = t("../../Common/Manager/MusicManager"),
        u = t("../../Common/UI/UIManager"),
        f = t("../Net/GameClient"),
        d = t("../../Common/Sdks/GameSDK"),
        h = t("../Info/ItemsInfo"),
        p = t("../Config/ProductConfig"),
        _ = t("../../Common/Manager/LoadResManager"),
        m = t("../Fb/FbPkMatchPanel"),
        g = cc._decorator,
        y = g.ccclass,
        b = (g.property, function () {});n.WatchVideoAdConfirmData = b;var C = function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return s.UILayerType.SubPopLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.btn_close = c.default.getComponent(cc.Button, this.node, "frame/btn_close"), this.btn_close.node.on(cc.Node.EventType.TOUCH_END, this.onTouchCloseHandler, this), this.btn_ok = c.default.getComponent(cc.Button, this.node, "frame/btn_ok"), this.btn_ok.node.on(cc.Node.EventType.TOUCH_END, this.onTouchOKHandler, this), this.info_label = c.default.getComponent(cc.Label, this.node, "frame/info_label"), this.before_upgrade_icon = c.default.getComponent(cc.Sprite, this.node, "frame/upgrade_node/before_upgrade/icon"), this.before_upgrade_name = c.default.getComponent(cc.Label, this.node, "frame/upgrade_node/before_upgrade/name"), this.after_upgrade_icon = c.default.getComponent(cc.Sprite, this.node, "frame/upgrade_node/after_upgrade/icon"), this.after_upgrade_name = c.default.getComponent(cc.Label, this.node, "frame/upgrade_node/after_upgrade/name");
      }, e.prototype.onShow = function () {
        var t = h.default.ins.getCurrentItemId();console.log("current_use_id", t);var e = p.default.ins.getItem(t),
            n = p.default.ins.getItem(t + 1);console.log("propInfo", e), h.default.current_use_id = t, _.default.loadSprite(this.before_upgrade_icon, "Atlas/atlas_item/" + e.icon), _.default.loadSprite(this.after_upgrade_icon, "Atlas/atlas_item/" + n.icon), this.before_upgrade_name.string = e.name, this.after_upgrade_name.string = n.name, this.info_label.string = "\u672C\u5C40\u643A\u5E26\u9053\u5177\u4E3A" + e.name + "\n\u53EF\u901A\u8FC7\u89C2\u770B\u5E7F\u544A\u5347\u7EA7\u9053\u5177";
      }, e.prototype.onClose = function () {
        f.default.ins.removeAll(this);
      }, e.prototype.onTouchCloseHandler = function () {
        l.default.playEffect(l.default.CLICK), u.default.close(this), u.default.show(m.default);
      }, e.prototype.onTouchOKHandler = function () {
        var t = this;l.default.playEffect(l.default.CLICK), d.default.showVideoAd(function () {
          h.default.current_use_id += 1, u.default.close(t), u.default.show(m.default);
        }, this, s.VideoAdType.ItemUpgrade);
      }, e.prototype.answerRePlay = function (t) {
        f.default.ins.send(529, { rid: this.data.rid, agree: t });
      }, e.prototype.cmd0x0211Handler = function (t) {
        t.isError || (t.body, u.default.close(this));
      }, e.prototype.onDestroy = function () {
        this.btn_close.node.targetOff(this), this.btn_ok.node.targetOff(this), t.prototype.onDestroy.call(this);
      }, r([y], e);
    }(a.default);n.default = C, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/LoadResManager": "LoadResManager", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/Sdks/GameSDK": "GameSDK", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Config/ProductConfig": "ProductConfig", "../Fb/FbPkMatchPanel": "FbPkMatchPanel", "../Info/ItemsInfo": "ItemsInfo", "../Net/GameClient": "GameClient" }], Vec3Util: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "e4e8fMz0VJN6ZLypXDl2Q0x", "Vec3Util"), Object.defineProperty(n, "__esModule", { value: !0 });var o = function () {
      function t() {}return t.add = function (t, e, n) {
        void 0 === n && (n = null);var o = n || cc.v3();return cc.Vec3.add(o, t, e);
      }, t.subtract = function (t, e, n) {
        void 0 === n && (n = null);var o = n || cc.v3();return cc.Vec3.subtract(o, t, e);
      }, t.multiply = function (t, e, n) {
        void 0 === n && (n = null);var o = n || cc.v3();return cc.Vec3.multiply(o, t, e);
      }, t.divide = function (t, e, n) {
        void 0 === n && (n = null);var o = n || cc.v3();return cc.Vec3.divide(o, t, e);
      }, t.ceil = function (t, e) {
        void 0 === e && (e = null);var n = e || cc.v3();return cc.Vec3.ceil(n, t);
      }, t.floor = function (t, e) {
        return void 0 === e && (e = null), e || cc.v3(), cc.Vec3.floor(t, e);
      }, t.min = function (t, e, n) {
        void 0 === n && (n = null);var o = n || cc.v3();return cc.Vec3.min(o, t, e);
      }, t.max = function (t, e, n) {
        void 0 === n && (n = null);var o = n || cc.v3();return cc.Vec3.max(o, t, e);
      }, t.round = function (t, e) {
        void 0 === e && (e = null);var n = e || cc.v3();return cc.Vec3.round(n, t);
      }, t.multiplyScalar = function (t, e, n) {
        void 0 === n && (n = null);var o = n || cc.v3();return cc.Vec3.multiplyScalar(o, t, e);
      }, t.dot = function (t, e, n) {
        return void 0 === n && (n = null), cc.Vec3.dot(t, e);
      }, t.cross = function (t, e, n) {
        void 0 === n && (n = null);var o = n || cc.v3();return cc.Vec3.cross(o, t, e);
      }, t.lerp = function (t, e, n, o) {
        void 0 === o && (o = null);var i = o || cc.v3();return cc.Vec3.lerp(i, t, e, n);
      }, t.random = function (t, e) {
        void 0 === e && (e = null);var n = e || cc.v3();return cc.Vec3.random(n, t);
      }, t;
    }();n.default = o, cc._RF.pop();
  }, {}], WatchVideoAdConfirm: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "3a04dCvgE1Ng5Z2c7J5Xc3m", "WatchVideoAdConfirm");var _o90,
        i = this && this.__extends || (_o90 = function o(t, e) {
      return (_o90 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o90(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 }), n.WatchVideoAdConfirmData = void 0;var a = t("../../Common/UI/UIPanel"),
        s = t("../../Common/Core/GameType"),
        c = t("../../Common/Util/ComponentUtil"),
        l = t("../../Common/Manager/MusicManager"),
        u = t("../../Common/UI/UIManager"),
        f = t("../Net/GameClient"),
        d = cc._decorator,
        h = d.ccclass,
        p = (d.property, function () {});n.WatchVideoAdConfirmData = p;var _ = function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), Object.defineProperty(e.prototype, "layerType", { get: function get() {
          return s.UILayerType.SubPopLayer;
        }, enumerable: !1, configurable: !0 }), e.prototype.onStart = function () {
        this.btn_close = c.default.getComponent(cc.Button, this.node, "frame/btn_close"), this.btn_close.node.on(cc.Node.EventType.TOUCH_END, this.onTouchCloseHandler, this), this.btn_ok = c.default.getComponent(cc.Button, this.node, "frame/btn_ok"), this.btn_ok.node.on(cc.Node.EventType.TOUCH_END, this.onTouchOKHandler, this), this.label_tip_content = c.default.getComponent(cc.Label, this.node, "frame/label_tip_content");
      }, e.prototype.onShow = function () {
        this.label_tip_content.string = this.data.tipText;
      }, e.prototype.onClose = function () {
        f.default.ins.removeAll(this);
      }, e.prototype.onTouchCloseHandler = function () {
        l.default.playEffect(l.default.CLICK), u.default.close(this);
      }, e.prototype.onTouchOKHandler = function () {
        l.default.playEffect(l.default.CLICK), this.data.func(), u.default.close(this);
      }, e.prototype.answerRePlay = function (t) {
        f.default.ins.send(529, { rid: this.data.rid, agree: t });
      }, e.prototype.cmd0x0211Handler = function (t) {
        t.isError || (t.body, u.default.close(this));
      }, e.prototype.onDestroy = function () {
        this.btn_close.node.targetOff(this), this.btn_ok.node.targetOff(this), t.prototype.onDestroy.call(this);
      }, r([h], e);
    }(a.default);n.default = _, cc._RF.pop();
  }, { "../../Common/Core/GameType": "GameType", "../../Common/Manager/MusicManager": "MusicManager", "../../Common/UI/UIManager": "UIManager", "../../Common/UI/UIPanel": "UIPanel", "../../Common/Util/ComponentUtil": "ComponentUtil", "../Net/GameClient": "GameClient" }], WorkerFactory: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "a944ccSbGVEcbLMajoDwnHr", "WorkerFactory"), Object.defineProperty(n, "__esModule", { value: !0 });var o = t("./MsgPackError"),
        i = function () {
      function t(t) {
        this.flags = t, this.workers = new Array();
      }return t.prototype.assign = function (t) {
        if (t) {
          t.factory && t.factory.unassign(t), t.factory = this;var e = this.workers.length;if (0 == e) this.workers.push(t);else {
            for (var n = 0; n < e; n++) {
              if (this.workers[n].priority < t.priority) return void this.workers.splice(n, 0, t);
            }this.workers.push(t);
          }
        }
      }, t.prototype.unassign = function (t) {
        for (var e = this.workers.length, n = 0; n < e; n++) {
          if (this.workers[n] == t) return t.factory = null, this.workers.splice(n, 1)[0];
        }throw new o.default("Worker cannot be unassigned because it hasn't been assigned");
      }, t.prototype.assignAll = function (t) {
        for (; t.length > 0;) {
          this.assign(t.pop());
        }
      }, t.prototype.unassignAll = function () {
        for (var t = new Array(); this.workers.length > 0;) {
          t.push(this.unassign(this.workers[0]));
        }return t;
      }, t.prototype.getWorkerByClass = function (t) {
        for (var e = cc.js.getClassName(t), n = this.workers.length, i = 0; i < n; i++) {
          if (cc.js.getClassName(this.workers[i]) != e) return this.workers[i];
        }throw new o.default("Worker for class '" + e + "' not found");
      }, t.prototype.getWorkerByType = function (t) {
        for (var e = this.workers.length, n = 0; n < e; n++) {
          if (this.workers[n].checkType(t)) return this.workers[n];
        }throw new o.default("Worker for type '" + cc.js.getClassName(t) + "' not found");
      }, t.prototype.getWorkerByByte = function (t) {
        for (var e = this.workers.length, n = 0; n < e; n++) {
          if (this.workers[n].checkByte(t)) return this.workers[n];
        }throw new o.default("Worker for signature 0x" + t.toString(16) + " not found");
      }, t.prototype.checkFlag = function (t) {
        return 0 != (t & this.flags);
      }, t;
    }();n.default = i, cc._RF.pop();
  }, { "./MsgPackError": "MsgPackError" }], WorkerPriority: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "70ee2Y7VhNE+INryoEdsczz", "WorkerPriority"), Object.defineProperty(n, "__esModule", { value: !0 });var o = t("./MsgPackError"),
        i = function () {
      function t() {
        throw new o.default("WorkerPriority cannot be instantiated.");
      }return t.DEFAULT_PRIORITY = -50, t;
    }();n.default = i, cc._RF.pop();
  }, { "./MsgPackError": "MsgPackError" }], achievement_item: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "94f56v7HaZKsLtOt50w4tzy", "achievement_item");var _o91,
        i = this && this.__extends || (_o91 = function o(t, e) {
      return (_o91 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o91(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 }), n.AchievementItemData = void 0;var a = cc._decorator,
        s = a.ccclass,
        c = (a.property, t("../../../Common/Manager/Logger")),
        l = t("../../../Common/Util/ComponentUtil"),
        u = t("../../../Common/Manager/LoadResManager"),
        f = t("../../Manager/CommandController"),
        d = t("../ReceiveGiftTips"),
        h = t("../../../Common/UI/UIManager"),
        p = t("../../Info/PlayerInfo"),
        _ = t("../../../Common/Sdks/GameSDK");n.AchievementItemData = function () {};var m = function (t) {
      function e() {
        return null !== t && t.apply(this, arguments) || this;
      }return i(e, t), e.prototype.onLoad = function () {
        this.icon_bg = l.default.getComponent(cc.Sprite, this.node, "icon_bg"), this.icon = l.default.getComponent(cc.Sprite, this.node, "icon_bg/icon"), this.name_label = l.default.getComponent(cc.Label, this.node, "name_label"), this.points_label = l.default.getComponent(cc.Label, this.node, "points_label"), this.bar = l.default.getComponent(cc.Sprite, this.node, "bar_bg/bar"), this.total_points_label = l.default.getComponent(cc.Label, this.node, "total_points_label"), this.btn_receive_gift = l.default.getComponent(cc.Button, this.node, "btn_receive_gift"), this.gift_icon = l.default.getComponent(cc.Sprite, this.node, "btn_receive_gift/bg/gift_icon"), this.gift_count_label = l.default.getComponent(cc.Label, this.node, "btn_receive_gift/bg/gift_count_label"), this.isCompleted_node = l.default.getNode(this.node, "isCompleted"), this.btn_receive_gift.node.on("touchend", this.onTouchReceiveGiftHandler, this);
      }, e.prototype.start = function () {}, e.prototype.init = function (t) {
        if (this.id = t.id, this.spId = t.spId, this.giftName = t.gift_name, this.giftIcon = t.gift_icon, this.giftCount = t.gift_count, this.finished = t.finished, t.icon_bg && (this.icon_bg.spriteFrame = null), t.icon) {
          var e = "Atlas/atlas_achievement/" + t.icon;u.default.loadSprite(this.icon, e);
        }t.gift_icon && (e = "Atlas/atlas_item/" + t.gift_icon, u.default.loadSprite(this.gift_icon, e)), t.completed ? (this.btn_receive_gift.node.active = !1, this.isCompleted_node.active = !0) : (this.btn_receive_gift.node.active = !0, this.isCompleted_node.active = !1), this.btn_receive_gift.interactable = t.finished, this.name_label.string = t.name_label, this.points_label.string = t.current_points + t.unit, this.total_points_label.string = t.current_points + "/" + t.total_points, this.gift_count_label.string = t.gift_count.toString(), "\u540D" == t.unit ? (this.total_points_label.string = "\u524D" + t.total_points + "\u540D", 0 == t.current_points ? (this.bar.fillRange = 0, this.points_label.string = "\u672A\u4E0A\u699C") : this.bar.fillRange = 2 * t.total_points - t.current_points / t.total_points) : this.bar.fillRange = t.current_points / t.total_points;
      }, e.prototype.onTouchReceiveGiftHandler = function () {
        if (this.finished) {
          f.default.achieveReward(this.id, this.onFinishedReceive, this);var t = { name: this.giftName, icon: this.giftIcon, count: this.giftCount, type: d.ReceiveGiftTipType.ForSign };h.default.show(d.default, t), 1 == this.spId && (p.default.ins.money += this.giftCount), 2 == this.spId && (p.default.ins.giftCoupon += this.giftCount);
        } else _.default.sdk.showToast("\u60A8\u8FD8\u6CA1\u6709\u8FBE\u6210\u8BE5\u6210\u5C31", 1e3);
      }, e.prototype.onFinishedReceive = function () {
        c.default.log("\u6210\u5C31" + this.id + "\u5956\u52B1\u9886\u53D6\u6210\u529F"), cc.game.emit("refreshAchievementList");
      }, r([s], e);
    }(cc.Component);n.default = m, cc._RF.pop();
  }, { "../../../Common/Manager/LoadResManager": "LoadResManager", "../../../Common/Manager/Logger": "Logger", "../../../Common/Sdks/GameSDK": "GameSDK", "../../../Common/UI/UIManager": "UIManager", "../../../Common/Util/ComponentUtil": "ComponentUtil", "../../Info/PlayerInfo": "PlayerInfo", "../../Manager/CommandController": "CommandController", "../ReceiveGiftTips": "ReceiveGiftTips" }], defclass: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "20cd2CTsh9KjIrtrjPLXJaw", "defclass"), Object.defineProperty(n, "__esModule", { value: !0 }), n.defclass = void 0, n.defclass = function (t) {
      var e = cc._RF.peek();e && cc.js.setClassName(e.script, t);
    }, cc._RF.pop();
  }, {}], gamesdks: [function (t, e) {
    "use strict";
    cc._RF.push(e, "e6538DoZw5H9oqjT7BBcHs7", "gamesdks"), cc._RF.pop();
  }, {}], incomplete: [function (t, e) {
    "use strict";
    cc._RF.push(e, "fb32fc1CLpPgqaIKUHSwNwO", "incomplete"), cc._RF.pop();
  }, {}], sign_item: [function (t, e, n) {
    "use strict";
    cc._RF.push(e, "a35093M8uBOhZtUw9EtA0cf", "sign_item");var _o92,
        i = this && this.__extends || (_o92 = function o(t, e) {
      return (_o92 = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) {
        t.__proto__ = e;
      } || function (t, e) {
        for (var n in e) {
          e.hasOwnProperty(n) && (t[n] = e[n]);
        }
      })(t, e);
    }, function (t, e) {
      function n() {
        this.constructor = t;
      }_o92(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n());
    }),
        r = this && this.__decorate || function (t, e, n, o) {
      var i,
          r = arguments.length,
          a = r < 3 ? e : null === o ? o = Object.getOwnPropertyDescriptor(e, n) : o;if ("object" == (typeof Reflect === "undefined" ? "undefined" : _typeof(Reflect)) && "function" == typeof Reflect.decorate) a = Reflect.decorate(t, e, n, o);else for (var s = t.length - 1; s >= 0; s--) {
        (i = t[s]) && (a = (r < 3 ? i(a) : r > 3 ? i(e, n, a) : i(e, n)) || a);
      }return r > 3 && a && Object.defineProperty(e, n, a), a;
    };Object.defineProperty(n, "__esModule", { value: !0 });var a = t("../../../Common/Sdks/UmaTrackHelper"),
        s = t("../../../Common/Manager/Logger"),
        c = t("../../../Common/Util/ComponentUtil"),
        l = t("../../../Common/Manager/LoadResManager"),
        u = t("../../Manager/CommandController"),
        f = t("../../Info/SignInfo"),
        d = t("../../../Common/Sdks/GameSDK"),
        h = t("../../Config/ProductConfig"),
        p = t("../ReceiveGiftTips"),
        _ = t("../../../Common/UI/UIManager"),
        m = t("../../Info/PlayerInfo"),
        g = t("../../Config/SignConfig"),
        y = t("../../../Common/Core/GameType"),
        b = cc._decorator,
        C = b.ccclass,
        v = (b.property, function (t) {
      function e() {
        var e = null !== t && t.apply(this, arguments) || this;return e.weekDays = ["\u4E00", "\u4E8C", "\u4E09", "\u56DB", "\u4E94", "\u516D", "\u65E5"], e;
      }return i(e, t), e.prototype.onLoad = function () {}, e.prototype.start = function () {}, e.prototype.init = function (t) {
        this.sign_list = g.default.ins.getList(), this.days_label = c.default.getComponent(cc.Label, this.node, "bg/days"), this.icon = c.default.getComponent(cc.Sprite, this.node, "bg/icon"), this.name_count = c.default.getComponent(cc.Label, this.node, "bg/name_count"), this.is_got = c.default.getNode(this.node, "is_got"), this.particle = c.default.getNode(this.node, "particle"), this.btn_buqian = c.default.getNode(this.node, "btn_buqian"), this.btn_buqian.on("touchend", this.onBtnBuQianClick, this), this.node.active = !0, this.day = t.days + 1, this.days_label.string = "\u661F\u671F" + this.weekDays[t.days], l.default.loadSprite(this.icon, t.icon), this.name_count.string = t.name_count, this.show_is_got(t.show_is_got), this.show_particle(t.show_particle), this.show_btn_buqian(t.show_btn_buqian);
      }, e.prototype.show_is_got = function (t) {
        this.is_got.active = t;
      }, e.prototype.show_particle = function (t) {
        this.particle.active = t;
      }, e.prototype.show_btn_buqian = function (t) {
        this.btn_buqian.active = t;
      }, e.prototype.onBtnBuQianClick = function () {
        d.default.showVideoAd(function () {
          var t = this;u.default.sign(this.day, 1, !1, function (e) {
            s.default.log("\u8865\u7B7E\u6210\u529F"), s.default.log(e, "\u7B7E\u5230\u6216\u8005\u8865\u7B7E\u8FD4\u56DE\u7684\u6570\u636E"), f.default.ins.init(e), cc.game.emit("SignPanelRefresh");var n = t.sign_list[t.day - 1].spId,
                o = h.default.ins.getItem(n),
                i = o.icon,
                r = o.name,
                c = t.sign_list[t.day - 1].count,
                l = { icon: i, count: c, name: r, type: p.ReceiveGiftTipType.ForSign };_.default.show(p.default, l), 1 == n && (m.default.ins.money += c), 2 == n && (m.default.ins.giftCoupon += c), a.default.trackEvent("1330");
          }, this);
        }, this, y.VideoAdType.Buqian);
      }, r([C], e);
    }(cc.Component));n.default = v, cc._RF.pop();
  }, { "../../../Common/Core/GameType": "GameType", "../../../Common/Manager/LoadResManager": "LoadResManager", "../../../Common/Manager/Logger": "Logger", "../../../Common/Sdks/GameSDK": "GameSDK", "../../../Common/Sdks/UmaTrackHelper": "UmaTrackHelper", "../../../Common/UI/UIManager": "UIManager", "../../../Common/Util/ComponentUtil": "ComponentUtil", "../../Config/ProductConfig": "ProductConfig", "../../Config/SignConfig": "SignConfig", "../../Info/PlayerInfo": "PlayerInfo", "../../Info/SignInfo": "SignInfo", "../../Manager/CommandController": "CommandController", "../ReceiveGiftTips": "ReceiveGiftTips" }] }, {}, ["AbsConfig", "ConfigManager", "ByteArray", "GameType", "NumValue", "NumValueBase64", "TextConfigNode", "TextConfigRead", "defclass", "AbsInfo", "gamesdks", "DataManager", "GameInitManager", "GlobalEventManager", "HostManager", "LoadResManager", "Logger", "MusicManager", "QueuePanelManager", "SysConfig", "TimeManager", "AbstractSDK", "GameSDK", "SdkDefault", "SdkQQ", "UmaTrackHelper", "UIItem", "UIManager", "UIPanel", "Base64", "BufferBigEndian", "BufferUtil", "ByteUtil", "CallBackUtils", "ComponentUtil", "FightUtil", "MD5", "MTween", "MathUtil", "NetUtil", "SHA1", "SHA256", "StringUtil", "Vec3Util", "AchieveConfig", "BaseConfig", "BuffConfig", "GameConfig", "MusicConfig", "ProductConfig", "RlzConfig", "RoleConfig", "ShopConfig", "SignConfig", "AchieveData", "BaseData", "BuffData", "MusicData", "ProductData", "RlzData", "RoleData", "ShopData", "SignData", "AbsDashController", "BuffController", "HeroActor", "HitEffect", "HitSkyEffect", "ItemActor", "MusicController", "ObjectActor", "SingleController", "SportController", "StageActor", "FbEndPanel", "FbPanel", "FbPkInvitePanel", "FbPkMatchPanel", "FbRewardPanel", "GameHeadInfo", "PKHeadInfo", "AddrInfo", "BuffInfo", "FbInfo", "ItemsInfo", "PlayerInfo", "SetInfo", "SignInfo", "ExchangeAddrPanel", "ExchangeConfirm", "ItemMessage", "ItemMessage1", "ItemMessageTips", "LotteryAddrPanel", "LotteryConfirm", "LotteryItemMessage", "LotteryPanel", "MyExchangePanel", "UIExchange", "UIExchangeLog", "UILottery", "AchievementPanel", "ActivePanel", "CoinExchangePanel", "DebugPanel", "ExchangeGiftTips", "FbDogfallPanel", "FbLostPanel", "FbWinPanel", "FeedbackPanel", "LoadingPanel", "MainPanel", "NoticePanel", "RankPanel", "RePlayAnswerConfirm", "ReceiveGiftTips", "ShopPanel", "SignPanel", "SubContextViewController", "UpgradePropConfirm", "WatchVideoAdConfirm", "AbsFbOverPanel", "FbHead", "FbOverHeadInfo", "ProInfoCtr", "achievement_item", "sign_item", "CommandController", "GameManager", "TcpBuffer", "GameClient", "PacketDataEvent", "AbstractWorker", "ArrayWorker", "BinaryWorker", "BooleanWorker", "ExtensionWorker", "MapWorker", "MsgPack", "MsgPackError", "MsgPackFlags", "NullWorker", "NumberWorker", "StringWorker", "WorkerFactory", "WorkerPriority", "incomplete", "GameScene", "MainScene", "GeneralTips"]);
});
define("ccRequire.js", function(require, module, exports){
var moduleMap = {
    'src/assets/Script/Common/Libs/zlib/zlib.min.js': function srcAssetsScriptCommonLibsZlibZlibMinJs() {
        return require('src/assets/Script/Common/Libs/zlib/zlib.min.js');
    },
    'assets/internal/index.js': function assetsInternalIndexJs() {
        return require('assets/internal/index.js');
    },
    'src/scripts/remote/index.js': function srcScriptsRemoteIndexJs() {
        return require('src/scripts/remote/index.js');
    },
    'src/scripts/resources/index.js': function srcScriptsResourcesIndexJs() {
        return require('src/scripts/resources/index.js');
    },
    'assets/main/index.js': function assetsMainIndexJs() {
        return require('assets/main/index.js');
    }
};

window.__cocos_require__ = function (moduleName) {
    var func = moduleMap[moduleName];
    if (!func) {
        throw new Error('cannot find module ' + moduleName);
    }
    return func();
};
});
define("cocos/cocos2d-js-min.js", function(require, module, exports){
(function(t,e,i){function n(i){var r=e[i];if(!r){var a=t[i];if(!a)return;var s={};r=e[i]={exports:s},a[0]((function(t){return n(a[1][t]||t)}),r,s)}return r.exports}for(var r=0;r<i.length;r++)n(i[r])})({1:[(function(t){"use strict";t("../core/platform/CCClass");var e=t("../core/utils/misc");cc.Action=cc.Class({name:"cc.Action",ctor:function(){this.originalTarget=null,this.target=null,this.tag=cc.Action.TAG_INVALID},clone:function(){var t=new cc.Action;return t.originalTarget=null,t.target=null,t.tag=this.tag,t},isDone:function(){return!0},startWithTarget:function(t){this.originalTarget=t,this.target=t},stop:function(){this.target=null},step:function(){cc.logID(1006)},update:function(){cc.logID(1007)},getTarget:function(){return this.target},setTarget:function(t){this.target=t},getOriginalTarget:function(){return this.originalTarget},setOriginalTarget:function(t){this.originalTarget=t},getTag:function(){return this.tag},setTag:function(t){this.tag=t},retain:function(){},release:function(){}}),cc.Action.TAG_INVALID=-1,cc.FiniteTimeAction=cc.Class({name:"cc.FiniteTimeAction",extends:cc.Action,ctor:function(){this._duration=0},getDuration:function(){return this._duration*(this._timesForRepeat||1)},setDuration:function(t){this._duration=t},reverse:function(){return cc.logID(1008),null},clone:function(){return new cc.FiniteTimeAction}}),cc.Speed=cc.Class({name:"cc.Speed",extends:cc.Action,ctor:function(t,e){this._speed=0,this._innerAction=null,t&&this.initWithAction(t,e)},getSpeed:function(){return this._speed},setSpeed:function(t){this._speed=t},initWithAction:function(t,e){return t?(this._innerAction=t,this._speed=e,!0):(cc.errorID(1021),!1)},clone:function(){var t=new cc.Speed;return t.initWithAction(this._innerAction.clone(),this._speed),t},startWithTarget:function(t){cc.Action.prototype.startWithTarget.call(this,t),this._innerAction.startWithTarget(t)},stop:function(){this._innerAction.stop(),cc.Action.prototype.stop.call(this)},step:function(t){this._innerAction.step(t*this._speed)},isDone:function(){return this._innerAction.isDone()},reverse:function(){return new cc.Speed(this._innerAction.reverse(),this._speed)},setInnerAction:function(t){this._innerAction!==t&&(this._innerAction=t)},getInnerAction:function(){return this._innerAction}}),cc.speed=function(t,e){return new cc.Speed(t,e)},cc.Follow=cc.Class({name:"cc.Follow",extends:cc.Action,ctor:function(t,e){this._followedNode=null,this._boundarySet=!1,this._boundaryFullyCovered=!1,this._halfScreenSize=null,this._fullScreenSize=null,this.leftBoundary=0,this.rightBoundary=0,this.topBoundary=0,this.bottomBoundary=0,this._worldRect=cc.rect(0,0,0,0),t&&(e?this.initWithTarget(t,e):this.initWithTarget(t))},clone:function(){var t=new cc.Follow,e=this._worldRect,i=new cc.Rect(e.x,e.y,e.width,e.height);return t.initWithTarget(this._followedNode,i),t},isBoundarySet:function(){return this._boundarySet},setBoudarySet:function(t){this._boundarySet=t},initWithTarget:function(t,e){if(!t)return cc.errorID(1022),!1;e=e||cc.rect(0,0,0,0),this._followedNode=t,this._worldRect=e,this._boundarySet=!(0===e.width&&0===e.height),this._boundaryFullyCovered=!1;var i=cc.winSize;return this._fullScreenSize=cc.v2(i.width,i.height),this._halfScreenSize=this._fullScreenSize.mul(.5),this._boundarySet&&(this.leftBoundary=-(e.x+e.width-this._fullScreenSize.x),this.rightBoundary=-e.x,this.topBoundary=-e.y,this.bottomBoundary=-(e.y+e.height-this._fullScreenSize.y),this.rightBoundary<this.leftBoundary&&(this.rightBoundary=this.leftBoundary=(this.leftBoundary+this.rightBoundary)/2),this.topBoundary<this.bottomBoundary&&(this.topBoundary=this.bottomBoundary=(this.topBoundary+this.bottomBoundary)/2),this.topBoundary===this.bottomBoundary&&this.leftBoundary===this.rightBoundary&&(this._boundaryFullyCovered=!0)),!0},step:function(){var t=this.target.convertToWorldSpaceAR(cc.Vec2.ZERO),i=this._followedNode.convertToWorldSpaceAR(cc.Vec2.ZERO),n=t.sub(i),r=this.target.parent.convertToNodeSpaceAR(n.add(this._halfScreenSize));if(this._boundarySet){if(this._boundaryFullyCovered)return;this.target.setPosition(e.clampf(r.x,this.leftBoundary,this.rightBoundary),e.clampf(r.y,this.bottomBoundary,this.topBoundary))}else this.target.setPosition(r.x,r.y)},isDone:function(){return!this._followedNode.activeInHierarchy},stop:function(){this.target=null,cc.Action.prototype.stop.call(this)}}),cc.follow=function(t,e){return new cc.Follow(t,e)}}),{"../core/platform/CCClass":193,"../core/utils/misc":278}],2:[(function(){"use strict";function t(t,e){return t[Math.min(t.length-1,Math.max(e,0))]}function e(t){for(var e=[],i=t.length-1;i>=0;i--)e.push(cc.v2(t[i].x,t[i].y));return e}function i(t){for(var e=[],i=0;i<t.length;i++)e.push(cc.v2(t[i].x,t[i].y));return e}cc.CardinalSplineTo=cc.Class({name:"cc.CardinalSplineTo",extends:cc.ActionInterval,ctor:function(t,e,i){this._points=[],this._deltaT=0,this._tension=0,this._previousPosition=null,this._accumulatedDiff=null,void 0!==i&&cc.CardinalSplineTo.prototype.initWithDuration.call(this,t,e,i)},initWithDuration:function(t,e,i){return e&&0!==e.length?!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this.setPoints(e),this._tension=i,!0):(cc.errorID(1024),!1)},clone:function(){var t=new cc.CardinalSplineTo;return t.initWithDuration(this._duration,i(this._points),this._tension),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._deltaT=1/(this._points.length-1),this._previousPosition=cc.v2(this.target.x,this.target.y),this._accumulatedDiff=cc.v2(0,0)},update:function(e){var i,n;e=this._computeEaseTime(e);var r=this._points;if(1===e)i=r.length-1,n=1;else{var a=this._deltaT;n=(e-a*(i=0|e/a))/a}var s,o,c,l,u,h,f,d,_,p,m,v,g,y,T,b,E=(s=t(r,i-1),o=t(r,i-0),c=t(r,i+1),l=t(r,i+2),_=(d=(1-this._tension)/2)*(2*(h=(u=n)*u)-(f=h*u)-u),p=d*(-f+h)+(2*f-3*h)+1,m=d*(f-2*h+u)+-2*f+3*h,v=d*(f-h),g=s.x*_+o.x*p+c.x*m+l.x*v,y=s.y*_+o.y*p+c.y*m+l.y*v,cc.v2(g,y));if(cc.macro.ENABLE_STACKABLE_ACTIONS&&(T=this.target.x-this._previousPosition.x,b=this.target.y-this._previousPosition.y,0!==T||0!==b)){var A=this._accumulatedDiff;T=A.x+T,b=A.y+b,A.x=T,A.y=b,E.x+=T,E.y+=b}this.updatePosition(E)},reverse:function(){var t=e(this._points);return cc.cardinalSplineTo(this._duration,t,this._tension)},updatePosition:function(t){this.target.setPosition(t),this._previousPosition=t},getPoints:function(){return this._points},setPoints:function(t){this._points=t}}),cc.cardinalSplineTo=function(t,e,i){return new cc.CardinalSplineTo(t,e,i)},cc.CardinalSplineBy=cc.Class({name:"cc.CardinalSplineBy",extends:cc.CardinalSplineTo,ctor:function(t,e,i){this._startPosition=cc.v2(0,0),void 0!==i&&this.initWithDuration(t,e,i)},startWithTarget:function(t){cc.CardinalSplineTo.prototype.startWithTarget.call(this,t),this._startPosition.x=t.x,this._startPosition.y=t.y},reverse:function(){for(var t,i=this._points.slice(),n=i[0],r=1;r<i.length;++r)t=i[r],i[r]=t.sub(n),n=t;var a=e(i);for(n=a[a.length-1],a.pop(),n.x=-n.x,n.y=-n.y,a.unshift(n),r=1;r<a.length;++r)(t=a[r]).x=-t.x,t.y=-t.y,t.x+=n.x,t.y+=n.y,a[r]=t,n=t;return cc.cardinalSplineBy(this._duration,a,this._tension)},updatePosition:function(t){var e=this._startPosition,i=t.x+e.x,n=t.y+e.y;this._previousPosition.x=i,this._previousPosition.y=n,this.target.setPosition(i,n)},clone:function(){var t=new cc.CardinalSplineBy;return t.initWithDuration(this._duration,i(this._points),this._tension),t}}),cc.cardinalSplineBy=function(t,e,i){return new cc.CardinalSplineBy(t,e,i)},cc.CatmullRomTo=cc.Class({name:"cc.CatmullRomTo",extends:cc.CardinalSplineTo,ctor:function(t,e){e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return cc.CardinalSplineTo.prototype.initWithDuration.call(this,t,e,.5)},clone:function(){var t=new cc.CatmullRomTo;return t.initWithDuration(this._duration,i(this._points)),t}}),cc.catmullRomTo=function(t,e){return new cc.CatmullRomTo(t,e)},cc.CatmullRomBy=cc.Class({name:"cc.CatmullRomBy",extends:cc.CardinalSplineBy,ctor:function(t,e){e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return cc.CardinalSplineTo.prototype.initWithDuration.call(this,t,e,.5)},clone:function(){var t=new cc.CatmullRomBy;return t.initWithDuration(this._duration,i(this._points)),t}}),cc.catmullRomBy=function(t,e){return new cc.CatmullRomBy(t,e)}}),{}],3:[(function(){"use strict";cc.easeIn=function(t){return{_rate:t,easing:function(t){return Math.pow(t,this._rate)},reverse:function(){return cc.easeIn(1/this._rate)}}},cc.easeOut=function(t){return{_rate:t,easing:function(t){return Math.pow(t,1/this._rate)},reverse:function(){return cc.easeOut(1/this._rate)}}},cc.easeInOut=function(t){return{_rate:t,easing:function(t){return(t*=2)<1?.5*Math.pow(t,this._rate):1-.5*Math.pow(2-t,this._rate)},reverse:function(){return cc.easeInOut(this._rate)}}};var t={easing:function(t){return 0===t?0:Math.pow(2,10*(t-1))},reverse:function(){return e}};cc.easeExponentialIn=function(){return t};var e={easing:function(t){return 1===t?1:1-Math.pow(2,-10*t)},reverse:function(){return t}};cc.easeExponentialOut=function(){return e};var i={easing:function(t){return 1!==t&&0!==t?(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1))):t},reverse:function(){return i}};cc.easeExponentialInOut=function(){return i};var n={easing:function(t){return 0===t||1===t?t:-1*Math.cos(t*Math.PI/2)+1},reverse:function(){return r}};cc.easeSineIn=function(){return n};var r={easing:function(t){return 0===t||1===t?t:Math.sin(t*Math.PI/2)},reverse:function(){return n}};cc.easeSineOut=function(){return r};var a={easing:function(t){return 0===t||1===t?t:-.5*(Math.cos(Math.PI*t)-1)},reverse:function(){return a}};cc.easeSineInOut=function(){return a};var s={easing:function(t){return 0===t||1===t?t:(t-=1,-Math.pow(2,10*t)*Math.sin((t-.075)*Math.PI*2/.3))},reverse:function(){return o}};cc.easeElasticIn=function(t){return t&&.3!==t?{_period:t,easing:function(t){return 0===t||1===t?t:(t-=1,-Math.pow(2,10*t)*Math.sin((t-this._period/4)*Math.PI*2/this._period))},reverse:function(){return cc.easeElasticOut(this._period)}}:s};var o={easing:function(t){return 0===t||1===t?t:Math.pow(2,-10*t)*Math.sin((t-.075)*Math.PI*2/.3)+1},reverse:function(){return s}};function c(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}cc.easeElasticOut=function(t){return t&&.3!==t?{_period:t,easing:function(t){return 0===t||1===t?t:Math.pow(2,-10*t)*Math.sin((t-this._period/4)*Math.PI*2/this._period)+1},reverse:function(){return cc.easeElasticIn(this._period)}}:o},cc.easeElasticInOut=function(t){return{_period:t=t||.3,easing:function(t){var e=0,i=this._period;if(0===t||1===t)e=t;else{t*=2,i||(i=this._period=.3*1.5);var n=i/4;e=(t-=1)<0?-.5*Math.pow(2,10*t)*Math.sin((t-n)*Math.PI*2/i):Math.pow(2,-10*t)*Math.sin((t-n)*Math.PI*2/i)*.5+1}return e},reverse:function(){return cc.easeElasticInOut(this._period)}}};var l={easing:function(t){return 1-c(1-t)},reverse:function(){return u}};cc.easeBounceIn=function(){return l};var u={easing:function(t){return c(t)},reverse:function(){return l}};cc.easeBounceOut=function(){return u};var h={easing:function(t){return t<.5?.5*(1-c(1-(t*=2))):.5*c(2*t-1)+.5},reverse:function(){return h}};cc.easeBounceInOut=function(){return h};var f={easing:function(t){return 0===t||1===t?t:t*t*(2.70158*t-1.70158)},reverse:function(){return d}};cc.easeBackIn=function(){return f};var d={easing:function(t){return 0===t?0:(t-=1)*t*(2.70158*t+1.70158)+1},reverse:function(){return f}};cc.easeBackOut=function(){return d};var _={easing:function(t){return(t*=2)<1?t*t*(3.5949095*t-2.5949095)/2:(t-=2)*t*(3.5949095*t+2.5949095)/2+1},reverse:function(){return _}};cc.easeBackInOut=function(){return _},cc.easeBezierAction=function(t,e,i,n){return{easing:function(r){return Math.pow(1-r,3)*t+3*r*Math.pow(1-r,2)*e+3*Math.pow(r,2)*(1-r)*i+Math.pow(r,3)*n},reverse:function(){return cc.easeBezierAction(n,i,e,t)}}};var p={easing:function(t){return Math.pow(t,2)},reverse:function(){return p}};cc.easeQuadraticActionIn=function(){return p};var m={easing:function(t){return-t*(t-2)},reverse:function(){return m}};cc.easeQuadraticActionOut=function(){return m};var v={easing:function(t){return(t*=2)<1?t*t*.5:-.5*(--t*(t-2)-1)},reverse:function(){return v}};cc.easeQuadraticActionInOut=function(){return v};var g={easing:function(t){return t*t*t*t},reverse:function(){return g}};cc.easeQuarticActionIn=function(){return g};var y={easing:function(t){return-((t-=1)*t*t*t-1)},reverse:function(){return y}};cc.easeQuarticActionOut=function(){return y};var T={easing:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},reverse:function(){return T}};cc.easeQuarticActionInOut=function(){return T};var b={easing:function(t){return t*t*t*t*t},reverse:function(){return b}};cc.easeQuinticActionIn=function(){return b};var E={easing:function(t){return(t-=1)*t*t*t*t+1},reverse:function(){return E}};cc.easeQuinticActionOut=function(){return E};var A={easing:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},reverse:function(){return A}};cc.easeQuinticActionInOut=function(){return A};var C={easing:function(t){return-1*(Math.sqrt(1-t*t)-1)},reverse:function(){return C}};cc.easeCircleActionIn=function(){return C};var x={easing:function(t){return t-=1,Math.sqrt(1-t*t)},reverse:function(){return x}};cc.easeCircleActionOut=function(){return x};var S={easing:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):(t-=2,.5*(Math.sqrt(1-t*t)+1))},reverse:function(){return S}};cc.easeCircleActionInOut=function(){return S};var w={easing:function(t){return t*t*t},reverse:function(){return w}};cc.easeCubicActionIn=function(){return w};var M={easing:function(t){return(t-=1)*t*t+1},reverse:function(){return M}};cc.easeCubicActionOut=function(){return M};var R={easing:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},reverse:function(){return R}};cc.easeCubicActionInOut=function(){return R}}),{}],4:[(function(){"use strict";cc.ActionInstant=cc.Class({name:"cc.ActionInstant",extends:cc.FiniteTimeAction,isDone:function(){return!0},step:function(){this.update(1)},update:function(){},reverse:function(){return this.clone()},clone:function(){return new cc.ActionInstant}}),cc.Show=cc.Class({name:"cc.Show",extends:cc.ActionInstant,update:function(){for(var t=this.target.getComponentsInChildren(cc.RenderComponent),e=0;e<t.length;++e)t[e].enabled=!0},reverse:function(){return new cc.Hide},clone:function(){return new cc.Show}}),cc.show=function(){return new cc.Show},cc.Hide=cc.Class({name:"cc.Hide",extends:cc.ActionInstant,update:function(){for(var t=this.target.getComponentsInChildren(cc.RenderComponent),e=0;e<t.length;++e)t[e].enabled=!1},reverse:function(){return new cc.Show},clone:function(){return new cc.Hide}}),cc.hide=function(){return new cc.Hide},cc.ToggleVisibility=cc.Class({name:"cc.ToggleVisibility",extends:cc.ActionInstant,update:function(){for(var t=this.target.getComponentsInChildren(cc.RenderComponent),e=0;e<t.length;++e){var i=t[e];i.enabled=!i.enabled}},reverse:function(){return new cc.ToggleVisibility},clone:function(){return new cc.ToggleVisibility}}),cc.toggleVisibility=function(){return new cc.ToggleVisibility},cc.RemoveSelf=cc.Class({name:"cc.RemoveSelf",extends:cc.ActionInstant,ctor:function(t){this._isNeedCleanUp=!0,void 0!==t&&this.init(t)},update:function(){this.target.removeFromParent(this._isNeedCleanUp)},init:function(t){return this._isNeedCleanUp=t,!0},reverse:function(){return new cc.RemoveSelf(this._isNeedCleanUp)},clone:function(){return new cc.RemoveSelf(this._isNeedCleanUp)}}),cc.removeSelf=function(t){return new cc.RemoveSelf(t)},cc.DestroySelf=cc.Class({name:"cc.DestroySelf",extends:cc.ActionInstant,update:function(){this.target.destroy()},reverse:function(){return new cc.DestroySelf},clone:function(){return new cc.DestroySelf}}),cc.destroySelf=function(){return new cc.DestroySelf},cc.FlipX=cc.Class({name:"cc.FlipX",extends:cc.ActionInstant,ctor:function(t){this._flippedX=!1,void 0!==t&&this.initWithFlipX(t)},initWithFlipX:function(t){return this._flippedX=t,!0},update:function(){this.target.scaleX=Math.abs(this.target.scaleX)*(this._flippedX?-1:1)},reverse:function(){return new cc.FlipX(!this._flippedX)},clone:function(){var t=new cc.FlipX;return t.initWithFlipX(this._flippedX),t}}),cc.flipX=function(t){return new cc.FlipX(t)},cc.FlipY=cc.Class({name:"cc.FlipY",extends:cc.ActionInstant,ctor:function(t){this._flippedY=!1,void 0!==t&&this.initWithFlipY(t)},initWithFlipY:function(t){return this._flippedY=t,!0},update:function(){this.target.scaleY=Math.abs(this.target.scaleY)*(this._flippedY?-1:1)},reverse:function(){return new cc.FlipY(!this._flippedY)},clone:function(){var t=new cc.FlipY;return t.initWithFlipY(this._flippedY),t}}),cc.flipY=function(t){return new cc.FlipY(t)},cc.Place=cc.Class({name:"cc.Place",extends:cc.ActionInstant,ctor:function(t,e){this._x=0,this._y=0,void 0!==t&&(void 0!==t.x&&(e=t.y,t=t.x),this.initWithPosition(t,e))},initWithPosition:function(t,e){return this._x=t,this._y=e,!0},update:function(){this.target.setPosition(this._x,this._y)},clone:function(){var t=new cc.Place;return t.initWithPosition(this._x,this._y),t}}),cc.place=function(t,e){return new cc.Place(t,e)},cc.CallFunc=cc.Class({name:"cc.CallFunc",extends:cc.ActionInstant,ctor:function(t,e,i){this._selectorTarget=null,this._function=null,this._data=null,this.initWithFunction(t,e,i)},initWithFunction:function(t,e,i){return t&&(this._function=t),e&&(this._selectorTarget=e),void 0!==i&&(this._data=i),!0},execute:function(){this._function&&this._function.call(this._selectorTarget,this.target,this._data)},update:function(){this.execute()},getTargetCallback:function(){return this._selectorTarget},setTargetCallback:function(t){t!==this._selectorTarget&&(this._selectorTarget&&(this._selectorTarget=null),this._selectorTarget=t)},clone:function(){var t=new cc.CallFunc;return t.initWithFunction(this._function,this._selectorTarget,this._data),t}}),cc.callFunc=function(t,e,i){return new cc.CallFunc(t,e,i)}}),{}],5:[(function(){"use strict";function t(t,e,i,n,r){return Math.pow(1-r,3)*t+3*r*Math.pow(1-r,2)*e+3*Math.pow(r,2)*(1-r)*i+Math.pow(r,3)*n}cc.ActionInterval=cc.Class({name:"cc.ActionInterval",extends:cc.FiniteTimeAction,ctor:function(t){this.MAX_VALUE=2,this._elapsed=0,this._firstTick=!1,this._easeList=null,this._speed=1,this._timesForRepeat=1,this._repeatForever=!1,this._repeatMethod=!1,this._speedMethod=!1,void 0!==t&&cc.ActionInterval.prototype.initWithDuration.call(this,t)},getElapsed:function(){return this._elapsed},initWithDuration:function(t){return this._duration=0===t?cc.macro.FLT_EPSILON:t,this._elapsed=0,this._firstTick=!0,!0},isDone:function(){return this._elapsed>=this._duration},_cloneDecoration:function(t){t._repeatForever=this._repeatForever,t._speed=this._speed,t._timesForRepeat=this._timesForRepeat,t._easeList=this._easeList,t._speedMethod=this._speedMethod,t._repeatMethod=this._repeatMethod},_reverseEaseList:function(t){if(this._easeList){t._easeList=[];for(var e=0;e<this._easeList.length;e++)t._easeList.push(this._easeList[e].reverse())}},clone:function(){var t=new cc.ActionInterval(this._duration);return this._cloneDecoration(t),t},easing:function(){this._easeList?this._easeList.length=0:this._easeList=[];for(var t=0;t<arguments.length;t++)this._easeList.push(arguments[t]);return this},_computeEaseTime:function(t){var e=this._easeList;if(!e||0===e.length)return t;for(var i=0,n=e.length;i<n;i++)t=e[i].easing(t);return t},step:function(t){this._firstTick?(this._firstTick=!1,this._elapsed=0):this._elapsed+=t;var e=this._elapsed/(this._duration>1.192092896e-7?this._duration:1.192092896e-7);e=1>e?e:1,this.update(e>0?e:0),this._repeatMethod&&this._timesForRepeat>1&&this.isDone()&&(this._repeatForever||this._timesForRepeat--,this.startWithTarget(this.target),this.step(this._elapsed-this._duration))},startWithTarget:function(t){cc.Action.prototype.startWithTarget.call(this,t),this._elapsed=0,this._firstTick=!0},reverse:function(){return cc.logID(1010),null},setAmplitudeRate:function(){cc.logID(1011)},getAmplitudeRate:function(){return cc.logID(1012),0},speed:function(t){return t<=0?(cc.logID(1013),this):(this._speedMethod=!0,this._speed*=t,this)},getSpeed:function(){return this._speed},setSpeed:function(t){return this._speed=t,this},repeat:function(t){return t=Math.round(t),isNaN(t)||t<1?(cc.logID(1014),this):(this._repeatMethod=!0,this._timesForRepeat*=t,this)},repeatForever:function(){return this._repeatMethod=!0,this._timesForRepeat=this.MAX_VALUE,this._repeatForever=!0,this}}),cc.actionInterval=function(t){return new cc.ActionInterval(t)},cc.Sequence=cc.Class({name:"cc.Sequence",extends:cc.ActionInterval,ctor:function(t){this._actions=[],this._split=null,this._last=0,this._reversed=!1;var e=t instanceof Array?t:arguments;if(1!==e.length){var i=e.length-1;if(i>=0&&null==e[i]&&cc.logID(1015),i>=0){for(var n,r=e[0],a=1;a<i;a++)e[a]&&(n=r,r=cc.Sequence._actionOneTwo(n,e[a]));this.initWithTwoActions(r,e[i])}}else cc.errorID(1019)},initWithTwoActions:function(t,e){if(!t||!e)return cc.errorID(1025),!1;var i=t._duration,n=e._duration,r=(i*=t._repeatMethod?t._timesForRepeat:1)+(n*=e._repeatMethod?e._timesForRepeat:1);return this.initWithDuration(r),this._actions[0]=t,this._actions[1]=e,!0},clone:function(){var t=new cc.Sequence;return this._cloneDecoration(t),t.initWithTwoActions(this._actions[0].clone(),this._actions[1].clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._split=this._actions[0]._duration/this._duration,this._split*=this._actions[0]._repeatMethod?this._actions[0]._timesForRepeat:1,this._last=-1},stop:function(){-1!==this._last&&this._actions[this._last].stop(),cc.Action.prototype.stop.call(this)},update:function(t){var e,i,n=0,r=this._split,a=this._actions,s=this._last;(t=this._computeEaseTime(t))<r?(e=0!==r?t/r:1,0===n&&1===s&&this._reversed&&(a[1].update(0),a[1].stop())):(n=1,e=1===r?1:(t-r)/(1-r),-1===s&&(a[0].startWithTarget(this.target),a[0].update(1),a[0].stop()),0===s&&(a[0].update(1),a[0].stop())),i=a[n],s===n&&i.isDone()||(s!==n&&i.startWithTarget(this.target),e*=i._timesForRepeat,i.update(e>1?e%1:e),this._last=n)},reverse:function(){var t=cc.Sequence._actionOneTwo(this._actions[1].reverse(),this._actions[0].reverse());return this._cloneDecoration(t),this._reverseEaseList(t),t._reversed=!0,t}}),cc.sequence=function(t){var e=t instanceof Array?t:arguments;if(1===e.length)return cc.errorID(1019),null;var i=e.length-1;i>=0&&null==e[i]&&cc.logID(1015);var n=null;if(i>=0){n=e[0];for(var r=1;r<=i;r++)e[r]&&(n=cc.Sequence._actionOneTwo(n,e[r]))}return n},cc.Sequence._actionOneTwo=function(t,e){var i=new cc.Sequence;return i.initWithTwoActions(t,e),i},cc.Repeat=cc.Class({name:"cc.Repeat",extends:cc.ActionInterval,ctor:function(t,e){this._times=0,this._total=0,this._nextDt=0,this._actionInstant=!1,this._innerAction=null,void 0!==e&&this.initWithAction(t,e)},initWithAction:function(t,e){var i=t._duration*e;return!!this.initWithDuration(i)&&(this._times=e,this._innerAction=t,t instanceof cc.ActionInstant&&(this._actionInstant=!0,this._times-=1),this._total=0,!0)},clone:function(){var t=new cc.Repeat;return this._cloneDecoration(t),t.initWithAction(this._innerAction.clone(),this._times),t},startWithTarget:function(t){this._total=0,this._nextDt=this._innerAction._duration/this._duration,cc.ActionInterval.prototype.startWithTarget.call(this,t),this._innerAction.startWithTarget(t)},stop:function(){this._innerAction.stop(),cc.Action.prototype.stop.call(this)},update:function(t){t=this._computeEaseTime(t);var e=this._innerAction,i=this._duration,n=this._times,r=this._nextDt;if(t>=r){for(;t>r&&this._total<n;)e.update(1),this._total++,e.stop(),e.startWithTarget(this.target),r+=e._duration/i,this._nextDt=r>1?1:r;t>=1&&this._total<n&&(e.update(1),this._total++),this._actionInstant||(this._total===n?e.stop():e.update(t-(r-e._duration/i)))}else e.update(t*n%1)},isDone:function(){return this._total===this._times},reverse:function(){var t=new cc.Repeat(this._innerAction.reverse(),this._times);return this._cloneDecoration(t),this._reverseEaseList(t),t},setInnerAction:function(t){this._innerAction!==t&&(this._innerAction=t)},getInnerAction:function(){return this._innerAction}}),cc.repeat=function(t,e){return new cc.Repeat(t,e)},cc.RepeatForever=cc.Class({name:"cc.RepeatForever",extends:cc.ActionInterval,ctor:function(t){this._innerAction=null,t&&this.initWithAction(t)},initWithAction:function(t){return t?(this._innerAction=t,!0):(cc.errorID(1026),!1)},clone:function(){var t=new cc.RepeatForever;return this._cloneDecoration(t),t.initWithAction(this._innerAction.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._innerAction.startWithTarget(t)},step:function(t){var e=this._innerAction;e.step(t),e.isDone()&&(e.startWithTarget(this.target),e.step(e.getElapsed()-e._duration))},isDone:function(){return!1},reverse:function(){var t=new cc.RepeatForever(this._innerAction.reverse());return this._cloneDecoration(t),this._reverseEaseList(t),t},setInnerAction:function(t){this._innerAction!==t&&(this._innerAction=t)},getInnerAction:function(){return this._innerAction}}),cc.repeatForever=function(t){return new cc.RepeatForever(t)},cc.Spawn=cc.Class({name:"cc.Spawn",extends:cc.ActionInterval,ctor:function(t){this._one=null,this._two=null;var e=t instanceof Array?t:arguments;if(1!==e.length){var i=e.length-1;if(i>=0&&null==e[i]&&cc.logID(1015),i>=0){for(var n,r=e[0],a=1;a<i;a++)e[a]&&(n=r,r=cc.Spawn._actionOneTwo(n,e[a]));this.initWithTwoActions(r,e[i])}}else cc.errorID(1020)},initWithTwoActions:function(t,e){if(!t||!e)return cc.errorID(1027),!1;var i=!1,n=t._duration,r=e._duration;return this.initWithDuration(Math.max(n,r))&&(this._one=t,this._two=e,n>r?this._two=cc.Sequence._actionOneTwo(e,cc.delayTime(n-r)):n<r&&(this._one=cc.Sequence._actionOneTwo(t,cc.delayTime(r-n))),i=!0),i},clone:function(){var t=new cc.Spawn;return this._cloneDecoration(t),t.initWithTwoActions(this._one.clone(),this._two.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._one.startWithTarget(t),this._two.startWithTarget(t)},stop:function(){this._one.stop(),this._two.stop(),cc.Action.prototype.stop.call(this)},update:function(t){t=this._computeEaseTime(t),this._one&&this._one.update(t),this._two&&this._two.update(t)},reverse:function(){var t=cc.Spawn._actionOneTwo(this._one.reverse(),this._two.reverse());return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.spawn=function(t){var e=t instanceof Array?t:arguments;if(1===e.length)return cc.errorID(1020),null;e.length>0&&null==e[e.length-1]&&cc.logID(1015);for(var i=e[0],n=1;n<e.length;n++)null!=e[n]&&(i=cc.Spawn._actionOneTwo(i,e[n]));return i},cc.Spawn._actionOneTwo=function(t,e){var i=new cc.Spawn;return i.initWithTwoActions(t,e),i},cc.RotateTo=cc.Class({name:"cc.RotateTo",extends:cc.ActionInterval,statics:{_reverse:!1},ctor:function(t,e){this._startAngle=0,this._dstAngle=0,this._angle=0,void 0!==e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._dstAngle=e,!0)},clone:function(){var t=new cc.RotateTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._dstAngle),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.angle%360,i=cc.RotateTo._reverse?this._dstAngle-e:this._dstAngle+e;i>180&&(i-=360),i<-180&&(i+=360),this._startAngle=e,this._angle=cc.RotateTo._reverse?i:-i},reverse:function(){cc.logID(1016)},update:function(t){t=this._computeEaseTime(t),this.target&&(this.target.angle=this._startAngle+this._angle*t)}}),cc.rotateTo=function(t,e){return new cc.RotateTo(t,e)},cc.RotateBy=cc.Class({name:"cc.RotateBy",extends:cc.ActionInterval,statics:{_reverse:!1},ctor:function(t,e){e*=cc.RotateBy._reverse?1:-1,this._deltaAngle=0,this._startAngle=0,void 0!==e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._deltaAngle=e,!0)},clone:function(){var t=new cc.RotateBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._deltaAngle),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._startAngle=t.angle},update:function(t){t=this._computeEaseTime(t),this.target&&(this.target.angle=this._startAngle+this._deltaAngle*t)},reverse:function(){var t=new cc.RotateBy;return t.initWithDuration(this._duration,-this._deltaAngle),this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.rotateBy=function(t,e){return new cc.RotateBy(t,e)},cc.MoveBy=cc.Class({name:"cc.MoveBy",extends:cc.ActionInterval,ctor:function(t,e,i){this._positionDelta=cc.v2(0,0),this._startPosition=cc.v2(0,0),this._previousPosition=cc.v2(0,0),void 0!==e&&cc.MoveBy.prototype.initWithDuration.call(this,t,e,i)},initWithDuration:function(t,e,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(void 0!==e.x&&(i=e.y,e=e.x),this._positionDelta.x=e,this._positionDelta.y=i,!0)},clone:function(){var t=new cc.MoveBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._positionDelta),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.x,i=t.y;this._previousPosition.x=e,this._previousPosition.y=i,this._startPosition.x=e,this._startPosition.y=i},update:function(t){if(t=this._computeEaseTime(t),this.target){var e=this._positionDelta.x*t,i=this._positionDelta.y*t,n=this._startPosition;if(cc.macro.ENABLE_STACKABLE_ACTIONS){var r=this.target.x,a=this.target.y,s=this._previousPosition;n.x=n.x+r-s.x,n.y=n.y+a-s.y,e+=n.x,i+=n.y,s.x=e,s.y=i,this.target.setPosition(e,i)}else this.target.setPosition(n.x+e,n.y+i)}},reverse:function(){var t=new cc.MoveBy(this._duration,cc.v2(-this._positionDelta.x,-this._positionDelta.y));return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.moveBy=function(t,e,i){return new cc.MoveBy(t,e,i)},cc.MoveTo=cc.Class({name:"cc.MoveTo",extends:cc.MoveBy,ctor:function(t,e,i){this._endPosition=cc.v2(0,0),void 0!==e&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){return!!cc.MoveBy.prototype.initWithDuration.call(this,t,e,i)&&(void 0!==e.x&&(i=e.y,e=e.x),this._endPosition.x=e,this._endPosition.y=i,!0)},clone:function(){var t=new cc.MoveTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endPosition),t},startWithTarget:function(t){cc.MoveBy.prototype.startWithTarget.call(this,t),this._positionDelta.x=this._endPosition.x-t.x,this._positionDelta.y=this._endPosition.y-t.y}}),cc.moveTo=function(t,e,i){return new cc.MoveTo(t,e,i)},cc.SkewTo=cc.Class({name:"cc.SkewTo",extends:cc.ActionInterval,ctor:function(t,e,i){this._skewX=0,this._skewY=0,this._startSkewX=0,this._startSkewY=0,this._endSkewX=0,this._endSkewY=0,this._deltaX=0,this._deltaY=0,void 0!==i&&cc.SkewTo.prototype.initWithDuration.call(this,t,e,i)},initWithDuration:function(t,e,i){var n=!1;return cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._endSkewX=e,this._endSkewY=i,n=!0),n},clone:function(){var t=new cc.SkewTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endSkewX,this._endSkewY),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._startSkewX=t.skewX%180,this._deltaX=this._endSkewX-this._startSkewX,this._deltaX>180&&(this._deltaX-=360),this._deltaX<-180&&(this._deltaX+=360),this._startSkewY=t.skewY%360,this._deltaY=this._endSkewY-this._startSkewY,this._deltaY>180&&(this._deltaY-=360),this._deltaY<-180&&(this._deltaY+=360)},update:function(t){t=this._computeEaseTime(t),this.target.skewX=this._startSkewX+this._deltaX*t,this.target.skewY=this._startSkewY+this._deltaY*t}}),cc.skewTo=function(t,e,i){return new cc.SkewTo(t,e,i)},cc.SkewBy=cc.Class({name:"cc.SkewBy",extends:cc.SkewTo,ctor:function(t,e,i){void 0!==i&&this.initWithDuration(t,e,i)},initWithDuration:function(t,e,i){var n=!1;return cc.SkewTo.prototype.initWithDuration.call(this,t,e,i)&&(this._skewX=e,this._skewY=i,n=!0),n},clone:function(){var t=new cc.SkewBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._skewX,this._skewY),t},startWithTarget:function(t){cc.SkewTo.prototype.startWithTarget.call(this,t),this._deltaX=this._skewX,this._deltaY=this._skewY,this._endSkewX=this._startSkewX+this._deltaX,this._endSkewY=this._startSkewY+this._deltaY},reverse:function(){var t=new cc.SkewBy(this._duration,-this._skewX,-this._skewY);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.skewBy=function(t,e,i){return new cc.SkewBy(t,e,i)},cc.JumpBy=cc.Class({name:"cc.JumpBy",extends:cc.ActionInterval,ctor:function(t,e,i,n,r){this._startPosition=cc.v2(0,0),this._previousPosition=cc.v2(0,0),this._delta=cc.v2(0,0),this._height=0,this._jumps=0,void 0!==n&&cc.JumpBy.prototype.initWithDuration.call(this,t,e,i,n,r)},initWithDuration:function(t,e,i,n,r){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(void 0===r&&(r=n,n=i,i=e.y,e=e.x),this._delta.x=e,this._delta.y=i,this._height=n,this._jumps=r,!0)},clone:function(){var t=new cc.JumpBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._delta,this._height,this._jumps),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.x,i=t.y;this._previousPosition.x=e,this._previousPosition.y=i,this._startPosition.x=e,this._startPosition.y=i},update:function(t){if(t=this._computeEaseTime(t),this.target){var e=t*this._jumps%1,i=4*this._height*e*(1-e);i+=this._delta.y*t;var n=this._delta.x*t,r=this._startPosition;if(cc.macro.ENABLE_STACKABLE_ACTIONS){var a=this.target.x,s=this.target.y,o=this._previousPosition;r.x=r.x+a-o.x,r.y=r.y+s-o.y,n+=r.x,i+=r.y,o.x=n,o.y=i,this.target.setPosition(n,i)}else this.target.setPosition(r.x+n,r.y+i)}},reverse:function(){var t=new cc.JumpBy(this._duration,cc.v2(-this._delta.x,-this._delta.y),this._height,this._jumps);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.jumpBy=function(t,e,i,n,r){return new cc.JumpBy(t,e,i,n,r)},cc.JumpTo=cc.Class({name:"cc.JumpTo",extends:cc.JumpBy,ctor:function(t,e,i,n,r){this._endPosition=cc.v2(0,0),void 0!==n&&this.initWithDuration(t,e,i,n,r)},initWithDuration:function(t,e,i,n,r){return!!cc.JumpBy.prototype.initWithDuration.call(this,t,e,i,n,r)&&(void 0===r&&(i=e.y,e=e.x),this._endPosition.x=e,this._endPosition.y=i,!0)},startWithTarget:function(t){cc.JumpBy.prototype.startWithTarget.call(this,t),this._delta.x=this._endPosition.x-this._startPosition.x,this._delta.y=this._endPosition.y-this._startPosition.y},clone:function(){var t=new cc.JumpTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endPosition,this._height,this._jumps),t}}),cc.jumpTo=function(t,e,i,n,r){return new cc.JumpTo(t,e,i,n,r)},cc.BezierBy=cc.Class({name:"cc.BezierBy",extends:cc.ActionInterval,ctor:function(t,e){this._config=[],this._startPosition=cc.v2(0,0),this._previousPosition=cc.v2(0,0),e&&cc.BezierBy.prototype.initWithDuration.call(this,t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._config=e,!0)},clone:function(){var t=new cc.BezierBy;this._cloneDecoration(t);for(var e=[],i=0;i<this._config.length;i++){var n=this._config[i];e.push(cc.v2(n.x,n.y))}return t.initWithDuration(this._duration,e),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.x,i=t.y;this._previousPosition.x=e,this._previousPosition.y=i,this._startPosition.x=e,this._startPosition.y=i},update:function(e){if(e=this._computeEaseTime(e),this.target){var i=this._config,n=i[0].x,r=i[1].x,a=i[2].x,s=i[0].y,o=i[1].y,c=i[2].y,l=t(0,n,r,a,e),u=t(0,s,o,c,e),h=this._startPosition;if(cc.macro.ENABLE_STACKABLE_ACTIONS){var f=this.target.x,d=this.target.y,_=this._previousPosition;h.x=h.x+f-_.x,h.y=h.y+d-_.y,l+=h.x,u+=h.y,_.x=l,_.y=u,this.target.setPosition(l,u)}else this.target.setPosition(h.x+l,h.y+u)}},reverse:function(){var t=this._config,e=t[0].x,i=t[0].y,n=t[1].x,r=t[1].y,a=t[2].x,s=t[2].y,o=[cc.v2(n-a,r-s),cc.v2(e-a,i-s),cc.v2(-a,-s)],c=new cc.BezierBy(this._duration,o);return this._cloneDecoration(c),this._reverseEaseList(c),c}}),cc.bezierBy=function(t,e){return new cc.BezierBy(t,e)},cc.BezierTo=cc.Class({name:"cc.BezierTo",extends:cc.BezierBy,ctor:function(t,e){this._toConfig=[],e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._toConfig=e,!0)},clone:function(){var t=new cc.BezierTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toConfig),t},startWithTarget:function(t){cc.BezierBy.prototype.startWithTarget.call(this,t);var e=this._startPosition,i=this._toConfig,n=this._config;n[0]=i[0].sub(e),n[1]=i[1].sub(e),n[2]=i[2].sub(e)}}),cc.bezierTo=function(t,e){return new cc.BezierTo(t,e)},cc.ScaleTo=cc.Class({name:"cc.ScaleTo",extends:cc.ActionInterval,ctor:function(t,e,i){this._scaleX=1,this._scaleY=1,this._startScaleX=1,this._startScaleY=1,this._endScaleX=0,this._endScaleY=0,this._deltaX=0,this._deltaY=0,void 0!==e&&cc.ScaleTo.prototype.initWithDuration.call(this,t,e,i)},initWithDuration:function(t,e,i){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._endScaleX=e,this._endScaleY=null!=i?i:e,!0)},clone:function(){var t=new cc.ScaleTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endScaleX,this._endScaleY),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._startScaleX=t.scaleX,this._startScaleY=t.scaleY,this._deltaX=this._endScaleX-this._startScaleX,this._deltaY=this._endScaleY-this._startScaleY},update:function(t){t=this._computeEaseTime(t),this.target&&(this.target.scaleX=this._startScaleX+this._deltaX*t,this.target.scaleY=this._startScaleY+this._deltaY*t)}}),cc.scaleTo=function(t,e,i){return new cc.ScaleTo(t,e,i)},cc.ScaleBy=cc.Class({name:"cc.ScaleBy",extends:cc.ScaleTo,startWithTarget:function(t){cc.ScaleTo.prototype.startWithTarget.call(this,t),this._deltaX=this._startScaleX*this._endScaleX-this._startScaleX,this._deltaY=this._startScaleY*this._endScaleY-this._startScaleY},reverse:function(){var t=new cc.ScaleBy(this._duration,1/this._endScaleX,1/this._endScaleY);return this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.ScaleBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._endScaleX,this._endScaleY),t}}),cc.scaleBy=function(t,e,i){return new cc.ScaleBy(t,e,i)},cc.Blink=cc.Class({name:"cc.Blink",extends:cc.ActionInterval,ctor:function(t,e){this._times=0,this._originalState=!1,void 0!==e&&this.initWithDuration(t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._times=e,!0)},clone:function(){var t=new cc.Blink;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._times),t},update:function(t){if(t=this._computeEaseTime(t),this.target&&!this.isDone()){var e=1/this._times,i=t%e;this.target.opacity=i>e/2?255:0}},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._originalState=t.opacity},stop:function(){this.target.opacity=this._originalState,cc.ActionInterval.prototype.stop.call(this)},reverse:function(){var t=new cc.Blink(this._duration,this._times);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.blink=function(t,e){return new cc.Blink(t,e)},cc.FadeTo=cc.Class({name:"cc.FadeTo",extends:cc.ActionInterval,ctor:function(t,e){this._toOpacity=0,this._fromOpacity=0,void 0!==e&&cc.FadeTo.prototype.initWithDuration.call(this,t,e)},initWithDuration:function(t,e){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._toOpacity=e,!0)},clone:function(){var t=new cc.FadeTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toOpacity),t},update:function(t){t=this._computeEaseTime(t);var e=void 0!==this._fromOpacity?this._fromOpacity:255;this.target.opacity=e+(this._toOpacity-e)*t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._fromOpacity=t.opacity}}),cc.fadeTo=function(t,e){return new cc.FadeTo(t,e)},cc.FadeIn=cc.Class({name:"cc.FadeIn",extends:cc.FadeTo,ctor:function(t){null==t&&(t=0),this._reverseAction=null,this.initWithDuration(t,255)},reverse:function(){var t=new cc.FadeOut;return t.initWithDuration(this._duration,0),this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.FadeIn;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toOpacity),t},startWithTarget:function(t){this._reverseAction&&(this._toOpacity=this._reverseAction._fromOpacity),cc.FadeTo.prototype.startWithTarget.call(this,t)}}),cc.fadeIn=function(t){return new cc.FadeIn(t)},cc.FadeOut=cc.Class({name:"cc.FadeOut",extends:cc.FadeTo,ctor:function(t){null==t&&(t=0),this._reverseAction=null,this.initWithDuration(t,0)},reverse:function(){var t=new cc.FadeIn;return t._reverseAction=this,t.initWithDuration(this._duration,255),this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.FadeOut;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._toOpacity),t}}),cc.fadeOut=function(t){return new cc.FadeOut(t)},cc.TintTo=cc.Class({name:"cc.TintTo",extends:cc.ActionInterval,ctor:function(t,e,i,n){this._to=cc.color(0,0,0),this._from=cc.color(0,0,0),e instanceof cc.Color&&(n=e.b,i=e.g,e=e.r),void 0!==n&&this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._to=cc.color(e,i,n),!0)},clone:function(){var t=new cc.TintTo;this._cloneDecoration(t);var e=this._to;return t.initWithDuration(this._duration,e.r,e.g,e.b),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._from=this.target.color},update:function(t){t=this._computeEaseTime(t);var e=this._from,i=this._to;e&&(this.target.color=cc.color(e.r+(i.r-e.r)*t,e.g+(i.g-e.g)*t,e.b+(i.b-e.b)*t))}}),cc.tintTo=function(t,e,i,n){return new cc.TintTo(t,e,i,n)},cc.TintBy=cc.Class({name:"cc.TintBy",extends:cc.ActionInterval,ctor:function(t,e,i,n){this._deltaR=0,this._deltaG=0,this._deltaB=0,this._fromR=0,this._fromG=0,this._fromB=0,void 0!==n&&this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,i,n){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._deltaR=e,this._deltaG=i,this._deltaB=n,!0)},clone:function(){var t=new cc.TintBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._deltaR,this._deltaG,this._deltaB),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=t.color;this._fromR=e.r,this._fromG=e.g,this._fromB=e.b},update:function(t){t=this._computeEaseTime(t),this.target.color=cc.color(this._fromR+this._deltaR*t,this._fromG+this._deltaG*t,this._fromB+this._deltaB*t)},reverse:function(){var t=new cc.TintBy(this._duration,-this._deltaR,-this._deltaG,-this._deltaB);return this._cloneDecoration(t),this._reverseEaseList(t),t}}),cc.tintBy=function(t,e,i,n){return new cc.TintBy(t,e,i,n)},cc.DelayTime=cc.Class({name:"cc.DelayTime",extends:cc.ActionInterval,update:function(){},reverse:function(){var t=new cc.DelayTime(this._duration);return this._cloneDecoration(t),this._reverseEaseList(t),t},clone:function(){var t=new cc.DelayTime;return this._cloneDecoration(t),t.initWithDuration(this._duration),t}}),cc.delayTime=function(t){return new cc.DelayTime(t)},cc.ReverseTime=cc.Class({name:"cc.ReverseTime",extends:cc.ActionInterval,ctor:function(t){this._other=null,t&&this.initWithAction(t)},initWithAction:function(t){return t?t===this._other?(cc.errorID(1029),!1):!!cc.ActionInterval.prototype.initWithDuration.call(this,t._duration)&&(this._other=t,!0):(cc.errorID(1028),!1)},clone:function(){var t=new cc.ReverseTime;return this._cloneDecoration(t),t.initWithAction(this._other.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._other.startWithTarget(t)},update:function(t){t=this._computeEaseTime(t),this._other&&this._other.update(1-t)},reverse:function(){return this._other.clone()},stop:function(){this._other.stop(),cc.Action.prototype.stop.call(this)}}),cc.reverseTime=function(t){return new cc.ReverseTime(t)},cc.TargetedAction=cc.Class({name:"cc.TargetedAction",extends:cc.ActionInterval,ctor:function(t,e){this._action=null,this._forcedTarget=null,e&&this.initWithTarget(t,e)},initWithTarget:function(t,e){return!!this.initWithDuration(e._duration)&&(this._forcedTarget=t,this._action=e,!0)},clone:function(){var t=new cc.TargetedAction;return this._cloneDecoration(t),t.initWithTarget(this._forcedTarget,this._action.clone()),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._action.startWithTarget(this._forcedTarget)},stop:function(){this._action.stop()},update:function(t){t=this._computeEaseTime(t),this._action.update(t)},getForcedTarget:function(){return this._forcedTarget},setForcedTarget:function(t){this._forcedTarget!==t&&(this._forcedTarget=t)}}),cc.targetedAction=function(t,e){return new cc.TargetedAction(t,e)}}),{}],6:[(function(t){"use strict";t("../core/platform/CCClass");var e=t("../core/platform/js"),i=function(){this.actions=[],this.target=null,this.actionIndex=0,this.currentAction=null,this.paused=!1,this.lock=!1};cc.ActionManager=function(){this._hashTargets=e.createMap(!0),this._arrayTargets=[],this._currentTarget=null,cc.director._scheduler&&cc.director._scheduler.enableForTarget(this)},cc.ActionManager.prototype={constructor:cc.ActionManager,_elementPool:[],_searchElementByTarget:function(t,e){for(var i=0;i<t.length;i++)if(e===t[i].target)return t[i];return null},_getElement:function(t,e){var n=this._elementPool.pop();return n||(n=new i),n.target=t,n.paused=!!e,n},_putElement:function(t){t.actions.length=0,t.actionIndex=0,t.currentAction=null,t.paused=!1,t.target=null,t.lock=!1,this._elementPool.push(t)},addAction:function(t,e,i){if(t&&e){var n=this._hashTargets[e._id];n?n.actions||(n.actions=[]):(n=this._getElement(e,i),this._hashTargets[e._id]=n,this._arrayTargets.push(n)),n.actions.push(t),t.startWithTarget(e)}else cc.errorID(1e3)},removeAllActions:function(){for(var t=this._arrayTargets,i=0;i<t.length;i++){var n=t[i];n&&this._putElement(n)}this._arrayTargets.length=0,this._hashTargets=e.createMap(!0)},removeAllActionsFromTarget:function(t){if(null!=t){var e=this._hashTargets[t._id];e&&(e.actions.length=0,this._deleteHashElement(e))}},removeAction:function(t){if(t){var e=t.getOriginalTarget(),i=this._hashTargets[e._id];if(i)for(var n=0;n<i.actions.length;n++)if(i.actions[n]===t){i.actions.splice(n,1),i.actionIndex>=n&&i.actionIndex--;break}}},_removeActionByTag:function(t,e,i){for(var n=0,r=e.actions.length;n<r;++n){var a=e.actions[n];if(a&&a.getTag()===t){if(i&&a.getOriginalTarget()!==i)continue;this._removeActionAtIndex(n,e);break}}},removeActionByTag:function(t,e){t===cc.Action.TAG_INVALID&&cc.logID(1002);var i=this._hashTargets;if(e){var n=i[e._id];n&&this._removeActionByTag(t,n,e)}else for(var r in i){var a=i[r];this._removeActionByTag(t,a)}},getActionByTag:function(t,e){t===cc.Action.TAG_INVALID&&cc.logID(1004);var i=this._hashTargets[e._id];if(i){if(null!=i.actions)for(var n=0;n<i.actions.length;++n){var r=i.actions[n];if(r&&r.getTag()===t)return r}cc.logID(1005,t)}return null},getNumberOfRunningActionsInTarget:function(t){var e=this._hashTargets[t._id];return e&&e.actions?e.actions.length:0},pauseTarget:function(t){var e=this._hashTargets[t._id];e&&(e.paused=!0)},resumeTarget:function(t){var e=this._hashTargets[t._id];e&&(e.paused=!1)},pauseAllRunningActions:function(){for(var t=[],e=this._arrayTargets,i=0;i<e.length;i++){var n=e[i];n&&!n.paused&&(n.paused=!0,t.push(n.target))}return t},resumeTargets:function(t){if(t)for(var e=0;e<t.length;e++)t[e]&&this.resumeTarget(t[e])},pauseTargets:function(t){if(t)for(var e=0;e<t.length;e++)t[e]&&this.pauseTarget(t[e])},purgeSharedManager:function(){cc.director.getScheduler().unscheduleUpdate(this)},_removeActionAtIndex:function(t,e){e.actions[t],e.actions.splice(t,1),e.actionIndex>=t&&e.actionIndex--,0===e.actions.length&&this._deleteHashElement(e)},_deleteHashElement:function(t){var e=!1;if(t&&!t.lock&&this._hashTargets[t.target._id]){delete this._hashTargets[t.target._id];for(var i=this._arrayTargets,n=0,r=i.length;n<r;n++)if(i[n]===t){i.splice(n,1);break}this._putElement(t),e=!0}return e},update:function(t){for(var e,i=this._arrayTargets,n=0;n<i.length;n++){if(this._currentTarget=i[n],!(e=this._currentTarget).paused&&e.actions){for(e.lock=!0,e.actionIndex=0;e.actionIndex<e.actions.length;e.actionIndex++)if(e.currentAction=e.actions[e.actionIndex],e.currentAction){if(e.currentAction.step(t*(e.currentAction._speedMethod?e.currentAction._speed:1)),e.currentAction&&e.currentAction.isDone()){e.currentAction.stop();var r=e.currentAction;e.currentAction=null,this.removeAction(r)}e.currentAction=null}e.lock=!1}0===e.actions.length&&this._deleteHashElement(e)&&n--}}}}),{"../core/platform/CCClass":193,"../core/platform/js":214}],7:[(function(t){"use strict";t("./CCActionManager"),t("./CCAction"),t("./CCActionInterval"),t("./CCActionInstant"),t("./CCActionEase"),t("./CCActionCatmullRom"),t("./tween")}),{"./CCAction":1,"./CCActionCatmullRom":2,"./CCActionEase":3,"./CCActionInstant":4,"./CCActionInterval":5,"./CCActionManager":6,"./tween":8}],8:[(function(t){"use strict";var e=t("../animation/bezier"),i=0,n=cc.Class({name:"cc.TweenAction",extends:cc.ActionInterval,ctor:function(t,e,i){if(this._opts=i=i||Object.create(null),this._props=Object.create(null),i.progress=i.progress||this.progress,i.easing&&"string"==typeof i.easing){var n=i.easing;i.easing=cc.easing[n],!i.easing&&cc.warnID(1031,n)}var r=this._opts.relative;for(var a in e){var s=e[a],o=void 0,c=void 0;if(void 0!==s.value&&(s.easing||s.progress)&&("string"==typeof s.easing?!(o=cc.easing[s.easing])&&cc.warnID(1031,s.easing):o=s.easing,c=s.progress,s=s.value),"number"==typeof s||s.lerp&&(!r||s.add||s.mul)&&s.clone){var l=Object.create(null);l.value=s,l.easing=o,l.progress=c,this._props[a]=l}else cc.warn("Can not animate "+a+" property, because it do not have [lerp, (add|mul), clone] function.")}this._originProps=e,this.initWithDuration(t)},clone:function(){var t=new n(this._duration,this._originProps,this._opts);return this._cloneDecoration(t),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var e=!!this._opts.relative,i=this._props;for(var n in i){var r=t[n],a=i[n];"number"==typeof r?(a.start=r,a.current=r,a.end=e?r+a.value:a.value):(a.start=r.clone(),a.current=r.clone(),a.end=e?(r.add||r.mul).call(r,a.value):a.value)}},update:function(t){var e=this._opts,i=t;e.easing&&(i=e.easing(t));var n=this.target;if(n){var r=this._props,a=this._opts.progress;for(var s in r){var o=r[s],c=o.easing?o.easing(t):i,l=o.current=(o.progress||a)(o.start,o.end,o.current,c);n[s]=l}}},progress:function(t,e,i,n){return"number"==typeof t?i=t+(e-t)*n:t.lerp(e,n,i),i}}),r=cc.Class({name:"cc.SetAction",extends:cc.ActionInstant,ctor:function(t){this._props={},void 0!==t&&this.init(t)},init:function(t){for(var e in t)this._props[e]=t[e];return!0},update:function(){var t=this._props,e=this.target;for(var i in t)e[i]=t[i]},clone:function(){var t=new r;return t.init(this._props),t}});function a(t){this._actions=[],this._finalAction=null,this._target=t,this._tag=cc.Action.TAG_INVALID}a.stopAll=function(){cc.director.getActionManager().removeAllActions()},a.stopAllByTag=function(t){cc.director.getActionManager().removeActionByTag(t)},a.stopAllByTarget=function(t){cc.director.getActionManager().removeAllActionsFromTarget(t)},a.prototype.then=function(t){return t instanceof cc.Action?this._actions.push(t.clone()):this._actions.push(t._union()),this},a.prototype.target=function(t){return this._target=t,this},a.prototype.start=function(){var t=this._target;return t?t instanceof cc.Object&&!t.isValid?void 0:(this._finalAction&&cc.director.getActionManager().removeAction(this._finalAction),this._finalAction=this._union(),void 0===t._id&&(t._id=++i),this._finalAction.setTag(this._tag),cc.director.getActionManager().addAction(this._finalAction,t,!1),this):(cc.warn("Please set target to tween first"),this)},a.prototype.stop=function(){return this._finalAction&&cc.director.getActionManager().removeAction(this._finalAction),this},a.prototype.tag=function(t){return this._tag=t,this},a.prototype.clone=function(t){var e=this._union();return cc.tween(t).then(e.clone())},a.prototype.union=function(){var t=this._union();return this._actions.length=0,this._actions.push(t),this},a.prototype._union=function(){var t=this._actions;return 1===t.length?t[0]:cc.sequence(t)},Object.assign(a.prototype,{bezierTo:function(t,i,n,r,a){var s=i.x,o=i.y,c=n.x,l=n.y;return(a=a||Object.create(null)).progress=function(t,i,n,r){return n.x=(0,e.bezier)(t.x,s,c,i.x,r),n.y=(0,e.bezier)(t.y,o,l,i.y,r),n},this.to(t,{position:r},a)},bezierBy:function(t,i,n,r,a){var s=i.x,o=i.y,c=n.x,l=n.y;return(a=a||Object.create(null)).progress=function(t,i,n,r){var a=t.x,u=t.y;return n.x=(0,e.bezier)(a,s+a,c+a,i.x,r),n.y=(0,e.bezier)(u,o+u,l+u,i.y,r),n},this.by(t,{position:r},a)},flipX:function(){var t=this;return this.call((function(){t._target.scaleX*=-1}),this)},flipY:function(){var t=this;return this.call((function(){t._target.scaleY*=-1}),this)},blink:function(t,e,i){var n=1/e;return(i=i||Object.create(null)).progress=function(t,e,i,r){return r>=1?t:r%n>n/2?255:0},this.to(t,{opacity:1},i)}});var s=[];function o(t){return function(){s.length=0;for(var e=arguments.length,i=0;i<e;i++){var n=s[i]=arguments[i];n instanceof a&&(s[i]=n._union())}return t.apply(this,s)}}for(var c={to:function(t,e,i){return(i=i||Object.create(null)).relative=!1,new n(t,e,i)},by:function(t,e,i){return(i=i||Object.create(null)).relative=!0,new n(t,e,i)},set:function(t){return new r(t)},delay:cc.delayTime,call:cc.callFunc,hide:cc.hide,show:cc.show,removeSelf:cc.removeSelf,sequence:o(cc.sequence),parallel:o(cc.spawn)},l={repeat:cc.repeat,repeatForever:function(t){return cc.repeat(t,1e9)},reverseTime:cc.reverseTime},u=Object.keys(c),h=function(t){var e=u[t];a.prototype[e]=function(){var t=c[e].apply(this,arguments);return this._actions.push(t),this}},f=0;f<u.length;f++)h(f);u=Object.keys(l);for(var d=function(t){var e=u[t];a.prototype[e]=function(){var t=this._actions,i=arguments[arguments.length-1],n=arguments.length-1;i instanceof cc.Tween?i=i._union():i instanceof cc.Action||(i=t[t.length-1],t.length-=1,n+=1);for(var r=[i],a=0;a<n;a++)r.push(arguments[a]);return i=l[e].apply(this,r),t.push(i),this}},_=0;_<u.length;_++)d(_);cc.tween=function(t){return new a(t)},cc.Tween=a}),{"../animation/bezier":14}],9:[(function(t,e){"use strict";var i=cc.js,n=t("./playable"),r=t("./animation-curves"),a=r.EventAnimCurve,s=r.EventInfo,o=t("./types").WrapModeMask,c=t("../core/utils/binary-search").binarySearchEpsilon;function l(t,e){n.call(this),this.target=t,this.animation=e,this._anims=new i.array.MutableForwardIterator([])}i.extend(l,n);var u=l.prototype;function h(t,e){var i=e.clip;e.duration=i.duration,e.speed=i.speed,e.wrapMode=i.wrapMode,e.frameRate=i.sample,(e.wrapMode&o.Loop)===o.Loop?e.repeatCount=1/0:e.repeatCount=1;var n=e.curves=i.createCurves(e,t),r=i.events;if(r)for(var l,u=0,h=r.length;u<h;u++){l||((l=new a).target=t,n.push(l));var f=r[u],d=f.frame/e.duration,_=void 0,p=c(l.ratios,d);p>=0?_=l.events[p]:(_=new s,l.ratios.push(d),l.events.push(_)),_.add(f.func,f.params)}}u.playState=function(t,e){t.clip&&(t.curveLoaded||h(this.target,t),t.animator=this,t.play(),"number"==typeof e&&t.setTime(e),this.play())},u.stopStatesExcept=function(t){var e=this._anims,i=e.array;for(e.i=0;e.i<i.length;++e.i){var n=i[e.i];n!==t&&this.stopState(n)}},u.addAnimation=function(t){-1===this._anims.array.indexOf(t)&&this._anims.push(t),t._setEventTarget(this.animation)},u.removeAnimation=function(t){var e=this._anims.array.indexOf(t);e>=0?(this._anims.fastRemoveAt(e),0===this._anims.array.length&&this.stop()):cc.errorID(3907),t.animator=null},u.sample=function(){var t=this._anims,e=t.array;for(t.i=0;t.i<e.length;++t.i)e[t.i].sample()},u.stopState=function(t){t&&t.stop()},u.pauseState=function(t){t&&t.pause()},u.resumeState=function(t){t&&t.resume(),this.isPaused&&this.resume()},u.setStateTime=function(t,e){if(void 0!==e)t&&(t.setTime(e),t.sample());else{e=t;for(var i=this._anims.array,n=0;n<i.length;++n){var r=i[n];r.setTime(e),r.sample()}}},u.onStop=function(){var t=this._anims,e=t.array;for(t.i=0;t.i<e.length;++t.i)e[t.i].stop()},u.onPause=function(){for(var t=this._anims.array,e=0;e<t.length;++e){var i=t[e];i.pause(),i.animator=null}},u.onResume=function(){for(var t=this._anims.array,e=0;e<t.length;++e){var i=t[e];i.animator=this,i.resume()}},u._reloadClip=function(t){h(this.target,t)},e.exports=l}),{"../core/utils/binary-search":271,"./animation-curves":11,"./playable":18,"./types":19}],10:[(function(t,e){"use strict";var i=t("./types").WrapMode,n=t("./animation-curves"),r=n.DynamicAnimCurve,a=n.quickFindIndex,s=t("./motion-path-helper").sampleMotionPaths,o=t("../core/utils/binary-search").binarySearchEpsilon,c=cc.Class({name:"cc.AnimationClip",extends:cc.Asset,properties:{_duration:{default:0,type:cc.Float},duration:{get:function(){return this._duration}},sample:{default:60},speed:{default:1},wrapMode:{default:i.Normal},curveData:{default:{},visible:!1},events:{default:[],visible:!1}},statics:{createWithSpriteFrames:function(t,e){if(!Array.isArray(t))return cc.errorID(3905),null;var i=new c;i.sample=e||i.sample,i._duration=t.length/i.sample;for(var n=[],r=1/i.sample,a=0,s=t.length;a<s;a++)n[a]={frame:a*r,value:t[a]};return i.curveData={comps:{"cc.Sprite":{spriteFrame:n}}},i}},onLoad:function(){this._duration=Number.parseFloat(this.duration),this.speed=Number.parseFloat(this.speed),this.wrapMode=Number.parseInt(this.wrapMode),this.frameRate=Number.parseFloat(this.sample)},createPropCurve:function(t,e,i){var n=[],c=t instanceof cc.Node&&"position"===e,l=new r;l.target=t,l.prop=e;for(var u=0,h=i.length;u<h;u++){var f=i[u],d=f.frame/this.duration;l.ratios.push(d),c&&n.push(f.motionPath);var _=f.value;l.values.push(_);var p=f.curve;if(p){if("string"==typeof p){l.types.push(p);continue}if(Array.isArray(p)){p[0]===p[1]&&p[2]===p[3]?l.types.push(r.Linear):l.types.push(r.Bezier(p));continue}}l.types.push(r.Linear)}c&&s(n,l,this.duration,this.sample,t);for(var m,v,g=l.ratios,y=!0,T=1,b=g.length;T<b;T++)if(m=g[T]-g[T-1],1===T)v=m;else if(Math.abs(m-v)>1e-6){y=!1;break}l._findFrameIndex=y?a:o;var E=l.values[0];return null==E||l._lerp||("number"==typeof E?l._lerp=r.prototype._lerpNumber:E instanceof cc.Quat?l._lerp=r.prototype._lerpQuat:E instanceof cc.Vec2?l._lerp=r.prototype._lerpVector2:E instanceof cc.Vec3?l._lerp=r.prototype._lerpVector3:E.lerp&&(l._lerp=r.prototype._lerpObject)),l},createTargetCurves:function(t,e,i){var n=e.props,r=e.comps;if(n)for(var a in n){var s=n[a],o=this.createPropCurve(t,a,s);i.push(o)}if(r)for(var c in r){var l=t.getComponent(c);if(l){var u=r[c];for(var h in u){var f=u[h],d=this.createPropCurve(l,h,f);i.push(d)}}}},createCurves:function(t,e){var i=this.curveData,n=i.paths,r=[];for(var a in this.createTargetCurves(e,i,r),n){var s=cc.find(a,e);if(s){var o=n[a];this.createTargetCurves(s,o,r)}}return r}});cc.AnimationClip=e.exports=c}),{"../core/utils/binary-search":271,"./animation-curves":11,"./motion-path-helper":17,"./types":19}],11:[(function(t,e){"use strict";var i=t("./bezier").bezierByTime,n=t("../core/utils/binary-search").binarySearchEpsilon,r=t("./types").WrapModeMask,a=t("./types").WrappedInfo;function s(t,e){if("string"==typeof e){var n=cc.easing[e];n?t=n(t):cc.errorID(3906,e)}else Array.isArray(e)&&(t=i(e,t));return t}var o=cc.Class({name:"cc.AnimCurve",sample:function(){},onTimeChangedManually:void 0});var c,l=cc.Class({name:"cc.DynamicAnimCurve",extends:o,ctor:function(){this._cachedIndex=0},properties:{target:null,prop:"",values:[],ratios:[],types:[]},_findFrameIndex:n,_lerp:void 0,_lerpNumber:function(t,e,i){return t+(e-t)*i},_lerpObject:function(t,e,i){return t.lerp(e,i)},_lerpQuat:(c=cc.quat(),function(t,e,i){return t.lerp(e,i,c)}),_lerpVector2:(function(){var t=cc.v2();return function(e,i,n){return e.lerp(i,n,t)}})(),_lerpVector3:(function(){var t=cc.v3();return function(e,i,n){return e.lerp(i,n,t)}})(),sample:function(t,e){var i=this.values,n=this.ratios,r=n.length;if(0!==r){var a,o=!0,c=this._cachedIndex;if(c<0&&(c=~c)>0&&c<n.length){var l=n[c-1],u=n[c];e>l&&e<u&&(o=!1)}o&&(this._cachedIndex=this._findFrameIndex(n,e));var h=this._cachedIndex;if(h<0)if((h=~h)<=0)a=i[0];else if(h>=r)a=i[r-1];else{var f=i[h-1];if(this._lerp){var d=n[h-1],_=n[h],p=this.types[h-1],m=(e-d)/(_-d);p&&(m=s(m,p));var v=i[h];a=this._lerp(f,v,m)}else a=f}else a=i[h];this.target[this.prop]=a}}});l.Linear=null,l.Bezier=function(t){return t};var u=function(){this.events=[]};u.prototype.add=function(t,e){this.events.push({func:t||"",params:e||[]})};var h=cc.Class({name:"cc.EventAnimCurve",extends:o,properties:{target:null,ratios:[],events:[],_wrappedInfo:{default:function(){return new a}},_lastWrappedInfo:null,_ignoreIndex:NaN},_wrapIterations:function(t){return t-(0|t)==0&&(t-=1),0|t},sample:function(t,e,i){var s=this.ratios.length,o=i.getWrappedInfo(i.time,this._wrappedInfo),c=o.direction,l=n(this.ratios,o.ratio);if(l<0&&(l=~l-1,c<0&&(l+=1)),this._ignoreIndex!==l&&(this._ignoreIndex=NaN),o.frameIndex=l,!this._lastWrappedInfo)return this._fireEvent(l),void(this._lastWrappedInfo=new a(o));var u=i.wrapMode,h=this._wrapIterations(o.iterations),f=this._lastWrappedInfo,d=this._wrapIterations(f.iterations),_=f.frameIndex,p=f.direction,m=-1!==d&&h!==d;if(_===l&&m&&1===s)this._fireEvent(0);else if(_!==l||m){c=p;do{if(_!==l){if(-1===c&&0===_&&l>0?((u&r.PingPong)===r.PingPong?c*=-1:_=s,d++):1===c&&_===s-1&&l<s-1&&((u&r.PingPong)===r.PingPong?c*=-1:_=-1,d++),_===l)break;if(d>h)break}_+=c,cc.director.getAnimationManager().pushDelayEvent(this,"_fireEvent",[_])}while(_!==l&&_>-1&&_<s)}this._lastWrappedInfo.set(o)},_fireEvent:function(t){if(!(t<0||t>=this.events.length||this._ignoreIndex===t)){var e=this.events[t].events;if(this.target.isValid)for(var i=this.target._components,n=0;n<e.length;n++)for(var r=e[n],a=r.func,s=0;s<i.length;s++){var o=i[s],c=o[a];c&&c.apply(o,r.params)}}},onTimeChangedManually:function(t,e){this._lastWrappedInfo=null,this._ignoreIndex=NaN;var i=e.getWrappedInfo(t,this._wrappedInfo),r=i.direction,a=n(this.ratios,i.ratio);a<0&&(a=~a-1,r<0&&(a+=1),this._ignoreIndex=a)}});e.exports={AnimCurve:o,DynamicAnimCurve:l,EventAnimCurve:h,EventInfo:u,computeRatioByType:s,quickFindIndex:function(t,e){var i=t.length-1;if(0===i)return 0;var n=t[0];if(e<n)return 0;var r=t[i];if(e>r)return~t.length;var a=(e=(e-n)/(r-n))/(1/i),s=0|a;return a-s<1e-6?s:s+1-a<1e-6?s+1:~(s+1)}}}),{"../core/utils/binary-search":271,"./bezier":14,"./types":19}],12:[(function(t,e){"use strict";var i=cc.js,n=cc.Class({ctor:function(){this._anims=new i.array.MutableForwardIterator([]),this._delayEvents=[],cc.director._scheduler&&cc.director._scheduler.enableForTarget(this)},update:function(t){var e=this._anims,i=e.array;for(e.i=0;e.i<i.length;++e.i){var n=i[e.i];n._isPlaying&&!n._isPaused&&n.update(t)}for(var r=this._delayEvents,a=0;a<r.length;a++){var s=r[a];s.target[s.func].apply(s.target,s.args)}r.length=0},destruct:function(){},addAnimation:function(t){-1===this._anims.array.indexOf(t)&&this._anims.push(t)},removeAnimation:function(t){var e=this._anims.array.indexOf(t);e>=0?this._anims.fastRemoveAt(e):cc.errorID(3907)},pushDelayEvent:function(t,e,i){this._delayEvents.push({target:t,func:e,args:i})}});cc.AnimationManager=e.exports=n}),{}],13:[(function(t,e){"use strict";var i=cc.js,n=t("./playable"),r=t("./types"),a=r.WrappedInfo,s=r.WrapMode,o=r.WrapModeMask;function c(t,e){n.call(this),this._currentFramePlayed=!1,this._delay=0,this._delayTime=0,this._wrappedInfo=new a,this._lastWrappedInfo=null,this._process=u,this._clip=t,this._name=e||t&&t.name,this.animator=null,this.curves=[],this.delay=0,this.repeatCount=1,this.duration=1,this.speed=1,this.wrapMode=s.Normal,this.time=0,this._target=null,this._lastframeEventOn=!1,this.emit=function(){for(var t=new Array(arguments.length),e=0,i=t.length;e<i;e++)t[e]=arguments[e];cc.director.getAnimationManager().pushDelayEvent(this,"_emit",t)}}i.extend(c,n);var l=c.prototype;function u(){var t,e=this.sample();this._lastframeEventOn&&(t=this._lastWrappedInfo?this._lastWrappedInfo:this._lastWrappedInfo=new a(e),this.repeatCount>1&&(0|e.iterations)>(0|t.iterations)&&this.emit("lastframe",this),t.set(e)),e.stopped&&(this.stop(),this.emit("finished",this))}function h(){var t=this.time,e=this.duration;t>e?0==(t%=e)&&(t=e):t<0&&0!=(t%=e)&&(t+=e);for(var i=t/e,n=this.curves,r=0,a=n.length;r<a;r++)n[r].sample(t,i,this);this._lastframeEventOn&&(void 0===this._lastIterations&&(this._lastIterations=i),(this.time>0&&this._lastIterations>i||this.time<0&&this._lastIterations<i)&&this.emit("lastframe",this),this._lastIterations=i)}l._emit=function(t,e){this._target&&this._target.isValid&&this._target.emit(t,t,e)},l.on=function(t,e,i){return this._target&&this._target.isValid?("lastframe"===t&&(this._lastframeEventOn=!0),this._target.on(t,e,i)):null},l.once=function(t,e,i){if(this._target&&this._target.isValid){"lastframe"===t&&(this._lastframeEventOn=!0);var n=this;return this._target.once(t,(function(t){e.call(i,t),n._lastframeEventOn=!1}))}return null},l.off=function(t,e,i){this._target&&this._target.isValid&&("lastframe"===t&&(this._target.hasEventListener(t)||(this._lastframeEventOn=!1)),this._target.off(t,e,i))},l._setEventTarget=function(t){this._target=t},l.onPlay=function(){this.setTime(0),this._delayTime=this._delay,cc.director.getAnimationManager().addAnimation(this),this.animator&&this.animator.addAnimation(this),this.emit("play",this)},l.onStop=function(){this.isPaused||cc.director.getAnimationManager().removeAnimation(this),this.animator&&this.animator.removeAnimation(this),this.emit("stop",this)},l.onResume=function(){cc.director.getAnimationManager().addAnimation(this),this.emit("resume",this)},l.onPause=function(){cc.director.getAnimationManager().removeAnimation(this),this.emit("pause",this)},l.setTime=function(t){this._currentFramePlayed=!1,this.time=t||0;for(var e=this.curves,i=0,n=e.length;i<n;i++){var r=e[i];r.onTimeChangedManually&&r.onTimeChangedManually(t,this)}},l.update=function(t){this._delayTime>0&&(this._delayTime-=t,this._delayTime>0)||(this._currentFramePlayed?this.time+=t*this.speed:this._currentFramePlayed=!0,this._process())},l._needRevers=function(t){var e=this.wrapMode,i=!1;return(e&o.PingPong)===o.PingPong&&(t-(0|t)==0&&t>0&&(t-=1),1&t&&(i=!i)),(e&o.Reverse)===o.Reverse&&(i=!i),i},l.getWrappedInfo=function(t,e){e=e||new a;var i=!1,n=this.duration,r=this.repeatCount,s=t>0?t/n:-t/n;if(s>=r){s=r,i=!0;var c=r-(0|r);0===c&&(c=1),t=c*n*(t>0?1:-1)}if(t>n){var l=t%n;t=0===l?n:l}else t<0&&0!=(t%=n)&&(t+=n);var u=!1,h=this._wrapMode&o.ShouldWrap;h&&(u=this._needRevers(s));var f=u?-1:1;return this.speed<0&&(f*=-1),h&&u&&(t=n-t),e.ratio=t/n,e.time=t,e.direction=f,e.stopped=i,e.iterations=s,e},l.sample=function(){for(var t=this.getWrappedInfo(this.time,this._wrappedInfo),e=this.curves,i=0,n=e.length;i<n;i++)e[i].sample(t.time,t.ratio,this);return t},i.get(l,"clip",(function(){return this._clip})),i.get(l,"name",(function(){return this._name})),i.obsolete(l,"AnimationState.length","duration"),i.getset(l,"curveLoaded",(function(){return this.curves.length>0}),(function(){this.curves.length=0})),i.getset(l,"wrapMode",(function(){return this._wrapMode}),(function(t){this._wrapMode=t,this.time=0,t&o.Loop?this.repeatCount=1/0:this.repeatCount=1})),i.getset(l,"repeatCount",(function(){return this._repeatCount}),(function(t){this._repeatCount=t;var e=this._wrapMode&o.ShouldWrap,i=(this.wrapMode&o.Reverse)===o.Reverse;this._process=t!==1/0||e||i?u:h})),i.getset(l,"delay",(function(){return this._delay}),(function(t){this._delayTime=this._delay=t})),cc.AnimationState=e.exports=c}),{"./playable":18,"./types":19}],14:[(function(t,e){"use strict";var i=Math.cos,n=Math.acos,r=Math.max,a=2*Math.PI,s=Math.sqrt;function o(t){return t<0?-Math.pow(-t,1/3):Math.pow(t,1/3)}function c(t,e){var c,l,u,h,f=e-0,d=e-t[0],_=3*f,p=3*d,m=3*(e-t[2]),v=1/(-f+p-m+(e-1)),g=(_-6*d+m)*v,y=g*(1/3),T=(-_+p)*v,b=1/3*(3*T-g*g),E=b*(1/3),A=(2*g*g*g-9*g*T+f*v*27)/27,C=A/2,x=C*C+E*E*E;if(x<0){var S=1/3*-b,w=s(S*S*S),M=-A/(2*w),R=n(M<-1?-1:M>1?1:M),I=2*o(w);return l=I*i(R*(1/3))-y,u=I*i((R+a)*(1/3))-y,h=I*i((R+2*a)*(1/3))-y,0<=l&&l<=1?0<=u&&u<=1?0<=h&&h<=1?r(l,u,h):r(l,u):0<=h&&h<=1?r(l,h):l:0<=u&&u<=1?0<=h&&h<=1?r(u,h):u:h}if(0===x)return u=-(c=C<0?o(-C):-o(C))-y,0<=(l=2*c-y)&&l<=1?0<=u&&u<=1?r(l,u):l:u;var O=s(x);return(c=o(-C+O))-o(C+O)-y}e.exports={bezier:function(t,e,i,n,r){var a=1-r;return a*(a*(t+(3*e-t)*r)+3*i*r*r)+n*r*r*r},bezierByTime:function(t,e){var i=c(t,e),n=t[1];return((1-i)*(n+(t[3]-n)*i)*3+i*i)*i}}}),{}],15:[(function(t,e){"use strict";var i={constant:function(){return 0},linear:function(t){return t},quadIn:function(t){return t*t},quadOut:function(t){return t*(2-t)},quadInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},cubicIn:function(t){return t*t*t},cubicOut:function(t){return--t*t*t+1},cubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},quartIn:function(t){return t*t*t*t},quartOut:function(t){return 1- --t*t*t*t},quartInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},quintIn:function(t){return t*t*t*t*t},quintOut:function(t){return--t*t*t*t*t+1},quintInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},sineIn:function(t){return 1-Math.cos(t*Math.PI/2)},sineOut:function(t){return Math.sin(t*Math.PI/2)},sineInOut:function(t){return.5*(1-Math.cos(Math.PI*t))},expoIn:function(t){return 0===t?0:Math.pow(1024,t-1)},expoOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},expoInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},circIn:function(t){return 1-Math.sqrt(1-t*t)},circOut:function(t){return Math.sqrt(1- --t*t)},circInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},elasticIn:function(t){var e,i=.1;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=.4*Math.asin(1/i)/(2*Math.PI),-i*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/.4))},elasticOut:function(t){var e,i=.1;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=.4*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*t)*Math.sin(2*(t-e)*Math.PI/.4)+1)},elasticInOut:function(t){var e,i=.1;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=.1):e=.4*Math.asin(1/i)/(2*Math.PI),(t*=2)<1?i*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/.4)*-.5:i*Math.pow(2,-10*(t-=1))*Math.sin(2*(t-e)*Math.PI/.4)*.5+1)},backIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},backOut:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},backInOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)},bounceIn:function(t){return 1-i.bounceOut(1-t)},bounceOut:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},bounceInOut:function(t){return t<.5?.5*i.bounceIn(2*t):.5*i.bounceOut(2*t-1)+.5},smooth:function(t){return t<=0?0:t>=1?1:t*t*(3-2*t)},fade:function(t){return t<=0?0:t>=1?1:t*t*t*(t*(6*t-15)+10)}};function n(t,e){return function(i){return i<.5?e(2*i)/2:t(2*i-1)/2+.5}}i.quadOutIn=n(i.quadIn,i.quadOut),i.cubicOutIn=n(i.cubicIn,i.cubicOut),i.quartOutIn=n(i.quartIn,i.quartOut),i.quintOutIn=n(i.quintIn,i.quintOut),i.sineOutIn=n(i.sineIn,i.sineOut),i.expoOutIn=n(i.expoIn,i.expoOut),i.circOutIn=n(i.circIn,i.circOut),i.backOutIn=n(i.backIn,i.backOut),i.bounceIn=function(t){return 1-i.bounceOut(1-t)},i.bounceInOut=function(t){return t<.5?.5*i.bounceIn(2*t):.5*i.bounceOut(2*t-1)+.5},i.bounceOutIn=n(i.bounceIn,i.bounceOut),cc.easing=e.exports=i}),{}],16:[(function(t){"use strict";t("./bezier"),t("./easing"),t("./types"),t("./motion-path-helper"),t("./animation-curves"),t("./animation-clip"),t("./animation-manager"),t("./animation-state"),t("./animation-animator")}),{"./animation-animator":9,"./animation-clip":10,"./animation-curves":11,"./animation-manager":12,"./animation-state":13,"./bezier":14,"./easing":15,"./motion-path-helper":17,"./types":19}],17:[(function(t,e){"use strict";var i=t("./animation-curves").DynamicAnimCurve,n=t("./animation-curves").computeRatioByType,r=t("./bezier").bezier,a=t("../core/utils/binary-search").binarySearchEpsilon,s=cc.v2;function o(t){this.points=t||[],this.beziers=[],this.ratios=[],this.progresses=[],this.length=0,this.computeBeziers()}function c(){this.start=s(),this.end=s(),this.startCtrlPoint=s(),this.endCtrlPoint=s()}function l(t){if(!Array.isArray(t))return!1;for(var e=0,i=t.length;e<i;e++){var n=t[e];if(!Array.isArray(n)||6!==n.length)return!1}return!0}o.prototype.computeBeziers=function(){var t;this.beziers.length=0,this.ratios.length=0,this.progresses.length=0,this.length=0;for(var e=1;e<this.points.length;e++){var i=this.points[e-1],n=this.points[e];(t=new c).start=i.pos,t.startCtrlPoint=i.out,t.end=n.pos,t.endCtrlPoint=n.in,this.beziers.push(t),this.length+=t.getLength()}var r=0;for(e=0;e<this.beziers.length;e++)t=this.beziers[e],this.ratios[e]=t.getLength()/this.length,this.progresses[e]=r+=this.ratios[e];return this.beziers},c.prototype.getPointAt=function(t){var e=this.getUtoTmapping(t);return this.getPoint(e)},c.prototype.getPoint=function(t){var e=r(this.start.x,this.startCtrlPoint.x,this.endCtrlPoint.x,this.end.x,t),i=r(this.start.y,this.startCtrlPoint.y,this.endCtrlPoint.y,this.end.y,t);return new s(e,i)},c.prototype.getLength=function(){var t=this.getLengths();return t[t.length-1]},c.prototype.getLengths=function(t){if(t||(t=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length===t+1)return this.cacheArcLengths;var e,i,n=[],r=this.getPoint(0),a=s(),o=0;for(n.push(0),i=1;i<=t;i++)e=this.getPoint(i/t),a.x=r.x-e.x,a.y=r.y-e.y,o+=a.mag(),n.push(o),r=e;return this.cacheArcLengths=n,n},c.prototype.getUtoTmapping=function(t,e){var i,n=this.getLengths(),r=0,a=n.length;i=e||t*n[a-1];for(var s,o=0,c=a-1;o<=c;)if((s=n[r=Math.floor(o+(c-o)/2)]-i)<0)o=r+1;else{if(!(s>0)){c=r;break}c=r-1}if(n[r=c]===i)return r/(a-1);var l=n[r];return(r+(i-l)/(n[r+1]-l))/(a-1)},e.exports={sampleMotionPaths:function(t,e,r,c,u){function h(t){return t instanceof cc.Vec2?{in:t,pos:t,out:t}:Array.isArray(t)&&6===t.length?{in:s(t[2],t[3]),pos:s(t[0],t[1]),out:s(t[4],t[5])}:{in:cc.Vec2.ZERO,pos:cc.Vec2.ZERO,out:cc.Vec2.ZERO}}var f=e.values=e.values.map((function(t){return Array.isArray(t)&&(t=2===t.length?cc.v2(t[0],t[1]):cc.v3(t[0],t[1],t[2])),t}));if(0!==t.length&&0!==f.length){for(var d=!1,_=0;_<t.length;_++){var p=t[_];if(p&&!l(p)&&(cc.errorID(3904,u?u.name:"","position",_),p=null),p&&p.length>0){d=!0;break}}if(d&&1!==f.length){for(var m=e.types,v=e.ratios,g=e.values=[],y=e.types=[],T=e.ratios=[],b=0,E=i.Linear,A=0,C=t.length;A<C-1;A++){var x,S=t[A],w=v[A],M=v[A+1]-w,R=f[A],I=f[A+1],O=m[A],D=[],P=b/M,L=1/(M*r*c);if(S&&S.length>0){var N=[];N.push(h(R));for(var F=0,B=S.length;F<B;F++){var k=h(S[F]);N.push(k)}N.push(h(I));var V=new o(N);V.computeBeziers();for(var z=V.progresses;1-P>1e-6;){var U,H,W,G;if((x=n(x=P,O))<0)G=(0-x)*(H=V.beziers[0]).getLength(),W=H.start.sub(H.endCtrlPoint).normalize(),U=H.start.add(W.mul(G));else if(x>1)G=(x-1)*(H=V.beziers[V.beziers.length-1]).getLength(),W=H.end.sub(H.startCtrlPoint).normalize(),U=H.end.add(W.mul(G));else{var j=a(z,x);j<0&&(j=~j),x-=j>0?z[j-1]:0,x/=V.ratios[j],U=V.beziers[j].getPointAt(x)}D.push(U),P+=L}}else for(;1-P>1e-6;)x=n(x=P,O),D.push(R.lerp(I,x)),P+=L;for(E="constant"===O?O:i.Linear,F=0,B=D.length;F<B;F++){var Y=w+b+L*F*M;X(D[F],E,Y)}b=Math.abs(P-1)>1e-6?(P-1)*M:0}v[v.length-1]!==T[T.length-1]&&X(f[f.length-1],E,v[v.length-1])}}function X(t,e,i){g.push(t),y.push(e),T.push(i)}},Curve:o,Bezier:c}}),{"../core/utils/binary-search":271,"./animation-curves":11,"./bezier":14}],18:[(function(t,e){"use strict";var i=cc.js,n=t("../core/CCDebug");function r(){this._isPlaying=!1,this._isPaused=!1,this._stepOnce=!1}var a=r.prototype;i.get(a,"isPlaying",(function(){return this._isPlaying}),!0),i.get(a,"isPaused",(function(){return this._isPaused}),!0);var s=function(){};a.onPlay=s,a.onPause=s,a.onResume=s,a.onStop=s,a.onError=s,a.play=function(){this._isPlaying?this._isPaused?(this._isPaused=!1,this.onResume()):this.onError(n.getError(3912)):(this._isPlaying=!0,this.onPlay())},a.stop=function(){this._isPlaying&&(this._isPlaying=!1,this.onStop(),this._isPaused=!1)},a.pause=function(){this._isPlaying&&!this._isPaused&&(this._isPaused=!0,this.onPause())},a.resume=function(){this._isPlaying&&this._isPaused&&(this._isPaused=!1,this.onResume())},a.step=function(){this.pause(),this._stepOnce=!0,this._isPlaying||this.play()},e.exports=r}),{"../core/CCDebug":57}],19:[(function(t,e){"use strict";var i={Loop:2,ShouldWrap:4,PingPong:22,Reverse:36},n=cc.Enum({Default:0,Normal:1,Reverse:i.Reverse,Loop:i.Loop,LoopReverse:i.Loop|i.Reverse,PingPong:i.PingPong,PingPongReverse:i.PingPong|i.Reverse});function r(t){t?this.set(t):(this.ratio=0,this.time=0,this.direction=1,this.stopped=!0,this.iterations=0,this.frameIndex=void 0)}cc.WrapMode=n,r.prototype.set=function(t){this.ratio=t.ratio,this.time=t.time,this.direction=t.direction,this.stopped=t.stopped,this.iterations=t.iterations,this.frameIndex=t.frameIndex},e.exports={WrapModeMask:i,WrapMode:n,WrappedInfo:r}}),{}],20:[(function(t,e){"use strict";var i,n,r=t("../core/event/event-target"),a=t("../core/platform/CCSys"),s=t("../core/assets/CCAudioClip").LoadMode,o=!1,c=[],l=function t(e){r.call(this),this._shouldRecycleOnEnded=!1,this._src=e,this._element=null,this.id=0,this._state=t.State.INITIALZING,this._onended=function(){this._state=t.State.STOPPED,this.emit("ended")}.bind(this)};cc.js.extend(l,r),l.State={ERROR:-1,INITIALZING:0,PLAYING:1,PAUSED:2,STOPPED:3},(i=l.prototype)._bindEnded=function(t){t=t||this._onended;var e=this._element;this._src&&e instanceof HTMLAudioElement?e.addEventListener("ended",t):e.onended=t},i._unbindEnded=function(){var t=this._element;t instanceof HTMLAudioElement?t.removeEventListener("ended",this._onended):t&&(t.onended=null)},i._onLoaded=function(){this._createElement(),this._state=l.State.INITIALZING,this.setVolume(1),this.setLoop(!1)},i._createElement=function(){var t=this._src._nativeAsset;t instanceof HTMLAudioElement?(this._element||(this._element=document.createElement("audio")),this._element.src=t.src):this._element=new u(t,this)},i.play=function(){var t=this;this._src&&this._src._ensureLoaded((function(){t._state=l.State.PLAYING,t._bindEnded();var e=t._element.play();window.Promise&&e instanceof Promise&&e.catch((function(){})),t._touchToPlay()}))},i._touchToPlay=function(){if(this._src&&this._src.loadMode===s.DOM_AUDIO&&this._element.paused&&c.push({instance:this,offset:0,audio:this._element}),!o){o=!0;var t="ontouchend"in window?"touchend":"mousedown";cc.game.canvas.addEventListener(t,(function(){for(var t;t=c.pop();)t.audio.play(t.offset)}))}},i.destroy=function(){this._element=null},i.pause=function(){if(this.getState()===l.State.PLAYING){var t=this;this._src&&this._src._ensureLoaded((function(){t._unbindEnded(),t._element.pause(),t._state=l.State.PAUSED}))}},i.resume=function(){if(this.getState()===l.State.PAUSED){var t=this;this._src&&this._src._ensureLoaded((function(){t._bindEnded(),t._element.play(),t._state=l.State.PLAYING}))}},i.stop=function(){var t=this;this._src&&this._src._ensureLoaded((function(){t._element.pause(),t._element.currentTime=0;for(var e=0;e<c.length;e++)if(c[e].instance===t){c.splice(e,1);break}t._unbindEnded(),t.emit("stop"),t._state=l.State.STOPPED}))},i.setLoop=function(t){var e=this;this._src&&this._src._ensureLoaded((function(){e._element.loop=t}))},i.getLoop=function(){return!!this._element&&this._element.loop},i.setVolume=function(t){var e=this;this._src&&this._src._ensureLoaded((function(){e._element.volume=t}))},i.getVolume=function(){return this._element?this._element.volume:1},i.setCurrentTime=function(t){var e=this;this._src&&this._src._ensureLoaded((function(){e._unbindEnded(),e._bindEnded((function(){e._bindEnded()})),e._element.currentTime=t}))},i.getCurrentTime=function(){return this._element?this._element.currentTime:0},i.getDuration=function(){return this._src?this._src.duration:0},i.getState=function(t){return void 0===t&&(t=!0),t&&this._forceUpdatingState(),this._state},i._forceUpdatingState=function(){var t=this._element;t&&(l.State.PLAYING===this._state&&t.paused?this._state=l.State.STOPPED:l.State.STOPPED!==this._state||t.paused||(this._state=l.State.PLAYING))},Object.defineProperty(i,"src",{get:function(){return this._src},set:function(t){if(this._unbindEnded(),t){if(t!==this._src)if(this._src=t,t.loaded)this._onLoaded();else{var e=this;t.once("load",(function(){t===e._src&&e._onLoaded()}))}}else this._src=null,this._element instanceof u?this._element=null:this._element&&(this._element.src=""),this._state=l.State.INITIALZING;return t},enumerable:!0,configurable:!0}),Object.defineProperty(i,"paused",{get:function(){return!this._element||this._element.paused},enumerable:!0,configurable:!0}),n=cc.sys.browserType===cc.sys.BROWSER_TYPE_EDGE||cc.sys.browserType===cc.sys.BROWSER_TYPE_BAIDU||cc.sys.browserType===cc.sys.BROWSER_TYPE_UC?.01:0;var u=function(t,e){this._audio=e,this._context=a.__audioSupport.context,this._buffer=t,this._gainObj=this._context.createGain(),this.volume=1,this._gainObj.connect(this._context.destination),this._loop=!1,this._startTime=-1,this._currentSource=null,this.playedLength=0,this._currentTimer=null,this._endCallback=function(){this.onended&&this.onended(this)}.bind(this)};(function(t){t.play=function(t){this._currentSource&&!this.paused&&(this._currentSource.onended=null,this._currentSource.stop(0),this.playedLength=0);var e=this._context.createBufferSource();e.buffer=this._buffer,e.connect(this._gainObj),e.loop=this._loop,this._startTime=this._context.currentTime,(t=t||this.playedLength)&&(this._startTime-=t);var i,n=this._buffer.duration,r=t;if(this._loop?e.start?e.start(0,r):e.notoGrainOn?e.noteGrainOn(0,r):e.noteOn(0,r):(i=n-t,e.start?e.start(0,r,i):e.noteGrainOn?e.noteGrainOn(0,r,i):e.noteOn(0,r,i)),this._currentSource=e,e.onended=this._endCallback,(!e.context.state||"suspended"===e.context.state)&&0===this._context.currentTime){var a=this;clearTimeout(this._currentTimer),this._currentTimer=setTimeout((function(){0===a._context.currentTime&&c.push({instance:a._audio,offset:t,audio:a})}),10)}var s=cc.sys;s.os===s.OS_IOS&&s.isBrowser&&s.isMobile&&("suspended"===e.context.state&&0!==this._context.currentTime||"interrupted"===e.context.state)&&e.context.resume()},t.pause=function(){if(clearTimeout(this._currentTimer),!this.paused){this.playedLength=this._context.currentTime-this._startTime,this.playedLength%=this._buffer.duration;var t=this._currentSource;this._currentSource=null,this._startTime=-1,t&&t.stop(0)}},Object.defineProperty(t,"paused",{get:function(){return(!this._currentSource||!this._currentSource.loop)&&(-1===this._startTime||this._context.currentTime-this._startTime>this._buffer.duration)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"loop",{get:function(){return this._loop},set:function(t){return this._currentSource&&(this._currentSource.loop=t),this._loop=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"volume",{get:function(){return this._volume},set:function(t){if(this._volume=t,this._gainObj.gain.setTargetAtTime)try{this._gainObj.gain.setTargetAtTime(t,this._context.currentTime,n)}catch(e){this._gainObj.gain.setTargetAtTime(t,this._context.currentTime,.01)}else this._gainObj.gain.value=t;a.os===a.OS_IOS&&!this.paused&&this._currentSource&&(this._currentSource.onended=null,this.pause(),this.play())},enumerable:!0,configurable:!0}),Object.defineProperty(t,"currentTime",{get:function(){return this.paused?this.playedLength:(this.playedLength=this._context.currentTime-this._startTime,this.playedLength%=this._buffer.duration,this.playedLength)},set:function(t){return this.paused?this.playedLength=t:(this.pause(),this.playedLength=t,this.play()),t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"duration",{get:function(){return this._buffer.duration},enumerable:!0,configurable:!0})})(u.prototype),e.exports=cc._Audio=l}),{"../core/assets/CCAudioClip":94,"../core/event/event-target":166,"../core/platform/CCSys":202}],21:[(function(t,e){"use strict";var i=t("./CCAudio"),n=t("../core/assets/CCAudioClip"),r=cc.js,a=0,s=r.createMap(!0),o={},c=[],l=function(t){t._shouldRecycleOnEnded&&(t._finishCallback=null,t.off("ended"),t.off("stop"),t.src=null,c.includes(t)||(c.length<32?c.push(t):t.destroy()),t._shouldRecycleOnEnded=!1)},u=function(t){var e=a++,n=o[t];if(n||(n=o[t]=[]),d._maxAudioInstance<=n.length){var r=n.shift();h(r).stop()}var u=c.pop()||new i,f=function(){if(h(this.id)){delete s[this.id];var t=n.indexOf(this.id);cc.js.array.fastRemoveAt(n,t)}l(this)};return u.on("ended",(function(){this._finishCallback&&this._finishCallback(),this.getLoop()||f.call(this)}),u),u.on("stop",f,u),u.id=e,s[e]=u,n.push(e),u},h=function(t){return s[t]},f=function(t){return void 0===t?t=1:"string"==typeof t&&(t=Number.parseFloat(t)),t},d={AudioState:i.State,_maxAudioInstance:24,_id2audio:s,play:function(t,e,i){if(!(t instanceof n))return cc.error("Wrong type of AudioClip.");var r=t.nativeUrl,a=u(r);return a.src=t,t._ensureLoaded(),a._shouldRecycleOnEnded=!0,a.setLoop(e||!1),i=f(i),a.setVolume(i),a.play(),a.id},setLoop:function(t,e){var i=h(t);i&&i.setLoop&&i.setLoop(e)},isLoop:function(t){var e=h(t);return!(!e||!e.getLoop)&&e.getLoop()},setVolume:function(t,e){var i=h(t);i&&i.setVolume(e)},getVolume:function(t){var e=h(t);return e?e.getVolume():1},setCurrentTime:function(t,e){var i=h(t);return!!i&&(i.setCurrentTime(e),!0)},getCurrentTime:function(t){var e=h(t);return e?e.getCurrentTime():0},getDuration:function(t){var e=h(t);return e?e.getDuration():0},getState:function(t){var e=h(t);return e?e.getState():this.AudioState.ERROR},setFinishCallback:function(t,e){var i=h(t);i&&(i._finishCallback=e)},pause:function(t){var e=h(t);return!!e&&(e.pause(),!0)},_pauseIDCache:[],pauseAll:function(){for(var t in s){var e=s[t];e.getState()===i.State.PLAYING&&(this._pauseIDCache.push(t),e.pause())}},resume:function(t){var e=h(t);e&&e.resume()},resumeAll:function(){for(var t=0;t<this._pauseIDCache.length;++t){var e=this._pauseIDCache[t],i=h(e);i&&i.resume()}this._pauseIDCache.length=0},stop:function(t){var e=h(t);return!!e&&(e.stop(),!0)},stopAll:function(){for(var t in s){var e=s[t];e&&e.stop()}},setMaxAudioInstance:function(){},getMaxAudioInstance:function(){return this._maxAudioInstance},uncache:function(t){var e=t;if("string"==typeof t)cc.warnID(8401,"cc.audioEngine","cc.AudioClip","AudioClip","cc.AudioClip","audio"),e=t;else{if(!t)return;e=t.nativeUrl}var i=o[e];if(i)for(;i.length>0;){var n=i.pop(),r=s[n];r&&(r.stop(),delete s[n])}},uncacheAll:function(){var t;for(var e in this.stopAll(),s)(t=s[e])&&t.destroy();for(;t=c.pop();)t.destroy();s=r.createMap(!0),o={}},_breakCache:null,_break:function(){for(var t in this._breakCache=[],s){var e=s[t];e.getState()===i.State.PLAYING&&(this._breakCache.push(t),e.pause())}},_restore:function(){if(this._breakCache){for(;this._breakCache.length>0;){var t=this._breakCache.pop(),e=h(t);e&&e.resume&&e.resume()}this._breakCache=null}},_music:{id:-1,loop:!1,volume:1},_effect:{volume:1,pauseCache:[]},playMusic:function(t,e){var i=this._music;return this.stop(i.id),i.id=this.play(t,e,i.volume),i.loop=e,i.id},stopMusic:function(){this.stop(this._music.id)},pauseMusic:function(){return this.pause(this._music.id),this._music.id},resumeMusic:function(){return this.resume(this._music.id),this._music.id},getMusicVolume:function(){return this._music.volume},setMusicVolume:function(t){t=f(t);var e=this._music;return e.volume=t,this.setVolume(e.id,e.volume),e.volume},isMusicPlaying:function(){return this.getState(this._music.id)===this.AudioState.PLAYING},playEffect:function(t,e){return this.play(t,e||!1,this._effect.volume)},setEffectsVolume:function(t){t=f(t);var e=this._music.id;for(var i in this._effect.volume=t,s){var n=s[i];n&&n.id!==e&&d.setVolume(i,t)}},getEffectsVolume:function(){return this._effect.volume},pauseEffect:function(t){return this.pause(t)},pauseAllEffects:function(){var t=this._music.id,e=this._effect;for(var i in e.pauseCache.length=0,s){var n=s[i];n&&n.id!==t&&n.getState()===this.AudioState.PLAYING&&(e.pauseCache.push(i),n.pause())}},resumeEffect:function(t){this.resume(t)},resumeAllEffects:function(){for(var t=this._effect.pauseCache,e=0;e<t.length;++e){var i=t[e],n=s[i];n&&n.resume()}},stopEffect:function(t){return this.stop(t)},stopAllEffects:function(){var t=this._music.id;for(var e in s){var i=s[e];i&&i.id!==t&&i.getState()===d.AudioState.PLAYING&&i.stop()}}};e.exports=cc.audioEngine=d}),{"../core/assets/CCAudioClip":94,"./CCAudio":20}],22:[(function(t,e){"use strict";var i={name:"Jacob__Codec"};i.Base64=t("./base64"),i.GZip=t("./gzip"),i.unzip=function(){return i.GZip.gunzip.apply(i.GZip,arguments)},i.unzipBase64=function(){var t=i.Base64.decode.apply(i.Base64,arguments);try{return i.GZip.gunzip.call(i.GZip,t)}catch(e){return t.slice(7)}},i.unzipBase64AsArray=function(t,e){e=e||1;var i,n,r,a=this.unzipBase64(t),s=[];for(i=0,r=a.length/e;i<r;i++)for(s[i]=0,n=e-1;n>=0;--n)s[i]+=a.charCodeAt(i*e+n)<<8*n;return s},i.unzipAsArray=function(t,e){e=e||1;var i,n,r,a=this.unzip(t),s=[];for(i=0,r=a.length/e;i<r;i++)for(s[i]=0,n=e-1;n>=0;--n)s[i]+=a.charCodeAt(i*e+n)<<8*n;return s},cc.codec=e.exports=i}),{"./base64":23,"./gzip":24}],23:[(function(t,e){"use strict";var i=t("../core/utils/misc").BASE64_VALUES,n={name:"Jacob__Codec__Base64",decode:function(t){var e,n,r,a,s,o,c=[],l=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<t.length;)e=i[t.charCodeAt(l++)]<<2|(a=i[t.charCodeAt(l++)])>>4,n=(15&a)<<4|(s=i[t.charCodeAt(l++)])>>2,r=(3&s)<<6|(o=i[t.charCodeAt(l++)]),c.push(String.fromCharCode(e)),64!==s&&c.push(String.fromCharCode(n)),64!==o&&c.push(String.fromCharCode(r));return c.join("")},decodeAsArray:function(t,e){var i,n,r,a=this.decode(t),s=[];for(i=0,r=a.length/e;i<r;i++)for(s[i]=0,n=e-1;n>=0;--n)s[i]+=a.charCodeAt(i*e+n)<<8*n;return s}};e.exports=n}),{"../core/utils/misc":278}],24:[(function(t,e){"use strict";var i=function(t){this.data=t,this.debug=!1,this.gpflags=void 0,this.files=0,this.unzipped=[],this.buf32k=new Array(32768),this.bIdx=0,this.modeZIP=!1,this.bytepos=0,this.bb=1,this.bits=0,this.nameBuf=[],this.fileout=void 0,this.literalTree=new Array(i.LITERALS),this.distanceTree=new Array(32),this.treepos=0,this.Places=null,this.len=0,this.fpos=new Array(17),this.fpos[0]=0,this.flens=void 0,this.fmax=void 0};i.gunzip=function(t){return t.constructor===Array||(t.constructor,String),new i(t).gunzip()[0][0]},i.HufNode=function(){this.b0=0,this.b1=0,this.jump=null,this.jumppos=-1},i.LITERALS=288,i.NAMEMAX=256,i.bitReverse=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],i.cplens=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],i.cplext=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],i.cpdist=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],i.cpdext=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],i.border=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],i.prototype.gunzip=function(){return this.outputArr=[],this.nextFile(),this.unzipped},i.prototype.readByte=function(){return this.bits+=8,this.bytepos<this.data.length?this.data.charCodeAt(this.bytepos++):-1},i.prototype.byteAlign=function(){this.bb=1},i.prototype.readBit=function(){var t;return this.bits++,t=1&this.bb,this.bb>>=1,0===this.bb&&(this.bb=this.readByte(),t=1&this.bb,this.bb=this.bb>>1|128),t},i.prototype.readBits=function(t){for(var e=0,n=t;n--;)e=e<<1|this.readBit();return t&&(e=i.bitReverse[e]>>8-t),e},i.prototype.flushBuffer=function(){this.bIdx=0},i.prototype.addBuffer=function(t){this.buf32k[this.bIdx++]=t,this.outputArr.push(String.fromCharCode(t)),32768===this.bIdx&&(this.bIdx=0)},i.prototype.IsPat=function(){for(;;){if(this.fpos[this.len]>=this.fmax)return-1;if(this.flens[this.fpos[this.len]]===this.len)return this.fpos[this.len]++;this.fpos[this.len]++}},i.prototype.Rec=function(){var t,e=this.Places[this.treepos];if(17===this.len)return-1;if(this.treepos++,this.len++,(t=this.IsPat())>=0)e.b0=t;else if(e.b0=32768,this.Rec())return-1;if((t=this.IsPat())>=0)e.b1=t,e.jump=null;else if(e.b1=32768,e.jump=this.Places[this.treepos],e.jumppos=this.treepos,this.Rec())return-1;return this.len--,0},i.prototype.CreateTree=function(t,e,i){var n;for(this.Places=t,this.treepos=0,this.flens=i,this.fmax=e,n=0;n<17;n++)this.fpos[n]=0;return this.len=0,this.Rec()?-1:0},i.prototype.DecodeValue=function(t){for(var e,i,n=0,r=t[n];;)if(this.readBit()){if(!(32768&r.b1))return r.b1;for(r=r.jump,e=t.length,i=0;i<e;i++)if(t[i]===r){n=i;break}}else{if(!(32768&r.b0))return r.b0;r=t[++n]}return-1},i.prototype.DeflateLoop=function(){var t,e,n;do{var r,a;if(t=this.readBit(),0===(e=this.readBits(2)))for(this.byteAlign(),r=this.readByte(),r|=this.readByte()<<8,a=this.readByte(),65535&(r^~(a|=this.readByte()<<8))&&document.write("BlockLen checksum mismatch\n");r--;)s=this.readByte(),this.addBuffer(s);else if(1===e)for(;;)if((o=i.bitReverse[this.readBits(7)]>>1)>23?(o=o<<1|this.readBit())>199?o=(o-=128)<<1|this.readBit():(o-=48)>143&&(o+=136):o+=256,o<256)this.addBuffer(o);else{if(256===o)break;for(o-=257,p=this.readBits(i.cplext[o])+i.cplens[o],o=i.bitReverse[this.readBits(5)]>>3,i.cpdext[o]>8?(m=this.readBits(8),m|=this.readBits(i.cpdext[o]-8)<<8):m=this.readBits(i.cpdext[o]),m+=i.cpdist[o],o=0;o<p;o++){var s=this.buf32k[this.bIdx-m&32767];this.addBuffer(s)}}else if(2===e){var o,c,l,u,h,f=new Array(320);for(l=257+this.readBits(5),u=1+this.readBits(5),h=4+this.readBits(4),o=0;o<19;o++)f[o]=0;for(o=0;o<h;o++)f[i.border[o]]=this.readBits(3);for(p=this.distanceTree.length,n=0;n<p;n++)this.distanceTree[n]=new i.HufNode;if(this.CreateTree(this.distanceTree,19,f,0))return this.flushBuffer(),1;for(c=l+u,n=0;n<c;)if((o=this.DecodeValue(this.distanceTree))<16)f[n++]=o;else if(16===o){var d;if(n+(o=3+this.readBits(2))>c)return this.flushBuffer(),1;for(d=n?f[n-1]:0;o--;)f[n++]=d}else{if(n+(o=17===o?3+this.readBits(3):11+this.readBits(7))>c)return this.flushBuffer(),1;for(;o--;)f[n++]=0}for(p=this.literalTree.length,n=0;n<p;n++)this.literalTree[n]=new i.HufNode;if(this.CreateTree(this.literalTree,l,f,0))return this.flushBuffer(),1;for(p=this.literalTree.length,n=0;n<p;n++)this.distanceTree[n]=new i.HufNode;var _=new Array;for(n=l;n<f.length;n++)_[n-l]=f[n];if(this.CreateTree(this.distanceTree,u,_,0))return this.flushBuffer(),1;for(;;)if((o=this.DecodeValue(this.literalTree))>=256){var p,m;if(0==(o-=256))break;for(o--,p=this.readBits(i.cplext[o])+i.cplens[o],o=this.DecodeValue(this.distanceTree),i.cpdext[o]>8?(m=this.readBits(8),m|=this.readBits(i.cpdext[o]-8)<<8):m=this.readBits(i.cpdext[o]),m+=i.cpdist[o];p--;)s=this.buf32k[this.bIdx-m&32767],this.addBuffer(s)}else this.addBuffer(o)}}while(!t);return this.flushBuffer(),this.byteAlign(),0},i.prototype.unzipFile=function(t){var e;for(this.gunzip(),e=0;e<this.unzipped.length;e++)if(this.unzipped[e][1]===t)return this.unzipped[e][0]},i.prototype.nextFile=function(){this.outputArr=[],this.modeZIP=!1;var t=[];if(t[0]=this.readByte(),t[1]=this.readByte(),120===t[0]&&218===t[1]&&(this.DeflateLoop(),this.unzipped[this.files]=[this.outputArr.join(""),"geonext.gxt"],this.files++),31===t[0]&&139===t[1]&&(this.skipdir(),this.unzipped[this.files]=[this.outputArr.join(""),"file"],this.files++),80===t[0]&&75===t[1]&&(this.modeZIP=!0,t[2]=this.readByte(),t[3]=this.readByte(),3===t[2]&&4===t[3])){t[0]=this.readByte(),t[1]=this.readByte(),this.gpflags=this.readByte(),this.gpflags|=this.readByte()<<8;var e=this.readByte();e|=this.readByte()<<8,this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte();var n=this.readByte();n|=this.readByte()<<8;var r=this.readByte();for(r|=this.readByte()<<8,s=0,this.nameBuf=[];n--;){var a=this.readByte();"/"===a|":"===a?s=0:s<i.NAMEMAX-1&&(this.nameBuf[s++]=String.fromCharCode(a))}this.fileout||(this.fileout=this.nameBuf);for(var s=0;s<r;)a=this.readByte(),s++;8===e&&(this.DeflateLoop(),this.unzipped[this.files]=[this.outputArr.join(""),this.nameBuf.join("")],this.files++),this.skipdir()}},i.prototype.skipdir=function(){var t,e,n=[];if(8&this.gpflags&&(n[0]=this.readByte(),n[1]=this.readByte(),n[2]=this.readByte(),n[3]=this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte()),this.modeZIP&&this.nextFile(),n[0]=this.readByte(),8!==n[0])return 0;if(this.gpflags=this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),4&this.gpflags)for(n[0]=this.readByte(),n[2]=this.readByte(),this.len=n[0]+256*n[1],t=0;t<this.len;t++)this.readByte();if(8&this.gpflags)for(t=0,this.nameBuf=[];e=this.readByte();)"7"!==e&&":"!==e||(t=0),t<i.NAMEMAX-1&&(this.nameBuf[t++]=e);if(16&this.gpflags)for(;e=this.readByte(););2&this.gpflags&&(this.readByte(),this.readByte()),this.DeflateLoop(),this.readByte(),this.readByte(),this.readByte(),this.readByte(),this.modeZIP&&this.nextFile()},e.exports=i}),{}],25:[(function(t,e){"use strict";(function(){function t(t){throw t}var e=void 0,i=!0,n=this;function r(t,i){var r,a=t.split("."),s=n;!(a[0]in s)&&s.execScript&&s.execScript("var "+a[0]);for(;a.length&&(r=a.shift());)a.length||i===e?s=s[r]?s[r]:s[r]={}:s[r]=i}var a="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array;function s(t){if("string"==typeof t){var e,i,n=t.split("");for(e=0,i=n.length;e<i;e++)n[e]=(255&n[e].charCodeAt(0))>>>0;t=n}for(var r,a=1,s=0,o=t.length,c=0;0<o;){o-=r=1024<o?1024:o;do{s+=a+=t[c++]}while(--r);a%=65521,s%=65521}return(s<<16|a)>>>0}function o(e,i){this.index="number"==typeof i?i:0,this.i=0,this.buffer=e instanceof(a?Uint8Array:Array)?e:new(a?Uint8Array:Array)(32768),2*this.buffer.length<=this.index&&t(Error("invalid index")),this.buffer.length<=this.index&&this.f()}o.prototype.f=function(){var t,e=this.buffer,i=e.length,n=new(a?Uint8Array:Array)(i<<1);if(a)n.set(e);else for(t=0;t<i;++t)n[t]=e[t];return this.buffer=n},o.prototype.d=function(t,e,i){var n,r=this.buffer,a=this.index,s=this.i,o=r[a];if(i&&1<e&&(t=8<e?(d[255&t]<<24|d[t>>>8&255]<<16|d[t>>>16&255]<<8|d[t>>>24&255])>>32-e:d[t]>>8-e),8>e+s)o=o<<e|t,s+=e;else for(n=0;n<e;++n)o=o<<1|t>>e-n-1&1,8==++s&&(s=0,r[a++]=d[o],o=0,a===r.length&&(r=this.f()));r[a]=o,this.buffer=r,this.i=s,this.index=a},o.prototype.finish=function(){var t,e=this.buffer,i=this.index;return 0<this.i&&(e[i]<<=8-this.i,e[i]=d[e[i]],i++),a?t=e.subarray(0,i):(e.length=i,t=e),t};var c,l=new(a?Uint8Array:Array)(256);for(c=0;256>c;++c){for(var u=f=c,h=7,f=f>>>1;f;f>>>=1)u<<=1,u|=1&f,--h;l[c]=(u<<h&255)>>>0}var d=l;function _(t){this.buffer=new(a?Uint16Array:Array)(2*t),this.length=0}function p(t){var e,i,n,r,s,o,c,l,u,h=t.length,f=0,d=Number.POSITIVE_INFINITY;for(l=0;l<h;++l)t[l]>f&&(f=t[l]),t[l]<d&&(d=t[l]);for(e=1<<f,i=new(a?Uint32Array:Array)(e),n=1,r=0,s=2;n<=f;){for(l=0;l<h;++l)if(t[l]===n){for(o=0,c=r,u=0;u<n;++u)o=o<<1|1&c,c>>=1;for(u=o;u<e;u+=s)i[u]=n<<16|l;++r}++n,r<<=1,s<<=1}return[i,f,d]}function m(t,e){this.h=g,this.w=0,this.input=t,this.b=0,e&&(e.lazy&&(this.w=e.lazy),"number"==typeof e.compressionType&&(this.h=e.compressionType),e.outputBuffer&&(this.a=a&&e.outputBuffer instanceof Array?new Uint8Array(e.outputBuffer):e.outputBuffer),"number"==typeof e.outputIndex&&(this.b=e.outputIndex)),this.a||(this.a=new(a?Uint8Array:Array)(32768))}a&&new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]),_.prototype.getParent=function(t){return 2*((t-2)/4|0)},_.prototype.push=function(t,e){var i,n,r,a=this.buffer;for(i=this.length,a[this.length++]=e,a[this.length++]=t;0<i&&(n=this.getParent(i),a[i]>a[n]);)r=a[i],a[i]=a[n],a[n]=r,r=a[i+1],a[i+1]=a[n+1],a[n+1]=r,i=n;return this.length},_.prototype.pop=function(){var t,e,i,n,r,a=this.buffer;for(e=a[0],t=a[1],this.length-=2,a[0]=a[this.length],a[1]=a[this.length+1],r=0;!((n=2*r+2)>=this.length)&&(n+2<this.length&&a[n+2]>a[n]&&(n+=2),a[n]>a[r]);)i=a[r],a[r]=a[n],a[n]=i,i=a[r+1],a[r+1]=a[n+1],a[n+1]=i,r=n;return{index:t,value:e,length:this.length}};var v,g=2,y={NONE:0,r:1,j:g,N:3},T=[];for(v=0;288>v;v++)switch(i){case 143>=v:T.push([v+48,8]);break;case 255>=v:T.push([v-144+400,9]);break;case 279>=v:T.push([v-256+0,7]);break;case 287>=v:T.push([v-280+192,8]);break;default:t("invalid literal: "+v)}function b(t,e){this.length=t,this.G=e}function E(){var e=A;switch(i){case 3===e:return[257,e-3,0];case 4===e:return[258,e-4,0];case 5===e:return[259,e-5,0];case 6===e:return[260,e-6,0];case 7===e:return[261,e-7,0];case 8===e:return[262,e-8,0];case 9===e:return[263,e-9,0];case 10===e:return[264,e-10,0];case 12>=e:return[265,e-11,1];case 14>=e:return[266,e-13,1];case 16>=e:return[267,e-15,1];case 18>=e:return[268,e-17,1];case 22>=e:return[269,e-19,2];case 26>=e:return[270,e-23,2];case 30>=e:return[271,e-27,2];case 34>=e:return[272,e-31,2];case 42>=e:return[273,e-35,3];case 50>=e:return[274,e-43,3];case 58>=e:return[275,e-51,3];case 66>=e:return[276,e-59,3];case 82>=e:return[277,e-67,4];case 98>=e:return[278,e-83,4];case 114>=e:return[279,e-99,4];case 130>=e:return[280,e-115,4];case 162>=e:return[281,e-131,5];case 194>=e:return[282,e-163,5];case 226>=e:return[283,e-195,5];case 257>=e:return[284,e-227,5];case 258===e:return[285,e-258,0];default:t("invalid length: "+e)}}m.prototype.n=function(){var n,r,s,c,l=this.input;switch(this.h){case 0:for(s=0,c=l.length;s<c;){var u,h,f,d=r=a?l.subarray(s,s+65535):l.slice(s,s+65535),_=(s+=r.length)===c,p=e,m=e,v=this.a,y=this.b;if(a){for(v=new Uint8Array(this.a.buffer);v.length<=y+d.length+5;)v=new Uint8Array(v.length<<1);v.set(this.a)}if(u=_?1:0,v[y++]=0|u,f=65536+~(h=d.length)&65535,v[y++]=255&h,v[y++]=h>>>8&255,v[y++]=255&f,v[y++]=f>>>8&255,a)v.set(d,y),y+=d.length,v=v.subarray(0,y);else{for(p=0,m=d.length;p<m;++p)v[y++]=d[p];v.length=y}this.b=y,this.a=v}break;case 1:var b=new o(new Uint8Array(this.a.buffer),this.b);b.d(1,1,i),b.d(1,2,i);var E,A,C,x=w(this,l);for(E=0,A=x.length;E<A;E++)if(C=x[E],o.prototype.d.apply(b,T[C]),256<C)b.d(x[++E],x[++E],i),b.d(x[++E],5),b.d(x[++E],x[++E],i);else if(256===C)break;this.a=b.finish(),this.b=this.a.length;break;case g:var S,I,O,D,P,L,N,F,B,k,V,z,U,H,W,G=new o(new Uint8Array(this.a),this.b),j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y=Array(19);for(S=g,G.d(1,1,i),G.d(S,2,i),I=w(this,l),N=R(L=M(this.L,15)),B=R(F=M(this.K,7)),O=286;257<O&&0===L[O-1];O--);for(D=30;1<D&&0===F[D-1];D--);var X,q,Z,K,Q,J,$=O,tt=D,et=new(a?Uint32Array:Array)($+tt),it=new(a?Uint32Array:Array)(316),nt=new(a?Uint8Array:Array)(19);for(X=q=0;X<$;X++)et[q++]=L[X];for(X=0;X<tt;X++)et[q++]=F[X];if(!a)for(X=0,K=nt.length;X<K;++X)nt[X]=0;for(X=Q=0,K=et.length;X<K;X+=q){for(q=1;X+q<K&&et[X+q]===et[X];++q);if(Z=q,0===et[X])if(3>Z)for(;0<Z--;)it[Q++]=0,nt[0]++;else for(;0<Z;)(J=138>Z?Z:138)>Z-3&&J<Z&&(J=Z-3),10>=J?(it[Q++]=17,it[Q++]=J-3,nt[17]++):(it[Q++]=18,it[Q++]=J-11,nt[18]++),Z-=J;else if(it[Q++]=et[X],nt[et[X]]++,3>--Z)for(;0<Z--;)it[Q++]=et[X],nt[et[X]]++;else for(;0<Z;)(J=6>Z?Z:6)>Z-3&&J<Z&&(J=Z-3),it[Q++]=16,it[Q++]=J-3,nt[16]++,Z-=J}for(n=a?it.subarray(0,Q):it.slice(0,Q),k=M(nt,7),H=0;19>H;H++)Y[H]=k[j[H]];for(P=19;4<P&&0===Y[P-1];P--);for(V=R(k),G.d(O-257,5,i),G.d(D-1,5,i),G.d(P-4,4,i),H=0;H<P;H++)G.d(Y[H],3,i);for(H=0,W=n.length;H<W;H++)if(z=n[H],G.d(V[z],k[z],i),16<=z){switch(H++,z){case 16:U=2;break;case 17:U=3;break;case 18:U=7;break;default:t("invalid code: "+z)}G.d(n[H],U,i)}var rt,at,st,ot,ct,lt,ut,ht,ft=[N,L],dt=[B,F];for(ct=ft[0],lt=ft[1],ut=dt[0],ht=dt[1],rt=0,at=I.length;rt<at;++rt)if(st=I[rt],G.d(ct[st],lt[st],i),256<st)G.d(I[++rt],I[++rt],i),ot=I[++rt],G.d(ut[ot],ht[ot],i),G.d(I[++rt],I[++rt],i);else if(256===st)break;this.a=G.finish(),this.b=this.a.length;break;default:t("invalid compression type")}return this.a};var A,C,x=[];for(A=3;258>=A;A++)C=E(),x[A]=C[2]<<24|C[1]<<16|C[0];var S=a?new Uint32Array(x):x;function w(n,r){function s(e,n){var r,a,s,o,c=e.G,l=[],u=0;switch(r=S[e.length],l[u++]=65535&r,l[u++]=r>>16&255,l[u++]=r>>24,i){case 1===c:a=[0,c-1,0];break;case 2===c:a=[1,c-2,0];break;case 3===c:a=[2,c-3,0];break;case 4===c:a=[3,c-4,0];break;case 6>=c:a=[4,c-5,1];break;case 8>=c:a=[5,c-7,1];break;case 12>=c:a=[6,c-9,2];break;case 16>=c:a=[7,c-13,2];break;case 24>=c:a=[8,c-17,3];break;case 32>=c:a=[9,c-25,3];break;case 48>=c:a=[10,c-33,4];break;case 64>=c:a=[11,c-49,4];break;case 96>=c:a=[12,c-65,5];break;case 128>=c:a=[13,c-97,5];break;case 192>=c:a=[14,c-129,6];break;case 256>=c:a=[15,c-193,6];break;case 384>=c:a=[16,c-257,7];break;case 512>=c:a=[17,c-385,7];break;case 768>=c:a=[18,c-513,8];break;case 1024>=c:a=[19,c-769,8];break;case 1536>=c:a=[20,c-1025,9];break;case 2048>=c:a=[21,c-1537,9];break;case 3072>=c:a=[22,c-2049,10];break;case 4096>=c:a=[23,c-3073,10];break;case 6144>=c:a=[24,c-4097,11];break;case 8192>=c:a=[25,c-6145,11];break;case 12288>=c:a=[26,c-8193,12];break;case 16384>=c:a=[27,c-12289,12];break;case 24576>=c:a=[28,c-16385,13];break;case 32768>=c:a=[29,c-24577,13];break;default:t("invalid distance")}for(r=a,l[u++]=r[0],l[u++]=r[1],l[u++]=r[2],s=0,o=l.length;s<o;++s)v[g++]=l[s];T[l[0]]++,E[l[3]]++,y=e.length+n-1,_=null}var o,c,l,u,h,f,d,_,p,m={},v=a?new Uint16Array(2*r.length):[],g=0,y=0,T=new(a?Uint32Array:Array)(286),E=new(a?Uint32Array:Array)(30),A=n.w;if(!a){for(l=0;285>=l;)T[l++]=0;for(l=0;29>=l;)E[l++]=0}for(T[256]=1,o=0,c=r.length;o<c;++o){for(l=h=0,u=3;l<u&&o+l!==c;++l)h=h<<8|r[o+l];if(m[h]===e&&(m[h]=[]),f=m[h],!(0<y--)){for(;0<f.length&&32768<o-f[0];)f.shift();if(o+3>=c){for(_&&s(_,-1),l=0,u=c-o;l<u;++l)p=r[o+l],v[g++]=p,++T[p];break}if(0<f.length){var C=e,x=e,w=0,M=e,R=e,I=e,O=r.length,D=(R=0,f.length);t:for(;R<D;R++){if(C=f[D-R-1],M=3,3<w){for(I=w;3<I;I--)if(r[C+I-1]!==r[o+I-1])continue t;M=w}for(;258>M&&o+M<O&&r[C+M]===r[o+M];)++M;if(M>w&&(x=C,w=M),258===M)break}d=new b(w,o-x),_?_.length<d.length?(p=r[o-1],v[g++]=p,++T[p],s(d,0)):s(_,-1):d.length<A?_=d:s(d,0)}else _?s(_,-1):(p=r[o],v[g++]=p,++T[p])}f.push(o)}return v[g++]=256,T[256]++,n.L=T,n.K=E,a?v.subarray(0,g):v}function M(t,e){function i(t){var e=A[t][C[t]];e===g?(i(t+1),i(t+1)):--b[e],++C[t]}var n,r,s,o,c,l=t.length,u=new _(572),h=new(a?Uint8Array:Array)(l);if(!a)for(o=0;o<l;o++)h[o]=0;for(o=0;o<l;++o)0<t[o]&&u.push(o,t[o]);if(n=Array(u.length/2),r=new(a?Uint32Array:Array)(u.length/2),1===n.length)return h[u.pop().index]=1,h;for(o=0,c=u.length/2;o<c;++o)n[o]=u.pop(),r[o]=n[o].value;var f,d,p,m,v,g=r.length,y=new(a?Uint16Array:Array)(e),T=new(a?Uint8Array:Array)(e),b=new(a?Uint8Array:Array)(g),E=Array(e),A=Array(e),C=Array(e),x=(1<<e)-g,S=1<<e-1;for(y[e-1]=g,d=0;d<e;++d)x<S?T[d]=0:(T[d]=1,x-=S),x<<=1,y[e-2-d]=(y[e-1-d]/2|0)+g;for(y[0]=T[0],E[0]=Array(y[0]),A[0]=Array(y[0]),d=1;d<e;++d)y[d]>2*y[d-1]+T[d]&&(y[d]=2*y[d-1]+T[d]),E[d]=Array(y[d]),A[d]=Array(y[d]);for(f=0;f<g;++f)b[f]=e;for(p=0;p<y[e-1];++p)E[e-1][p]=r[p],A[e-1][p]=p;for(f=0;f<e;++f)C[f]=0;for(1===T[e-1]&&(--b[0],++C[e-1]),d=e-2;0<=d;--d){for(m=f=0,v=C[d+1],p=0;p<y[d];p++)(m=E[d+1][v]+E[d+1][v+1])>r[f]?(E[d][p]=m,A[d][p]=g,v+=2):(E[d][p]=r[f],A[d][p]=f,++f);C[d]=0,1===T[d]&&i(d)}for(s=b,o=0,c=n.length;o<c;++o)h[n[o].index]=s[o];return h}function R(e){var i,n,r,s,o=new(a?Uint16Array:Array)(e.length),c=[],l=[],u=0;for(i=0,n=e.length;i<n;i++)c[e[i]]=1+(0|c[e[i]]);for(i=1,n=16;i<=n;i++)l[i]=u,(u+=0|c[i])>1<<i&&t("overcommitted"),u<<=1;for(65536>u&&t("undercommitted"),i=0,n=e.length;i<n;i++)for(u=l[e[i]],l[e[i]]+=1,r=o[i]=0,s=e[i];r<s;r++)o[i]=o[i]<<1|1&u,u>>>=1;return o}function I(t,e){this.input=t,this.a=new(a?Uint8Array:Array)(32768),this.h=O.j;var i,n={};for(i in!e&&(e={})||"number"!=typeof e.compressionType||(this.h=e.compressionType),e)n[i]=e[i];n.outputBuffer=this.a,this.z=new m(this.input,n)}var O=y;function D(e,i){switch(this.k=[],this.l=32768,this.e=this.g=this.c=this.q=0,this.input=a?new Uint8Array(e):e,this.s=!1,this.m=L,this.B=!1,!i&&(i={})||(i.index&&(this.c=i.index),i.bufferSize&&(this.l=i.bufferSize),i.bufferType&&(this.m=i.bufferType),i.resize&&(this.B=i.resize)),this.m){case P:this.b=32768,this.a=new(a?Uint8Array:Array)(32768+this.l+258);break;case L:this.b=0,this.a=new(a?Uint8Array:Array)(this.l),this.f=this.J,this.t=this.H,this.o=this.I;break;default:t(Error("invalid inflate mode"))}}I.prototype.n=function(){var e,i,n,r,o,c,l,u=0;switch(l=this.a,e=ut){case ut:i=Math.LOG2E*Math.log(32768)-8;break;default:t(Error("invalid compression method"))}switch(n=i<<4|e,l[u++]=n,e){case ut:switch(this.h){case O.NONE:o=0;break;case O.r:o=1;break;case O.j:o=2;break;default:t(Error("unsupported compression type"))}break;default:t(Error("invalid compression method"))}return r=o<<6|0,l[u++]=r|31-(256*n+r)%31,c=s(this.input),this.z.b=u,u=(l=this.z.n()).length,a&&((l=new Uint8Array(l.buffer)).length<=u+4&&(this.a=new Uint8Array(l.length+4),this.a.set(l),l=this.a),l=l.subarray(0,u+4)),l[u++]=c>>24&255,l[u++]=c>>16&255,l[u++]=c>>8&255,l[u++]=255&c,l},r("Zlib.Deflate",I),r("Zlib.Deflate.compress",(function(t,e){return new I(t,e).n()})),r("Zlib.Deflate.CompressionType",O),r("Zlib.Deflate.CompressionType.NONE",O.NONE),r("Zlib.Deflate.CompressionType.FIXED",O.r),r("Zlib.Deflate.CompressionType.DYNAMIC",O.j);var P=0,L=1,N={D:P,C:L};D.prototype.p=function(){for(;!this.s;){var n=tt(this,3);switch(1&n&&(this.s=i),n>>>=1){case 0:var r=this.input,s=this.c,o=this.a,c=this.b,l=e,u=e,h=e,f=o.length,d=e;switch(this.e=this.g=0,(l=r[s++])===e&&t(Error("invalid uncompressed block header: LEN (first byte)")),u=l,(l=r[s++])===e&&t(Error("invalid uncompressed block header: LEN (second byte)")),u|=l<<8,(l=r[s++])===e&&t(Error("invalid uncompressed block header: NLEN (first byte)")),h=l,(l=r[s++])===e&&t(Error("invalid uncompressed block header: NLEN (second byte)")),u===~(h|=l<<8)&&t(Error("invalid uncompressed block header: length verify")),s+u>r.length&&t(Error("input buffer is broken")),this.m){case P:for(;c+u>o.length;){if(u-=d=f-c,a)o.set(r.subarray(s,s+d),c),c+=d,s+=d;else for(;d--;)o[c++]=r[s++];this.b=c,o=this.f(),c=this.b}break;case L:for(;c+u>o.length;)o=this.f({v:2});break;default:t(Error("invalid inflate mode"))}if(a)o.set(r.subarray(s,s+u),c),c+=u,s+=u;else for(;u--;)o[c++]=r[s++];this.c=s,this.b=c,this.a=o;break;case 1:this.o(Q,$);break;case 2:it(this);break;default:t(Error("unknown BTYPE: "+n))}}return this.t()};var F,B,k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=a?new Uint16Array(k):k,z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],U=a?new Uint16Array(z):z,H=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],W=a?new Uint8Array(H):H,G=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],j=a?new Uint16Array(G):G,Y=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],X=a?new Uint8Array(Y):Y,q=new(a?Uint8Array:Array)(288);for(F=0,B=q.length;F<B;++F)q[F]=143>=F?8:255>=F?9:279>=F?7:8;var Z,K,Q=p(q),J=new(a?Uint8Array:Array)(30);for(Z=0,K=J.length;Z<K;++Z)J[Z]=5;var $=p(J);function tt(i,n){for(var r,a=i.g,s=i.e,o=i.input,c=i.c;s<n;)(r=o[c++])===e&&t(Error("input buffer is broken")),a|=r<<s,s+=8;return r=a&(1<<n)-1,i.g=a>>>n,i.e=s-n,i.c=c,r}function et(i,n){for(var r,a,s,o=i.g,c=i.e,l=i.input,u=i.c,h=n[0],f=n[1];c<f;)(r=l[u++])===e&&t(Error("input buffer is broken")),o|=r<<c,c+=8;return s=(a=h[o&(1<<f)-1])>>>16,i.g=o>>s,i.e=c-s,i.c=u,65535&a}function it(t){function e(t,e,i){var n,r,a,s;for(s=0;s<t;)switch(n=et(this,e)){case 16:for(a=3+tt(this,2);a--;)i[s++]=r;break;case 17:for(a=3+tt(this,3);a--;)i[s++]=0;r=0;break;case 18:for(a=11+tt(this,7);a--;)i[s++]=0;r=0;break;default:r=i[s++]=n}return i}var i,n,r,s,o=tt(t,5)+257,c=tt(t,5)+1,l=tt(t,4)+4,u=new(a?Uint8Array:Array)(V.length);for(s=0;s<l;++s)u[V[s]]=tt(t,3);i=p(u),n=new(a?Uint8Array:Array)(o),r=new(a?Uint8Array:Array)(c),t.o(p(e.call(t,o,i,n)),p(e.call(t,c,i,r)))}function nt(e,i){var n,r;switch(this.input=e,this.c=0,!i&&(i={})||(i.index&&(this.c=i.index),i.verify&&(this.M=i.verify)),n=e[this.c++],r=e[this.c++],15&n){case ut:this.method=ut;break;default:t(Error("unsupported compression method"))}0!=((n<<8)+r)%31&&t(Error("invalid fcheck flag:"+((n<<8)+r)%31)),32&r&&t(Error("fdict flag is not supported")),this.A=new D(e,{index:this.c,bufferSize:i.bufferSize,bufferType:i.bufferType,resize:i.resize})}D.prototype.o=function(t,e){var i=this.a,n=this.b;this.u=t;for(var r,a,s,o,c=i.length-258;256!==(r=et(this,t));)if(256>r)n>=c&&(this.b=n,i=this.f(),n=this.b),i[n++]=r;else for(o=U[a=r-257],0<W[a]&&(o+=tt(this,W[a])),r=et(this,e),s=j[r],0<X[r]&&(s+=tt(this,X[r])),n>=c&&(this.b=n,i=this.f(),n=this.b);o--;)i[n]=i[n++-s];for(;8<=this.e;)this.e-=8,this.c--;this.b=n},D.prototype.I=function(t,e){var i=this.a,n=this.b;this.u=t;for(var r,a,s,o,c=i.length;256!==(r=et(this,t));)if(256>r)n>=c&&(c=(i=this.f()).length),i[n++]=r;else for(o=U[a=r-257],0<W[a]&&(o+=tt(this,W[a])),r=et(this,e),s=j[r],0<X[r]&&(s+=tt(this,X[r])),n+o>c&&(c=(i=this.f()).length);o--;)i[n]=i[n++-s];for(;8<=this.e;)this.e-=8,this.c--;this.b=n},D.prototype.f=function(){var t,e,i=new(a?Uint8Array:Array)(this.b-32768),n=this.b-32768,r=this.a;if(a)i.set(r.subarray(32768,i.length));else for(t=0,e=i.length;t<e;++t)i[t]=r[t+32768];if(this.k.push(i),this.q+=i.length,a)r.set(r.subarray(n,n+32768));else for(t=0;32768>t;++t)r[t]=r[n+t];return this.b=32768,r},D.prototype.J=function(t){var e,i,n,r=this.input.length/this.c+1|0,s=this.input,o=this.a;return t&&("number"==typeof t.v&&(r=t.v),"number"==typeof t.F&&(r+=t.F)),i=2>r?(n=(s.length-this.c)/this.u[2]/2*258|0)<o.length?o.length+n:o.length<<1:o.length*r,a?(e=new Uint8Array(i)).set(o):e=o,this.a=e},D.prototype.t=function(){var t,e,i,n,r,s=0,o=this.a,c=this.k,l=new(a?Uint8Array:Array)(this.q+(this.b-32768));if(0===c.length)return a?this.a.subarray(32768,this.b):this.a.slice(32768,this.b);for(e=0,i=c.length;e<i;++e)for(n=0,r=(t=c[e]).length;n<r;++n)l[s++]=t[n];for(e=32768,i=this.b;e<i;++e)l[s++]=o[e];return this.k=[],this.buffer=l},D.prototype.H=function(){var t,e=this.b;return a?this.B?(t=new Uint8Array(e)).set(this.a.subarray(0,e)):t=this.a.subarray(0,e):(this.a.length>e&&(this.a.length=e),t=this.a),this.buffer=t},nt.prototype.p=function(){var e,i=this.input;return e=this.A.p(),this.c=this.A.c,this.M&&(i[this.c++]<<24|i[this.c++]<<16|i[this.c++]<<8|i[this.c++])>>>0!==s(e)&&t(Error("invalid adler-32 checksum")),e},r("Zlib.Inflate",nt),r("Zlib.Inflate.BufferType",N),N.ADAPTIVE=N.C,N.BLOCK=N.D,r("Zlib.Inflate.prototype.decompress",nt.prototype.p),a&&new Uint16Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),a&&new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258]),a&&new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0]),a&&new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577]),a&&new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]);var rt,at,st=new(a?Uint8Array:Array)(288);for(rt=0,at=st.length;rt<at;++rt)st[rt]=143>=rt?8:255>=rt?9:279>=rt?7:8;p(st);var ot,ct,lt=new(a?Uint8Array:Array)(30);for(ot=0,ct=lt.length;ot<ct;++ot)lt[ot]=5;p(lt);var ut=8}).call(window);var i=window.Zlib;i.Deflate=i.Deflate,i.Deflate.compress=i.Deflate.compress,i.Inflate=i.Inflate,i.Inflate.BufferType=i.Inflate.BufferType,i.Inflate.prototype.decompress=i.Inflate.prototype.decompress,e.exports=i}),{}],26:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r,a,s,o,c,l,u,h,f,d,_,p,m,v,g,y,T,b,E,A,C,x=D(t("../../renderer/enums")),S=D(t("../value-types/color")),w=t("../value-types"),M=D(t("../renderer/index")),R=D(t("../platform/CCEnum")),I=D(t("../components/CCComponent")),O=t("../platform/CCClassDecorator");function D(t){return t&&t.__esModule?t:{default:t}}function P(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function L(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function N(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function F(t,e,i,n,r){var a={};return Object.keys(n).forEach((function(t){a[t]=n[t]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}var B=null;B=t("../../renderer/scene/light");var k=(0,R.default)({DIRECTIONAL:0,POINT:1,SPOT:2,AMBIENT:3}),V=(0,R.default)({NONE:0,HARD:2,SOFT_PCF3X3:3,SOFT_PCF5X5:4}),z=(n=(0,O.ccclass)("cc.Light"),r=(0,O.menu)("i18n:MAIN_MENU.component.renderers/Light"),a=(0,O.inspector)("packages://inspector/inspectors/comps/light.js"),s=(0,O.property)({type:k}),o=(0,O.property)({type:V}),n(c=r(c=(0,O.executeInEditMode)(c=a((C=A=(function(t){var e,i,n,r;function a(){var e;return P(e=t.call(this)||this,"_type",u,L(e)),P(e,"_color",h,L(e)),P(e,"_intensity",f,L(e)),P(e,"_range",d,L(e)),P(e,"_spotAngle",_,L(e)),P(e,"_spotExp",p,L(e)),P(e,"_shadowType",m,L(e)),P(e,"_shadowResolution",v,L(e)),P(e,"_shadowDarkness",g,L(e)),P(e,"_shadowMinDepth",y,L(e)),P(e,"_shadowMaxDepth",T,L(e)),P(e,"_shadowFrustumSize",b,L(e)),P(e,"_shadowBias",E,L(e)),e._light=new B,e}i=t,(e=a).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i,n=a,(r=[{key:"type",get:function(){return this._type},set:function(t){this._type=t;var e=x.default.LIGHT_DIRECTIONAL;t===k.POINT?e=x.default.LIGHT_POINT:t===k.SPOT?e=x.default.LIGHT_SPOT:t===k.AMBIENT&&(e=x.default.LIGHT_AMBIENT),this._light.setType(e)}},{key:"color",get:function(){return this._color},set:function(t){this._color.equals(t)||this._color.set(t),this._light.setColor(t.r/255,t.g/255,t.b/255)}},{key:"intensity",get:function(){return this._intensity},set:function(t){this._intensity=t,this._light.setIntensity(t)}},{key:"range",get:function(){return this._range},set:function(t){this._range=t,this._light.setRange(t)}},{key:"spotAngle",get:function(){return this._spotAngle},set:function(t){this._spotAngle=t,this._light.setSpotAngle((0,w.toRadian)(t))}},{key:"spotExp",get:function(){return this._spotExp},set:function(t){this._spotExp=t,this._light.setSpotExp(t)}},{key:"shadowType",get:function(){return this._shadowType},set:function(t){this._shadowType=t,this._light.setShadowType(t)}},{key:"shadowResolution",get:function(){return this._shadowResolution},set:function(t){this._shadowResolution=t,this._light.setShadowResolution(t)}},{key:"shadowDarkness",get:function(){return this._shadowDarkness},set:function(t){this._shadowDarkness=t,this._light.setShadowDarkness(t)}},{key:"shadowMinDepth",get:function(){return this._shadowMinDepth},set:function(t){this._shadowMinDepth=t,this._light.setShadowMinDepth(t)}},{key:"shadowMaxDepth",get:function(){return this._shadowMaxDepth},set:function(t){this._shadowMaxDepth=t,this._light.setShadowMaxDepth(t)}},{key:"shadowFrustumSize",get:function(){return this._shadowFrustumSize},set:function(t){this._shadowFrustumSize=t,this._light.setShadowFrustumSize(t)}}])&&N(n.prototype,r);var s=a.prototype;return s.onLoad=function(){this._light.setNode(this.node),this.type=this._type,this.color=this._color,this.intensity=this._intensity,this.range=this._range,this.spotAngle=this._spotAngle,this.spotExp=this._spotExp,this.shadowType=this._shadowType,this.shadowResolution=this._shadowResolution,this.shadowDarkness=this._shadowDarkness,this.shadowMaxDepth=this._shadowMaxDepth,this.shadowFrustumSize=this._shadowFrustumSize,this.shadowBias=this._shadowBias},s.onEnable=function(){M.default.scene.addLight(this._light)},s.onDisable=function(){M.default.scene.removeLight(this._light)},a})(I.default),A.Type=k,A.ShadowType=V,u=F((l=C).prototype,"_type",[O.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return k.DIRECTIONAL}}),h=F(l.prototype,"_color",[O.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return S.default.WHITE}}),f=F(l.prototype,"_intensity",[O.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),d=F(l.prototype,"_range",[O.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1e3}}),_=F(l.prototype,"_spotAngle",[O.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 60}}),p=F(l.prototype,"_spotExp",[O.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),m=F(l.prototype,"_shadowType",[O.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return V.NONE}}),v=F(l.prototype,"_shadowResolution",[O.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1024}}),g=F(l.prototype,"_shadowDarkness",[O.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.5}}),y=F(l.prototype,"_shadowMinDepth",[O.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),T=F(l.prototype,"_shadowMaxDepth",[O.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 4096}}),b=F(l.prototype,"_shadowFrustumSize",[O.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1024}}),E=F(l.prototype,"_shadowBias",[O.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5e-4}}),F(l.prototype,"type",[s],Object.getOwnPropertyDescriptor(l.prototype,"type"),l.prototype),F(l.prototype,"color",[O.property],Object.getOwnPropertyDescriptor(l.prototype,"color"),l.prototype),F(l.prototype,"intensity",[O.property],Object.getOwnPropertyDescriptor(l.prototype,"intensity"),l.prototype),F(l.prototype,"range",[O.property],Object.getOwnPropertyDescriptor(l.prototype,"range"),l.prototype),F(l.prototype,"spotAngle",[O.property],Object.getOwnPropertyDescriptor(l.prototype,"spotAngle"),l.prototype),F(l.prototype,"spotExp",[O.property],Object.getOwnPropertyDescriptor(l.prototype,"spotExp"),l.prototype),F(l.prototype,"shadowType",[o],Object.getOwnPropertyDescriptor(l.prototype,"shadowType"),l.prototype),F(l.prototype,"shadowResolution",[O.property],Object.getOwnPropertyDescriptor(l.prototype,"shadowResolution"),l.prototype),F(l.prototype,"shadowDarkness",[O.property],Object.getOwnPropertyDescriptor(l.prototype,"shadowDarkness"),l.prototype),F(l.prototype,"shadowMinDepth",[O.property],Object.getOwnPropertyDescriptor(l.prototype,"shadowMinDepth"),l.prototype),F(l.prototype,"shadowMaxDepth",[O.property],Object.getOwnPropertyDescriptor(l.prototype,"shadowMaxDepth"),l.prototype),F(l.prototype,"shadowFrustumSize",[O.property],Object.getOwnPropertyDescriptor(l.prototype,"shadowFrustumSize"),l.prototype),c=l))||c)||c)||c)||c);i.default=z,cc.Light=z,e.exports=i.default}),{"../../renderer/enums":321,"../../renderer/scene/light":347,"../components/CCComponent":129,"../platform/CCClassDecorator":194,"../platform/CCEnum":195,"../renderer/index":225,"../value-types":293,"../value-types/color":292}],27:[(function(t,e){"use strict";var i=cc.Class({name:"cc.Model",extends:cc.Asset,ctor:function(){this._rootNode=null,this.loaded=!1},properties:{_nodes:{default:[]},_precomputeJointMatrix:!1,nodes:{get:function(){return this._nodes}},rootNode:{get:function(){return this._rootNode}},precomputeJointMatrix:{get:function(){return this._precomputeJointMatrix}}},onLoad:function(){var t=this._nodes;this._rootNode=t[0];for(var e=0;e<t.length;e++){var i=t[e];i.position=cc.v3.apply(this,i.position),i.scale=cc.v3.apply(this,i.scale),i.quat=cc.quat.apply(this,i.quat),i.uniqueBindPose&&(i.uniqueBindPose=cc.mat4.apply(this,i.uniqueBindPose));var n=i.bindpose;if(n)for(var r in n)n[r]=cc.mat4.apply(this,n[r]);var a=i.children;if(a)for(var s=0;s<a.length;s++)a[s]=t[a[s]]}}});cc.Model=e.exports=i}),{}],28:[(function(t){"use strict";var e=n(t("../value-types/quat")),i=n(t("../value-types/vec3"));function n(t){return t&&t.__esModule?t:{default:t}}var r=cc.quat(),a=cc.v3();cc.Rotate3DTo=cc.Class({name:"cc.Rotate3DTo",extends:cc.ActionInterval,ctor:function(t,e,i,n){this._startQuat=cc.quat(),this._dstQuat=cc.quat(),void 0!==e&&this.initWithDuration(t,e,i,n)},initWithDuration:function(t,i,n,r){if(cc.ActionInterval.prototype.initWithDuration.call(this,t)){var a=this._dstQuat;return i instanceof cc.Quat?a.set(i):(i instanceof cc.Vec3?(n=i.y,r=i.z,i=i.x):(n=n||0,r=r||0),e.default.fromEuler(a,i,n,r)),!0}return!1},clone:function(){var t=new cc.Rotate3DTo;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._dstQuat),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._startQuat.set(t.quat)},reverse:function(){cc.logID(1016)},update:function(t){t=this._computeEaseTime(t),this.target&&(e.default.slerp(r,this._startQuat,this._dstQuat,t),this.target.setRotation(r))}}),cc.rotate3DTo=function(t,e,i,n){return new cc.Rotate3DTo(t,e,i,n)},cc.Rotate3DBy=cc.Class({name:"cc.Rotate3DBy",extends:cc.ActionInterval,ctor:function(t,e,i,n){this._startQuat=cc.quat(),this._dstQuat=cc.quat(),this._deltaAngle=cc.v3(),void 0!==e&&this.initWithDuration(t,e,i,n)},initWithDuration:function(t,e,n,r){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(e instanceof cc.Vec3?(n=e.y,r=e.z,e=e.x):(n=n||0,r=r||0),i.default.set(this._deltaAngle,e,n,r),!0)},clone:function(){var t=new cc.Rotate3DBy;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._angle),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t);var i=t.eulerAngles,n=this._deltaAngle;e.default.fromEuler(this._dstQuat,i.x+n.x,i.y+n.y,i.z+n.z),this._startQuat.set(t.quat)},update:(Math.PI,function(t){t=this._computeEaseTime(t),this.target&&(e.default.slerp(r,this._startQuat,this._dstQuat,t),this.target.setRotation(r))}),reverse:function(){var t=this._angle;a.x=-t.x,a.y=-t.y,a.z=-t.z;var e=new cc.Rotate3DBy(this._duration,a);return this._cloneDecoration(e),this._reverseEaseList(e),e}}),cc.rotate3DBy=function(t,e,i,n){return new cc.Rotate3DBy(t,e,i,n)}}),{"../value-types/quat":296,"../value-types/vec3":303}],29:[(function(t){"use strict";t("./primitive"),t("./physics/exports/physics-builtin"),t("./physics/exports/physics-cannon"),t("./physics/exports/physics-framework"),t("./CCModel"),t("./skeleton/CCSkeleton"),t("./skeleton/CCSkeletonAnimationClip"),t("./actions"),t("./physics/framework/assets/physics-material"),t("./skeleton/CCSkeletonAnimation"),t("./skeleton/CCSkinnedMeshRenderer"),t("./skeleton/skinned-mesh-renderer"),t("./CCLightComponent"),t("./particle/particle-system-3d"),t("./particle/renderer/particle-system-3d-renderer")}),{"./CCLightComponent":26,"./CCModel":27,"./actions":28,"./particle/particle-system-3d":45,"./particle/renderer/particle-system-3d-renderer":48,"./physics/exports/physics-builtin":void 0,"./physics/exports/physics-cannon":void 0,"./physics/exports/physics-framework":void 0,"./physics/framework/assets/physics-material":void 0,"./primitive":void 0,"./skeleton/CCSkeleton":52,"./skeleton/CCSkeletonAnimation":53,"./skeleton/CCSkeletonAnimationClip":54,"./skeleton/CCSkinnedMeshRenderer":55,"./skeleton/skinned-mesh-renderer":56}],30:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r,a,s,o,c,l,u=t("../../../platform/CCClassDecorator"),h=t("../../../value-types"),f=(n=t("./gradient-range"))&&n.__esModule?n:{default:n};function d(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function _(t,e,i,n,r){var a={};return Object.keys(n).forEach((function(t){a[t]=n[t]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}var p=(r=(0,u.ccclass)("cc.ColorOvertimeModule"),a=(0,u.property)({type:f.default}),r((c=_((o=(function(){function t(){d(this,"enable",c,this),d(this,"color",l,this)}return t.prototype.animate=function(t){this.enable&&(t.color.set(t.startColor),t.color.multiply(this.color.evaluate(1-t.remainingLifetime/t.startLifetime,(0,h.pseudoRandom)(t.randomSeed+91041))))},t})()).prototype,"enable",[u.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),l=_(o.prototype,"color",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new f.default}}),s=o))||s);i.default=p,e.exports=i.default}),{"../../../platform/CCClassDecorator":194,"../../../value-types":293,"./gradient-range":33}],31:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=i.Mode=void 0;var n,r,a,s,o,c,l,u,h,f,d,_,p,m,v,g,y,T,b=t("../../../platform/CCClassDecorator"),E=(n=t("../../../platform/CCEnum"))&&n.__esModule?n:{default:n},A=t("../../../value-types"),C=t("../curve");function x(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function S(t,e,i,n,r){var a={};return Object.keys(n).forEach((function(t){a[t]=n[t]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}var w=(0,E.default)({Constant:0,Curve:1,TwoCurves:2,TwoConstants:3});i.Mode=w;var M=(r=(0,b.ccclass)("cc.CurveRange"),a=(0,b.property)({type:w}),s=(0,b.property)({type:C.AnimationCurve}),o=(0,b.property)({type:C.AnimationCurve}),c=(0,b.property)({type:C.AnimationCurve}),r((T=y=(function(){function t(){x(this,"mode",h,this),x(this,"curve",f,this),x(this,"curveMin",d,this),x(this,"curveMax",_,this),x(this,"constant",p,this),x(this,"constantMin",m,this),x(this,"constantMax",v,this),x(this,"multiplier",g,this)}var e=t.prototype;return e.evaluate=function(t,e){switch(this.mode){case w.Constant:return this.constant;case w.Curve:return this.curve.evaluate(t)*this.multiplier;case w.TwoCurves:return(0,A.lerp)(this.curveMin.evaluate(t),this.curveMax.evaluate(t),e)*this.multiplier;case w.TwoConstants:return(0,A.lerp)(this.constantMin,this.constantMax,e)}},e.getMax=function(){switch(this.mode){case w.Constant:return this.constant;case w.Curve:return this.multiplier;case w.TwoConstants:return this.constantMax;case w.TwoCurves:return this.multiplier}return 0},t})(),y.Mode=w,h=S((u=T).prototype,"mode",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return w.Constant}}),f=S(u.prototype,"curve",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new C.AnimationCurve}}),d=S(u.prototype,"curveMin",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new C.AnimationCurve}}),_=S(u.prototype,"curveMax",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new C.AnimationCurve}}),p=S(u.prototype,"constant",[b.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),m=S(u.prototype,"constantMin",[b.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),v=S(u.prototype,"constantMax",[b.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),g=S(u.prototype,"multiplier",[b.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),l=u))||l);i.default=M,cc.CurveRange=M}),{"../../../platform/CCClassDecorator":194,"../../../platform/CCEnum":195,"../../../value-types":293,"../curve":41}],32:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r,a,s,o,c,l,u,h,f,d,_,p,m=t("../../../platform/CCClassDecorator"),v=t("../../../value-types"),g=t("../enum"),y=t("../particle-general-function"),T=(n=t("./curve-range"))&&n.__esModule?n:{default:n};function b(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function E(t,e,i,n,r){var a={};return Object.keys(n).forEach((function(t){a[t]=n[t]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}var A=cc.v3(),C=(r=(0,m.ccclass)("cc.ForceOvertimeModule"),a=(0,m.property)({type:g.Space}),s=(0,m.property)({type:T.default,range:[-1,1]}),o=(0,m.property)({type:T.default,range:[-1,1]}),c=(0,m.property)({type:T.default,range:[-1,1],displayOrder:4}),r((h=E((u=(function(){function t(){b(this,"enable",h,this),b(this,"space",f,this),b(this,"x",d,this),b(this,"y",_,this),b(this,"z",p,this),this.randomized=!1,this.rotation=null,this.needTransform=!1,this.rotation=new v.Quat,this.needTransform=!1}var e=t.prototype;return e.update=function(t,e){this.needTransform=(0,y.calculateTransform)(t,this.space,e,this.rotation)},e.animate=function(t,e){var i=1-t.remainingLifetime/t.startLifetime,n=v.Vec3.set(A,this.x.evaluate(i,(0,v.pseudoRandom)(t.randomSeed+212165)),this.y.evaluate(i,(0,v.pseudoRandom)(t.randomSeed+212165)),this.z.evaluate(i,(0,v.pseudoRandom)(t.randomSeed+212165)));this.needTransform&&v.Vec3.transformQuat(n,n,this.rotation),v.Vec3.scaleAndAdd(t.velocity,t.velocity,n,e)},t})()).prototype,"enable",[m.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f=E(u.prototype,"space",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return g.Space.Local}}),d=E(u.prototype,"x",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new T.default}}),_=E(u.prototype,"y",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new T.default}}),p=E(u.prototype,"z",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new T.default}}),l=u))||l);i.default=C,e.exports=i.default}),{"../../../platform/CCClassDecorator":194,"../../../value-types":293,"../enum":43,"../particle-general-function":44,"./curve-range":31}],33:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r,a,s,o,c,l,u,h,f,d,_,p,m,v,g,y,T,b=t("../../../platform/CCClassDecorator"),E=(n=t("../../../platform/CCEnum"))&&n.__esModule?n:{default:n},A=t("./gradient");function C(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function x(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function S(t,e,i,n,r){var a={};return Object.keys(n).forEach((function(t){a[t]=n[t]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}var w=(0,E.default)({Color:0,Gradient:1,TwoColors:2,TwoGradients:3,RandomColor:4}),M=(r=(0,b.ccclass)("cc.GradientRange"),a=(0,b.property)({type:w}),s=(0,b.property)({type:A.Gradient}),o=(0,b.property)({type:A.Gradient}),c=(0,b.property)({type:A.Gradient}),r((T=y=(function(){function t(){C(this,"_mode",h,this),C(this,"_color",f,this),C(this,"color",d,this),C(this,"colorMin",_,this),C(this,"colorMax",p,this),C(this,"gradient",m,this),C(this,"gradientMin",v,this),C(this,"gradientMax",g,this)}var e,i;return t.prototype.evaluate=function(t,e){switch(this._mode){case w.Color:return this.color;case w.TwoColors:return this.colorMin.lerp(this.colorMax,e,this._color),this._color;case w.RandomColor:return this.gradient.randomColor();case w.Gradient:return this.gradient.evaluate(t);case w.TwoGradients:return this.gradientMin.evaluate(t).lerp(this.gradientMax.evaluate(t),e,this._color),this._color;default:return this.color}},e=t,(i=[{key:"mode",get:function(){return this._mode},set:function(t){this._mode=t}}])&&x(e.prototype,i),t})(),y.Mode=w,h=S((u=T).prototype,"_mode",[b.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return w.Color}}),S(u.prototype,"mode",[a],Object.getOwnPropertyDescriptor(u.prototype,"mode"),u.prototype),f=S(u.prototype,"_color",[b.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return cc.Color.WHITE.clone()}}),d=S(u.prototype,"color",[b.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return cc.Color.WHITE.clone()}}),_=S(u.prototype,"colorMin",[b.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return cc.Color.WHITE.clone()}}),p=S(u.prototype,"colorMax",[b.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return cc.Color.WHITE.clone()}}),m=S(u.prototype,"gradient",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new A.Gradient}}),v=S(u.prototype,"gradientMin",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new A.Gradient}}),g=S(u.prototype,"gradientMax",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new A.Gradient}}),l=u))||l);i.default=M,cc.GradientRange=M,e.exports=i.default}),{"../../../platform/CCClassDecorator":194,"../../../platform/CCEnum":195,"./gradient":34}],34:[(function(t,e,i){"use strict";i.__esModule=!0,i.Gradient=i.AlphaKey=i.ColorKey=void 0;var n,r,a,s,o,c,l,u,h,f,d,_,p,m,v,g,y,T,b,E,A=t("../../../platform/CCClassDecorator"),C=(n=t("../../../platform/CCEnum"))&&n.__esModule?n:{default:n},x=t("../../../value-types");function S(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function w(t,e,i,n,r){var a={};return Object.keys(n).forEach((function(t){a[t]=n[t]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}var M=(0,C.default)({Blend:0,Fixed:1}),R=(0,A.ccclass)("cc.ColorKey")((s=w((a=function(){S(this,"color",s,this),S(this,"time",o,this)}).prototype,"color",[A.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return cc.Color.WHITE.clone()}}),o=w(a.prototype,"time",[A.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),r=a))||r;i.ColorKey=R;var I=(0,A.ccclass)("cc.AlphaKey")((u=w((l=function(){S(this,"alpha",u,this),S(this,"time",h,this)}).prototype,"alpha",[A.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),h=w(l.prototype,"time",[A.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),c=l))||c;i.AlphaKey=I;var O=(f=(0,A.ccclass)("cc.Gradient"),d=(0,A.property)({type:[R]}),_=(0,A.property)({type:[I]}),p=(0,A.property)({type:M}),f((E=b=(function(){function t(){S(this,"colorKeys",g,this),S(this,"alphaKeys",y,this),S(this,"mode",T,this),this._color=null,this._color=cc.Color.WHITE.clone()}var e=t.prototype;return e.setKeys=function(t,e){this.colorKeys=t,this.alphaKeys=e},e.sortKeys=function(){this.colorKeys.length>1&&this.colorKeys.sort((function(t,e){return t.time-e.time})),this.alphaKeys.length>1&&this.alphaKeys.sort((function(t,e){return t.time-e.time}))},e.evaluate=function(t){return this.getRGB(t),this._color._fastSetA(this.getAlpha(t)),this._color},e.randomColor=function(){var t=this.colorKeys[Math.trunc(Math.random()*this.colorKeys.length)],e=this.alphaKeys[Math.trunc(Math.random()*this.alphaKeys.length)];return this._color.set(t.color),this._color._fastSetA(e.alpha),this._color},e.getRGB=function(t){if(!(this.colorKeys.length>1))return 1===this.colorKeys.length?(this._color.set(this.colorKeys[0].color),this._color):(this._color.set(cc.Color.WHITE),this._color);t=(0,x.repeat)(t,1);for(var e=1;e<this.colorKeys.length;++e){var i=this.colorKeys[e-1].time,n=this.colorKeys[e].time;if(t>=i&&t<n){if(this.mode===M.Fixed)return this.colorKeys[e].color;var r=(t-i)/(n-i);return this.colorKeys[e-1].color.lerp(this.colorKeys[e].color,r,this._color),this._color}}var a=this.colorKeys.length-1;t<this.colorKeys[0].time?cc.Color.BLACK.lerp(this.colorKeys[0].color,t/this.colorKeys[0].time,this._color):t>this.colorKeys[a].time&&this.colorKeys[a].color.lerp(cc.Color.BLACK,(t-this.colorKeys[a].time)/(1-this.colorKeys[a].time),this._color)},e.getAlpha=function(t){if(!(this.alphaKeys.length>1))return 1===this.alphaKeys.length?this.alphaKeys[0].alpha:255;t=(0,x.repeat)(t,1);for(var e=1;e<this.alphaKeys.length;++e){var i=this.alphaKeys[e-1].time,n=this.alphaKeys[e].time;if(t>=i&&t<n){if(this.mode===M.Fixed)return this.alphaKeys[e].alpha;var r=(t-i)/(n-i);return(0,x.lerp)(this.alphaKeys[e-1].alpha,this.alphaKeys[e].alpha,r)}}var a=this.alphaKeys.length-1;return t<this.alphaKeys[0].time?(0,x.lerp)(255,this.alphaKeys[0].alpha,t/this.alphaKeys[0].time):t>this.alphaKeys[a].time?(0,x.lerp)(this.alphaKeys[a].alpha,255,(t-this.alphaKeys[a].time)/(1-this.alphaKeys[a].time)):void 0},t})(),b.Mode=M,g=w((v=E).prototype,"colorKeys",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Array}}),y=w(v.prototype,"alphaKeys",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Array}}),T=w(v.prototype,"mode",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return M.Blend}}),m=v))||m);i.Gradient=O,cc.ColorKey=R,cc.AlphaKey=I,cc.Gradient=O}),{"../../../platform/CCClassDecorator":194,"../../../platform/CCEnum":195,"../../../value-types":293}],35:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r,a,s,o,c,l,u,h,f,d,_,p,m,v,g,y,T=t("../../../platform/CCClassDecorator"),b=t("../../../value-types"),E=t("../enum"),A=(n=t("./curve-range"))&&n.__esModule?n:{default:n};function C(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function x(t,e,i,n,r){var a={};return Object.keys(n).forEach((function(t){a[t]=n[t]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}var S=cc.v3(),w=cc.v3();function M(t,e,i){var n=Math.sign(t),r=Math.abs(t);return r>e&&(r=(0,b.lerp)(r,e,i)),r*n}var R=(r=(0,T.ccclass)("cc.LimitVelocityOvertimeModule"),a=(0,T.property)({type:E.Space}),s=(0,T.property)({type:A.default,range:[-1,1]}),o=(0,T.property)({type:A.default,range:[-1,1]}),c=(0,T.property)({type:A.default,range:[-1,1]}),l=(0,T.property)({type:A.default,range:[-1,1]}),r((f=x((h=(function(){function t(){C(this,"enable",f,this),C(this,"space",d,this),C(this,"separateAxes",_,this),C(this,"limit",p,this),C(this,"limitX",m,this),C(this,"limitY",v,this),C(this,"limitZ",g,this),C(this,"dampen",y,this),this.drag=null,this.multiplyDragByParticleSize=!1,this.multiplyDragByParticleVelocity=!1,this.rotation=null,this.needTransform=!1,this.rotation=new b.Quat,this.needTransform=!1}var e=t.prototype;return e.update=function(t,e){this.needTransform=calculateTransform(t,this.space,e,this.rotation)},e.animate=function(t){var e=1-t.remainingLifetime/t.startLifetime,i=S;this.separateAxes?(b.Vec3.set(w,this.limitX.evaluate(e,(0,b.pseudoRandom)(t.randomSeed+23541)),this.limitY.evaluate(e,(0,b.pseudoRandom)(t.randomSeed+23541)),this.limitZ.evaluate(e,(0,b.pseudoRandom)(t.randomSeed+23541))),this.needTransform&&b.Vec3.transformQuat(w,w,this.rotation),b.Vec3.set(i,M(t.ultimateVelocity.x,w.x,this.dampen),M(t.ultimateVelocity.y,w.y,this.dampen),M(t.ultimateVelocity.z,w.z,this.dampen))):(b.Vec3.normalize(i,t.ultimateVelocity),b.Vec3.scale(i,i,M(t.ultimateVelocity.len(),this.limit.evaluate(e,(0,b.pseudoRandom)(t.randomSeed+23541)),this.dampen))),b.Vec3.copy(t.ultimateVelocity,i)},t})()).prototype,"enable",[T.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=x(h.prototype,"space",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return E.Space.Local}}),_=x(h.prototype,"separateAxes",[T.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),p=x(h.prototype,"limit",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new A.default}}),m=x(h.prototype,"limitX",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new A.default}}),v=x(h.prototype,"limitY",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new A.default}}),g=x(h.prototype,"limitZ",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new A.default}}),y=x(h.prototype,"dampen",[T.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),u=h))||u);i.default=R,e.exports=i.default}),{"../../../platform/CCClassDecorator":194,"../../../value-types":293,"../enum":43,"./curve-range":31}],36:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r,a,s,o,c,l,u,h,f,d,_,p=t("../../../platform/CCClassDecorator"),m=t("../../../value-types"),v=(n=t("./curve-range"))&&n.__esModule?n:{default:n};function g(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function y(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function T(t,e,i,n,r){var a={};return Object.keys(n).forEach((function(t){a[t]=n[t]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}var b=(r=(0,p.ccclass)("cc.RotationOvertimeModule"),a=(0,p.property)({type:v.default,range:[-1,1],radian:!0}),s=(0,p.property)({type:v.default,range:[-1,1],radian:!0}),o=(0,p.property)({type:v.default,range:[-1,1],radian:!0}),r((u=T((l=(function(){var t,e;function i(){g(this,"enable",u,this),g(this,"_separateAxes",h,this),g(this,"x",f,this),g(this,"y",d,this),g(this,"z",_,this)}return t=i,(e=[{key:"separateAxes",get:function(){return this._separateAxes},set:function(t){t?console.error("rotation overtime separateAxes is not supported!"):this._separateAxes=t}}])&&y(t.prototype,e),i.prototype.animate=function(t,e){var i=1-t.remainingLifetime/t.startLifetime;if(this._separateAxes){var n=(0,m.pseudoRandom)(t.randomSeed+125292);t.rotation.x+=this.x.evaluate(i,n)*e,t.rotation.y+=this.y.evaluate(i,n)*e,t.rotation.z+=this.z.evaluate(i,n)*e}else t.rotation.x+=this.z.evaluate(i,(0,m.pseudoRandom)(t.randomSeed+125292))*e},i})()).prototype,"enable",[p.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),h=T(l.prototype,"_separateAxes",[p.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),T(l.prototype,"separateAxes",[p.property],Object.getOwnPropertyDescriptor(l.prototype,"separateAxes"),l.prototype),f=T(l.prototype,"x",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new v.default}}),d=T(l.prototype,"y",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new v.default}}),_=T(l.prototype,"z",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new v.default}}),c=l))||c);i.default=b,e.exports=i.default}),{"../../../platform/CCClassDecorator":194,"../../../value-types":293,"./curve-range":31}],37:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r,a,s,o,c,l,u,h,f,d,_,p,m,v=t("../../../platform/CCClassDecorator"),g=t("../../../value-types"),y=(n=t("./curve-range"))&&n.__esModule?n:{default:n};function T(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function b(t,e,i,n,r){var a={};return Object.keys(n).forEach((function(t){a[t]=n[t]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}var E=(r=(0,v.ccclass)("cc.SizeOvertimeModule"),a=(0,v.property)({type:y.default}),s=(0,v.property)({type:y.default}),o=(0,v.property)({type:y.default}),c=(0,v.property)({type:y.default}),r((h=b((u=(function(){function t(){T(this,"enable",h,this),T(this,"separateAxes",f,this),T(this,"size",d,this),T(this,"x",_,this),T(this,"y",p,this),T(this,"z",m,this)}return t.prototype.animate=function(t){if(this.separateAxes){var e=1-t.remainingLifetime/t.startLifetime,i=(0,g.pseudoRandom)(t.randomSeed+39825);t.size.x=t.startSize.x*this.x.evaluate(e,i),t.size.y=t.startSize.y*this.y.evaluate(e,i),t.size.z=t.startSize.z*this.z.evaluate(e,i)}else g.Vec3.scale(t.size,t.startSize,this.size.evaluate(1-t.remainingLifetime/t.startLifetime,(0,g.pseudoRandom)(t.randomSeed+39825)))},t})()).prototype,"enable",[v.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f=b(u.prototype,"separateAxes",[v.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=b(u.prototype,"size",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new y.default}}),_=b(u.prototype,"x",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new y.default}}),p=b(u.prototype,"y",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new y.default}}),m=b(u.prototype,"z",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new y.default}}),l=u))||l);i.default=E,e.exports=i.default}),{"../../../platform/CCClassDecorator":194,"../../../value-types":293,"./curve-range":31}],38:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r,a,s,o,c,l,u,h,f,d,_,p,m,v,g,y,T=t("../../../platform/CCClassDecorator"),b=C(t("../../../platform/CCEnum")),E=t("../../../value-types"),A=C(t("./curve-range"));function C(t){return t&&t.__esModule?t:{default:t}}function x(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function S(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function w(t,e,i,n,r){var a={};return Object.keys(n).forEach((function(t){a[t]=n[t]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}var M=(0,b.default)({Grid:0}),R=(0,b.default)({WholeSheet:0,SingleRow:1}),I=(n=(0,T.ccclass)("cc.TextureAnimationModule"),r=(0,T.property)({type:M}),a=(0,T.property)({type:R}),s=(0,T.property)({type:A.default}),o=(0,T.property)({type:A.default}),n((u=w((l=(function(){function t(){x(this,"_enable",u,this),x(this,"_mode",h,this),x(this,"numTilesX",f,this),x(this,"numTilesY",d,this),x(this,"animation",_,this),x(this,"randomRow",p,this),x(this,"rowIndex",m,this),x(this,"frameOverTime",v,this),x(this,"startFrame",g,this),x(this,"cycleCount",y,this),this._flipU=0,this._flipV=0,this._uvChannelMask=-1,this.ps=null}var e,i,n=t.prototype;return n.onInit=function(t){this.ps=t},n.init=function(t){t.startRow=Math.floor(Math.random()*this.numTilesY)},n.animate=function(t){var e=1-t.remainingLifetime/t.startLifetime,i=this.startFrame.evaluate(e,(0,E.pseudoRandom)(t.randomSeed+90794))/(this.numTilesX*this.numTilesY);if(this.animation===R.WholeSheet)t.frameIndex=(0,E.repeat)(this.cycleCount*(this.frameOverTime.evaluate(e,(0,E.pseudoRandom)(t.randomSeed+90794))+i),1);else if(this.animation===R.SingleRow){var n=1/this.numTilesY;if(this.randomRow){var r=(0,E.repeat)(this.cycleCount*(this.frameOverTime.evaluate(e,(0,E.pseudoRandom)(t.randomSeed+90794))+i),1),a=t.startRow*n,s=a+n;t.frameIndex=(0,E.lerp)(a,s,r)}else{var o=this.rowIndex*n,c=o+n;t.frameIndex=(0,E.lerp)(o,c,(0,E.repeat)(this.cycleCount*(this.frameOverTime.evaluate(e,(0,E.pseudoRandom)(t.randomSeed+90794))+i),1))}}},e=t,(i=[{key:"enable",get:function(){return this._enable},set:function(t){this._enable=t,this.ps._assembler._updateMaterialParams()}},{key:"mode",get:function(){return this._mode},set:function(t){t===M.Grid||console.error("particle texture animation's sprites is not supported!")}},{key:"flipU",get:function(){return this._flipU},set:function(){console.error("particle texture animation's flipU is not supported!")}},{key:"flipV",get:function(){return this._flipV},set:function(){console.error("particle texture animation's flipV is not supported!")}},{key:"uvChannelMask",get:function(){return this._uvChannelMask},set:function(){console.error("particle texture animation's uvChannelMask is not supported!")}}])&&S(e.prototype,i),t})()).prototype,"_enable",[T.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),w(l.prototype,"enable",[T.property],Object.getOwnPropertyDescriptor(l.prototype,"enable"),l.prototype),h=w(l.prototype,"_mode",[T.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return M.Grid}}),w(l.prototype,"mode",[r],Object.getOwnPropertyDescriptor(l.prototype,"mode"),l.prototype),f=w(l.prototype,"numTilesX",[T.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),d=w(l.prototype,"numTilesY",[T.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),_=w(l.prototype,"animation",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return R.WholeSheet}}),p=w(l.prototype,"randomRow",[T.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),m=w(l.prototype,"rowIndex",[T.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),v=w(l.prototype,"frameOverTime",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new A.default}}),g=w(l.prototype,"startFrame",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new A.default}}),y=w(l.prototype,"cycleCount",[T.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),w(l.prototype,"flipU",[T.property],Object.getOwnPropertyDescriptor(l.prototype,"flipU"),l.prototype),w(l.prototype,"flipV",[T.property],Object.getOwnPropertyDescriptor(l.prototype,"flipV"),l.prototype),w(l.prototype,"uvChannelMask",[T.property],Object.getOwnPropertyDescriptor(l.prototype,"uvChannelMask"),l.prototype),c=l))||c);i.default=I,e.exports=i.default}),{"../../../platform/CCClassDecorator":194,"../../../platform/CCEnum":195,"../../../value-types":293,"./curve-range":31}],39:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r,a,s,o,c,l,u,h,f,d,_,p,m,v,g=t("../../../platform/CCClassDecorator"),y=t("../../../value-types"),T=t("../enum"),b=t("../particle-general-function"),E=(n=t("./curve-range"))&&n.__esModule?n:{default:n};function A(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function C(t,e,i,n,r){var a={};return Object.keys(n).forEach((function(t){a[t]=n[t]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}var x=cc.v3(),S=(r=(0,g.ccclass)("cc.VelocityOvertimeModule"),a=(0,g.property)({type:T.Space}),s=(0,g.property)({type:E.default,range:[-1,1]}),o=(0,g.property)({type:E.default,range:[-1,1]}),c=(0,g.property)({type:E.default,range:[-1,1]}),l=(0,g.property)({type:E.default,range:[-1,1]}),r((f=C((h=(function(){function t(){A(this,"enable",f,this),A(this,"space",d,this),A(this,"x",_,this),A(this,"y",p,this),A(this,"z",m,this),A(this,"speedModifier",v,this),this.rotation=null,this.needTransform=!1,this.rotation=new y.Quat,this.speedModifier.constant=1,this.needTransform=!1}var e=t.prototype;return e.update=function(t,e){this.needTransform=(0,b.calculateTransform)(t,this.space,e,this.rotation)},e.animate=function(t){var e=1-t.remainingLifetime/t.startLifetime,i=y.Vec3.set(x,this.x.evaluate(e,(0,y.pseudoRandom)(t.randomSeed+197866)),this.y.evaluate(e,(0,y.pseudoRandom)(t.randomSeed+197866)),this.z.evaluate(e,(0,y.pseudoRandom)(t.randomSeed+197866)));this.needTransform&&y.Vec3.transformQuat(i,i,this.rotation),y.Vec3.add(t.animatedVelocity,t.animatedVelocity,i),y.Vec3.add(t.ultimateVelocity,t.velocity,t.animatedVelocity),y.Vec3.scale(t.ultimateVelocity,t.ultimateVelocity,this.speedModifier.evaluate(1-t.remainingLifetime/t.startLifetime,(0,y.pseudoRandom)(t.randomSeed+197866)))},t})()).prototype,"enable",[g.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),d=C(h.prototype,"space",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return T.Space.Local}}),_=C(h.prototype,"x",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new E.default}}),p=C(h.prototype,"y",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new E.default}}),m=C(h.prototype,"z",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new E.default}}),v=C(h.prototype,"speedModifier",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new E.default}}),u=h))||u);i.default=S,e.exports=i.default}),{"../../../platform/CCClassDecorator":194,"../../../value-types":293,"../enum":43,"../particle-general-function":44,"./curve-range":31}],40:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r,a,s,o,c,l,u,h,f,d,_=t("../../platform/CCClassDecorator"),p=t("../../value-types"),m=(n=t("./animator/curve-range"))&&n.__esModule?n:{default:n};function v(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function g(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function y(t,e,i,n,r){var a={};return Object.keys(n).forEach((function(t){a[t]=n[t]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}var T=(r=(0,_.ccclass)("cc.Burst"),a=(0,_.property)({type:m.default}),r((c=y((o=(function(){var t,e;function i(){v(this,"_time",c,this),v(this,"minCount",l,this),v(this,"maxCount",u,this),v(this,"_repeatCount",h,this),v(this,"repeatInterval",f,this),v(this,"count",d,this),this._remainingCount=0,this._curTime=0,this._remainingCount=0,this._curTime=0}t=i,(e=[{key:"time",get:function(){return this._time},set:function(t){this._time=t,this._curTime=t}},{key:"repeatCount",get:function(){return this._repeatCount},set:function(t){this._repeatCount=t,this._remainingCount=t}}])&&g(t.prototype,e);var n=i.prototype;return n.update=function(t,e){if(0===this._remainingCount&&(this._remainingCount=this._repeatCount,this._curTime=this._time),this._remainingCount>0){var i=(0,p.repeat)(t._time-t.startDelay.evaluate(0,1),t.duration)-e;i=i>0?i:0;var n=(0,p.repeat)(t.time-t.startDelay.evaluate(0,1),t.duration);this._curTime>=i&&this._curTime<n&&(t.emit(this.count.evaluate(this._curTime/t.duration,1),e-(n-this._curTime)),this._curTime+=this.repeatInterval,--this._remainingCount)}},n.getMaxCount=function(t){return this.count.getMax()*Math.min(Math.ceil(t.duration/this.repeatInterval),this.repeatCount)},i})()).prototype,"_time",[_.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),y(o.prototype,"time",[_.property],Object.getOwnPropertyDescriptor(o.prototype,"time"),o.prototype),l=y(o.prototype,"minCount",[_.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 30}}),u=y(o.prototype,"maxCount",[_.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 30}}),h=y(o.prototype,"_repeatCount",[_.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),y(o.prototype,"repeatCount",[_.property],Object.getOwnPropertyDescriptor(o.prototype,"repeatCount"),o.prototype),f=y(o.prototype,"repeatInterval",[_.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),d=y(o.prototype,"count",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new m.default}}),s=o))||s);i.default=T,e.exports=i.default}),{"../../platform/CCClassDecorator":194,"../../value-types":293,"./animator/curve-range":31}],41:[(function(t,e,i){"use strict";i.__esModule=!0,i.evalOptCurve=w,i.AnimationCurve=i.OptimizedKey=i.Keyframe=void 0;var n,r,a,s,o,c,l,u,h,f,d,_,p,m,v,g,y=(n=t("../../platform/CCEnum"))&&n.__esModule?n:{default:n},T=t("../../value-types"),b=t("../../platform/CCClassDecorator");function E(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function A(t,e,i,n,r){var a={};return Object.keys(n).forEach((function(t){a[t]=n[t]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}var C=(0,y.default)({Default:0,Once:1,Loop:2,PingPong:3,ClampForever:4}),x=(0,b.ccclass)("cc.Keyframe")((s=A((a=function(t,e,i,n){E(this,"time",s,this),E(this,"value",o,this),E(this,"inTangent",c,this),E(this,"outTangent",l,this),this.time=t||0,this.value=e||0,this.inTangent=i||0,this.outTangent=n||0}).prototype,"time",[b.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),o=A(a.prototype,"value",[b.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),c=A(a.prototype,"inTangent",[b.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),l=A(a.prototype,"outTangent",[b.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),r=a))||r;i.Keyframe=x;var S=(function(){function t(){this.index=0,this.time=0,this.endTime=0,this.coefficient=null,this.index=-1,this.time=0,this.endTime=0,this.coefficient=new Float32Array(4)}return t.prototype.evaluate=function(t){return w(t-this.time,this.coefficient)},t})();function w(t,e){return t*(t*(t*e[0]+e[1])+e[2])+e[3]}i.OptimizedKey=S;var M=new x(0,1,0,0),R=new x(1,1,0,0),I=(u=(0,b.ccclass)("cc.AnimationCurve"),h=(0,b.property)({type:[x]}),f=(0,b.property)({type:cc.Enum(C),visible:!1}),d=(0,b.property)({type:cc.Enum(C),visible:!1}),u((m=A((p=(function(){function t(t){void 0===t&&(t=null),E(this,"keyFrames",m,this),E(this,"preWrapMode",v,this),E(this,"postWrapMode",g,this),this.cachedKey=null,t?this.keyFrames=t:(this.keyFrames.push(M),this.keyFrames.push(R)),this.cachedKey=new S}var e=t.prototype;return e.addKey=function(t){null==this.keyFrames&&(this.keyFrames=[]),this.keyFrames.push(t)},e.evaluate_slow=function(t){var e=t,i=t<0?this.preWrapMode:this.postWrapMode,n=this.keyFrames[0].time,r=this.keyFrames[this.keyFrames.length-1].time;switch(i){case C.Loop:e=(0,T.repeat)(t-n,r-n)+n;break;case C.PingPong:e=(0,T.pingPong)(t-n,r-n)+n;break;case C.ClampForever:e=(0,T.clamp)(t,n,r)}var a=0;if(e>this.keyFrames[0].time)if(e>=this.keyFrames[this.keyFrames.length-1].time)a=this.keyFrames.length-2;else for(var s=0;s<this.keyFrames.length-1;s++)if(e>=this.keyFrames[0].time&&e<=this.keyFrames[s+1].time){a=s;break}var o=this.keyFrames[a],c=this.keyFrames[a+1],l=(0,T.inverseLerp)(o.time,c.time,e),u=c.time-o.time,h=o.outTangent*u,f=c.inTangent*u,d=l*l,_=d*l,p=_-2*d+l,m=_-d,v=-2*_+3*d;return(2*_-3*d+1)*o.value+p*h+m*f+v*c.value},e.evaluate=function(t){var e=t,i=t<0?this.preWrapMode:this.postWrapMode,n=this.keyFrames[0].time,r=this.keyFrames[this.keyFrames.length-1].time;switch(i){case C.Loop:e=(0,T.repeat)(t-n,r-n)+n;break;case C.PingPong:e=(0,T.pingPong)(t-n,r-n)+n;break;case C.ClampForever:e=(0,T.clamp)(t,n,r)}if(e>=this.cachedKey.time&&e<this.cachedKey.endTime)return this.cachedKey.evaluate(e);var a=this.findIndex(this.cachedKey,e),s=a+1;return s===this.keyFrames.length&&(s-=1),this.calcOptimizedKey(this.cachedKey,a,s),this.cachedKey.evaluate(e)},e.calcOptimizedKey=function(t,e,i){var n=this.keyFrames[e],r=this.keyFrames[i];t.index=e,t.time=n.time,t.endTime=r.time;var a=r.time-n.time,s=r.value-n.value,o=1/(a*a),c=n.outTangent*a,l=r.inTangent*a;t.coefficient[0]=(c+l-s-s)*o/a,t.coefficient[1]=(s+s+s-c-c-l)*o,t.coefficient[2]=n.outTangent,t.coefficient[3]=n.value},e.findIndex=function(t,e){var i=t.index;if(-1!==i)if(e>this.keyFrames[i].time)for(var n=0;n<3;n++){var r=i+n;if(r+1<this.keyFrames.length&&this.keyFrames[r+1].time>e)return r}else for(var a=0;a<3;a++){var s=i-a;if(s>=0&&this.keyFrames[s-1].time<=e)return s-1}for(var o=0,c=this.keyFrames.length,l=Math.floor((o+c)/2);c-o>1;)this.keyFrames[l].time>=e?c=l:o=l+1,l=Math.floor((o+c)/2);return o},t})()).prototype,"keyFrames",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Array}}),v=A(p.prototype,"preWrapMode",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return C.Loop}}),g=A(p.prototype,"postWrapMode",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return C.Loop}}),_=p))||_);i.AnimationCurve=I,cc.Keyframe=x,cc.AnimationCurve=I}),{"../../platform/CCClassDecorator":194,"../../platform/CCEnum":195,"../../value-types":293}],42:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r,a,s,o,c,l,u,h,f,d,_,p,m,v,g,y,T,b,E,A,C,x,S,w,M,R,I=t("../../../platform/CCClassDecorator"),O=t("../../../value-types"),D=(n=t("../animator/curve-range"))&&n.__esModule?n:{default:n},P=t("../particle-general-function"),L=t("../enum");function N(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function F(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function B(t,e,i,n,r){var a={};return Object.keys(n).forEach((function(t){a[t]=n[t]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}var k=new O.Vec3(0,0,0),V=new Array,z=new O.Vec3(.5,.5,.5),U=(r=(0,I.ccclass)("cc.ShapeModule"),a=(0,I.property)({type:L.ShapeType}),s=(0,I.property)({type:L.EmitLocation}),o=(0,I.property)({type:L.ArcMode}),c=(0,I.property)({type:D.default}),r((h=B((u=(function(){var t,e;function i(){N(this,"enable",h,this),N(this,"_shapeType",f,this),N(this,"emitFrom",d,this),N(this,"radius",_,this),N(this,"radiusThickness",p,this),N(this,"_angle",m,this),N(this,"_arc",v,this),N(this,"arcMode",g,this),N(this,"arcSpread",y,this),N(this,"arcSpeed",T,this),N(this,"length",b,this),N(this,"boxThickness",E,this),N(this,"_position",A,this),N(this,"_rotation",C,this),N(this,"_scale",x,this),N(this,"alignToDirection",S,this),N(this,"randomDirectionAmount",w,this),N(this,"sphericalDirectionAmount",M,this),N(this,"randomPositionAmount",R,this),this.mat=null,this.Quat=null,this.particleSystem=null,this.lastTime=null,this.totalAngle=null,this.mat=new O.Mat4,this.quat=new O.Quat,this.particleSystem=null,this.lastTime=0,this.totalAngle=0}t=i,(e=[{key:"shapeType",get:function(){return this._shapeType},set:function(t){switch(this._shapeType=t,this._shapeType){case L.ShapeType.Box:this.emitFrom===L.EmitLocation.Base&&(this.emitFrom=L.EmitLocation.Volume);break;case L.ShapeType.Cone:this.emitFrom===L.EmitLocation.Edge&&(this.emitFrom=L.EmitLocation.Base);break;case L.ShapeType.Sphere:case L.ShapeType.Hemisphere:this.emitFrom!==L.EmitLocation.Base&&this.emitFrom!==L.EmitLocation.Edge||(this.emitFrom=L.EmitLocation.Volume)}}},{key:"angle",get:function(){return Math.round(100*(0,O.toDegree)(this._angle))/100},set:function(t){this._angle=(0,O.toRadian)(t)}},{key:"arc",get:function(){return(0,O.toDegree)(this._arc)},set:function(t){this._arc=(0,O.toRadian)(t)}},{key:"position",get:function(){return this._position},set:function(t){this._position=t,this.constructMat()}},{key:"rotation",get:function(){return this._rotation},set:function(t){this._rotation=t,this.constructMat()}},{key:"scale",get:function(){return this._scale},set:function(t){this._scale=t,this.constructMat()}}])&&F(t.prototype,e);var n=i.prototype;return n.onInit=function(t){this.particleSystem=t,this.constructMat(),this.lastTime=this.particleSystem._time},n.constructMat=function(){O.Quat.fromEuler(this.quat,this._rotation.x,this._rotation.y,this._rotation.z),O.Mat4.fromRTS(this.mat,this.quat,this._position,this._scale)},n.emit=function(t){switch(this.shapeType){case L.ShapeType.Box:j(this.emitFrom,this.boxThickness,t.position,t.velocity);break;case L.ShapeType.Circle:e=this.radius,i=this.radiusThickness,n=this.generateArcAngle(),r=t.position,a=t.velocity,(0,P.randomPointBetweenCircleAtFixedAngle)(r,e*(1-i),e,n),O.Vec3.normalize(a,r);break;case L.ShapeType.Cone:G(this.emitFrom,this.radius,this.radiusThickness,this.generateArcAngle(),this._angle,this.length,t.position,t.velocity);break;case L.ShapeType.Sphere:H(this.emitFrom,this.radius,this.radiusThickness,t.position,t.velocity);break;case L.ShapeType.Hemisphere:W(this.emitFrom,this.radius,this.radiusThickness,t.position,t.velocity);break;default:console.warn(this.shapeType+" shapeType is not supported by ShapeModule.")}var e,i,n,r,a;if(this.randomPositionAmount>0&&(t.position.x+=(0,O.randomRange)(-this.randomPositionAmount,this.randomPositionAmount),t.position.y+=(0,O.randomRange)(-this.randomPositionAmount,this.randomPositionAmount),t.position.z+=(0,O.randomRange)(-this.randomPositionAmount,this.randomPositionAmount)),O.Vec3.transformQuat(t.velocity,t.velocity,this.quat),O.Vec3.transformMat4(t.position,t.position,this.mat),this.sphericalDirectionAmount>0){var s=O.Vec3.normalize(k,t.position);O.Vec3.lerp(t.velocity,t.velocity,s,this.sphericalDirectionAmount)}this.lastTime=this.particleSystem._time},n.generateArcAngle=function(){if(this.arcMode===L.ArcMode.Random)return(0,O.randomRange)(0,this._arc);var t=this.totalAngle+2*Math.PI*this.arcSpeed.evaluate(this.particleSystem._time,1)*(this.particleSystem._time-this.lastTime);switch(this.totalAngle=t,0!==this.arcSpread&&(t=Math.floor(t/(this._arc*this.arcSpread))*this._arc*this.arcSpread),this.arcMode){case L.ArcMode.Loop:return(0,O.repeat)(t,this._arc);case L.ArcMode.PingPong:return(0,O.pingPong)(t,this._arc)}},i})()).prototype,"enable",[I.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),f=B(u.prototype,"_shapeType",[I.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return L.ShapeType.Cone}}),B(u.prototype,"shapeType",[a],Object.getOwnPropertyDescriptor(u.prototype,"shapeType"),u.prototype),d=B(u.prototype,"emitFrom",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return L.EmitLocation.Volume}}),_=B(u.prototype,"radius",[I.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),p=B(u.prototype,"radiusThickness",[I.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),m=B(u.prototype,"_angle",[I.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,O.toRadian)(25)}}),B(u.prototype,"angle",[I.property],Object.getOwnPropertyDescriptor(u.prototype,"angle"),u.prototype),v=B(u.prototype,"_arc",[I.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(0,O.toRadian)(360)}}),B(u.prototype,"arc",[I.property],Object.getOwnPropertyDescriptor(u.prototype,"arc"),u.prototype),g=B(u.prototype,"arcMode",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return L.ArcMode.Random}}),y=B(u.prototype,"arcSpread",[I.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),T=B(u.prototype,"arcSpeed",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new D.default}}),b=B(u.prototype,"length",[I.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),E=B(u.prototype,"boxThickness",[I.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new O.Vec3(0,0,0)}}),A=B(u.prototype,"_position",[I.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new O.Vec3(0,0,0)}}),B(u.prototype,"position",[I.property],Object.getOwnPropertyDescriptor(u.prototype,"position"),u.prototype),C=B(u.prototype,"_rotation",[I.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new O.Vec3(0,0,0)}}),B(u.prototype,"rotation",[I.property],Object.getOwnPropertyDescriptor(u.prototype,"rotation"),u.prototype),x=B(u.prototype,"_scale",[I.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new O.Vec3(1,1,1)}}),B(u.prototype,"scale",[I.property],Object.getOwnPropertyDescriptor(u.prototype,"scale"),u.prototype),S=B(u.prototype,"alignToDirection",[I.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),w=B(u.prototype,"randomDirectionAmount",[I.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),M=B(u.prototype,"sphericalDirectionAmount",[I.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),R=B(u.prototype,"randomPositionAmount",[I.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),l=u))||l);function H(t,e,i,n,r){switch(t){case L.EmitLocation.Volume:(0,P.randomPointBetweenSphere)(n,e*(1-i),e),O.Vec3.copy(r,n),O.Vec3.normalize(r,r);break;case L.EmitLocation.Shell:(0,P.randomUnitVector)(n),O.Vec3.scale(n,n,e),O.Vec3.copy(r,n);break;default:console.warn(t+" is not supported for sphere emitter.")}}function W(t,e,i,n,r){switch(t){case L.EmitLocation.Volume:(0,P.randomPointBetweenSphere)(n,e*(1-i),e),n.z>0&&(n.z*=-1),O.Vec3.copy(r,n),O.Vec3.normalize(r,r);break;case L.EmitLocation.Shell:(0,P.randomUnitVector)(n),O.Vec3.scale(n,n,e),n.z<0&&(n.z*=-1),O.Vec3.copy(r,n);break;default:console.warn(t+" is not supported for hemisphere emitter.")}}function G(t,e,i,n,r,a,s,o){switch(t){case L.EmitLocation.Base:(0,P.randomPointBetweenCircleAtFixedAngle)(s,e*(1-i),e,n),O.Vec2.scale(o,s,Math.sin(r)),o.z=-Math.cos(r)*e,O.Vec3.normalize(o,o),s.z=0;break;case L.EmitLocation.Shell:(0,P.fixedAngleUnitVector2)(s,n),O.Vec2.scale(o,s,Math.sin(r)),o.z=-Math.cos(r),O.Vec3.normalize(o,o),O.Vec2.scale(s,s,e),s.z=0;break;case L.EmitLocation.Volume:(0,P.randomPointBetweenCircleAtFixedAngle)(s,e*(1-i),e,n),O.Vec2.scale(o,s,Math.sin(r)),o.z=-Math.cos(r)*e,O.Vec3.normalize(o,o),s.z=0,O.Vec3.add(s,s,O.Vec3.scale(k,o,a*(0,O.random)()/-o.z));break;default:console.warn(t+" is not supported for cone emitter.")}}function j(t,e,i,n){switch(t){case L.EmitLocation.Volume:(0,P.randomPointInCube)(i,z);break;case L.EmitLocation.Shell:V.splice(0,V.length),V.push((0,O.randomRange)(-.5,.5)),V.push((0,O.randomRange)(-.5,.5)),V.push(.5*(0,P.randomSign)()),(0,P.randomSortArray)(V),Y(V,e),O.Vec3.set(i,V[0],V[1],V[2]);break;case L.EmitLocation.Edge:V.splice(0,V.length),V.push((0,O.randomRange)(-.5,.5)),V.push(.5*(0,P.randomSign)()),V.push(.5*(0,P.randomSign)()),(0,P.randomSortArray)(V),Y(V,e),O.Vec3.set(i,V[0],V[1],V[2]);break;default:console.warn(t+" is not supported for box emitter.")}O.Vec3.copy(n,P.particleEmitZAxis)}function Y(t,e){e.x>0&&(t[0]+=.5*(0,O.randomRange)(-e.x,e.x),t[0]=(0,O.clamp)(t[0],-.5,.5)),e.y>0&&(t[1]+=.5*(0,O.randomRange)(-e.y,e.y),t[1]=(0,O.clamp)(t[1],-.5,.5)),e.z>0&&(t[2]+=.5*(0,O.randomRange)(-e.z,e.z),t[2]=(0,O.clamp)(t[2],-.5,.5))}i.default=U,e.exports=i.default}),{"../../../platform/CCClassDecorator":194,"../../../value-types":293,"../animator/curve-range":31,"../enum":43,"../particle-general-function":44}],43:[(function(t,e,i){"use strict";i.__esModule=!0,i.TextureMode=i.TrailMode=i.ArcMode=i.EmitLocation=i.ShapeType=i.RenderMode=i.Space=void 0;var n,r=(n=t("../../platform/CCEnum"))&&n.__esModule?n:{default:n},a=(0,r.default)({World:0,Local:1,Custom:2});i.Space=a;var s=(0,r.default)({Billboard:0,StrecthedBillboard:1,HorizontalBillboard:2,VerticalBillboard:3,Mesh:4});i.RenderMode=s;var o=(0,r.default)({Box:0,Circle:1,Cone:2,Sphere:3,Hemisphere:4});i.ShapeType=o;var c=(0,r.default)({Base:0,Edge:1,Shell:2,Volume:3});i.EmitLocation=c;var l=(0,r.default)({Random:0,Loop:1,PingPong:2});i.ArcMode=l;var u=(0,r.default)({Particles:0,Ribbon:1});i.TrailMode=u;var h=(0,r.default)({Stretch:0,Repeat:1});i.TextureMode=h}),{"../../platform/CCEnum":195}],44:[(function(t,e,i){"use strict";i.__esModule=!0,i.calculateTransform=function(t,e,i,r){return e!==t?(t===a.Space.World?n.Mat4.getRotation(r,i):(n.Mat4.invert(i,i),n.Mat4.getRotation(r,i)),!0):(n.Quat.set(r,0,0,0,1),!1)},i.fixedAngleUnitVector2=o,i.randomUnitVector2=c,i.randomUnitVector=l,i.randomPointInUnitSphere=function(t){l(t),n.Vec3.scale(t,t,(0,n.random)())},i.randomPointBetweenSphere=function(t,e,i){l(t),n.Vec3.scale(t,t,e+(i-e)*(0,n.random)())},i.randomPointInUnitCircle=function(t){c(t),t.z=0,n.Vec3.scale(t,t,(0,n.random)())},i.randomPointBetweenCircle=function(t,e,i){c(t),t.z=0,n.Vec3.scale(t,t,e+(i-e)*(0,n.random)())},i.randomPointBetweenCircleAtFixedAngle=function(t,e,i,r){o(t,r),t.z=0,n.Vec3.scale(t,t,e+(i-e)*(0,n.random)())},i.randomPointInCube=function(t,e){n.Vec3.set(t,(0,n.randomRange)(-e.x,e.x),(0,n.randomRange)(-e.y,e.y),(0,n.randomRange)(-e.z,e.z))},i.randomPointBetweenCube=function(t,e,i){for(var r=["x","y","z"],a=(0,n.randomRangeInt)(0,3),s=0;s<3;s++)if(s!==a){var o=2*(0,n.random)()-1;t[r[s]]=o<0?-e[r[s]]+o*(i[r[s]]-e[r[s]]):e[r[s]]+o*(i[r[s]]-e[r[s]])}else t[r[s]]=(0,n.randomRange)(-i[r[s]],i[r[s]])},i.randomSortArray=function(t){for(var e=0;e<t.length;e++){var i=e+(0,n.randomRangeInt)(0,t.length-e),r=t[i];t[i]=t[e],t[e]=r}},i.randomSign=function(){var t=(0,n.randomRange)(-1,1);return 0===t&&t++,(0,r.sign)(t)},i.particleEmitZAxis=void 0;var n=t("../../value-types"),r=t("../../value-types/utils"),a=t("./enum"),s=new n.Vec3(0,0,-1);function o(t,e){n.Vec2.set(t,Math.cos(e),Math.sin(e))}function c(t){var e=(0,n.randomRange)(0,2*Math.PI),i=Math.cos(e),r=Math.sin(e);n.Vec2.set(t,i,r)}function l(t){var e=(0,n.randomRange)(-1,1),i=(0,n.randomRange)(0,2*Math.PI),r=Math.sqrt(1-e*e),a=r*Math.cos(i),s=r*Math.sin(i);n.Vec3.set(t,a,s,e)}i.particleEmitZAxis=s}),{"../../value-types":293,"../../value-types/utils":300,"./enum":43}],45:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r,a,s,o,c,l,u,h,f,d,_,p,m,v,g,y,T,b,E,A,C,x,S,w,M,R,I,O,D,P,L,N,F,B,k,V,z,U,H,W,G,j,Y,X,q,Z,K,Q,J,$,tt,et,it,nt,rt,at,st,ot,ct,lt,ut,ht,ft,dt,_t,pt=t("../../value-types"),mt=t("../../value-types/utils"),vt=Lt(t("../../assets/material/CCMaterial")),gt=Lt(t("./animator/color-overtime")),yt=(function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=Pt();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var a=n?Object.getOwnPropertyDescriptor(t,r):null;a&&(a.get||a.set)?Object.defineProperty(i,r,a):i[r]=t[r]}return i.default=t,e&&e.set(t,i),i})(t("./animator/curve-range")),Tt=Lt(t("./animator/force-overtime")),bt=Lt(t("./animator/gradient-range")),Et=Lt(t("./animator/limit-velocity-overtime")),At=Lt(t("./animator/rotation-overtime")),Ct=Lt(t("./animator/size-overtime")),xt=Lt(t("./animator/texture-animation")),St=Lt(t("./animator/velocity-overtime")),wt=Lt(t("./burst")),Mt=Lt(t("./emitter/shape-module")),Rt=t("./enum"),It=t("./particle-general-function"),Ot=Lt(t("./renderer/trail")),Dt=Lt(t("../../mesh/CCMesh"));function Pt(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return Pt=function(){return t},t}function Lt(t){return t&&t.__esModule?t:{default:t}}function Nt(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=Ft(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(i=t[Symbol.iterator]()).next.bind(i)}function Ft(t,e){if(t){if("string"==typeof t)return Bt(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Bt(t,e):void 0}}function Bt(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function kt(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function Vt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Ut(t,e,i){return e&&zt(t.prototype,e),i&&zt(t,i),t}function Ht(t,e,i,n,r){var a={};return Object.keys(n).forEach((function(t){a[t]=n[t]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}var Wt=t("../../platform/CCClassDecorator"),Gt=Wt.ccclass,jt=Wt.menu,Yt=Wt.property,Xt=Wt.executeInEditMode,qt=Wt.executionOrder,Zt=t("../../components/CCRenderComponent"),Kt=new pt.Mat4,Qt=(n=Gt("cc.ParticleSystem3D"),r=jt("i18n:MAIN_MENU.component.renderers/ParticleSystem3D"),a=qt(99),s=Yt({animatable:!1}),o=Yt({animatable:!1}),c=Yt({type:Rt.Space,animatable:!1}),l=Yt({type:yt.default}),u=Yt({type:yt.default}),h=Yt({type:bt.default}),f=Yt({type:Rt.Space}),d=Yt({type:yt.default}),_=Yt({type:yt.default,range:[-1,1]}),p=Yt({type:yt.default,range:[-1,1],radian:!0}),m=Yt({type:yt.default,range:[-1,1]}),v=Yt({type:yt.default}),g=Yt({type:yt.default}),y=Yt({type:[wt.default],animatable:!1}),T=Yt({type:[vt.default],displayName:"Materials",visible:!1,override:!0}),b=Yt({type:Mt.default,animatable:!1}),E=Yt({type:gt.default,animatable:!1}),A=Yt({type:Ct.default,animatable:!1}),C=Yt({type:St.default,animatable:!1}),x=Yt({type:Tt.default,animatable:!1}),S=Yt({type:Et.default,animatable:!1}),w=Yt({type:At.default,animatable:!1}),M=Yt({type:xt.default,animatable:!1}),R=Yt({type:Ot.default,animatable:!1}),I=Yt({type:Rt.RenderMode,animatable:!1}),O=Yt({animatable:!1}),D=Yt({animatable:!1}),P=Yt({type:Dt.default,animatable:!1}),L=Yt({type:vt.default,animatable:!1}),N=Yt({type:vt.default,animatable:!1}),n(F=r(F=a(F=Xt((k=Ht((B=(function(t){var e,i;function n(){var e;return kt(e=t.call(this)||this,"duration",k,Vt(e)),kt(e,"_capacity",V,Vt(e)),kt(e,"loop",z,Vt(e)),kt(e,"playOnAwake",U,Vt(e)),kt(e,"_prewarm",H,Vt(e)),kt(e,"_simulationSpace",W,Vt(e)),kt(e,"simulationSpeed",G,Vt(e)),kt(e,"startDelay",j,Vt(e)),kt(e,"startLifetime",Y,Vt(e)),kt(e,"startColor",X,Vt(e)),kt(e,"scaleSpace",q,Vt(e)),kt(e,"startSize",Z,Vt(e)),kt(e,"startSpeed",K,Vt(e)),kt(e,"startRotation",Q,Vt(e)),kt(e,"gravityModifier",J,Vt(e)),kt(e,"rateOverTime",$,Vt(e)),kt(e,"rateOverDistance",tt,Vt(e)),kt(e,"bursts",et,Vt(e)),kt(e,"_shapeModule",it,Vt(e)),kt(e,"_colorOverLifetimeModule",nt,Vt(e)),kt(e,"_sizeOvertimeModule",rt,Vt(e)),kt(e,"_velocityOvertimeModule",at,Vt(e)),kt(e,"_forceOvertimeModule",st,Vt(e)),kt(e,"_limitVelocityOvertimeModule",ot,Vt(e)),kt(e,"_rotationOvertimeModule",ct,Vt(e)),kt(e,"_textureAnimationModule",lt,Vt(e)),kt(e,"_trailModule",ut,Vt(e)),kt(e,"_renderMode",ht,Vt(e)),kt(e,"_velocityScale",ft,Vt(e)),kt(e,"_lengthScale",dt,Vt(e)),kt(e,"_mesh",_t,Vt(e)),e._isPlaying=void 0,e._isPaused=void 0,e._isStopped=void 0,e._isEmitting=void 0,e._time=void 0,e._emitRateTimeCounter=void 0,e._emitRateDistanceCounter=void 0,e._oldWPos=void 0,e._curWPos=void 0,e._customData1=void 0,e._customData2=void 0,e._subEmitters=void 0,e.rateOverTime.constant=10,e.startLifetime.constant=5,e.startSize.constant=1,e.startSpeed.constant=5,e._isPlaying=!1,e._isPaused=!1,e._isStopped=!0,e._isEmitting=!1,e._time=0,e._emitRateTimeCounter=0,e._emitRateDistanceCounter=0,e._oldWPos=new pt.Vec3(0,0,0),e._curWPos=new pt.Vec3(0,0,0),e._customData1=new pt.Vec2(0,0),e._customData2=new pt.Vec2(0,0),e._subEmitters=[],e}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i,Ut(n,[{key:"capacity",get:function(){return this._capacity},set:function(t){this._capacity=t,this._assembler&&this._assembler.setCapacity(this._capacity)}},{key:"prewarm",get:function(){return this._prewarm},set:function(t){!0===t&&this.loop,this._prewarm=t}},{key:"simulationSpace",get:function(){return this._simulationSpace},set:function(t){t!==this._simulationSpace&&(this._simulationSpace=t,this._assembler._updateMaterialParams(),this._assembler._updateTrailMaterial())}},{key:"materials",get:function(){return this._materials},set:function(t){this._materials=t,this._activateMaterial()}},{key:"shapeModule",get:function(){return this._shapeModule},set:function(t){this._shapeModule=t,this._shapeModule.onInit(this)}},{key:"colorOverLifetimeModule",get:function(){return this._colorOverLifetimeModule},set:function(t){this._colorOverLifetimeModule=t}},{key:"sizeOvertimeModule",get:function(){return this._sizeOvertimeModule},set:function(t){this._sizeOvertimeModule=t}},{key:"velocityOvertimeModule",get:function(){return this._velocityOvertimeModule},set:function(t){this._velocityOvertimeModule=t}},{key:"forceOvertimeModule",get:function(){return this._forceOvertimeModule},set:function(t){this._forceOvertimeModule=t}},{key:"limitVelocityOvertimeModule",get:function(){return this._limitVelocityOvertimeModule},set:function(t){this._limitVelocityOvertimeModule=t}},{key:"rotationOvertimeModule",get:function(){return this._rotationOvertimeModule},set:function(t){this._rotationOvertimeModule=t}},{key:"textureAnimationModule",get:function(){return this._textureAnimationModule},set:function(t){this._textureAnimationModule=t,this._textureAnimationModule.onInit(this)}},{key:"trailModule",get:function(){return this._trailModule},set:function(t){this._trailModule=t,this._trailModule.onInit(this)}},{key:"renderMode",get:function(){return this._renderMode},set:function(t){this._renderMode!==t&&(this._renderMode=t,this._assembler._setVertexAttrib(),this._assembler._updateModel(),this._assembler._updateMaterialParams())}},{key:"velocityScale",get:function(){return this._velocityScale},set:function(t){this._velocityScale=t,this._assembler._updateMaterialParams()}},{key:"lengthScale",get:function(){return this._lengthScale},set:function(t){this._lengthScale=t,this._assembler._updateMaterialParams()}},{key:"mesh",get:function(){return this._mesh},set:function(t){this._mesh=t,this._assembler._updateModel()}},{key:"particleMaterial",get:function(){return this.getMaterial(0)},set:function(t){this.setMaterial(0,t),this._onMaterialModified(0,t)}},{key:"trailMaterial",get:function(){return this.getMaterial(1)},set:function(t){this.setMaterial(1,t),this._onMaterialModified(1,t)}}]);var r=n.prototype;return r.onLoad=function(){this._assembler.onInit(this),this.shapeModule.onInit(this),this.trailModule.onInit(this),this.textureAnimationModule.onInit(this),this._resetPosition()},r._onMaterialModified=function(t,e){this._assembler._onMaterialModified(t,e)},r._onRebuildPSO=function(t,e){this._assembler._onRebuildPSO(t,e)},r.play=function(){this._isPaused&&(this._isPaused=!1),this._isStopped&&(this._isStopped=!1),this._isPlaying=!0,this._isEmitting=!0,this._resetPosition(),this._prewarm&&this._prewarmSystem()},r.pause=function(){this._isStopped?console.warn("pause(): particle system is already stopped."):(this._isPlaying&&(this._isPlaying=!1),this._isPaused=!0)},r.stop=function(){(this._isPlaying||this._isPaused)&&this.clear(),this._isPlaying&&(this._isPlaying=!1),this._isPaused&&(this._isPaused=!1),this._time=0,this._emitRateTimeCounter=0,this._emitRateDistanceCounter=0,this._isStopped=!0},r.clear=function(){this.enabledInHierarchy&&(this._assembler.clear(),this.trailModule.clear())},r.getParticleCount=function(){return this._assembler.getParticleCount()},r.setCustomData1=function(t,e){pt.Vec2.set(this._customData1,t,e)},r.setCustomData2=function(t,e){pt.Vec2.set(this._customData2,t,e)},r.onDestroy=function(){this._assembler.onDestroy(),this.trailModule.destroy()},r.onEnable=function(){t.prototype.onEnable.call(this),this.playOnAwake&&this.play(),this._assembler.onEnable(),this.trailModule.onEnable()},r.onDisable=function(){t.prototype.onDisable.call(this),this._assembler.onDisable(),this.trailModule.onDisable()},r.update=function(t){var e=t*this.simulationSpeed;this._isPlaying&&(this._time+=e,this._emit(e),0!==this._assembler._updateParticles(e)||this._isEmitting||this.stop(),this._assembler.updateParticleBuffer(),this.trailModule.enable&&this.trailModule.updateTrailBuffer())},r.emit=function(t,e){this._simulationSpace===Rt.Space.World&&this.node.getWorldMatrix(Kt);for(var i=0;i<t;++i){var n=this._assembler._getFreeParticle();if(null===n)return;var r=(0,pt.pseudoRandom)((0,pt.randomRangeInt)(0,mt.INT_MAX));switch(this.shapeModule.enable?this.shapeModule.emit(n):(pt.Vec3.set(n.position,0,0,0),pt.Vec3.copy(n.velocity,It.particleEmitZAxis)),this.textureAnimationModule.enable&&this.textureAnimationModule.init(n),pt.Vec3.scale(n.velocity,n.velocity,this.startSpeed.evaluate(this._time/this.duration,r)),this._simulationSpace){case Rt.Space.Local:break;case Rt.Space.World:pt.Vec3.transformMat4(n.position,n.position,Kt);var a=new pt.Quat;this.node.getWorldRotation(a),pt.Vec3.transformQuat(n.velocity,n.velocity,a);break;case Rt.Space.Custom:}pt.Vec3.copy(n.ultimateVelocity,n.velocity),pt.Vec3.set(n.rotation,0,0,this.startRotation.evaluate(this._time/this.duration,r)),pt.Vec3.set(n.startSize,this.startSize.evaluate(this._time/this.duration,r),1,1),n.startSize.y=n.startSize.x,pt.Vec3.copy(n.size,n.startSize),n.startColor.set(this.startColor.evaluate(this._time/this.duration,r)),n.color.set(n.startColor),n.startLifetime=this.startLifetime.evaluate(this._time/this.duration,r)+e,n.remainingLifetime=n.startLifetime,n.randomSeed=(0,pt.randomRangeInt)(0,233280),this._assembler._setNewParticle(n)}},r._prewarmSystem=function(){this.startDelay.mode=yt.Mode.Constant,this.startDelay.constant=0;for(var t=this.duration/1,e=0;e<t;++e)this._time+=1,this._emit(1),this._assembler._updateParticles(1)},r._emit=function(t){var e=this.startDelay.evaluate(0,1);if(this._time>e){if(this._time>this.duration+e&&!this.loop)return void(this._isEmitting=!1);if(this._emitRateTimeCounter+=this.rateOverTime.evaluate(this._time/this.duration,1)*t,this._emitRateTimeCounter>1&&this._isEmitting){var i=Math.floor(this._emitRateTimeCounter);this._emitRateTimeCounter-=i,this.emit(i,t)}this.node.getWorldPosition(this._curWPos);var n=pt.Vec3.distance(this._curWPos,this._oldWPos);if(pt.Vec3.copy(this._oldWPos,this._curWPos),this._emitRateDistanceCounter+=n*this.rateOverDistance.evaluate(this._time/this.duration,1),this._emitRateDistanceCounter>1&&this._isEmitting){var r=Math.floor(this._emitRateDistanceCounter);this._emitRateDistanceCounter-=r,this.emit(r,t)}for(var a,s=Nt(this.bursts);!(a=s()).done;)a.value.update(this,t)}},r._activateMaterial=function(){},r._resetPosition=function(){this.node.getWorldPosition(this._oldWPos),pt.Vec3.copy(this._curWPos,this._oldWPos)},r.addSubEmitter=function(t){this._subEmitters.push(t)},r.removeSubEmitter=function(t){this._subEmitters.splice(this._subEmitters.indexOf(t),1)},r.addBurst=function(t){this.bursts.push(t)},r.removeBurst=function(t){this.bursts.splice(this.bursts.indexOf(t),1)},r._checkBacth=function(){},Ut(n,[{key:"isPlaying",get:function(){return this._isPlaying}},{key:"isPaused",get:function(){return this._isPaused}},{key:"isStopped",get:function(){return this._isStopped}},{key:"isEmitting",get:function(){return this._isEmitting}},{key:"time",get:function(){return this._time}}]),n})(Zt)).prototype,"duration",[Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),V=Ht(B.prototype,"_capacity",[Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),Ht(B.prototype,"capacity",[Yt],Object.getOwnPropertyDescriptor(B.prototype,"capacity"),B.prototype),z=Ht(B.prototype,"loop",[Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),U=Ht(B.prototype,"playOnAwake",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),H=Ht(B.prototype,"_prewarm",[Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ht(B.prototype,"prewarm",[o],Object.getOwnPropertyDescriptor(B.prototype,"prewarm"),B.prototype),W=Ht(B.prototype,"_simulationSpace",[Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Rt.Space.Local}}),Ht(B.prototype,"simulationSpace",[c],Object.getOwnPropertyDescriptor(B.prototype,"simulationSpace"),B.prototype),G=Ht(B.prototype,"simulationSpeed",[Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),j=Ht(B.prototype,"startDelay",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new yt.default}}),Y=Ht(B.prototype,"startLifetime",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new yt.default}}),X=Ht(B.prototype,"startColor",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new bt.default}}),q=Ht(B.prototype,"scaleSpace",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Rt.Space.Local}}),Z=Ht(B.prototype,"startSize",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new yt.default}}),K=Ht(B.prototype,"startSpeed",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new yt.default}}),Q=Ht(B.prototype,"startRotation",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new yt.default}}),J=Ht(B.prototype,"gravityModifier",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new yt.default}}),$=Ht(B.prototype,"rateOverTime",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new yt.default}}),tt=Ht(B.prototype,"rateOverDistance",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new yt.default}}),et=Ht(B.prototype,"bursts",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Array}}),Ht(B.prototype,"materials",[T],Object.getOwnPropertyDescriptor(B.prototype,"materials"),B.prototype),it=Ht(B.prototype,"_shapeModule",[Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Mt.default}}),Ht(B.prototype,"shapeModule",[b],Object.getOwnPropertyDescriptor(B.prototype,"shapeModule"),B.prototype),nt=Ht(B.prototype,"_colorOverLifetimeModule",[Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new gt.default}}),Ht(B.prototype,"colorOverLifetimeModule",[E],Object.getOwnPropertyDescriptor(B.prototype,"colorOverLifetimeModule"),B.prototype),rt=Ht(B.prototype,"_sizeOvertimeModule",[Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Ct.default}}),Ht(B.prototype,"sizeOvertimeModule",[A],Object.getOwnPropertyDescriptor(B.prototype,"sizeOvertimeModule"),B.prototype),at=Ht(B.prototype,"_velocityOvertimeModule",[Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new St.default}}),Ht(B.prototype,"velocityOvertimeModule",[C],Object.getOwnPropertyDescriptor(B.prototype,"velocityOvertimeModule"),B.prototype),st=Ht(B.prototype,"_forceOvertimeModule",[Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Tt.default}}),Ht(B.prototype,"forceOvertimeModule",[x],Object.getOwnPropertyDescriptor(B.prototype,"forceOvertimeModule"),B.prototype),ot=Ht(B.prototype,"_limitVelocityOvertimeModule",[Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Et.default}}),Ht(B.prototype,"limitVelocityOvertimeModule",[S],Object.getOwnPropertyDescriptor(B.prototype,"limitVelocityOvertimeModule"),B.prototype),ct=Ht(B.prototype,"_rotationOvertimeModule",[Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new At.default}}),Ht(B.prototype,"rotationOvertimeModule",[w],Object.getOwnPropertyDescriptor(B.prototype,"rotationOvertimeModule"),B.prototype),lt=Ht(B.prototype,"_textureAnimationModule",[Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new xt.default}}),Ht(B.prototype,"textureAnimationModule",[M],Object.getOwnPropertyDescriptor(B.prototype,"textureAnimationModule"),B.prototype),ut=Ht(B.prototype,"_trailModule",[Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new Ot.default}}),Ht(B.prototype,"trailModule",[R],Object.getOwnPropertyDescriptor(B.prototype,"trailModule"),B.prototype),ht=Ht(B.prototype,"_renderMode",[Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Rt.RenderMode.Billboard}}),Ht(B.prototype,"renderMode",[I],Object.getOwnPropertyDescriptor(B.prototype,"renderMode"),B.prototype),ft=Ht(B.prototype,"_velocityScale",[Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Ht(B.prototype,"velocityScale",[O],Object.getOwnPropertyDescriptor(B.prototype,"velocityScale"),B.prototype),dt=Ht(B.prototype,"_lengthScale",[Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Ht(B.prototype,"lengthScale",[D],Object.getOwnPropertyDescriptor(B.prototype,"lengthScale"),B.prototype),_t=Ht(B.prototype,"_mesh",[Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ht(B.prototype,"mesh",[P],Object.getOwnPropertyDescriptor(B.prototype,"mesh"),B.prototype),Ht(B.prototype,"particleMaterial",[L],Object.getOwnPropertyDescriptor(B.prototype,"particleMaterial"),B.prototype),Ht(B.prototype,"trailMaterial",[N],Object.getOwnPropertyDescriptor(B.prototype,"trailMaterial"),B.prototype),F=B))||F)||F)||F)||F);i.default=Qt,cc.ParticleSystem3D=Qt,e.exports=i.default}),{"../../assets/material/CCMaterial":111,"../../components/CCRenderComponent":140,"../../mesh/CCMesh":187,"../../platform/CCClassDecorator":194,"../../value-types":293,"../../value-types/utils":300,"./animator/color-overtime":30,"./animator/curve-range":31,"./animator/force-overtime":32,"./animator/gradient-range":33,"./animator/limit-velocity-overtime":35,"./animator/rotation-overtime":36,"./animator/size-overtime":37,"./animator/texture-animation":38,"./animator/velocity-overtime":39,"./burst":40,"./emitter/shape-module":42,"./enum":43,"./particle-general-function":44,"./renderer/trail":49}],46:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=t("../../value-types");i.default=function(t){this.particleSystem=null,this.position=null,this.velocity=null,this.animatedVelocity=null,this.ultimateVelocity=null,this.angularVelocity=null,this.axisOfRotation=null,this.rotation=null,this.startSize=null,this.size=null,this.startColor=null,this.color=cc.Color.WHITE,this.randomSeed=null,this.remainingLifetime=null,this.startLifetime=null,this.emitAccumulator0=null,this.emitAccumulator1=null,this.frameIndex=null,this.particleSystem=t,this.position=new n.Vec3(0,0,0),this.velocity=new n.Vec3(0,0,0),this.animatedVelocity=new n.Vec3(0,0,0),this.ultimateVelocity=new n.Vec3(0,0,0),this.angularVelocity=new n.Vec3(0,0,0),this.axisOfRotation=new n.Vec3(0,0,0),this.rotation=new n.Vec3(0,0,0),this.startSize=new n.Vec3(0,0,0),this.size=new n.Vec3(0,0,0),this.startColor=cc.Color.WHITE.clone(),this.color=cc.Color.WHITE.clone(),this.randomSeed=0,this.remainingLifetime=0,this.startLifetime=0,this.emitAccumulator0=0,this.emitAccumulator1=0,this.frameIndex=0},e.exports=i.default}),{"../../value-types":293}],47:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=s(t("../../../../renderer/gfx")),r=s(t("../../../../renderer/core/input-assembler")),a=t("../../../mesh/mesh-data");function s(t){return t&&t.__esModule?t:{default:t}}var o=t("../../../renderer"),c=(function(){function t(){this._capacity=0,this._vertFormat=null,this._vertAttrsFloatCount=0,this._mesh=null,this._vertCount=0,this._indexCount=0,this._material=null,this._capacity=0,this._vertFormat=null,this._vertAttrsFloatCount=0,this._mesh=null,this._subDatas=[],this._subMeshes=[]}var e=t.prototype;return e.setCapacity=function(t){var e=this._capacity!==t;this._capacity=t,this._inited&&e&&this._recreateBuffer()},e.setVertexAttributes=function(t,e){this._mesh===t&&this._vertFormat===e||(this._mesh=t,this._vertFormat=e,this._vertAttrsFloatCount=this._vertFormat._bytes/4,this._createParticleData(),this._inited=!0)},e._recreateBuffer=function(){this._createParticleData()},e._createParticleData=function(){this.destroyIAData(),this._vertCount=4,this._indexCount=6;var t=null,e=null,i=this._vertFormat._bytes;if(this._mesh){var s=this._mesh._subDatas[0];this._vertCount=s.vData.byteLength/s.vfm._bytes,this._indexCount=s.iData.byteLength/2,t=new Float32Array(i*this._capacity*this._vertCount/4),e=new Uint16Array(this._capacity*this._indexCount);var c=this._vertFormat.element(n.default.ATTR_TEX_COORD3),l=this._vertFormat.element(n.default.ATTR_NORMAL),u=this._vertFormat.element(n.default.ATTR_TEX_COORD),h=this._vertFormat.element(n.default.ATTR_COLOR1);if(this._mesh.copyAttribute(0,n.default.ATTR_POSITION,t.buffer,i,c.offset),this._mesh.copyAttribute(0,n.default.ATTR_NORMAL,t.buffer,i,l.offset),this._mesh.copyAttribute(0,n.default.ATTR_UV0,t.buffer,i,u.offset),!this._mesh.copyAttribute(0,n.default.ATTR_COLOR,t.buffer,i,h.offset))for(var f=new Uint32Array(t.buffer),d=0;d<this._vertCount;++d)f[d*this._vertAttrsFloatCount+h.offset/4]=cc.Color.WHITE._val;var _=new Float32Array(t.buffer);for(d=1;d<this._capacity;d++)_.copyWithin(d*i*this._vertCount/4,0,i*this._vertCount/4);for(this._mesh.copyIndices(0,e),d=1;d<this._capacity;d++)for(var p=0;p<this._indexCount;p++)e[d*this._indexCount+p]=e[p]+d*this._vertCount}else{t=new Float32Array(i*this._capacity*this._vertCount/4),e=new Uint16Array(this._capacity*this._indexCount);var m=0;for(d=0;d<this._capacity;++d){var v=4*d;e[m++]=v,e[m++]=v+1,e[m++]=v+2,e[m++]=v+3,e[m++]=v+2,e[m++]=v+1}}var g=new a.MeshData;g.vData=t,g.iData=e,g.vfm=this._vertFormat,g.vDirty=!0,g.iDirty=!0,g.enable=!0,this._subDatas[0]=g;var y=new n.default.VertexBuffer(o.device,this._vertFormat,n.default.USAGE_DYNAMIC,t),T=new n.default.IndexBuffer(o.device,n.default.INDEX_FMT_UINT16,n.default.USAGE_STATIC,e,e.length);this._subMeshes[0]=new r.default(y,T)},e.createTrailData=function(t,e){if(!this._subDatas[1]){var i=t._bytes,s=new ArrayBuffer(i*(e+1)*2),c=new Uint16Array(6*e),l=new a.MeshData;l.vData=new Float32Array(s),l.iData=c,l.vfm=t,l.vDirty=!0,l.iDirty=!0,l.enable=!0,this._subDatas[1]=l;var u=new n.default.VertexBuffer(o.device,t,n.default.USAGE_DYNAMIC,s),h=new n.default.IndexBuffer(o.device,n.default.INDEX_FMT_UINT16,n.default.USAGE_DYNAMIC,c,6*e);this._subMeshes[1]=new r.default(u,h)}},e.setModelMaterial=function(t){this._material=t},e.addParticleVertexData=function(t,e){var i=this._subDatas[0],n=i.getVData(),r=i.getVData(Uint32Array);if(this._mesh)for(var a=0;a<this._vertCount;a++){var s=(t*this._vertCount+a)*this._vertAttrsFloatCount;n[s++]=e[0].x,n[s++]=e[0].y,n[s++]=e[0].z,s+=2,n[s++]=e[1].z,n[s++]=e[2].x,n[s++]=e[2].y,n[s++]=e[2].z,n[s++]=e[3].x,n[s++]=e[3].y,n[s++]=e[3].z,r[s++]=e[4]}else{var o=t*this._vertAttrsFloatCount;n[o++]=e[0].x,n[o++]=e[0].y,n[o++]=e[0].z,n[o++]=e[1].x,n[o++]=e[1].y,n[o++]=e[1].z,n[o++]=e[2].x,n[o++]=e[2].y,n[o++]=e[2].z,n[o++]=e[3].x,n[o++]=e[3].y,n[o++]=e[3].z,r[o++]=e[4],e[5]&&(n[o++]=e[5].x,n[o++]=e[5].y,n[o++]=e[5].z)}},e._uploadData=function(){for(var t=this._subDatas,e=this._subMeshes,i=0,n=t.length;i<n;i++){var r=t[i],a=e[i];if(r.vDirty){var s=a._vertexBuffer,o=r.vData;s.update(0,o),r.vDirty=!1}if(r.iDirty){var c=a._indexBuffer,l=r.iData;c.update(0,l),r.iDirty=!1}}},e.updateIA=function(t,e,i,n){this._subMeshes[t]._count=e;var r=this._subDatas[t];r.vDirty=i,r.iDirty=n},e.clear=function(){var t=this._subMeshes[0];t&&(t.indexCount=0)},e.destroy=function(){this._subDatas.length=0;for(var t=this._subMeshes,e=0,i=t.length;e<i;e++){var n=t[e]._vertexBuffer;n&&n.destroy();var r=t[e]._indexBuffer;r&&r.destroy()}t.length=0},e.destroyIAData=function(){this._subMeshes[0]&&(this._subMeshes[0]._vertexBuffer.destroy(),this._subMeshes[0]._indexBuffer.destroy(),this._subMeshes[0]=null),this._subDatas[0]=null},t})();i.default=c,e.exports=i.default}),{"../../../../renderer/core/input-assembler":316,"../../../../renderer/gfx":326,"../../../mesh/mesh-data":190,"../../../renderer":225}],48:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=t("../../../value-types"),a=d(t("../../../../renderer/gfx")),s=d(t("./particle-batch-model")),o=d(t("../../../assets/material/material-variant")),c=d(t("../../../../renderer/memop/recycle-pool")),l=t("../enum"),u=d(t("../particle")),h=d(t("../../../renderer/assembler")),f=d(t("../particle-system-3d"));function d(t){return t&&t.__esModule?t:{default:t}}var _=t("../../../platform/CCClassDecorator"),p=_.ccclass,m=(_.property,new r.Vec3),v=(new r.Vec2,new r.Vec4,new r.Mat4),g=[0,0,1,0,0,1,1,1],y=new a.default.VertexFormat([{name:a.default.ATTR_POSITION,type:a.default.ATTR_TYPE_FLOAT32,num:3},{name:a.default.ATTR_TEX_COORD,type:a.default.ATTR_TYPE_FLOAT32,num:3},{name:a.default.ATTR_TEX_COORD1,type:a.default.ATTR_TYPE_FLOAT32,num:3},{name:a.default.ATTR_TEX_COORD2,type:a.default.ATTR_TYPE_FLOAT32,num:3},{name:a.default.ATTR_COLOR,type:a.default.ATTR_TYPE_UINT8,num:4,normalize:!0}]);y.name="vfmtNormal";var T=new a.default.VertexFormat([{name:a.default.ATTR_POSITION,type:a.default.ATTR_TYPE_FLOAT32,num:3},{name:a.default.ATTR_TEX_COORD,type:a.default.ATTR_TYPE_FLOAT32,num:3},{name:a.default.ATTR_TEX_COORD1,type:a.default.ATTR_TYPE_FLOAT32,num:3},{name:a.default.ATTR_TEX_COORD2,type:a.default.ATTR_TYPE_FLOAT32,num:3},{name:a.default.ATTR_COLOR,type:a.default.ATTR_TYPE_UINT8,num:4,normalize:!0},{name:a.default.ATTR_COLOR1,type:a.default.ATTR_TYPE_FLOAT32,num:3}]);T.name="vfmtStretch";var b=new a.default.VertexFormat([{name:a.default.ATTR_POSITION,type:a.default.ATTR_TYPE_FLOAT32,num:3},{name:a.default.ATTR_TEX_COORD,type:a.default.ATTR_TYPE_FLOAT32,num:3},{name:a.default.ATTR_TEX_COORD1,type:a.default.ATTR_TYPE_FLOAT32,num:3},{name:a.default.ATTR_TEX_COORD2,type:a.default.ATTR_TYPE_FLOAT32,num:3},{name:a.default.ATTR_COLOR,type:a.default.ATTR_TYPE_UINT8,num:4,normalize:!0},{name:a.default.ATTR_TEX_COORD3,type:a.default.ATTR_TYPE_FLOAT32,num:3},{name:a.default.ATTR_NORMAL,type:a.default.ATTR_TYPE_FLOAT32,num:3},{name:a.default.ATTR_COLOR1,type:a.default.ATTR_TYPE_UINT8,num:4,normalize:!0}]);b.name="vfmtMesh";var E=p("cc.ParticleSystem3DAssembler")(n=(function(t){var e,i;function n(){var e;return(e=t.call(this)||this)._defines=null,e._trailDefines=null,e._model=null,e.frameTile_velLenScale=null,e.attrs=[],e._vertFormat=[],e._particleSystem=null,e._particles=null,e._defaultMat=null,e._isAssetReady=!1,e._defaultTrailMat=null,e._customProperties=null,e._node_scale=null,e._model=null,e.frameTile_velLenScale=cc.v4(1,1,0,0),e._node_scale=cc.v4(),e.attrs=new Array(5),e._trailDefines={CC_USE_WORLD_SPACE:!0},e}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var a=n.prototype;return a.onInit=function(t){var e=this;this._particleSystem=t,this._particles=new c.default(function(){return new u.default(e)},16),this._setVertexAttrib(),this.onEnable(),this._updateModel(),this._updateMaterialParams(),this._updateTrailMaterial()},a.onEnable=function(){this._particleSystem&&(null==this._model&&(this._model=new s.default),this._model.inited||this._model.setCapacity(this._particleSystem.capacity),this._model.enabled=this._particleSystem.enabledInHierarchy)},a.onDisable=function(){this._model&&(this._model.enabled=this._particleSystem.enabledInHierarchy)},a.onDestroy=function(){this._model=null},a.clear=function(){this._particles.reset(),this.updateParticleBuffer()},a._getFreeParticle=function(){return this._particles.length>=this._particleSystem.capacity?null:this._particles.add()},a._setNewParticle=function(){},a._updateParticles=function(t){switch(this._particleSystem.node.getWorldMatrix(v),this._particleSystem.scaleSpace){case l.Space.Local:this._particleSystem.node.getScale(this._node_scale);break;case l.Space.World:this._particleSystem.node.getWorldScale(this._node_scale)}(this._particleSystem.materials[0]?this._particleSystem.particleMaterial:this._defaultMat).setProperty("scale",this._node_scale),this._particleSystem.velocityOvertimeModule.enable&&this._particleSystem.velocityOvertimeModule.update(this._particleSystem._simulationSpace,v),this._particleSystem.forceOvertimeModule.enable&&this._particleSystem.forceOvertimeModule.update(this._particleSystem._simulationSpace,v),this._particleSystem.trailModule.enable&&this._particleSystem.trailModule.update();for(var e=0;e<this._particles.length;++e){var i=this._particles.data[e];i.remainingLifetime-=t,r.Vec3.set(i.animatedVelocity,0,0,0),i.remainingLifetime<0?(this._particleSystem.trailModule.enable&&this._particleSystem.trailModule.removeParticle(i),this._particles.remove(e),--e):(i.velocity.y-=9.8*this._particleSystem.gravityModifier.evaluate(1-i.remainingLifetime/i.startLifetime,i.randomSeed)*t,this._particleSystem.sizeOvertimeModule.enable&&this._particleSystem.sizeOvertimeModule.animate(i),this._particleSystem.colorOverLifetimeModule.enable&&this._particleSystem.colorOverLifetimeModule.animate(i),this._particleSystem.forceOvertimeModule.enable&&this._particleSystem.forceOvertimeModule.animate(i,t),this._particleSystem.velocityOvertimeModule.enable?this._particleSystem.velocityOvertimeModule.animate(i):r.Vec3.copy(i.ultimateVelocity,i.velocity),this._particleSystem.limitVelocityOvertimeModule.enable&&this._particleSystem.limitVelocityOvertimeModule.animate(i),this._particleSystem.rotationOvertimeModule.enable&&this._particleSystem.rotationOvertimeModule.animate(i,t),this._particleSystem.textureAnimationModule.enable&&this._particleSystem.textureAnimationModule.animate(i),r.Vec3.scaleAndAdd(i.position,i.position,i.ultimateVelocity,t),this._particleSystem.trailModule.enable&&this._particleSystem.trailModule.animate(i,t))}return this._particles.length},a.updateParticleBuffer=function(){for(var t=0,e=this._particleSystem.renderMode===l.RenderMode.StrecthedBillboard,i=0;i<this._particles.length;++i){var n=this._particles.data[i],r=0;this._particleSystem.textureAnimationModule.enable&&(r=n.frameIndex),t=4*i;var a=0;if(this._particleSystem.renderMode!==l.RenderMode.Mesh)for(var s=0;s<4;++s)a=0,this.attrs[a++]=n.position,m.x=g[2*s],m.y=g[2*s+1],m.z=r,this.attrs[a++]=m,this.attrs[a++]=n.size,this.attrs[a++]=n.rotation,this.attrs[a++]=n.color._val,this.attrs[a++]=e?n.ultimateVelocity:null,this._model.addParticleVertexData(t++,this.attrs);else a=0,this.attrs[a++]=n.position,m.z=r,this.attrs[a++]=m,this.attrs[a++]=n.size,this.attrs[a++]=n.rotation,this.attrs[a++]=n.color._val,this._model.addParticleVertexData(i,this.attrs)}this.updateIA(0,this._particles.length*this._model._indexCount,!0)},a.updateShaderUniform=function(){},a.updateIA=function(t,e,i,n){this._model&&this._model.updateIA(t,e,i,n)},a.getParticleCount=function(){return this._particles.data.length},a._onMaterialModified=function(t){0===t?(this._updateModel(),this._updateMaterialParams()):this._updateTrailMaterial()},a._onRebuildPSO=function(t,e){this._model&&0===t&&this._model.setModelMaterial(e),this._particleSystem.trailModule._trailModel&&1===t&&this._particleSystem.trailModule._trailModel.setModelMaterial(e)},a._ensureLoadMesh=function(){this._particleSystem.mesh&&!this._particleSystem.mesh.loaded&&cc.assetManager.postLoadNative(this._particleSystem.mesh)},a.setCapacity=function(t){this._model&&this._model.setCapacity(t)},a._setVertexAttrib=function(){switch(this._particleSystem.renderMode){case l.RenderMode.StrecthedBillboard:this._vertFormat=T;break;case l.RenderMode.Mesh:this._vertFormat=b;break;default:this._vertFormat=y}},a._updateMaterialParams=function(){if(this._particleSystem){var t=this._particleSystem.materials[0];t=(t=null==t&&null==this._defaultMat?this._defaultMat=o.default.createWithBuiltin("3d-particle",this):o.default.create(t,this._particleSystem))||this._defaultMat,this._particleSystem._simulationSpace===l.Space.World?t.define("CC_USE_WORLD_SPACE",!0):t.define("CC_USE_WORLD_SPACE",!1),this._particleSystem.renderMode===l.RenderMode.Billboard?(t.define("CC_USE_BILLBOARD",!0),t.define("CC_USE_STRETCHED_BILLBOARD",!1),t.define("CC_USE_HORIZONTAL_BILLBOARD",!1),t.define("CC_USE_VERTICAL_BILLBOARD",!1),t.define("CC_USE_MESH",!1)):this._particleSystem.renderMode===l.RenderMode.StrecthedBillboard?(t.define("CC_USE_BILLBOARD",!1),t.define("CC_USE_STRETCHED_BILLBOARD",!0),t.define("CC_USE_HORIZONTAL_BILLBOARD",!1),t.define("CC_USE_VERTICAL_BILLBOARD",!1),t.define("CC_USE_MESH",!1),this.frameTile_velLenScale.z=this._particleSystem.velocityScale,this.frameTile_velLenScale.w=this._particleSystem.lengthScale):this._particleSystem.renderMode===l.RenderMode.HorizontalBillboard?(t.define("CC_USE_BILLBOARD",!1),t.define("CC_USE_STRETCHED_BILLBOARD",!1),t.define("CC_USE_HORIZONTAL_BILLBOARD",!0),t.define("CC_USE_VERTICAL_BILLBOARD",!1),t.define("CC_USE_MESH",!1)):this._particleSystem.renderMode===l.RenderMode.VerticalBillboard?(t.define("CC_USE_BILLBOARD",!1),t.define("CC_USE_STRETCHED_BILLBOARD",!1),t.define("CC_USE_HORIZONTAL_BILLBOARD",!1),t.define("CC_USE_VERTICAL_BILLBOARD",!0),t.define("CC_USE_MESH",!1)):this._particleSystem.renderMode===l.RenderMode.Mesh?(t.define("CC_USE_BILLBOARD",!1),t.define("CC_USE_STRETCHED_BILLBOARD",!1),t.define("CC_USE_HORIZONTAL_BILLBOARD",!1),t.define("CC_USE_VERTICAL_BILLBOARD",!1),t.define("CC_USE_MESH",!0)):console.warn("particle system renderMode "+this._particleSystem.renderMode+" not support."),this._particleSystem.textureAnimationModule.enable&&r.Vec2.set(this.frameTile_velLenScale,this._particleSystem.textureAnimationModule.numTilesX,this._particleSystem.textureAnimationModule.numTilesY),t.setProperty("frameTile_velLenScale",this.frameTile_velLenScale),this._particleSystem.setMaterial(0,t)}},a._updateTrailMaterial=function(){var t=this._particleSystem.trailMaterial;this._particleSystem.trailModule.enable&&(null===t&&null===this._defaultTrailMat&&(this._defaultTrailMat=o.default.createWithBuiltin("3d-trail",this)),null===t&&(t=this._defaultTrailMat,this._particleSystem.trailMaterial=t),this._particleSystem._simulationSpace===l.Space.World||this._particleSystem.trailModule.space===l.Space.World?t.define("CC_USE_WORLD_SPACE",!0):t.define("CC_USE_WORLD_SPACE",!1),this._particleSystem.trailModule._updateMaterial())},a._updateTrailEnable=function(t){if(this._model){var e=this._model._subDatas[1];e&&(e.enable=t)}},a._updateModel=function(){this._model&&this._model.setVertexAttributes(this._particleSystem.renderMode===l.RenderMode.Mesh?this._particleSystem.mesh:null,this._vertFormat)},a.setVertexAttributes=function(t,e){this._model&&this._model.setVertexAttributes(t,e)},a.fillBuffers=function(t,e){if(this._model){this._model._uploadData();var i=this._model._subMeshes,n=this._model._subDatas,r=t.materials;e._flush();for(var a=0,s=i.length;a<s;a++){var o=i[a],c=n[a],l=r[a];c.enable&&(e.material=l,e.cullingMask=t.node._cullingMask,e.node=t.node,e._flushIA(o))}}},n})(h.default))||n;i.default=E,Object.assign(E,{uv:g}),h.default.register(f.default,E),e.exports=i.default}),{"../../../../renderer/gfx":326,"../../../../renderer/memop/recycle-pool":341,"../../../assets/material/material-variant":118,"../../../platform/CCClassDecorator":194,"../../../renderer/assembler":222,"../../../value-types":293,"../enum":43,"../particle":46,"../particle-system-3d":45,"./particle-batch-model":47}],49:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r,a,s,o,c,l,u,h,f,d,_,p,m,v,g,y,T,b,E,A,C,x=t("../../../platform/CCClassDecorator"),S=t("../../../value-types"),w=P(t("../../../../renderer/gfx")),M=P(t("../../../../renderer/memop/pool")),R=P(t("../animator/curve-range")),I=P(t("../animator/gradient-range")),O=t("../enum"),D=P(t("../utils"));function P(t){return t&&t.__esModule?t:{default:t}}function L(t,e){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=N(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(i=t[Symbol.iterator]()).next.bind(i)}function N(t,e){if(t){if("string"==typeof t)return F(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?F(t,e):void 0}}function F(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function B(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function k(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function V(t,e,i,n,r){var a={};return Object.keys(n).forEach((function(t){a[t]=n[t]})),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),a),r&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(r):void 0,a.initializer=void 0),void 0===a.initializer&&(Object.defineProperty(t,e,a),a=null),a}var z=Math.cos((0,S.toRadian)(100)),U={position:cc.v3(),velocity:cc.v3()},H=cc.quat(),W=cc.mat4(),G=cc.v3(),j=cc.v3(),Y=cc.color(),X=(function(){function t(t){for(this.start=void 0,this.end=void 0,this.trailElements=[],this.start=-1,this.end=-1,this.trailElements=[];t--;)this.trailElements.push({position:cc.v3(),lifetime:0,width:0,velocity:cc.v3(),direction:0,color:cc.color()})}var e=t.prototype;return e.getElement=function(t){return-1===this.start?null:(t<0&&(t=(t+this.trailElements.length)%this.trailElements.length),t>=this.trailElements.length&&(t%=this.trailElements.length),this.trailElements[t])},e.addElement=function(){if(0===this.trailElements.length)return null;if(-1===this.start)return this.start=0,this.end=1,this.trailElements[0];this.start===this.end&&(this.trailElements.splice(this.end,0,{position:cc.v3(),lifetime:0,width:0,velocity:cc.v3(),direction:0,color:cc.color()}),this.start++,this.start%=this.trailElements.length);var t=this.end++;return this.end%=this.trailElements.length,this.trailElements[t]},e.iterateElement=function(t,e,i,n){for(var r=this.start>=this.end?this.end+this.trailElements.length:this.end,a=this.start;a<r;a++)e(t,this.trailElements[a%this.trailElements.length],i,n)&&(this.start++,this.start%=this.trailElements.length);this.start===r&&(this.start=-1,this.end=-1)},e.count=function(){return this.start<this.end?this.end-this.start:this.trailElements.length+this.end-this.start},e.clear=function(){this.start=-1,this.end=-1},t})(),q=(n=(0,x.ccclass)("cc.TrailModule"),r=(0,x.property)({type:O.TrailMode}),a=(0,x.property)({type:R.default}),s=(0,x.property)({type:O.Space}),o=(0,x.property)({type:O.TextureMode}),c=(0,x.property)({type:R.default}),l=(0,x.property)({type:I.default}),u=(0,x.property)({type:I.default}),n((d=V((f=(function(){var t,e;function i(){B(this,"_enable",d,this),B(this,"mode",_,this),B(this,"lifeTime",p,this),B(this,"_minParticleDistance",m,this),B(this,"_space",v,this),B(this,"existWithParticles",g,this),B(this,"textureMode",y,this),B(this,"widthFromParticle",T,this),B(this,"widthRatio",b,this),B(this,"colorFromParticle",E,this),B(this,"colorOverTrail",A,this),B(this,"colorOvertime",C,this),this._particleSystem=null,this._minSquaredDistance=0,this._vertSize=0,this._trailNum=0,this._trailLifetime=0,this.vbOffset=0,this.ibOffset=0,this._trailSegments=null,this._particleTrail=null,this._ia=null,this._gfxVFmt=null,this._vbF32=null,this._vbUint32=null,this._iBuffer=null,this._needTransform=null,this._defaultMat=null,this._material=null,this._gfxVFmt=new w.default.VertexFormat([{name:w.default.ATTR_POSITION,type:w.default.ATTR_TYPE_FLOAT32,num:3},{name:w.default.ATTR_TEX_COORD,type:w.default.ATTR_TYPE_FLOAT32,num:4},{name:w.default.ATTR_TEX_COORD1,type:w.default.ATTR_TYPE_FLOAT32,num:3},{name:w.default.ATTR_COLOR,type:w.default.ATTR_TYPE_UINT8,num:4,normalize:!0}]),this._vertSize=this._gfxVFmt._bytes,this._particleTrail=new D.default}t=i,(e=[{key:"enable",get:function(){return this._enable},set:function(t){t&&this._createTrailData(),t&&!this._enable&&(this._enable=t,this._particleSystem._assembler._updateTrailMaterial()),this._enable=t,this._particleSystem._assembler._updateTrailEnable(this._enable)}},{key:"minParticleDistance",get:function(){return this._minParticleDistance},set:function(t){this._minParticleDistance=t,this._minSquaredDistance=t*t}},{key:"space",get:function(){return this._space},set:function(t){this._space=t,this._particleSystem&&this._particleSystem._assembler._updateTrailMaterial()}}])&&k(t.prototype,e);var n=i.prototype;return n.onInit=function(t){this._particleSystem=t,this.minParticleDistance=this._minParticleDistance;for(var e,i=0,n=L(t.bursts);!(e=n()).done;)i+=e.value.getMaxCount(t);this.lifeTime.constant=1,this._trailNum=Math.ceil(t.startLifetime.getMax()*this.lifeTime.getMax()*60*(t.rateOverTime.getMax()*t.duration+i)),this._trailSegments=new M.default(function(){return new X(10)},Math.ceil(t.rateOverTime.getMax()*t.duration)),this._enable&&(this.enable=this._enable,this._updateMaterial())},n.onEnable=function(){},n.onDisable=function(){},n.destroy=function(){this._trailSegments&&(this._trailSegments.clear((function(t){t.trailElements.length=0})),this._trailSegments=null)},n.clear=function(){if(this.enable){for(var t=this._particleTrail.values(),e=t.next();!e.done;)e.value.clear(),e=t.next();this._particleTrail.clear(),this.updateTrailBuffer()}},n._createTrailData=function(){var t=this._particleSystem._assembler._model;if(t){t.createTrailData(this._gfxVFmt,this._trailNum);var e=t._subDatas[1];this._vbF32=e.getVData(),this._vbUint32=e.getVData(Uint32Array),this._iBuffer=e.iData}},n._updateMaterial=function(){if(this._particleSystem){var t=this._particleSystem.trailMaterial;this._material=t||this._particleSystem._assembler._defaultTrailMat}},n.update=function(){this._trailLifetime=this.lifeTime.evaluate(this._particleSystem._time,1),this.space===O.Space.World&&this._particleSystem._simulationSpace===O.Space.Local?(this._needTransform=!0,this._particleSystem.node.getWorldMatrix(W),this._particleSystem.node.getWorldRotation(H)):this._needTransform=!1},n.animate=function(t,e){if(this._trailSegments){var i=this._particleTrail.get(t);if(!i)return i=this._trailSegments.alloc(),void this._particleTrail.set(t,i);var n=i.getElement(i.end-1);if(this._needTransform?S.Vec3.transformMat4(G,t.position,W):S.Vec3.copy(G,t.position),!(n&&(i.iterateElement(this,this._updateTrailElement,t,e),S.Vec3.squaredDistance(n.position,G)<this._minSquaredDistance))&&(n=i.addElement())){S.Vec3.copy(n.position,G),n.lifetime=0,this.widthFromParticle?n.width=t.size.x*this.widthRatio.evaluate(0,1):n.width=this.widthRatio.evaluate(0,1);var r=i.count();if(2===r){var a=i.getElement(i.end-2);S.Vec3.subtract(a.velocity,n.position,a.position)}else if(r>2){var s=i.getElement(i.end-2),o=i.getElement(i.end-3);S.Vec3.subtract(G,o.position,s.position),S.Vec3.subtract(j,n.position,s.position),S.Vec3.subtract(s.velocity,j,G),S.Vec3.equals(cc.Vec3.ZERO,s.velocity)&&S.Vec3.copy(s.velocity,G)}this.colorFromParticle?n.color.set(t.color):n.color.set(this.colorOvertime.evaluate(0,1))}}},n._updateTrailElement=function(t,e,i,n){return e.lifetime+=n,t.colorFromParticle?(e.color.set(i.color),e.color.multiply(t.colorOvertime.evaluate(1-i.remainingLifetime/i.startLifetime,1))):e.color.set(t.colorOvertime.evaluate(1-i.remainingLifetime/i.startLifetime,1)),t.widthFromParticle?e.width=i.size.x*t.widthRatio.evaluate(e.lifetime/t._trailLifetime,1):e.width=t.widthRatio.evaluate(e.lifetime/t._trailLifetime,1),e.lifetime>t._trailLifetime},n.removeParticle=function(t){var e=this._particleTrail.get(t);e&&this._trailSegments&&(e.clear(),this._trailSegments.free(e),this._particleTrail.delete(t))},n.updateTrailBuffer=function(){this.vbOffset=0,this.ibOffset=0;for(var t,e=L(this._particleTrail.keys());!(t=e()).done;){var i=t.value,n=this._particleTrail.get(i);if(-1!==n.start){var r=4*this.vbOffset/this._vertSize,a=n.start>=n.end?n.end+n.trailElements.length:n.end,s=a-n.start,o=1/s,c=n.trailElements[n.start];this._fillVertexBuffer(c,this.colorOverTrail.evaluate(1,1),r,1,0,4);for(var l=n.start+1;l<a;l++){var u=n.trailElements[l%n.trailElements.length],h=l-n.start;this._fillVertexBuffer(u,this.colorOverTrail.evaluate(1-h/s,1),r,1-h*o,h,5)}if(this._needTransform?S.Vec3.transformMat4(U.position,i.position,W):S.Vec3.copy(U.position,i.position),1===s||2===s){var f=n.getElement(n.end-1);S.Vec3.subtract(f.velocity,U.position,f.position),this._vbF32[this.vbOffset-this._vertSize/4-4]=f.velocity.x,this._vbF32[this.vbOffset-this._vertSize/4-3]=f.velocity.y,this._vbF32[this.vbOffset-this._vertSize/4-2]=f.velocity.z,this._vbF32[this.vbOffset-4]=f.velocity.x,this._vbF32[this.vbOffset-3]=f.velocity.y,this._vbF32[this.vbOffset-2]=f.velocity.z,S.Vec3.subtract(U.velocity,U.position,f.position),this._checkDirectionReverse(U,f)}else if(s>2){var d=n.getElement(n.end-1),_=n.getElement(n.end-2);S.Vec3.subtract(G,_.position,d.position),S.Vec3.subtract(j,U.position,d.position),S.Vec3.normalize(G,G),S.Vec3.normalize(j,j),S.Vec3.subtract(d.velocity,j,G),S.Vec3.normalize(d.velocity,d.velocity),this._checkDirectionReverse(d,_),this.vbOffset-=this._vertSize/4*2,this.ibOffset-=6,this._fillVertexBuffer(d,this.colorOverTrail.evaluate(o,1),r,o,s-1,5),S.Vec3.subtract(U.velocity,U.position,d.position),S.Vec3.normalize(U.velocity,U.velocity),this._checkDirectionReverse(U,d)}this.widthFromParticle?U.width=i.size.x*this.widthRatio.evaluate(0,1):U.width=this.widthRatio.evaluate(0,1),U.color=i.color,S.Vec3.equals(U.velocity,cc.Vec3.ZERO)?this.ibOffset-=3:this._fillVertexBuffer(U,this.colorOverTrail.evaluate(0,1),r,0,s,1)}}this._updateIA(this.ibOffset)},n._fillVertexBuffer=function(t,e,i,n,r,a){this._vbF32[this.vbOffset++]=t.position.x,this._vbF32[this.vbOffset++]=t.position.y,this._vbF32[this.vbOffset++]=t.position.z,this._vbF32[this.vbOffset++]=0,this._vbF32[this.vbOffset++]=t.width,this._vbF32[this.vbOffset++]=n,this._vbF32[this.vbOffset++]=0,this._vbF32[this.vbOffset++]=t.velocity.x,this._vbF32[this.vbOffset++]=t.velocity.y,this._vbF32[this.vbOffset++]=t.velocity.z,Y.set(t.color),Y.multiply(e),this._vbUint32[this.vbOffset++]=Y._val,this._vbF32[this.vbOffset++]=t.position.x,this._vbF32[this.vbOffset++]=t.position.y,this._vbF32[this.vbOffset++]=t.position.z,this._vbF32[this.vbOffset++]=1,this._vbF32[this.vbOffset++]=t.width,this._vbF32[this.vbOffset++]=n,this._vbF32[this.vbOffset++]=1,this._vbF32[this.vbOffset++]=t.velocity.x,this._vbF32[this.vbOffset++]=t.velocity.y,this._vbF32[this.vbOffset++]=t.velocity.z,this._vbUint32[this.vbOffset++]=Y._val,1&a&&(this._iBuffer[this.ibOffset++]=i+2*r,this._iBuffer[this.ibOffset++]=i+2*r-1,this._iBuffer[this.ibOffset++]=i+2*r+1),4&a&&(this._iBuffer[this.ibOffset++]=i+2*r,this._iBuffer[this.ibOffset++]=i+2*r+1,this._iBuffer[this.ibOffset++]=i+2*r+2)},n._updateIA=function(t){this._particleSystem&&this._particleSystem._assembler&&this._particleSystem._assembler.updateIA(1,t,!0,!0)},n._checkDirectionReverse=function(t,e){S.Vec3.dot(t.velocity,e.velocity)<z?t.direction=1-e.direction:t.direction=e.direction},i})()).prototype,"_enable",[x.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),V(f.prototype,"enable",[x.property],Object.getOwnPropertyDescriptor(f.prototype,"enable"),f.prototype),_=V(f.prototype,"mode",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return O.TrailMode.Particles}}),p=V(f.prototype,"lifeTime",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new R.default}}),m=V(f.prototype,"_minParticleDistance",[x.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.1}}),V(f.prototype,"minParticleDistance",[x.property],Object.getOwnPropertyDescriptor(f.prototype,"minParticleDistance"),f.prototype),v=V(f.prototype,"_space",[x.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return O.Space.World}}),V(f.prototype,"space",[s],Object.getOwnPropertyDescriptor(f.prototype,"space"),f.prototype),g=V(f.prototype,"existWithParticles",[x.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),y=V(f.prototype,"textureMode",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return O.TextureMode.Stretch}}),T=V(f.prototype,"widthFromParticle",[x.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),b=V(f.prototype,"widthRatio",[c],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new R.default}}),E=V(f.prototype,"colorFromParticle",[x.property],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),A=V(f.prototype,"colorOverTrail",[l],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new I.default}}),C=V(f.prototype,"colorOvertime",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new I.default}}),h=f))||h);i.default=q,e.exports=i.default}),{"../../../../renderer/gfx":326,"../../../../renderer/memop/pool":340,"../../../platform/CCClassDecorator":194,"../../../value-types":293,"../animator/curve-range":31,"../animator/gradient-range":33,"../enum":43,"../utils":50}],50:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0,Object.is||(Object.is=function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e});var n=(function(){function t(t){this.datas=[],!t&&(t=[]),this.datas=[];var e=this;t.forEach((function(t){e.has(t[0])||e.datas.push({key:t[0],value:t[1]})}))}var e=t.prototype;return e.size=function(){return this.datas.length},e.set=function(t,e){this.delete(t),this.datas.push({key:t,value:e})},e.get=function(t){for(var e=void 0,i=this.datas,n=0,r=i.length;n<r;n++)if(Object.is(t,i[n].key)){e=i[n].value;break}return e},e.has=function(t){for(var e=!1,i=this.datas,n=0,r=i.length;n<r;n++)if(Object.is(t,i[n].key)){e=!0;break}return e},e.clear=function(){this.datas.length=0},e.delete=function(t){for(var e=!1,i=this.datas,n=0,r=i.length;n<r;n++)if(Object.is(t,i[n].key)){i.splice(n,1),e=!0;break}return e},e.keys=function(){for(var t=this.datas,e=[],i=0,n=t.length;i<n;i++)e.push(t[i].key);return e},e.values=function(){var t=0,e=this.datas;return{next:function(){return 0===e.length||void 0===e[t]?{value:void 0,done:!0}:{value:e[t++].value,done:!1}}}},t})();i.default=n,e.exports=i.default}),{}],51:[(function(t,e){"use strict";var i=t("../../../animation/animation-curves"),n=i.DynamicAnimCurve,r=i.quickFindIndex,a=cc.Class({name:"cc.JointMatrixCurve",extends:n,_findFrameIndex:r,sample:function(t,e){var i=this.ratios,n=this._findFrameIndex(i,e);n<-1&&(n=~n-1);for(var r=this.pairs,a=0;a<r.length;a++){var s=r[a];s.target._jointMatrix=s.values[n]}}});e.exports=a}),{"../../../animation/animation-curves":11}],52:[(function(t,e){"use strict";var i=cc.Class({name:"cc.Skeleton",extends:cc.Asset,ctor:function(){this.loaded=!1,this._bindposes=[],this._uniqueBindPoses=[],this._jointPaths=[]},properties:{_model:cc.Model,_jointIndices:[],_skinIndex:-1,jointPaths:{get:function(){return this._jointPaths}},bindposes:{get:function(){return this._bindposes}},uniqueBindPoses:{get:function(){return this._uniqueBindPoses}},model:{get:function(){return this._model}}},onLoad:function(){for(var t=this._model.nodes,e=this._jointIndices,i=this._jointPaths,n=this._bindposes,r=this._uniqueBindPoses,a=0;a<e.length;a++){var s=t[e[a]];i[a]=s.path,s.uniqueBindPose?n[a]=r[a]=s.uniqueBindPose:n[a]=s.bindpose[this._skinIndex]}}});cc.Skeleton=e.exports=i}),{}],53:[(function(t,e){"use strict";var i=t("../../components/CCAnimation"),n=t("../CCModel"),r=t("./CCSkeletonAnimationClip"),a=cc.Class({name:"cc.SkeletonAnimation",extends:i,editor:!1,properties:{_model:{default:null,type:n},_defaultClip:{override:!0,default:null,type:r},_clips:{override:!0,default:[],type:[r],visible:!0},defaultClip:{override:!0,get:function(){return this._defaultClip},set:function(t){this._defaultClip=t},type:r},model:{get:function(){return this._model},set:function(t){this._model=t,this._updateClipModel()},type:n}},__preload:function(){this._updateClipModel()},_updateClipModel:function(){this._defaultClip&&(this._defaultClip._model=this._model);for(var t=this._clips,e=0;e<t.length;e++)t[e]._model=this._model},addClip:function(t,e){return t._model=this._model,i.prototype.addClip.call(this,t,e)},searchClips:!1});cc.SkeletonAnimation=e.exports=a}),{"../../components/CCAnimation":124,"../CCModel":27,"./CCSkeletonAnimationClip":54,"fire-path":void 0}],54:[(function(t,e){"use strict";var i,n=(i=t("../../value-types/mat4"))&&i.__esModule?i:{default:i},r=t("../../../animation/animation-clip"),a=t("./CCJointMatrixCurve");function s(t){var e=new Float32Array(16);return e.set(t.m),e}var o=cc.Class({name:"cc.SkeletonAnimationClip",extends:r,properties:{_nativeAsset:{override:!0,get:function(){return this._buffer},set:function(t){var e=ArrayBuffer.isView(t)?t.buffer:t;this._buffer=new Float32Array(e||t,0,e.byteLength/4)}},description:{default:null,type:Object},curveData:{visible:!1,override:!0,get:function(){return this._curveData||{}},set:function(){}}},statics:{preventDeferredLoadDependents:!0},_init:function(){return this._curveData?this._curveData:(this._curveData={},this._generateCommonCurve(),this._model.precomputeJointMatrix&&this._generateJointMatrixCurve(),this._curveData)},_generateCommonCurve:function(){var t=this._buffer,e=this.description,i=0;function n(){return t[i++]}this._curveData.paths||(this._curveData.paths={});var r=this._curveData.paths;for(var a in e){var s=e[a],o={};for(var c in r[a]={props:o},s){var l=[],u=s[c].frameCount;i=s[c].offset;for(var h=0;h<u;h++){var f=n(),d=void 0;"position"===c||"scale"===c?d=cc.v3(n(),n(),n()):"quat"===c&&(d=cc.quat(n(),n(),n(),n())),l.push({frame:f,value:d})}o[c]=l}}},_generateJointMatrixCurve:function(){var t=this._model.rootNode,e=this._curveData.paths,i={ratios:[],jointMatrixMap:{}},r=i.jointMatrixMap;function a(i,o,c){var l,u=e[i.path];if(i!==t&&u){var h,f=u.props;for(var d in f)for(var _=f[d],p=0;p<_.length;p++){var m=_[p];if(Math.abs(m.frame-o)<1e-4){i[d].set(m.value);break}if(m.frame>o){var v=_[p-1],g=(o-v.frame)/(m.frame-v.frame);v.value.lerp(m.value,g,i[d]);break}}l=cc.mat4(),n.default.fromRTS(l,i.quat,i.position,i.scale),c&&n.default.mul(l,c,l),f._jointMatrix||(f._jointMatrix=[]),i.uniqueBindPose&&(h=cc.mat4(),n.default.mul(h,l,i.uniqueBindPose)),r[i.path]||(r[i.path]=[]),h?r[i.path].push(s(h)):r[i.path].push(l)}var y=i.children;for(var T in y)a(y[T],o,l)}for(var o=0,c=this.duration,l=1/this.sample;o<c;)i.ratios.push(o/c),a(t,o),o+=l;this._curveData=i},_createJointMatrixCurve:function(t,e){var i=new a;i.ratios=this.curveData.ratios,i.pairs=[];var n=this.curveData.jointMatrixMap;for(var r in n){var s=cc.find(r,e);s&&i.pairs.push({target:s,values:n[r]})}return[i]},createCurves:function(t,e){return this._model?(this._init(),this._model.precomputeJointMatrix?this._createJointMatrixCurve(t,e):r.prototype.createCurves.call(this,t,e)):(cc.warn("Skeleton Animation Clip ["+this.name+"] Can not find model"),[])}});cc.SkeletonAnimationClip=e.exports=o}),{"../../../animation/animation-clip":10,"../../value-types/mat4":295,"./CCJointMatrixCurve":51}],55:[(function(t,e){"use strict";var i,n=(i=t("../../value-types/mat4"))&&i.__esModule?i:{default:i},r=t("./CCSkeleton"),a=t("../../mesh/CCMeshRenderer"),s=t("../../renderer/render-flow"),o=(t("../../../renderer/enums"),cc.mat4()),c=cc.mat4(),l=cc.Class({name:"cc.SkinnedMeshRenderer",extends:a,editor:!1,ctor:function(){this._jointsData=this._jointsFloat32Data=null,this._jointsTexture=null,this._joints=[],this._dummyNode=new cc.Node,this._jointsTextureOptions=null,this._usingRGBA8Texture=!1},properties:{_skeleton:r,_rootBone:cc.Node,skeleton:{get:function(){return this._skeleton},set:function(t){this._skeleton=t,this._init()},type:r},rootBone:{get:function(){return this._rootBone},set:function(t){this._rootBone=t,this._init()},type:cc.Node},enableAutoBatch:{get:function(){return!1},visible:!1,override:!0}},__preload:function(){this._super(),this._init()},_init:function(){this._model=this._skeleton&&this._skeleton.model,this._calFunc=null,this._initJoints(),this._initJointsTexture(),this._initCalcFunc(),this._updateRenderNode()},_calcWorldMatrixToRoot:function(t){var e=t._worldMatrixToRoot;if(!e){t._worldMatrixToRoot=e=cc.mat4(),t.getLocalMatrix(e);var i=t.parent;i!==this.rootBone&&(i._worldMatrixToRoot||this._calcWorldMatrixToRoot(i),n.default.mul(e,i._worldMatrixToRoot,e))}},_validateRender:function(){this._jointsData?this._super():this.disableRender()},_initJoints:function(){var t=this._joints;if(t.length=0,this.skeleton&&this.rootBone){for(var e=this._useJointMatrix(),i=this.skeleton.jointPaths,r=this.rootBone,a=0;a<i.length;a++){var c=cc.find(i[a],r);c||cc.warn("Can not find joint in root bone [%s] with path [%s]",r.name,i[a]),e&&(c._renderFlag&=~s.FLAG_CHILDREN,this._calcWorldMatrixToRoot(c)),t.push(c)}if(e)for(var l=this.skeleton.uniqueBindPoses,u=0;u<i.length;u++){var h=t[u];l[u]?(n.default.mul(o,h._worldMatrixToRoot,l[u]),h._jointMatrix=n.default.toArray([],o)):h._jointMatrix=h._worldMatrixToRoot}}},_initJointsTexture:function(){if(this._skeleton){var t=this._joints.length,e=!1;if(t<=cc.sys.getMaxJointMatrixSize()&&(e=!0,this._jointsData=this._jointsFloat32Data=new Float32Array(16*t)),!e){var i,n=!!cc.sys.glExtension("OES_texture_float");i=t>256?64:t>64?32:t>16?16:8,this._jointsData=this._jointsFloat32Data=new Float32Array(i*i*4);var r=cc.Texture2D.PixelFormat.RGBA32F,a=i,s=i;n||(this._jointsData=new Uint8Array(this._jointsFloat32Data.buffer),r=cc.Texture2D.PixelFormat.RGBA8888,a*=4,this._usingRGBA8Texture=!0,cc.warn("SkinnedMeshRenderer ["+this.node.name+"] has too many joints ["+t+"] and device do not support float32 texture, fallback to use RGBA8888 texture, which is much slower."));var o=this._jointsTexture||new cc.Texture2D,c=cc.Texture2D.Filter.NEAREST;o.setFilters(c,c),o.initWithData(this._jointsData,r,a,s),this._jointsTexture=o,this._jointsTextureOptions={format:r,width:o.width,height:o.height,images:[]}}this._updateMaterial()}},_updateMaterial:function(){a.prototype._updateMaterial.call(this);for(var t=this.getMaterials(),e=0;e<t.length;e++){var i=t[e];this._jointsTexture?(i.setProperty("jointsTexture",this._jointsTexture),i.setProperty("jointsTextureSize",new Float32Array([this._jointsTexture.width,this._jointsTexture.height])),i.define("CC_JOINTS_TEXTURE_FLOAT32",!!cc.sys.glExtension("OES_texture_float")),i.define("CC_USE_JOINTS_TEXTRUE",!0)):(this._jointsFloat32Data&&i.setProperty("jointMatrices",this._jointsFloat32Data,void 0,!0),i.define("CC_USE_JOINTS_TEXTRUE",!1)),i.define("CC_USE_SKINNING",!0)}},_setJointsDataWithArray:function(t,e){this._jointsFloat32Data.set(e,16*t)},_setJointsDataWithMatrix:function(t,e){this._jointsFloat32Data.set(e.m,16*t)},_commitJointsData:function(){this._jointsTexture&&(this._jointsTextureOptions.images[0]=this._jointsData,this._jointsTexture.update(this._jointsTextureOptions))},_useJointMatrix:function(){return this._model&&this._model.precomputeJointMatrix},_updateRenderNode:function(){this._useJointMatrix()||this._usingRGBA8Texture?this._assembler.setRenderNode(this.rootBone):this._assembler.setRenderNode(this._dummyNode)},_initCalcFunc:function(){this._useJointMatrix()?this._calFunc=this._calJointMatrix:this._usingRGBA8Texture?this._calFunc=this._calRGBA8WorldMatrix:this._calFunc=this._calWorldMatrix},_calJointMatrix:function(){for(var t=this._joints,e=this.skeleton.bindposes,i=this.skeleton.uniqueBindPoses,r=0;r<t.length;++r){var a=t[r]._jointMatrix;i[r]?this._setJointsDataWithArray(r,a):(n.default.multiply(o,a,e[r]),this._setJointsDataWithMatrix(r,o))}},_calRGBA8WorldMatrix:function(){var t=this._joints,e=this.skeleton.bindposes;this.rootBone._updateWorldMatrix();for(var i=this.rootBone._worldMatrix,r=n.default.invert(c,i),a=0;a<t.length;++a){var s=t[a];s._updateWorldMatrix(),n.default.multiply(o,r,s._worldMatrix),n.default.multiply(o,o,e[a]),this._setJointsDataWithMatrix(a,o)}},_calWorldMatrix:function(){for(var t=this._joints,e=this.skeleton.bindposes,i=0;i<t.length;++i){var r=t[i];r._updateWorldMatrix(),n.default.multiply(o,r._worldMatrix,e[i]),this._setJointsDataWithMatrix(i,o)}},calcJointMatrix:function(){this.skeleton&&this.rootBone&&(this._calFunc.call(this),this._commitJointsData())}});cc.SkinnedMeshRenderer=e.exports=l}),{"../../../renderer/enums":321,"../../mesh/CCMeshRenderer":188,"../../renderer/render-flow":226,"../../value-types/mat4":295,"./CCSkeleton":52}],56:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=t("./CCSkinnedMeshRenderer"),r=t("../../mesh/mesh-renderer"),a=(t("../../renderer/render-flow"),(function(t){var e,i;function n(){return t.apply(this,arguments)||this}return i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i,n.prototype.fillBuffers=function(e,i){e.calcJointMatrix(),t.prototype.fillBuffers.call(this,e,i)},n})(r));i.default=a,cc.Assembler.register(n,a),e.exports=i.default}),{"../../mesh/mesh-renderer":191,"../../renderer/render-flow":226,"./CCSkinnedMeshRenderer":55}],57:[(function(t,e){"use strict";var i,n=t("./platform/utils"),r=(t("../../DebugInfos"),"https://github.com/cocos-creator/engine/blob/master/EngineErrorMap.md");function a(t){return function(){var e=arguments[0],i=t+" "+e+", please go to "+r+"#"+e+" to see details.";if(1===arguments.length)return i;if(2===arguments.length)return i+" Arguments: "+arguments[1];var n=cc.js.shiftArguments.apply(null,arguments);return i+" Arguments: "+n.join(", ")}}cc.log=cc.warn=cc.error=cc.assert=console.log.bind?console.log.bind(console):console.log,cc._throw=function(t){n.callInNextTick((function(){throw t}))};var s=a("Log");cc.logID=function(){cc.log(s.apply(null,arguments))};var o=a("Warning");cc.warnID=function(){cc.warn(o.apply(null,arguments))};var c=a("Error");cc.errorID=function(){cc.error(c.apply(null,arguments))};var l=a("Assert");cc.assertID=function(t){t||cc.assert(!1,l.apply(null,cc.js.shiftArguments.apply(null,arguments)))};var u=cc.Enum({NONE:0,INFO:1,WARN:2,ERROR:3,INFO_FOR_WEB_PAGE:4,WARN_FOR_WEB_PAGE:5,ERROR_FOR_WEB_PAGE:6});e.exports=cc.debug={DebugMode:u,_resetDebugSetting:function(t){if(cc.log=cc.warn=cc.error=cc.assert=function(){},t!==u.NONE){if(t>u.ERROR){var e=function(t){if(cc.game.canvas){if(!i){var e=document.createElement("Div");e.setAttribute("id","logInfoDiv"),e.setAttribute("width","200"),e.setAttribute("height",cc.game.canvas.height);var n=e.style;n.zIndex="99999",n.position="absolute",n.top=n.left="0",(i=document.createElement("textarea")).setAttribute("rows","20"),i.setAttribute("cols","30"),i.setAttribute("disabled","true");var r=i.style;r.backgroundColor="transparent",r.borderBottom="1px solid #cccccc",r.borderTopWidth=r.borderLeftWidth=r.borderRightWidth="0px",r.borderTopStyle=r.borderLeftStyle=r.borderRightStyle="none",r.padding="0px",r.margin=0,e.appendChild(i),cc.game.canvas.parentNode.appendChild(e)}i.value=i.value+t+"\r\n",i.scrollTop=i.scrollHeight}};cc.error=function(){e("ERROR :  "+cc.js.formatStr.apply(null,arguments))},cc.assert=function(t,i){!t&&i&&(i=cc.js.formatStr.apply(null,cc.js.shiftArguments.apply(null,arguments)),e("ASSERT: "+i))},t!==u.ERROR_FOR_WEB_PAGE&&(cc.warn=function(){e("WARN :  "+cc.js.formatStr.apply(null,arguments))}),t===u.INFO_FOR_WEB_PAGE&&(cc.log=function(){e(cc.js.formatStr.apply(null,arguments))})}else console&&console.log.apply&&(console.error||(console.error=console.log),console.warn||(console.warn=console.log),console.error.bind?cc.error=console.error.bind(console):cc.error=function(){return console.error.apply(console,arguments)},cc.assert=function(t,e){if(!t)throw e&&(e=cc.js.formatStr.apply(null,cc.js.shiftArguments.apply(null,arguments))),new Error(e)});t!==u.ERROR&&(console.warn.bind?cc.warn=console.warn.bind(console):cc.warn=function(){return console.warn.apply(console,arguments)}),t===u.INFO&&(console.log.bind?cc.log=console.log.bind(console):cc.log=function(){return console.log.apply(console,arguments)})}},getError:a("ERROR"),isDisplayStats:function(){return!!cc.profiler&&cc.profiler.isShowingStats()},setDisplayStats:function(t){cc.profiler&&cc.game.renderType!==cc.game.RENDER_TYPE_CANVAS&&(t?cc.profiler.showStats():cc.profiler.hideStats(),cc.game.config.showFPS=!!t)}}}),{"../../DebugInfos":void 0,"./platform/utils":217}],58:[(function(t,e){"use strict";var i=t("./event/event-target"),n=t("./component-scheduler"),r=t("./node-activator"),a=t("./platform/CCObject"),s=t("./CCGame"),o=t("./renderer"),c=t("./event-manager"),l=t("./CCScheduler");cc.Director=function(){i.call(this),this._paused=!1,this._purgeDirectorInNextLoop=!1,this._winSizeInPoints=null,this._scene=null,this._loadingScene="",this._totalFrames=0,this._lastUpdate=0,this._deltaTime=0,this._startTime=0,this._maxParticleDeltaTime=0,this._scheduler=null,this._compScheduler=null,this._nodeActivator=null,this._actionManager=null;var t=this;s.on(s.EVENT_SHOW,(function(){t._lastUpdate=performance.now()})),s.once(s.EVENT_ENGINE_INITED,this.init,this)},cc.Director.prototype={constructor:cc.Director,init:function(){return this._totalFrames=0,this._lastUpdate=performance.now(),this._startTime=this._lastUpdate,this._paused=!1,this._purgeDirectorInNextLoop=!1,this._winSizeInPoints=cc.size(0,0),this._scheduler=new l,cc.ActionManager?(this._actionManager=new cc.ActionManager,this._scheduler.scheduleUpdate(this._actionManager,l.PRIORITY_SYSTEM,!1)):this._actionManager=null,this.sharedInit(),!0},sharedInit:function(){this._compScheduler=new n,this._nodeActivator=new r,c&&c.setEnabled(!0),cc.AnimationManager?(this._animationManager=new cc.AnimationManager,this._scheduler.scheduleUpdate(this._animationManager,l.PRIORITY_SYSTEM,!1)):this._animationManager=null,cc.CollisionManager?(this._collisionManager=new cc.CollisionManager,this._scheduler.scheduleUpdate(this._collisionManager,l.PRIORITY_SYSTEM,!1)):this._collisionManager=null,cc.PhysicsManager?(this._physicsManager=new cc.PhysicsManager,this._scheduler.scheduleUpdate(this._physicsManager,l.PRIORITY_SYSTEM,!1)):this._physicsManager=null,cc.Physics3DManager?(this._physics3DManager=new cc.Physics3DManager,this._scheduler.scheduleUpdate(this._physics3DManager,l.PRIORITY_SYSTEM,!1)):this._physics3DManager=null,cc._widgetManager&&cc._widgetManager.init(this)},calculateDeltaTime:function(t){t||(t=performance.now()),this._deltaTime=t>this._lastUpdate?(t-this._lastUpdate)/1e3:0,this._lastUpdate=t},convertToGL:function(t){var e=s.container,i=cc.view,n=e.getBoundingClientRect(),r=n.left+window.pageXOffset-e.clientLeft,a=n.top+window.pageYOffset-e.clientTop,o=i._devicePixelRatio*(t.x-r),c=i._devicePixelRatio*(a+n.height-t.y);return i._isRotated?cc.v2(i._viewportRect.width-c,o):cc.v2(o,c)},convertToUI:function(t){var e=s.container,i=cc.view,n=e.getBoundingClientRect(),r=n.left+window.pageXOffset-e.clientLeft,a=n.top+window.pageYOffset-e.clientTop,o=cc.v2(0,0);return i._isRotated?(o.x=r+t.y/i._devicePixelRatio,o.y=a+n.height-(i._viewportRect.width-t.x)/i._devicePixelRatio):(o.x=r+t.x*i._devicePixelRatio,o.y=a+n.height-t.y*i._devicePixelRatio),o},end:function(){this._purgeDirectorInNextLoop=!0},getWinSize:function(){return cc.size(cc.winSize)},getWinSizeInPixels:function(){return cc.size(cc.winSize)},pause:function(){this._paused||(this._paused=!0)},purgeCachedData:function(){cc.assetManager.releaseAll()},purgeDirector:function(){this._scheduler.unscheduleAll(),this._compScheduler.unscheduleAll(),this._nodeActivator.reset(),c&&c.setEnabled(!1),cc.isValid(this._scene)&&this._scene.destroy(),this._scene=null,cc.renderer.clear(),cc.assetManager.builtins.clear(),cc.game.pause(),cc.assetManager.releaseAll()},reset:function(){this.purgeDirector(),c&&c.setEnabled(!0),this._actionManager&&this._scheduler.scheduleUpdate(this._actionManager,cc.Scheduler.PRIORITY_SYSTEM,!1),this._animationManager&&this._scheduler.scheduleUpdate(this._animationManager,cc.Scheduler.PRIORITY_SYSTEM,!1),this._collisionManager&&this._scheduler.scheduleUpdate(this._collisionManager,cc.Scheduler.PRIORITY_SYSTEM,!1),this._physicsManager&&this._scheduler.scheduleUpdate(this._physicsManager,cc.Scheduler.PRIORITY_SYSTEM,!1),cc.game.resume()},runSceneImmediate:function(t,e,i){cc.assertID(t instanceof cc.Scene||t instanceof cc.SceneAsset,1216),t instanceof cc.SceneAsset&&(t=t.scene),t._load();for(var n=Object.keys(s._persistRootNodes).map((function(t){return s._persistRootNodes[t]})),r=0;r<n.length;r++){var o=n[r],c=t.getChildByUuid(o.uuid);if(c){var l=c.getSiblingIndex();c._destroyImmediate(),t.insertChild(o,l)}else o.parent=t}var u=this._scene;cc.assetManager._releaseManager._autoRelease(u,t,n),cc.isValid(u)&&u.destroy(),this._scene=null,a._deferredDestroy(),e&&e(),this.emit(cc.Director.EVENT_BEFORE_SCENE_LAUNCH,t),this._scene=t,t._activate(),cc.game.resume(),i&&i(null,t),this.emit(cc.Director.EVENT_AFTER_SCENE_LAUNCH,t)},runScene:function(t,e,i){cc.assertID(t,1205),cc.assertID(t instanceof cc.Scene||t instanceof cc.SceneAsset,1216),t instanceof cc.SceneAsset&&(t=t.scene),t._load(),this.once(cc.Director.EVENT_AFTER_DRAW,(function(){this.runSceneImmediate(t,e,i)}),this)},loadScene:function(t,e,i){if(this._loadingScene)return cc.warnID(1208,t,this._loadingScene),!1;var n=cc.assetManager.bundles.find((function(e){return e.getSceneInfo(t)}));if(n){this.emit(cc.Director.EVENT_BEFORE_SCENE_LOADING,t),this._loadingScene=t;var r=this;return console.time("LoadScene "+t),n.loadScene(t,(function(n,a){console.timeEnd("LoadScene "+t),r._loadingScene="",n?(n="Failed to load scene: "+n,cc.error(n),e&&e(n)):r.runSceneImmediate(a,i,e)})),!0}return cc.errorID(1209,t),!1},preloadScene:function(t,e,i){var n=cc.assetManager.bundles.find((function(e){return e.getSceneInfo(t)}));if(!n)return cc.errorID(1209,t),null;n.preloadScene(t,null,e,i)},resume:function(){this._paused&&(this._lastUpdate=performance.now(),this._lastUpdate||cc.logID(1200),this._paused=!1,this._deltaTime=0)},setDepthTest:function(t){cc.Camera.main&&(cc.Camera.main.depth=!!t)},setClearColor:function(t){cc.Camera.main&&(cc.Camera.main.backgroundColor=t)},getRunningScene:function(){return this._scene},getScene:function(){return this._scene},getAnimationInterval:function(){return 1e3/s.getFrameRate()},setAnimationInterval:function(t){s.setFrameRate(Math.round(1e3/t))},getDeltaTime:function(){return this._deltaTime},getTotalTime:function(){return performance.now()-this._startTime},getTotalFrames:function(){return this._totalFrames},isPaused:function(){return this._paused},getScheduler:function(){return this._scheduler},setScheduler:function(t){this._scheduler!==t&&(this._scheduler=t)},getActionManager:function(){return this._actionManager},setActionManager:function(t){this._actionManager!==t&&(this._actionManager&&this._scheduler.unscheduleUpdate(this._actionManager),this._actionManager=t,this._scheduler.scheduleUpdate(this._actionManager,cc.Scheduler.PRIORITY_SYSTEM,!1))},getAnimationManager:function(){return this._animationManager},getCollisionManager:function(){return this._collisionManager},getPhysicsManager:function(){return this._physicsManager},getPhysics3DManager:function(){return this._physics3DManager},startAnimation:function(){cc.game.resume()},stopAnimation:function(){cc.game.pause()},_resetDeltaTime:function(){this._lastUpdate=performance.now(),this._deltaTime=0},mainLoop:function(t){this._purgeDirectorInNextLoop?(this._purgeDirectorInNextLoop=!1,this.purgeDirector()):(this.calculateDeltaTime(t),this._paused||(this.emit(cc.Director.EVENT_BEFORE_UPDATE),this._compScheduler.startPhase(),this._compScheduler.updatePhase(this._deltaTime),this._scheduler.update(this._deltaTime),this._compScheduler.lateUpdatePhase(this._deltaTime),this.emit(cc.Director.EVENT_AFTER_UPDATE),a._deferredDestroy()),this.emit(cc.Director.EVENT_BEFORE_DRAW),o.render(this._scene,this._deltaTime),this.emit(cc.Director.EVENT_AFTER_DRAW),c.frameUpdateListeners(),this._totalFrames++)},__fastOn:function(t,e,i){this.on(t,e,i)},__fastOff:function(t,e,i){this.off(t,e,i)}},cc.js.addon(cc.Director.prototype,i.prototype),cc.Director.EVENT_PROJECTION_CHANGED="director_projection_changed",cc.Director.EVENT_BEFORE_SCENE_LOADING="director_before_scene_loading",cc.Director.EVENT_BEFORE_SCENE_LAUNCH="director_before_scene_launch",cc.Director.EVENT_AFTER_SCENE_LAUNCH="director_after_scene_launch",cc.Director.EVENT_BEFORE_UPDATE="director_before_update",cc.Director.EVENT_AFTER_UPDATE="director_after_update",cc.Director.EVENT_BEFORE_VISIT="director_before_draw",cc.Director.EVENT_AFTER_VISIT="director_before_draw",cc.Director.EVENT_BEFORE_DRAW="director_before_draw",cc.Director.EVENT_AFTER_DRAW="director_after_draw",cc.Director.PROJECTION_2D=0,cc.Director.PROJECTION_3D=1,cc.Director.PROJECTION_CUSTOM=3,cc.Director.PROJECTION_DEFAULT=cc.Director.PROJECTION_2D,cc.Director.EVENT_BEFORE_PHYSICS="director_before_physics",cc.Director.EVENT_AFTER_PHYSICS="director_after_physics",cc.director=new cc.Director,e.exports=cc.director}),{"./CCGame":59,"./CCScheduler":63,"./component-scheduler":123,"./event-manager":164,"./event/event-target":166,"./node-activator":192,"./platform/CCObject":199,"./renderer":225}],59:[(function(t,e){"use strict";var i=t("./event/event-target");t("../audio/CCAudioEngine");var n=t("./CCDebug"),r=t("./renderer/index.js"),a=t("../core/renderer/utils/dynamic-atlas/manager"),s={EVENT_HIDE:"game_on_hide",EVENT_SHOW:"game_on_show",EVENT_RESTART:"game_on_restart",EVENT_GAME_INITED:"game_inited",EVENT_ENGINE_INITED:"engine_inited",EVENT_RENDERER_INITED:"engine_inited",RENDER_TYPE_CANVAS:0,RENDER_TYPE_WEBGL:1,RENDER_TYPE_OPENGL:2,_persistRootNodes:{},_paused:!0,_configLoaded:!1,_isCloning:!1,_prepared:!1,_rendererInitialized:!1,_renderContext:null,_intervalId:null,_lastTime:null,_frameTime:null,frame:null,container:null,canvas:null,renderType:-1,config:null,onStart:null,setFrameRate:function(t){this.config.frameRate=t,this._intervalId&&window.cancelAnimFrame(this._intervalId),this._intervalId=0,this._paused=!0,this._setAnimFrame(),this._runMainLoop()},getFrameRate:function(){return this.config.frameRate},step:function(){cc.director.mainLoop()},pause:function(){this._paused||(this._paused=!0,cc.audioEngine&&cc.audioEngine._break(),this._intervalId&&window.cancelAnimFrame(this._intervalId),this._intervalId=0)},resume:function(){this._paused&&(this._paused=!1,cc.audioEngine&&cc.audioEngine._restore(),cc.director._resetDeltaTime(),this._runMainLoop())},isPaused:function(){return this._paused},restart:function(){cc.director.once(cc.Director.EVENT_AFTER_DRAW,(function(){for(var t in s._persistRootNodes)s.removePersistRootNode(s._persistRootNodes[t]);cc.director.getScene().destroy(),cc.Object._deferredDestroy(),cc.audioEngine&&cc.audioEngine.uncacheAll(),cc.director.reset(),s.pause(),cc.assetManager.builtins.init((function(){s.onStart(),s.emit(s.EVENT_RESTART)}))}))},end:function(){close()},_initEngine:function(){this._rendererInitialized||(this._initRenderer(),this._initEvents(),this.emit(this.EVENT_ENGINE_INITED))},_loadPreviewScript:function(t){t()},_prepareFinished:function(t){var e=this;this._initEngine(),this._setAnimFrame(),cc.assetManager.builtins.init((function(){console.log("Cocos Creator v"+cc.ENGINE_VERSION),e._prepared=!0,e._runMainLoop(),e.emit(e.EVENT_GAME_INITED),t&&t()}))},eventTargetOn:i.prototype.on,eventTargetOnce:i.prototype.once,on:function(t,e,i,n){this._prepared&&t===this.EVENT_ENGINE_INITED||!this._paused&&t===this.EVENT_GAME_INITED?e.call(i):this.eventTargetOn(t,e,i,n)},once:function(t,e,i){this._prepared&&t===this.EVENT_ENGINE_INITED||!this._paused&&t===this.EVENT_GAME_INITED?e.call(i):this.eventTargetOnce(t,e,i)},prepare:function(t){var e=this;this._prepared?t&&t():this._loadPreviewScript((function(){e._prepareFinished(t)}))},run:function(t,e){this._initConfig(t),this.onStart=e,this.prepare(s.onStart&&s.onStart.bind(s))},addPersistRootNode:function(t){if(cc.Node.isNode(t)&&t.uuid){var e=t.uuid;if(!this._persistRootNodes[e]){var i=cc.director._scene;if(cc.isValid(i))if(t.parent){if(!(t.parent instanceof cc.Scene))return void cc.warnID(3801);if(t.parent!==i)return void cc.warnID(3802)}else t.parent=i;this._persistRootNodes[e]=t,t._persistNode=!0,cc.assetManager._releaseManager._addPersistNodeRef(t)}}else cc.warnID(3800)},removePersistRootNode:function(t){var e=t.uuid||"";t===this._persistRootNodes[e]&&(delete this._persistRootNodes[e],t._persistNode=!1,cc.assetManager._releaseManager._removePersistNodeRef(t))},isPersistRootNode:function(t){return t._persistNode},_setAnimFrame:function(){this._lastTime=performance.now();var t=s.config.frameRate;this._frameTime=1e3/t,cc.director._maxParticleDeltaTime=this._frameTime/1e3*2,60!==t&&30!==t?(window.requestAnimFrame=this._stTime,window.cancelAnimFrame=this._ctTime):(window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||this._stTime,window.cancelAnimFrame=window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.oCancelAnimationFrame||this._ctTime)},_stTime:function(t){var e=performance.now(),i=Math.max(0,s._frameTime-(e-s._lastTime)),n=window.setTimeout((function(){t()}),i);return s._lastTime=e+i,n},_ctTime:function(t){window.clearTimeout(t)},_runMainLoop:function(){if(this._prepared){var t,e=this,i=e.config,r=cc.director,a=!0,s=i.frameRate;n.setDisplayStats(i.showFPS),t=function(i){if(!e._paused){if(e._intervalId=window.requestAnimFrame(t),30===s&&(a=!a))return;r.mainLoop(i)}},e._intervalId=window.requestAnimFrame(t),e._paused=!1}},_initConfig:function(t){"number"!=typeof t.debugMode&&(t.debugMode=0),t.exposeClassName=!!t.exposeClassName,"number"!=typeof t.frameRate&&(t.frameRate=60);var e=t.renderMode;("number"!=typeof e||e>2||e<0)&&(t.renderMode=0),"boolean"!=typeof t.registerSystemEvent&&(t.registerSystemEvent=!0),t.showFPS=1!==e&&!!t.showFPS,this.collisionMatrix=t.collisionMatrix||[],this.groupList=t.groupList||[],n._resetDebugSetting(t.debugMode),this.config=t,this._configLoaded=!0},_determineRenderType:function(){var t=this.config,e=parseInt(t.renderMode)||0;this.renderType=this.RENDER_TYPE_CANVAS;var i=!1;if(0===e?cc.sys.capabilities.opengl?(this.renderType=this.RENDER_TYPE_WEBGL,i=!0):cc.sys.capabilities.canvas&&(this.renderType=this.RENDER_TYPE_CANVAS,i=!0):1===e&&cc.sys.capabilities.canvas?(this.renderType=this.RENDER_TYPE_CANVAS,i=!0):2===e&&cc.sys.capabilities.opengl&&(this.renderType=this.RENDER_TYPE_WEBGL,i=!0),!i)throw new Error(n.getError(3820,e))},_initRenderer:function(){if(!this._rendererInitialized){var t,e,i,n,s=this.config.id,o=s instanceof HTMLElement?s:document.querySelector(s)||document.querySelector("#"+s);if("CANVAS"===o.tagName?(t=o.width,e=o.height,this.canvas=i=o,this.container=n=document.createElement("DIV"),i.parentNode&&i.parentNode.insertBefore(n,i)):("DIV"!==o.tagName&&cc.warnID(3819),t=o.clientWidth,e=o.clientHeight,this.canvas=i=document.createElement("CANVAS"),this.container=n=document.createElement("DIV"),o.appendChild(n)),n.setAttribute("id","Cocos2dGameContainer"),n.appendChild(i),this.frame=n.parentNode===document.body?document.documentElement:n.parentNode,(function(t){(" "+t.className+" ").indexOf(" gameCanvas ")>-1||(t.className&&(t.className+=" "),t.className+="gameCanvas")})(i),i.setAttribute("width",t||480),i.setAttribute("height",e||320),i.setAttribute("tabindex",99),this._determineRenderType(),this.renderType===this.RENDER_TYPE_WEBGL){var c={stencil:!0,antialias:cc.macro.ENABLE_WEBGL_ANTIALIAS,alpha:cc.macro.ENABLE_TRANSPARENT_CANVAS};r.initWebGL(i,c),this._renderContext=r.device._gl,!cc.macro.CLEANUP_IMAGE_CACHE&&a&&(a.enabled=!0)}this._renderContext||(this.renderType=this.RENDER_TYPE_CANVAS,r.initCanvas(i),this._renderContext=r.device._ctx),this.canvas.oncontextmenu=function(){if(!cc._isContextMenuEnable)return!1},this._rendererInitialized=!0}},_initEvents:function(){var t,e=window;this.config.registerSystemEvent&&cc.internal.inputManager.registerSystemEvent(this.canvas),void 0!==document.hidden?t="hidden":void 0!==document.mozHidden?t="mozHidden":void 0!==document.msHidden?t="msHidden":void 0!==document.webkitHidden&&(t="webkitHidden");var i=!1;function n(){i||(i=!0,s.emit(s.EVENT_HIDE))}function r(t,e,n,r,a){i&&(i=!1,s.emit(s.EVENT_SHOW,t,e,n,r,a))}if(t)for(var a=["visibilitychange","mozvisibilitychange","msvisibilitychange","webkitvisibilitychange","qbrowserVisibilityChange"],o=0;o<a.length;o++)document.addEventListener(a[o],(function(e){var i=document[t];(i=i||e.hidden)?n():r()}));else e.addEventListener("blur",n),e.addEventListener("focus",r);navigator.userAgent.indexOf("MicroMessenger")>-1&&(e.onfocus=r),"onpageshow"in window&&"onpagehide"in window&&(e.addEventListener("pagehide",n),e.addEventListener("pageshow",r),document.addEventListener("pagehide",n),document.addEventListener("pageshow",r)),this.on(s.EVENT_HIDE,(function(){s.pause()})),this.on(s.EVENT_SHOW,(function(){s.resume()}))}};i.call(s),cc.js.addon(s,i.prototype),cc.game=e.exports=s}),{"../audio/CCAudioEngine":21,"../core/renderer/utils/dynamic-atlas/manager":228,"./CCDebug":57,"./event/event-target":166,"./renderer/index.js":225}],60:[(function(t,e){"use strict";var i=t("./value-types"),n=t("./utils/base-node"),r=t("./utils/prefab-helper"),a=t("./utils/trans-pool").NodeMemPool,s=t("./utils/affine-transform"),o=t("./event-manager"),c=t("./platform/CCMacro"),l=t("./platform/js"),u=(t("./event/event"),t("./event/event-target")),h=t("./renderer/render-flow"),f=cc.Object.Flags.Destroying,d=Math.PI/180,_=!!cc.ActionManager,p=function(){},m=new i.Vec3,v=new i.Quat,g=new i.Vec3,y=new i.Vec3,T=new i.Quat,b=new i.Quat,E=new i.Vec3,A=new i.Vec3,C=new i.Vec3,x=new i.Vec3,S=new i.Vec3,w=new i.Quat,M=new i.Quat,R=new i.Vec3,I=new i.Quat,O=new i.Vec3,D=new i.Quat,P=new i.Vec3,L=new i.Vec3,N=new i.Quat,F=new i.Quat,B=(new i.Quat,cc.mat4()),k=new i.Vec3,V=new Array(16);V.length=0;var z=cc.Enum({DEBUG:31}),U=cc.Enum({POSITION:1,SCALE:2,ROTATION:4,SKEW:8,TRS:7,RS:6,TRSS:15,PHYSICS_POSITION:16,PHYSICS_SCALE:32,PHYSICS_ROTATION:64,PHYSICS_TRS:112,PHYSICS_RS:96,ALL_POSITION:17,ALL_SCALE:34,ALL_ROTATION:68,ALL_TRS:119,ALL:65535}),H=cc.Enum({TOUCH_START:"touchstart",TOUCH_MOVE:"touchmove",TOUCH_END:"touchend",TOUCH_CANCEL:"touchcancel",MOUSE_DOWN:"mousedown",MOUSE_MOVE:"mousemove",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_UP:"mouseup",MOUSE_WHEEL:"mousewheel",POSITION_CHANGED:"position-changed",ROTATION_CHANGED:"rotation-changed",SCALE_CHANGED:"scale-changed",SIZE_CHANGED:"size-changed",ANCHOR_CHANGED:"anchor-changed",COLOR_CHANGED:"color-changed",CHILD_ADDED:"child-added",CHILD_REMOVED:"child-removed",CHILD_REORDER:"child-reorder",GROUP_CHANGED:"group-changed",SIBLING_ORDER_CHANGED:"sibling-order-changed"}),W=[H.TOUCH_START,H.TOUCH_MOVE,H.TOUCH_END,H.TOUCH_CANCEL],G=[H.MOUSE_DOWN,H.MOUSE_ENTER,H.MOUSE_MOVE,H.MOUSE_LEAVE,H.MOUSE_UP,H.MOUSE_WHEEL],j=!0,Y=function(t){if(0!==t){j&&cc.warn("`cc.Node.skewX/Y` is deprecated since v2.2.1, please use 3D node instead.",""),j=!1}},X=null,q=function(t,e){var i=t.getLocation(),n=this.owner;return!!n._hitTest(i,this)&&(e.type=H.TOUCH_START,e.touch=t,e.bubbles=!0,n.dispatchEvent(e),!0)},Z=function(t,e){var i=this.owner;e.type=H.TOUCH_MOVE,e.touch=t,e.bubbles=!0,i.dispatchEvent(e)},K=function(t,e){var i=t.getLocation(),n=this.owner;n._hitTest(i,this)?e.type=H.TOUCH_END:e.type=H.TOUCH_CANCEL,e.touch=t,e.bubbles=!0,n.dispatchEvent(e)},Q=function(t,e){t.getLocation();var i=this.owner;e.type=H.TOUCH_CANCEL,e.touch=t,e.bubbles=!0,i.dispatchEvent(e)},J=function(t){var e=t.getLocation(),i=this.owner;i._hitTest(e,this)&&(t.type=H.MOUSE_DOWN,t.bubbles=!0,i.dispatchEvent(t))},$=function(t){var e=t.getLocation(),i=this.owner;if(i._hitTest(e,this))this._previousIn||(X&&X._mouseListener&&(t.type=H.MOUSE_LEAVE,X.dispatchEvent(t),X._mouseListener._previousIn=!1),X=this.owner,t.type=H.MOUSE_ENTER,i.dispatchEvent(t),this._previousIn=!0),t.type=H.MOUSE_MOVE,t.bubbles=!0,i.dispatchEvent(t);else{if(!this._previousIn)return;t.type=H.MOUSE_LEAVE,i.dispatchEvent(t),this._previousIn=!1,X=null}t.stopPropagation()},tt=function(t){var e=t.getLocation(),i=this.owner;i._hitTest(e,this)&&(t.type=H.MOUSE_UP,t.bubbles=!0,i.dispatchEvent(t),t.stopPropagation())},et=function(t){var e=t.getLocation(),i=this.owner;i._hitTest(e,this)&&(t.type=H.MOUSE_WHEEL,t.bubbles=!0,i.dispatchEvent(t),t.stopPropagation())};function it(t,e){if(e){for(var i=0,n=null,r=t;r&&cc.Node.isNode(r);r=r._parent,++i)if(r.getComponent(e)){var a={index:i,node:r};n?n.push(a):n=[a]}return n}return null}function nt(t,e){if(!(t._objFlags&f)){if(t._bubblingListeners)for(var i=0,n=e.length;i<n;++i)if(t._bubblingListeners.hasEventListener(e[i]))return!0;if(t._capturingListeners)for(var r=0,a=e.length;r<a;++r)if(t._capturingListeners.hasEventListener(e[r]))return!0;return!1}return!0}function rt(t,e){var i,n;for(e.target=t,V.length=0,t._getCapturingTargets(e.type,V),e.eventPhase=1,n=V.length-1;n>=0;--n)if((i=V[n])._capturingListeners&&(e.currentTarget=i,i._capturingListeners.emit(e.type,e,V),e._propagationStopped))return void(V.length=0);if(V.length=0,e.eventPhase=2,e.currentTarget=t,t._capturingListeners&&t._capturingListeners.emit(e.type,e),!e._propagationImmediateStopped&&t._bubblingListeners&&t._bubblingListeners.emit(e.type,e),!e._propagationStopped&&e.bubbles)for(t._getBubblingTargets(e.type,V),e.eventPhase=3,n=0;n<V.length;++n)if((i=V[n])._bubblingListeners&&(e.currentTarget=i,i._bubblingListeners.emit(e.type,e),e._propagationStopped))return void(V.length=0);V.length=0}function at(t){var e=t.groupIndex;return 0===e&&t.parent&&(e=at(t.parent)),e}function st(t){var e=at(t);t._cullingMask=1<<e;for(var i=0;i<t._children.length;i++)st(t._children[i])}function ot(){if(this._localMatDirty&U.TRSS){var t=this._matrix,e=t.m;if(i.Trs.toMat4(t,this._trs),this._skewX||this._skewY){var n=e[0],r=e[1],a=e[4],s=e[5],o=Math.tan(this._skewX*d),c=Math.tan(this._skewY*d);o===1/0&&(o=99999999),c===1/0&&(c=99999999),e[0]=n+a*c,e[1]=r+s*c,e[4]=a+n*o,e[5]=s+r*o}this._localMatDirty&=~U.TRSS,this._worldMatDirty=!0}}function ct(){var t=this._localMatDirty;if(t&U.TRSS){var e=this._matrix.m,i=this._trs;if(t&(U.RS|U.SKEW)){var n=-this._eulerAngles.z,r=this._skewX||this._skewY,a=i[7],s=i[8];if(n||r){var o=1,c=0,l=0,u=1;if(n){var h=n*d;l=Math.sin(h),o=u=Math.cos(h),c=-l}if(e[0]=o*=a,e[1]=c*=a,e[4]=l*=s,e[5]=u*=s,r){var f=e[0],_=e[1],p=e[4],m=e[5],v=Math.tan(this._skewX*d),g=Math.tan(this._skewY*d);v===1/0&&(v=99999999),g===1/0&&(g=99999999),e[0]=f+p*g,e[1]=_+m*g,e[4]=p+f*v,e[5]=m+_*v}}else e[0]=a,e[1]=0,e[4]=0,e[5]=s}e[12]=i[0],e[13]=i[1],this._localMatDirty&=~U.TRSS,this._worldMatDirty=!0}}function lt(){if(this._localMatDirty&U.TRSS&&this._updateLocalMatrix(),this._parent){var t=this._parent._worldMatrix;i.Mat4.mul(this._worldMatrix,t,this._matrix)}else i.Mat4.copy(this._worldMatrix,this._matrix);this._worldMatDirty=!1}function ut(){this._localMatDirty&U.TRSS&&this._updateLocalMatrix();var t=this._parent;t?this._mulMat(this._worldMatrix,t._worldMatrix,this._matrix):i.Mat4.copy(this._worldMatrix,this._matrix),this._worldMatDirty=!1}function ht(t,e,i){var n=e.m,r=i.m,a=t.m,s=n[0],o=n[1],c=n[4],l=n[5],u=n[12],h=n[13],f=r[0],d=r[1],_=r[4],p=r[5],m=r[12],v=r[13];0!==o||0!==c?(a[0]=f*s+d*c,a[1]=f*o+d*l,a[4]=_*s+p*c,a[5]=_*o+p*l,a[12]=s*m+c*v+u,a[13]=o*m+l*v+h):(a[0]=f*s,a[1]=d*l,a[4]=_*s,a[5]=p*l,a[12]=s*m+u,a[13]=l*v+h)}var ft=i.Mat4.mul,dt={name:"cc.Node",extends:n,properties:{_opacity:255,_color:cc.Color.WHITE,_contentSize:cc.Size,_anchorPoint:cc.v2(.5,.5),_position:void 0,_scale:void 0,_trs:null,_eulerAngles:cc.Vec3,_skewX:0,_skewY:0,_zIndex:{default:void 0,type:cc.Integer},_localZOrder:{default:0,serializable:!1},_is3DNode:!1,_groupIndex:{default:0,formerlySerializedAs:"groupIndex"},groupIndex:{get:function(){return this._groupIndex},set:function(t){this._groupIndex=t,st(this),this.emit(H.GROUP_CHANGED,this)}},group:{get:function(){return cc.game.groupList[this.groupIndex]||""},set:function(t){this.groupIndex=cc.game.groupList.indexOf(t)}},x:{get:function(){return this._trs[0]},set:function(t){var e=this._trs;t!==e[0]&&(e[0]=t,this.setLocalDirty(U.ALL_POSITION),1&this._eventMask&&this.emit(H.POSITION_CHANGED))}},y:{get:function(){return this._trs[1]},set:function(t){var e=this._trs;t!==e[1]&&(e[1]=t,this.setLocalDirty(U.ALL_POSITION),1&this._eventMask&&this.emit(H.POSITION_CHANGED))}},z:{get:function(){return this._trs[2]},set:function(t){var e=this._trs;t!==e[2]&&(e[2]=t,this.setLocalDirty(U.ALL_POSITION),this._renderFlag|=h.FLAG_WORLD_TRANSFORM,1&this._eventMask&&this.emit(H.POSITION_CHANGED))}},rotation:{get:function(){return-this.angle},set:function(t){this.angle=-t}},angle:{get:function(){return this._eulerAngles.z},set:function(t){i.Vec3.set(this._eulerAngles,0,0,t),i.Trs.fromAngleZ(this._trs,t),this.setLocalDirty(U.ALL_ROTATION),4&this._eventMask&&this.emit(H.ROTATION_CHANGED)}},rotationX:{get:function(){return this._eulerAngles.x},set:function(t){this._eulerAngles.x!==t&&(this._eulerAngles.x=t,this._eulerAngles.x===this._eulerAngles.y?i.Trs.fromAngleZ(this._trs,-t):i.Trs.fromEulerNumber(this._trs,t,this._eulerAngles.y,0),this.setLocalDirty(U.ALL_ROTATION),4&this._eventMask&&this.emit(H.ROTATION_CHANGED))}},rotationY:{get:function(){return this._eulerAngles.y},set:function(t){this._eulerAngles.y!==t&&(this._eulerAngles.y=t,this._eulerAngles.x===this._eulerAngles.y?i.Trs.fromAngleZ(this._trs,-t):i.Trs.fromEulerNumber(this._trs,this._eulerAngles.x,t,0),this.setLocalDirty(U.ALL_ROTATION),4&this._eventMask&&this.emit(H.ROTATION_CHANGED))}},eulerAngles:{get:function(){return i.Trs.toEuler(this._eulerAngles,this._trs)},set:function(t){i.Trs.fromEuler(this._trs,t),this.setLocalDirty(U.ALL_ROTATION),this._renderFlag|=h.FLAG_TRANSFORM,4&this._eventMask&&this.emit(H.ROTATION_CHANGED)}},quat:{get:function(){var t=this._trs;return new i.Quat(t[3],t[4],t[5],t[6])},set:function(t){this.setRotation(t)}},scale:{get:function(){return this._trs[7]},set:function(t){this.setScale(t)}},scaleX:{get:function(){return this._trs[7]},set:function(t){this._trs[7]!==t&&(this._trs[7]=t,this.setLocalDirty(U.ALL_SCALE),2&this._eventMask&&this.emit(H.SCALE_CHANGED))}},scaleY:{get:function(){return this._trs[8]},set:function(t){this._trs[8]!==t&&(this._trs[8]=t,this.setLocalDirty(U.ALL_SCALE),2&this._eventMask&&this.emit(H.SCALE_CHANGED))}},scaleZ:{get:function(){return this._trs[9]},set:function(t){this._trs[9]!==t&&(this._trs[9]=t,this.setLocalDirty(U.ALL_SCALE),this._renderFlag|=h.FLAG_TRANSFORM,2&this._eventMask&&this.emit(H.SCALE_CHANGED))}},skewX:{get:function(){return this._skewX},set:function(t){Y(t),this._skewX=t,this.setLocalDirty(U.SKEW)}},skewY:{get:function(){return this._skewY},set:function(t){Y(t),this._skewY=t,this.setLocalDirty(U.SKEW)}},opacity:{get:function(){return this._opacity},set:function(t){t=cc.misc.clampf(t,0,255),this._opacity!==t&&(this._opacity=t,this._renderFlag|=h.FLAG_OPACITY_COLOR)},range:[0,255]},color:{get:function(){return this._color.clone()},set:function(t){this._color.equals(t)||(this._color.set(t),this._renderFlag|=h.FLAG_COLOR,32&this._eventMask&&this.emit(H.COLOR_CHANGED,t))}},anchorX:{get:function(){return this._anchorPoint.x},set:function(t){var e=this._anchorPoint;e.x!==t&&(e.x=t,16&this._eventMask&&this.emit(H.ANCHOR_CHANGED))}},anchorY:{get:function(){return this._anchorPoint.y},set:function(t){var e=this._anchorPoint;e.y!==t&&(e.y=t,16&this._eventMask&&this.emit(H.ANCHOR_CHANGED))}},width:{get:function(){return this._contentSize.width},set:function(t){t!==this._contentSize.width&&(this._contentSize.width=t,8&this._eventMask&&this.emit(H.SIZE_CHANGED))}},height:{get:function(){return this._contentSize.height},set:function(t){t!==this._contentSize.height&&(this._contentSize.height=t,8&this._eventMask&&this.emit(H.SIZE_CHANGED))}},zIndex:{get:function(){return this._localZOrder>>16},set:function(t){t>c.MAX_ZINDEX?(cc.warnID(1636),t=c.MAX_ZINDEX):t<c.MIN_ZINDEX&&(cc.warnID(1637),t=c.MIN_ZINDEX),this.zIndex!==t&&(this._localZOrder=65535&this._localZOrder|t<<16,this.emit(H.SIBLING_ORDER_CHANGED),this._onSiblingIndexChanged())}},is3DNode:{get:function(){return this._is3DNode},set:function(t){this._is3DNode=t,this._update3DFunction()}},up:{get:function(){return i.Vec3.transformQuat(O,i.Vec3.UP,this.getWorldRotation(D)).clone()}},right:{get:function(){return i.Vec3.transformQuat(O,i.Vec3.RIGHT,this.getWorldRotation(D)).clone()}},forward:{get:function(){return i.Vec3.transformQuat(O,i.Vec3.FORWARD,this.getWorldRotation(D)).clone()}}},ctor:function(){this._reorderChildDirty=!1,this._widget=null,this._renderComponent=null,this._capturingListeners=null,this._bubblingListeners=null,this._touchListener=null,this._mouseListener=null,this._initDataFromPool(),this._eventMask=0,this._cullingMask=1,this._childArrivalOrder=1,this._renderFlag=h.FLAG_TRANSFORM|h.FLAG_OPACITY_COLOR},statics:{EventType:H,_LocalDirtyFlag:U,isNode:function(t){return t instanceof _t&&(t.constructor===_t||!(t instanceof cc.Scene))},BuiltinGroupIndex:z},_onSiblingIndexChanged:function(){this._parent&&this._parent._delaySort()},_onPreDestroy:function(){this._onPreDestroyBase(),_&&cc.director.getActionManager().removeAllActionsFromTarget(this),X===this&&(X=null),this._bubblingListeners&&this._bubblingListeners.clear(),this._capturingListeners&&this._capturingListeners.clear(),(this._touchListener||this._mouseListener)&&(o.removeListeners(this),this._touchListener&&(this._touchListener.owner=null,this._touchListener.mask=null,this._touchListener=null),this._mouseListener&&(this._mouseListener.owner=null,this._mouseListener.mask=null,this._mouseListener=null)),this._backDataIntoPool(),this._reorderChildDirty&&cc.director.__fastOff(cc.Director.EVENT_AFTER_UPDATE,this.sortAllChildren,this)},_onPostActivated:function(t){var e=_?cc.director.getActionManager():null;t?(this._renderFlag|=h.FLAG_WORLD_TRANSFORM,e&&e.resumeTarget(this),o.resumeTarget(this),this._checkListenerMask()):(e&&e.pauseTarget(this),o.pauseTarget(this))},_onHierarchyChanged:function(t){this._updateOrderOfArrival(),st(this),this._parent&&this._parent._delaySort(),this._renderFlag|=h.FLAG_WORLD_TRANSFORM,this._onHierarchyChangedBase(t),cc._widgetManager&&(cc._widgetManager._nodesOrderDirty=!0),t&&this._activeInHierarchy&&this._checkListenerMask()},_update3DFunction:function(){this._is3DNode?(this._updateLocalMatrix=ot,this._calculWorldMatrix=lt,this._mulMat=ft):(this._updateLocalMatrix=ct,this._calculWorldMatrix=ut,this._mulMat=ht),this._renderComponent&&this._renderComponent._on3DNodeChanged&&this._renderComponent._on3DNodeChanged(),this._renderFlag|=h.FLAG_TRANSFORM,this._localMatDirty=U.ALL},_initDataFromPool:function(){this._spaceInfo||(this._spaceInfo=a.pop());var t=this._spaceInfo;this._matrix=cc.mat4(t.localMat),i.Mat4.identity(this._matrix),this._worldMatrix=cc.mat4(t.worldMat),i.Mat4.identity(this._worldMatrix),this._localMatDirty=U.ALL,this._worldMatDirty=!0;var e=this._trs=t.trs;e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=1,e[7]=1,e[8]=1,e[9]=1},_backDataIntoPool:function(){a.push(this._spaceInfo),this._matrix=null,this._worldMatrix=null,this._trs=null,this._spaceInfo=null},_toEuler:function(){if(this.is3DNode)i.Trs.toEuler(this._eulerAngles,this._trs);else{var t=Math.asin(this._trs[5])/d*2;i.Vec3.set(this._eulerAngles,0,0,t)}},_fromEuler:function(){this.is3DNode?i.Trs.fromEuler(this._trs,this._eulerAngles):i.Trs.fromAngleZ(this._trs,this._eulerAngles.z)},_initProperties:function(){this._is3DNode&&this._update3DFunction();var t=this._trs;if(t){var e=t;t=this._trs=this._spaceInfo.trs,11===e.length?t.set(e.subarray(1)):t.set(e)}else t=this._trs=this._spaceInfo.trs;this._fromEuler()},_onBatchCreated:function(t){this._initProperties(),this._cullingMask=1<<at(this),this._activeInHierarchy||(_&&cc.director.getActionManager().pauseTarget(this),o.pauseTarget(this));for(var e=this._children,i=0,n=e.length;i<n;i++){var a=e[i];if(!t){var s=a._prefab;s&&s.sync&&s.root===a&&r.syncWithPrefab(a),a._updateOrderOfArrival()}a._onBatchCreated(t)}e.length>0&&(this._renderFlag|=h.FLAG_CHILDREN)},_checkListenerMask:function(){if(this._touchListener){var t=this._touchListener.mask=it(this,cc.Mask);this._mouseListener&&(this._mouseListener.mask=t)}else this._mouseListener&&(this._mouseListener.mask=it(this,cc.Mask))},_checknSetupSysEvent:function(t){var e=!1,i=!1;return-1!==W.indexOf(t)?(this._touchListener||(this._touchListener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,owner:this,mask:it(this,cc.Mask),onTouchBegan:q,onTouchMoved:Z,onTouchEnded:K,onTouchCancelled:Q}),o.addListener(this._touchListener,this),e=!0),i=!0):-1!==G.indexOf(t)&&(this._mouseListener||(this._mouseListener=cc.EventListener.create({event:cc.EventListener.MOUSE,_previousIn:!1,owner:this,mask:it(this,cc.Mask),onMouseDown:J,onMouseMove:$,onMouseUp:tt,onMouseScroll:et}),o.addListener(this._mouseListener,this),e=!0),i=!0),e&&!this._activeInHierarchy&&cc.director.getScheduler().schedule((function(){this._activeInHierarchy||o.pauseTarget(this)}),this,0,0,0,!1),i},on:function(t,e,i,n){if(this._checknSetupSysEvent(t))return this._onDispatch(t,e,i,n);switch(t){case H.POSITION_CHANGED:this._eventMask|=1;break;case H.SCALE_CHANGED:this._eventMask|=2;break;case H.ROTATION_CHANGED:this._eventMask|=4;break;case H.SIZE_CHANGED:this._eventMask|=8;break;case H.ANCHOR_CHANGED:this._eventMask|=16;break;case H.COLOR_CHANGED:this._eventMask|=32}return this._bubblingListeners||(this._bubblingListeners=new u),this._bubblingListeners.on(t,e,i)},once:function(t,e,i,n){var r=this,a=null;(a=this._checknSetupSysEvent(t)&&n?this._capturingListeners=this._capturingListeners||new u:this._bubblingListeners=this._bubblingListeners||new u).once(t,e,i),a.once(t,(function(){r.off(t,e,i)}),void 0)},_onDispatch:function(t,e,i,n){if("boolean"==typeof i?(n=i,i=void 0):n=!!n,e){var r=null;return(r=n?this._capturingListeners=this._capturingListeners||new u:this._bubblingListeners=this._bubblingListeners||new u).hasEventListener(t,e,i)||(r.on(t,e,i),i&&i.__eventTargets&&i.__eventTargets.push(this)),e}cc.errorID(6800)},off:function(t,e,i,n){var r=-1!==W.indexOf(t),a=!r&&-1!==G.indexOf(t);if(r||a)this._offDispatch(t,e,i,n),r?this._touchListener&&!nt(this,W)&&(o.removeListener(this._touchListener),this._touchListener=null):a&&this._mouseListener&&!nt(this,G)&&(o.removeListener(this._mouseListener),this._mouseListener=null);else if(this._bubblingListeners&&(this._bubblingListeners.off(t,e,i),!this._bubblingListeners.hasEventListener(t)))switch(t){case H.POSITION_CHANGED:this._eventMask&=-2;break;case H.SCALE_CHANGED:this._eventMask&=-3;break;case H.ROTATION_CHANGED:this._eventMask&=-5;break;case H.SIZE_CHANGED:this._eventMask&=-9;break;case H.ANCHOR_CHANGED:this._eventMask&=-17;break;case H.COLOR_CHANGED:this._eventMask&=-33}},_offDispatch:function(t,e,i,n){if("boolean"==typeof i?(n=i,i=void 0):n=!!n,e){var r=n?this._capturingListeners:this._bubblingListeners;r&&(r.off(t,e,i),i&&i.__eventTargets&&l.array.fastRemove(i.__eventTargets,this))}else this._capturingListeners&&this._capturingListeners.removeAll(t),this._bubblingListeners&&this._bubblingListeners.removeAll(t)},targetOff:function(t){var e=this._bubblingListeners;e&&(e.targetOff(t),1&this._eventMask&&!e.hasEventListener(H.POSITION_CHANGED)&&(this._eventMask&=-2),2&this._eventMask&&!e.hasEventListener(H.SCALE_CHANGED)&&(this._eventMask&=-3),4&this._eventMask&&!e.hasEventListener(H.ROTATION_CHANGED)&&(this._eventMask&=-5),8&this._eventMask&&!e.hasEventListener(H.SIZE_CHANGED)&&(this._eventMask&=-9),16&this._eventMask&&!e.hasEventListener(H.ANCHOR_CHANGED)&&(this._eventMask&=-17),32&this._eventMask&&!e.hasEventListener(H.COLOR_CHANGED)&&(this._eventMask&=-33)),this._capturingListeners&&this._capturingListeners.targetOff(t),t&&t.__eventTargets&&l.array.fastRemove(t.__eventTargets,this),this._touchListener&&!nt(this,W)&&(o.removeListener(this._touchListener),this._touchListener=null),this._mouseListener&&!nt(this,G)&&(o.removeListener(this._mouseListener),this._mouseListener=null)},hasEventListener:function(t){var e=!1;return this._bubblingListeners&&(e=this._bubblingListeners.hasEventListener(t)),!e&&this._capturingListeners&&(e=this._capturingListeners.hasEventListener(t)),e},emit:function(t,e,i,n,r,a){this._bubblingListeners&&this._bubblingListeners.emit(t,e,i,n,r,a)},dispatchEvent:function(t){rt(this,t),V.length=0},pauseSystemEvents:function(t){o.pauseTarget(this,t)},resumeSystemEvents:function(t){o.resumeTarget(this,t)},_hitTest:function(t,e){var n=this._contentSize.width,r=this._contentSize.height,a=P,s=L,o=cc.Camera.findCamera(this);if(o?o.getScreenToWorldPoint(t,a):a.set(t),this._updateWorldMatrix(),!i.Mat4.invert(B,this._worldMatrix))return!1;i.Vec2.transformMat4(s,a,B),s.x+=this._anchorPoint.x*n,s.y+=this._anchorPoint.y*r;var c=!1;if(s.x>=0&&s.y>=0&&s.x<=n&&s.y<=r&&(c=!0,e&&e.mask))for(var l=e.mask,u=this,h=l?l.length:0,f=0,d=0;u&&d<h;++f,u=u.parent){var _=l[d];if(f===_.index){if(u!==_.node){l.length=d;break}var p=u.getComponent(cc.Mask);if(p&&p._enabled&&!p._hitTest(a)){c=!1;break}d++}else if(f>_.index){l.length=d;break}}return c},_getCapturingTargets:function(t,e){for(var i=this.parent;i;)i._capturingListeners&&i._capturingListeners.hasEventListener(t)&&e.push(i),i=i.parent},_getBubblingTargets:function(t,e){for(var i=this.parent;i;)i._bubblingListeners&&i._bubblingListeners.hasEventListener(t)&&e.push(i),i=i.parent},runAction:_?function(t){if(this.active){cc.assertID(t,1618);var e=cc.director.getActionManager();return e._suppressDeprecation||(e._suppressDeprecation=!0,cc.warnID(1639)),e.addAction(t,this,!1),t}}:p,pauseAllActions:_?function(){cc.director.getActionManager().pauseTarget(this)}:p,resumeAllActions:_?function(){cc.director.getActionManager().resumeTarget(this)}:p,stopAllActions:_?function(){cc.director.getActionManager().removeAllActionsFromTarget(this)}:p,stopAction:_?function(t){cc.director.getActionManager().removeAction(t)}:p,stopActionByTag:_?function(t){t!==cc.Action.TAG_INVALID?cc.director.getActionManager().removeActionByTag(t,this):cc.logID(1612)}:p,getActionByTag:_?function(t){return t===cc.Action.TAG_INVALID?(cc.logID(1613),null):cc.director.getActionManager().getActionByTag(t,this)}:function(){return null},getNumberOfRunningActions:_?function(){return cc.director.getActionManager().getNumberOfRunningActionsInTarget(this)}:function(){return 0},getPosition:function(t){return t=t||new i.Vec3,i.Trs.toPosition(t,this._trs)},setPosition:function(t,e,i){var n;void 0===e?(n=t.x,e=t.y,i=t.z):n=t;var r=this._trs;void 0===i&&(i=r[2]),(r[0]!==n||r[1]!==e||r[2]!==i)&&(r[0]=n,r[1]=e,r[2]=i,this.setLocalDirty(U.ALL_POSITION),this._renderFlag|=h.FLAG_WORLD_TRANSFORM,1&this._eventMask&&this.emit(H.POSITION_CHANGED))},getScale:function(t){return void 0!==t?i.Trs.toScale(t,this._trs):(cc.errorID(1400,"cc.Node.getScale","cc.Node.scale or cc.Node.getScale(cc.Vec3)"),this._trs[7])},setScale:function(t,e,i){var n;t&&"number"!=typeof t?(n=t.x,e=t.y,i=t.z):void 0!==t&&void 0===e?(n=t,e=t,i=t):n=t;var r=this._trs;void 0===i&&(i=r[9]),r[7]===n&&r[8]===e&&r[9]===i||(r[7]=n,r[8]=e,r[9]=i,this.setLocalDirty(U.ALL_SCALE),this._renderFlag|=h.FLAG_TRANSFORM,2&this._eventMask&&this.emit(H.SCALE_CHANGED))},getRotation:function(t){return t instanceof i.Quat?i.Trs.toRotation(t,this._trs):-this.angle},setRotation:function(t,e,i,n){if("number"==typeof t&&void 0===e)this.angle=-t;else{var r=t;void 0===e&&(r=t.x,e=t.y,i=t.z,n=t.w);var a=this._trs;a[3]===r&&a[4]===e&&a[5]===i&&a[6]===n||(a[3]=r,a[4]=e,a[5]=i,a[6]=n,this.setLocalDirty(U.ALL_ROTATION),4&this._eventMask&&this.emit(H.ROTATION_CHANGED))}},getContentSize:function(){return cc.size(this._contentSize.width,this._contentSize.height)},setContentSize:function(t,e){var i=this._contentSize;if(void 0===e){if(t.width===i.width&&t.height===i.height)return;i.width=t.width,i.height=t.height}else{if(t===i.width&&e===i.height)return;i.width=t,i.height=e}8&this._eventMask&&this.emit(H.SIZE_CHANGED)},getAnchorPoint:function(){return cc.v2(this._anchorPoint)},setAnchorPoint:function(t,e){var i=this._anchorPoint;if(void 0===e){if(t.x===i.x&&t.y===i.y)return;i.x=t.x,i.y=t.y}else{if(t===i.x&&e===i.y)return;i.x=t,i.y=e}this.setLocalDirty(U.ALL_POSITION),16&this._eventMask&&this.emit(H.ANCHOR_CHANGED)},_invTransformPoint:function(t,e){this._parent?this._parent._invTransformPoint(t,e):i.Vec3.copy(t,e);var n=this._trs;return i.Trs.toPosition(g,n),i.Vec3.sub(t,t,g),i.Trs.toRotation(T,n),i.Quat.conjugate(b,T),i.Vec3.transformQuat(t,t,b),i.Trs.toScale(g,n),i.Vec3.inverseSafe(y,g),i.Vec3.mul(t,t,y),t},getWorldPosition:function(t){i.Trs.toPosition(t,this._trs);for(var e,n=this._parent;n;)e=n._trs,i.Trs.toScale(m,e),i.Vec3.mul(t,t,m),i.Trs.toRotation(v,e),i.Vec3.transformQuat(t,t,v),i.Trs.toPosition(m,e),i.Vec3.add(t,t,m),n=n._parent;return t},setWorldPosition:function(t){var e=this._trs;this._parent?this._parent._invTransformPoint(E,t):i.Vec3.copy(E,t),i.Trs.fromPosition(e,E),this.setLocalDirty(U.ALL_POSITION),1&this._eventMask&&this.emit(H.POSITION_CHANGED)},getWorldRotation:function(t){i.Trs.toRotation(N,this._trs),i.Quat.copy(t,N);for(var e=this._parent;e;)i.Trs.toRotation(N,e._trs),i.Quat.mul(t,N,t),e=e._parent;return t},setWorldRotation:function(t){this._parent?(this._parent.getWorldRotation(F),i.Quat.conjugate(F,F),i.Quat.mul(F,F,t)):i.Quat.copy(F,t),i.Trs.fromRotation(this._trs,F),this.setLocalDirty(U.ALL_ROTATION)},getWorldScale:function(t){i.Trs.toScale(A,this._trs),i.Vec3.copy(t,A);for(var e=this._parent;e;)i.Trs.toScale(A,e._trs),i.Vec3.mul(t,t,A),e=e._parent;return t},setWorldScale:function(t){this._parent?(this._parent.getWorldScale(C),i.Vec3.div(C,t,C)):i.Vec3.copy(C,t),i.Trs.fromScale(this._trs,C),this.setLocalDirty(U.ALL_SCALE)},getWorldRT:function(t){var e=x,n=w,r=this._trs;i.Trs.toPosition(e,r),i.Trs.toRotation(n,r);for(var a=this._parent;a;)r=a._trs,i.Trs.toScale(S,r),i.Vec3.mul(e,e,S),i.Trs.toRotation(M,r),i.Vec3.transformQuat(e,e,M),i.Trs.toPosition(S,r),i.Vec3.add(e,e,S),i.Quat.mul(n,M,n),a=a._parent;return i.Mat4.fromRT(t,n,e),t},lookAt:function(t,e){this.getWorldPosition(R),i.Vec3.sub(R,R,t),i.Vec3.normalize(R,R),i.Quat.fromViewUp(I,R,e),this.setWorldRotation(I)},_updateLocalMatrix:ct,_calculWorldMatrix:function(){this._localMatDirty&U.TRSS&&this._updateLocalMatrix();var t=this._parent;t?this._mulMat(this._worldMatrix,t._worldMatrix,this._matrix):i.Mat4.copy(this._worldMatrix,this._matrix),this._worldMatDirty=!1},_mulMat:ht,_updateWorldMatrix:function(){if(this._parent&&this._parent._updateWorldMatrix(),this._worldMatDirty){this._calculWorldMatrix();for(var t=this._children,e=0,i=t.length;e<i;e++)t[e]._worldMatDirty=!0}},setLocalDirty:function(t){this._localMatDirty|=t,this._worldMatDirty=!0,t===U.ALL_POSITION||t===U.POSITION?this._renderFlag|=h.FLAG_WORLD_TRANSFORM:this._renderFlag|=h.FLAG_TRANSFORM},setWorldDirty:function(){this._worldMatDirty=!0},getLocalMatrix:function(t){return this._updateLocalMatrix(),i.Mat4.copy(t,this._matrix)},getWorldMatrix:function(t){return this._updateWorldMatrix(),i.Mat4.copy(t,this._worldMatrix)},convertToNodeSpaceAR:function(t,e){return this._updateWorldMatrix(),i.Mat4.invert(B,this._worldMatrix),t instanceof cc.Vec2?(e=e||new cc.Vec2,i.Vec2.transformMat4(e,t,B)):(e=e||new cc.Vec3,i.Vec3.transformMat4(e,t,B))},convertToWorldSpaceAR:function(t,e){return this._updateWorldMatrix(),t instanceof cc.Vec2?(e=e||new cc.Vec2,i.Vec2.transformMat4(e,t,this._worldMatrix)):(e=e||new cc.Vec3,i.Vec3.transformMat4(e,t,this._worldMatrix))},convertToNodeSpace:function(t){this._updateWorldMatrix(),i.Mat4.invert(B,this._worldMatrix);var e=new cc.Vec2;return i.Vec2.transformMat4(e,t,B),e.x+=this._anchorPoint.x*this._contentSize.width,e.y+=this._anchorPoint.y*this._contentSize.height,e},convertToWorldSpace:function(t){this._updateWorldMatrix();var e=new cc.Vec2(t.x-this._anchorPoint.x*this._contentSize.width,t.y-this._anchorPoint.y*this._contentSize.height);return i.Vec2.transformMat4(e,e,this._worldMatrix)},getNodeToParentTransform:function(t){t||(t=s.identity()),this._updateLocalMatrix();var e=this._contentSize;return k.x=-this._anchorPoint.x*e.width,k.y=-this._anchorPoint.y*e.height,i.Mat4.copy(B,this._matrix),i.Mat4.transform(B,B,k),s.fromMat4(t,B)},getNodeToParentTransformAR:function(t){return t||(t=s.identity()),this._updateLocalMatrix(),s.fromMat4(t,this._matrix)},getNodeToWorldTransform:function(t){t||(t=s.identity()),this._updateWorldMatrix();var e=this._contentSize;return k.x=-this._anchorPoint.x*e.width,k.y=-this._anchorPoint.y*e.height,i.Mat4.copy(B,this._worldMatrix),i.Mat4.transform(B,B,k),s.fromMat4(t,B)},getNodeToWorldTransformAR:function(t){return t||(t=s.identity()),this._updateWorldMatrix(),s.fromMat4(t,this._worldMatrix)},getParentToNodeTransform:function(t){return t||(t=s.identity()),this._updateLocalMatrix(),i.Mat4.invert(B,this._matrix),s.fromMat4(t,B)},getWorldToNodeTransform:function(t){return t||(t=s.identity()),this._updateWorldMatrix(),i.Mat4.invert(B,this._worldMatrix),s.fromMat4(t,B)},convertTouchToNodeSpace:function(t){return this.convertToNodeSpace(t.getLocation())},convertTouchToNodeSpaceAR:function(t){return this.convertToNodeSpaceAR(t.getLocation())},getBoundingBox:function(){this._updateLocalMatrix();var t=this._contentSize.width,e=this._contentSize.height,i=cc.rect(-this._anchorPoint.x*t,-this._anchorPoint.y*e,t,e);return i.transformMat4(i,this._matrix)},getBoundingBoxToWorld:function(){return this._parent?(this._parent._updateWorldMatrix(),this._getBoundingBoxTo()):this.getBoundingBox()},_getBoundingBoxTo:function(){var t=this._contentSize.width,e=this._contentSize.height,i=cc.rect(-this._anchorPoint.x*t,-this._anchorPoint.y*e,t,e);if(this._calculWorldMatrix(),i.transformMat4(i,this._worldMatrix),!this._children)return i;for(var n=this._children,r=0;r<n.length;r++){var a=n[r];if(a&&a.active){var s=a._getBoundingBoxTo();s&&i.union(i,s)}}return i},_updateOrderOfArrival:function(){var t=this._parent?++this._parent._childArrivalOrder:0;this._localZOrder=4294901760&this._localZOrder|t,this.emit(H.SIBLING_ORDER_CHANGED)},addChild:function(t,e,i){cc.assertID(t,1606),cc.assertID(null===t._parent,1605),t.parent=this,void 0!==e&&(t.zIndex=e),void 0!==i&&(t.name=i)},cleanup:function(){_&&cc.director.getActionManager().removeAllActionsFromTarget(this),o.removeListeners(this);var t,e,i=this._children.length;for(t=0;t<i;++t)(e=this._children[t])&&e.cleanup()},sortAllChildren:function(){if(this._reorderChildDirty){this._reorderChildDirty=!1;var t=this._children;this._childArrivalOrder=1;for(var e=0,i=t.length;e<i;e++)t[e]._updateOrderOfArrival();if(o._setDirtyForNode(this),t.length>1){for(var n,r,a=1,s=t.length;a<s;a++){n=t[a];for(var c=a;c>0&&(r=t[c-1])._localZOrder>n._localZOrder;c--)t[c]=r;t[c]=n}this.emit(H.CHILD_REORDER,this)}cc.director.__fastOff(cc.Director.EVENT_AFTER_UPDATE,this.sortAllChildren,this)}},_delaySort:function(){this._reorderChildDirty||(this._reorderChildDirty=!0,cc.director.__fastOn(cc.Director.EVENT_AFTER_UPDATE,this.sortAllChildren,this))},_restoreProperties:!1,onRestore:!1},_t=cc.Class(dt),pt=_t.prototype;l.getset(pt,"position",pt.getPosition,pt.setPosition,!1,!0),cc.Node=e.exports=_t}),{"./event-manager":164,"./event/event":167,"./event/event-target":166,"./platform/CCMacro":198,"./platform/js":214,"./renderer/render-flow":226,"./utils/affine-transform":269,"./utils/base-node":270,"./utils/prefab-helper":281,"./utils/trans-pool":287,"./value-types":293}],61:[(function(t,e){"use strict";var i=t("./CCNode"),n=t("./renderer/render-flow"),r=(cc.Object.Flags.HideInHierarchy,i._LocalDirtyFlag),a=cc.Class({name:"cc.PrivateNode",extends:i,properties:{x:{get:function(){return this._originPos.x},set:function(t){var e=this._originPos;t!==e.x&&(e.x=t,this._posDirty(!0))},override:!0},y:{get:function(){return this._originPos.y},set:function(t){var e=this._originPos;t!==e.y&&(e.y=t,this._posDirty(!0))},override:!0},zIndex:{get:function(){return cc.macro.MIN_ZINDEX},set:function(){},override:!0},showInEditor:{default:!1,editorOnly:!0,override:!0}},ctor:function(){this._localZOrder=cc.macro.MIN_ZINDEX<<16,this._originPos=cc.v2()},_posDirty:function(t){this.setLocalDirty(r.POSITION),this._renderFlag|=n.FLAG_TRANSFORM,!0===t&&1&this._eventMask&&this.emit(i.EventType.POSITION_CHANGED)},_updateLocalMatrix:function(){if(this._localMatDirty){var t=this.parent;t&&(this._trs[0]=this._originPos.x-(t._anchorPoint.x-.5)*t._contentSize.width,this._trs[1]=this._originPos.y-(t._anchorPoint.y-.5)*t._contentSize.height),this._super()}},getPosition:function(){return new cc.Vec2(this._originPos)},setPosition:function(t,e){void 0===e&&(e=(t=t.x).y);var i=this._originPos;i.x===t&&i.y===e||(i.x=t,i.y=e,this._posDirty(!0))},setParent:function(t){var e=this._parent;this._super(t),e!==t&&(e&&e.off(i.EventType.ANCHOR_CHANGED,this._posDirty,this),t&&t.on(i.EventType.ANCHOR_CHANGED,this._posDirty,this))},_updateOrderOfArrival:function(){}}),s=a.prototype;cc.js.getset(s,"parent",s.getParent,s.setParent),cc.js.getset(s,"position",s.getPosition,s.setPosition),cc.PrivateNode=e.exports=a}),{"./CCNode":60,"./renderer/render-flow":226}],62:[(function(t,e){"use strict";cc.Scene=cc.Class({name:"cc.Scene",extends:t("./CCNode"),properties:{_is3DNode:{default:!0,override:!0},autoReleaseAssets:!1},ctor:function(){this._anchorPoint.x=0,this._anchorPoint.y=0,this._activeInHierarchy=!1,this._inited=!cc.game._isCloning,this.dependAssets=null},destroy:function(){if(cc.Object.prototype.destroy.call(this))for(var t=this._children,e=0;e<t.length;++e)t[e].active=!1;this._active=!1,this._activeInHierarchy=!1},_onHierarchyChanged:function(){},_instantiate:null,_load:function(){this._inited||(this._onBatchCreated(!1),this._inited=!0)},_activate:function(t){t=!1!==t,cc.director._nodeActivator.activateNode(this,t)}}),e.exports=cc.Scene}),{"./CCNode":60}],63:[(function(t,e){"use strict";var i=t("./platform/js"),n=new(t("./platform/id-generater"))("Scheduler"),r=function(t,e,i,n){this.target=t,this.priority=e,this.paused=i,this.markedForDeletion=n},a=[];r.get=function(t,e,i,n){var s=a.pop();return s?(s.target=t,s.priority=e,s.paused=i,s.markedForDeletion=n):s=new r(t,e,i,n),s},r.put=function(t){a.length<20&&(t.target=null,a.push(t))};var s=function(t,e,i,n){this.list=t,this.entry=e,this.target=i,this.callback=n},o=[];s.get=function(t,e,i,n){var r=o.pop();return r?(r.list=t,r.entry=e,r.target=i,r.callback=n):r=new s(t,e,i,n),r},s.put=function(t){o.length<20&&(t.list=t.entry=t.target=t.callback=null,o.push(t))};var c=function(t,e,i,n,r,a){var s=this;s.timers=t,s.target=e,s.timerIndex=i,s.currentTimer=n,s.currentTimerSalvaged=r,s.paused=a},l=[];function u(){this._lock=!1,this._scheduler=null,this._elapsed=-1,this._runForever=!1,this._useDelay=!1,this._timesExecuted=0,this._repeat=0,this._delay=0,this._interval=0,this._target=null,this._callback=null}c.get=function(t,e,i,n,r,a){var s=l.pop();return s?(s.timers=t,s.target=e,s.timerIndex=i,s.currentTimer=n,s.currentTimerSalvaged=r,s.paused=a):s=new c(t,e,i,n,r,a),s},c.put=function(t){l.length<20&&(t.timers=t.target=t.currentTimer=null,l.push(t))};var h=u.prototype;h.initWithCallback=function(t,e,i,n,r,a){return this._lock=!1,this._scheduler=t,this._target=i,this._callback=e,this._elapsed=-1,this._interval=n,this._delay=a,this._useDelay=this._delay>0,this._repeat=r,this._runForever=this._repeat===cc.macro.REPEAT_FOREVER,!0},h.getInterval=function(){return this._interval},h.setInterval=function(t){this._interval=t},h.update=function(t){-1===this._elapsed?(this._elapsed=0,this._timesExecuted=0):(this._elapsed+=t,this._runForever&&!this._useDelay?this._elapsed>=this._interval&&(this.trigger(),this._elapsed=0):(this._useDelay?this._elapsed>=this._delay&&(this.trigger(),this._elapsed-=this._delay,this._timesExecuted+=1,this._useDelay=!1):this._elapsed>=this._interval&&(this.trigger(),this._elapsed=0,this._timesExecuted+=1),this._callback&&!this._runForever&&this._timesExecuted>this._repeat&&this.cancel()))},h.getCallback=function(){return this._callback},h.trigger=function(){this._target&&this._callback&&(this._lock=!0,this._callback.call(this._target,this._elapsed),this._lock=!1)},h.cancel=function(){this._scheduler.unschedule(this._callback,this._target)};var f=[];u.get=function(){return f.pop()||new u},u.put=function(t){f.length<20&&!t._lock&&(t._scheduler=t._target=t._callback=null,f.push(t))},cc.Scheduler=function(){this._timeScale=1,this._updatesNegList=[],this._updates0List=[],this._updatesPosList=[],this._hashForUpdates=i.createMap(!0),this._hashForTimers=i.createMap(!0),this._currentTarget=null,this._currentTargetSalvaged=!1,this._updateHashLocked=!1,this._arrayForTimers=[]},cc.Scheduler.prototype={constructor:cc.Scheduler,_removeHashElement:function(t){delete this._hashForTimers[t.target._id];for(var e=this._arrayForTimers,i=0,n=e.length;i<n;i++)if(e[i]===t){e.splice(i,1);break}c.put(t)},_removeUpdateFromHash:function(t){var e=t.target._id,i=this._hashForUpdates[e];if(i){for(var n=i.list,a=i.entry,o=0,c=n.length;o<c;o++)if(n[o]===a){n.splice(o,1);break}delete this._hashForUpdates[e],r.put(a),s.put(i)}},_priorityIn:function(t,e,i){for(var n=0;n<t.length;n++)if(i<t[n].priority)return void t.splice(n,0,e);t.push(e)},_appendIn:function(t,e){t.push(e)},enableForTarget:function(t){t._id||(t.__instanceId?cc.warnID(1513):t._id=n.getNewId())},setTimeScale:function(t){this._timeScale=t},getTimeScale:function(){return this._timeScale},update:function(t){var e,i,n,r;for(this._updateHashLocked=!0,1!==this._timeScale&&(t*=this._timeScale),e=0,n=(i=this._updatesNegList).length;e<n;e++)(r=i[e]).paused||r.markedForDeletion||r.target.update(t);for(e=0,n=(i=this._updates0List).length;e<n;e++)(r=i[e]).paused||r.markedForDeletion||r.target.update(t);for(e=0,n=(i=this._updatesPosList).length;e<n;e++)(r=i[e]).paused||r.markedForDeletion||r.target.update(t);var a,s=this._arrayForTimers;for(e=0;e<s.length;e++){if(a=s[e],this._currentTarget=a,this._currentTargetSalvaged=!1,!a.paused)for(a.timerIndex=0;a.timerIndex<a.timers.length;++a.timerIndex)a.currentTimer=a.timers[a.timerIndex],a.currentTimerSalvaged=!1,a.currentTimer.update(t),a.currentTimer=null;this._currentTargetSalvaged&&0===this._currentTarget.timers.length&&(this._removeHashElement(this._currentTarget),--e)}for(e=0,i=this._updatesNegList;e<i.length;)(r=i[e]).markedForDeletion?this._removeUpdateFromHash(r):e++;for(e=0,i=this._updates0List;e<i.length;)(r=i[e]).markedForDeletion?this._removeUpdateFromHash(r):e++;for(e=0,i=this._updatesPosList;e<i.length;)(r=i[e]).markedForDeletion?this._removeUpdateFromHash(r):e++;this._updateHashLocked=!1,this._currentTarget=null},schedule:function(t,e,i,n,r,a){if("function"!=typeof t){var s=t;t=e,e=s}4!==arguments.length&&5!==arguments.length||(a=!!n,n=cc.macro.REPEAT_FOREVER,r=0),cc.assertID(e,1502);var o=e._id;o||(e.__instanceId?(cc.warnID(1513),o=e._id=e.__instanceId):cc.errorID(1510));var l,h,f=this._hashForTimers[o];if(f?f.paused!==a&&cc.warnID(1511):(f=c.get(null,e,0,null,null,a),this._arrayForTimers.push(f),this._hashForTimers[o]=f),null==f.timers)f.timers=[];else for(h=0;h<f.timers.length;++h)if((l=f.timers[h])&&t===l._callback)return cc.logID(1507,l.getInterval(),i),void(l._interval=i);(l=u.get()).initWithCallback(this,t,e,i,n,r),f.timers.push(l),this._currentTarget===f&&this._currentTargetSalvaged&&(this._currentTargetSalvaged=!1)},scheduleUpdate:function(t,e,i){var n=t._id;n||(t.__instanceId?(cc.warnID(1513),n=t._id=t.__instanceId):cc.errorID(1510));var a=this._hashForUpdates[n];if(a&&a.entry){if(a.entry.priority===e)return a.entry.markedForDeletion=!1,void(a.entry.paused=i);if(this._updateHashLocked)return cc.logID(1506),a.entry.markedForDeletion=!1,void(a.entry.paused=i);this.unscheduleUpdate(t)}var o,c=r.get(t,e,i,!1);0===e?(o=this._updates0List,this._appendIn(o,c)):(o=e<0?this._updatesNegList:this._updatesPosList,this._priorityIn(o,c,e)),this._hashForUpdates[n]=s.get(o,c,t,null)},unschedule:function(t,e){if(e&&t){var i=e._id;i||(e.__instanceId?(cc.warnID(1513),i=e._id=e.__instanceId):cc.errorID(1510));var n=this._hashForTimers[i];if(n)for(var r=n.timers,a=0,s=r.length;a<s;a++){var o=r[a];if(t===o._callback)return o!==n.currentTimer||n.currentTimerSalvaged||(n.currentTimerSalvaged=!0),r.splice(a,1),u.put(o),n.timerIndex>=a&&n.timerIndex--,void(0===r.length&&(this._currentTarget===n?this._currentTargetSalvaged=!0:this._removeHashElement(n)))}}},unscheduleUpdate:function(t){if(t){var e=t._id;e||(t.__instanceId?(cc.warnID(1513),e=t._id=t.__instanceId):cc.errorID(1510));var i=this._hashForUpdates[e];i&&(this._updateHashLocked?i.entry.markedForDeletion=!0:this._removeUpdateFromHash(i.entry))}},unscheduleAllForTarget:function(t){if(t){var e=t._id;e||(t.__instanceId?(cc.warnID(1513),e=t._id=t.__instanceId):cc.errorID(1510));var i=this._hashForTimers[e];if(i){var n=i.timers;n.indexOf(i.currentTimer)>-1&&!i.currentTimerSalvaged&&(i.currentTimerSalvaged=!0);for(var r=0,a=n.length;r<a;r++)u.put(n[r]);n.length=0,this._currentTarget===i?this._currentTargetSalvaged=!0:this._removeHashElement(i)}this.unscheduleUpdate(t)}},unscheduleAll:function(){this.unscheduleAllWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)},unscheduleAllWithMinPriority:function(t){var e,i,n,r=this._arrayForTimers;for(e=r.length-1;e>=0;e--)i=r[e],this.unscheduleAllForTarget(i.target);var a=0;if(t<0)for(e=0;e<this._updatesNegList.length;)a=this._updatesNegList.length,(n=this._updatesNegList[e])&&n.priority>=t&&this.unscheduleUpdate(n.target),a==this._updatesNegList.length&&e++;if(t<=0)for(e=0;e<this._updates0List.length;)a=this._updates0List.length,(n=this._updates0List[e])&&this.unscheduleUpdate(n.target),a==this._updates0List.length&&e++;for(e=0;e<this._updatesPosList.length;)a=this._updatesPosList.length,(n=this._updatesPosList[e])&&n.priority>=t&&this.unscheduleUpdate(n.target),a==this._updatesPosList.length&&e++},isScheduled:function(t,e){cc.assertID(t,1508),cc.assertID(e,1509);var i=e._id;i||(e.__instanceId?(cc.warnID(1513),i=e._id=e.__instanceId):cc.errorID(1510));var n=this._hashForTimers[i];if(!n)return!1;if(null==n.timers)return!1;for(var r=n.timers,a=0;a<r.length;++a)if(t===r[a]._callback)return!0;return!1},pauseAllTargets:function(){return this.pauseAllTargetsWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)},pauseAllTargetsWithMinPriority:function(t){var e,i,n,r,a=[],s=this._arrayForTimers;for(i=0,n=s.length;i<n;i++)(e=s[i])&&(e.paused=!0,a.push(e.target));if(t<0)for(i=0;i<this._updatesNegList.length;i++)(r=this._updatesNegList[i])&&r.priority>=t&&(r.paused=!0,a.push(r.target));if(t<=0)for(i=0;i<this._updates0List.length;i++)(r=this._updates0List[i])&&(r.paused=!0,a.push(r.target));for(i=0;i<this._updatesPosList.length;i++)(r=this._updatesPosList[i])&&r.priority>=t&&(r.paused=!0,a.push(r.target));return a},resumeTargets:function(t){if(t)for(var e=0;e<t.length;e++)this.resumeTarget(t[e])},pauseTarget:function(t){cc.assertID(t,1503);var e=t._id;e||(t.__instanceId?(cc.warnID(1513),e=t._id=t.__instanceId):cc.errorID(1510));var i=this._hashForTimers[e];i&&(i.paused=!0);var n=this._hashForUpdates[e];n&&(n.entry.paused=!0)},resumeTarget:function(t){cc.assertID(t,1504);var e=t._id;e||(t.__instanceId?(cc.warnID(1513),e=t._id=t.__instanceId):cc.errorID(1510));var i=this._hashForTimers[e];i&&(i.paused=!1);var n=this._hashForUpdates[e];n&&(n.entry.paused=!1)},isTargetPaused:function(t){cc.assertID(t,1505);var e=t._id;e||(t.__instanceId?(cc.warnID(1513),e=t._id=t.__instanceId):cc.errorID(1510));var i=this._hashForTimers[e];if(i)return i.paused;var n=this._hashForUpdates[e];return!!n&&n.entry.paused}},cc.Scheduler.PRIORITY_SYSTEM=1<<31,cc.Scheduler.PRIORITY_NON_SYSTEM=cc.Scheduler.PRIORITY_SYSTEM+1,e.exports=cc.Scheduler}),{"./platform/id-generater":210,"./platform/js":214}],64:[(function(t,e){"use strict";var i=t("./preprocess"),n=t("./fetch"),r=t("./cache"),a=t("./helper"),s=t("./releaseManager"),o=t("./depend-util"),c=t("./load"),l=t("./pipeline"),u=t("./task"),h=t("./request-item"),f=t("./downloader"),d=t("./parser"),_=t("./pack-manager"),p=t("./bundle"),m=t("./builtins"),v=t("./factory"),g=t("./urlTransformer"),y=g.parse,T=g.combine,b=t("./utilities"),E=b.parseParameters,A=b.asyncify,C=t("./shared"),x=C.assets,S=C.files,w=C.parsed,M=C.pipeline,R=C.transformPipeline,I=C.fetchPipeline,O=C.RequestType,D=C.bundles,P=C.BuiltinBundleName;function L(){this._preprocessPipe=i,this._fetchPipe=n,this._loadPipe=c,this.pipeline=M.append(i).append(c),this.fetchPipeline=I.append(i).append(n),this.transformPipeline=R.append(y).append(T),this.bundles=D,this.assets=x,this._files=S,this._parsed=w,this.generalImportBase="",this.generalNativeBase="",this.dependUtil=o,this._releaseManager=s,this.cacheAsset=!0,this.force=!1,this.utils=a,this.downloader=f,this.parser=d,this.builtins=m,this.packManager=_,this.factory=v,this.cacheManager=null,this.presets={default:{priority:0},preload:{maxConcurrency:2,maxRequestsPerFrame:2,priority:-1},scene:{maxConcurrency:8,maxRequestsPerFrame:8,priority:1},bundle:{maxConcurrency:8,maxRequestsPerFrame:8,priority:2},remote:{maxRetryCount:4},script:{maxConcurrency:1024,maxRequestsPerFrame:1024,priority:2}}}L.Pipeline=l,L.Task=u,L.Cache=r,L.RequestItem=h,L.Bundle=p,L.BuiltinBundleName=P,L.prototype={constructor:L,get main(){return D.get(P.MAIN)},get resources(){return D.get(P.RESOURCES)},get internal(){return D.get(P.INTERNAL)},init:function(t){t=t||Object.create(null),this._files.clear(),this._parsed.clear(),this._releaseManager.init(),this.assets.clear(),this.bundles.clear(),this.packManager.init(),this.downloader.init(t.bundleVers,t.server),this.parser.init(),this.dependUtil.init(),this.generalImportBase=t.importBase,this.generalNativeBase=t.nativeBase},getBundle:function(t){return D.get(t)},removeBundle:function(t){t._destroy(),D.remove(t.name)},loadAny:function(t,e,i,n){var r=E(e,i,n);e=r.options,i=r.onProgress,n=r.onComplete,e.preset=e.preset||"default",t=Array.isArray(t)?t.concat():t;var a=new u({input:t,onProgress:i,onComplete:A(n),options:e});M.async(a)},preloadAny:function(t,e,i,n){var r=E(e,i,n);e=r.options,i=r.onProgress,n=r.onComplete,e.preset=e.preset||"preload",t=Array.isArray(t)?t.concat():t;var a=new u({input:t,onProgress:i,onComplete:A(n),options:e});I.async(a)},postLoadNative:function(t,e,i){if(!(t instanceof cc.Asset))throw new Error("input is not asset");var n=E(e,void 0,i);if(e=n.options,i=n.onComplete,!t._native||t._nativeAsset)return A(i)(null);var r=o.getNativeDep(t._uuid);if(r){if(!D.has(r.bundle)){var a=D.find((function(e){return e.getAssetInfo(t._uuid)}));a&&(r.bundle=a.name)}this.loadAny(r,e,(function(e,n){e?cc.error(e.message,e.stack):!t._nativeAsset&&(t._nativeAsset=n),i&&i(e)}))}},loadRemote:function(t,e,i){var n=E(e,void 0,i);if(e=n.options,i=n.onComplete,this.assets.has(t))return A(i)(null,this.assets.get(t));e.__isNative__=!0,e.preset=e.preset||"remote",this.loadAny({url:t},e,null,(function(n,r){n?(cc.error(n.message,n.stack),i&&i(n,null)):v.create(t,r,e.ext||cc.path.extname(t),e,(function(t,e){i&&i(t,e)}))}))},loadScript:function(t,e,i){var n=E(e,void 0,i);e=n.options,i=n.onComplete,e.__requestType__=O.URL,e.preset=e.preset||"script",this.loadAny(t,e,i)},loadBundle:function(t,e,i){var n=E(e,void 0,i),r=(e=n.options,i=n.onComplete,cc.path.basename(t));if(this.bundles.has(r))return A(i)(null,this.getBundle(r));e.preset=e.preset||"bundle",e.ext="bundle",this.loadRemote(t,e,i)},releaseAsset:function(t){s.tryRelease(t,!0)},releaseUnusedAssets:function(){x.forEach((function(t){s.tryRelease(t)}))},releaseAll:function(){x.forEach((function(t){s.tryRelease(t,!0)}))},_transform:function(t,e){var i=u.create({input:t,options:e}),n=[];try{for(var r=R.sync(i),a=0,s=r.length;a<s;a++){var o=r[a],c=o.url;o.recycle(),n.push(c)}}catch(l){for(a=0,s=i.output.length;a<s;a++)i.output[a].recycle();cc.error(l.message,l.stack)}return i.recycle(),n.length>1?n:n[0]}},cc.AssetManager=L,cc.assetManager=new L,Object.defineProperty(cc,"resources",{get:function(){return D.get(P.RESOURCES)}}),e.exports=cc.assetManager}),{"./builtins":65,"./bundle":66,"./cache":67,"./depend-util":69,"./downloader":76,"./factory":77,"./fetch":78,"./helper":80,"./load":82,"./pack-manager":83,"./parser":84,"./pipeline":85,"./preprocess":86,"./releaseManager":87,"./request-item":88,"./shared":89,"./task":90,"./urlTransformer":91,"./utilities":92}],65:[(function(t,e){"use strict";var i=t("./cache"),n=t("./releaseManager"),r=t("./shared").BuiltinBundleName,a={_assets:new i({material:new i,effect:new i}),_loadBuiltins:function(t,e){var i=t+"s",n=this._assets.get(t);return cc.assetManager.internal.loadDir(i,null,null,(function(t,i){if(t)cc.error(t.message,t.stack);else for(var r=0;r<i.length;r++){var a=i[r];n.add(a.name,a.addRef())}e()}))},init:function(t){var e=this;if(this.clear(),cc.game.renderType===cc.game.RENDER_TYPE_CANVAS||!cc.assetManager.bundles.has(r.INTERNAL))return t&&t();this._loadBuiltins("effect",(function(){e._loadBuiltins("material",t)}))},getBuiltin:function(t,e){return 0===arguments.length?this._assets:1===arguments.length?this._assets.get(t):this._assets.get(t).get(e)},clear:function(){this._assets.forEach((function(t){t.forEach((function(t){n.tryRelease(t,!0)})),t.clear()}))}};e.exports=a}),{"./cache":67,"./releaseManager":87,"./shared":89}],66:[(function(t,e){"use strict";var i=t("./config"),n=t("./releaseManager"),r=t("./utilities"),a=r.parseParameters,s=r.parseLoadResArgs,o=t("./shared"),c=o.RequestType,l=o.assets,u=o.bundles;function h(){this._config=new i}h.prototype={constructor:h,get name(){return this._config.name},get deps(){return this._config.deps},get base(){return this._config.base},getInfoWithPath:function(t,e){return this._config.getInfoWithPath(t,e)},getDirWithPath:function(t,e,i){return this._config.getDirWithPath(t,e,i)},getAssetInfo:function(t){return this._config.getAssetInfo(t)},getSceneInfo:function(t){return this._config.getSceneInfo(t)},init:function(t){this._config.init(t),u.add(t.name,this)},load:function(t,e,i,n){var r=s(e,i,n);e=r.type,i=r.onProgress,n=r.onComplete,cc.assetManager.loadAny(t,{__requestType__:c.PATH,type:e,bundle:this.name,__outputAsArray__:Array.isArray(t)},i,n)},preload:function(t,e,i,n){var r=s(e,i,n);e=r.type,i=r.onProgress,n=r.onComplete,cc.assetManager.preloadAny(t,{__requestType__:c.PATH,type:e,bundle:this.name},i,n)},loadDir:function(t,e,i,n){var r=s(e,i,n);e=r.type,i=r.onProgress,n=r.onComplete,cc.assetManager.loadAny(t,{__requestType__:c.DIR,type:e,bundle:this.name,__outputAsArray__:!0},i,n)},preloadDir:function(t,e,i,n){var r=s(e,i,n);e=r.type,i=r.onProgress,n=r.onComplete,cc.assetManager.preloadAny(t,{__requestType__:c.DIR,type:e,bundle:this.name},i,n)},loadScene:function(t,e,i,n){var r=a(e,i,n);e=r.options,i=r.onProgress,n=r.onComplete,e.preset=e.preset||"scene",e.bundle=this.name,cc.assetManager.loadAny({scene:t},e,i,(function(t,e){if(t)cc.error(t.message,t.stack),n&&n(t);else if(e instanceof cc.SceneAsset){var i=e.scene;i._id=e._uuid,i._name=e._name,n&&n(null,e)}else n&&n(new Error("The asset "+e._uuid+" is not a scene"))}))},preloadScene:function(t,e,i,n){var r=a(e,i,n);e=r.options,i=r.onProgress,n=r.onComplete,e.bundle=this.name,cc.assetManager.preloadAny({scene:t},e,i,(function(e){e&&cc.errorID(1210,t,e.message),n&&n(e)}))},get:function(t,e){var i=this.getInfoWithPath(t,e);return l.get(i&&i.uuid)},release:function(t,e){n.tryRelease(this.get(t,e),!0)},releaseUnusedAssets:function(){var t=this;l.forEach((function(e){var i=t.getAssetInfo(e._uuid);i&&!i.redirect&&n.tryRelease(e)}))},releaseAll:function(){var t=this;l.forEach((function(e){var i=t.getAssetInfo(e._uuid);i&&!i.redirect&&n.tryRelease(e,!0)}))},_destroy:function(){this._config.destroy()}},e.exports=h}),{"./config":68,"./releaseManager":87,"./shared":89,"./utilities":92}],67:[(function(t,e){"use strict";var i=t("../platform/js");function n(t){t?(this._map=t,this._count=Object.keys(t).length):(this._map=i.createMap(!0),this._count=0)}n.prototype={constructor:n,add:function(t,e){return t in this._map||this._count++,this._map[t]=e},get:function(t){return this._map[t]},has:function(t){return t in this._map},remove:function(t){var e=this._map[t];return t in this._map&&(delete this._map[t],this._count--),e},clear:function(){0!==this._count&&(this._map=i.createMap(!0),this._count=0)},forEach:function(t){for(var e in this._map)t(this._map[e],e)},find:function(t){for(var e in this._map)if(t(this._map[e],e))return this._map[e];return null},get count(){return this._count},destroy:function(){this._map=null}},e.exports=n}),{"../platform/js":214}],68:[(function(t,e){"use strict";var i=t("../platform/js"),n=t("./cache"),r=t("./helper").normalize,a=t("./utilities").processOptions;function s(){this.name="",this.base="",this.importBase="",this.nativeBase="",this.deps=null,this.assetInfos=new n,this.scenes=new n,this.paths=new n}s.prototype={constructor:s,init:function(t){a(t),this.importBase=t.importBase||"",this.nativeBase=t.nativeBase||"",this.base=t.base||"",this.name=t.name||"",this.deps=t.deps||[],this._initUuid(t.uuids),this._initPath(t.paths),this._initScene(t.scenes),this._initPackage(t.packs),this._initVersion(t.versions),this._initRedirect(t.redirect)},_initUuid:function(t){if(t){this.assetInfos.clear();for(var e=0,i=t.length;e<i;e++){var n=t[e];this.assetInfos.add(n,{uuid:n})}}},_initPath:function(t){if(t){var e=this.paths;for(var n in e.clear(),t){var r=t[n],a=r[0],s=r[1],o=3===r.length,c=this.assetInfos.get(n);c.path=a,c.ctor=i._getClassById(s),e.has(a)?o?e.get(a).push(c):e.get(a).splice(0,0,c):e.add(a,[c])}}},_initScene:function(t){if(t){var e=this.scenes;e.clear();var i=this.assetInfos;for(var n in t){var r=t[n],a=i.get(r);a.url=n,e.add(n,a)}}},_initPackage:function(t){if(t){var e=this.assetInfos;for(var i in t){var n=t[i],r={uuid:i,packs:n,ext:".json"};e.add(i,r);for(var a=0,s=n.length;a<s;a++){var o=n[a],c=e.get(o),l=c.packs;l?1===s?l.splice(0,0,r):l.push(r):c.packs=[r]}}}},_initVersion:function(t){if(t){var e=this.assetInfos,i=t.import;if(i)for(var n=0,r=i.length;n<r;n+=2){var a=i[n];e.get(a).ver=i[n+1]}if(i=t.native)for(n=0,r=i.length;n<r;n+=2)a=i[n],e.get(a).nativeVer=i[n+1]}},_initRedirect:function(t){if(t)for(var e=this.assetInfos,i=0,n=t.length;i<n;i+=2){var r=t[i];e.get(r).redirect=t[i+1]}},getInfoWithPath:function(t,e){if(!t)return null;t=r(t);var n=this.paths.get(t);if(n){if(!e)return n[0];for(var a=0,s=n.length;a<s;a++){var o=n[a];if(i.isChildClassOf(o.ctor,e))return o}}return null},getDirWithPath:function(t,e,n){"/"===(t=r(t))[t.length-1]&&(t=t.slice(0,-1));var a=n||[];function s(t,e){return!(t.length>e.length)||47===t.charCodeAt(e.length)}return this.paths.forEach((function(n,r){if(r.startsWith(t)&&s(r,t)||!t)for(var o=0,c=n.length;o<c;o++){var l=n[o];e&&!i.isChildClassOf(l.ctor,e)||a.push(l)}})),a},getAssetInfo:function(t){return this.assetInfos.get(t)},getSceneInfo:function(t){return t.endsWith(".fire")||(t+=".fire"),"/"===t[0]||t.startsWith("db://")||(t="/"+t),this.scenes.find((function(e,i){return i.endsWith(t)}))},destroy:function(){this.paths.destroy(),this.scenes.destroy(),this.assetInfos.destroy()}},e.exports=s}),{"../platform/js":214,"./cache":67,"./helper":80,"./utilities":92}],69:[(function(t,e){"use strict";var i=(function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=n();if(e&&e.has(t))return e.get(t);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var s=r?Object.getOwnPropertyDescriptor(t,a):null;s&&(s.get||s.set)?Object.defineProperty(i,a,s):i[a]=t[a]}return i.default=t,e&&e.set(t,i),i})(t("../platform/deserialize-compiled"));function n(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return n=function(){return t},t}var r=t("./cache"),a=t("./deserialize"),s=t("./shared"),o=s.files,c=s.parsed,l={_depends:new r,init:function(){this._depends.clear()},getNativeDep:function(t){var e=this._depends.get(t);return e?e.nativeDep&&Object.assign({},e.nativeDep):null},getDeps:function(t){return this._depends.has(t)?this._depends.get(t).deps:[]},getDepsRecursively:function(t){var e=Object.create(null),i=[];return this._descend(t,e,i),i},_descend:function(t,e,i){for(var n=this.getDeps(t),r=0;r<n.length;r++){var a=n[r];e[a]||(e[a]=!0,i.push(a),this._descend(a,e,i))}},remove:function(t){this._depends.remove(t)},parse:function(t,e){var n=null;if(Array.isArray(e)||e.__type__){if(n=this._depends.get(t))return n;if(Array.isArray(e)&&!(0,i.hasNativeDep)(e))n={deps:this._parseDepsFromJson(e)};else try{var r=a(e);(n=this._parseDepsFromAsset(r)).nativeDep&&(n.nativeDep.uuid=t),c.add(t+"@import",r)}catch(s){o.remove(t+"@import"),n={deps:[]}}}else{if((n=this._depends.get(t))&&n.parsedFromExistAsset)return n;n=this._parseDepsFromAsset(e)}return this._depends.add(t,n),n},_parseDepsFromAsset:function(t){for(var e={deps:[],parsedFromExistAsset:!0,preventPreloadNativeObject:t.constructor.preventPreloadNativeObject,preventDeferredLoadDependents:t.constructor.preventDeferredLoadDependents},i=t.__depends__,n=0,r=i.length;n<r;n++){var a=i[n].uuid;e.deps.push(a)}return t.__nativeDepend__&&(e.nativeDep=t._nativeDep),e},_parseDepsFromJson:function(t){var e=(0,i.getDependUuidList)(t);return e.forEach((function(t,i){return e[i]=cc.assetManager.utils.decodeUuid(t)})),e}};e.exports=l}),{"../platform/deserialize-compiled":208,"./cache":67,"./deserialize":71,"./shared":89}],70:[(function(t){"use strict";var e=t("../platform/js");t("../CCDirector");var i=t("./utilities"),n=t("./depend-util"),r=t("./releaseManager"),a=t("./downloader"),s=t("./factory"),o=[".png",".jpg",".bmp",".jpeg",".gif",".ico",".tiff",".webp",".image",".pvr",".pkm"],c=[".mp3",".ogg",".wav",".m4a"];function l(){return!0}var u={transformURL:function(t){return t=t.replace(/.*[\/\\][0-9a-fA-F]{2}[\/\\]([0-9a-fA-F-]{8,})/,(function(e,i){var n=cc.assetManager.bundles.find((function(t){return t.getAssetInfo(i)})),r="";if(n){var a=n.getAssetInfo(i);r=t.startsWith(n.base+n._config.nativeBase)?a.nativeVer:a.ver}return r?e+"."+r:e}))}},h={onProgress:null,_autoReleaseSetting:Object.create(null),get _cache(){return cc.assetManager.assets._map},load:function(t,e,i){void 0===i&&void 0!==e&&(i=e,e=null),t=Array.isArray(t)?t:[t];for(var n=0;n<t.length;n++){var r=t[n];"string"==typeof r?t[n]={url:r,__isNative__:!0}:(r.type&&(r.ext="."+r.type,r.type=void 0),r.url&&(r.__isNative__=!0))}var a=[],u=[];cc.assetManager.loadAny(t,null,(function(t,i,n){n.content&&(o.includes(n.ext)?a.push(n.content):c.includes(n.ext)&&u.push(n.content)),e&&e(t,i,n)}),(function(e,n){var r=null;if(!e){n=Array.isArray(n)?n:[n];for(var o=0;o<n.length;o++){var c=n[o];if(!(c instanceof cc.Asset)){var h=c,f=t[o].url;a.includes(h)?s.create(f,c,".png",null,(function(t,e){h=n[o]=e})):u.includes(h)&&s.create(f,c,".mp3",null,(function(t,e){h=n[o]=e})),cc.assetManager.assets.add(f,h)}}if(n.length>1){var d=Object.create(null);n.forEach((function(t){d[t._uuid]=t})),r={isCompleted:l,_map:d}}else r=n[0]}i&&i(e,r)}))},getXMLHttpRequest:function(){return new XMLHttpRequest},_parseLoadResArgs:i.parseLoadResArgs,getItem:function(t){return cc.assetManager.assets.has(t)?{content:cc.assetManager.assets.get(t)}:null},loadRes:function(t,e,i,n){var r=this._parseLoadResArgs(e,i,n),a=(e=r.type,r.onProgress),s=r.onComplete,o=cc.path.extname(t);o&&(t=t.slice(0,-o.length)),cc.resources.load(t,e,a,s)},loadResArray:function(t,e,i,n){var r=this._parseLoadResArgs(e,i,n),a=(e=r.type,r.onProgress),s=r.onComplete;t.forEach((function(e,i){var n=cc.path.extname(e);n&&(t[i]=e.slice(0,-n.length))})),cc.resources.load(t,e,a,s)},loadResDir:function(t,e,i,n){var r=this._parseLoadResArgs(e,i,n),a=(e=r.type,r.onProgress),s=r.onComplete;cc.resources.loadDir(t,e,a,(function(i,n){var r=[];i||(r=cc.resources.getDirWithPath(t,e).map((function(t){return t.path}))),s&&s(i,n,r)}))},getRes:function(t,e){return cc.assetManager.assets.has(t)?cc.assetManager.assets.get(t):cc.resources.get(t,e)},getResCount:function(){return cc.assetManager.assets.count},getDependsRecursively:function(t){return t?n.getDepsRecursively("string"==typeof t?t:t._uuid).concat([t._uuid]):[]},get assetLoader(){},get md5Pipe(){return u},get downloader(){return cc.assetManager.downloader},get loader(){return cc.assetManager.parser},addDownloadHandlers:function(t){var e=Object.create(null);for(var i in t){var n=t[i];e["."+i]=function(t,e,i){n({url:t},i)}}cc.assetManager.downloader.register(e)},addLoadHandlers:function(t){var e=Object.create(null);for(var i in t){var n=t[i];e["."+i]=function(t,e,i){n({content:t},i)}}cc.assetManager.parser.register(e)},flowInDeps:function(){},release:function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++){var i=t[e];"string"==typeof i&&(i=cc.assetManager.assets.get(i)),cc.assetManager.builtins._assets.find((function(t){return t.find((function(t){return t===i}))}))||cc.assetManager.releaseAsset(i)}else if(t){if("string"==typeof t&&(t=cc.assetManager.assets.get(t)),cc.assetManager.builtins._assets.find((function(e){return e.find((function(e){return e===t}))})))return;cc.assetManager.releaseAsset(t)}},releaseAsset:function(t){cc.assetManager.releaseAsset(t)},releaseRes:function(t,e){cc.resources.release(t,e)},releaseResDir:function(){},releaseAll:function(){cc.assetManager.releaseAll(),cc.assetManager.assets.clear()},removeItem:function(t){cc.assetManager.assets.remove(t)},setAutoRelease:function(t,e){"object"==typeof t&&(t=t._uuid),this._autoReleaseSetting[t]=!!e},setAutoReleaseRecursively:function(t,e){"object"==typeof t&&(t=t._uuid),e=!!e,this._autoReleaseSetting[t]=e;for(var i=n.getDepsRecursively(t),r=0;r<i.length;r++){var a=i[r];this._autoReleaseSetting[a]=e}},isAutoRelease:function(t){return"object"==typeof t&&(t=t._uuid),!!this._autoReleaseSetting[t]}};a.loadSubpackage=function(t,e){cc.assetManager.loadBundle(t,null,e)};var f={init:function(t){t.importBase=t.libraryPath,t.nativeBase=t.rawAssetsBase,cc.assetManager.init(t),t.rawAssets&&(new cc.AssetManager.Bundle).init({name:cc.AssetManager.BuiltinBundleName.RESOURCES,importBase:t.importBase,nativeBase:t.nativeBase,paths:t.rawAssets.assets,uuids:Object.keys(t.rawAssets.assets)})},loadAsset:function(t,e){cc.assetManager.loadAny(t,e)},getLibUrlNoExt:function(){},queryAssetInfo:function(){}};cc.url={normalize:function(t){return cc.warnID(1400,"cc.url.normalize","cc.assetManager.utils.normalize"),cc.assetManager.utils.normalize(t)},raw:function(t){return cc.warnID(1400,"cc.url.raw","cc.resources.load"),t.startsWith("resources/")?cc.assetManager._transform({path:cc.path.changeExtname(t.substr(10)),bundle:cc.AssetManager.BuiltinBundleName.RESOURCES,__isNative__:!0,ext:cc.path.extname(t)}):""}},Object.defineProperties(cc,{loader:{get:function(){return h}},AssetLibrary:{get:function(){return f}},LoadingItems:{get:function(){return cc.warnID(1400,"cc.LoadingItems","cc.AssetManager.Task"),cc.AssetManager.Task}},Pipeline:{get:function(){return cc.warnID(1400,"cc.Pipeline","cc.AssetManager.Pipeline"),cc.AssetManager.Pipeline}}}),e.obsolete(cc,"cc.RawAsset","cc.Asset"),e.obsolete(cc.Asset.prototype,"cc.Asset.url","nativeUrl"),Object.defineProperties(cc.macro,{DOWNLOAD_MAX_CONCURRENT:{get:function(){return cc.assetManager.downloader.maxConcurrency},set:function(t){cc.assetManager.downloader.maxConcurrency=t}}}),Object.assign(cc.director,{_getSceneUuid:function(t){cc.assetManager.main.getSceneInfo(t)}}),Object.defineProperties(cc.game,{_sceneInfos:{get:function(){var t=[];return cc.assetManager.main._config.scenes.forEach((function(e){t.push(e)})),t}}});var d=i.parseParameters;i.parseParameters=function(t,e,i){var n=d(t,e,i);return n.onProgress=n.onProgress||h.onProgress,n};var _=r._autoRelease;r._autoRelease=function(){_.apply(this,arguments);for(var t=h._autoReleaseSetting,e=Object.keys(t),i=0;i<e.length;i++){var n=e[i];if(!0===t[n]){var a=cc.assetManager.assets.get(n);a&&r.tryRelease(a)}}}}),{"../CCDirector":58,"../platform/js":214,"./depend-util":69,"./downloader":76,"./factory":77,"./releaseManager":87,"./utilities":92}],71:[(function(t,e){"use strict";var i=t("./helper");t("../platform/deserialize"),e.exports=function(t,e){var n;n=cc._MissingScript.safeFindClass;var r,a=null,s=(a=cc.deserialize.Details.pool).get();try{r=cc.deserialize(t,s,{classFinder:n,customEnv:e})}catch(d){throw a.put(s),d}for(var o=s.uuidList,c=s.uuidObjList,l=s.uuidPropList,u=[],h=0;h<o.length;h++){var f=o[h];u[h]={uuid:i.decodeUuid(f),owner:c[h],prop:l[h]}}return r.__depends__=u,r._native&&(r.__nativeDepend__=!0),a.put(s),r}}),{"../platform/deserialize":209,"../platform/deserialize-compiled":208,"../platform/deserialize-editor":void 0,"./helper":80}],72:[(function(t,e){"use strict";var i=cc.sys.__audioSupport,n=t("./utilities").parseParameters;e.exports=function(t,e,r){var a=n(e,void 0,r),s=(e=a.options,r=a.onComplete,document.createElement("audio"));s.src=t;var o=function(){clearTimeout(c),s.removeEventListener("canplaythrough",l,!1),s.removeEventListener("error",u,!1),i.USE_LOADER_EVENT&&s.removeEventListener(i.USE_LOADER_EVENT,l,!1)},c=setTimeout((function(){0===s.readyState?u():l()}),8e3),l=function(){o(),r&&r(null,s)},u=function(){o();var e="load audio failure - "+t;cc.log(e),r&&r(new Error(e))};return s.addEventListener("canplaythrough",l,!1),s.addEventListener("error",u,!1),i.USE_LOADER_EVENT&&s.addEventListener(i.USE_LOADER_EVENT,l,!1),s}}),{"./utilities":92}],73:[(function(t,e){"use strict";var i=t("./utilities").parseParameters;e.exports=function(t,e,n){var r=i(e,void 0,n),a=(e=r.options,n=r.onComplete,new Image);function s(){a.removeEventListener("load",s),a.removeEventListener("error",o),n&&n(null,a)}function o(){a.removeEventListener("load",s),a.removeEventListener("error",o),n&&n(new Error(cc.debug.getError(4930,t)))}return"file:"!==window.location.protocol&&(a.crossOrigin="anonymous"),a.addEventListener("load",s),a.addEventListener("error",o),a.src=t,a}}),{"./utilities":92}],74:[(function(t,e){"use strict";var i=t("./utilities").parseParameters;e.exports=function(t,e,n,r){var a=i(e,n,r),s=(e=a.options,n=a.onProgress,r=a.onComplete,new XMLHttpRequest),o="download failed: "+t+", status: ";if(s.open("GET",t,!0),void 0!==e.responseType&&(s.responseType=e.responseType),void 0!==e.withCredentials&&(s.withCredentials=e.withCredentials),void 0!==e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),void 0!==e.timeout&&(s.timeout=e.timeout),e.header)for(var c in e.header)s.setRequestHeader(c,e.header[c]);return s.onload=function(){200===s.status||0===s.status?r&&r(null,s.response):r&&r(new Error(o+s.status+"(no response)"))},n&&(s.onprogress=function(t){t.lengthComputable&&n(t.loaded,t.total)}),s.onerror=function(){r&&r(new Error(o+s.status+"(error)"))},s.ontimeout=function(){r&&r(new Error(o+s.status+"(time out)"))},s.onabort=function(){r&&r(new Error(o+s.status+"(abort)"))},s.send(null),s}}),{"./utilities":92}],75:[(function(t,e){"use strict";var i=t("./utilities").parseParameters,n={};e.exports=function(t,e,r){var a=i(e,void 0,r);if(e=a.options,r=a.onComplete,n[t])return r&&r(null);var s=document,o=document.createElement("script");function c(){o.parentNode.removeChild(o),o.removeEventListener("load",c,!1),o.removeEventListener("error",l,!1),n[t]=!0,r&&r(null)}function l(){o.parentNode.removeChild(o),o.removeEventListener("load",c,!1),o.removeEventListener("error",l,!1),r&&r(new Error(cc.debug.getError(4928,t)))}"file:"!==window.location.protocol&&(o.crossOrigin="anonymous"),o.async=e.async,o.src=t,o.addEventListener("load",c,!1),o.addEventListener("error",l,!1),s.body.appendChild(o)}}),{"./utilities":92}],76:[(function(t,e){"use strict";var i=t("../platform/js"),n=t("../CCDebug"),r=t("./font-loader").loadFont,a=t("../platform/utils").callInNextTick,s=t("./download-dom-image"),o=t("./download-dom-audio"),c=t("./download-file"),l=t("./download-script.js"),u=t("./cache"),h=t("./shared").files,f=t("../platform/CCSys"),d=f.__audioSupport,_=f.capabilities,p=t("./utilities"),m=p.urlAppendTimestamp,v=p.retry,g=/^\w+:\/\/.*/,y=function(t,e,i){e.audioLoadMode!==cc.AudioClip.LoadMode.DOM_AUDIO?A(t,e,i):o(t,e,i)},T=(y=0===(d.format||[]).length?function(t,e,i){i(new Error(n.getError(4927)))}:d.WEB_AUDIO?y:o,function(){var t=_.imageBitmap&&cc.macro.ALLOW_IMAGE_BITMAP?b:s;t.apply(this,arguments)}),b=function(t,e,i){e.responseType="blob",c(t,e,e.onFileProgress,i)},E=function(t,e,i){e.responseType="json",c(t,e,e.onFileProgress,(function(t,e){if(!t&&"string"==typeof e)try{e=JSON.parse(e)}catch(n){t=n}i&&i(t,e)}))},A=function(t,e,i){e.responseType="arraybuffer",c(t,e,e.onFileProgress,i)},C=function(t,e,i){e.responseType="text",c(t,e,e.onFileProgress,i)},x=function(t,e,i){i(null,t)},S=new u,w=[],M=!1,R=0,I=0,O=-1,D=!1,P=function(){var t=Date.now();t-O>1e3*cc.director._deltaTime&&(I=0,O=t)},L=function t(e,i){for(D=!1,P();w.length>0&&R<e&&I<i;){M&&(w.sort((function(t,e){return t.priority-e.priority})),M=!1);var n=w.pop();if(!n)break;R++,I++,n.invoke()}w.length>0&&R<e&&(a(t,e,i),D=!0)},N={_remoteServerAddress:"",get remoteServerAddress(){return this._remoteServerAddress},maxConcurrency:6,maxRequestsPerFrame:6,maxRetryCount:3,appendTimeStamp:!1,limited:!0,retryInterval:2e3,bundleVers:null,downloadDomImage:s,downloadDomAudio:o,downloadFile:c,downloadScript:l,init:function(t,e){S.clear(),w.length=0,this._remoteServerAddress=e||"",this.bundleVers=t||Object.create(null)},register:function(t,e){"object"==typeof t?i.mixin(F,t):F[t]=e},download:function(t,e,i,n,r){var s,o,c=F[i]||F.default,l=this;if(s=h.get(t))r(null,s);else if(o=S.get(t)){o.push(r);for(var u=0,f=w.length;u<f;u++){var d=w[u];if(d.id===t){var _=n.priority||0;return void(d.priority<_&&(d.priority=_,M=!0))}}}else{var p=n.maxRetryCount||this.maxRetryCount,g=n.maxConcurrency||this.maxConcurrency,y=n.maxRequestsPerFrame||this.maxRequestsPerFrame;v((function(i,s){if(0===i&&S.add(t,[r]),!l.limited)return c(m(e),n,s);function o(){c(m(e),n,(function(){R--,!D&&w.length>0&&(a(L,g,y),D=!0),s.apply(this,arguments)}))}P(),R<g&&I<y?(o(),R++,I++):(w.push({id:t,priority:n.priority||0,invoke:o}),M=!0,!D&&R<g&&(a(L,g,y),D=!0))}),p,this.retryInterval,(function(e,i){e||h.add(t,i);for(var n=S.remove(t),r=0,a=n.length;r<a;r++)n[r](e,i)}))}}},F={".png":T,".jpg":T,".bmp":T,".jpeg":T,".gif":T,".ico":T,".tiff":T,".webp":T,".image":T,".pvr":A,".pkm":A,".mp3":y,".ogg":y,".wav":y,".m4a":y,".txt":C,".xml":C,".vsh":C,".fsh":C,".atlas":C,".tmx":C,".tsx":C,".json":E,".ExportJson":E,".plist":C,".fnt":C,".font":r,".eot":r,".ttf":r,".woff":r,".svg":r,".ttc":r,".mp4":x,".avi":x,".mov":x,".mpg":x,".mpeg":x,".rm":x,".rmvb":x,".binary":A,".bin":A,".dbbin":A,".skel":A,".js":l,bundle:function(t,e,i){var n=cc.path.basename(t),r=t;g.test(r)||(r="assets/"+n);var a=e.version||N.bundleVers[n],s=0,o=null,c=null;E(r+"/config."+(a?a+".":"")+"json",e,(function(t,e){t&&(c=t),(o=e)&&(o.base=r+"/"),2==++s&&i(c,o)})),l(r+"/index."+(a?a+".":"")+"js",e,(function(t){t&&(c=t),2==++s&&i(c,o)}))},default:C};e.exports=N}),{"../CCDebug":57,"../platform/CCSys":202,"../platform/js":214,"../platform/utils":217,"./cache":67,"./download-dom-audio":72,"./download-dom-image":73,"./download-file":74,"./download-script.js":75,"./font-loader":79,"./shared":89,"./utilities":92}],77:[(function(t,e){"use strict";var i=t("./bundle"),n=t("./cache"),r=t("./shared"),a=r.assets,s=r.bundles,o=new n;function c(t,e,i,n){var r=null,a=null;try{(r=new cc.Texture2D)._nativeUrl=t,r._nativeAsset=e}catch(s){a=s}n&&n(a,r)}function l(t,e,i,n){var r=new cc.AudioClip;r._nativeUrl=t,r._nativeAsset=e,r.duration=e.duration,n&&n(null,r)}function u(t,e,i,n){var r=new cc.JsonAsset;r.json=e,n&&n(null,r)}function h(t,e,i,n){var r=new cc.TextAsset;r.text=e,n&&n(null,r)}function f(t,e,i,n){var r=new cc.TTFFont;r._nativeUrl=t,r._nativeAsset=e,n&&n(null,r)}function d(t,e,i,n){var r=new cc.BufferAsset;r._nativeUrl=t,r._nativeAsset=e,n&&n(null,r)}var _={register:function(t,e){"object"==typeof t?cc.js.mixin(p,t):p[t]=e},create:function(t,e,i,n,r){var s,c,l=p[i]||p.default;(s=a.get(t))?r(null,s):(c=o.get(t))?c.push(r):(o.add(t,[r]),l(t,e,n,(function(e,i){!e&&i instanceof cc.Asset&&(i._uuid=t,a.add(t,i));for(var n=o.remove(t),r=0,s=n.length;r<s;r++)n[r](e,i)})))}},p={".png":c,".jpg":c,".bmp":c,".jpeg":c,".gif":c,".ico":c,".tiff":c,".webp":c,".image":c,".pvr":c,".pkm":c,".mp3":l,".ogg":l,".wav":l,".m4a":l,".txt":h,".xml":h,".vsh":h,".fsh":h,".atlas":h,".tmx":h,".tsx":h,".fnt":h,".json":u,".ExportJson":u,".font":f,".eot":f,".ttf":f,".woff":f,".svg":f,".ttc":f,".binary":d,".bin":d,".dbbin":d,".skel":d,bundle:function(t,e,n,r){var a=s.get(e.name);a||(a=new i,e.base=e.base||t+"/",a.init(e)),r&&r(null,a)},default:function(t,e,i,n){var r=new cc.Asset;r._nativeUrl=t,r._nativeAsset=e,n&&n(null,r)}};e.exports=_}),{"./bundle":66,"./cache":67,"./shared":89}],78:[(function(t,e){"use strict";var i=t("./pack-manager"),n=t("./task"),r=t("./utilities"),a=r.getDepends,s=r.clear,o=r.forEach,c=t("./shared"),l=c.assets,u=c.fetchPipeline;function h(t){for(var e=t.output,i=0,n=e.length;i<n;i++)e[i].content&&e[i].content.decRef(!1)}function f(t,e,i,n,r,s,o){var c=e.options.__exclude__,l=e.progress;t.content=i,t.file=n,e.output.push(t),r&&(c[t.uuid]=!0,a(t.uuid,n||i,c,s,!0,!1,t.config),l.total=o+s.length),l.canInvoke&&e.dispatch("progress",++l.finish,l.total,t)}e.exports=function(t,e){var r=!1;t.progress||(t.progress={finish:0,total:t.input.length,canInvoke:!0},r=!0);var a=t.options,c=[],d=t.progress,_=d.total;a.__exclude__=a.__exclude__||Object.create(null),t.output=[],o(t.input,(function(n,a){if(!n.isNative&&l.has(n.uuid)){var s=l.get(n.uuid);return s.addRef(),f(n,t,s,null,s.__asyncLoadAssets__,c,_),a()}i.load(n,t.options,(function(i,s){i?t.isFinish||(!cc.assetManager.force||r?(cc.error(i.message,i.stack),d.canInvoke=!1,e(i)):f(n,t,null,null,!1,c,_)):t.isFinish||f(n,t,null,s,!n.isNative,c,_),a()}))}),(function(){if(t.isFinish)return s(t,!0),t.dispatch("error");if(c.length>0){var i=n.create({name:t.name+" dependencies",input:c,progress:d,options:a,onProgress:t.onProgress,onError:n.prototype.recycle,onComplete:function(n){n||(t.output.push.apply(t.output,this.output),i.recycle()),r&&h(t),e(n)}});u.async(i)}else r&&h(t),e()}))}}),{"./pack-manager":83,"./shared":89,"./task":90,"./utilities":92}],79:[(function(t,e){"use strict";var i,n=t("../utils/text-utils"),r=null,a="BES bswy:->@123\u4e01\u3041\u1101",s=Object.create(null),o=-1,c=[],l=3e3,u=(i=void 0,function(){if(void 0===i)if(window.FontFace){var t=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent),e=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);i=t?parseInt(t[1],10)>42:!e}else i=!1;return i});function h(){for(var t=!0,e=Date.now(),i=c.length-1;i>=0;i--){var s=c[i],u=s.fontFamilyName;if(e-s.startTime>l)cc.warnID(4933,u),s.onComplete(null,u),c.splice(i,1);else{var h=s.refWidth,f="40px "+u;r.font=f,h!==n.safeMeasureText(r,a,f)?(c.splice(i,1),s.onComplete(null,u)):t=!1}}t&&(clearInterval(o),o=-1)}var f={loadFont:function(t,e,i){var d=f._getFontFamily(t);if(s[d])return i(null,d);if(!r){var _=document.createElement("canvas");_.width=100,_.height=100,r=_.getContext("2d")}var p="40px "+d;r.font=p;var m=n.safeMeasureText(r,a,p),v=document.createElement("style");v.type="text/css";var g="";isNaN(d-0)?g+="@font-face { font-family:"+d+"; src:":g+="@font-face { font-family:'"+d+"'; src:",g+="url('"+t+"');",v.textContent=g+"}",document.body.appendChild(v);var y,T,b,E,A,C,x=document.createElement("div"),S=x.style;if(S.fontFamily=d,x.innerHTML=".",S.position="absolute",S.left="-100px",S.top="-100px",document.body.appendChild(x),u())y=Date.now(),T=d,b=i,E=new Promise(function(t,e){(function i(){Date.now()-y>=l?e():document.fonts.load("40px "+T).then((function(e){e.length>=1?t():setTimeout(i,100)}),(function(){e()}))})()}),A=null,C=new Promise(function(t,e){A=setTimeout(e,l)}),Promise.race([C,E]).then((function(){A&&(clearTimeout(A),A=null),b(null,T)}),(function(){cc.warnID(4933,T),b(null,T)}));else{var w={fontFamilyName:d,refWidth:m,onComplete:i,startTime:Date.now()};c.push(w),-1===o&&(o=setInterval(h,100))}s[d]=v},_getFontFamily:function(t){var e=t.lastIndexOf(".ttf");if(-1===e)return t;var i,n=t.lastIndexOf("/");return-1!==(i=-1===n?t.substring(0,e)+"_LABEL":t.substring(n+1,e)+"_LABEL").indexOf(" ")&&(i='"'+i+'"'),i}};e.exports=f}),{"../utils/text-utils":285}],80:[(function(t,e){"use strict";var i,n=t("./shared").bundles,r={decodeUuid:t("../utils/decode-uuid"),getUuidFromURL:(i=/.*[\/\\][0-9a-fA-F]{2}[\/\\]([0-9a-fA-F-]{8,})/,function(t){var e=t.match(i);return e?e[1]:""}),getUrlWithUuid:function(t,e){(e=e||Object.create(null)).__isNative__=e.isNative,e.ext=e.nativeExt;var i=n.find((function(e){return e.getAssetInfo(t)}));return i&&(e.bundle=i.name),cc.assetManager._transform(t,e)},isScene:function(t){return t&&(t.constructor===cc.SceneAsset||t instanceof cc.Scene)},normalize:function(t){return t&&(46===t.charCodeAt(0)&&47===t.charCodeAt(1)?t=t.slice(2):47===t.charCodeAt(0)&&(t=t.slice(1))),t}};e.exports=r}),{"../utils/decode-uuid":273,"./shared":89}],81:[(function(t){"use strict";t("./deprecated"),t("./CCAssetManager")}),{"./CCAssetManager":64,"./deprecated":70}],82:[(function(t,e){"use strict";var i=t("./pack-manager"),n=t("./pipeline"),r=t("./parser"),a=t("./utilities"),s=a.getDepends,o=a.cache,c=a.gatherAsset,l=a.setProperties,u=a.forEach,h=a.clear,f=a.checkCircleReference,d=t("./shared"),_=d.assets,p=d.files,m=d.parsed,v=d.pipeline,g=t("./task"),y=new n("loadOneAsset",[function(t,e){var n=t.output=t.input,r=n.options,a=n.isNative,s=n.uuid,o=n.file,c=r.reload;if(o||!c&&!a&&_.has(s))return e();i.load(n,t.options,(function(t,i){n.file=i,e(t)}))},function(t,e){var i=t.output=t.input,n=t.progress,a=t.options.__exclude__,s=i.id,o=i.file,c=i.options;if(i.isNative)r.parse(s,o,i.ext,c,(function(r,a){if(r)return e(r);i.content=a,n.canInvoke&&t.dispatch("progress",++n.finish,n.total,i),p.remove(s),m.remove(s),e()}));else{var l=i.uuid;if(l in a){var u=a[l],h=u.finish,d=u.content,v=u.err,g=u.callbacks;n.canInvoke&&t.dispatch("progress",++n.finish,n.total,i),h||f(l,l,a)?(d&&d.addRef&&d.addRef(),i.content=d,e(v)):g.push({done:e,item:i})}else if(!c.reload&&_.has(l)){var y=_.get(l);c.__asyncLoadAssets__||!y.__asyncLoadAssets__?(i.content=y.addRef(),n.canInvoke&&t.dispatch("progress",++n.finish,n.total,i),e()):T(t,y,e,!1)}else r.parse(s,o,"import",c,(function(i,n){if(i)return e(i);n._uuid=l,T(t,n,e,!0)}))}}]);function T(t,e,i,n){var r=t.input,a=t.progress,c=r.uuid,u=r.id,h=r.options,f=r.config,d=h.__asyncLoadAssets__,_=h.cacheAsset,y=[];e.addRef&&e.addRef(),s(c,e,Object.create(null),y,!1,d,f),a.canInvoke&&t.dispatch("progress",++a.finish,a.total+=y.length,r);var T=t.options.__exclude__[c]={content:e,finish:!1,callbacks:[{done:i,item:r}]},b=g.create({input:y,options:t.options,onProgress:t.onProgress,onError:g.prototype.recycle,progress:a,onComplete:function(t){if(e.decRef&&e.decRef(!1),e.__asyncLoadAssets__=d,T.finish=!0,T.err=t,!t){for(var i=Array.isArray(b.output)?b.output:[b.output],r=Object.create(null),a=0,s=i.length;a<s;a++){var h=i[a];h&&(r[h instanceof cc.Asset?h._uuid+"@import":c+"@native"]=h)}if(n){if(!l(c,e,r))try{e.onLoad&&e.onLoad()}catch(E){cc.error(E.message,E.stack)}p.remove(u),m.remove(u),o(c,e,void 0!==_?_:cc.assetManager.cacheAsset)}else if(e.__nativeDepend__&&!e._nativeAsset&&!l(c,e,r))try{e.onLoad&&e.onLoad()}catch(E){cc.error(E.message,E.stack)}b.recycle()}for(var f=T.callbacks,v=0,g=f.length;v<g;v++){var y=f[v];e.addRef&&e.addRef(),y.item.content=e,y.done(t)}f.length=0}});v.async(b)}e.exports=function(t,e){var i=!1;t.progress||(t.progress={finish:0,total:t.input.length,canInvoke:!0},i=!0);var n=t.options,r=t.progress;n.__exclude__=n.__exclude__||Object.create(null),t.output=[],u(t.input,(function(a,s){var o=g.create({input:a,onProgress:t.onProgress,options:n,progress:r,onComplete:function(n,a){n&&!t.isFinish&&(!cc.assetManager.force||i?(cc.error(n.message,n.stack),r.canInvoke=!1,e(n)):r.canInvoke&&t.dispatch("progress",++r.finish,r.total,a)),t.output.push(a),o.recycle(),s()}});y.async(o)}),(function(){if(n.__exclude__=null,t.isFinish)return h(t,!0),t.dispatch("error");c(t),h(t,!0),e()}))}}),{"./pack-manager":83,"./parser":84,"./pipeline":85,"./shared":89,"./task":90,"./utilities":92}],83:[(function(t,e){"use strict";var i=t("../platform/deserialize-compiled"),n=t("./downloader"),r=t("./cache"),a=t("../platform/js"),s=t("./shared").files,o=new r;function c(t){return o.has(t.uuid)}var l={unpackJson:function(t,e,n,r){var s=a.createMap(!0),o=null;if(Array.isArray(e)){(e=(0,i.unpackJSONs)(e,cc._MissingScript.safeFindClass)).length!==t.length&&cc.errorID(4915);for(var c=0;c<t.length;c++)s[t[c]+"@import"]=e[c]}else{var l=a._getClassId(cc.Texture2D);if(e.type===l){if(e.data){var u=e.data.split("|");u.length!==t.length&&cc.errorID(4915);for(var h=0;h<t.length;h++)s[t[h]+"@import"]=(0,i.packCustomObjData)(l,u[h])}}else o=new Error("unmatched type pack!"),s=null}r&&r(o,s)},init:function(){o.clear()},register:function(t,e){"object"==typeof t?a.mixin(u,t):u[t]=e},unpack:function(t,e,i,n,r){e?(0,u[i])(t,e,n,r):r&&r(new Error("package data is wrong!"))},load:function(t,e,i){if(t.isNative||!t.info||!t.info.packs)return n.download(t.id,t.url,t.ext,t.options,i);if(s.has(t.id))return i(null,s.get(t.id));var r=t.info.packs,a=r.find(c);if(a)return o.get(a.uuid).push({onComplete:i,id:t.id});a=r[0],o.add(a.uuid,[{onComplete:i,id:t.id}]);var u=cc.assetManager._transform(a.uuid,{ext:a.ext,bundle:t.config.name});n.download(a.uuid,u,a.ext,t.options,(function(e,i){s.remove(a.uuid),e&&cc.error(e.message,e.stack),l.unpack(a.packs,i,a.ext,t.options,(function(t,e){if(!t)for(var i in e)s.add(i,e[i]);for(var n=o.remove(a.uuid),r=0,c=n.length;r<c;r++){var l=n[r];if(t)l.onComplete(t);else{var u=e[l.id];u?l.onComplete(null,u):l.onComplete(new Error("can not retrieve data from package"))}}}))}))}},u={".json":l.unpackJson};e.exports=l}),{"../platform/deserialize-compiled":208,"../platform/js":214,"./cache":67,"./downloader":76,"./shared":89}],84:[(function(t,e){"use strict";var i=t("../platform/CCSAXParser").plistParser,n=t("../platform/js"),r=t("./deserialize"),a=t("./cache"),s=t("./helper").isScene,o=t("./shared"),c=o.parsed,l=o.files,u=t("../platform/CCSys"),h=u.__audioSupport,f=u.capabilities,d=new a,_={parseImage:function(t,e,i){if(f.imageBitmap&&t instanceof Blob){var n={};n.imageOrientation=e.__flipY__?"flipY":"none",n.premultiplyAlpha=e.__premultiplyAlpha__?"premultiply":"none",createImageBitmap(t,n).then((function(t){t.flipY=!!e.__flipY__,t.premultiplyAlpha=!!e.__premultiplyAlpha__,i&&i(null,t)}),(function(t){i&&i(t,null)}))}else i&&i(null,t)},parseAudio:function(t,e,i){t instanceof ArrayBuffer?h.context.decodeAudioData(t,(function(t){i&&i(null,t)}),(function(t){i&&i(t,null)})):i&&i(null,t)},parsePVRTex:function(t,e,i){var n=null,r=null;try{var a=t instanceof ArrayBuffer?t:t.buffer,s=new Int32Array(a,0,13);if(55727696!=s[0])throw new Error("Invalid magic number in PVR header");var o=s[7],c=s[6],l=s[12]+52;r={_data:new Uint8Array(a,l),_compressed:!0,width:o,height:c}}catch(u){n=u}i&&i(n,r)},parsePKMTex:(function(){function t(t,e){return t[e]<<8|t[e+1]}return function(e,i,n){var r=null,a=null;try{var s=e instanceof ArrayBuffer?e:e.buffer,o=new Uint8Array(s),c=t(o,6);if(0!==c&&1!==c&&3!==c)return new Error("Invalid magic number in ETC header");var l=t(o,12),u=t(o,14);t(o,8),t(o,10),a={_data:new Uint8Array(s,16),_compressed:!0,width:l,height:u}}catch(h){r=h}n&&n(r,a)}})(),parsePlist:function(t,e,n){var r=null,a=i.parse(t);a||(r=new Error("parse failed")),n&&n(r,a)},parseImport:function(t,e,i){if(!t)return i&&i(new Error("Json is empty"));var n,a=null;try{n=r(t,e)}catch(s){a=s}i&&i(a,n)},init:function(){d.clear()},register:function(t,e){"object"==typeof t?n.mixin(p,t):p[t]=e},parse:function(t,e,i,n,r){var a,o,u;(a=c.get(t))?r(null,a):(o=d.get(t))?o.push(r):(u=p[i])?(d.add(t,[r]),u(e,n,(function(e,i){e?l.remove(t):s(i)||c.add(t,i);for(var n=d.remove(t),r=0,a=n.length;r<a;r++)n[r](e,i)}))):r(null,e)}},p={".png":_.parseImage,".jpg":_.parseImage,".bmp":_.parseImage,".jpeg":_.parseImage,".gif":_.parseImage,".ico":_.parseImage,".tiff":_.parseImage,".webp":_.parseImage,".image":_.parseImage,".pvr":_.parsePVRTex,".pkm":_.parsePKMTex,".mp3":_.parseAudio,".ogg":_.parseAudio,".wav":_.parseAudio,".m4a":_.parseAudio,".plist":_.parsePlist,import:_.parseImport};e.exports=_}),{"../platform/CCSAXParser":200,"../platform/CCSys":202,"../platform/js":214,"./cache":67,"./deserialize":71,"./helper":80,"./shared":89}],85:[(function(t,e){"use strict";var i=t("./task"),n=0;function r(t,e){if(Array.isArray(e)){this.id=n++,this.name=t,this.pipes=[];for(var i=0,r=e.length;i<r;i++)"function"==typeof e[i]&&this.pipes.push(e[i])}else cc.warn("funcs must be an array")}r.prototype={constructor:r,insert:function(t,e){if(!("function"!=typeof t||e>this.pipes.length))return this.pipes.splice(e,0,t),this;cc.warnID(4921)},append:function(t){if("function"==typeof t)return this.pipes.push(t),this},remove:function(t){if("number"==typeof t)return this.pipes.splice(t,1),this},sync:function(t){var e=this.pipes;if(t instanceof i&&0!==e.length){null!=t.output&&(t.input=t.output,t.output=null),t._isFinish=!1;for(var n=0,r=e.length;n<r;){var a=(0,e[n])(t);if(a)return t._isFinish=!0,a;++n!==r&&(t.input=t.output,t.output=null)}return t._isFinish=!0,t.output}},async:function(t){var e=this.pipes;t instanceof i&&0!==e.length&&(null!=t.output&&(t.input=t.output,t.output=null),t._isFinish=!1,this._flow(0,t))},_flow:function(t,e){var i=this;(0,this.pipes[t])(e,(function(n){n?(e._isFinish=!0,e.onComplete&&e.onComplete(n)):++t<i.pipes.length?(e.input=e.output,e.output=null,i._flow(t,e)):(e._isFinish=!0,e.onComplete&&e.onComplete(n,e.output))}))}},e.exports=r}),{"./task":90}],86:[(function(t,e){"use strict";var i=t("./task"),n=t("./shared"),r=n.transformPipeline,a=n.RequestType;e.exports=function(t,e){var n=t.options,s=Object.create(null),o=Object.create(null);for(var c in n)switch(c){case a.PATH:case a.UUID:case a.DIR:case a.SCENE:case a.URL:break;case"__requestType__":case"__isNative__":case"ext":case"type":case"__nativeName__":case"audioLoadMode":case"bundle":s[c]=n[c];break;case"__exclude__":case"__outputAsArray__":o[c]=n[c];break;default:s[c]=n[c],o[c]=n[c]}t.options=o;var l=i.create({input:t.input,options:s}),u=null;try{t.output=t.source=r.sync(l)}catch(d){u=d;for(var h=0,f=l.output.length;h<f;h++)l.output[h].recycle()}l.recycle(),e(u)}}),{"./shared":89,"./task":90}],87:[(function(t,e){"use strict";var i=t("./depend-util"),n=t("./cache");t("../assets/CCAsset");var r=t("./shared").assets;function a(t,e){t._uuid&&e.push(t._uuid)}function s(t,e){for(var i=Object.getOwnPropertyNames(t),n=0;n<i.length;n++){var r=i[n];if("node"!==r&&"__eventTargets"!==r){var s=t[r];if("object"==typeof s&&s)if(Array.isArray(s))for(var o=0;o<s.length;o++){var c=s[o];c instanceof cc.Asset&&a(c,e)}else if(s.constructor&&s.constructor!==Object)s instanceof cc.Asset&&a(s,e);else for(var l=Object.getOwnPropertyNames(s),u=0;u<l.length;u++){var h=s[l[u]];h instanceof cc.Asset&&a(h,e)}}}}var o=[];function c(t,e){for(var i=0;i<t._components.length;i++)s(t._components[i],e);for(var n=0;n<t._children.length;n++)c(t._children[n],e)}function l(t,e,n,a){n.push(t._uuid);for(var s=i.getDeps(t._uuid),o=0,c=s.length;o<c;o++){var u=r.get(s[o]);if(u){var h=u._uuid;if(h in e?e[h]+=a:e[h]=u.refCount+a,n.includes(h))continue;l(u,e,n,a)}}}function u(t){var e=Object.create(null);if(e[t._uuid]=t.refCount,l(t,e,o,-1),o.length=0,0!==e[t._uuid])return e[t._uuid];for(var i in e)0!==e[i]&&l(r.get(i),e,o,1);return o.length=0,e[t._uuid]}var h=new n,f=new n,d=!1;function _(){d=!1,f.forEach((function(t){p._free(t)})),f.clear()}var p={init:function(){h.clear(),f.clear()},_addPersistNodeRef:function(t){var e=[];c(t,e);for(var i=0,n=e.length;i<n;i++){var a=r.get(e[i]);a&&a.addRef()}h.add(t.uuid,e)},_removePersistNodeRef:function(t){if(h.has(t.uuid)){for(var e=h.get(t.uuid),i=0,n=e.length;i<n;i++){var a=r.get(e[i]);a&&a.decRef()}h.remove(t.uuid)}},_autoRelease:function(t,e,n){for(var a=0,s=n.length;a<s;a++){for(var o=n[a],c=i._depends.get(e._id),l=h.get(o.uuid),u=0,f=l.length;u<f;u++){var d=r.get(l[u]);d&&d.addRef()}c&&(!c.persistDeps&&(c.persistDeps=[]),c.persistDeps.push.apply(c.persistDeps,l))}if(t){for(var _=i.getDeps(t._id),p=0,m=_.length;p<m;p++){var v=r.get(_[p]);v&&v.decRef(t.autoReleaseAssets)}var g=i._depends.get(t._id);if(g&&g.persistDeps)for(var y=g.persistDeps,T=0,b=y.length;T<b;T++){var E=r.get(y[T]);E&&E.decRef(t.autoReleaseAssets)}i.remove(t._id)}},_free:function(t,e){if(f.remove(t._uuid),cc.isValid(t,!0)&&!(!e&&t.refCount>0&&u(t)>0)){r.remove(t._uuid);for(var n=i.getDeps(t._uuid),a=0,s=n.length;a<s;a++){var o=r.get(n[a]);o&&(o.decRef(!1),p._free(o,!1))}t.destroy(),i.remove(t._uuid)}},tryRelease:function(t,e){t instanceof cc.Asset&&(e?p._free(t,e):(f.add(t._uuid,t),d||(d=!0,cc.director.once(cc.Director.EVENT_AFTER_DRAW,_))))}};e.exports=p}),{"../assets/CCAsset":93,"./cache":67,"./depend-util":69,"./shared":89}],88:[(function(t,e){"use strict";var i=[];function n(){this._id="",this.uuid="",this.url="",this.ext=".json",this.content=null,this.file=null,this.info=null,this.config=null,this.isNative=!1,this.options=Object.create(null)}n.prototype={constructor:n,get id(){return this._id||(this._id=this.uuid+"@"+(this.isNative?"native":"import")),this._id},recycle:function(){500!==i.length&&(this._id="",this.uuid="",this.url="",this.ext=".json",this.content=null,this.file=null,this.info=null,this.config=null,this.isNative=!1,this.options=Object.create(null),i.push(this))}},n.create=function(){return 0!==i.length?i.pop():new n},e.exports=n}),{}],89:[(function(t,e){"use strict";var i=t("./cache"),n=t("./pipeline"),r=new i,a=new i,s=new i,o=new i,c=new n("normal load",[]),l=new n("fetch",[]),u=new n("transform url",[]);e.exports={assets:r,files:a,parsed:s,pipeline:c,fetchPipeline:l,transformPipeline:u,RequestType:{UUID:"uuid",PATH:"path",DIR:"dir",URL:"url",SCENE:"scene"},bundles:o,BuiltinBundleName:{RESOURCES:"resources",INTERNAL:"internal",MAIN:"main",START_SCENE:"start-scene"}}}),{"./cache":67,"./pipeline":85}],90:[(function(t,e){"use strict";var i=0,n=[];function r(t){this.id=i++,this._isFinish=!0,this.onComplete=null,this.onProgress=null,this.onError=null,this.source=null,this.output=null,this.input=null,this.progress=null,this.options=null,this.set(t)}r.prototype={constructor:r,set:function(t){t=t||Object.create(null),this.onComplete=t.onComplete,this.onProgress=t.onProgress,this.onError=t.onError,this.source=this.input=t.input,this.output=null,this.progress=t.progress,this.options=t.options||Object.create(null)},dispatch:function(t,e,i,n,r){switch(t){case"complete":this.onComplete&&this.onComplete(e,i,n,r);break;case"progress":this.onProgress&&this.onProgress(e,i,n,r);break;case"error":this.onError&&this.onError(e,i,n,r);break;default:var a="on"+t[0].toUpperCase()+t.substr(1);"function"==typeof this[a]&&this[a](e,i,n,r)}},recycle:function(){500!==n.length&&(this.onComplete=null,this.onProgress=null,this.onError=null,this.source=this.output=this.input=null,this.progress=null,this.options=null,n.push(this))},get isFinish(){return this._isFinish}},r.create=function(t){var e=null;return 0!==n.length?(e=n.pop()).set(t):e=new r(t),e},e.exports=r}),{}],91:[(function(t,e){"use strict";var i=t("./helper").decodeUuid,n=t("./request-item"),r=t("./shared"),a=r.RequestType,s=r.bundles;e.exports={parse:function(t){var e=t.input,r=t.options;e=Array.isArray(e)?e:[e],t.output=[];for(var o=0;o<e.length;o++){var c=e[o],l=n.create();if("string"==typeof c&&((c=Object.create(null))[r.__requestType__||a.UUID]=e[o]),"object"==typeof c)for(var u in cc.js.addon(c,r),c.preset&&cc.js.addon(c,cc.assetManager.presets[c.preset]),c){switch(u){case a.UUID:var h=l.uuid=i(c.uuid);if(s.has(c.bundle)){if((p=(m=s.get(c.bundle)._config).getAssetInfo(h))&&p.redirect){if(!s.has(p.redirect))throw new Error("Please load bundle "+p.redirect+" first");p=(m=s.get(p.redirect)._config).getAssetInfo(h)}l.config=m,l.info=p}l.ext=c.ext||".json";break;case"__requestType__":case"ext":case"bundle":case"preset":case"type":break;case a.DIR:if(s.has(c.bundle)){var f=[];s.get(c.bundle)._config.getDirWithPath(c.dir,c.type,f);for(var d=0,_=f.length;d<_;d++){var p=f[d];e.push({uuid:p.uuid,__isNative__:!1,ext:".json",bundle:c.bundle})}}l.recycle(),l=null;break;case a.PATH:if(s.has(c.bundle)){if((p=(m=s.get(c.bundle)._config).getInfoWithPath(c.path,c.type))&&p.redirect){if(!s.has(p.redirect))throw new Error("you need to load bundle "+p.redirect+" first");p=(m=s.get(p.redirect)._config).getAssetInfo(p.uuid)}if(!p)throw l.recycle(),new Error("Bundle "+c.bundle+" doesn't contain "+c.path);l.config=m,l.uuid=p.uuid,l.info=p}l.ext=c.ext||".json";break;case a.SCENE:if(s.has(c.bundle)){var m;if((p=(m=s.get(c.bundle)._config).getSceneInfo(c.scene))&&p.redirect){if(!s.has(p.redirect))throw new Error("you need to load bundle "+p.redirect+" first");p=(m=s.get(p.redirect)._config).getAssetInfo(p.uuid)}if(!p)throw l.recycle(),new Error("Bundle "+m.name+" doesn't contain scene "+c.scene);l.config=m,l.uuid=p.uuid,l.info=p}break;case"__isNative__":l.isNative=c.__isNative__;break;case a.URL:l.url=c.url,l.uuid=c.uuid||c.url,l.ext=c.ext||cc.path.extname(c.url),l.isNative=void 0===c.__isNative__||c.__isNative__;break;default:l.options[u]=c[u]}if(!l)break}if(l&&(t.output.push(l),!l.uuid&&!l.url))throw new Error("unknown input:"+c.toString())}return null},combine:function(t){for(var e=t.output=t.input,i=0;i<e.length;i++){var n=e[i];if(!n.url){var r,a,s=n.config;a=n.isNative?s&&s.nativeBase?s.base+s.nativeBase:cc.assetManager.generalNativeBase:s&&s.importBase?s.base+s.importBase:cc.assetManager.generalImportBase;var o=n.uuid,c="";n.info&&(c=n.isNative?n.info.nativeVer?"."+n.info.nativeVer:"":n.info.ver?"."+n.info.ver:""),r=".ttf"===n.ext?a+"/"+o.slice(0,2)+"/"+o+c+"/"+n.options.__nativeName__:a+"/"+o.slice(0,2)+"/"+o+c+n.ext,n.url=r}}return null}}}),{"./helper":80,"./request-item":88,"./shared":89}],92:[(function(t,e){"use strict";var i=t("./depend-util"),n=t("./helper"),r=n.isScene,a=n.decodeUuid,s=t("./shared").assets,o=t("../platform/utils").callInNextTick;t("../assets/CCAsset");var c={processOptions:function(t){var e=t.uuids,i=t.paths,n=t.types,r=t.deps,s=t.paths=Object.create(null);if(!1===t.debug){for(var o=0,c=e.length;o<c;o++)e[o]=a(e[o]);for(var l in i){var u=i[l],h=u[1];u[1]=n[h]}}else{for(var f=Object.create(null),d=0,_=e.length;d<_;d++){var p=e[d];e[d]=f[p]=a(p)}e=f}for(var m in i){var v=i[m];s[e[m]]=v}var g=t.scenes;for(var y in g){var T=g[y];g[y]=e[T]}var b=t.packs;for(var E in b)for(var A=b[E],C=0;C<A.length;++C)A[C]=e[A[C]];var x=t.versions;if(x)for(var S in x)for(var w=x[S],M=0;M<w.length;M+=2){var R=w[M];w[M]=e[R]||R}var I=t.redirect;if(I)for(var O=0;O<I.length;O+=2)I[O]=e[I[O]],I[O+1]=r[I[O+1]]},clear:function(t,e){for(var i=0,n=t.input.length;i<n;i++){var r=t.input[i];e&&!r.isNative&&r.content&&r.content.decRef&&r.content.decRef(!1),r.recycle()}t.input=null},urlAppendTimestamp:function(t){return cc.assetManager.downloader.appendTimeStamp&&"string"==typeof t?/\?/.test(t)?t+"&_t="+(new Date-0):t+"?_t="+(new Date-0):t},retry:function(t,e,i,n,r){t(r=r||0,(function(a,s){r++,!a||r>e?n&&n(a,s):setTimeout((function(){c.retry(t,e,i,n,r)}),i)}))},getDepends:function(t,e,n,r,a,s,o){try{var c=i.parse(t,e),l=!0;if(e instanceof cc.Asset&&(!e.__nativeDepend__||e._nativeAsset)&&(l=!1),a){for(var u=0,h=c.deps.length;u<h;u++){var f=c.deps[u];f in n||(n[f]=!0,r.push({uuid:f,bundle:o&&o.name}))}l&&c.nativeDep&&(o&&(c.nativeDep.bundle=o.name),r.push(Object.assign({},c.nativeDep)))}else{s=!!e.asyncLoadAssets||s&&!c.preventDeferredLoadDependents;for(var d=0,_=c.deps.length;d<_;d++){var p=c.deps[d];p in n||(n[p]=!0,r.push({uuid:p,__asyncLoadAssets__:s,bundle:o&&o.name}))}l&&!s&&!c.preventPreloadNativeObject&&c.nativeDep&&(o&&(c.nativeDep.bundle=o.name),r.push(Object.assign({},c.nativeDep)))}}catch(m){cc.error(m.message,m.stack)}},cache:function(t,e,i){e&&(!r(e)&&i&&s.add(t,e))},setProperties:function(t,e,i){var n=!1,r=e.__depends__;if(r){for(var a=0,s=r.length;a<s;a++){var o=r[a],c=i[o.uuid+"@import"];c?o.owner[o.prop]=c.addRef():(cc.error("The asset "+o.uuid+" is missing!"),n=!0)}e.__depends__=void 0}return e.__nativeDepend__&&(e._nativeAsset||(i[t+"@native"]?e._nativeAsset=i[t+"@native"]:n=!0),e.__nativeDepend__=void 0),n},gatherAsset:function(t){var e=t.source;if(t.options.__outputAsArray__||1!==e.length)for(var i=t.output=[],n=0,r=e.length;n<r;n++)i.push(e[n].content);else t.output=e[0].content},forEach:function(t,e,i){var n=0,r=[];0===t.length&&i&&i(r);for(var a=0,s=t.length;a<s;a++)e(t[a],(function(t){t&&r.push(t),++n===s&&i&&i(r)}))},parseParameters:function(t,e,i){if(void 0===i){var n="function"==typeof t;e?(i=e,n||(e=null)):void 0===e&&n&&(i=t,t=null,e=null),void 0!==e&&n&&(e=t,t=null)}return{options:t=t||Object.create(null),onProgress:e,onComplete:i}},parseLoadResArgs:function(t,e,i){if(void 0===i){var n=cc.js.isChildClassOf(t,cc.Asset);e?(i=e,n&&(e=null)):void 0!==e||n||(i=t,e=null,t=null),void 0===e||n||(e=t,t=null)}return{type:t,onProgress:e,onComplete:i}},checkCircleReference:function(t,e,n,r){if(r||(r=Object.create(null)),!n[e]||r[e])return!1;r[e]=!0;var a=!1,s=i.getDeps(e);if(s)for(var o=0,l=s.length;o<l;o++){var u=s[o];if(u===t||c.checkCircleReference(t,u,n,r)){a=!0;break}}return a},asyncify:function(t){return function(e,i){t&&o(t,e,i)}}};e.exports=c}),{"../assets/CCAsset":93,"../platform/utils":217,"./depend-util":69,"./helper":80,"./shared":89}],93:[(function(t,e){"use strict";var i=t("../platform/CCObject");cc.Asset=cc.Class({name:"cc.Asset",extends:i,ctor:function(){Object.defineProperty(this,"_uuid",{value:"",writable:!0}),this.loaded=!0,this._nativeUrl="",this._ref=0},properties:{nativeUrl:{get:function(){if(!this._nativeUrl&&this._native){var t=this._native;if(47===t.charCodeAt(0))return t.slice(1);46===t.charCodeAt(0)?this._nativeUrl=cc.assetManager.utils.getUrlWithUuid(this._uuid,{nativeExt:t,isNative:!0}):this._nativeUrl=cc.assetManager.utils.getUrlWithUuid(this._uuid,{__nativeName__:t,nativeExt:cc.path.extname(t),isNative:!0})}return this._nativeUrl},visible:!1},refCount:{get:function(){return this._ref}},_native:"",_nativeAsset:{get:function(){return this._$nativeAsset},set:function(t){this._$nativeAsset=t}},_nativeDep:{get:function(){if(this._native)return{__isNative__:!0,uuid:this._uuid,ext:this._native}}}},statics:{deserialize:!1,preventDeferredLoadDependents:!1,preventPreloadNativeObject:!1},toString:function(){return this.nativeUrl},serialize:!1,createNode:null,_setRawAsset:function(t,e){this._native=!1!==e?t||void 0:"/"+t},addRef:function(){return this._ref++,this},decRef:function(t){return this._ref--,!1!==t&&cc.assetManager._releaseManager.tryRelease(this),this}}),e.exports=cc.Asset}),{"../platform/CCObject":199}],94:[(function(t,e){"use strict";var i=t("./CCAsset"),n=t("../event/event-target"),r=cc.Enum({WEB_AUDIO:0,DOM_AUDIO:1}),a=cc.Class({name:"cc.AudioClip",extends:i,mixins:[n],ctor:function(){this._loading=!1,this.loaded=!1,this._audio=null},properties:{duration:0,loadMode:{default:r.WEB_AUDIO,type:r},_nativeAsset:{get:function(){return this._audio},set:function(t){t instanceof cc.AudioClip?this._audio=t._nativeAsset:this._audio=t,this._audio&&(this.loaded=!0,this.emit("load"))},override:!0},_nativeDep:{get:function(){return{uuid:this._uuid,audioLoadMode:this.loadMode,ext:cc.path.extname(this._native),__isNative__:!0}},override:!0}},statics:{LoadMode:r,_loadByUrl:function(t,e){var i=cc.assetManager.assets.get(t);i?e(null,i):cc.assetManager.loadRemote(t,(function(t,i){if(t)return e(t);e(null,i)}))}},_ensureLoaded:function(t){if(this.loaded)return t&&t();if(t&&this.once("load",t),!this._loading){this._loading=!0;var e=this;cc.assetManager.postLoadNative(this,(function(){e._loading=!1}))}},destroy:function(){cc.audioEngine.uncache(this),this._super()}});cc.AudioClip=a,e.exports=a}),{"../event/event-target":166,"./CCAsset":93}],95:[(function(t,e){"use strict";var i=function(){this.u=0,this.v=0,this.w=0,this.h=0,this.offsetX=0,this.offsetY=0,this.textureID=0,this.valid=!1,this.xAdvance=0},n=function(t){this._letterDefinitions={},this._texture=t};n.prototype={constructor:n,addLetterDefinitions:function(t,e){this._letterDefinitions[t]=e},cloneLetterDefinition:function(){var t={};for(var e in this._letterDefinitions){var n=new i;cc.js.mixin(n,this._letterDefinitions[e]),t[e]=n}return t},getTexture:function(){return this._texture},getLetter:function(t){return this._letterDefinitions[t]},getLetterDefinitionForChar:function(t){var e=t.charCodeAt(0);return this._letterDefinitions.hasOwnProperty(e)?this._letterDefinitions[e]:null},clear:function(){this._letterDefinitions={}}};var r=cc.Class({name:"cc.BitmapFont",extends:cc.Font,properties:{fntDataStr:{default:""},spriteFrame:{default:null,type:cc.SpriteFrame},fontSize:{default:-1},_fntConfig:null,_fontDefDictionary:null},onLoad:function(){var t=this.spriteFrame;!this._fontDefDictionary&&t&&(this._fontDefDictionary=new n(t._texture));var e=this._fntConfig;if(e){var r=e.fontDefDictionary;for(var a in r){var s=new i,o=r[a].rect;s.offsetX=r[a].xOffset,s.offsetY=r[a].yOffset,s.w=o.width,s.h=o.height,s.u=o.x,s.v=o.y,s.textureID=0,s.valid=!0,s.xAdvance=r[a].xAdvance,this._fontDefDictionary.addLetterDefinitions(a,s)}}}});cc.BitmapFont=r,cc.BitmapFont.FontLetterDefinition=i,cc.BitmapFont.FontAtlas=n,e.exports=r}),{}],96:[(function(t,e){"use strict";var i=cc.Class({name:"cc.BufferAsset",extends:cc.Asset,ctor:function(){this._buffer=null},properties:{_nativeAsset:{get:function(){return this._buffer},set:function(t){this._buffer=t.buffer||t},override:!0},buffer:function(){return this._buffer}}});cc.BufferAsset=e.exports=i}),{}],97:[(function(t,e){"use strict";var i=cc.Class({name:"cc.Font",extends:cc.Asset});cc.Font=e.exports=i}),{}],98:[(function(t,e){"use strict";var i=cc.Class({name:"cc.JsonAsset",extends:cc.Asset,properties:{json:null}});e.exports=cc.JsonAsset=i}),{}],99:[(function(t,e){"use strict";var i=cc.Class({name:"cc.LabelAtlas",extends:cc.BitmapFont,onLoad:function(){this.spriteFrame?this._fntConfig?this._super():cc.warnID(9101,this.name):cc.warnID(9100,this.name)}});cc.LabelAtlas=i,e.exports=i}),{}],100:[(function(t,e){"use strict";var i=cc.Enum({AUTO:0,SINGLE_INSTANCE:1,MULTI_INSTANCE:2}),n=cc.Class({name:"cc.Prefab",extends:cc.Asset,ctor:function(){this._createFunction=null,this._instantiatedTimes=0},properties:{data:null,optimizationPolicy:i.AUTO,asyncLoadAssets:!1,readonly:{default:!1,editorOnly:!0}},statics:{OptimizationPolicy:i,OptimizationPolicyThreshold:3},createNode:!1,compileCreateFunction:function(){var e=t("../platform/instantiate-jit");this._createFunction=e.compile(this.data)},_doInstantiate:function(t){return this.data._prefab||cc.warnID(3700),this._createFunction||this.compileCreateFunction(),this._createFunction(t)},_instantiate:function(){var t;return t=this.data._instantiate(),++this._instantiatedTimes,t},destroy:function(){this.data&&this.data.destroy(),this._super()}});cc.Prefab=e.exports=n,cc.js.obsolete(cc,"cc._Prefab","Prefab")}),{"../platform/instantiate-jit":212}],101:[(function(t,e){"use strict";var i,n=(i=t("../../renderer/gfx"))&&i.__esModule?i:{default:i},r=t("../renderer"),a=t("./CCTexture2D"),s=cc.Enum({RB_FMT_D24S8:n.default.RB_FMT_D24S8,RB_FMT_S8:n.default.RB_FMT_S8,RB_FMT_D16:n.default.RB_FMT_D16}),o=cc.Class({name:"cc.RenderTexture",extends:a,statics:{DepthStencilFormat:s},ctor:function(){this._framebuffer=null},initWithSize:function(t,e,i){this.width=Math.floor(t||cc.visibleRect.width),this.height=Math.floor(e||cc.visibleRect.height),this._resetUnderlyingMipmaps();var a,s={colors:[this._texture]};this._depthStencilBuffer&&this._depthStencilBuffer.destroy(),i&&(a=new n.default.RenderBuffer(r.device,i,t,e),i===n.default.RB_FMT_D24S8?s.depthStencil=a:i===n.default.RB_FMT_S8?s.stencil=a:i===n.default.RB_FMT_D16&&(s.depth=a)),this._depthStencilBuffer=a,this._framebuffer&&this._framebuffer.destroy(),this._framebuffer=new n.default.FrameBuffer(r.device,t,e,s),this._packable=!1,this.loaded=!0,this.emit("load")},updateSize:function(t,e){this.width=Math.floor(t||cc.visibleRect.width),this.height=Math.floor(e||cc.visibleRect.height),this._resetUnderlyingMipmaps();var i=this._depthStencilBuffer;i&&i.update(this.width,this.height),this._framebuffer._width=t,this._framebuffer._height=e},drawTextureAt:function(t,e,i){t._image&&0!==t._image.width&&this._texture.updateSubImage({x:e,y:i,image:t._image,width:t.width,height:t.height,level:0,flipY:!1,premultiplyAlpha:t._premultiplyAlpha})},readPixels:function(t,e,i,n,r){if(!this._framebuffer||!this._texture)return t;e=e||0,i=i||0;var a=n||this.width,s=r||this.height;t=t||new Uint8Array(a*s*4);var o=cc.game._renderContext,c=o.getParameter(o.FRAMEBUFFER_BINDING);return o.bindFramebuffer(o.FRAMEBUFFER,this._framebuffer.getHandle()),o.readPixels(e,i,a,s,o.RGBA,o.UNSIGNED_BYTE,t),o.bindFramebuffer(o.FRAMEBUFFER,c),t},destroy:function(){this._super(),this._framebuffer&&(this._framebuffer.destroy(),this._framebuffer=null)}});cc.RenderTexture=e.exports=o}),{"../../renderer/gfx":326,"../renderer":225,"./CCTexture2D":108}],102:[(function(t,e){"use strict";var i=cc.Class({name:"cc.SceneAsset",extends:cc.Asset,properties:{scene:null,asyncLoadAssets:void 0}});cc.SceneAsset=i,e.exports=i}),{}],103:[(function(){"use strict";var t=cc.Class({name:"cc.Script",extends:cc.Asset});cc._Script=t;var e=cc.Class({name:"cc.JavaScript",extends:t});cc._JavaScript=e;var i=cc.Class({name:"cc.TypeScript",extends:t});cc._TypeScript=i}),{}],104:[(function(t,e){"use strict";var i=cc.Class({name:"cc.SpriteAtlas",extends:cc.Asset,properties:{_spriteFrames:{default:{}}},getTexture:function(){var t=Object.keys(this._spriteFrames);if(t.length>0){var e=this._spriteFrames[t[0]];return e?e.getTexture():null}return null},getSpriteFrame:function(t){var e=this._spriteFrames[t];return e?(e.name||(e.name=t),e):null},getSpriteFrames:function(){var t=[],e=this._spriteFrames;for(var i in e)t.push(this.getSpriteFrame(i));return t}});cc.SpriteAtlas=i,e.exports=i}),{}],105:[(function(t,e){"use strict";var i=t("../event/event-target"),n=[{u:0,v:0},{u:0,v:0},{u:0,v:0},{u:0,v:0}],r=cc.Class({name:"cc.SpriteFrame",extends:t("../assets/CCAsset"),mixins:[i],properties:{_textureSetter:{set:function(t){t&&this._texture!==t&&this._refreshTexture(t)}},insetTop:{get:function(){return this._capInsets[1]},set:function(t){this._capInsets[1]=t,this._texture&&this._calculateSlicedUV()}},insetBottom:{get:function(){return this._capInsets[3]},set:function(t){this._capInsets[3]=t,this._texture&&this._calculateSlicedUV()}},insetLeft:{get:function(){return this._capInsets[0]},set:function(t){this._capInsets[0]=t,this._texture&&this._calculateSlicedUV()}},insetRight:{get:function(){return this._capInsets[2]},set:function(t){this._capInsets[2]=t,this._texture&&this._calculateSlicedUV()}}},ctor:function(){i.call(this);var t=arguments[0],e=arguments[1],n=arguments[2],r=arguments[3],a=arguments[4];this._rect=null,this.uv=[],this._texture=null,this._original=null,this._offset=null,this._originalSize=null,this._rotated=!1,this._flipX=!1,this._flipY=!1,this.vertices=null,this._capInsets=[0,0,0,0],this.uvSliced=[],void 0!==t&&this.setTexture(t,e,n,r,a)},textureLoaded:function(){return this._texture&&this._texture.loaded},onTextureLoaded:function(t,e){return this.textureLoaded()?(t.call(e),!0):(this.once("load",t,e),this.ensureLoadTexture(),!1)},isRotated:function(){return this._rotated},setRotated:function(t){this._rotated=t,this._texture&&this._calculateUV()},isFlipX:function(){return this._flipX},isFlipY:function(){return this._flipY},setFlipX:function(t){this._flipX=t,this._texture&&this._calculateUV()},setFlipY:function(t){this._flipY=t,this._texture&&this._calculateUV()},getRect:function(){return cc.rect(this._rect)},setRect:function(t){this._rect=t,this._texture&&this._calculateUV()},getOriginalSize:function(){return cc.size(this._originalSize)},setOriginalSize:function(t){this._originalSize?(this._originalSize.width=t.width,this._originalSize.height=t.height):this._originalSize=cc.size(t)},getTexture:function(){return this._texture},_textureLoadedCallback:function(){var t=this._texture;if(t){var e=t.width,i=t.height;this._rect?this._checkRect(this._texture):this._rect=cc.rect(0,0,e,i),this._originalSize||this.setOriginalSize(cc.size(e,i)),this._offset||this.setOffset(cc.v2(0,0)),this._calculateUV(),this.emit("load")}},_refreshTexture:function(t){this._texture=t,t.loaded?this._textureLoadedCallback():t.once("load",this._textureLoadedCallback,this)},getOffset:function(){return cc.v2(this._offset)},setOffset:function(t){this._offset=cc.v2(t)},clone:function(){return new r(this._texture,this.getRect(),this._rotated,this.getOffset(),this.getOriginalSize())},setTexture:function(t,e,i,n,r){if(1!==arguments.length||t!==this._texture){if(this._rect=e||null,n?this.setOffset(n):this._offset=null,r?this.setOriginalSize(r):this._originalSize=null,this._rotated=i||!1,"string"!=typeof t)return t instanceof cc.Texture2D&&this._refreshTexture(t),!0;cc.errorID(3401)}},ensureLoadTexture:function(){this._texture&&(this._texture.loaded||(this._refreshTexture(this._texture),cc.assetManager.postLoadNative(this._texture)))},_checkRect:function(t){var e=this._rect,i=e.x,n=e.y;this._rotated?(i+=e.height,n+=e.width):(i+=e.width,n+=e.height),i>t.width&&cc.errorID(3300,t.nativeUrl+"/"+this.name,i,t.width),n>t.height&&cc.errorID(3400,t.nativeUrl+"/"+this.name,n,t.height)},_flipXY:function(t){if(this._flipX){var e=t[0];t[0]=t[1],t[1]=e,e=t[2],t[2]=t[3],t[3]=e}if(this._flipY){var i=t[0];t[0]=t[2],t[2]=i,i=t[1],t[1]=t[3],t[3]=i}},_calculateSlicedUV:function(){var t=this._rect,e=this._texture.width,i=this._texture.height,r=this._capInsets[0],a=this._capInsets[2],s=t.width-r-a,o=this._capInsets[1],c=this._capInsets[3],l=t.height-o-c,u=this.uvSliced;if(u.length=0,this._rotated){n[0].u=t.x/e,n[1].u=(t.x+c)/e,n[2].u=(t.x+c+l)/e,n[3].u=(t.x+t.height)/e,n[3].v=t.y/i,n[2].v=(t.y+r)/i,n[1].v=(t.y+r+s)/i,n[0].v=(t.y+t.width)/i,this._flipXY(n);for(var h=0;h<4;++h)for(var f=n[h],d=0;d<4;++d){var _=n[3-d];u.push({u:f.u,v:_.v})}}else{n[0].u=t.x/e,n[1].u=(t.x+r)/e,n[2].u=(t.x+r+s)/e,n[3].u=(t.x+t.width)/e,n[3].v=t.y/i,n[2].v=(t.y+o)/i,n[1].v=(t.y+o+l)/i,n[0].v=(t.y+t.height)/i,this._flipXY(n);for(var p=0;p<4;++p)for(var m=n[p],v=0;v<4;++v){var g=n[v];u.push({u:g.u,v:m.v})}}},_setDynamicAtlasFrame:function(t){t&&(this._original={_texture:this._texture,_x:this._rect.x,_y:this._rect.y},this._texture=t.texture,this._rect.x=t.x,this._rect.y=t.y,this._calculateUV())},_resetDynamicAtlasFrame:function(){this._original&&(this._rect.x=this._original._x,this._rect.y=this._original._y,this._texture=this._original._texture,this._original=null,this._calculateUV())},_calculateUV:function(){var t=this._rect,e=this._texture,i=this.uv,n=e.width,r=e.height;if(this._rotated){var a=0===n?0:t.x/n,s=0===n?0:(t.x+t.height)/n,o=0===r?0:(t.y+t.width)/r,c=0===r?0:t.y/r;i[0]=a,i[1]=c,i[2]=a,i[3]=o,i[4]=s,i[5]=c,i[6]=s,i[7]=o}else{var l=0===n?0:t.x/n,u=0===n?0:(t.x+t.width)/n,h=0===r?0:(t.y+t.height)/r,f=0===r?0:t.y/r;i[0]=l,i[1]=h,i[2]=u,i[3]=h,i[4]=l,i[5]=f,i[6]=u,i[7]=f}if(this._flipX){var d=i[0];i[0]=i[2],i[2]=d,d=i[1],i[1]=i[3],i[3]=d,d=i[4],i[4]=i[6],i[6]=d,d=i[5],i[5]=i[7],i[7]=d}if(this._flipY){var _=i[0];i[0]=i[4],i[4]=_,_=i[1],i[1]=i[5],i[5]=_,_=i[2],i[2]=i[6],i[6]=_,_=i[3],i[3]=i[7],i[7]=_}var p=this.vertices;if(p){p.nu.length=0,p.nv.length=0;for(var m=0;m<p.u.length;m++)p.nu[m]=p.u[m]/n,p.nv[m]=p.v[m]/r}this._calculateSlicedUV()},_serialize:!1,_deserialize:function(t){var e=t.rect;e&&(this._rect=new cc.Rect(e[0],e[1],e[2],e[3])),t.offset&&this.setOffset(new cc.Vec2(t.offset[0],t.offset[1])),t.originalSize&&this.setOriginalSize(new cc.Size(t.originalSize[0],t.originalSize[1])),this._rotated=1===t.rotated,this._name=t.name;var i=t.capInsets;i&&(this._capInsets[0]=i[0],this._capInsets[1]=i[1],this._capInsets[2]=i[2],this._capInsets[3]=i[3]),this.vertices=t.vertices,this.vertices&&(this.vertices.nu=[],this.vertices.nv=[])}}),a=r.prototype;a.copyWithZone=a.clone,a.copy=a.clone,a.initWithTexture=a.setTexture,cc.SpriteFrame=r,e.exports=r}),{"../assets/CCAsset":93,"../event/event-target":166}],106:[(function(t,e){"use strict";var i=t("./CCFont"),n=cc.Class({name:"cc.TTFFont",extends:i,properties:{_fontFamily:null,_nativeAsset:{type:cc.String,get:function(){return this._fontFamily},set:function(t){this._fontFamily=t||"Arial"},override:!0},_nativeDep:{get:function(){return{uuid:this._uuid,__nativeName__:this._native,ext:cc.path.extname(this._native),__isNative__:!0}},override:!0}}});cc.TTFFont=e.exports=n}),{"./CCFont":97}],107:[(function(t,e){"use strict";var i=cc.Class({name:"cc.TextAsset",extends:cc.Asset,properties:{text:""},toString:function(){return this.text}});e.exports=cc.TextAsset=i}),{}],108:[(function(t,e){"use strict";var i,n=(i=t("../../renderer/gfx"))&&i.__esModule?i:{default:i},r=t("../event/event-target"),a=t("../renderer");t("../platform/CCClass");var s=new(t("../platform/id-generater"))("Tex"),o=1024,c=cc.Enum({RGB565:n.default.TEXTURE_FMT_R5_G6_B5,RGB5A1:n.default.TEXTURE_FMT_R5_G5_B5_A1,RGBA4444:n.default.TEXTURE_FMT_R4_G4_B4_A4,RGB888:n.default.TEXTURE_FMT_RGB8,RGBA8888:n.default.TEXTURE_FMT_RGBA8,RGBA32F:n.default.TEXTURE_FMT_RGBA32F,A8:n.default.TEXTURE_FMT_A8,I8:n.default.TEXTURE_FMT_L8,AI8:n.default.TEXTURE_FMT_L8_A8,RGB_PVRTC_2BPPV1:n.default.TEXTURE_FMT_RGB_PVRTC_2BPPV1,RGBA_PVRTC_2BPPV1:n.default.TEXTURE_FMT_RGBA_PVRTC_2BPPV1,RGB_A_PVRTC_2BPPV1:o++,RGB_PVRTC_4BPPV1:n.default.TEXTURE_FMT_RGB_PVRTC_4BPPV1,RGBA_PVRTC_4BPPV1:n.default.TEXTURE_FMT_RGBA_PVRTC_4BPPV1,RGB_A_PVRTC_4BPPV1:o++,RGB_ETC1:n.default.TEXTURE_FMT_RGB_ETC1,RGBA_ETC1:o++,RGB_ETC2:n.default.TEXTURE_FMT_RGB_ETC2,RGBA_ETC2:n.default.TEXTURE_FMT_RGBA_ETC2}),l=cc.Enum({REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648}),u=cc.Enum({LINEAR:9729,NEAREST:9728}),h={9728:0,9729:1},f=[],d={width:void 0,height:void 0,minFilter:void 0,magFilter:void 0,wrapS:void 0,wrapT:void 0,format:void 0,genMipmaps:void 0,images:void 0,image:void 0,flipY:void 0,premultiplyAlpha:void 0};function _(){for(var t in d)d[t]=void 0;return f.length=0,d.images=f,d}var p=cc.Class({name:"cc.Texture2D",extends:t("../assets/CCAsset"),mixins:[r],properties:{_nativeAsset:{get:function(){return this._image},set:function(t){t._compressed&&t._data?this.initWithData(t._data,this._format,t.width,t.height):this.initWithElement(t)},override:!0},_format:c.RGBA8888,_premultiplyAlpha:!1,_flipY:!1,_minFilter:u.LINEAR,_magFilter:u.LINEAR,_mipFilter:u.LINEAR,_wrapS:l.CLAMP_TO_EDGE,_wrapT:l.CLAMP_TO_EDGE,_isAlphaAtlas:!1,_genMipmaps:!1,genMipmaps:{get:function(){return this._genMipmaps},set:function(t){if(this._genMipmaps!==t){var e=_();e.genMipmaps=t,this.update(e)}}},_packable:!0,packable:{get:function(){return this._packable},set:function(t){this._packable=t}},_nativeDep:{get:function(){return{__isNative__:!0,uuid:this._uuid,ext:this._native,__flipY__:this._flipY,__premultiplyAlpha__:this._premultiplyAlpha}},override:!0}},statics:{PixelFormat:c,WrapMode:l,Filter:u,_FilterIndex:h,extnames:[".png",".jpg",".jpeg",".bmp",".webp",".pvr",".pkm"],_parseExt:function(t,e){for(var i=cc.renderer.device,n=t.split("_"),r="",a="",s=999,o=e,l=cc.macro.SUPPORT_TEXTURE_FORMATS,u=0;u<n.length;u++){var h=n[u].split("@"),f=h[0];f=p.extnames[f.charCodeAt(0)-48]||f;var d=l.indexOf(f);if(-1!==d&&d<s){var _=h[1]?parseInt(h[1]):e;if(".pvr"===f&&!i.ext("WEBGL_compressed_texture_pvrtc"))continue;if(!(_!==c.RGB_ETC1&&_!==c.RGBA_ETC1||i.ext("WEBGL_compressed_texture_etc1")))continue;if(!(_!==c.RGB_ETC2&&_!==c.RGBA_ETC2||i.ext("WEBGL_compressed_texture_etc")))continue;if(".webp"===f&&!cc.sys.capabilities.webp)continue;s=d,a=f,o=_}else r||(r=f)}return{bestExt:a,bestFormat:o,defaultExt:r}}},ctor:function(){this._id=s.getNewId(),this.loaded=!1,this.width=0,this.height=0,this._hashDirty=!0,this._hash=0,this._texture=null},getImpl:function(){return this._texture||(this._texture=new a.Texture2D(a.device,{})),this._texture},getId:function(){return this._id},toString:function(){return this.nativeUrl||""},update:function(t){if(t){var e=!1;void 0!==t.width&&(this.width=t.width),void 0!==t.height&&(this.height=t.height),void 0!==t.minFilter&&(this._minFilter=t.minFilter,t.minFilter=h[t.minFilter]),void 0!==t.magFilter&&(this._magFilter=t.magFilter,t.magFilter=h[t.magFilter]),void 0!==t.mipFilter&&(this._mipFilter=t.mipFilter,t.mipFilter=h[t.mipFilter]),void 0!==t.wrapS&&(this._wrapS=t.wrapS),void 0!==t.wrapT&&(this._wrapT=t.wrapT),void 0!==t.format&&(this._format=t.format),void 0!==t.flipY&&(this._flipY=t.flipY,e=!0),void 0!==t.premultiplyAlpha&&(this._premultiplyAlpha=t.premultiplyAlpha,e=!0),void 0!==t.genMipmaps&&(this._genMipmaps=t.genMipmaps),cc.sys.capabilities.imageBitmap&&this._image instanceof ImageBitmap?this._checkImageBitmap(this._upload.bind(this,t,e)):this._upload(t,e)}},_upload:function(t,e){e&&this._image&&(t.image=this._image),t.images&&t.images.length>0?this._image=t.images[0]:void 0!==t.image&&(this._image=t.image,t.images||(f.length=0,t.images=f),t.images.push(t.image)),this._texture&&this._texture.update(t),this._hashDirty=!0},initWithElement:function(t){if(t)if(this._image=t,t.complete||t instanceof HTMLCanvasElement)this.handleLoadedTexture();else if(cc.sys.capabilities.imageBitmap&&t instanceof ImageBitmap)this._checkImageBitmap(this.handleLoadedTexture.bind(this));else{var e=this;t.addEventListener("load",(function(){e.handleLoadedTexture()})),t.addEventListener("error",(function(t){cc.warnID(3119,t.message)}))}},initWithData:function(t,e,i,n){var r=_();return r.image=t,r.images=[r.image],r.genMipmaps=this._genMipmaps,r.premultiplyAlpha=this._premultiplyAlpha,r.flipY=this._flipY,r.minFilter=h[this._minFilter],r.magFilter=h[this._magFilter],r.wrapS=this._wrapS,r.wrapT=this._wrapT,r.format=this._getGFXPixelFormat(e),r.width=i,r.height=n,this._texture?this._texture.update(r):this._texture=new a.Texture2D(a.device,r),this.width=i,this.height=n,this._updateFormat(),this._checkPackable(),this.loaded=!0,this.emit("load"),!0},getHtmlElementObj:function(){return this._image},destroy:function(){cc.sys.capabilities.imageBitmap&&this._image instanceof ImageBitmap&&this._image.close&&this._image.close(),this._packable&&cc.dynamicAtlasManager&&cc.dynamicAtlasManager.deleteAtlasTexture(this),this._image=null,this._texture&&this._texture.destroy(),this._super()},getPixelFormat:function(){return this._format},hasPremultipliedAlpha:function(){return this._premultiplyAlpha||!1},isAlphaAtlas:function(){return this._isAlphaAtlas},handleLoadedTexture:function(){if(this._image&&this._image.width&&this._image.height){this.width=this._image.width,this.height=this._image.height;var t=_();t.image=this._image,t.images=[t.image],t.width=this.width,t.height=this.height,t.genMipmaps=this._genMipmaps,t.format=this._getGFXPixelFormat(this._format),t.premultiplyAlpha=this._premultiplyAlpha,t.flipY=this._flipY,t.minFilter=h[this._minFilter],t.magFilter=h[this._magFilter],t.wrapS=this._wrapS,t.wrapT=this._wrapT,this._texture?this._texture.update(t):this._texture=new a.Texture2D(a.device,t),this._updateFormat(),this._checkPackable(),this.loaded=!0,this.emit("load"),cc.macro.CLEANUP_IMAGE_CACHE&&(this._image instanceof HTMLImageElement?this._clearImage():cc.sys.capabilities.imageBitmap&&this._image instanceof ImageBitmap&&this._image.close&&this._image.close())}},description:function(){return"<cc.Texture2D | Name = "+this.nativeUrl+" | Dimensions = "+this.width+" x "+this.height+">"},releaseTexture:function(){this._image=null,this._texture&&this._texture.destroy()},setWrapMode:function(t,e){if(this._wrapS!==t||this._wrapT!==e){var i=_();i.wrapS=t,i.wrapT=e,this.update(i)}},setFilters:function(t,e){if(this._minFilter!==t||this._magFilter!==e){var i=_();i.minFilter=t,i.magFilter=e,this.update(i)}},setFlipY:function(t){if(this._flipY!==t){var e=_();e.flipY=t,e.premultiplyAlpha=this._premultiplyAlpha,this.update(e)}},setPremultiplyAlpha:function(t){if(this._premultiplyAlpha!==t){var e=_();e.flipY=this._flipY,e.premultiplyAlpha=t,this.update(e)}},_updateFormat:function(){this._isAlphaAtlas=this._format===c.RGBA_ETC1||this._format===c.RGB_A_PVRTC_4BPPV1||this._format===c.RGB_A_PVRTC_2BPPV1},_checkPackable:function(){var t=cc.dynamicAtlasManager;if(t)if(this._isCompressed())this._packable=!1;else{var e=this.width,i=this.height;!this._image||e>t.maxFrameSize||i>t.maxFrameSize||this._getHash()!==t.Atlas.DEFAULT_HASH?this._packable=!1:this._image&&this._image instanceof HTMLCanvasElement&&(this._packable=!0)}},_getOpts:function(){var t=_();return t.width=this.width,t.height=this.height,t.genMipmaps=this._genMipmaps,t.format=this._format,t.premultiplyAlpha=this._premultiplyAlpha,t.anisotropy=this._anisotropy,t.flipY=this._flipY,t.minFilter=h[this._minFilter],t.magFilter=h[this._magFilter],t.mipFilter=h[this._mipFilter],t.wrapS=this._wrapS,t.wrapT=this._wrapT,t},_getGFXPixelFormat:function(t){return t===c.RGBA_ETC1?t=c.RGB_ETC1:t===c.RGB_A_PVRTC_4BPPV1?t=c.RGB_PVRTC_4BPPV1:t===c.RGB_A_PVRTC_2BPPV1&&(t=c.RGB_PVRTC_2BPPV1),t},_resetUnderlyingMipmaps:function(t){var e=this._getOpts();e.images=t||[null],this._texture?this._texture.update(e):this._texture=new a.Texture2D(a.device,e)},_serialize:!1,_deserialize:function(t){var e=t.split(","),i=e[0];if(i){var n=p._parseExt(i,this._format);if(n.bestExt)this._setRawAsset(n.bestExt),this._format=n.bestFormat;else{if(!n.defaultExt)throw new Error(cc.debug.getError(3121));this._setRawAsset(n.defaultExt),cc.warnID(3120,n.defaultExt,n.defaultExt)}}8===e.length&&(this._minFilter=parseInt(e[1]),this._magFilter=parseInt(e[2]),this._wrapS=parseInt(e[3]),this._wrapT=parseInt(e[4]),this._premultiplyAlpha=49===e[5].charCodeAt(0),this._genMipmaps=49===e[6].charCodeAt(0),this._packable=49===e[7].charCodeAt(0))},_getHash:function(){if(!this._hashDirty)return this._hash;var t=this._genMipmaps?1:0,e=this._premultiplyAlpha?1:0,i=this._flipY?1:0,n=this._minFilter===u.LINEAR?1:2,r=this._magFilter===u.LINEAR?1:2,a=this._wrapS===l.REPEAT?1:this._wrapS===l.CLAMP_TO_EDGE?2:3,s=this._wrapT===l.REPEAT?1:this._wrapT===l.CLAMP_TO_EDGE?2:3,o=this._format;return this._image,this._hash=Number(""+n+r+o+a+s+t+e+i),this._hashDirty=!1,this._hash},_isCompressed:function(){return this._format<c.A8||this._format>c.RGBA32F},_clearImage:function(){this._image.src=""},_checkImageBitmap:function(t){var e=this,i=this._image,n=this._flipY,r=this._premultiplyAlpha;this._flipY!==i.flipY||this._premultiplyAlpha!==i.premultiplyAlpha?createImageBitmap(i,{imageOrientation:n!==i.flipY?"flipY":"none",premultiplyAlpha:r?"premultiply":"none"}).then((function(a){i.close&&i.close(),a.flipY=n,a.premultiplyAlpha=r,e._image=a,t()}),(function(t){cc.error(t.message)})):t()}});cc.Texture2D=e.exports=p}),{"../../renderer/gfx":326,"../assets/CCAsset":93,"../event/event-target":166,"../platform/CCClass":193,"../platform/id-generater":210,"../renderer":225}],109:[(function(t){"use strict";t("./CCAsset"),t("./CCFont"),t("./CCPrefab"),t("./CCAudioClip"),t("./CCScripts"),t("./CCSceneAsset"),t("./CCSpriteFrame"),t("./CCTexture2D"),t("./CCRenderTexture"),t("./CCTTFFont"),t("./CCSpriteAtlas"),t("./CCBitmapFont"),t("./CCLabelAtlas"),t("./CCTextAsset"),t("./CCJsonAsset"),t("./CCBufferAsset"),t("./material")}),{"./CCAsset":93,"./CCAudioClip":94,"./CCBitmapFont":95,"./CCBufferAsset":96,"./CCFont":97,"./CCJsonAsset":98,"./CCLabelAtlas":99,"./CCPrefab":100,"./CCRenderTexture":101,"./CCSceneAsset":102,"./CCScripts":103,"./CCSpriteAtlas":104,"./CCSpriteFrame":105,"./CCTTFFont":106,"./CCTextAsset":107,"./CCTexture2D":108,"./material":116}],110:[(function(t,e){"use strict";var i,n=(i=t("../CCAsset"))&&i.__esModule?i:{default:i},r=t("./effect-parser"),a=cc.Class({name:"cc.EffectAsset",extends:n.default,ctor:function(){this._effect=null},properties:{properties:Object,techniques:[],shaders:[]},onLoad:function(){if(cc.game.renderType!==cc.game.RENDER_TYPE_CANVAS){for(var t=cc.renderer._forward._programLib,e=0;e<this.shaders.length;e++)t.define(this.shaders[e]);this._initEffect()}},_initEffect:function(){this._effect||(this._effect=(0,r.parseEffect)(this),Object.freeze(this._effect))},getInstantiatedEffect:function(){return this._initEffect(),this._effect.clone()},getEffect:function(){return this._initEffect(),this._effect}});e.exports=cc.EffectAsset=a}),{"../CCAsset":93,"./effect-parser":113}],111:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=t("../CCAsset"),r=t("../CCTexture2D"),a=(r.PixelFormat,t("./CCEffectAsset")),s=(t("../../utils/texture-util"),cc.gfx),o=cc.Enum({SPRITE:"2d-sprite",GRAY_SPRITE:"2d-gray-sprite",UNLIT:"unlit"}),c=cc.Class({name:"cc.Material",extends:n,ctor:function(){this.loaded=!1,this._manualHash=!1,this._dirty=!0,this._effect=null},properties:{_defines:{default:void 0,type:Object},_props:{default:void 0,type:Object},_effectAsset:{type:a,default:null},_techniqueIndex:0,_techniqueData:Object,effectName:void 0,effectAsset:{get:function(){return this._effectAsset},set:function(t){cc.game.renderType!==cc.game.RENDER_TYPE_CANVAS&&(this._effectAsset=t,t?this._effect=this._effectAsset.getInstantiatedEffect():cc.error("Can not set an empty effect asset."))}},effect:{get:function(){return this._effect}},techniqueIndex:{get:function(){return this._techniqueIndex},set:function(t){this._techniqueIndex=t,this._effect.switchTechnique(t)}}},statics:{getBuiltinMaterial:function(t){return cc.game.renderType===cc.game.RENDER_TYPE_CANVAS?new cc.Material:cc.assetManager.builtins.getBuiltin("material","builtin-"+t)},BUILTIN_NAME:o,createWithBuiltin:function(t,e){void 0===e&&(e=0);var i=cc.assetManager.builtins.getBuiltin("effect","builtin-"+t);return c.create(i,e)},create:function(t,e){if(void 0===e&&(e=0),!t)return null;var i=new c;return i.effectAsset=t,i.techniqueIndex=e,i}},setProperty:function(t,e,i,n){if(cc.game.renderType!==cc.game.RENDER_TYPE_CANVAS){if("string"==typeof i&&(i=parseInt(i)),e instanceof r){var a=e.isAlphaAtlas(),s="CC_USE_ALPHA_ATLAS_"+t,o=this.getDefine(s,i);(a||o)&&this.define(s,a),e.loaded||cc.assetManager.postLoadNative(e)}this._effect.setProperty(t,e,i,n)}},getProperty:function(t,e){return"string"==typeof e&&(e=parseInt(e)),this._effect.getProperty(t,e)},define:function(t,e,i,n){cc.game.renderType!==cc.game.RENDER_TYPE_CANVAS&&("string"==typeof i&&(i=parseInt(i)),this._effect.define(t,e,i,n))},getDefine:function(t,e){return"string"==typeof e&&(e=parseInt(e)),this._effect.getDefine(t,e)},setCullMode:function(t,e){void 0===t&&(t=s.CULL_BACK),this._effect.setCullMode(t,e)},setDepth:function(t,e,i,n){void 0===t&&(t=!1),void 0===e&&(e=!1),void 0===i&&(i=s.DS_FUNC_LESS),this._effect.setDepth(t,e,i,n)},setBlend:function(t,e,i,n,r,a,o,c,l){void 0===t&&(t=!1),void 0===e&&(e=s.BLEND_FUNC_ADD),void 0===i&&(i=s.BLEND_SRC_ALPHA),void 0===n&&(n=s.BLEND_ONE_MINUS_SRC_ALPHA),void 0===r&&(r=s.BLEND_FUNC_ADD),void 0===a&&(a=s.BLEND_SRC_ALPHA),void 0===o&&(o=s.BLEND_ONE_MINUS_SRC_ALPHA),void 0===c&&(c=4294967295),this._effect.setBlend(t,e,i,n,r,a,o,c,l)},setStencilEnabled:function(t,e){void 0===t&&(t=s.STENCIL_INHERIT),this._effect.setStencilEnabled(t,e)},setStencil:function(t,e,i,n,r,a,o,c,l){void 0===t&&(t=s.STENCIL_INHERIT),void 0===e&&(e=s.DS_FUNC_ALWAYS),void 0===i&&(i=0),void 0===n&&(n=255),void 0===r&&(r=s.STENCIL_OP_KEEP),void 0===a&&(a=s.STENCIL_OP_KEEP),void 0===o&&(o=s.STENCIL_OP_KEEP),void 0===c&&(c=255),this._effect.setStencil(t,e,i,n,r,a,o,c,l)},updateHash:function(t){this._manualHash=t,this._effect&&this._effect.updateHash(t)},getHash:function(){return this._manualHash||this._effect&&this._effect.getHash()},onLoad:function(){if(this.effectAsset=this._effectAsset,this._effect){this._techniqueIndex&&this._effect.switchTechnique(this._techniqueIndex),this._techniqueData=this._techniqueData||{};var t=this._techniqueData;for(var e in t){var i=t[e=parseInt(e)];if(i){for(var n in i.defines)this.define(n,i.defines[n],e);for(var r in i.props)this.setProperty(r,i.props[r],e)}}}}}),l=c;i.default=l,cc.Material=c,e.exports=i.default}),{"../../utils/texture-util":286,"../CCAsset":93,"../CCTexture2D":108,"./CCEffectAsset":110}],112:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=(n=t("../../../renderer/core/pass"))&&n.__esModule?n:{default:n};function a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=cc.gfx,o=(function(){function t(){this._dirty=!0,this._name="",this._technique=null}var e,i,n=t.prototype;return n._createPassProp=function(t,e){var i=e._properties[t];if(i){var n=Object.create(null);return n.name=t,n.type=i.type,i.value instanceof Float32Array?n.value=new Float32Array(i.value):n.value=i.value,e._properties[t]=n,n}},n._setPassProperty=function(t,e,i,n){var a=i._properties.hasOwnProperty(t);if(a){if(a.value===e)return}else a=this._createPassProp(t,i);return this._dirty=!0,r.default.prototype.setProperty.call(i,t,e,n)},n.setProperty=function(t,e,i,n){var r=!1,a=this.passes,s=0,o=a.length;void 0!==i&&(s=i,o=i+1);for(var c=s;c<o;c++)this._setPassProperty(t,e,a[c],n)&&(r=!0);r||cc.warnID(9103,this.name,t)},n.getProperty=function(t,e){var i=this.passes;if(!(e>=i.length)){var n=0,r=i.length;void 0!==e&&(n=e,r=e+1);for(var a=n;a<r;a++){var s=i[a].getProperty(t);if(void 0!==s)return s}}},n.define=function(t,e,i,n){var r=!1,a=this.passes,s=0,o=a.length;void 0!==i&&(s=i,o=i+1);for(var c=s;c<o;c++)a[c].define(t,e,n)&&(r=!0);r||cc.warnID(9104,this.name,t)},n.getDefine=function(t,e){var i=this.passes;if(!(e>=i.length)){var n=0,r=i.length;void 0!==e&&(n=e,r=e+1);for(var a=n;a<r;a++){var s=i[a].getDefine(t);if(void 0!==s)return s}}},n.setCullMode=function(t,e){void 0===t&&(t=s.CULL_BACK);var i=this.passes,n=0,r=i.length;void 0!==e&&(n=e,r=e+1);for(var a=n;a<r;a++)i[a].setCullMode(t);this._dirty=!0},n.setDepth=function(t,e,i,n){var r=this.passes,a=0,s=r.length;void 0!==n&&(a=n,s=n+1);for(var o=a;o<s;o++)r[o].setDepth(t,e,i);this._dirty=!0},n.setBlend=function(t,e,i,n,r,a,s,o,c){var l=this.passes,u=0,h=l.length;void 0!==c&&(u=c,h=c+1);for(var f=u;f<h;f++)l[f].setBlend(t,e,i,n,r,a,s,o);this._dirty=!0},n.setStencilEnabled=function(t,e){void 0===t&&(t=s.STENCIL_INHERIT);var i=this.passes,n=0,r=i.length;void 0!==e&&(n=e,r=e+1);for(var a=n;a<r;a++)i[a].setStencilEnabled(t);this._dirty=!0},n.setStencil=function(t,e,i,n,r,a,s,o,c){var l=this.passes,u=0,h=l.length;void 0!==c&&(u=c,h=c+1);for(var f=u;f<h;f++){var d=l[f];d.setStencilFront(t,e,i,n,r,a,s,o),d.setStencilBack(t,e,i,n,r,a,s,o)}this._dirty=!0},e=t,(i=[{key:"name",get:function(){return this._name}},{key:"technique",get:function(){return this._technique}},{key:"passes",get:function(){return[]}}])&&a(e.prototype,i),t})();i.default=o,cc.EffectBase=o,e.exports=i.default}),{"../../../renderer/core/pass":317}],113:[(function(t,e,i){"use strict";i.__esModule=!0,i.parseEffect=function(t){var e=f(t);return new s.default(t.name,e,0,t)};var n=c(t("../../../renderer/core/pass")),r=t("../../../renderer/types"),a=c(t("../../../renderer/enums")),s=c(t("./effect")),o=c(t("../../../renderer/core/technique"));function c(t){return t&&t.__esModule?t:{default:t}}function l(t){return cc.renderer._forward._programLib.getTemplate(t)}function u(t,e){var i=e.properties||{},n=l(e.program),s=function(e){if(!n.uniforms.find((function(t){return t.name===e})))return cc.warnID(9107,t.name,e),"continue"};for(var o in i)s(o);var c={};return n.uniforms.forEach((function(t){var e=t.name,n=c[e]=Object.assign({},t),s=i[e],o=r.enums2default[t.type];o=s?s.type===a.default.PARAM_TEXTURE_2D?null:s.type===a.default.PARAM_INT||s.type===a.default.PARAM_FLOAT?Array.isArray(s.value)?s.value[0]:s.value:new Float32Array(s.value):r.enums2default[t.type],n.value=o})),c}function h(t){var e={};return l(t.program).defines.forEach((function(t){e[t.name]=r.enums2default[t.type]})),e}function f(t){for(var e=t.techniques.length,i=new Array(e),r=0;r<e;++r){for(var a=t.techniques[r],s=a.name||r,c=a.passes.length,l=new Array(c),f=0;f<c;++f){var d=a.passes[f],_=d.name||f,p=t.name+"-"+s+"-"+_,m=d.stage||"opaque",v=u(t,d),g=h(d),y=l[f]=new n.default(_,p,d.program,m,v,g);d.rasterizerState&&y.setCullMode(d.rasterizerState.cullMode);var T=d.blendState&&d.blendState.targets[0];T&&y.setBlend(T.blend,T.blendEq,T.blendSrc,T.blendDst,T.blendAlphaEq,T.blendSrcAlpha,T.blendDstAlpha,T.blendColor);var b=d.depthStencilState;b&&(y.setDepth(b.depthTest,b.depthWrite,b.depthFunc),y.setStencilFront(b.stencilTest,b.stencilFuncFront,b.stencilRefFront,b.stencilMaskFront,b.stencilFailOpFront,b.stencilZFailOpFront,b.stencilZPassOpFront,b.stencilWriteMaskFront),y.setStencilBack(b.stencilTest,b.stencilFuncBack,b.stencilRefBack,b.stencilMaskBack,b.stencilFailOpBack,b.stencilZFailOpBack,b.stencilZPassOpBack,b.stencilWriteMaskBack))}i[r]=new o.default(s,l)}return i}}),{"../../../renderer/core/pass":317,"../../../renderer/core/technique":319,"../../../renderer/enums":321,"../../../renderer/types":350,"./effect":115}],114:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=s(t("../../../renderer/murmurhash2_gc")),r=s(t("./utils")),a=s(t("./effect-base"));function s(t){return t&&t.__esModule?t:{default:t}}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}cc.gfx;var c=(function(t){var e,i,a,s;function c(e){var i;return(i=t.call(this)||this)._effect=void 0,i._passes=[],i._stagePasses={},i._hash=0,i.init(e),i}i=t,(e=c).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i,a=c,(s=[{key:"effect",get:function(){return this._effect}},{key:"name",get:function(){return this._effect&&this._effect.name+" (variant)"}},{key:"passes",get:function(){return this._passes}},{key:"stagePasses",get:function(){return this._stagePasses}}])&&o(a.prototype,s);var l=c.prototype;return l._onEffectChanged=function(){},l.init=function(t){if(t instanceof c&&(t=t.effect),this._effect=t,this._dirty=!0,t){var e=t.passes,i=this._passes;i.length=0;for(var n=this._stagePasses={},r=0;r<e.length;r++){var a=i[r]=Object.setPrototypeOf({},e[r]);a._properties=Object.setPrototypeOf({},e[r]._properties),a._defines=Object.setPrototypeOf({},e[r]._defines),n[a._stage]||(n[a._stage]=[]),n[a._stage].push(a)}}},l.updateHash=function(){},l.getHash=function(){if(!this._dirty)return this._hash;this._dirty=!1;var t="";t+=r.default.serializePasses(this._passes);var e=this._effect;return e&&(t+=r.default.serializePasses(e.passes)),this._hash=(0,n.default)(t,666),this.updateHash(this._hash),this._hash},c})(a.default);i.default=c,cc.EffectVariant=c,e.exports=i.default}),{"../../../renderer/murmurhash2_gc":344,"./effect-base":112,"./utils":119}],115:[(function(t,e,i){"use strict";var n;function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}i.__esModule=!0,i.default=void 0;var a=(function(t){var e,i,n,a;function s(e,i,n,r){var a;return(a=t.call(this)||this)._techniques=[],a._asset=null,a.init(e,i,n,r,!0),a}i=t,(e=s).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i,n=s,(a=[{key:"technique",get:function(){return this._technique}},{key:"passes",get:function(){return this._technique.passes}}])&&r(n.prototype,a);var o=s.prototype;return o.init=function(t,e,i,n){this._name=t,this._techniques=e,this._technique=e[i],this._asset=n},o.switchTechnique=function(t){t>=this._techniques.length?cc.warn("Can not switch to technique with index ["+t+"]"):this._technique=this._techniques[t]},o.clear=function(){this._techniques=[]},o.clone=function(){for(var t=[],e=0;e<this._techniques.length;e++)t.push(this._techniques[e].clone());var i=this._techniques.indexOf(this._technique);return new s(this._name,t,i,this._asset)},s})(((n=t("./effect-base"))&&n.__esModule?n:{default:n}).default);i.default=a,cc.Effect=a,e.exports=i.default}),{"./effect-base":112}],116:[(function(t){"use strict";t("./CCEffectAsset"),t("./CCMaterial"),t("./material-variant")}),{"./CCEffectAsset":110,"./CCMaterial":111,"./material-variant":118}],117:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=a(t("./utils")),r=a(t("../../utils/pool"));function a(t){return t&&t.__esModule?t:{default:t}}var s=new(function(t){var e,i;function r(){for(var e,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this).enabled=!1,e._pool={},e}i=t,(e=r).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var a=r.prototype;return a.get=function(t,e){var i,r=this._pool;if(t instanceof cc.MaterialVariant){if(!t._owner)return t._owner=e,t;if(t._owner===e)return t;t=t.material}if(this.enabled){var a=t.effectAsset._uuid;if(r[a]){var s=n.default.serializeDefines(t._effect._defines)+n.default.serializeTechniques(t._effect._techniques);i=r[a][s]&&r[a][s].pop()}}return i?this.count--:((i=new cc.MaterialVariant(t))._name=t._name+" (Instance)",i._uuid=t._uuid),i._owner=e,i},a.put=function(t){if(this.enabled&&t._owner){var e=this._pool,i=t.effectAsset._uuid;e[i]||(e[i]={});var r=n.default.serializeDefines(t._effect._defines)+n.default.serializeTechniques(t._effect._techniques);e[i][r]||(e[i][r]=[]),this.count>this.maxSize||(this._clean(t),e[i][r].push(t),this.count++)}},a.clear=function(){this._pool={},this.count=0},a._clean=function(t){t._owner=null},r}(r.default));r.default.register("material",s);var o=s;i.default=o,e.exports=i.default}),{"../../utils/pool":280,"./utils":119}],118:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=o(t("./CCMaterial")),a=o(t("./effect-variant")),s=o(t("./material-pool"));function o(t){return t&&t.__esModule?t:{default:t}}function c(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var l=(0,cc._decorator.ccclass)("cc.MaterialVariant")(n=(function(t){var e,i,n,o;function l(e){var i;return(i=t.call(this)||this)._owner=null,i._material=null,i.init(e),i}return i=t,(e=l).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i,l.createWithBuiltin=function(t,e){return l.create(r.default.getBuiltinMaterial(t),e)},l.create=function(t,e){return t?s.default.get(t,e):null},n=l,(o=[{key:"uuid",get:function(){return this._material.uuid}},{key:"owner",get:function(){return this._owner}},{key:"material",get:function(){return this._material}}])&&c(n.prototype,o),l.prototype.init=function(t){this._effect=new a.default(t.effect),this._effectAsset=t._effectAsset,this._material=t},l})(r.default))||n;i.default=l,cc.MaterialVariant=l,e.exports=i.default}),{"./CCMaterial":111,"./effect-variant":114,"./material-pool":117}],119:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=(n=t("../../../renderer/enums"))&&n.__esModule?n:{default:n};function a(t){var e="";for(var i in t)e+=i+t[i];return e}function s(t){var e="";for(var i in t){var n=t[i],a=n.value;a&&(n.type===r.default.PARAM_TEXTURE_2D||n.type===r.default.PARAM_TEXTURE_CUBE?e+=a._id+";":e+=a.toString()+";")}return e}var o={serializeDefines:a,serializePasses:function(t){for(var e,i,n="",r=0;r<t.length;r++)n+=(void 0,i=void 0,i=(e=t[r])._programName+e._cullMode,e._blend&&(i+=e._blendEq+e._blendAlphaEq+e._blendSrc+e._blendDst+e._blendSrcAlpha+e._blendDstAlpha+e._blendColor),e._depthTest&&(i+=e._depthWrite+e._depthFunc),e._stencilTest&&(i+=e._stencilFuncFront+e._stencilRefFront+e._stencilMaskFront+e._stencilFailOpFront+e._stencilZFailOpFront+e._stencilZPassOpFront+e._stencilWriteMaskFront+e._stencilFuncBack+e._stencilRefBack+e._stencilMaskBack+e._stencilFailOpBack+e._stencilZFailOpBack+e._stencilZPassOpBack+e._stencilWriteMaskBack),i+=s(e._properties),i+=a(e._defines));return n},serializeUniforms:s};i.default=o,e.exports=i.default}),{"../../../renderer/enums":321}],120:[(function(t,e){"use strict";t("../CCNode").EventType;var i=56,n=7,r=cc.Enum({ONCE:0,ON_WINDOW_RESIZE:1,ALWAYS:2});function a(t,e,i,n){for(var r=t._parent.scaleX,a=t._parent.scaleY,s=0,o=0,c=t._parent;;){if(s+=c.x,o+=c.y,!(c=c._parent))return i.x=i.y=0,void(n.x=n.y=1);if(c===e)break;var l=c.scaleX,u=c.scaleY;s*=l,o*=u,r*=l,a*=u}n.x=0!==r?1/r:1,n.y=0!==a?1/a:1,i.x=-s,i.y=-o}var s=cc.Vec2.ZERO,o=cc.Vec2.ONE;function c(t,e){var r,c,l,u=e._target;u?a(t,r=u,c=s,l=o):r=t._parent;var h,f=(h=r)instanceof cc.Scene?cc.visibleRect:h._contentSize,d=r._anchorPoint,_=r instanceof cc.Scene,p=t.x,m=t.y,v=t._anchorPoint;if(e._alignFlags&i){var g,y,T=f.width;_?(g=cc.visibleRect.left.x,y=cc.visibleRect.right.x):y=(g=-d.x*T)+T,g+=e._isAbsLeft?e._left:e._left*T,y-=e._isAbsRight?e._right:e._right*T,u&&(g+=c.x,g*=l.x,y+=c.x,y*=l.x);var b,E=v.x,A=t.scaleX;if(A<0&&(E=1-E,A=-A),e.isStretchWidth)b=y-g,0!==A&&(t.width=b/A),p=g+E*b;else if(b=t.width*A,e.isAlignHorizontalCenter){var C=e._isAbsHorizontalCenter?e._horizontalCenter:e._horizontalCenter*T,x=(.5-d.x)*f.width;u&&(C*=l.x,x+=c.x,x*=l.x),p=x+(E-.5)*b+C}else p=e.isAlignLeft?g+E*b:y+(E-1)*b}if(e._alignFlags&n){var S,w,M=f.height;_?(w=cc.visibleRect.bottom.y,S=cc.visibleRect.top.y):S=(w=-d.y*M)+M,w+=e._isAbsBottom?e._bottom:e._bottom*M,S-=e._isAbsTop?e._top:e._top*M,u&&(w+=c.y,w*=l.y,S+=c.y,S*=l.y);var R,I=v.y,O=t.scaleY;if(O<0&&(I=1-I,O=-O),e.isStretchHeight)R=S-w,0!==O&&(t.height=R/O),m=w+I*R;else if(R=t.height*O,e.isAlignVerticalCenter){var D=e._isAbsVerticalCenter?e._verticalCenter:e._verticalCenter*M,P=(.5-d.y)*f.height;u&&(D*=l.y,P+=c.y,P*=l.y),m=P+(I-.5)*R+D}else m=e.isAlignBottom?w+I*R:S+(I-1)*R}t.setPosition(p,m)}function l(t){var e=t._widget;e&&(c(t,e),e.alignMode!==r.ALWAYS?f.remove(e):h.push(e));for(var i=t._children,n=0;n<i.length;n++){var a=i[n];a._active&&l(a)}}function u(){var t=cc.director.getScene();if(t){if(f.isAligning=!0,f._nodesOrderDirty)h.length=0,l(t),f._nodesOrderDirty=!1;else{var e,i=f._activeWidgetsIterator;for(i.i=0;i.i<h.length;++i.i)c((e=h[i.i]).node,e)}f.isAligning=!1}}var h=[],f=cc._widgetManager=e.exports={_AlignFlags:{TOP:1,MID:2,BOT:4,LEFT:8,CENTER:16,RIGHT:32},isAligning:!1,_nodesOrderDirty:!1,_activeWidgetsIterator:new cc.js.array.MutableForwardIterator(h),init:function(t){t.on(cc.Director.EVENT_AFTER_UPDATE,u);var e=this.onResized.bind(this);cc.view.on("canvas-resize",e),window.addEventListener("orientationchange",e)},add:function(t){t.node._widget=t,this._nodesOrderDirty=!0},remove:function(t){t.node._widget=null,this._activeWidgetsIterator.remove(t)},onResized:function(){var t=cc.director.getScene();t&&this.refreshWidgetOnResized(t)},refreshWidgetOnResized:function(t){var e=cc.Node.isNode(t)&&t.getComponent(cc.Widget);e&&e.enabled&&e.alignMode===r.ON_WINDOW_RESIZE&&this.add(e);for(var i=t._children,n=0;n<i.length;n++){var a=i[n];this.refreshWidgetOnResized(a)}},updateAlignment:function t(e){var i=e._parent;cc.Node.isNode(i)&&t(i);var n=e._widget||e.getComponent(cc.Widget);n&&i&&c(e,n)},AlignMode:r}}),{"../CCNode":60}],121:[(function(t,e){"use strict";var i=t("../value-types"),n=t("../geom-utils"),r=t("../utils/affine-transform"),a=t("../renderer/index"),s=t("../renderer/render-flow"),o=t("../CCGame"),c=null;c=t("../../renderer/scene/camera");var l=cc.mat4(),u=cc.mat4(),h=cc.v3(),f=cc.v3(),d=cc.v3(),_=[];function p(){for(var t=0,e=Number.MAX_VALUE;t<_.length;t++){var i=_[t];i._depth<e&&(T.main=i,e=i._depth)}}var m=null;function v(){if(m){var t=m.getNode(),e=cc.game.canvas;t.z=e.height/1.1566,t.x=e.width/2,t.y=e.height/2}}var g=cc.Enum({COLOR:1,DEPTH:2,STENCIL:4}),y=cc.Enum({OPAQUE:1,TRANSPARENT:2}),T=cc.Class({name:"cc.Camera",extends:cc.Component,ctor:function(){if(o.renderType!==o.RENDER_TYPE_CANVAS){var t=new c;t.setStages(["opaque"]),t.dirty=!0,this._inited=!1,this._camera=t}else this._inited=!0},editor:!1,properties:{_cullingMask:4294967295,_clearFlags:g.DEPTH|g.STENCIL,_backgroundColor:cc.color(0,0,0,255),_depth:0,_zoomRatio:1,_targetTexture:null,_fov:60,_orthoSize:10,_nearClip:1,_farClip:4096,_ortho:!0,_rect:cc.rect(0,0,1,1),_renderStages:1,_alignWithScreen:!0,zoomRatio:{get:function(){return this._zoomRatio},set:function(t){this._zoomRatio=t},tooltip:!1},fov:{get:function(){return this._fov},set:function(t){this._fov=t},tooltip:!1},orthoSize:{get:function(){return this._orthoSize},set:function(t){this._orthoSize=t},tooltip:!1},nearClip:{get:function(){return this._nearClip},set:function(t){this._nearClip=t,this._updateClippingpPlanes()},tooltip:!1},farClip:{get:function(){return this._farClip},set:function(t){this._farClip=t,this._updateClippingpPlanes()},tooltip:!1},ortho:{get:function(){return this._ortho},set:function(t){this._ortho=t,this._updateProjection()},tooltip:!1},rect:{get:function(){return this._rect},set:function(t){this._rect=t,this._updateRect()},tooltip:!1},cullingMask:{get:function(){return this._cullingMask},set:function(t){this._cullingMask=t,this._updateCameraMask()},tooltip:!1},clearFlags:{get:function(){return this._clearFlags},set:function(t){this._clearFlags=t,this._camera&&this._camera.setClearFlags(t)},tooltip:!1},backgroundColor:{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor.equals(t)||(this._backgroundColor.set(t),this._updateBackgroundColor())},tooltip:!1},depth:{get:function(){return this._depth},set:function(t){T.main===this?this._depth<t&&p():T.main&&t<T.main._depth&&_.includes(this)&&(T.main=this),this._depth=t,this._camera&&this._camera.setPriority(t)},tooltip:!1},targetTexture:{get:function(){return this._targetTexture},set:function(t){this._targetTexture=t,this._updateTargetTexture()},tooltip:!1},renderStages:{get:function(){return this._renderStages},set:function(t){this._renderStages=t,this._updateStages()},tooltip:!1},alignWithScreen:{get:function(){return this._alignWithScreen},set:function(t){this._alignWithScreen=t}},_is3D:{get:function(){return this.node&&this.node._is3DNode}}},statics:{main:null,cameras:_,ClearFlags:g,findCamera:function(t){for(var e=0,i=_.length;e<i;e++){var n=_[e];if(n.containsNode(t))return n}return null},_findRendererCamera:function(t){for(var e=a.scene._cameras,i=0;i<e._count;i++)if(e._data[i]._cullingMask&t._cullingMask)return e._data[i];return null},_setupDebugCamera:function(){if(!m&&o.renderType!==o.RENDER_TYPE_CANVAS){var t=new c;m=t,t.setStages(["opaque"]),t.setFov(60*Math.PI/180),t.setNear(.1),t.setFar(4096),t.dirty=!0,t.cullingMask=1<<cc.Node.BuiltinGroupIndex.DEBUG,t.setPriority(cc.macro.MAX_ZINDEX),t.setClearFlags(0),t.setColor(0,0,0,0);var e=new cc.Node;t.setNode(e),v(),cc.view.on("design-resolution-changed",v),a.scene.addCamera(t)}}},_updateCameraMask:function(){if(this._camera){var t=this._cullingMask&~(1<<cc.Node.BuiltinGroupIndex.DEBUG);this._camera.cullingMask=t}},_updateBackgroundColor:function(){if(this._camera){var t=this._backgroundColor;this._camera.setColor(t.r/255,t.g/255,t.b/255,t.a/255)}},_updateTargetTexture:function(){if(this._camera){var t=this._targetTexture;this._camera.setFrameBuffer(t?t._framebuffer:null)}},_updateClippingpPlanes:function(){this._camera&&(this._camera.setNear(this._nearClip),this._camera.setFar(this._farClip))},_updateProjection:function(){if(this._camera){var t=this._ortho?1:0;this._camera.setType(t)}},_updateRect:function(){if(this._camera){var t=this._rect;this._camera.setRect(t.x,t.y,t.width,t.height)}},_updateStages:function(){var t=this._renderStages,e=[];t&y.OPAQUE&&e.push("opaque"),t&y.TRANSPARENT&&e.push("transparent"),this._camera.setStages(e)},_init:function(){if(!this._inited){this._inited=!0;var t=this._camera;t&&(t.setNode(this.node),t.setClearFlags(this._clearFlags),t.setPriority(this._depth),this._updateBackgroundColor(),this._updateCameraMask(),this._updateTargetTexture(),this._updateClippingpPlanes(),this._updateProjection(),this._updateStages(),this._updateRect(),this.beforeDraw())}},__preload:function(){this._init()},onEnable:function(){o.renderType!==o.RENDER_TYPE_CANVAS&&(cc.director.on(cc.Director.EVENT_BEFORE_DRAW,this.beforeDraw,this),a.scene.addCamera(this._camera)),_.push(this),(!T.main||this._depth<T.main._depth)&&(T.main=this)},onDisable:function(){o.renderType!==o.RENDER_TYPE_CANVAS&&(cc.director.off(cc.Director.EVENT_BEFORE_DRAW,this.beforeDraw,this),a.scene.removeCamera(this._camera)),cc.js.array.fastRemove(_,this),T.main===this&&(T.main=null,p())},getScreenToWorldMatrix2D:function(t){return this.getWorldToScreenMatrix2D(t),i.Mat4.invert(t,t),t},getWorldToScreenMatrix2D:function(t){this.node.getWorldRT(l);var e=this.zoomRatio,n=l.m;n[0]*=e,n[1]*=e,n[4]*=e,n[5]*=e;var r=n[12],a=n[13],s=cc.visibleRect.center;return n[12]=s.x-(n[0]*r+n[4]*a),n[13]=s.y-(n[1]*r+n[5]*a),t!==l&&i.Mat4.copy(t,l),t},getScreenToWorldPoint:function(t,e){return this.node.is3DNode?(e=e||new cc.Vec3,this._camera.screenToWorld(e,t,cc.visibleRect.width,cc.visibleRect.height)):(e=e||new cc.Vec2,this.getScreenToWorldMatrix2D(l),i.Vec2.transformMat4(e,t,l)),e},getWorldToScreenPoint:function(t,e){return this.node.is3DNode?(e=e||new cc.Vec3,this._camera.worldToScreen(e,t,cc.visibleRect.width,cc.visibleRect.height)):(e=e||new cc.Vec2,this.getWorldToScreenMatrix2D(l),i.Vec2.transformMat4(e,t,l)),e},getRay:function(t){return cc.geomUtils?(i.Vec3.set(d,t.x,t.y,1),this._camera.screenToWorld(f,d,cc.visibleRect.width,cc.visibleRect.height),this.ortho?(i.Vec3.set(d,t.x,t.y,-1),this._camera.screenToWorld(h,d,cc.visibleRect.width,cc.visibleRect.height)):this.node.getWorldPosition(h),n.Ray.fromPoints(new n.Ray,h,f)):t},containsNode:function(t){return(t._cullingMask&this.cullingMask)>0},render:function(t){if(!(t=t||cc.director.getScene()))return null;this.node.getWorldMatrix(l),this.beforeDraw(),s.renderCamera(this._camera,t)},_onAlignWithScreen:function(){var t=cc.game.canvas.height/cc.view._scaleY;this._targetTexture&&(t=cc.visibleRect.height);var e=this._fov*cc.macro.RAD;this.node.z=t/(2*Math.tan(e/2)),e=2*Math.atan(Math.tan(e/2)/this.zoomRatio),this._camera.setFov(e),this._camera.setOrthoHeight(t/2/this.zoomRatio),this.node.setRotation(0,0,0,1)},beforeDraw:function(){if(this._camera){if(this._alignWithScreen)this._onAlignWithScreen();else{var t=this._fov*cc.macro.RAD;t=2*Math.atan(Math.tan(t/2)/this.zoomRatio),this._camera.setFov(t),this._camera.setOrthoHeight(this._orthoSize/this.zoomRatio)}this._camera.dirty=!0}}});cc.js.mixin(T.prototype,{getNodeToCameraTransform:function(t){var e=r.identity();return t.getWorldMatrix(u),this.containsNode(t)&&(this.getWorldToCameraMatrix(l),i.Mat4.mul(u,u,l)),r.fromMat4(e,u),e},getCameraToWorldPoint:function(t,e){return this.getScreenToWorldPoint(t,e)},getWorldToCameraPoint:function(t,e){return this.getWorldToScreenPoint(t,e)},getCameraToWorldMatrix:function(t){return this.getScreenToWorldMatrix2D(t)},getWorldToCameraMatrix:function(t){return this.getWorldToScreenMatrix2D(t)}}),e.exports=cc.Camera=T}),{"../../renderer/scene/camera":346,"../CCGame":59,"../geom-utils":174,"../renderer/index":225,"../renderer/render-flow":226,"../utils/affine-transform":269,"../value-types":293}],122:[(function(t,e){"use strict";var i={};function n(t,e,i,n){var r=(n.x-i.x)*(t.y-i.y)-(n.y-i.y)*(t.x-i.x),a=(e.x-t.x)*(t.y-i.y)-(e.y-t.y)*(t.x-i.x),s=(n.y-i.y)*(e.x-t.x)-(n.x-i.x)*(e.y-t.y);if(0!==s){var o=r/s,c=a/s;if(0<=o&&o<=1&&0<=c&&c<=1)return!0}return!1}function r(t,e,i){for(var r=i.length,a=0;a<r;++a)if(n(t,e,i[a],i[(a+1)%r]))return!0;return!1}function a(t,e){for(var i=!1,n=t.x,r=t.y,a=e.length,s=0,o=a-1;s<a;o=s++){var c=e[s].x,l=e[s].y,u=e[o].x,h=e[o].y;l>r!=h>r&&n<(u-c)*(r-l)/(h-l)+c&&(i=!i)}return i}function s(t,e,i,n){var r,a=i.x-e.x,s=i.y-e.y,o=a*a+s*s,c=((t.x-e.x)*a+(t.y-e.y)*s)/o;return r=n?o?c<0?e:c>1?i:cc.v2(e.x+c*a,e.y+c*s):e:cc.v2(e.x+c*a,e.y+c*s),a=t.x-r.x,s=t.y-r.y,Math.sqrt(a*a+s*s)}i.lineLine=n,i.lineRect=function(t,e,i){var r=new cc.Vec2(i.x,i.y),a=new cc.Vec2(i.x,i.yMax),s=new cc.Vec2(i.xMax,i.yMax),o=new cc.Vec2(i.xMax,i.y);return!!(n(t,e,r,a)||n(t,e,a,s)||n(t,e,s,o)||n(t,e,o,r))},i.linePolygon=r,i.rectRect=function(t,e){var i=t.x,n=t.y,r=t.x+t.width,a=t.y+t.height,s=e.x,o=e.y,c=e.x+e.width,l=e.y+e.height;return i<=c&&r>=s&&n<=l&&a>=o},i.rectPolygon=function(t,e){var i,n,s=new cc.Vec2(t.x,t.y),o=new cc.Vec2(t.x,t.yMax),c=new cc.Vec2(t.xMax,t.yMax),l=new cc.Vec2(t.xMax,t.y);if(r(s,o,e))return!0;if(r(o,c,e))return!0;if(r(c,l,e))return!0;if(r(l,s,e))return!0;for(i=0,n=e.length;i<n;++i)if(a(e[i],t))return!0;return!!(a(s,e)||a(o,e)||a(c,e)||a(l,e))},i.polygonPolygon=function(t,e){var i,n;for(i=0,n=t.length;i<n;++i)if(r(t[i],t[(i+1)%n],e))return!0;for(i=0,n=e.length;i<n;++i)if(a(e[i],t))return!0;for(i=0,n=t.length;i<n;++i)if(a(t[i],e))return!0;return!1},i.circleCircle=function(t,e){return t.position.sub(e.position).mag()<t.radius+e.radius},i.polygonCircle=function(t,e){var i=e.position;if(a(i,t))return!0;for(var n=0,r=t.length;n<r;n++)if(s(i,0===n?t[t.length-1]:t[n-1],t[n],!0)<e.radius)return!0;return!1},i.pointInPolygon=a,i.pointLineDistance=s,cc.Intersection=e.exports=i}),{}],123:[(function(t,e){"use strict";t("./platform/CCClass");var i=t("./platform/CCObject").Flags,n=t("./platform/js").array,r=i.IsStartCalled,a=i.IsOnEnableCalled;function s(t,e){for(var i=e.constructor._executionOrder,n=e._id,r=0,a=t.length-1,s=a>>>1;r<=a;s=r+a>>>1){var o=t[s],c=o.constructor._executionOrder;if(c>i)a=s-1;else if(c<i)r=s+1;else{var l=o._id;if(l>n)a=s-1;else{if(!(l<n))return s;r=s+1}}}return~r}function o(t,e){for(var i=t.array,n=t.i+1;n<i.length;){var r=i[n];r._enabled&&r.node._activeInHierarchy?++n:(t.removeAt(n),e&&(r._objFlags&=~e))}}i.IsEditorOnEnableCalled;var c=cc.Class({__ctor__:function(t){var e=n.MutableForwardIterator;this._zero=new e([]),this._neg=new e([]),this._pos=new e([]),this._invoke=t},statics:{stableRemoveInactive:o},add:null,remove:null,invoke:null});function l(t,e){return t.constructor._executionOrder-e.constructor._executionOrder}var u=cc.Class({extends:c,add:function(t){var e=t.constructor._executionOrder;(0===e?this._zero:e<0?this._neg:this._pos).array.push(t)},remove:function(t){var e=t.constructor._executionOrder;(0===e?this._zero:e<0?this._neg:this._pos).fastRemove(t)},cancelInactive:function(t){o(this._zero,t),o(this._neg,t),o(this._pos,t)},invoke:function(){var t=this._neg;t.array.length>0&&(t.array.sort(l),this._invoke(t),t.array.length=0),this._invoke(this._zero),this._zero.array.length=0;var e=this._pos;e.array.length>0&&(e.array.sort(l),this._invoke(e),e.array.length=0)}}),h=cc.Class({extends:c,add:function(t){var e=t.constructor._executionOrder;if(0===e)this._zero.array.push(t);else{var i=e<0?this._neg.array:this._pos.array,n=s(i,t);n<0&&i.splice(~n,0,t)}},remove:function(t){var e=t.constructor._executionOrder;if(0===e)this._zero.fastRemove(t);else{var i=e<0?this._neg:this._pos,n=s(i.array,t);n>=0&&i.removeAt(n)}},invoke:function(t){this._neg.array.length>0&&this._invoke(this._neg,t),this._invoke(this._zero,t),this._pos.array.length>0&&this._invoke(this._pos,t)}});function f(t,e,i,n){return function(e,r){try{n(e,r)}catch(s){cc._throw(s);var a=e.array;for(i&&(a[e.i]._objFlags|=i),++e.i;e.i<a.length;++e.i)try{t(a[e.i],r)}catch(s){cc._throw(s),i&&(a[e.i]._objFlags|=i)}}}}var d=f((function(t){t.start(),t._objFlags|=r}),0,r,(function(t){var e=t.array;for(t.i=0;t.i<e.length;++t.i){var i=e[t.i];i.start(),i._objFlags|=r}})),_=f((function(t,e){t.update(e)}),0,void 0,(function(t,e){var i=t.array;for(t.i=0;t.i<i.length;++t.i)i[t.i].update(e)})),p=f((function(t,e){t.lateUpdate(e)}),0,void 0,(function(t,e){var i=t.array;for(t.i=0;t.i<i.length;++t.i)i[t.i].lateUpdate(e)}));function m(){this.startInvoker=new u(d),this.updateInvoker=new h(_),this.lateUpdateInvoker=new h(p),this._deferredComps=[],this._updating=!1}var v=cc.Class({ctor:m,unscheduleAll:m,statics:{LifeCycleInvoker:c,OneOffInvoker:u,createInvokeImpl:f,invokeOnEnable:function(t){var e=cc.director._compScheduler,i=t.array;for(t.i=0;t.i<i.length;++t.i){var n=i[t.i];n._enabled&&(n.onEnable(),!n.node._activeInHierarchy||e._onEnabled(n))}}},_onEnabled:function(t){cc.director.getScheduler().resumeTarget(t),t._objFlags|=a,this._updating?this._deferredComps.push(t):this._scheduleImmediate(t)},_onDisabled:function(t){cc.director.getScheduler().pauseTarget(t),t._objFlags&=~a;var e=this._deferredComps.indexOf(t);e>=0?n.fastRemoveAt(this._deferredComps,e):(!t.start||t._objFlags&r||this.startInvoker.remove(t),t.update&&this.updateInvoker.remove(t),t.lateUpdate&&this.lateUpdateInvoker.remove(t))},enableComp:function(t,e){if(!(t._objFlags&a)){if(t.onEnable){if(e)return void e.add(t);if(t.onEnable(),!t.node._activeInHierarchy)return}this._onEnabled(t)}},disableComp:function(t){t._objFlags&a&&(t.onDisable&&t.onDisable(),this._onDisabled(t))},_scheduleImmediate:function(t){"function"!=typeof t.start||t._objFlags&r||this.startInvoker.add(t),"function"==typeof t.update&&this.updateInvoker.add(t),"function"==typeof t.lateUpdate&&this.lateUpdateInvoker.add(t)},_deferredSchedule:function(){for(var t=this._deferredComps,e=0,i=t.length;e<i;e++)this._scheduleImmediate(t[e]);t.length=0},_startForNewComps:function(){this._deferredComps.length>0&&(this._deferredSchedule(),this.startInvoker.invoke())},startPhase:function(){this._updating=!0,this.startInvoker.invoke(),this._startForNewComps()},updatePhase:function(t){this.updateInvoker.invoke(t)},lateUpdatePhase:function(t){this.lateUpdateInvoker.invoke(t),this._updating=!1,this._startForNewComps()}});e.exports=v}),{"./platform/CCClass":193,"./platform/CCObject":199,"./platform/js":214,"./utils/misc":278}],124:[(function(t,e){"use strict";var i=t("../../animation/animation-animator"),n=t("../../animation/animation-clip"),r=t("../event/event-target"),a=t("../platform/js"),s=function(t,e){return t===e},o=cc.Enum({PLAY:"play",STOP:"stop",PAUSE:"pause",RESUME:"resume",LASTFRAME:"lastframe",FINISHED:"finished"}),c=cc.Class({name:"cc.Animation",extends:t("./CCComponent"),mixins:[r],editor:!1,statics:{EventType:o},ctor:function(){cc.EventTarget.call(this),this._animator=null,this._nameToState=a.createMap(!0),this._didInit=!1,this._currentClip=null},properties:{_defaultClip:{default:null,type:n},defaultClip:{type:n,get:function(){return this._defaultClip},set:function(){},tooltip:!1},currentClip:{get:function(){return this._currentClip},set:function(t){this._currentClip=t},type:n,visible:!1},_writableClips:{get:function(){return this._clips},set:function(t){this._didInit=!1,this._clips=t,this._init()},type:[n]},_clips:{default:[],type:[n],tooltip:!1,visible:!0},playOnLoad:{default:!1,tooltip:!1}},start:function(){if(this.playOnLoad&&this._defaultClip&&(!this._animator||!this._animator.isPlaying)){var t=this.getAnimationState(this._defaultClip.name);this._animator.playState(t)}},onEnable:function(){this._animator&&this._animator.resume()},onDisable:function(){this._animator&&this._animator.pause()},onDestroy:function(){this.stop()},getClips:function(){return this._clips},play:function(t,e){var i=this.playAdditive(t,e);return this._animator.stopStatesExcept(i),i},playAdditive:function(t,e){this._init();var i=this.getAnimationState(t||this._defaultClip&&this._defaultClip.name);if(i){this.enabled=!0;var n=this._animator;n.isPlaying&&i.isPlaying?i.isPaused?n.resumeState(i):(n.stopState(i),n.playState(i,e)):n.playState(i,e),this.enabledInHierarchy||n.pause(),this.currentClip=i.clip}return i},stop:function(t){if(this._didInit)if(t){var e=this._nameToState[t];e&&this._animator.stopState(e)}else this._animator.stop()},pause:function(t){if(this._didInit)if(t){var e=this._nameToState[t];e&&this._animator.pauseState(e)}else this.enabled=!1},resume:function(t){if(this._didInit)if(t){var e=this._nameToState[t];e&&this._animator.resumeState(e)}else this.enabled=!0},setCurrentTime:function(t,e){if(this._init(),e){var i=this._nameToState[e];i&&this._animator.setStateTime(i,t)}else this._animator.setStateTime(t)},getAnimationState:function(t){this._init();var e=this._nameToState[t];return e&&!e.curveLoaded&&this._animator._reloadClip(e),e||null},addClip:function(t,e){if(t){this._init(),cc.js.array.contains(this._clips,t)||this._clips.push(t),e=e||t.name;var i=this._nameToState[e];if(i){if(i.clip===t)return i;var n=this._clips.indexOf(i.clip);-1!==n&&this._clips.splice(n,1)}var r=new cc.AnimationState(t,e);return this._nameToState[e]=r,r}cc.warnID(3900)},removeClip:function(t,e){if(t){var i;for(var n in this._init(),this._nameToState)if(i=this._nameToState[n],s(i.clip,t))break;if(t===this._defaultClip){if(!e)return void cc.warnID(3902);this._defaultClip=null}if(i&&i.isPlaying){if(!e)return void cc.warnID(3903);this.stop(i.name)}this._clips=this._clips.filter((function(e){return!s(e,t)})),i&&delete this._nameToState[i.name]}else cc.warnID(3901)},sample:function(t){if(this._init(),t){var e=this._nameToState[t];e&&e.sample()}else this._animator.sample()},on:function(t,e,i,n){this._init();var r=this._EventTargetOn(t,e,i,n);if("lastframe"===t){var a=this._nameToState;for(var s in a)a[s]._lastframeEventOn=!0}return r},off:function(t,e,i,n){if(this._init(),"lastframe"===t){var r=this._nameToState;for(var a in r)r[a]._lastframeEventOn=!1}this._EventTargetOff(t,e,i,n)},_init:function(){this._didInit||(this._didInit=!0,this._animator=new i(this.node,this),this._createStates())},_createStates:function(){this._nameToState=a.createMap(!0);for(var t=null,e=!1,i=0;i<this._clips.length;++i){var n=this._clips[i];n&&(t=new cc.AnimationState(n),this._nameToState[t.name]=t,s(this._defaultClip,n)&&(e=t))}this._defaultClip&&!e&&(t=new cc.AnimationState(this._defaultClip),this._nameToState[t.name]=t)}});c.prototype._EventTargetOn=r.prototype.on,c.prototype._EventTargetOff=r.prototype.off,cc.Animation=e.exports=c}),{"../../animation/animation-animator":9,"../../animation/animation-clip":10,"../event/event-target":166,"../platform/js":214,"./CCComponent":129}],125:[(function(t,e){"use strict";var i=t("../utils/misc"),n=t("./CCComponent"),r=t("../assets/CCAudioClip"),a=cc.Class({name:"cc.AudioSource",extends:n,editor:!1,ctor:function(){this.audio=new cc._Audio},properties:{_clip:{default:null,type:r},_volume:1,_mute:!1,_loop:!1,_pausedFlag:{default:!1,serializable:!1},_firstlyEnabled:!0,isPlaying:{get:function(){return this.audio.getState()===cc._Audio.State.PLAYING},visible:!1},clip:{get:function(){return this._clip},set:function(t){if(t!==this._clip){if(!(t instanceof r))return cc.error("Wrong type of AudioClip.");this._clip=t,this.audio.stop(),this.audio.src=this._clip,this.preload&&this._clip._ensureLoaded()}},type:r,tooltip:!1,animatable:!1},volume:{get:function(){return this._volume},set:function(t){return t=i.clamp01(t),this._volume=t,this._mute||this.audio.setVolume(t),t},tooltip:!1},mute:{get:function(){return this._mute},set:function(t){return this._mute=t,this.audio.setVolume(t?0:this._volume),t},animatable:!1,tooltip:!1},loop:{get:function(){return this._loop},set:function(t){return this._loop=t,this.audio.setLoop(t),t},animatable:!1,tooltip:!1},playOnLoad:{default:!1,tooltip:!1,animatable:!1},preload:{default:!1,animatable:!1}},_pausedCallback:function(){this.audio.getState()===cc._Audio.State.PLAYING&&(this.audio.pause(),this._pausedFlag=!0)},_restoreCallback:function(){this._pausedFlag&&this.audio.resume(),this._pausedFlag=!1},onLoad:function(){this.audio.src||(this.audio.src=this._clip),this.preload&&this._clip._ensureLoaded()},onEnable:function(){this.playOnLoad&&this._firstlyEnabled&&(this._firstlyEnabled=!1,this.play()),cc.game.on(cc.game.EVENT_HIDE,this._pausedCallback,this),cc.game.on(cc.game.EVENT_SHOW,this._restoreCallback,this)},onDisable:function(){this.stop(),cc.game.off(cc.game.EVENT_HIDE,this._pausedCallback,this),cc.game.off(cc.game.EVENT_SHOW,this._restoreCallback,this)},onDestroy:function(){this.audio.destroy()},play:function(){if(this._clip){var t=this.audio;t.setVolume(this._mute?0:this._volume),t.setLoop(this._loop),t.setCurrentTime(0),t.play()}},stop:function(){this.audio.stop()},pause:function(){this.audio.pause()},resume:function(){this.audio.resume()},rewind:function(){this.audio.setCurrentTime(0)},getCurrentTime:function(){return this.audio.getCurrentTime()},setCurrentTime:function(t){return this.audio.setCurrentTime(t),t},getDuration:function(){return this.audio.getDuration()}});cc.AudioSource=e.exports=a}),{"../assets/CCAudioClip":94,"../utils/misc":278,"./CCComponent":129}],126:[(function(t,e){"use strict";var i=["touchstart","touchmove","touchend","mousedown","mousemove","mouseup","mouseenter","mouseleave","mousewheel"];function n(t){t.stopPropagation()}var r=cc.Class({name:"cc.BlockInputEvents",extends:t("./CCComponent"),editor:{menu:"i18n:MAIN_MENU.component.ui/Block Input Events",inspector:"packages://inspector/inspectors/comps/block-input-events.js",help:"i18n:COMPONENT.help_url.block_input_events"},onEnable:function(){for(var t=0;t<i.length;t++)this.node.on(i[t],n,this)},onDisable:function(){for(var t=0;t<i.length;t++)this.node.off(i[t],n,this)}});cc.BlockInputEvents=e.exports=r}),{"./CCComponent":129}],127:[(function(t,e){"use strict";var i=t("./CCComponent"),n=t("../utils/gray-sprite-state"),r=cc.Enum({NONE:0,COLOR:1,SPRITE:2,SCALE:3}),a=cc.Enum({NORMAL:0,HOVER:1,PRESSED:2,DISABLED:3}),s=cc.Class({name:"cc.Button",extends:i,mixins:[n],ctor:function(){this._pressed=!1,this._hovered=!1,this._fromColor=null,this._toColor=null,this._time=0,this._transitionFinished=!0,this._fromScale=cc.Vec2.ZERO,this._toScale=cc.Vec2.ZERO,this._originalScale=null,this._graySpriteMaterial=null,this._spriteMaterial=null,this._sprite=null},editor:!1,properties:{interactable:{default:!0,tooltip:!1,notify:function(){this._updateState(),this.interactable||this._resetState()},animatable:!1},_resizeToTarget:{animatable:!1,set:function(t){t&&this._resizeNodeToTargetNode()}},enableAutoGrayEffect:{default:!1,tooltip:!1,notify:function(){this._updateDisabledState(!0)}},transition:{default:r.NONE,tooltip:!1,type:r,animatable:!1,notify:function(t){this._updateTransition(t)},formerlySerializedAs:"transition"},normalColor:{default:cc.Color.WHITE,displayName:"Normal",tooltip:!1,notify:function(){this.transition===r.Color&&this._getButtonState()===a.NORMAL&&(this._getTarget().opacity=this.normalColor.a),this._updateState()}},pressedColor:{default:cc.color(211,211,211),displayName:"Pressed",tooltip:!1,notify:function(){this.transition===r.Color&&this._getButtonState()===a.PRESSED&&(this._getTarget().opacity=this.pressedColor.a),this._updateState()},formerlySerializedAs:"pressedColor"},hoverColor:{default:cc.Color.WHITE,displayName:"Hover",tooltip:!1,notify:function(){this.transition===r.Color&&this._getButtonState()===a.HOVER&&(this._getTarget().opacity=this.hoverColor.a),this._updateState()},formerlySerializedAs:"hoverColor"},disabledColor:{default:cc.color(124,124,124),displayName:"Disabled",tooltip:!1,notify:function(){this.transition===r.Color&&this._getButtonState()===a.DISABLED&&(this._getTarget().opacity=this.disabledColor.a),this._updateState()}},duration:{default:.1,range:[0,10],tooltip:!1},zoomScale:{default:1.2,tooltip:!1},normalSprite:{default:null,type:cc.SpriteFrame,displayName:"Normal",tooltip:!1,notify:function(){this._updateState()}},pressedSprite:{default:null,type:cc.SpriteFrame,displayName:"Pressed",tooltip:!1,formerlySerializedAs:"pressedSprite",notify:function(){this._updateState()}},hoverSprite:{default:null,type:cc.SpriteFrame,displayName:"Hover",tooltip:!1,formerlySerializedAs:"hoverSprite",notify:function(){this._updateState()}},disabledSprite:{default:null,type:cc.SpriteFrame,displayName:"Disabled",tooltip:!1,notify:function(){this._updateState()}},target:{default:null,type:cc.Node,tooltip:!1,notify:function(t){this._applyTarget(),t&&this.target!==t&&this._unregisterTargetEvent(t)}},clickEvents:{default:[],type:cc.Component.EventHandler,tooltip:!1}},statics:{Transition:r},__preload:function(){this._applyTarget(),this._resetState()},_resetState:function(){this._pressed=!1,this._hovered=!1;var t=this._getTarget(),e=this.transition,i=this._originalScale;e===r.COLOR&&this.interactable?this._setTargetColor(this.normalColor):e===r.SCALE&&i&&t.setScale(i.x,i.y),this._transitionFinished=!0},onEnable:function(){this.normalSprite&&this.normalSprite.ensureLoadTexture(),this.hoverSprite&&this.hoverSprite.ensureLoadTexture(),this.pressedSprite&&this.pressedSprite.ensureLoadTexture(),this.disabledSprite&&this.disabledSprite.ensureLoadTexture(),this._registerNodeEvent(),this._updateState()},onDisable:function(){this._resetState(),this._unregisterNodeEvent()},_getTarget:function(){return this.target?this.target:this.node},_onTargetSpriteFrameChanged:function(t){this.transition===r.SPRITE&&this._setCurrentStateSprite(t.spriteFrame)},_onTargetColorChanged:function(t){this.transition===r.COLOR&&this._setCurrentStateColor(t)},_onTargetScaleChanged:function(){var t=this._getTarget();this._originalScale&&(this.transition!==r.SCALE||this._transitionFinished)&&(this._originalScale.x=t.scaleX,this._originalScale.y=t.scaleY)},_setTargetColor:function(t){var e=this._getTarget(),i=t.clone();e.opacity=i.a,i.a=255,e.color=i},_getStateColor:function(t){switch(t){case a.NORMAL:return this.normalColor;case a.HOVER:return this.hoverColor;case a.PRESSED:return this.pressedColor;case a.DISABLED:return this.disabledColor}},_getStateSprite:function(t){switch(t){case a.NORMAL:return this.normalSprite;case a.HOVER:return this.hoverSprite;case a.PRESSED:return this.pressedSprite;case a.DISABLED:return this.disabledSprite}},_setCurrentStateColor:function(t){switch(this._getButtonState()){case a.NORMAL:this.normalColor=t;break;case a.HOVER:this.hoverColor=t;break;case a.PRESSED:this.pressedColor=t;break;case a.DISABLED:this.disabledColor=t}},_setCurrentStateSprite:function(t){switch(this._getButtonState()){case a.NORMAL:this.normalSprite=t;break;case a.HOVER:this.hoverSprite=t;break;case a.PRESSED:this.pressedSprite=t;break;case a.DISABLED:this.disabledSprite=t}},update:function(t){var e=this._getTarget();if(!this._transitionFinished&&(this.transition===r.COLOR||this.transition===r.SCALE)){this.time+=t;var i=1;if(this.duration>0&&(i=this.time/this.duration),i>=1&&(i=1),this.transition===r.COLOR){var n=this._fromColor.lerp(this._toColor,i);this._setTargetColor(n)}else this.transition===r.SCALE&&this._originalScale&&(e.scale=this._fromScale.lerp(this._toScale,i));1===i&&(this._transitionFinished=!0)}},_registerNodeEvent:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this),this.node.on(cc.Node.EventType.MOUSE_ENTER,this._onMouseMoveIn,this),this.node.on(cc.Node.EventType.MOUSE_LEAVE,this._onMouseMoveOut,this)},_unregisterNodeEvent:function(){this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancel,this),this.node.off(cc.Node.EventType.MOUSE_ENTER,this._onMouseMoveIn,this),this.node.off(cc.Node.EventType.MOUSE_LEAVE,this._onMouseMoveOut,this)},_registerTargetEvent:function(t){t.on(cc.Node.EventType.SCALE_CHANGED,this._onTargetScaleChanged,this)},_unregisterTargetEvent:function(t){t.off(cc.Node.EventType.SCALE_CHANGED,this._onTargetScaleChanged,this)},_getTargetSprite:function(t){var e=null;return t&&(e=t.getComponent(cc.Sprite)),e},_applyTarget:function(){var t=this._getTarget();this._sprite=this._getTargetSprite(t),this._originalScale||(this._originalScale=cc.Vec2.ZERO),this._originalScale.x=t.scaleX,this._originalScale.y=t.scaleY,this._registerTargetEvent(t)},_onTouchBegan:function(t){this.interactable&&this.enabledInHierarchy&&(this._pressed=!0,this._updateState(),t.stopPropagation())},_onTouchMove:function(t){if(this.interactable&&this.enabledInHierarchy&&this._pressed){var e,i=t.touch,n=this.node._hitTest(i.getLocation()),s=this._getTarget(),o=this._originalScale;this.transition===r.SCALE&&o?n?(this._fromScale.x=o.x,this._fromScale.y=o.y,this._toScale.x=o.x*this.zoomScale,this._toScale.y=o.y*this.zoomScale,this._transitionFinished=!1):(this.time=0,this._transitionFinished=!0,s.setScale(o.x,o.y)):(e=n?a.PRESSED:a.NORMAL,this._applyTransition(e)),t.stopPropagation()}},_onTouchEnded:function(t){this.interactable&&this.enabledInHierarchy&&(this._pressed&&(cc.Component.EventHandler.emitEvents(this.clickEvents,t),this.node.emit("click",this)),this._pressed=!1,this._updateState(),t.stopPropagation())},_onTouchCancel:function(){this.interactable&&this.enabledInHierarchy&&(this._pressed=!1,this._updateState())},_onMouseMoveIn:function(){!this._pressed&&this.interactable&&this.enabledInHierarchy&&(this.transition!==r.SPRITE||this.hoverSprite)&&(this._hovered||(this._hovered=!0,this._updateState()))},_onMouseMoveOut:function(){this._hovered&&(this._hovered=!1,this._updateState())},_updateState:function(){var t=this._getButtonState();this._applyTransition(t),this._updateDisabledState()},_getButtonState:function(){return this.interactable?this._pressed?a.PRESSED:this._hovered?a.HOVER:a.NORMAL:a.DISABLED},_updateColorTransitionImmediately:function(t){var e=this._getStateColor(t);this._setTargetColor(e),this._fromColor=e.clone(),this._toColor=e},_updateColorTransition:function(t){if(t===a.DISABLED)this._updateColorTransitionImmediately(t);else{var e=this._getTarget(),i=this._getStateColor(t);this._fromColor=e.color.clone(),this._toColor=i,this.time=0,this._transitionFinished=!1}},_updateSpriteTransition:function(t){var e=this._getStateSprite(t);this._sprite&&e&&(this._sprite.spriteFrame=e)},_updateScaleTransition:function(t){t===a.PRESSED?this._zoomUp():this._zoomBack()},_zoomUp:function(){this._originalScale&&(this._fromScale.x=this._originalScale.x,this._fromScale.y=this._originalScale.y,this._toScale.x=this._originalScale.x*this.zoomScale,this._toScale.y=this._originalScale.y*this.zoomScale,this.time=0,this._transitionFinished=!1)},_zoomBack:function(){if(this._originalScale){var t=this._getTarget();this._fromScale.x=t.scaleX,this._fromScale.y=t.scaleY,this._toScale.x=this._originalScale.x,this._toScale.y=this._originalScale.y,this.time=0,this._transitionFinished=!1}},_updateTransition:function(t){t===r.COLOR?this._updateColorTransitionImmediately(a.NORMAL):t===r.SPRITE&&this._updateSpriteTransition(a.NORMAL),this._updateState()},_applyTransition:function(t){var e=this.transition;e===r.COLOR?this._updateColorTransition(t):e===r.SPRITE?this._updateSpriteTransition(t):e===r.SCALE&&this._updateScaleTransition(t)},_resizeNodeToTargetNode:!1,_updateDisabledState:function(t){if(this._sprite&&(this.enableAutoGrayEffect||t)){var e=!1;this.transition===r.SPRITE&&this.disabledSprite||(e=this.enableAutoGrayEffect&&!this.interactable),this._switchGrayMaterial(e,this._sprite)}}});cc.Button=e.exports=s}),{"../utils/gray-sprite-state":275,"./CCComponent":129}],128:[(function(t,e){"use strict";var i=t("../camera/CCCamera"),n=t("./CCComponent"),r=cc.Class({name:"cc.Canvas",extends:n,editor:!1,resetInEditor:!1,statics:{instance:null},properties:{_designResolution:cc.size(960,640),designResolution:{get:function(){return cc.size(this._designResolution)},set:function(t){this._designResolution.width=t.width,this._designResolution.height=t.height,this.applySettings()},tooltip:!1},_fitWidth:!1,_fitHeight:!0,fitHeight:{get:function(){return this._fitHeight},set:function(t){this._fitHeight!==t&&(this._fitHeight=t,this.applySettings())},tooltip:!1},fitWidth:{get:function(){return this._fitWidth},set:function(t){this._fitWidth!==t&&(this._fitWidth=t,this.applySettings())},tooltip:!1}},_fitDesignResolution:!1,__preload:function(){if(r.instance)return cc.warnID(6700,this.node.name,r.instance.node.name);r.instance=this,this.applySettings();var t=this.getComponent(cc.Widget);t&&t.updateAlignment()},start:function(){if(!i.main&&cc.game.renderType!==cc.game.RENDER_TYPE_CANVAS){var t=new cc.Node("Main Camera");t.parent=this.node,t.setSiblingIndex(0);var e=t.addComponent(i),n=i.ClearFlags;e.clearFlags=n.COLOR|n.DEPTH|n.STENCIL,e.depth=-1}},onDestroy:function(){r.instance===this&&(r.instance=null)},applySettings:function(){var t,e=cc.ResolutionPolicy;t=this.fitHeight&&this.fitWidth?e.SHOW_ALL:this.fitHeight||this.fitWidth?this.fitWidth?e.FIXED_WIDTH:e.FIXED_HEIGHT:e.NO_BORDER;var i=this._designResolution;cc.view.setDesignResolutionSize(i.width,i.height,t)}});cc.Canvas=e.exports=r}),{"../camera/CCCamera":121,"./CCComponent":129}],129:[(function(t,e){"use strict";var i=t("../platform/CCObject"),n=t("../platform/js"),r=new(t("../platform/id-generater"))("Comp"),a=(i.Flags.IsOnEnableCalled,i.Flags.IsOnLoadCalled),s=!!cc.ActionManager,o=cc.Class({name:"cc.Component",extends:i,ctor:function(){this._id=r.getNewId(),this.__eventTargets=[]},properties:{node:{default:null,visible:!1},name:{get:function(){if(this._name)return this._name;var t=cc.js.getClassName(this),e=t.lastIndexOf(".");return e>=0&&(t=t.slice(e+1)),this.node.name+"<"+t+">"},set:function(t){this._name=t},visible:!1},uuid:{get:function(){return this._id},visible:!1},__scriptAsset:!1,_enabled:!0,enabled:{get:function(){return this._enabled},set:function(t){if(this._enabled!==t&&(this._enabled=t,this.node._activeInHierarchy)){var e=cc.director._compScheduler;t?e.enableComp(this):e.disableComp(this)}},visible:!1,animatable:!0},enabledInHierarchy:{get:function(){return this._enabled&&this.node._activeInHierarchy},visible:!1},_isOnLoadCalled:{get:function(){return this._objFlags&a}}},update:null,lateUpdate:null,__preload:null,onLoad:null,start:null,onEnable:null,onDisable:null,onDestroy:null,onFocusInEditor:null,onLostFocusInEditor:null,resetInEditor:null,addComponent:function(t){return this.node.addComponent(t)},getComponent:function(t){return this.node.getComponent(t)},getComponents:function(t){return this.node.getComponents(t)},getComponentInChildren:function(t){return this.node.getComponentInChildren(t)},getComponentsInChildren:function(t){return this.node.getComponentsInChildren(t)},_getLocalBounds:null,onRestore:null,destroy:function(){this._super()&&this._enabled&&this.node._activeInHierarchy&&cc.director._compScheduler.disableComp(this)},_onPreDestroy:function(){s&&cc.director.getActionManager().removeAllActionsFromTarget(this),this.unscheduleAllCallbacks();for(var t=this.__eventTargets,e=t.length-1;e>=0;--e){var i=t[e];i&&i.targetOff(this)}t.length=0,cc.director._nodeActivator.destroyComp(this),this.node._removeComponent(this)},_instantiate:function(t){return t||(t=cc.instantiate._clone(this,this)),t.node=null,t},schedule:function(t,e,i,n){cc.assertID(t,1619),e=e||0,cc.assertID(e>=0,1620),i=isNaN(i)?cc.macro.REPEAT_FOREVER:i,n=n||0;var r=cc.director.getScheduler(),a=r.isTargetPaused(this);r.schedule(t,this,e,i,n,a)},scheduleOnce:function(t,e){this.schedule(t,0,0,e)},unschedule:function(t){t&&cc.director.getScheduler().unschedule(t,this)},unscheduleAllCallbacks:function(){cc.director.getScheduler().unscheduleAllForTarget(this)}});o._requireComponent=null,o._executionOrder=0,n.value(o,"_registerEditorProps",(function(t,e){var i=e.requireComponent;i&&(t._requireComponent=i);var n=e.executionOrder;n&&"number"==typeof n&&(t._executionOrder=n)})),o.prototype.__scriptUuid="",cc.Component=e.exports=o}),{"../platform/CCObject":199,"../platform/id-generater":210,"../platform/js":214}],130:[(function(){"use strict";cc.Component.EventHandler=cc.Class({name:"cc.ClickEvent",properties:{target:{default:null,type:cc.Node},component:"",_componentId:"",_componentName:{get:function(){return this._genCompIdIfNeeded(),this._compId2Name(this._componentId)},set:function(t){this._componentId=this._compName2Id(t)}},handler:{default:""},customEventData:{default:""}},statics:{emitEvents:function(t){var e;if(arguments.length>0)for(var i=0,n=(e=new Array(arguments.length-1)).length;i<n;i++)e[i]=arguments[i+1];for(var r=0,a=t.length;r<a;r++){var s=t[r];s instanceof cc.Component.EventHandler&&s.emit(e)}}},emit:function(t){var e=this.target;if(cc.isValid(e)){this._genCompIdIfNeeded();var i=cc.js._getClassById(this._componentId),n=e.getComponent(i);if(cc.isValid(n)){var r=n[this.handler];"function"==typeof r&&(null!=this.customEventData&&""!==this.customEventData&&(t=t.slice()).push(this.customEventData),r.apply(n,t))}}},_compName2Id:function(t){var e=cc.js.getClassByName(t);return cc.js._getClassId(e)},_compId2Name:function(t){var e=cc.js._getClassById(t);return cc.js.getClassName(e)},_genCompIdIfNeeded:function(){this._componentId||(this._componentName=this.component,this.component="")}})}),{}],131:[(function(t,e){"use strict";var i=t("../platform/CCMacro"),n=t("./CCRenderComponent"),r=(t("../assets/material/CCMaterial"),t("../renderer/utils/label/label-frame")),a=t("../utils/blend-func"),s=t("../renderer/utils/utils").deleteFromDynamicAtlas,o=i.TextAlignment,c=i.VerticalTextAlignment,l=cc.Enum({NONE:0,CLAMP:1,SHRINK:2,RESIZE_HEIGHT:3}),u=cc.Enum({NONE:0,BITMAP:1,CHAR:2}),h=cc.Class({name:"cc.Label",extends:n,mixins:[a],ctor:function(){this._actualFontSize=0,this._assemblerData=null,this._frame=null,this._ttfTexture=null,this._letterTexture=null,cc.game.renderType===cc.game.RENDER_TYPE_CANVAS?this._updateMaterial=this._updateMaterialCanvas:this._updateMaterial=this._updateMaterialWebgl},editor:!1,properties:{_string:{default:"",formerlySerializedAs:"_N$string"},string:{get:function(){return this._string},set:function(t){var e=this._string;this._string=""+t,this.string!==e&&this.setVertsDirty(),this._checkStringEmpty()},multiline:!0,tooltip:!1},horizontalAlign:{default:o.LEFT,type:o,tooltip:!1,notify:function(t){this.horizontalAlign!==t&&this.setVertsDirty()},animatable:!1},verticalAlign:{default:c.TOP,type:c,tooltip:!1,notify:function(t){this.verticalAlign!==t&&this.setVertsDirty()},animatable:!1},actualFontSize:{displayName:"Actual Font Size",animatable:!1,readonly:!0,get:function(){return this._actualFontSize},tooltip:!1},_fontSize:40,fontSize:{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.setVertsDirty())},range:[0,512],tooltip:!1},fontFamily:{default:"Arial",tooltip:!1,notify:function(t){this.fontFamily!==t&&this.setVertsDirty()},animatable:!1},_lineHeight:40,lineHeight:{get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.setVertsDirty())},tooltip:!1},overflow:{default:l.NONE,type:l,tooltip:!1,notify:function(t){this.overflow!==t&&this.setVertsDirty()},animatable:!1},_enableWrapText:!0,enableWrapText:{get:function(){return this._enableWrapText},set:function(t){this._enableWrapText!==t&&(this._enableWrapText=t,this.setVertsDirty())},animatable:!1,tooltip:!1},_N$file:null,font:{get:function(){return this._N$file},set:function(t){this.font!==t&&(t||(this._isSystemFontUsed=!0),this._N$file=t,t&&this._isSystemFontUsed&&(this._isSystemFontUsed=!1),this.enabledInHierarchy&&this._forceUpdateRenderData())},type:cc.Font,tooltip:!1,animatable:!1},_isSystemFontUsed:!0,useSystemFont:{get:function(){return this._isSystemFontUsed},set:function(t){if(this._isSystemFontUsed!==t){if(this._isSystemFontUsed=!!t,t){if(this.font=null,!this.enabledInHierarchy)return;this._forceUpdateRenderData()}this.markForValidate()}},animatable:!1,tooltip:!1},_bmFontOriginalSize:{displayName:"BMFont Original Size",get:function(){return this._N$file instanceof cc.BitmapFont?this._N$file.fontSize:-1},visible:!0,animatable:!1},_spacingX:0,spacingX:{get:function(){return this._spacingX},set:function(t){this._spacingX=t,this.setVertsDirty()},tooltip:!1},_batchAsBitmap:!1,cacheMode:{default:u.NONE,type:u,tooltip:!1,notify:function(t){this.cacheMode!==t&&(t!==u.BITMAP||this.font instanceof cc.BitmapFont||this._frame&&this._frame._resetDynamicAtlasFrame(),t===u.CHAR&&(this._ttfTexture=null),this.enabledInHierarchy&&this._forceUpdateRenderData())},animatable:!1},_styleFlags:0,enableBold:{get:function(){return!!(1&this._styleFlags)},set:function(t){t?this._styleFlags|=1:this._styleFlags&=-2,this.setVertsDirty()},animatable:!1,tooltip:!1},enableItalic:{get:function(){return!!(2&this._styleFlags)},set:function(t){t?this._styleFlags|=2:this._styleFlags&=-3,this.setVertsDirty()},animatable:!1,tooltip:!1},enableUnderline:{get:function(){return!!(4&this._styleFlags)},set:function(t){t?this._styleFlags|=4:this._styleFlags&=-5,this.setVertsDirty()},animatable:!1,tooltip:!1},_underlineHeight:0,underlineHeight:{get:function(){return this._underlineHeight},set:function(t){this._underlineHeight!==t&&(this._underlineHeight=t,this.setVertsDirty())},tooltip:!1}},statics:{HorizontalAlign:o,VerticalAlign:c,Overflow:l,CacheMode:u,_shareAtlas:null,clearCharCache:function(){h._shareAtlas&&h._shareAtlas.clearAllCache()}},onLoad:function(){this._batchAsBitmap&&this.cacheMode===u.NONE&&(this.cacheMode=u.BITMAP,this._batchAsBitmap=!1),cc.game.renderType===cc.game.RENDER_TYPE_CANVAS&&(this.cacheMode=u.NONE)},onEnable:function(){this._super(),this.node.on(cc.Node.EventType.SIZE_CHANGED,this._nodeSizeChanged,this),this.node.on(cc.Node.EventType.ANCHOR_CHANGED,this.setVertsDirty,this),this.node.on(cc.Node.EventType.COLOR_CHANGED,this._nodeColorChanged,this),this._forceUpdateRenderData()},onDisable:function(){this._super(),this.node.off(cc.Node.EventType.SIZE_CHANGED,this._nodeSizeChanged,this),this.node.off(cc.Node.EventType.ANCHOR_CHANGED,this.setVertsDirty,this),this.node.off(cc.Node.EventType.COLOR_CHANGED,this._nodeColorChanged,this)},onDestroy:function(){this._assembler&&this._assembler._resetAssemblerData&&this._assembler._resetAssemblerData(this._assemblerData),this._assemblerData=null,this._letterTexture=null,this._ttfTexture&&(this._ttfTexture.destroy(),this._ttfTexture=null),this._super()},_nodeSizeChanged:function(){this.overflow!==l.NONE&&this.setVertsDirty()},_nodeColorChanged:function(){this.font instanceof cc.BitmapFont||this.setVertsDirty()},setVertsDirty:function(){this._super()},_updateColor:function(){this.font instanceof cc.BitmapFont||this._srcBlendFactor===cc.macro.BlendFactor.SRC_ALPHA&&this.node._renderFlag&cc.RenderFlow.FLAG_OPACITY||this.setVertsDirty(),n.prototype._updateColor.call(this)},_validateRender:function(){if(this.string){if(this._materials[0]){var t=this.font;if(!(t instanceof cc.BitmapFont))return;var e=t.spriteFrame;if(e&&e.textureLoaded()&&t._fntConfig)return}this.disableRender()}else this.disableRender()},_resetAssembler:function(){this._resetFrame(),n.prototype._resetAssembler.call(this)},_resetFrame:function(){this._frame&&(s(this,this._frame),this._frame=null)},_checkStringEmpty:function(){this.markForRender(!!this.string)},_on3DNodeChanged:function(){this._resetAssembler(),this._applyFontTexture()},_onBMFontTextureLoaded:function(){this._frame._texture=this.font.spriteFrame._texture,this.markForRender(!0),this._updateMaterial(),this._assembler&&this._assembler.updateRenderData(this)},_onBlendChanged:function(){this.useSystemFont&&this.enabledInHierarchy&&this._forceUpdateRenderData()},_applyFontTexture:function(){var t=this.font;if(t instanceof cc.BitmapFont){var e=t.spriteFrame;this._frame=e,e&&e.onTextureLoaded(this._onBMFontTextureLoaded,this)}else this._nativeTTF()||(this._frame||(this._frame=new r),this.cacheMode===u.CHAR?(this._letterTexture=this._assembler._getAssemblerData(),this._frame._refreshTexture(this._letterTexture)):this._ttfTexture||(this._ttfTexture=new cc.Texture2D,this._assemblerData=this._assembler._getAssemblerData(),this._ttfTexture.initWithElement(this._assemblerData.canvas)),this.cacheMode!==u.CHAR&&(this._frame._resetDynamicAtlasFrame(),this._frame._refreshTexture(this._ttfTexture),this._srcBlendFactor===cc.macro.BlendFactor.ONE&&this._ttfTexture.setPremultiplyAlpha(!0)),this._updateMaterial()),this._assembler&&this._assembler.updateRenderData(this);this.markForValidate()},_updateMaterialCanvas:function(){this._frame&&(this._frame._texture._nativeUrl=this.uuid+"_texture")},_updateMaterialWebgl:function(){var t=this.getMaterial(0);this._nativeTTF()?t&&this._assembler._updateTTFMaterial(this):this._frame&&(t&&t.setProperty("texture",this._frame._texture),a.prototype._updateMaterial.call(this))},_forceUseCanvas:!1,_useNativeTTF:function(){return cc.macro.ENABLE_NATIVE_TTF_RENDERER&&!this._forceUseCanvas},_nativeTTF:function(){return this._useNativeTTF()&&!!this._assembler&&!!this._assembler._updateTTFMaterial},_forceUpdateRenderData:function(){this.setVertsDirty(),this._resetAssembler(),this._applyFontTexture()},_enableBold:function(t){this.enableBold=!!t},_enableItalics:function(t){this.enableItalic=!!t},_enableUnderline:function(t){this.enableUnderline=!!t}});cc.Label=e.exports=h}),{"../assets/material/CCMaterial":111,"../platform/CCMacro":198,"../renderer/utils/label/label-frame":230,"../renderer/utils/utils":233,"../utils/blend-func":272,"./CCRenderComponent":140}],132:[(function(t,e){"use strict";var i=cc.Class({name:"cc.LabelOutline",extends:t("./CCComponent"),editor:!1,properties:{_color:cc.Color.WHITE,_width:1,color:{tooltip:!1,get:function(){return this._color.clone()},set:function(t){this._color.equals(t)||this._color.set(t),this._updateRenderData()}},width:{tooltip:!1,get:function(){return this._width},set:function(t){this._width!==t&&(this._width=t,this._updateRenderData())},range:[0,512]}},onEnable:function(){this._updateRenderData()},onDisable:function(){this._updateRenderData()},_updateRenderData:function(){var t=this.node.getComponent(cc.Label);t&&t.setVertsDirty()}});cc.LabelOutline=e.exports=i}),{"./CCComponent":129}],133:[(function(t,e){"use strict";var i=cc.Class({name:"cc.LabelShadow",extends:t("./CCComponent"),editor:!1,properties:{_color:cc.Color.WHITE,_offset:cc.v2(2,2),_blur:2,color:{tooltip:!1,get:function(){return this._color.clone()},set:function(t){this._color.equals(t)||this._color.set(t),this._updateRenderData()}},offset:{tooltip:!1,get:function(){return this._offset},set:function(t){this._offset=t,this._updateRenderData()}},blur:{tooltip:!1,get:function(){return this._blur},set:function(t){this._blur=t,this._updateRenderData()},range:[0,1024]}},onEnable:function(){this._updateRenderData()},onDisable:function(){this._updateRenderData()},_updateRenderData:function(){var t=this.node.getComponent(cc.Label);t&&t.markForRender(!0)}});cc.LabelShadow=e.exports=i}),{"./CCComponent":129}],134:[(function(t,e){"use strict";var i=t("../CCNode").EventType,n=cc.Enum({NONE:0,HORIZONTAL:1,VERTICAL:2,GRID:3}),r=cc.Enum({NONE:0,CONTAINER:1,CHILDREN:2}),a=cc.Enum({HORIZONTAL:0,VERTICAL:1}),s=cc.Enum({BOTTOM_TO_TOP:0,TOP_TO_BOTTOM:1}),o=cc.Enum({LEFT_TO_RIGHT:0,RIGHT_TO_LEFT:1}),c=cc.Class({name:"cc.Layout",extends:t("./CCComponent"),editor:!1,properties:{_layoutSize:cc.size(300,200),_layoutDirty:{default:!0,serializable:!1},_resize:r.NONE,_N$layoutType:n.NONE,type:{type:n,get:function(){return this._N$layoutType},set:function(t){this._N$layoutType=t,this._doLayoutDirty()},tooltip:!1,animatable:!1},resizeMode:{type:r,tooltip:!1,animatable:!1,get:function(){return this._resize},set:function(t){this.type===n.NONE&&t===r.CHILDREN||(this._resize=t,this._doLayoutDirty())}},cellSize:{default:cc.size(40,40),tooltip:!1,type:cc.Size,notify:function(){this._doLayoutDirty()}},startAxis:{default:a.HORIZONTAL,tooltip:!1,type:a,notify:function(){this._doLayoutDirty()},animatable:!1},paddingLeft:{default:0,tooltip:!1,notify:function(){this._doLayoutDirty()}},paddingRight:{default:0,tooltip:!1,notify:function(){this._doLayoutDirty()}},paddingTop:{default:0,tooltip:!1,notify:function(){this._doLayoutDirty()}},paddingBottom:{default:0,tooltip:!1,notify:function(){this._doLayoutDirty()}},spacingX:{default:0,notify:function(){this._doLayoutDirty()},tooltip:!1},spacingY:{default:0,notify:function(){this._doLayoutDirty()},tooltip:!1},verticalDirection:{default:s.TOP_TO_BOTTOM,type:s,notify:function(){this._doLayoutDirty()},tooltip:!1,animatable:!1},horizontalDirection:{default:o.LEFT_TO_RIGHT,type:o,notify:function(){this._doLayoutDirty()},tooltip:!1,animatable:!1},affectedByScale:{default:!1,notify:function(){this._doLayoutDirty()},animatable:!1,tooltip:!1}},statics:{Type:n,VerticalDirection:s,HorizontalDirection:o,ResizeMode:r,AxisDirection:a},onEnable:function(){this._addEventListeners(),this.node.getContentSize().equals(cc.size(0,0))&&this.node.setContentSize(this._layoutSize),this._doLayoutDirty()},onDisable:function(){this._removeEventListeners()},_doLayoutDirty:function(){this._layoutDirty=!0},_doScaleDirty:function(){this._layoutDirty=this._layoutDirty||this.affectedByScale},_addEventListeners:function(){cc.director.on(cc.Director.EVENT_AFTER_UPDATE,this.updateLayout,this),this.node.on(i.SIZE_CHANGED,this._resized,this),this.node.on(i.ANCHOR_CHANGED,this._doLayoutDirty,this),this.node.on(i.CHILD_ADDED,this._childAdded,this),this.node.on(i.CHILD_REMOVED,this._childRemoved,this),this.node.on(i.CHILD_REORDER,this._doLayoutDirty,this),this._addChildrenEventListeners()},_removeEventListeners:function(){cc.director.off(cc.Director.EVENT_AFTER_UPDATE,this.updateLayout,this),this.node.off(i.SIZE_CHANGED,this._resized,this),this.node.off(i.ANCHOR_CHANGED,this._doLayoutDirty,this),this.node.off(i.CHILD_ADDED,this._childAdded,this),this.node.off(i.CHILD_REMOVED,this._childRemoved,this),this.node.off(i.CHILD_REORDER,this._doLayoutDirty,this),this._removeChildrenEventListeners()},_addChildrenEventListeners:function(){for(var t=this.node.children,e=0;e<t.length;++e){var n=t[e];n.on(i.SCALE_CHANGED,this._doScaleDirty,this),n.on(i.SIZE_CHANGED,this._doLayoutDirty,this),n.on(i.POSITION_CHANGED,this._doLayoutDirty,this),n.on(i.ANCHOR_CHANGED,this._doLayoutDirty,this),n.on("active-in-hierarchy-changed",this._doLayoutDirty,this)}},_removeChildrenEventListeners:function(){for(var t=this.node.children,e=0;e<t.length;++e){var n=t[e];n.off(i.SCALE_CHANGED,this._doScaleDirty,this),n.off(i.SIZE_CHANGED,this._doLayoutDirty,this),n.off(i.POSITION_CHANGED,this._doLayoutDirty,this),n.off(i.ANCHOR_CHANGED,this._doLayoutDirty,this),n.off("active-in-hierarchy-changed",this._doLayoutDirty,this)}},_childAdded:function(t){t.on(i.SCALE_CHANGED,this._doScaleDirty,this),t.on(i.SIZE_CHANGED,this._doLayoutDirty,this),t.on(i.POSITION_CHANGED,this._doLayoutDirty,this),t.on(i.ANCHOR_CHANGED,this._doLayoutDirty,this),t.on("active-in-hierarchy-changed",this._doLayoutDirty,this),this._doLayoutDirty()},_childRemoved:function(t){t.off(i.SCALE_CHANGED,this._doScaleDirty,this),t.off(i.SIZE_CHANGED,this._doLayoutDirty,this),t.off(i.POSITION_CHANGED,this._doLayoutDirty,this),t.off(i.ANCHOR_CHANGED,this._doLayoutDirty,this),t.off("active-in-hierarchy-changed",this._doLayoutDirty,this),this._doLayoutDirty()},_resized:function(){this._layoutSize=this.node.getContentSize(),this._doLayoutDirty()},_doLayoutHorizontally:function(t,e,i,a){var c=this.node.getAnchorPoint(),l=this.node.children,u=1,h=this.paddingLeft,f=-c.x*t;this.horizontalDirection===o.RIGHT_TO_LEFT&&(u=-1,f=(1-c.x)*t,h=this.paddingRight);for(var d=f+u*h-u*this.spacingX,_=0,p=0,m=0,v=0,g=0,y=0,T=0,b=0;b<l.length;++b)(A=l[b]).activeInHierarchy&&T++;var E=this.cellSize.width;for(this.type!==n.GRID&&this.resizeMode===r.CHILDREN&&(E=(t-(this.paddingLeft+this.paddingRight)-(T-1)*this.spacingX)/T),b=0;b<l.length;++b){var A=l[b],C=this._getUsedScaleValue(A.scaleX),x=this._getUsedScaleValue(A.scaleY);if(A.activeInHierarchy){this._resize===r.CHILDREN&&(A.width=E/C,this.type===n.GRID&&(A.height=this.cellSize.height/x));var S=A.anchorX,w=A.width*C,M=A.height*x;m>p&&(p=m),M>=p&&(m=p,p=M,y=A.getAnchorPoint().y),this.horizontalDirection===o.RIGHT_TO_LEFT&&(S=1-A.anchorX),d=d+u*S*w+u*this.spacingX;var R=u*(1-S)*w;if(e){var I=d+R+u*(u>0?this.paddingRight:this.paddingLeft),O=this.horizontalDirection===o.LEFT_TO_RIGHT&&I>(1-c.x)*t,D=this.horizontalDirection===o.RIGHT_TO_LEFT&&I<-c.x*t;(O||D)&&(M>=p?(0===m&&(m=p),_+=m,m=p):(_+=p,m=M,p=0),d=f+u*(h+S*w),v++)}var P=i(A,_,v);t>=w+this.paddingLeft+this.paddingRight&&a&&A.setPosition(cc.v2(d,P));var L,N=1,F=0===p?M:p;this.verticalDirection===s.TOP_TO_BOTTOM?(g=g||this.node._contentSize.height,(L=P+(N=-1)*(F*y+this.paddingBottom))<g&&(g=L)):(g=g||-this.node._contentSize.height,(L=P+N*(F*y+this.paddingTop))>g&&(g=L)),d+=R}}return g},_getVerticalBaseHeight:function(t){var e=0,i=0;if(this.resizeMode===r.CONTAINER){for(var n=0;n<t.length;++n){var a=t[n];a.activeInHierarchy&&(i++,e+=a.height*this._getUsedScaleValue(a.scaleY))}e+=(i-1)*this.spacingY+this.paddingBottom+this.paddingTop}else e=this.node.getContentSize().height;return e},_doLayoutVertically:function(t,e,i,a){var c=this.node.getAnchorPoint(),l=this.node.children,u=1,h=this.paddingBottom,f=-c.y*t;this.verticalDirection===s.TOP_TO_BOTTOM&&(u=-1,f=(1-c.y)*t,h=this.paddingTop);for(var d=f+u*h-u*this.spacingY,_=0,p=0,m=0,v=0,g=0,y=0,T=0,b=0;b<l.length;++b)(A=l[b]).activeInHierarchy&&T++;var E=this.cellSize.height;for(this.type!==n.GRID&&this.resizeMode===r.CHILDREN&&(E=(t-(this.paddingTop+this.paddingBottom)-(T-1)*this.spacingY)/T),b=0;b<l.length;++b){var A=l[b],C=this._getUsedScaleValue(A.scaleX),x=this._getUsedScaleValue(A.scaleY);if(A.activeInHierarchy){this.resizeMode===r.CHILDREN&&(A.height=E/x,this.type===n.GRID&&(A.width=this.cellSize.width/C));var S=A.anchorY,w=A.width*C,M=A.height*x;m>p&&(p=m),w>=p&&(m=p,p=w,y=A.getAnchorPoint().x),this.verticalDirection===s.TOP_TO_BOTTOM&&(S=1-A.anchorY),d=d+u*S*M+u*this.spacingY;var R=u*(1-S)*M;if(e){var I=d+R+u*(u>0?this.paddingTop:this.paddingBottom),O=this.verticalDirection===s.BOTTOM_TO_TOP&&I>(1-c.y)*t,D=this.verticalDirection===s.TOP_TO_BOTTOM&&I<-c.y*t;(O||D)&&(w>=p?(0===m&&(m=p),_+=m,m=p):(_+=p,m=w,p=0),d=f+u*(h+S*M),v++)}var P=i(A,_,v);t>=M+(this.paddingTop+this.paddingBottom)&&a&&A.setPosition(cc.v2(P,d));var L,N=1,F=0===p?w:p;this.horizontalDirection===o.RIGHT_TO_LEFT?(N=-1,g=g||this.node._contentSize.width,(L=P+N*(F*y+this.paddingLeft))<g&&(g=L)):(g=g||-this.node._contentSize.width,(L=P+N*(F*y+this.paddingRight))>g&&(g=L)),d+=R}}return g},_doLayoutBasic:function(){for(var t=this.node.children,e=null,i=0;i<t.length;++i){var n=t[i];n.activeInHierarchy&&(e?e.union(e,n.getBoundingBoxToWorld()):e=n.getBoundingBoxToWorld())}if(e){var r=this.node.convertToNodeSpaceAR(cc.v2(e.x,e.y));r=cc.v2(r.x-this.paddingLeft,r.y-this.paddingBottom);var a=this.node.convertToNodeSpaceAR(cc.v2(e.xMax,e.yMax)),s=(a=cc.v2(a.x+this.paddingRight,a.y+this.paddingTop)).sub(r);if(0!==(s=cc.size(parseFloat(s.x.toFixed(2)),parseFloat(s.y.toFixed(2)))).width){var o=-r.x/s.width;this.node.anchorX=parseFloat(o.toFixed(2))}if(0!==s.height){var c=-r.y/s.height;this.node.anchorY=parseFloat(c.toFixed(2))}this.node.setContentSize(s)}},_doLayoutGridAxisHorizontal:function(t,e){var i=e.width,n=1,a=-t.y*e.height,o=this.paddingBottom;this.verticalDirection===s.TOP_TO_BOTTOM&&(n=-1,a=(1-t.y)*e.height,o=this.paddingTop);var c=function(t,e,i){return a+n*(e+t.anchorY*t.height*this._getUsedScaleValue(t.scaleY)+o+i*this.spacingY)}.bind(this),l=0;if(this.resizeMode===r.CONTAINER){var u=this._doLayoutHorizontally(i,!0,c,!1);(l=a-u)<0&&(l*=-1),a=-t.y*l,this.verticalDirection===s.TOP_TO_BOTTOM&&(n=-1,a=(1-t.y)*l)}this._doLayoutHorizontally(i,!0,c,!0),this.resizeMode===r.CONTAINER&&this.node.setContentSize(i,l)},_doLayoutGridAxisVertical:function(t,e){var i=e.height,n=1,a=-t.x*e.width,s=this.paddingLeft;this.horizontalDirection===o.RIGHT_TO_LEFT&&(n=-1,a=(1-t.x)*e.width,s=this.paddingRight);var c=function(t,e,i){return a+n*(e+t.anchorX*t.width*this._getUsedScaleValue(t.scaleX)+s+i*this.spacingX)}.bind(this),l=0;if(this.resizeMode===r.CONTAINER){var u=this._doLayoutVertically(i,!0,c,!1);(l=a-u)<0&&(l*=-1),a=-t.x*l,this.horizontalDirection===o.RIGHT_TO_LEFT&&(n=-1,a=(1-t.x)*l)}this._doLayoutVertically(i,!0,c,!0),this.resizeMode===r.CONTAINER&&this.node.setContentSize(l,i)},_doLayoutGrid:function(){var t=this.node.getAnchorPoint(),e=this.node.getContentSize();this.startAxis===a.HORIZONTAL?this._doLayoutGridAxisHorizontal(t,e):this.startAxis===a.VERTICAL&&this._doLayoutGridAxisVertical(t,e)},_getHorizontalBaseWidth:function(t){var e=0,i=0;if(this.resizeMode===r.CONTAINER){for(var n=0;n<t.length;++n){var a=t[n];a.activeInHierarchy&&(i++,e+=a.width*this._getUsedScaleValue(a.scaleX))}e+=(i-1)*this.spacingX+this.paddingLeft+this.paddingRight}else e=this.node.getContentSize().width;return e},_doLayout:function(){if(this.type===n.HORIZONTAL){var t=this._getHorizontalBaseWidth(this.node.children);this._doLayoutHorizontally(t,!1,(function(t){return t.y}),!0),this.node.width=t}else if(this.type===n.VERTICAL){var e=this._getVerticalBaseHeight(this.node.children);this._doLayoutVertically(e,!1,(function(t){return t.x}),!0),this.node.height=e}else this.type===n.NONE?this.resizeMode===r.CONTAINER&&this._doLayoutBasic():this.type===n.GRID&&this._doLayoutGrid()},_getUsedScaleValue:function(t){return this.affectedByScale?Math.abs(t):1},updateLayout:function(){this._layoutDirty&&this.node.children.length>0&&(this._doLayout(),this._layoutDirty=!1)}});cc.Layout=e.exports=c}),{"../CCNode":60,"./CCComponent":129}],135:[(function(t,e){"use strict";var i=s(t("../../renderer/gfx")),n=s(t("../value-types/mat4")),r=s(t("../value-types/vec2")),a=s(t("../assets/material/material-variant"));function s(t){return t&&t.__esModule?t:{default:t}}var o=t("../utils/misc"),c=t("./CCRenderComponent"),l=t("../renderer/render-flow"),u=t("../graphics/graphics"),h=new r.default,f=new n.default,d=[];function _(t,e,i){d.length=0;for(var n=2*Math.PI/i,r=0;r<i;++r)d.push(cc.v2(e.x*Math.cos(n*r)+t.x,e.y*Math.sin(n*r)+t.y));return d}var p=cc.Enum({RECT:0,ELLIPSE:1,IMAGE_STENCIL:2}),m=cc.Class({name:"cc.Mask",extends:c,editor:!1,ctor:function(){this._graphics=null,this._enableMaterial=null,this._exitMaterial=null,this._clearMaterial=null},properties:{_spriteFrame:{default:null,type:cc.SpriteFrame},_type:p.RECT,type:{get:function(){return this._type},set:function(t){this._type!==t&&this._resetAssembler(),this._type=t,this._type!==p.IMAGE_STENCIL&&(this.spriteFrame=null,this.alphaThreshold=0,this._updateGraphics()),this._activateMaterial()},type:p,tooltip:!1},spriteFrame:{type:cc.SpriteFrame,tooltip:!1,get:function(){return this._spriteFrame},set:function(t){this._spriteFrame!==t&&(this._spriteFrame=t,this.setVertsDirty(),this._updateMaterial())}},alphaThreshold:{default:.1,type:cc.Float,range:[0,1,.1],slide:!0,tooltip:!1,notify:function(){cc.game.renderType!==cc.game.RENDER_TYPE_CANVAS?this._updateMaterial():cc.warnID(4201)}},inverted:{default:!1,type:cc.Boolean,tooltip:!1,notify:function(){cc.game.renderType===cc.game.RENDER_TYPE_CANVAS&&cc.warnID(4202)}},_segments:64,segements:{get:function(){return this._segments},set:function(t){this._segments=o.clampf(t,3,1e4),this._updateGraphics()},type:cc.Integer,tooltip:!1},_resizeToTarget:{animatable:!1,set:function(t){t&&this._resizeNodeToTargetNode()}}},statics:{Type:p},onRestore:function(){this._activateMaterial()},onEnable:function(){this._super(),this._type!==p.IMAGE_STENCIL&&this._updateGraphics(),this.node.on(cc.Node.EventType.POSITION_CHANGED,this._updateGraphics,this),this.node.on(cc.Node.EventType.ROTATION_CHANGED,this._updateGraphics,this),this.node.on(cc.Node.EventType.SCALE_CHANGED,this._updateGraphics,this),this.node.on(cc.Node.EventType.SIZE_CHANGED,this._updateGraphics,this),this.node.on(cc.Node.EventType.ANCHOR_CHANGED,this._updateGraphics,this)},onDisable:function(){this._super(),this.node.off(cc.Node.EventType.POSITION_CHANGED,this._updateGraphics,this),this.node.off(cc.Node.EventType.ROTATION_CHANGED,this._updateGraphics,this),this.node.off(cc.Node.EventType.SCALE_CHANGED,this._updateGraphics,this),this.node.off(cc.Node.EventType.SIZE_CHANGED,this._updateGraphics,this),this.node.off(cc.Node.EventType.ANCHOR_CHANGED,this._updateGraphics,this),this.node._renderFlag&=~l.FLAG_POST_RENDER},onDestroy:function(){this._super(),this._removeGraphics()},_resizeNodeToTargetNode:!1,_validateRender:function(){if(this._type===p.IMAGE_STENCIL){var t=this._spriteFrame;t&&t.textureLoaded()||this.disableRender()}},_activateMaterial:function(){this._createGraphics();var t=this._materials[0];(t=t?a.default.create(t,this):a.default.createWithBuiltin("2d-sprite",this)).define("USE_ALPHA_TEST",!0),this._type===p.IMAGE_STENCIL?(t.define("CC_USE_MODEL",!1),t.define("USE_TEXTURE",!0)):(t.define("CC_USE_MODEL",!0),t.define("USE_TEXTURE",!1)),this._enableMaterial||(this._enableMaterial=a.default.createWithBuiltin("2d-sprite",this)),this._exitMaterial||(this._exitMaterial=a.default.createWithBuiltin("2d-sprite",this),this._exitMaterial.setStencilEnabled(i.default.STENCIL_DISABLE)),this._clearMaterial||(this._clearMaterial=a.default.createWithBuiltin("clear-stencil",this)),this.setMaterial(0,t),this._graphics._materials[0]=t,this._updateMaterial()},_updateMaterial:function(){var t=this._materials[0];if(t){if(this._type===p.IMAGE_STENCIL&&this.spriteFrame){var e=this.spriteFrame.getTexture();t.setProperty("texture",e)}t.setProperty("alphaThreshold",this.alphaThreshold)}},_createGraphics:function(){this._graphics||(this._graphics=new u,cc.Assembler.init(this._graphics),this._graphics.node=this.node,this._graphics.lineWidth=0,this._graphics.strokeColor=cc.color(0,0,0,0))},_updateGraphics:function(){var t=this.node,e=this._graphics;e.clear(!1);var i=t._contentSize.width,n=t._contentSize.height,r=-i*t._anchorPoint.x,a=-n*t._anchorPoint.y;if(this._type===p.RECT)e.rect(r,a,i,n);else if(this._type===p.ELLIPSE){for(var s=_(cc.v2(r+i/2,a+n/2),{x:i/2,y:n/2},this._segments),o=0;o<s.length;++o){var c=s[o];0===o?e.moveTo(c.x,c.y):e.lineTo(c.x,c.y)}e.close()}cc.game.renderType===cc.game.RENDER_TYPE_CANVAS?e.stroke():e.fill()},_removeGraphics:function(){this._graphics&&(this._graphics.destroy(),this._graphics._destroyImmediate(),this._graphics=null)},_hitTest:function(t){var e=this.node,i=e.getContentSize(),a=i.width,s=i.height,o=h;if(e._updateWorldMatrix(),!n.default.invert(f,e._worldMatrix))return!1;r.default.transformMat4(o,t,f),o.x+=e._anchorPoint.x*a,o.y+=e._anchorPoint.y*s;var c=!1;if(this.type===p.RECT||this.type===p.IMAGE_STENCIL)c=o.x>=0&&o.y>=0&&o.x<=a&&o.y<=s;else if(this.type===p.ELLIPSE){var l=a/2,u=s/2,d=o.x-.5*a,_=o.y-.5*s;c=d*d/(l*l)+_*_/(u*u)<1}return this.inverted&&(c=!c),c},markForRender:function(t){var e=l.FLAG_RENDER|l.FLAG_UPDATE_RENDER_DATA|l.FLAG_POST_RENDER;t?(this.node._renderFlag|=e,this.markForValidate()):t||(this.node._renderFlag&=~e)},disableRender:function(){this.node._renderFlag&=~(l.FLAG_RENDER|l.FLAG_UPDATE_RENDER_DATA|l.FLAG_POST_RENDER)}});cc.Mask=e.exports=m}),{"../../renderer/gfx":326,"../assets/material/material-variant":118,"../graphics/graphics":182,"../renderer/render-flow":226,"../utils/misc":278,"../value-types/mat4":295,"../value-types/vec2":302,"./CCRenderComponent":140}],136:[(function(t,e){"use strict";var i=t("../components/CCRenderComponent"),n=t("../../core/utils/blend-func"),r=cc.Class({name:"cc.MotionStreak",extends:i,mixins:[n],editor:!1,ctor:function(){this._points=[]},properties:{preview:{default:!1,editorOnly:!0,notify:!1,animatable:!1},_fadeTime:1,fadeTime:{get:function(){return this._fadeTime},set:function(t){this._fadeTime=t,this.reset()},animatable:!1,tooltip:!1},_minSeg:1,minSeg:{get:function(){return this._minSeg},set:function(t){this._minSeg=t},animatable:!1,tooltip:!1},_stroke:64,stroke:{get:function(){return this._stroke},set:function(t){this._stroke=t},animatable:!1,tooltip:!1},_texture:{default:null,type:cc.Texture2D},texture:{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture=t,this._updateMaterial())},type:cc.Texture2D,animatable:!1,tooltip:!1},_color:cc.Color.WHITE,color:{get:function(){return this._color.clone()},set:function(t){this._color.equals(t)||this._color.set(t)},type:cc.Color,tooltip:!1},_fastMode:!1,fastMode:{get:function(){return this._fastMode},set:function(t){this._fastMode=t},animatable:!1,tooltip:!1}},onEnable:function(){this._super(),this.reset()},_updateMaterial:function(){var t=this.getMaterial(0);t&&t.setProperty("texture",this._texture),n.prototype._updateMaterial.call(this)},onFocusInEditor:!1,onLostFocusInEditor:!1,reset:function(){this._points.length=0,this._assembler&&this._assembler._renderData.clear()},lateUpdate:function(t){this._assembler&&this._assembler.update(this,t)}});cc.MotionStreak=e.exports=r}),{"../../core/utils/blend-func":272,"../components/CCRenderComponent":140}],137:[(function(t,e){"use strict";var i=cc.Enum({Unified:0,Free:1}),n=cc.Enum({Horizontal:0,Vertical:1}),r=cc.Enum({PAGE_TURNING:0}),a=cc.Class({name:"cc.PageView",extends:cc.ScrollView,editor:!1,ctor:function(){this._curPageIdx=0,this._lastPageIdx=0,this._pages=[],this._initContentPos=cc.v2(),this._scrollCenterOffsetX=[],this._scrollCenterOffsetY=[]},properties:{sizeMode:{default:i.Unified,type:i,tooltip:!1,notify:function(){this._syncSizeMode()}},direction:{default:n.Horizontal,type:n,tooltip:!1,notify:function(){this._syncScrollDirection()}},scrollThreshold:{default:.5,type:cc.Float,slide:!0,range:[0,1,.01],tooltip:!1},autoPageTurningThreshold:{default:100,type:cc.Float,tooltip:!1},pageTurningEventTiming:{default:.1,type:cc.Float,range:[0,1,.01],tooltip:!1},indicator:{default:null,type:cc.PageViewIndicator,tooltip:!1,notify:function(){this.indicator&&this.indicator.setPageView(this)}},pageTurningSpeed:{default:.3,type:cc.Float,tooltip:!1},pageEvents:{default:[],type:cc.Component.EventHandler,tooltip:!1}},statics:{SizeMode:i,Direction:n,EventType:r},onEnable:function(){this._super(),this.node.on(cc.Node.EventType.SIZE_CHANGED,this._updateAllPagesSize,this),this.node.on("scroll-ended-with-threshold",this._dispatchPageTurningEvent,this)},onDisable:function(){this._super(),this.node.off(cc.Node.EventType.SIZE_CHANGED,this._updateAllPagesSize,this),this.node.off("scroll-ended-with-threshold",this._dispatchPageTurningEvent,this)},onLoad:function(){this._initPages(),this.indicator&&this.indicator.setPageView(this)},getCurrentPageIndex:function(){return this._curPageIdx},setCurrentPageIndex:function(t){this.scrollToPage(t,!0)},getPages:function(){return this._pages},addPage:function(t){t&&-1===this._pages.indexOf(t)&&this.content&&(this.content.addChild(t),this._pages.push(t),this._updatePageView())},insertPage:function(t,e){e<0||!t||-1!==this._pages.indexOf(t)||!this.content||(e>=this._pages.length?this.addPage(t):(this._pages.splice(e,0,t),this.content.addChild(t),this._updatePageView()))},removePage:function(t){if(t&&this.content){var e=this._pages.indexOf(t);-1!==e?this.removePageAtIndex(e):cc.warnID(4300,t.name)}},removePageAtIndex:function(t){var e=this._pages;if(!(t<0||t>=e.length)){var i=e[t];i&&(this.content.removeChild(i),e.splice(t,1),this._updatePageView())}},removeAllPages:function(){if(this.content){for(var t=this._pages,e=0,i=t.length;e<i;e++)this.content.removeChild(t[e]);this._pages.length=0,this._updatePageView()}},scrollToPage:function(t,e){t<0||t>=this._pages.length||(e=void 0!==e?e:.3,this._curPageIdx=t,this.scrollToOffset(this._moveOffsetValue(t),e,!0),this.indicator&&this.indicator._changedState())},getScrollEndedEventTiming:function(){return this.pageTurningEventTiming},_syncScrollDirection:function(){this.horizontal=this.direction===n.Horizontal,this.vertical=this.direction===n.Vertical},_syncSizeMode:function(){if(this.content){var t=this.content.getComponent(cc.Layout);if(t){if(this.sizeMode===i.Free&&this._pages.length>0){var e=this._pages[this._pages.length-1];this.direction===n.Horizontal?(t.paddingLeft=(this._view.width-this._pages[0].width)/2,t.paddingRight=(this._view.width-e.width)/2):this.direction===n.Vertical&&(t.paddingTop=(this._view.height-this._pages[0].height)/2,t.paddingBottom=(this._view.height-e.height)/2)}t.updateLayout()}}},_updatePageView:function(){var t=this.content.getComponent(cc.Layout);t&&t.enabled&&t.updateLayout();var e=this._pages.length;this._curPageIdx>=e&&(this._curPageIdx=0===e?0:e-1,this._lastPageIdx=this._curPageIdx);for(var i=this._initContentPos,r=0;r<e;++r){var a=this._pages[r];a.setSiblingIndex(r),this.direction===n.Horizontal?this._scrollCenterOffsetX[r]=Math.abs(i.x+a.x):this._scrollCenterOffsetY[r]=Math.abs(i.y+a.y)}this.indicator&&this.indicator._refresh()},_updateAllPagesSize:function(){if(this.sizeMode===i.Unified&&this._view)for(var t=this._pages,e=this._view.getContentSize(),n=0,r=t.length;n<r;n++)t[n].setContentSize(e)},_initPages:function(){if(this.content){this._initContentPos=this.content.position;for(var t=this.content.children,e=0;e<t.length;++e){var i=t[e];this._pages.indexOf(i)>=0||this._pages.push(i)}this._syncScrollDirection(),this._syncSizeMode(),this._updatePageView()}},_dispatchPageTurningEvent:function(){this._lastPageIdx!==this._curPageIdx&&(this._lastPageIdx=this._curPageIdx,cc.Component.EventHandler.emitEvents(this.pageEvents,this,r.PAGE_TURNING),this.node.emit("page-turning",this))},_isScrollable:function(t,e,r){if(this.sizeMode===i.Free){var a,s;if(this.direction===n.Horizontal)return a=this._scrollCenterOffsetX[e],s=this._scrollCenterOffsetX[r],Math.abs(t.x)>=Math.abs(a-s)*this.scrollThreshold;if(this.direction===n.Vertical)return a=this._scrollCenterOffsetY[e],s=this._scrollCenterOffsetY[r],Math.abs(t.y)>=Math.abs(a-s)*this.scrollThreshold}else{if(this.direction===n.Horizontal)return Math.abs(t.x)>=this._view.width*this.scrollThreshold;if(this.direction===n.Vertical)return Math.abs(t.y)>=this._view.height*this.scrollThreshold}},_isQuicklyScrollable:function(t){if(this.direction===n.Horizontal){if(Math.abs(t.x)>this.autoPageTurningThreshold)return!0}else if(this.direction===n.Vertical&&Math.abs(t.y)>this.autoPageTurningThreshold)return!0;return!1},_moveOffsetValue:function(t){var e=cc.v2(0,0);return this.sizeMode===i.Free?this.direction===n.Horizontal?e.x=this._scrollCenterOffsetX[t]:this.direction===n.Vertical&&(e.y=this._scrollCenterOffsetY[t]):this.direction===n.Horizontal?e.x=t*this._view.width:this.direction===n.Vertical&&(e.y=t*this._view.height),e},_getDragDirection:function(t){return this.direction===n.Horizontal?0===t.x?0:t.x>0?1:-1:this.direction===n.Vertical?0===t.y?0:t.y<0?1:-1:void 0},_handleReleaseLogic:function(){this._autoScrollToPage(),this._scrolling&&(this._scrolling=!1,this._autoScrolling||this._dispatchEvent("scroll-ended"))},_autoScrollToPage:function(){if(this._startBounceBackIfNeeded()){var t=this._getHowMuchOutOfBoundary();((t=this._clampDelta(t)).x>0||t.y<0)&&(this._curPageIdx=0===this._pages.length?0:this._pages.length-1),(t.x<0||t.y>0)&&(this._curPageIdx=0),this.indicator&&this.indicator._changedState()}else{var e=this._touchBeganPosition.sub(this._touchEndPosition),i=this._curPageIdx,n=i+this._getDragDirection(e),r=this.pageTurningSpeed*Math.abs(i-n);if(n<this._pages.length){if(this._isScrollable(e,i,n))return void this.scrollToPage(n,r);var a=this._calculateTouchMoveVelocity();if(this._isQuicklyScrollable(a))return void this.scrollToPage(n,r)}this.scrollToPage(i,r)}},_onTouchBegan:function(t,e){this._touchBeganPosition=t.touch.getLocation(),this._super(t,e)},_onTouchMoved:function(t,e){this._super(t,e)},_onTouchEnded:function(t,e){this._touchEndPosition=t.touch.getLocation(),this._super(t,e)},_onTouchCancelled:function(t,e){this._touchEndPosition=t.touch.getLocation(),this._super(t,e)},_onMouseWheel:function(){}});cc.PageView=e.exports=a}),{}],138:[(function(t,e){"use strict";var i=cc.Enum({HORIZONTAL:0,VERTICAL:1}),n=cc.Class({name:"cc.PageViewIndicator",extends:t("./CCComponent"),editor:!1,properties:{_layout:null,_pageView:null,_indicators:[],spriteFrame:{default:null,type:cc.SpriteFrame,tooltip:!1},direction:{default:i.HORIZONTAL,type:i,tooltip:!1},cellSize:{default:cc.size(20,20),tooltip:!1},spacing:{default:0,tooltip:!1}},statics:{Direction:i},onLoad:function(){this._updateLayout()},setPageView:function(t){this._pageView=t,this._refresh()},_updateLayout:function(){this._layout=this.getComponent(cc.Layout),this._layout||(this._layout=this.addComponent(cc.Layout)),this.direction===i.HORIZONTAL?(this._layout.type=cc.Layout.Type.HORIZONTAL,this._layout.spacingX=this.spacing):this.direction===i.VERTICAL&&(this._layout.type=cc.Layout.Type.VERTICAL,this._layout.spacingY=this.spacing),this._layout.resizeMode=cc.Layout.ResizeMode.CONTAINER},_createIndicator:function(){var t=new cc.Node,e=t.addComponent(cc.Sprite);return e.spriteFrame=this.spriteFrame,e.sizeMode=cc.Sprite.SizeMode.CUSTOM,t.parent=this.node,t.width=this.cellSize.width,t.height=this.cellSize.height,t},_changedState:function(){var t=this._indicators;if(0!==t.length){var e=this._pageView._curPageIdx;if(!(e>=t.length)){for(var i=0;i<t.length;++i)t[i].opacity=127.5;t[e].opacity=255}}},_refresh:function(){if(this._pageView){var t=this._indicators,e=this._pageView.getPages();if(e.length!==t.length){var i=0;if(e.length>t.length)for(i=0;i<e.length;++i)t[i]||(t[i]=this._createIndicator());else for(i=t.length-e.length;i>0;--i){var n=t[i-1];this.node.removeChild(n),t.splice(i-1,1)}this._layout&&this._layout.enabledInHierarchy&&this._layout.updateLayout(),this._changedState()}}}});cc.PageViewIndicator=e.exports=n}),{"./CCComponent":129}],139:[(function(t,e){"use strict";var i=t("../utils/misc"),n=t("./CCComponent"),r=cc.Enum({HORIZONTAL:0,VERTICAL:1,FILLED:2}),a=cc.Class({name:"cc.ProgressBar",extends:n,editor:!1,_initBarSprite:function(){if(this.barSprite){var t=this.barSprite.node;if(!t)return;var e=this.node.getContentSize(),i=this.node.getAnchorPoint(),n=t.getContentSize();t.parent===this.node&&this.node.setContentSize(n),this.barSprite.fillType===cc.Sprite.FillType.RADIAL&&(this.mode=r.FILLED);var a=t.getContentSize();if(this.mode===r.HORIZONTAL?this.totalLength=a.width:this.mode===r.VERTICAL?this.totalLength=a.height:this.totalLength=this.barSprite.fillRange,t.parent===this.node){var s=-e.width*i.x;t.setPosition(cc.v2(s,0))}}},_updateBarStatus:function(){if(this.barSprite){var t=this.barSprite.node;if(!t)return;var e,n,a,s=t.getAnchorPoint(),o=t.getContentSize(),c=t.getPosition(),l=cc.v2(0,.5),u=i.clamp01(this.progress),h=this.totalLength*u;switch(this.mode){case r.HORIZONTAL:this.reverse&&(l=cc.v2(1,.5)),e=cc.size(h,o.height),n=this.totalLength,a=o.height;break;case r.VERTICAL:l=this.reverse?cc.v2(.5,1):cc.v2(.5,0),e=cc.size(o.width,h),n=o.width,a=this.totalLength}if(this.mode===r.FILLED)this.barSprite.type!==cc.Sprite.Type.FILLED?cc.warn("ProgressBar FILLED mode only works when barSprite's Type is FILLED!"):(this.reverse&&(h*=-1),this.barSprite.fillRange=h);else if(this.barSprite.type!==cc.Sprite.Type.FILLED){var f=l.x-s.x,d=l.y-s.y,_=cc.v2(n*f,a*d);t.setPosition(c.x+_.x,c.y+_.y),t.setAnchorPoint(l),t.setContentSize(e)}else cc.warn("ProgressBar non-FILLED mode only works when barSprite's Type is non-FILLED!")}},properties:{barSprite:{default:null,type:cc.Sprite,tooltip:!1,notify:function(){this._initBarSprite()},animatable:!1},mode:{default:r.HORIZONTAL,type:r,tooltip:!1,notify:function(){if(this.barSprite){var t=this.barSprite.node;if(!t)return;var e=t.getContentSize();this.mode===r.HORIZONTAL?this.totalLength=e.width:this.mode===r.VERTICAL?this.totalLength=e.height:this.mode===r.FILLED&&(this.totalLength=this.barSprite.fillRange)}},animatable:!1},_N$totalLength:1,totalLength:{range:[0,Number.MAX_VALUE],tooltip:!1,get:function(){return this._N$totalLength},set:function(t){this.mode===r.FILLED&&(t=i.clamp01(t)),this._N$totalLength=t,this._updateBarStatus()}},progress:{default:1,type:cc.Float,range:[0,1,.1],slide:!0,tooltip:!1,notify:function(){this._updateBarStatus()}},reverse:{default:!1,tooltip:!1,notify:function(){this.barSprite&&(this.barSprite.fillStart=1-this.barSprite.fillStart),this._updateBarStatus()},animatable:!1}},statics:{Mode:r}});cc.ProgressBar=e.exports=a}),{"../utils/misc":278,"./CCComponent":129}],140:[(function(t,e){"use strict";var i=a(t("../renderer/assembler")),n=a(t("../assets/material/material-variant")),r=t("../value-types");function a(t){return t&&t.__esModule?t:{default:t}}var s=t("./CCComponent"),o=t("../renderer/render-flow"),c=t("../assets/material/CCMaterial"),l=new r.Color,u=cc.Class({name:"RenderComponent",extends:s,editor:!1,properties:{_materials:{default:[],type:c},materials:{get:function(){return this._materials},set:function(t){this._materials=t,this._activateMaterial()},type:[c],displayName:"Materials",animatable:!1}},ctor:function(){this._vertsDirty=!0,this._assembler=null},_resetAssembler:function(){i.default.init(this),this._updateColor(),this.setVertsDirty()},__preload:function(){this._resetAssembler(),this._activateMaterial()},onEnable:function(){this.node._renderComponent&&(this.node._renderComponent.enabled=!1),this.node._renderComponent=this,this.node._renderFlag|=o.FLAG_OPACITY_COLOR,this.setVertsDirty()},onDisable:function(){this.node._renderComponent=null,this.disableRender()},onDestroy:function(){for(var t=this._materials,e=0;e<t.length;e++)cc.pool.material.put(t[e]);t.length=0,cc.pool.assembler.put(this._assembler)},setVertsDirty:function(){this._vertsDirty=!0,this.markForRender(!0)},_on3DNodeChanged:function(){this._resetAssembler()},_validateRender:function(){},markForValidate:function(){cc.RenderFlow.registerValidate(this)},markForRender:function(t){var e=o.FLAG_RENDER|o.FLAG_UPDATE_RENDER_DATA;t?(this.node._renderFlag|=e,this.markForValidate()):this.node._renderFlag&=~e},disableRender:function(){this.node._renderFlag&=~(o.FLAG_RENDER|o.FLAG_UPDATE_RENDER_DATA)},getMaterial:function(t){if(t<0||t>=this._materials.length)return null;var e=this._materials[t];if(!e)return null;var i=n.default.create(e,this);return i!==e&&this.setMaterial(t,i),i},getMaterials:function(){for(var t=this._materials,e=0;e<t.length;e++)t[e]=n.default.create(t[e],this);return t},setMaterial:function(t,e){return e!==this._materials[t]&&(e=n.default.create(e,this),this._materials[t]=e),this._updateMaterial(),this.markForRender(!0),e},_getDefaultMaterial:function(){return c.getBuiltinMaterial("2d-sprite")},_activateMaterial:function(){var t=this._materials;if(!t[0]){var e=this._getDefaultMaterial();t[0]=e}for(var i=0;i<t.length;i++)t[i]=n.default.create(t[i],this);this._updateMaterial()},_updateMaterial:function(){},_updateColor:function(){if(this._assembler.updateColor){var t=this.srcBlendFactor===cc.macro.BlendFactor.ONE;t&&r.Color.premultiplyAlpha(l,this.node._color);var e=t?l._val:null;this._assembler.updateColor(this,e)}},_checkBacth:function(t,e){var i=this._materials[0];(i&&i.getHash()!==t.material.getHash()||t.cullingMask!==e)&&(t._flush(),t.node=i.getDefine("CC_USE_MODEL")?this.node:t._dummyNode,t.material=i,t.cullingMask=e)}});cc.RenderComponent=e.exports=u}),{"../assets/material/CCMaterial":111,"../assets/material/material-variant":118,"../renderer/assembler":222,"../renderer/render-flow":226,"../value-types":293,"./CCComponent":129}],141:[(function(t,e){"use strict";var i=t("../platform/js"),n=t("../platform/CCMacro"),r=t("../utils/text-utils"),a=new(t("../utils/html-text-parser")),s=n.TextAlignment,o=n.VerticalTextAlignment,c=cc.Label.CacheMode,l=new i.Pool(function(t){if(!cc.isValid(t))return!1;var e=t.getComponent(cc.LabelOutline);return e&&(e.width=0),!0},20);l.get=function(){var t=this._get();t||(t=new cc.PrivateNode("RICHTEXT_CHILD")),t.setPosition(0,0),t.setAnchorPoint(.5,.5),t.skewX=0;var e=t.getComponent(cc.Label);return e||(e=t.addComponent(cc.Label)),e.string="",e.horizontalAlign=s.LEFT,e.verticalAlign=o.CENTER,e._forceUseCanvas=!0,t};var u=cc.Class({name:"cc.RichText",extends:cc.Component,ctor:function(){this._textArray=null,this._labelSegments=[],this._labelSegmentsCache=[],this._linesWidth=[],this._updateRichTextStatus=this._updateRichText},editor:!1,properties:{string:{default:"<color=#00ff00>Rich</c><color=#0fffff>Text</color>",multiline:!0,tooltip:!1,notify:function(){this._updateRichTextStatus()}},horizontalAlign:{default:s.LEFT,type:s,tooltip:!1,animatable:!1,notify:function(t){this.horizontalAlign!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},fontSize:{default:40,tooltip:!1,notify:function(t){this.fontSize!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},_fontFamily:"Arial",fontFamily:{tooltip:!1,get:function(){return this._fontFamily},set:function(t){this._fontFamily!==t&&(this._fontFamily=t,this._layoutDirty=!0,this._updateRichTextStatus())},animatable:!1},font:{default:null,type:cc.TTFFont,tooltip:!1,notify:function(t){this.font!==t&&(this._layoutDirty=!0,this.font?(this.useSystemFont=!1,this._onTTFLoaded()):this.useSystemFont=!0,this._updateRichTextStatus())}},_isSystemFontUsed:!0,useSystemFont:{get:function(){return this._isSystemFontUsed},set:function(t){this._isSystemFontUsed!==t&&(this._isSystemFontUsed=t,this._layoutDirty=!0,this._updateRichTextStatus())},animatable:!1,tooltip:!1},cacheMode:{default:c.NONE,type:c,tooltip:!1,notify:function(t){this.cacheMode!==t&&this._updateRichTextStatus()},animatable:!1},maxWidth:{default:0,tooltip:!1,notify:function(t){this.maxWidth!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},lineHeight:{default:40,tooltip:!1,notify:function(t){this.lineHeight!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},imageAtlas:{default:null,type:cc.SpriteAtlas,tooltip:!1,notify:function(t){this.imageAtlas!==t&&(this._layoutDirty=!0,this._updateRichTextStatus())}},handleTouchEvent:{default:!0,tooltip:!1,notify:function(t){this.handleTouchEvent!==t&&this.enabledInHierarchy&&(this.handleTouchEvent?this._addEventListeners():this._removeEventListeners())}}},statics:{HorizontalAlign:s,VerticalAlign:o},onEnable:function(){this.handleTouchEvent&&this._addEventListeners(),this._updateRichText(),this._activateChildren(!0)},onDisable:function(){this.handleTouchEvent&&this._removeEventListeners(),this._activateChildren(!1)},start:function(){this._onTTFLoaded()},_onColorChanged:function(t){this.node.children.forEach((function(e){e.color=t}))},_addEventListeners:function(){this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(cc.Node.EventType.COLOR_CHANGED,this._onColorChanged,this)},_removeEventListeners:function(){this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.off(cc.Node.EventType.COLOR_CHANGED,this._onColorChanged,this)},_updateLabelSegmentTextAttributes:function(){this._labelSegments.forEach(function(t){this._applyTextAttribute(t,null,!0)}.bind(this))},_createFontLabel:function(t){return l.get(t,this)},_onTTFLoaded:function(){if(this.font instanceof cc.TTFFont)if(this.font._nativeAsset)this._layoutDirty=!0,this._updateRichText();else{var t=this;cc.assetManager.postLoadNative(this.font,(function(){t._layoutDirty=!0,t._updateRichText()}))}else this._layoutDirty=!0,this._updateRichText()},_measureText:function(t,e){var i=this,n=function(e){var n;return 0===i._labelSegmentsCache.length?(n=i._createFontLabel(e),i._labelSegmentsCache.push(n)):n=i._labelSegmentsCache[0],n._styleIndex=t,i._applyTextAttribute(n,e,!0),n.getContentSize().width};return e?n(e):n},_onTouchEnded:function(t){for(var e=this,i=this.node.getComponents(cc.Component),n=function(n){var r=e._labelSegments[n],a=r._clickHandler,s=r._clickParam;a&&e._containsTouchLocation(r,t.touch.getLocation())&&(i.forEach((function(e){e.enabledInHierarchy&&e[a]&&e[a](t,s)})),t.stopPropagation())},r=0;r<this._labelSegments.length;++r)n(r)},_containsTouchLocation:function(t,e){return t.getBoundingBoxToWorld().contains(e)},_resetState:function(){for(var t=this.node.children,e=t.length-1;e>=0;e--){var i=t[e];"RICHTEXT_CHILD"!==i.name&&"RICHTEXT_Image_CHILD"!==i.name||(i.parent===this.node?i.parent=null:t.splice(e,1),"RICHTEXT_CHILD"===i.name&&l.put(i))}this._labelSegments.length=0,this._labelSegmentsCache.length=0,this._linesWidth.length=0,this._lineOffsetX=0,this._lineCount=1,this._labelWidth=0,this._labelHeight=0,this._layoutDirty=!0},onRestore:!1,_activateChildren:function(t){for(var e=this.node.children.length-1;e>=0;e--){var i=this.node.children[e];"RICHTEXT_CHILD"!==i.name&&"RICHTEXT_Image_CHILD"!==i.name||(i.active=t)}},_addLabelSegment:function(t,e){var i;return(i=0===this._labelSegmentsCache.length?this._createFontLabel(t):this._labelSegmentsCache.pop())._styleIndex=e,i._lineCount=this._lineCount,i.active=this.node.active,i.setAnchorPoint(0,0),this._applyTextAttribute(i,t),this.node.addChild(i),this._labelSegments.push(i),i},_updateRichTextWithMaxWidth:function(t,e,i){var n=e;if(this._lineOffsetX>0&&n+this._lineOffsetX>this.maxWidth)for(var a=0;this._lineOffsetX<=this.maxWidth;){var s=this._getFirstWordLen(t,a,t.length),o=t.substr(a,s),c=this._measureText(i,o);if(!(this._lineOffsetX+c<=this.maxWidth)){if(a>0){var l=t.substr(0,a);this._addLabelSegment(l,i),t=t.substr(a,t.length),n=this._measureText(i,t)}this._updateLineInfo();break}this._lineOffsetX+=c,a+=s}if(n>this.maxWidth)for(var u=r.fragmentText(t,n,this.maxWidth,this._measureText(i)),h=0;h<u.length;++h){var f=u[h],d=this._addLabelSegment(f,i).getContentSize();this._lineOffsetX+=d.width,u.length>1&&h<u.length-1&&this._updateLineInfo()}else this._lineOffsetX+=n,this._addLabelSegment(t,i)},_isLastComponentCR:function(t){return t.length-1===t.lastIndexOf("\n")},_updateLineInfo:function(){this._linesWidth.push(this._lineOffsetX),this._lineOffsetX=0,this._lineCount++},_needsUpdateTextLayout:function(t){if(this._layoutDirty||!this._textArray||!t)return!0;if(this._textArray.length!==t.length)return!0;for(var e=0;e<this._textArray.length;++e){var i=this._textArray[e],n=t[e];if(i.text!==n.text)return!0;var r=i.style,a=n.style;if(r){if(a){if(!r.outline!=!a.outline)return!0;if(r.size!==a.size||!r.italic!=!a.italic||r.isImage!==a.isImage)return!0;if(r.src!==a.src||r.imageAlign!==a.imageAlign||r.imageHeight!==a.imageHeight||r.imageWidth!==a.imageWidth||r.imageOffset!==a.imageOffset)return!0}else if(r.size||r.italic||r.isImage||r.outline)return!0}else if(a&&(a.size||a.italic||a.isImage||a.outline))return!0}return!1},_addRichTextImageElement:function(t){var e=t.style.src,i=this.imageAtlas.getSpriteFrame(e);if(i){var n=new cc.PrivateNode("RICHTEXT_Image_CHILD"),r=n.addComponent(cc.Sprite);switch(t.style.imageAlign){case"top":n.setAnchorPoint(0,1);break;case"center":n.setAnchorPoint(0,.5);break;default:n.setAnchorPoint(0,0)}t.style.imageOffset&&(n._imageOffset=t.style.imageOffset),r.type=cc.Sprite.Type.SLICED,r.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.node.addChild(n),this._labelSegments.push(n);var a=i.getRect(),s=1,o=a.width,c=a.height,l=t.style.imageWidth,u=t.style.imageHeight;u>0?(o*=s=u/c,c*=s):(o*=s=this.lineHeight/c,c*=s),l>0&&(o=l),this.maxWidth>0?(this._lineOffsetX+o>this.maxWidth&&this._updateLineInfo(),this._lineOffsetX+=o):(this._lineOffsetX+=o,this._lineOffsetX>this._labelWidth&&(this._labelWidth=this._lineOffsetX)),r.spriteFrame=i,n.setContentSize(o,c),n._lineCount=this._lineCount,t.style.event?(t.style.event.click&&(n._clickHandler=t.style.event.click),t.style.event.param?n._clickParam=t.style.event.param:n._clickParam=""):n._clickHandler=null}else cc.warnID(4400)},_updateRichText:function(){if(this.enabledInHierarchy){var t=a.parse(this.string);if(!this._needsUpdateTextLayout(t))return this._textArray=t,void this._updateLabelSegmentTextAttributes();this._textArray=t,this._resetState();for(var e,i=!1,n=0;n<this._textArray.length;++n){var s=this._textArray[n],o=s.text;if(""===o){if(s.style&&s.style.newline){this._updateLineInfo();continue}if(s.style&&s.style.isImage&&this.imageAtlas){this._addRichTextImageElement(s);continue}}for(var c=o.split("\n"),l=0;l<c.length;++l){var u=c[l];if(""!==u)if(i=!1,this.maxWidth>0){var h=this._measureText(n,u);this._updateRichTextWithMaxWidth(u,h,n),c.length>1&&l<c.length-1&&this._updateLineInfo()}else e=this._addLabelSegment(u,n).getContentSize(),this._lineOffsetX+=e.width,this._lineOffsetX>this._labelWidth&&(this._labelWidth=this._lineOffsetX),c.length>1&&l<c.length-1&&this._updateLineInfo();else{if(this._isLastComponentCR(o)&&l===c.length-1)continue;this._updateLineInfo(),i=!0}}}i||this._linesWidth.push(this._lineOffsetX),this.maxWidth>0&&(this._labelWidth=this.maxWidth),this._labelHeight=(this._lineCount+r.BASELINE_RATIO)*this.lineHeight,this.node.setContentSize(this._labelWidth,this._labelHeight),this._updateRichTextPosition(),this._layoutDirty=!1}},_getFirstWordLen:function(t,e,i){var n=t.charAt(e);if(r.isUnicodeCJK(n)||r.isUnicodeSpace(n))return 1;for(var a=1,s=e+1;s<i&&(n=t.charAt(s),!r.isUnicodeSpace(n)&&!r.isUnicodeCJK(n));++s)a++;return a},_updateRichTextPosition:function(){for(var t=0,e=1,i=this._lineCount,n=0;n<this._labelSegments.length;++n){var a=this._labelSegments[n],o=a._lineCount;o>e&&(t=0,e=o);var c=0;switch(this.horizontalAlign){case s.LEFT:c=-this._labelWidth/2;break;case s.CENTER:c=-this._linesWidth[o-1]/2;break;case s.RIGHT:c=this._labelWidth/2-this._linesWidth[o-1]}a.x=t+c;var l=a.getContentSize();if(a.y=this.lineHeight*(i-o)-this._labelHeight/2,o===e&&(t+=l.width),a.getComponent(cc.Sprite)){var u=this.lineHeight,h=this.lineHeight*(1+r.BASELINE_RATIO);switch(a.anchorY){case 1:a.y+=u+(h-u)/2;break;case.5:a.y+=h/2;break;default:a.y+=(h-u)/2}if(a._imageOffset){var f=a._imageOffset.split(",");if(1===f.length&&f[0]){var d=parseFloat(f[0]);Number.isInteger(d)&&(a.y+=d)}else if(2===f.length){var _=parseFloat(f[0]),p=parseFloat(f[1]);Number.isInteger(_)&&(a.x+=_),Number.isInteger(p)&&(a.y+=p)}}}var m=a.getComponent(cc.LabelOutline);m&&m.width&&(a.y=a.y-m.width)}},_convertLiteralColorValue:function(t){var e=t.toUpperCase();return cc.Color[e]?cc.Color[e]:cc.color().fromHEX(t)},_applyTextAttribute:function(t,e,i){var n=t.getComponent(cc.Label);if(n){var r=t._styleIndex,a=null;if(this._textArray[r]&&(a=this._textArray[r].style),a&&a.color?t.color=this._convertLiteralColorValue(a.color):t.color=this.node.color,n.cacheMode=this.cacheMode,this.font instanceof cc.Font&&!this._isSystemFontUsed?n.font=this.font:n.fontFamily=this.fontFamily,n.useSystemFont=this._isSystemFontUsed,n.lineHeight=this.lineHeight,n.enableBold=a&&a.bold,n.enableItalics=a&&a.italic,a&&a.italic&&(t.skewX=12),n.enableUnderline=a&&a.underline,a&&a.outline){var s=t.getComponent(cc.LabelOutline);s||(s=t.addComponent(cc.LabelOutline)),s.color=this._convertLiteralColorValue(a.outline.color),s.width=a.outline.width}a&&a.size?n.fontSize=a.size:n.fontSize=this.fontSize,null!==e&&("string"!=typeof e&&(e=""+e),n.string=e),i&&n._forceUpdateRenderData(),a&&a.event?(a.event.click&&(t._clickHandler=a.event.click),a.event.param?t._clickParam=a.event.param:t._clickParam=""):t._clickHandler=null}},onDestroy:function(){for(var t=0;t<this._labelSegments.length;++t)this._labelSegments[t].removeFromParent(),l.put(this._labelSegments[t])}});cc.RichText=e.exports=u}),{"../platform/CCMacro":198,"../platform/js":214,"../utils/html-text-parser":276,"../utils/text-utils":285}],142:[(function(t,e){"use strict";var i=t("./CCWidget"),n=t("../base-ui/CCWidgetManager"),r=cc.Class({name:"cc.SafeArea",extends:t("./CCComponent"),editor:!1,onEnable:function(){this.updateArea(),cc.view.on("canvas-resize",this.updateArea,this)},onDisable:function(){cc.view.off("canvas-resize",this.updateArea,this)},updateArea:function(){var t=this.node.getComponent(i);if(t){t.updateAlignment();var e=this.node.position,r=this.node.getAnchorPoint();t.isAlignTop=t.isAlignBottom=t.isAlignLeft=t.isAlignRight=!0;var a=cc.winSize.width,s=cc.winSize.height,o=cc.sys.getSafeAreaRect();t.top=s-o.y-o.height,t.bottom=o.y,t.left=o.x,t.right=a-o.x-o.width,t.updateAlignment();var c=this.node.position,l=r.x-(c.x-e.x)/this.node.width,u=r.y-(c.y-e.y)/this.node.height;this.node.setAnchorPoint(l,u),n.add(t)}}});cc.SafeArea=e.exports=r}),{"../base-ui/CCWidgetManager":120,"./CCComponent":129,"./CCWidget":151}],143:[(function(t,e){"use strict";var i=t("../utils/misc"),n=(t("./CCComponent"),cc.Enum({HORIZONTAL:0,VERTICAL:1})),r=cc.Class({name:"cc.Scrollbar",extends:t("./CCComponent"),editor:!1,properties:{_scrollView:null,_touching:!1,_autoHideRemainingTime:{default:0,serializable:!1},_opacity:255,handle:{default:null,type:cc.Sprite,tooltip:!1,notify:function(){this._onScroll(cc.v2(0,0))},animatable:!1},direction:{default:n.HORIZONTAL,type:n,tooltip:!1,notify:function(){this._onScroll(cc.v2(0,0))},animatable:!1},enableAutoHide:{default:!0,animatable:!1,tooltip:!1},autoHideTime:{default:1,animatable:!1,tooltip:!1}},statics:{Direction:n},setTargetScrollView:function(t){this._scrollView=t},_convertToScrollViewSpace:function(t){var e=this._scrollView.node,i=t.convertToWorldSpaceAR(cc.v2(-t.anchorX*t.width,-t.anchorY*t.height)),n=e.convertToNodeSpaceAR(i);return n.x+=e.anchorX*e.width,n.y+=e.anchorY*e.height,n},_setOpacity:function(t){this.handle&&(this.node.opacity=t,this.handle.node.opacity=t)},_onScroll:function(t){if(this._scrollView){var e=this._scrollView.content;if(e){var i=e.getContentSize(),r=this._scrollView.node.getContentSize(),a=this.node.getContentSize();if(this._conditionalDisableScrollBar(i,r))return;this.enableAutoHide&&(this._autoHideRemainingTime=this.autoHideTime,this._setOpacity(this._opacity));var s=0,o=0,c=0,l=0,u=0;this.direction===n.HORIZONTAL?(s=i.width,o=r.width,u=a.width,c=t.x,l=-this._convertToScrollViewSpace(e).x):this.direction===n.VERTICAL&&(s=i.height,o=r.height,u=a.height,c=t.y,l=-this._convertToScrollViewSpace(e).y);var h=this._calculateLength(s,o,u,c),f=this._calculatePosition(s,o,u,l,c,h);this._updateLength(h),this._updateHanlderPosition(f)}}},_updateHanlderPosition:function(t){if(this.handle){var e=this._fixupHandlerPosition();this.handle.node.setPosition(t.x+e.x,t.y+e.y)}},_fixupHandlerPosition:function(){var t=this.node.getContentSize(),e=this.node.getAnchorPoint(),i=this.handle.node.getContentSize(),r=this.handle.node.parent,a=this.node.convertToWorldSpaceAR(cc.v2(-t.width*e.x,-t.height*e.y)),s=r.convertToNodeSpaceAR(a);return this.direction===n.HORIZONTAL?s=cc.v2(s.x,s.y+(t.height-i.height)/2):this.direction===n.VERTICAL&&(s=cc.v2(s.x+(t.width-i.width)/2,s.y)),this.handle.node.setPosition(s),s},_onTouchBegan:function(){this.enableAutoHide&&(this._touching=!0)},_conditionalDisableScrollBar:function(t,e){return t.width<=e.width&&this.direction===n.HORIZONTAL||t.height<=e.height&&this.direction===n.VERTICAL},_onTouchEnded:function(){if(this.enableAutoHide&&(this._touching=!1,!(this.autoHideTime<=0))){if(this._scrollView){var t=this._scrollView.content;if(t){var e=t.getContentSize(),i=this._scrollView.node.getContentSize();if(this._conditionalDisableScrollBar(e,i))return}}this._autoHideRemainingTime=this.autoHideTime}},_calculateLength:function(t,e,i,n){var r=t;return n&&(r+=20*(n>0?n:-n)),i*(e/r)},_calculatePosition:function(t,e,r,a,s,o){var c=t-e;s&&(c+=Math.abs(s));var l=0;c&&(l=a/c,l=i.clamp01(l));var u=(r-o)*l;return this.direction===n.VERTICAL?cc.v2(0,u):cc.v2(u,0)},_updateLength:function(t){if(this.handle){var e=this.handle.node,i=e.getContentSize();e.setAnchorPoint(cc.v2(0,0)),this.direction===n.HORIZONTAL?e.setContentSize(t,i.height):e.setContentSize(i.width,t)}},_processAutoHide:function(t){if(this.enableAutoHide&&!(this._autoHideRemainingTime<=0)&&!this._touching&&(this._autoHideRemainingTime-=t,this._autoHideRemainingTime<=this.autoHideTime)){this._autoHideRemainingTime=Math.max(0,this._autoHideRemainingTime);var e=this._opacity*(this._autoHideRemainingTime/this.autoHideTime);this._setOpacity(e)}},start:function(){this.enableAutoHide&&this._setOpacity(0)},hide:function(){this._autoHideRemainingTime=0,this._setOpacity(0)},show:function(){this._autoHideRemainingTime=this.autoHideTime,this._setOpacity(this._opacity)},update:function(t){this._processAutoHide(t)}});cc.Scrollbar=e.exports=r}),{"../utils/misc":278,"./CCComponent":129}],144:[(function(t,e){"use strict";var i=t("../CCNode").EventType,n=cc.v2(),r=cc.v2(),a=function(){return(new Date).getMilliseconds()},s=cc.Enum({SCROLL_TO_TOP:0,SCROLL_TO_BOTTOM:1,SCROLL_TO_LEFT:2,SCROLL_TO_RIGHT:3,SCROLLING:4,BOUNCE_TOP:5,BOUNCE_BOTTOM:6,BOUNCE_LEFT:7,BOUNCE_RIGHT:8,SCROLL_ENDED:9,TOUCH_UP:10,AUTOSCROLL_ENDED_WITH_THRESHOLD:11,SCROLL_BEGAN:12}),o={"scroll-to-top":s.SCROLL_TO_TOP,"scroll-to-bottom":s.SCROLL_TO_BOTTOM,"scroll-to-left":s.SCROLL_TO_LEFT,"scroll-to-right":s.SCROLL_TO_RIGHT,scrolling:s.SCROLLING,"bounce-bottom":s.BOUNCE_BOTTOM,"bounce-left":s.BOUNCE_LEFT,"bounce-right":s.BOUNCE_RIGHT,"bounce-top":s.BOUNCE_TOP,"scroll-ended":s.SCROLL_ENDED,"touch-up":s.TOUCH_UP,"scroll-ended-with-threshold":s.AUTOSCROLL_ENDED_WITH_THRESHOLD,"scroll-began":s.SCROLL_BEGAN},c=cc.Class({name:"cc.ScrollView",extends:t("./CCViewGroup"),editor:!1,ctor:function(){this._topBoundary=0,this._bottomBoundary=0,this._leftBoundary=0,this._rightBoundary=0,this._touchMoveDisplacements=[],this._touchMoveTimeDeltas=[],this._touchMovePreviousTimestamp=0,this._touchMoved=!1,this._autoScrolling=!1,this._autoScrollAttenuate=!1,this._autoScrollStartPosition=cc.v2(0,0),this._autoScrollTargetDelta=cc.v2(0,0),this._autoScrollTotalTime=0,this._autoScrollAccumulatedTime=0,this._autoScrollCurrentlyOutOfBoundary=!1,this._autoScrollBraking=!1,this._autoScrollBrakingStartPosition=cc.v2(0,0),this._outOfBoundaryAmount=cc.v2(0,0),this._outOfBoundaryAmountDirty=!0,this._stopMouseWheel=!1,this._mouseWheelEventElapsedTime=0,this._isScrollEndedWithThresholdEventFired=!1,this._scrollEventEmitMask=0,this._isBouncing=!1,this._scrolling=!1},properties:{content:{default:void 0,type:cc.Node,tooltip:!1,formerlySerializedAs:"content",notify:function(){this._calculateBoundary()}},horizontal:{default:!0,animatable:!1,tooltip:!1},vertical:{default:!0,animatable:!1,tooltip:!1},inertia:{default:!0,tooltip:!1},brake:{default:.5,type:cc.Float,range:[0,1,.1],tooltip:!1},elastic:{default:!0,animatable:!1,tooltip:!1},bounceDuration:{default:1,range:[0,10],tooltip:!1},horizontalScrollBar:{default:void 0,type:cc.Scrollbar,tooltip:!1,notify:function(){this.horizontalScrollBar&&(this.horizontalScrollBar.setTargetScrollView(this),this._updateScrollBar(0))},animatable:!1},verticalScrollBar:{default:void 0,type:cc.Scrollbar,tooltip:!1,notify:function(){this.verticalScrollBar&&(this.verticalScrollBar.setTargetScrollView(this),this._updateScrollBar(0))},animatable:!1},scrollEvents:{default:[],type:cc.Component.EventHandler,tooltip:!1},cancelInnerEvents:{default:!0,animatable:!1,tooltip:!1},_view:{get:function(){if(this.content)return this.content.parent}}},statics:{EventType:s},scrollToBottom:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.v2(0,0),applyToHorizontal:!1,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i,!0)},scrollToTop:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.v2(0,1),applyToHorizontal:!1,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},scrollToLeft:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.v2(0,0),applyToHorizontal:!0,applyToVertical:!1});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},scrollToRight:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.v2(1,0),applyToHorizontal:!0,applyToVertical:!1});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},scrollToTopLeft:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.v2(0,1),applyToHorizontal:!0,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},scrollToTopRight:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.v2(1,1),applyToHorizontal:!0,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},scrollToBottomLeft:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.v2(0,0),applyToHorizontal:!0,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},scrollToBottomRight:function(t,e){var i=this._calculateMovePercentDelta({anchor:cc.v2(1,0),applyToHorizontal:!0,applyToVertical:!0});t?this._startAutoScroll(i,t,!1!==e):this._moveContent(i)},scrollToOffset:function(t,e,i){var n=this.getMaxScrollOffset(),r=cc.v2(0,0);0===n.x?r.x=0:r.x=t.x/n.x,0===n.y?r.y=1:r.y=(n.y-t.y)/n.y,this.scrollTo(r,e,i)},getScrollOffset:function(){var t=this._getContentTopBoundary()-this._topBoundary,e=this._getContentLeftBoundary()-this._leftBoundary;return cc.v2(e,t)},getMaxScrollOffset:function(){var t=this._view.getContentSize(),e=this.content.getContentSize(),i=e.width-t.width,n=e.height-t.height;return i=i>=0?i:0,n=n>=0?n:0,cc.v2(i,n)},scrollToPercentHorizontal:function(t,e,i){var n=this._calculateMovePercentDelta({anchor:cc.v2(t,0),applyToHorizontal:!0,applyToVertical:!1});e?this._startAutoScroll(n,e,!1!==i):this._moveContent(n)},scrollTo:function(t,e,i){var n=this._calculateMovePercentDelta({anchor:cc.v2(t),applyToHorizontal:!0,applyToVertical:!0});e?this._startAutoScroll(n,e,!1!==i):this._moveContent(n)},scrollToPercentVertical:function(t,e,i){var n=this._calculateMovePercentDelta({anchor:cc.v2(0,t),applyToHorizontal:!1,applyToVertical:!0});e?this._startAutoScroll(n,e,!1!==i):this._moveContent(n)},stopAutoScroll:function(){this._autoScrolling=!1,this._autoScrollAccumulatedTime=this._autoScrollTotalTime},setContentPosition:function(t){t.fuzzyEquals(this.getContentPosition(),1e-4)||(this.content.setPosition(t),this._outOfBoundaryAmountDirty=!0)},getContentPosition:function(){return this.content.getPosition()},isScrolling:function(){return this._scrolling},isAutoScrolling:function(){return this._autoScrolling},_registerEvent:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this,!0),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this,!0),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this,!0),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this,!0),this.node.on(cc.Node.EventType.MOUSE_WHEEL,this._onMouseWheel,this,!0)},_unregisterEvent:function(){this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this,!0),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this,!0),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this,!0),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this,!0),this.node.off(cc.Node.EventType.MOUSE_WHEEL,this._onMouseWheel,this,!0)},_onMouseWheel:function(t,e){if(this.enabledInHierarchy&&!this._hasNestedViewGroup(t,e)){var i=cc.v2(0,0);this.vertical?i=cc.v2(0,-.1*t.getScrollY()):this.horizontal&&(i=cc.v2(-.1*t.getScrollY(),0)),this._mouseWheelEventElapsedTime=0,this._processDeltaMove(i),this._stopMouseWheel||(this._handlePressLogic(),this.schedule(this._checkMouseWheel,1/60),this._stopMouseWheel=!0),this._stopPropagationIfTargetIsMe(t)}},_checkMouseWheel:function(t){if(!this._getHowMuchOutOfBoundary().fuzzyEquals(cc.v2(0,0),1e-4))return this._processInertiaScroll(),this.unschedule(this._checkMouseWheel),this._dispatchEvent("scroll-ended"),void(this._stopMouseWheel=!1);this._mouseWheelEventElapsedTime+=t,this._mouseWheelEventElapsedTime>.1&&(this._onScrollBarTouchEnded(),this.unschedule(this._checkMouseWheel),this._dispatchEvent("scroll-ended"),this._stopMouseWheel=!1)},_calculateMovePercentDelta:function(t){var e=t.anchor,i=t.applyToHorizontal,n=t.applyToVertical;this._calculateBoundary(),e=e.clampf(cc.v2(0,0),cc.v2(1,1));var r=this._view.getContentSize(),a=this.content.getContentSize(),s=this._getContentBottomBoundary()-this._bottomBoundary;s=-s;var o=this._getContentLeftBoundary()-this._leftBoundary;o=-o;var c=cc.v2(0,0),l=0;return i&&(l=a.width-r.width,c.x=o-l*e.x),n&&(l=a.height-r.height,c.y=s-l*e.y),c},_moveContentToTopLeft:function(t){var e=this.content.getContentSize(),i=this._getContentBottomBoundary()-this._bottomBoundary;i=-i;var n=cc.v2(0,0),r=0,a=this._getContentLeftBoundary()-this._leftBoundary;a=-a,e.height<t.height&&(r=e.height-t.height,n.y=i-r),e.width<t.width&&(r=e.width-t.width,n.x=a),this._updateScrollBarState(),this._moveContent(n),this._adjustContentOutOfBoundary()},_calculateBoundary:function(){if(this.content){var t=this.content.getComponent(cc.Layout);t&&t.enabledInHierarchy&&t.updateLayout();var e=this._view.getContentSize(),i=e.width*this._view.anchorX,n=e.height*this._view.anchorY;this._leftBoundary=-i,this._bottomBoundary=-n,this._rightBoundary=this._leftBoundary+e.width,this._topBoundary=this._bottomBoundary+e.height,this._moveContentToTopLeft(e)}},_hasNestedViewGroup:function(t,e){if(t.eventPhase===cc.Event.CAPTURING_PHASE){if(e)for(var i=0;i<e.length;++i){var n=e[i];if(this.node===n)return!!t.target.getComponent(cc.ViewGroup);if(n.getComponent(cc.ViewGroup))return!0}return!1}},_stopPropagationIfTargetIsMe:function(t){t.eventPhase===cc.Event.AT_TARGET&&t.target===this.node&&t.stopPropagation()},_onTouchBegan:function(t,e){if(this.enabledInHierarchy&&!this._hasNestedViewGroup(t,e)){var i=t.touch;this.content&&this._handlePressLogic(i),this._touchMoved=!1,this._stopPropagationIfTargetIsMe(t)}},_onTouchMoved:function(t,e){if(this.enabledInHierarchy&&!this._hasNestedViewGroup(t,e)){var i=t.touch;if(this.content&&this._handleMoveLogic(i),this.cancelInnerEvents){if(i.getLocation().sub(i.getStartLocation()).mag()>7&&!this._touchMoved&&t.target!==this.node){var n=new cc.Event.EventTouch(t.getTouches(),t.bubbles);n.type=cc.Node.EventType.TOUCH_CANCEL,n.touch=t.touch,n.simulate=!0,t.target.dispatchEvent(n),this._touchMoved=!0}this._stopPropagationIfTargetIsMe(t)}}},_onTouchEnded:function(t,e){if(this.enabledInHierarchy&&!this._hasNestedViewGroup(t,e)){this._dispatchEvent("touch-up");var i=t.touch;this.content&&this._handleReleaseLogic(i),this._touchMoved?t.stopPropagation():this._stopPropagationIfTargetIsMe(t)}},_onTouchCancelled:function(t,e){if(this.enabledInHierarchy&&!this._hasNestedViewGroup(t,e)){if(!t.simulate){var i=t.touch;this.content&&this._handleReleaseLogic(i)}this._stopPropagationIfTargetIsMe(t)}},_processDeltaMove:function(t){this._scrollChildren(t),this._gatherTouchMove(t)},_getLocalAxisAlignDelta:function(t){return this.node.convertToNodeSpaceAR(t.getLocation(),n),this.node.convertToNodeSpaceAR(t.getPreviousLocation(),r),n.sub(r)},_handleMoveLogic:function(t){var e=this._getLocalAxisAlignDelta(t);this._processDeltaMove(e)},_scrollChildren:function(t){var e,i=t=this._clampDelta(t);this.elastic&&(e=this._getHowMuchOutOfBoundary(),i.x*=0===e.x?1:.5,i.y*=0===e.y?1:.5),this.elastic||(e=this._getHowMuchOutOfBoundary(i),i=i.add(e));var n=-1;i.y>0?this.content.y-this.content.anchorY*this.content.height+i.y>=this._bottomBoundary&&(n="scroll-to-bottom"):i.y<0&&this.content.y-this.content.anchorY*this.content.height+this.content.height+i.y<=this._topBoundary&&(n="scroll-to-top"),i.x<0?this.content.x-this.content.anchorX*this.content.width+this.content.width+i.x<=this._rightBoundary&&(n="scroll-to-right"):i.x>0&&this.content.x-this.content.anchorX*this.content.width+i.x>=this._leftBoundary&&(n="scroll-to-left"),this._moveContent(i,!1),0===i.x&&0===i.y||(this._scrolling||(this._scrolling=!0,this._dispatchEvent("scroll-began")),this._dispatchEvent("scrolling")),-1!==n&&this._dispatchEvent(n)},_handlePressLogic:function(){this._autoScrolling&&this._dispatchEvent("scroll-ended"),this._autoScrolling=!1,this._isBouncing=!1,this._touchMovePreviousTimestamp=a(),this._touchMoveDisplacements.length=0,this._touchMoveTimeDeltas.length=0,this._onScrollBarTouchBegan()},_clampDelta:function(t){var e=this.content.getContentSize(),i=this._view.getContentSize();return e.width<i.width&&(t.x=0),e.height<i.height&&(t.y=0),t},_gatherTouchMove:function(t){for(t=this._clampDelta(t);this._touchMoveDisplacements.length>=5;)this._touchMoveDisplacements.shift(),this._touchMoveTimeDeltas.shift();this._touchMoveDisplacements.push(t);var e=a();this._touchMoveTimeDeltas.push((e-this._touchMovePreviousTimestamp)/1e3),this._touchMovePreviousTimestamp=e},_startBounceBackIfNeeded:function(){if(!this.elastic)return!1;var t=this._getHowMuchOutOfBoundary();if((t=this._clampDelta(t)).fuzzyEquals(cc.v2(0,0),1e-4))return!1;var e=Math.max(this.bounceDuration,0);return this._startAutoScroll(t,e,!0),this._isBouncing||(t.y>0&&this._dispatchEvent("bounce-top"),t.y<0&&this._dispatchEvent("bounce-bottom"),t.x>0&&this._dispatchEvent("bounce-right"),t.x<0&&this._dispatchEvent("bounce-left"),this._isBouncing=!0),!0},_processInertiaScroll:function(){if(!this._startBounceBackIfNeeded()&&this.inertia){var t=this._calculateTouchMoveVelocity();!t.fuzzyEquals(cc.v2(0,0),1e-4)&&this.brake<1&&this._startInertiaScroll(t)}this._onScrollBarTouchEnded()},_handleReleaseLogic:function(t){var e=this._getLocalAxisAlignDelta(t);this._gatherTouchMove(e),this._processInertiaScroll(),this._scrolling&&(this._scrolling=!1,this._autoScrolling||this._dispatchEvent("scroll-ended"))},_isOutOfBoundary:function(){return!this._getHowMuchOutOfBoundary().fuzzyEquals(cc.v2(0,0),1e-4)},_isNecessaryAutoScrollBrake:function(){if(this._autoScrollBraking)return!0;if(this._isOutOfBoundary()){if(!this._autoScrollCurrentlyOutOfBoundary)return this._autoScrollCurrentlyOutOfBoundary=!0,this._autoScrollBraking=!0,this._autoScrollBrakingStartPosition=this.getContentPosition(),!0}else this._autoScrollCurrentlyOutOfBoundary=!1;return!1},getScrollEndedEventTiming:function(){return 1e-4},_processAutoScrolling:function(t){var e=this._isNecessaryAutoScrollBrake(),i=e?.05:1;this._autoScrollAccumulatedTime+=t*(1/i);var n,r=Math.min(1,this._autoScrollAccumulatedTime/this._autoScrollTotalTime);this._autoScrollAttenuate&&(n=r,r=(n-=1)*n*n*n*n+1);var a=this._autoScrollStartPosition.add(this._autoScrollTargetDelta.mul(r)),s=Math.abs(r-1)<=1e-4;if(Math.abs(r-1)<=this.getScrollEndedEventTiming()&&!this._isScrollEndedWithThresholdEventFired&&(this._dispatchEvent("scroll-ended-with-threshold"),this._isScrollEndedWithThresholdEventFired=!0),this.elastic){var o=a.sub(this._autoScrollBrakingStartPosition);e&&(o=o.mul(i)),a=this._autoScrollBrakingStartPosition.add(o)}else{var c=a.sub(this.getContentPosition()),l=this._getHowMuchOutOfBoundary(c);l.fuzzyEquals(cc.v2(0,0),1e-4)||(a=a.add(l),s=!0)}s&&(this._autoScrolling=!1);var u=a.sub(this.getContentPosition());this._moveContent(this._clampDelta(u),s),this._dispatchEvent("scrolling"),this._autoScrolling||(this._isBouncing=!1,this._scrolling=!1,this._dispatchEvent("scroll-ended"))},_startInertiaScroll:function(t){var e=t.mul(.7);this._startAttenuatingAutoScroll(e,t)},_calculateAttenuatedFactor:function(t){return this.brake<=0?1-this.brake:(1-this.brake)*(1/(1+14e-6*t+t*t*8e-9))},_startAttenuatingAutoScroll:function(t,e){var i=this._calculateAutoScrollTimeByInitalSpeed(e.mag()),n=t.normalize(),r=this.content.getContentSize(),a=this._view.getContentSize(),s=r.width-a.width,o=r.height-a.height,c=this._calculateAttenuatedFactor(s),l=this._calculateAttenuatedFactor(o);n=cc.v2(n.x*s*(1-this.brake)*c,n.y*o*l*(1-this.brake));var u=t.mag(),h=n.mag()/u;n=n.add(t),this.brake>0&&h>7&&(h=Math.sqrt(h),n=t.mul(h).add(t)),this.brake>0&&h>3&&(i*=h=3),0===this.brake&&h>1&&(i*=h),this._startAutoScroll(n,i,!0)},_calculateAutoScrollTimeByInitalSpeed:function(t){return Math.sqrt(Math.sqrt(t/5))},_startAutoScroll:function(t,e,i){var n=this._flattenVectorByDirection(t);this._autoScrolling=!0,this._autoScrollTargetDelta=n,this._autoScrollAttenuate=i,this._autoScrollStartPosition=this.getContentPosition(),this._autoScrollTotalTime=e,this._autoScrollAccumulatedTime=0,this._autoScrollBraking=!1,this._isScrollEndedWithThresholdEventFired=!1,this._autoScrollBrakingStartPosition=cc.v2(0,0),this._getHowMuchOutOfBoundary().fuzzyEquals(cc.v2(0,0),1e-4)||(this._autoScrollCurrentlyOutOfBoundary=!0)},_calculateTouchMoveVelocity:function(){var t=0;if((t=this._touchMoveTimeDeltas.reduce((function(t,e){return t+e}),t))<=0||t>=.5)return cc.v2(0,0);var e=cc.v2(0,0);return e=this._touchMoveDisplacements.reduce((function(t,e){return t.add(e)}),e),cc.v2(e.x*(1-this.brake)/t,e.y*(1-this.brake)/t)},_flattenVectorByDirection:function(t){var e=t;return e.x=this.horizontal?e.x:0,e.y=this.vertical?e.y:0,e},_moveContent:function(t,e){var i=this._flattenVectorByDirection(t),n=this.getContentPosition().add(i);this.setContentPosition(n);var r=this._getHowMuchOutOfBoundary();this._updateScrollBar(r),this.elastic&&e&&this._startBounceBackIfNeeded()},_getContentLeftBoundary:function(){return this.getContentPosition().x-this.content.getAnchorPoint().x*this.content.getContentSize().width},_getContentRightBoundary:function(){var t=this.content.getContentSize();return this._getContentLeftBoundary()+t.width},_getContentTopBoundary:function(){var t=this.content.getContentSize();return this._getContentBottomBoundary()+t.height},_getContentBottomBoundary:function(){return this.getContentPosition().y-this.content.getAnchorPoint().y*this.content.getContentSize().height},_getHowMuchOutOfBoundary:function(t){if((t=t||cc.v2(0,0)).fuzzyEquals(cc.v2(0,0),1e-4)&&!this._outOfBoundaryAmountDirty)return this._outOfBoundaryAmount;var e=cc.v2(0,0);return this._getContentLeftBoundary()+t.x>this._leftBoundary?e.x=this._leftBoundary-(this._getContentLeftBoundary()+t.x):this._getContentRightBoundary()+t.x<this._rightBoundary&&(e.x=this._rightBoundary-(this._getContentRightBoundary()+t.x)),this._getContentTopBoundary()+t.y<this._topBoundary?e.y=this._topBoundary-(this._getContentTopBoundary()+t.y):this._getContentBottomBoundary()+t.y>this._bottomBoundary&&(e.y=this._bottomBoundary-(this._getContentBottomBoundary()+t.y)),t.fuzzyEquals(cc.v2(0,0),1e-4)&&(this._outOfBoundaryAmount=e,this._outOfBoundaryAmountDirty=!1),this._clampDelta(e)},_updateScrollBarState:function(){if(this.content){var t=this.content.getContentSize(),e=this._view.getContentSize();this.verticalScrollBar&&(t.height<e.height?this.verticalScrollBar.hide():this.verticalScrollBar.show()),this.horizontalScrollBar&&(t.width<e.width?this.horizontalScrollBar.hide():this.horizontalScrollBar.show())}},_updateScrollBar:function(t){this.horizontalScrollBar&&this.horizontalScrollBar._onScroll(t),this.verticalScrollBar&&this.verticalScrollBar._onScroll(t)},_onScrollBarTouchBegan:function(){this.horizontalScrollBar&&this.horizontalScrollBar._onTouchBegan(),this.verticalScrollBar&&this.verticalScrollBar._onTouchBegan()},_onScrollBarTouchEnded:function(){this.horizontalScrollBar&&this.horizontalScrollBar._onTouchEnded(),this.verticalScrollBar&&this.verticalScrollBar._onTouchEnded()},_dispatchEvent:function(t){if("scroll-ended"===t)this._scrollEventEmitMask=0;else if("scroll-to-top"===t||"scroll-to-bottom"===t||"scroll-to-left"===t||"scroll-to-right"===t){var e=1<<o[t];if(this._scrollEventEmitMask&e)return;this._scrollEventEmitMask|=e}cc.Component.EventHandler.emitEvents(this.scrollEvents,this,o[t]),this.node.emit(t,this)},_adjustContentOutOfBoundary:function(){if(this._outOfBoundaryAmountDirty=!0,this._isOutOfBoundary()){var t=this._getHowMuchOutOfBoundary(cc.v2(0,0)),e=this.getContentPosition().add(t);this.content&&(this.content.setPosition(e),this._updateScrollBar(0))}},start:function(){this._calculateBoundary(),this.content&&cc.director.once(cc.Director.EVENT_BEFORE_DRAW,this._adjustContentOutOfBoundary,this)},_hideScrollbar:function(){this.horizontalScrollBar&&this.horizontalScrollBar.hide(),this.verticalScrollBar&&this.verticalScrollBar.hide()},onDisable:function(){this._unregisterEvent(),this.content&&(this.content.off(i.SIZE_CHANGED,this._calculateBoundary,this),this.content.off(i.SCALE_CHANGED,this._calculateBoundary,this),this._view&&(this._view.off(i.POSITION_CHANGED,this._calculateBoundary,this),this._view.off(i.SCALE_CHANGED,this._calculateBoundary,this),this._view.off(i.SIZE_CHANGED,this._calculateBoundary,this))),this._hideScrollbar(),this.stopAutoScroll()},onEnable:function(){this._registerEvent(),this.content&&(this.content.on(i.SIZE_CHANGED,this._calculateBoundary,this),this.content.on(i.SCALE_CHANGED,this._calculateBoundary,this),this._view&&(this._view.on(i.POSITION_CHANGED,this._calculateBoundary,this),this._view.on(i.SCALE_CHANGED,this._calculateBoundary,this),this._view.on(i.SIZE_CHANGED,this._calculateBoundary,this))),this._updateScrollBarState()},update:function(t){this._autoScrolling&&this._processAutoScrolling(t)}});cc.ScrollView=e.exports=c}),{"../CCNode":60,"./CCViewGroup":150}],145:[(function(t,e){"use strict";var i=t("../utils/misc"),n=t("./CCComponent"),r=cc.Enum({Horizontal:0,Vertical:1}),a=cc.Class({name:"cc.Slider",extends:n,editor:!1,ctor:function(){this._offset=cc.v2(),this._touchHandle=!1,this._dragging=!1},properties:{handle:{default:null,type:cc.Button,tooltip:!1,notify:function(){}},direction:{default:r.Horizontal,type:r,tooltip:!1},progress:{default:.5,type:cc.Float,range:[0,1,.1],slide:!0,tooltip:!1,notify:function(){this._updateHandlePosition()}},slideEvents:{default:[],type:cc.Component.EventHandler,tooltip:!1}},statics:{Direction:r},__preload:function(){this._updateHandlePosition()},onEnable:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this),this.handle&&this.handle.isValid&&(this.handle.node.on(cc.Node.EventType.TOUCH_START,this._onHandleDragStart,this),this.handle.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.handle.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this))},onDisable:function(){this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._onTouchCancelled,this),this.handle&&this.handle.isValid&&(this.handle.node.off(cc.Node.EventType.TOUCH_START,this._onHandleDragStart,this),this.handle.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMoved,this),this.handle.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this))},_onHandleDragStart:function(t){this._dragging=!0,this._touchHandle=!0,this._offset=this.handle.node.convertToNodeSpaceAR(t.touch.getLocation()),t.stopPropagation()},_onTouchBegan:function(t){this.handle&&(this._dragging=!0,this._touchHandle||this._handleSliderLogic(t.touch),t.stopPropagation())},_onTouchMoved:function(t){this._dragging&&(this._handleSliderLogic(t.touch),t.stopPropagation())},_onTouchEnded:function(t){this._dragging=!1,this._touchHandle=!1,this._offset=cc.v2(),t.stopPropagation()},_onTouchCancelled:function(t){this._dragging=!1,t.stopPropagation()},_handleSliderLogic:function(t){this._updateProgress(t),this._emitSlideEvent()},_emitSlideEvent:function(){cc.Component.EventHandler.emitEvents(this.slideEvents,this),this.node.emit("slide",this)},_updateProgress:function(t){if(this.handle){var e=this.node,n=e.convertToNodeSpaceAR(t.getLocation());this.direction===r.Horizontal?this.progress=i.clamp01((n.x-this._offset.x+e.anchorX*e.width)/e.width):this.progress=i.clamp01((n.y-this._offset.y+e.anchorY*e.height)/e.height)}},_updateHandlePosition:function(){if(this.handle){var t;t=this.direction===r.Horizontal?cc.v2(-this.node.width*this.node.anchorX+this.progress*this.node.width,0):cc.v2(0,-this.node.height*this.node.anchorY+this.progress*this.node.height);var e=this.node.convertToWorldSpaceAR(t);this.handle.node.position=this.handle.node.parent.convertToNodeSpaceAR(e)}}});cc.Slider=e.exports=a}),{"../utils/misc":278,"./CCComponent":129}],146:[(function(t,e){"use strict";var i=t("../utils/misc"),n=(t("../CCNode").EventType,t("./CCRenderComponent")),r=t("../utils/blend-func"),a=cc.Enum({SIMPLE:0,SLICED:1,TILED:2,FILLED:3,MESH:4}),s=cc.Enum({HORIZONTAL:0,VERTICAL:1,RADIAL:2}),o=cc.Enum({CUSTOM:0,TRIMMED:1,RAW:2}),c=cc.Enum({NORMAL:0,GRAY:1}),l=cc.Class({name:"cc.Sprite",extends:n,mixins:[r],editor:!1,properties:{_spriteFrame:{default:null,type:cc.SpriteFrame},_type:a.SIMPLE,_sizeMode:o.TRIMMED,_fillType:0,_fillCenter:cc.v2(0,0),_fillStart:0,_fillRange:0,_isTrimmedMode:!0,_atlas:{default:null,type:cc.SpriteAtlas,tooltip:!1,editorOnly:!0,visible:!0,animatable:!1},spriteFrame:{get:function(){return this._spriteFrame},set:function(t){var e=this._spriteFrame;e!==t&&(this._spriteFrame=t,this._applySpriteFrame(e))},type:cc.SpriteFrame},type:{get:function(){return this._type},set:function(t){this._type!==t&&(this._type=t,this.setVertsDirty(),this._resetAssembler())},type:a,animatable:!1,tooltip:!1},fillType:{get:function(){return this._fillType},set:function(t){t!==this._fillType&&(this._fillType=t,this.setVertsDirty(),this._resetAssembler())},type:s,tooltip:!1},fillCenter:{get:function(){return this._fillCenter},set:function(t){this._fillCenter.x=t.x,this._fillCenter.y=t.y,this._type===a.FILLED&&this.setVertsDirty()},tooltip:!1},fillStart:{get:function(){return this._fillStart},set:function(t){this._fillStart=i.clampf(t,-1,1),this._type===a.FILLED&&this.setVertsDirty()},tooltip:!1},fillRange:{get:function(){return this._fillRange},set:function(t){this._fillRange=i.clampf(t,-1,1),this._type===a.FILLED&&this.setVertsDirty()},tooltip:!1},trim:{get:function(){return this._isTrimmedMode},set:function(t){this._isTrimmedMode!==t&&(this._isTrimmedMode=t,this._type!==a.SIMPLE&&this._type!==a.MESH||this.setVertsDirty())},animatable:!1,tooltip:!1},sizeMode:{get:function(){return this._sizeMode},set:function(t){this._sizeMode=t,t!==o.CUSTOM&&this._applySpriteSize()},animatable:!1,type:o,tooltip:!1}},statics:{FillType:s,Type:a,SizeMode:o,State:c},setVisible:function(t){this.enabled=t},setState:function(){},getState:function(){},__preload:function(){this._super(),this._applySpriteFrame()},onEnable:function(){this._super(),this._spriteFrame&&this._spriteFrame.ensureLoadTexture(),this.node.on(cc.Node.EventType.SIZE_CHANGED,this.setVertsDirty,this),this.node.on(cc.Node.EventType.ANCHOR_CHANGED,this.setVertsDirty,this)},onDisable:function(){this._super(),this.node.off(cc.Node.EventType.SIZE_CHANGED,this.setVertsDirty,this),this.node.off(cc.Node.EventType.ANCHOR_CHANGED,this.setVertsDirty,this)},_updateMaterial:function(){var t=this._spriteFrame&&this._spriteFrame.getTexture(),e=this.getMaterial(0);e&&(void 0!==e.getDefine("USE_TEXTURE")&&e.define("USE_TEXTURE",!0),e.setProperty("texture",t)),r.prototype._updateMaterial.call(this)},_applyAtlas:!1,_validateRender:function(){var t=this._spriteFrame;this._materials[0]&&t&&t.textureLoaded()||this.disableRender()},_applySpriteSize:function(){if(this._spriteFrame&&this.isValid){if(o.RAW===this._sizeMode){var t=this._spriteFrame._originalSize;this.node.setContentSize(t)}else if(o.TRIMMED===this._sizeMode){var e=this._spriteFrame._rect;this.node.setContentSize(e.width,e.height)}this.setVertsDirty()}},_applySpriteFrame:function(t){var e=t&&t.getTexture();e&&!e.loaded&&t.off("load",this._applySpriteSize,this),this._updateMaterial();var i=this._spriteFrame;if(i){var n=i.getTexture();n&&n.loaded?this._applySpriteSize():(this.disableRender(),i.once("load",this._applySpriteSize,this))}else this.disableRender()}});cc.Sprite=e.exports=l}),{"../CCNode":60,"../utils/blend-func":272,"../utils/misc":278,"./CCRenderComponent":140}],147:[(function(t,e){"use strict";var i=t("../utils/gray-sprite-state"),n=cc.Class({name:"cc.Toggle",extends:t("./CCButton"),mixins:[i],editor:!1,properties:{_N$isChecked:!0,isChecked:{get:function(){return this._N$isChecked},set:function(t){if(t!==this._N$isChecked){var e=this.toggleGroup||this._toggleContainer;e&&e.enabled&&this._N$isChecked&&!e.allowSwitchOff||(this._N$isChecked=t,this._updateCheckMark(),e&&e.enabled&&e.updateToggles(this),cc.Toggle._triggerEventInScript_isChecked&&this._emitToggleEvents())}},tooltip:!1},toggleGroup:{default:null,tooltip:!1,type:t("./CCToggleGroup")},checkMark:{default:null,type:cc.Sprite,tooltip:!1},checkEvents:{default:[],type:cc.Component.EventHandler},_resizeToTarget:{animatable:!1,set:function(t){t&&this._resizeNodeToTargetNode()}}},statics:{_triggerEventInScript_check:!1,_triggerEventInScript_isChecked:!1},onEnable:function(){this._super(),this._registerToggleEvent(),this.toggleGroup&&this.toggleGroup.enabledInHierarchy&&this.toggleGroup.addToggle(this)},onDisable:function(){this._super(),this._unregisterToggleEvent(),this.toggleGroup&&this.toggleGroup.enabledInHierarchy&&this.toggleGroup.removeToggle(this)},_hideCheckMark:function(){this._N$isChecked=!1,this._updateCheckMark()},toggle:function(t){this.isChecked=!this.isChecked,cc.Toggle._triggerEventInScript_isChecked||!cc.Toggle._triggerEventInScript_check&&!t||this._emitToggleEvents()},check:function(){this.isChecked=!0,!cc.Toggle._triggerEventInScript_isChecked&&cc.Toggle._triggerEventInScript_check&&this._emitToggleEvents()},uncheck:function(){this.isChecked=!1,!cc.Toggle._triggerEventInScript_isChecked&&cc.Toggle._triggerEventInScript_check&&this._emitToggleEvents()},_updateCheckMark:function(){this.checkMark&&(this.checkMark.node.active=!!this.isChecked)},_updateDisabledState:function(){if(this._super(),this.enableAutoGrayEffect&&this.checkMark){var t=!this.interactable;this._switchGrayMaterial(t,this.checkMark)}},_registerToggleEvent:function(){this.node.on("click",this.toggle,this)},_unregisterToggleEvent:function(){this.node.off("click",this.toggle,this)},_emitToggleEvents:function(){this.node.emit("toggle",this),this.checkEvents&&cc.Component.EventHandler.emitEvents(this.checkEvents,this)}});cc.Toggle=e.exports=n,t("../platform/js").get(n.prototype,"_toggleContainer",(function(){var t=this.node.parent;return cc.Node.isNode(t)?t.getComponent(cc.ToggleContainer):null}))}),{"../platform/js":214,"../utils/gray-sprite-state":275,"./CCButton":127,"./CCToggleGroup":149}],148:[(function(t,e){"use strict";var i=cc.Class({name:"cc.ToggleContainer",extends:cc.Component,editor:!1,properties:{allowSwitchOff:{tooltip:!1,default:!1},checkEvents:{default:[],type:cc.Component.EventHandler}},updateToggles:function(t){this.enabledInHierarchy&&t.isChecked&&(this.toggleItems.forEach((function(e){e!==t&&e.isChecked&&e.enabled&&e._hideCheckMark()})),this.checkEvents&&cc.Component.EventHandler.emitEvents(this.checkEvents,t))},_allowOnlyOneToggleChecked:function(){var t=!1;return this.toggleItems.forEach((function(e){t?e._hideCheckMark():e.isChecked&&(t=!0)})),t},_makeAtLeastOneToggleChecked:function(){if(!this._allowOnlyOneToggleChecked()&&!this.allowSwitchOff){var t=this.toggleItems;t.length>0&&t[0].check()}},onEnable:function(){this.node.on("child-added",this._allowOnlyOneToggleChecked,this),this.node.on("child-removed",this._makeAtLeastOneToggleChecked,this)},onDisable:function(){this.node.off("child-added",this._allowOnlyOneToggleChecked,this),this.node.off("child-removed",this._makeAtLeastOneToggleChecked,this)},start:function(){this._makeAtLeastOneToggleChecked()}});t("../platform/js").get(i.prototype,"toggleItems",(function(){return this.node._children.map((function(t){return t.getComponent(cc.Toggle)})).filter(Boolean)})),cc.ToggleContainer=e.exports=i}),{"../platform/js":214}],149:[(function(t,e){"use strict";var i=cc.Class({name:"cc.ToggleGroup",extends:cc.Component,ctor:function(){this._toggleItems=[]},editor:!1,properties:{allowSwitchOff:{tooltip:!1,default:!1},toggleItems:{get:function(){return this._toggleItems}}},updateToggles:function(t){this.enabledInHierarchy&&this._toggleItems.forEach((function(e){t.isChecked&&e!==t&&e.isChecked&&e.enabled&&e._hideCheckMark()}))},addToggle:function(t){-1===this._toggleItems.indexOf(t)&&this._toggleItems.push(t),this._allowOnlyOneToggleChecked()},removeToggle:function(t){var e=this._toggleItems.indexOf(t);e>-1&&this._toggleItems.splice(e,1),this._makeAtLeastOneToggleChecked()},_allowOnlyOneToggleChecked:function(){var t=!1;return this._toggleItems.forEach((function(e){t&&e.enabled&&e._hideCheckMark(),e.isChecked&&e.enabled&&(t=!0)})),t},_makeAtLeastOneToggleChecked:function(){this._allowOnlyOneToggleChecked()||this.allowSwitchOff||this._toggleItems.length>0&&(this._toggleItems[0].isChecked=!0)},start:function(){this._makeAtLeastOneToggleChecked()}}),n=t("../platform/js"),r=!1;n.get(cc,"ToggleGroup",(function(){return r||(cc.errorID(1405,"cc.ToggleGroup","cc.ToggleContainer"),r=!0),i})),e.exports=i}),{"../platform/js":214}],150:[(function(t,e){"use strict";var i=cc.Class({name:"cc.ViewGroup",extends:t("./CCComponent")});cc.ViewGroup=e.exports=i}),{"./CCComponent":129}],151:[(function(t,e){"use strict";var i=t("../base-ui/CCWidgetManager"),n=i.AlignMode,r=i._AlignFlags,a=r.TOP,s=r.MID,o=r.BOT,c=r.LEFT,l=r.CENTER,u=r.RIGHT,h=a|o,f=c|u,d=cc.Class({name:"cc.Widget",extends:t("./CCComponent"),editor:!1,properties:{target:{get:function(){return this._target},set:function(t){this._target=t},type:cc.Node,tooltip:!1},isAlignTop:{get:function(){return(this._alignFlags&a)>0},set:function(t){this._setAlign(a,t)},animatable:!1,tooltip:!1},isAlignVerticalCenter:{get:function(){return(this._alignFlags&s)>0},set:function(t){t?(this.isAlignTop=!1,this.isAlignBottom=!1,this._alignFlags|=s):this._alignFlags&=~s},animatable:!1,tooltip:!1},isAlignBottom:{get:function(){return(this._alignFlags&o)>0},set:function(t){this._setAlign(o,t)},animatable:!1,tooltip:!1},isAlignLeft:{get:function(){return(this._alignFlags&c)>0},set:function(t){this._setAlign(c,t)},animatable:!1,tooltip:!1},isAlignHorizontalCenter:{get:function(){return(this._alignFlags&l)>0},set:function(t){t?(this.isAlignLeft=!1,this.isAlignRight=!1,this._alignFlags|=l):this._alignFlags&=~l},animatable:!1,tooltip:!1},isAlignRight:{get:function(){return(this._alignFlags&u)>0},set:function(t){this._setAlign(u,t)},animatable:!1,tooltip:!1},isStretchWidth:{get:function(){return(this._alignFlags&f)===f},visible:!1},isStretchHeight:{get:function(){return(this._alignFlags&h)===h},visible:!1},top:{get:function(){return this._top},set:function(t){this._top=t},tooltip:!1},bottom:{get:function(){return this._bottom},set:function(t){this._bottom=t},tooltip:!1},left:{get:function(){return this._left},set:function(t){this._left=t},tooltip:!1},right:{get:function(){return this._right},set:function(t){this._right=t},tooltip:!1},horizontalCenter:{get:function(){return this._horizontalCenter},set:function(t){this._horizontalCenter=t},tooltip:!1},verticalCenter:{get:function(){return this._verticalCenter},set:function(t){this._verticalCenter=t},tooltip:!1},isAbsoluteHorizontalCenter:{get:function(){return this._isAbsHorizontalCenter},set:function(t){this._isAbsHorizontalCenter=t},animatable:!1},isAbsoluteVerticalCenter:{get:function(){return this._isAbsVerticalCenter},set:function(t){this._isAbsVerticalCenter=t},animatable:!1},isAbsoluteTop:{get:function(){return this._isAbsTop},set:function(t){this._isAbsTop=t},animatable:!1},isAbsoluteBottom:{get:function(){return this._isAbsBottom},set:function(t){this._isAbsBottom=t},animatable:!1},isAbsoluteLeft:{get:function(){return this._isAbsLeft},set:function(t){this._isAbsLeft=t},animatable:!1},isAbsoluteRight:{get:function(){return this._isAbsRight},set:function(t){this._isAbsRight=t},animatable:!1},alignMode:{default:n.ON_WINDOW_RESIZE,type:n,tooltip:!1},_wasAlignOnce:{default:void 0,formerlySerializedAs:"isAlignOnce"},_target:null,_alignFlags:0,_left:0,_right:0,_top:0,_bottom:0,_verticalCenter:0,_horizontalCenter:0,_isAbsLeft:!0,_isAbsRight:!0,_isAbsTop:!0,_isAbsBottom:!0,_isAbsHorizontalCenter:!0,_isAbsVerticalCenter:!0,_originalWidth:0,_originalHeight:0},statics:{AlignMode:n},onLoad:function(){void 0!==this._wasAlignOnce&&(this.alignMode=this._wasAlignOnce?n.ONCE:n.ALWAYS,this._wasAlignOnce=void 0)},onEnable:function(){i.add(this)},onDisable:function(){i.remove(this)},_validateTargetInDEV:!1,_setAlign:function(t,e){if(e!==(this._alignFlags&t)>0){var i=(t&f)>0;e?(this._alignFlags|=t,i?(this.isAlignHorizontalCenter=!1,this.isStretchWidth&&(this._originalWidth=this.node.width)):(this.isAlignVerticalCenter=!1,this.isStretchHeight&&(this._originalHeight=this.node.height))):(i?this.isStretchWidth&&(this.node.width=this._originalWidth):this.isStretchHeight&&(this.node.height=this._originalHeight),this._alignFlags&=~t)}},updateAlignment:function(){i.updateAlignment(this.node)}});Object.defineProperty(d.prototype,"isAlignOnce",{get:function(){return this.alignMode===n.ONCE},set:function(t){this.alignMode=t?n.ONCE:n.ALWAYS}}),cc.Widget=e.exports=d}),{"../base-ui/CCWidgetManager":120,"./CCComponent":129}],152:[(function(t,e){"use strict";var i=t("./CCComponent"),n=cc.Class({name:"cc.SubContextView",extends:i,editor:!1,properties:{_firstlyEnabled:!0,_fps:60,fps:{get:function(){return this._fps},set:function(t){this._fps!==t&&(this._fps=t,this._updateInterval=1/t,this._updateSubContextFrameRate())},tooltip:!1}},ctor:function(){this._sprite=null,this._tex=new cc.Texture2D,this._context=null,this._updatedTime=performance.now(),this._updateInterval=0},onLoad:function(){if(window.__globalAdapter&&__globalAdapter.getOpenDataContext){this._updateInterval=1e3/this._fps,this._context=__globalAdapter.getOpenDataContext(),this.reset();var t=this._context.canvas;this._tex.setPremultiplyAlpha(!0),this._tex.initWithElement(t),this._sprite=this.node.getComponent(cc.Sprite),this._sprite||(this._sprite=this.node.addComponent(cc.Sprite),this._sprite.srcBlendFactor=cc.macro.BlendFactor.ONE),this._sprite.spriteFrame=new cc.SpriteFrame(this._tex)}else this.enabled=!1},reset:function(){if(this._context){this.updateSubContextViewport();var t=this._context.canvas;t&&(t.width=this.node.width,t.height=this.node.height)}},onEnable:function(){this._firstlyEnabled&&this._context?(this._context.postMessage({fromEngine:!0,event:"boot"}),this._firstlyEnabled=!1):this._runSubContextMainLoop(),this._registerNodeEvent(),this._updateSubContextFrameRate(),this.updateSubContextViewport()},onDisable:function(){this._unregisterNodeEvent(),this._stopSubContextMainLoop()},update:function(t){if(void 0===t)return this._context&&this._context.postMessage({fromEngine:!0,event:"step"}),void this._updateSubContextTexture();performance.now()-this._updatedTime>=this._updateInterval&&(this._updatedTime+=this._updateInterval,this._updateSubContextTexture())},_updateSubContextTexture:function(){this._tex&&this._context&&(this._tex.initWithElement(this._context.canvas),this._sprite._activateMaterial())},updateSubContextViewport:function(){if(this._context){var t=this.node.getBoundingBoxToWorld(),e=cc.view._scaleX,i=cc.view._scaleY;this._context.postMessage({fromEngine:!0,event:"viewport",x:t.x*e+cc.view._viewportRect.x,y:t.y*i+cc.view._viewportRect.y,width:t.width*e,height:t.height*i})}},_registerNodeEvent:function(){this.node.on("position-changed",this.updateSubContextViewport,this),this.node.on("scale-changed",this.updateSubContextViewport,this),this.node.on("size-changed",this.updateSubContextViewport,this)},_unregisterNodeEvent:function(){this.node.off("position-changed",this.updateSubContextViewport,this),this.node.off("scale-changed",this.updateSubContextViewport,this),this.node.off("size-changed",this.updateSubContextViewport,this)},_runSubContextMainLoop:function(){this._context&&this._context.postMessage({fromEngine:!0,event:"mainLoop",value:!0})},_stopSubContextMainLoop:function(){this._context&&this._context.postMessage({fromEngine:!0,event:"mainLoop",value:!1})},_updateSubContextFrameRate:function(){this._context&&this._context.postMessage({fromEngine:!0,event:"frameRate",value:this._fps})}});cc.SubContextView=e.exports=n,cc.WXSubContextView=n,cc.SwanSubContextView=n}),{"./CCComponent":129}],153:[(function(t,e){"use strict";var i=t("../../platform/CCMacro"),n=t("../editbox/EditBoxImplBase"),r=t("../CCLabel"),a=t("./types"),s=a.InputMode,o=a.InputFlag,c=a.KeyboardReturnType;function l(t){return t.charAt(0).toUpperCase()+t.slice(1)}var u=cc.Class({name:"cc.EditBox",extends:cc.Component,editor:!1,properties:{_string:"",string:{tooltip:!1,get:function(){return this._string},set:function(t){t=""+t,this.maxLength>=0&&t.length>=this.maxLength&&(t=t.slice(0,this.maxLength)),this._string=t,this._updateString(t)}},textLabel:{tooltip:!1,default:null,type:r,notify:function(t){this.textLabel&&this.textLabel!==t&&(this._updateTextLabel(),this._updateLabels())}},placeholderLabel:{tooltip:!1,default:null,type:r,notify:function(t){this.placeholderLabel&&this.placeholderLabel!==t&&(this._updatePlaceholderLabel(),this._updateLabels())}},background:{tooltip:!1,default:null,type:cc.Sprite,notify:function(t){this.background&&this.background!==t&&this._updateBackgroundSprite()}},_N$backgroundImage:{default:void 0,type:cc.SpriteFrame},backgroundImage:{get:function(){return this.background?this.background.spriteFrame:null},set:function(t){this.background&&(this.background.spriteFrame=t)}},returnType:{default:c.DEFAULT,tooltip:!1,displayName:"KeyboardReturnType",type:c},_N$returnType:{default:void 0,type:cc.Float},inputFlag:{tooltip:!1,default:o.DEFAULT,type:o,notify:function(){this._updateString(this._string)}},inputMode:{tooltip:!1,default:s.ANY,type:s,notify:function(t){this.inputMode!==t&&(this._updateTextLabel(),this._updatePlaceholderLabel())}},fontSize:{get:function(){return this.textLabel?this.textLabel.fontSize:0},set:function(t){this.textLabel&&(this.textLabel.fontSize=t)}},_N$fontSize:{default:void 0,type:cc.Float},lineHeight:{get:function(){return this.textLabel?this.textLabel.lineHeight:0},set:function(t){this.textLabel&&(this.textLabel.lineHeight=t)}},_N$lineHeight:{default:void 0,type:cc.Float},fontColor:{get:function(){return this.textLabel?this.textLabel.node.color:cc.Color.BLACK},set:function(t){this.textLabel&&(this.textLabel.node.color=t,this.textLabel.node.opacity=t.a)}},_N$fontColor:void 0,placeholder:{tooltip:!1,get:function(){return this.placeholderLabel?this.placeholderLabel.string:""},set:function(t){this.placeholderLabel&&(this.placeholderLabel.string=t)}},_N$placeholder:{default:void 0,type:cc.String},placeholderFontSize:{get:function(){return this.placeholderLabel?this.placeholderLabel.fontSize:0},set:function(t){this.placeholderLabel&&(this.placeholderLabel.fontSize=t)}},_N$placeholderFontSize:{default:void 0,type:cc.Float},placeholderFontColor:{get:function(){return this.placeholderLabel?this.placeholderLabel.node.color:cc.Color.BLACK},set:function(t){this.placeholderLabel&&(this.placeholderLabel.node.color=t,this.placeholderLabel.node.opacity=t.a)}},_N$placeholderFontColor:void 0,maxLength:{tooltip:!1,default:20},_N$maxLength:{default:void 0,type:cc.Float},stayOnTop:{default:!1,notify:function(){cc.warn("editBox.stayOnTop is removed since v2.1.")}},_tabIndex:0,tabIndex:{tooltip:!1,get:function(){return this._tabIndex},set:function(t){this._tabIndex!==t&&(this._tabIndex=t,this._impl&&this._impl.setTabIndex(t))}},editingDidBegan:{default:[],type:cc.Component.EventHandler},textChanged:{default:[],type:cc.Component.EventHandler},editingDidEnded:{default:[],type:cc.Component.EventHandler},editingReturn:{default:[],type:cc.Component.EventHandler}},statics:{_ImplClass:n,KeyboardReturnType:c,InputFlag:o,InputMode:s},_init:function(){this._upgradeComp(),this._isLabelVisible=!0,this.node.on(cc.Node.EventType.SIZE_CHANGED,this._syncSize,this),(this._impl=new u._ImplClass).init(this),this._updateString(this._string),this._syncSize()},_updateBackgroundSprite:function(){var t=this.background;if(!t){var e=this.node.getChildByName("BACKGROUND_SPRITE");e||(e=new cc.Node("BACKGROUND_SPRITE")),(t=e.getComponent(cc.Sprite))||(t=e.addComponent(cc.Sprite)),e.parent=this.node,this.background=t}t.type=cc.Sprite.Type.SLICED,void 0!==this._N$backgroundImage&&(t.spriteFrame=this._N$backgroundImage,this._N$backgroundImage=void 0)},_updateTextLabel:function(){var t=this.textLabel;if(!t){var e=this.node.getChildByName("TEXT_LABEL");e||(e=new cc.Node("TEXT_LABEL")),(t=e.getComponent(r))||(t=e.addComponent(r)),e.parent=this.node,this.textLabel=t}t.node.setAnchorPoint(0,1),t.overflow=r.Overflow.CLAMP,this.inputMode===s.ANY?(t.verticalAlign=i.VerticalTextAlignment.TOP,t.enableWrapText=!0):(t.verticalAlign=i.VerticalTextAlignment.CENTER,t.enableWrapText=!1),t.string=this._updateLabelStringStyle(this._string),void 0!==this._N$fontColor&&(t.node.color=this._N$fontColor,t.node.opacity=this._N$fontColor.a,this._N$fontColor=void 0),void 0!==this._N$fontSize&&(t.fontSize=this._N$fontSize,this._N$fontSize=void 0),void 0!==this._N$lineHeight&&(t.lineHeight=this._N$lineHeight,this._N$lineHeight=void 0)},_updatePlaceholderLabel:function(){var t=this.placeholderLabel;if(!t){var e=this.node.getChildByName("PLACEHOLDER_LABEL");e||(e=new cc.Node("PLACEHOLDER_LABEL")),(t=e.getComponent(r))||(t=e.addComponent(r)),e.parent=this.node,this.placeholderLabel=t}t.node.setAnchorPoint(0,1),t.overflow=r.Overflow.CLAMP,this.inputMode===s.ANY?(t.verticalAlign=i.VerticalTextAlignment.TOP,t.enableWrapText=!0):(t.verticalAlign=i.VerticalTextAlignment.CENTER,t.enableWrapText=!1),t.string=this.placeholder,void 0!==this._N$placeholderFontColor&&(t.node.color=this._N$placeholderFontColor,t.node.opacity=this._N$placeholderFontColor.a,this._N$placeholderFontColor=void 0),void 0!==this._N$placeholderFontSize&&(t.fontSize=this._N$placeholderFontSize,this._N$placeholderFontSize=void 0)},_upgradeComp:function(){void 0!==this._N$returnType&&(this.returnType=this._N$returnType,this._N$returnType=void 0),void 0!==this._N$maxLength&&(this.maxLength=this._N$maxLength,this._N$maxLength=void 0),void 0!==this._N$backgroundImage&&this._updateBackgroundSprite(),void 0===this._N$fontColor&&void 0===this._N$fontSize&&void 0===this._N$lineHeight||this._updateTextLabel(),void 0===this._N$placeholderFontColor&&void 0===this._N$placeholderFontSize||this._updatePlaceholderLabel(),void 0!==this._N$placeholder&&(this.placeholder=this._N$placeholder,this._N$placeholder=void 0)},_syncSize:function(){if(this._impl){var t=this.node.getContentSize();this._impl.setSize(t.width,t.height)}},_showLabels:function(){this._isLabelVisible=!0,this._updateLabels()},_hideLabels:function(){this._isLabelVisible=!1,this.textLabel&&(this.textLabel.node.active=!1),this.placeholderLabel&&(this.placeholderLabel.node.active=!1)},_updateLabels:function(){if(this._isLabelVisible){var t=this._string;this.textLabel&&(this.textLabel.node.active=""!==t),this.placeholderLabel&&(this.placeholderLabel.node.active=""===t)}},_updateString:function(t){var e=this.textLabel;if(e){var i=t;i&&(i=this._updateLabelStringStyle(i)),e.string=i,this._updateLabels()}},_updateLabelStringStyle:function(t,e){var i=this.inputFlag;if(e||i!==o.PASSWORD)i===o.INITIAL_CAPS_ALL_CHARACTERS?t=t.toUpperCase():i===o.INITIAL_CAPS_WORD?t=t.replace(/(?:^|\s)\S/g,(function(t){return t.toUpperCase()})):i===o.INITIAL_CAPS_SENTENCE&&(t=l(t));else{for(var n="",r=t.length,a=0;a<r;++a)n+="\u25cf";t=n}return t},editBoxEditingDidBegan:function(){cc.Component.EventHandler.emitEvents(this.editingDidBegan,this),this.node.emit("editing-did-began",this)},editBoxEditingDidEnded:function(){cc.Component.EventHandler.emitEvents(this.editingDidEnded,this),this.node.emit("editing-did-ended",this)},editBoxTextChanged:function(t){t=this._updateLabelStringStyle(t,!0),this.string=t,cc.Component.EventHandler.emitEvents(this.textChanged,t,this),this.node.emit("text-changed",this)},editBoxEditingReturn:function(){cc.Component.EventHandler.emitEvents(this.editingReturn,this),this.node.emit("editing-return",this)},onEnable:function(){this._registerEvent(),this._impl&&this._impl.enable()},onDisable:function(){this._unregisterEvent(),this._impl&&this._impl.disable()},onDestroy:function(){this._impl&&this._impl.clear()},__preload:function(){this._init()},_registerEvent:function(){this.node.on(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this)},_unregisterEvent:function(){this.node.off(cc.Node.EventType.TOUCH_START,this._onTouchBegan,this),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnded,this)},_onTouchBegan:function(t){t.stopPropagation()},_onTouchCancel:function(t){t.stopPropagation()},_onTouchEnded:function(t){this._impl&&this._impl.beginEditing(),t.stopPropagation()},setFocus:function(){cc.errorID(1400,"setFocus()","focus()"),this._impl&&this._impl.setFocus(!0)},focus:function(){this._impl&&this._impl.setFocus(!0)},blur:function(){this._impl&&this._impl.setFocus(!1)},isFocused:function(){return!!this._impl&&this._impl.isFocused()},update:function(){this._impl&&this._impl.update()}});cc.EditBox=e.exports=u,cc.sys.isBrowser&&t("./WebEditBoxImpl")}),{"../../platform/CCMacro":198,"../CCLabel":131,"../editbox/EditBoxImplBase":154,"./WebEditBoxImpl":155,"./types":157}],154:[(function(t,e){"use strict";var i=cc.Class({ctor:function(){this._delegate=null,this._editing=!1},init:function(){},enable:function(){},disable:function(){this._editing&&this.endEditing()},clear:function(){},update:function(){},setTabIndex:function(){},setSize:function(){},setFocus:function(t){t?this.beginEditing():this.endEditing()},isFocused:function(){return this._editing},beginEditing:function(){},endEditing:function(){}});e.exports=i}),{}],155:[(function(t){"use strict";var e,i=(e=t("../../value-types/mat4"))&&e.__esModule?e:{default:e},n=t("../../platform/utils"),r=t("../../platform/CCMacro"),a=t("./types"),s=t("../CCLabel"),o=t("./tabIndexUtil"),c=cc.EditBox,l=cc.js,u=a.InputMode,h=a.InputFlag,f=a.KeyboardReturnType,d={zoomInvalid:!1};cc.sys.OS_ANDROID!==cc.sys.os||cc.sys.browserType!==cc.sys.BROWSER_TYPE_SOUGOU&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_360||(d.zoomInvalid=!0);var _=0,p=cc.v3(),m=null,v=!1,g=!1,y=c._ImplClass;function T(){y.call(this),this._domId="EditBoxId_"+ ++_,this._placeholderStyleSheet=null,this._elem=null,this._isTextArea=!1,this._worldMat=new i.default,this._cameraMat=new i.default,this._m00=0,this._m01=0,this._m04=0,this._m05=0,this._m12=0,this._m13=0,this._w=0,this._h=0,this._cacheViewportRect=cc.rect(0,0,0,0),this._inputMode=null,this._inputFlag=null,this._returnType=null,this._eventListeners={},this._textLabelFont=null,this._textLabelFontSize=null,this._textLabelFontColor=null,this._textLabelAlign=null,this._placeholderLabelFont=null,this._placeholderLabelFontSize=null,this._placeholderLabelFontColor=null,this._placeholderLabelAlign=null,this._placeholderLineHeight=null}l.extend(T,y),c._ImplClass=T,Object.assign(T.prototype,{init:function(t){t&&(this._delegate=t,t.inputMode===u.ANY?this._createTextArea():this._createInput(),o.add(this),this.setTabIndex(t.tabIndex),this._initStyleSheet(),this._registerEventListeners(),this._addDomToGameContainer(),v=cc.view.isAutoFullScreenEnabled(),g=cc.view._resizeWithBrowserSize)},clear:function(){this._removeEventListeners(),this._removeDomFromGameContainer(),o.remove(this),m===this&&(m=null)},update:function(){this._updateMatrix()},setTabIndex:function(t){this._elem.tabIndex=t,o.resort()},setSize:function(t,e){var i=this._elem;i.style.width=t+"px",i.style.height=e+"px"},beginEditing:function(){m&&m!==this&&m.setFocus(!1),this._editing=!0,m=this,this._delegate.editBoxEditingDidBegan(),this._showDom(),this._elem.focus()},endEditing:function(){this._elem&&this._elem.blur()},_createInput:function(){this._isTextArea=!1,this._elem=document.createElement("input")},_createTextArea:function(){this._isTextArea=!0,this._elem=document.createElement("textarea")},_addDomToGameContainer:function(){cc.game.container.appendChild(this._elem),document.head.appendChild(this._placeholderStyleSheet)},_removeDomFromGameContainer:function(){n.contains(cc.game.container,this._elem)&&cc.game.container.removeChild(this._elem),n.contains(document.head,this._placeholderStyleSheet)&&document.head.removeChild(this._placeholderStyleSheet),delete this._elem,delete this._placeholderStyleSheet},_showDom:function(){this._updateMaxLength(),this._updateInputType(),this._updateStyleSheet(),this._elem.style.display="",this._delegate._hideLabels(),cc.sys.isMobile&&this._showDomOnMobile()},_hideDom:function(){this._elem.style.display="none",this._delegate._showLabels(),cc.sys.isMobile&&this._hideDomOnMobile()},_showDomOnMobile:function(){cc.sys.os===cc.sys.OS_ANDROID&&(v&&(cc.view.enableAutoFullScreen(!1),cc.screen.exitFullScreen()),g&&cc.view.resizeWithBrowserSize(!1),this._adjustWindowScroll())},_hideDomOnMobile:function(){cc.sys.os===cc.sys.OS_ANDROID&&(g&&cc.view.resizeWithBrowserSize(!0),setTimeout((function(){m||v&&cc.view.enableAutoFullScreen(!0)}),800)),this._scrollBackWindow()},_adjustWindowScroll:function(){var t=this;setTimeout((function(){window.scrollY<100&&t._elem.scrollIntoView({block:"start",inline:"nearest",behavior:"smooth"})}),800)},_scrollBackWindow:function(){setTimeout((function(){var t=cc.sys;t.browserType!==t.BROWSER_TYPE_WECHAT||t.os!==t.OS_IOS?window.scrollTo(0,0):window.top&&window.top.scrollTo(0,0)}),800)},_updateCameraMatrix:function(){var t=this._delegate.node;t.getWorldMatrix(this._worldMat);var e=this._worldMat,n=t._contentSize,r=t._anchorPoint;p.x=-r.x*n.width,p.y=-r.y*n.height,i.default.transform(e,e,p);var a=cc.Camera.findCamera(t);return!!a&&(a.getWorldToScreenMatrix2D(this._cameraMat),i.default.mul(this._cameraMat,this._cameraMat,e),!0)},_updateMatrix:function(){if(this._updateCameraMatrix()){var t=this._cameraMat.m,e=this._delegate.node,i=cc.view;if(this._m00!==t[0]||this._m01!==t[1]||this._m04!==t[4]||this._m05!==t[5]||this._m12!==t[12]||this._m13!==t[13]||this._w!==e._contentSize.width||this._h!==e._contentSize.height||!this._cacheViewportRect.equals(i._viewportRect)){this._m00=t[0],this._m01=t[1],this._m04=t[4],this._m05=t[5],this._m12=t[12],this._m13=t[13],this._w=e._contentSize.width,this._h=e._contentSize.height,this._cacheViewportRect.set(i._viewportRect);var n=i._scaleX,r=i._scaleY,a=i._viewportRect,s=i._devicePixelRatio;n/=s,r/=s;var o=cc.game.container,c=t[0]*n,l=t[1],u=t[4],h=t[5]*r,f=o&&o.style.paddingLeft&&parseInt(o.style.paddingLeft);f+=a.x/s;var _=o&&o.style.paddingBottom&&parseInt(o.style.paddingBottom);_+=a.y/s;var p=t[12]*n+f,m=t[13]*r+_;d.zoomInvalid&&(this.setSize(e.width*c,e.height*h),c=1,h=1);var v=this._elem,g="matrix("+c+","+-l+","+-u+","+h+","+p+","+-m+")";v.style.transform=g,v.style["-webkit-transform"]=g,v.style["transform-origin"]="0px 100% 0px",v.style["-webkit-transform-origin"]="0px 100% 0px"}}},_updateInputType:function(){var t=this._delegate,e=t.inputMode,i=t.inputFlag,n=t.returnType,r=this._elem;if(this._inputMode!==e||this._inputFlag!==i||this._returnType!==n){if(this._inputMode=e,this._inputFlag=i,this._returnType=n,this._isTextArea){var a="none";return i===h.INITIAL_CAPS_ALL_CHARACTERS?a="uppercase":i===h.INITIAL_CAPS_WORD&&(a="capitalize"),void(r.style.textTransform=a)}if(i!==h.PASSWORD){var s=r.type;e===u.EMAIL_ADDR?s="email":e===u.NUMERIC||e===u.DECIMAL?s="number":e===u.PHONE_NUMBER?(s="number",r.pattern="[0-9]*"):e===u.URL?s="url":(s="text",n===f.SEARCH&&(s="search")),r.type=s;var o="none";i===h.INITIAL_CAPS_ALL_CHARACTERS?o="uppercase":i===h.INITIAL_CAPS_WORD&&(o="capitalize"),r.style.textTransform=o}else r.type="password"}},_updateMaxLength:function(){var t=this._delegate.maxLength;t<0&&(t=65535),this._elem.maxLength=t},_initStyleSheet:function(){var t=this._elem;t.style.display="none",t.style.border=0,t.style.background="transparent",t.style.width="100%",t.style.height="100%",t.style.active=0,t.style.outline="medium",t.style.padding="0",t.style.textTransform="uppercase",t.style.position="absolute",t.style.bottom="0px",t.style.left="2px",t.className="cocosEditBox",t.id=this._domId,this._isTextArea?(t.style.resize="none",t.style.overflow_y="scroll"):(t.type="text",t.style["-moz-appearance"]="textfield"),this._placeholderStyleSheet=document.createElement("style")},_updateStyleSheet:function(){var t=this._delegate,e=this._elem;e.value=t.string,e.placeholder=t.placeholder,this._updateTextLabel(t.textLabel),this._updatePlaceholderLabel(t.placeholderLabel)},_updateTextLabel:function(t){if(t){var e=t.font;e=!e||e instanceof cc.BitmapFont?t.fontFamily:e._fontFamily;var i=t.fontSize*t.node.scaleY;if(this._textLabelFont!==e||this._textLabelFontSize!==i||this._textLabelFontColor!==t.fontColor||this._textLabelAlign!==t.horizontalAlign){this._textLabelFont=e,this._textLabelFontSize=i,this._textLabelFontColor=t.fontColor,this._textLabelAlign=t.horizontalAlign;var n=this._elem;switch(n.style.fontSize=i+"px",n.style.color=t.node.color.toCSS(),n.style.fontFamily=e,t.horizontalAlign){case s.HorizontalAlign.LEFT:n.style.textAlign="left";break;case s.HorizontalAlign.CENTER:n.style.textAlign="center";break;case s.HorizontalAlign.RIGHT:n.style.textAlign="right"}}}},_updatePlaceholderLabel:function(t){if(t){var e=t.font;e=!e||e instanceof cc.BitmapFont?t.fontFamily:t.font._fontFamily;var i=t.fontSize*t.node.scaleY;if(this._placeholderLabelFont!==e||this._placeholderLabelFontSize!==i||this._placeholderLabelFontColor!==t.fontColor||this._placeholderLabelAlign!==t.horizontalAlign||this._placeholderLineHeight!==t.fontSize){this._placeholderLabelFont=e,this._placeholderLabelFontSize=i,this._placeholderLabelFontColor=t.fontColor,this._placeholderLabelAlign=t.horizontalAlign,this._placeholderLineHeight=t.fontSize;var n,r=this._placeholderStyleSheet,a=t.node.color.toCSS(),o=t.fontSize;switch(t.horizontalAlign){case s.HorizontalAlign.LEFT:n="left";break;case s.HorizontalAlign.CENTER:n="center";break;case s.HorizontalAlign.RIGHT:n="right"}r.innerHTML="#"+this._domId+"::-webkit-input-placeholder,#"+this._domId+"::-moz-placeholder,#"+this._domId+":-ms-input-placeholder{text-transform: initial; font-family: "+e+"; font-size: "+i+"px; color: "+a+"; line-height: "+o+"px; text-align: "+n+";}",cc.sys.browserType===cc.sys.BROWSER_TYPE_EDGE&&(r.innerHTML+="#"+this._domId+"::-ms-clear{display: none;}")}}},_registerEventListeners:function(){var t=this,e=this._elem,i=!1,n=this._eventListeners;n.compositionStart=function(){i=!0},n.compositionEnd=function(){i=!1,t._delegate.editBoxTextChanged(e.value)},n.onInput=function(){if(!i){var n=t._delegate.maxLength;n>=0&&(e.value=e.value.slice(0,n)),t._delegate.editBoxTextChanged(e.value)}},n.onClick=function(){t._editing&&cc.sys.isMobile&&t._adjustWindowScroll()},n.onKeydown=function(i){i.keyCode===r.KEY.enter?(i.stopPropagation(),t._delegate.editBoxEditingReturn(),t._isTextArea||e.blur()):i.keyCode===r.KEY.tab&&(i.stopPropagation(),i.preventDefault(),o.next(t))},n.onBlur=function(){cc.sys.isMobile&&i&&n.compositionEnd(),t._editing=!1,m=null,t._hideDom(),t._delegate.editBoxEditingDidEnded()},e.addEventListener("compositionstart",n.compositionStart),e.addEventListener("compositionend",n.compositionEnd),e.addEventListener("input",n.onInput),e.addEventListener("keydown",n.onKeydown),e.addEventListener("blur",n.onBlur),e.addEventListener("touchstart",n.onClick)},_removeEventListeners:function(){var t=this._elem,e=this._eventListeners;t.removeEventListener("compositionstart",e.compositionStart),t.removeEventListener("compositionend",e.compositionEnd),t.removeEventListener("input",e.onInput),t.removeEventListener("keydown",e.onKeydown),t.removeEventListener("blur",e.onBlur),t.removeEventListener("touchstart",e.onClick),e.compositionStart=null,e.compositionEnd=null,e.onInput=null,e.onKeydown=null,e.onBlur=null,e.onClick=null}})}),{"../../platform/CCMacro":198,"../../platform/utils":217,"../../value-types/mat4":295,"../CCLabel":131,"./tabIndexUtil":156,"./types":157}],156:[(function(t,e){"use strict";e.exports={_tabIndexList:[],add:function(t){var e=this._tabIndexList;-1===e.indexOf(t)&&e.push(t)},remove:function(t){var e=this._tabIndexList,i=e.indexOf(t);-1!==i&&e.splice(i,1)},resort:function(){this._tabIndexList.sort((function(t,e){return t._delegate._tabIndex-e._delegate._tabIndex}))},next:function(t){var e=this._tabIndexList,i=e.indexOf(t);if(t.setFocus(!1),-1!==i){var n=e[i+1];n&&n._delegate._tabIndex>=0&&n.setFocus(!0)}}}}),{}],157:[(function(t,e){"use strict";var i=cc.Enum({DEFAULT:0,DONE:1,SEND:2,SEARCH:3,GO:4,NEXT:5}),n=cc.Enum({ANY:0,EMAIL_ADDR:1,NUMERIC:2,PHONE_NUMBER:3,URL:4,DECIMAL:5,SINGLE_LINE:6}),r=cc.Enum({PASSWORD:0,SENSITIVE:1,INITIAL_CAPS_WORD:2,INITIAL_CAPS_SENTENCE:3,INITIAL_CAPS_ALL_CHARACTERS:4,DEFAULT:5});e.exports={KeyboardReturnType:i,InputMode:n,InputFlag:r}}),{}],158:[(function(t,e){"use strict";t("./CCComponent"),t("./CCComponentEventHandler"),t("./missing-script");var i=t("./SubContextView");i||(i=cc.Class({name:"cc.SubContextView",extends:cc.Component}),cc.SubContextView=cc.WXSubContextView=cc.SwanSubContextView=i);var n=[t("./CCSprite"),t("./CCWidget"),t("./CCCanvas"),t("./CCAudioSource"),t("./CCAnimation"),t("./CCButton"),t("./CCLabel"),t("./CCProgressBar"),t("./CCMask"),t("./CCScrollBar"),t("./CCScrollView"),t("./CCPageViewIndicator"),t("./CCPageView"),t("./CCSlider"),t("./CCLayout"),t("./editbox/CCEditBox"),t("./CCLabelOutline"),t("./CCLabelShadow"),t("./CCRichText"),t("./CCToggleContainer"),t("./CCToggleGroup"),t("./CCToggle"),t("./CCBlockInputEvents"),t("./CCMotionStreak"),t("./CCSafeArea"),i];e.exports=n}),{"./CCAnimation":124,"./CCAudioSource":125,"./CCBlockInputEvents":126,"./CCButton":127,"./CCCanvas":128,"./CCComponent":129,"./CCComponentEventHandler":130,"./CCLabel":131,"./CCLabelOutline":132,"./CCLabelShadow":133,"./CCLayout":134,"./CCMask":135,"./CCMotionStreak":136,"./CCPageView":137,"./CCPageViewIndicator":138,"./CCProgressBar":139,"./CCRichText":141,"./CCSafeArea":142,"./CCScrollBar":143,"./CCScrollView":144,"./CCSlider":145,"./CCSprite":146,"./CCToggle":147,"./CCToggleContainer":148,"./CCToggleGroup":149,"./CCWidget":151,"./SubContextView":152,"./editbox/CCEditBox":153,"./missing-script":159}],159:[(function(t,e){"use strict";var i=cc.js,n=cc.Class({name:"cc.MissingScript",extends:cc.Component,editor:{inspector:"packages://inspector/inspectors/comps/missing-script.js"},properties:{compiled:{default:!1,serializable:!1},_$erialized:{default:null,visible:!1,editorOnly:!0}},ctor:!1,statics:{safeFindClass:function(t){return i._getClassById(t)||(cc.deserialize.reportMissingClass(t),n)}},onLoad:function(){cc.warnID(4600,this.node.name)}});cc._MissingScript=e.exports=n}),{}],160:[(function(t,e){"use strict";var i=cc.js;t("../event/event");var n=function(t,e){cc.Event.call(this,cc.Event.MOUSE,e),this._eventType=t,this._button=0,this._x=0,this._y=0,this._prevX=0,this._prevY=0,this._scrollX=0,this._scrollY=0};i.extend(n,cc.Event);var r=n.prototype;r.setScrollData=function(t,e){this._scrollX=t,this._scrollY=e},r.getScrollX=function(){return this._scrollX},r.getScrollY=function(){return this._scrollY},r.setLocation=function(t,e){this._x=t,this._y=e},r.getLocation=function(){return cc.v2(this._x,this._y)},r.getLocationInView=function(){return cc.v2(this._x,cc.view._designResolutionSize.height-this._y)},r._setPrevCursor=function(t,e){this._prevX=t,this._prevY=e},r.getPreviousLocation=function(){return cc.v2(this._prevX,this._prevY)},r.getDelta=function(){return cc.v2(this._x-this._prevX,this._y-this._prevY)},r.getDeltaX=function(){return this._x-this._prevX},r.getDeltaY=function(){return this._y-this._prevY},r.setButton=function(t){this._button=t},r.getButton=function(){return this._button},r.getLocationX=function(){return this._x},r.getLocationY=function(){return this._y},n.NONE=0,n.DOWN=1,n.UP=2,n.MOVE=3,n.SCROLL=4,n.BUTTON_LEFT=0,n.BUTTON_RIGHT=2,n.BUTTON_MIDDLE=1,n.BUTTON_4=3,n.BUTTON_5=4,n.BUTTON_6=5,n.BUTTON_7=6,n.BUTTON_8=7;var a=function(t,e){cc.Event.call(this,cc.Event.TOUCH,e),this._eventCode=0,this._touches=t||[],this.touch=null,this.currentTouch=null};i.extend(a,cc.Event),(r=a.prototype).getEventCode=function(){return this._eventCode},r.getTouches=function(){return this._touches},r._setEventCode=function(t){this._eventCode=t},r._setTouches=function(t){this._touches=t},r.setLocation=function(t,e){this.touch&&this.touch.setTouchInfo(this.touch.getID(),t,e)},r.getLocation=function(){return this.touch?this.touch.getLocation():cc.v2()},r.getLocationInView=function(){return this.touch?this.touch.getLocationInView():cc.v2()},r.getPreviousLocation=function(){return this.touch?this.touch.getPreviousLocation():cc.v2()},r.getStartLocation=function(){return this.touch?this.touch.getStartLocation():cc.v2()},r.getID=function(){return this.touch?this.touch.getID():null},r.getDelta=function(){return this.touch?this.touch.getDelta():cc.v2()},r.getDeltaX=function(){return this.touch?this.touch.getDelta().x:0},r.getDeltaY=function(){return this.touch?this.touch.getDelta().y:0},r.getLocationX=function(){return this.touch?this.touch.getLocationX():0},r.getLocationY=function(){return this.touch?this.touch.getLocationY():0},a.MAX_TOUCHES=5,a.BEGAN=0,a.MOVED=1,a.ENDED=2,a.CANCELED=3;var s=function(t,e){cc.Event.call(this,cc.Event.ACCELERATION,e),this.acc=t};i.extend(s,cc.Event);var o=function(t,e,i){cc.Event.call(this,cc.Event.KEYBOARD,i),this.keyCode=t,this.isPressed=e};i.extend(o,cc.Event),cc.Event.EventMouse=n,cc.Event.EventTouch=a,cc.Event.EventAcceleration=s,cc.Event.EventKeyboard=o,e.exports=cc.Event}),{"../event/event":167}],161:[(function(t,e){"use strict";var i=t("../platform/js");cc.EventListener=function(t,e,i){this._onEvent=i,this._type=t||0,this._listenerID=e||"",this._registered=!1,this._fixedPriority=0,this._node=null,this._target=null,this._paused=!0,this._isEnabled=!0},cc.EventListener.prototype={constructor:cc.EventListener,_setPaused:function(t){this._paused=t},_isPaused:function(){return this._paused},_setRegistered:function(t){this._registered=t},_isRegistered:function(){return this._registered},_getType:function(){return this._type},_getListenerID:function(){return this._listenerID},_setFixedPriority:function(t){this._fixedPriority=t},_getFixedPriority:function(){return this._fixedPriority},_setSceneGraphPriority:function(t){this._target=t,this._node=t},_getSceneGraphPriority:function(){return this._node},checkAvailable:function(){return null!==this._onEvent},clone:function(){return null},setEnabled:function(t){this._isEnabled=t},isEnabled:function(){return this._isEnabled},retain:function(){},release:function(){}},cc.EventListener.UNKNOWN=0,cc.EventListener.TOUCH_ONE_BY_ONE=1,cc.EventListener.TOUCH_ALL_AT_ONCE=2,cc.EventListener.KEYBOARD=3,cc.EventListener.MOUSE=4,cc.EventListener.ACCELERATION=6,cc.EventListener.CUSTOM=8;var n=cc.EventListener.ListenerID={MOUSE:"__cc_mouse",TOUCH_ONE_BY_ONE:"__cc_touch_one_by_one",TOUCH_ALL_AT_ONCE:"__cc_touch_all_at_once",KEYBOARD:"__cc_keyboard",ACCELERATION:"__cc_acceleration"},r=function(t,e){this._onCustomEvent=e,cc.EventListener.call(this,cc.EventListener.CUSTOM,t,this._callback)};i.extend(r,cc.EventListener),i.mixin(r.prototype,{_onCustomEvent:null,_callback:function(t){null!==this._onCustomEvent&&this._onCustomEvent(t)},checkAvailable:function(){return cc.EventListener.prototype.checkAvailable.call(this)&&null!==this._onCustomEvent},clone:function(){return new r(this._listenerID,this._onCustomEvent)}});var a=function(){cc.EventListener.call(this,cc.EventListener.MOUSE,n.MOUSE,this._callback)};i.extend(a,cc.EventListener),i.mixin(a.prototype,{onMouseDown:null,onMouseUp:null,onMouseMove:null,onMouseScroll:null,_callback:function(t){var e=cc.Event.EventMouse;switch(t._eventType){case e.DOWN:this.onMouseDown&&this.onMouseDown(t);break;case e.UP:this.onMouseUp&&this.onMouseUp(t);break;case e.MOVE:this.onMouseMove&&this.onMouseMove(t);break;case e.SCROLL:this.onMouseScroll&&this.onMouseScroll(t)}},clone:function(){var t=new a;return t.onMouseDown=this.onMouseDown,t.onMouseUp=this.onMouseUp,t.onMouseMove=this.onMouseMove,t.onMouseScroll=this.onMouseScroll,t},checkAvailable:function(){return!0}});var s=function(){cc.EventListener.call(this,cc.EventListener.TOUCH_ONE_BY_ONE,n.TOUCH_ONE_BY_ONE,null),this._claimedTouches=[]};i.extend(s,cc.EventListener),i.mixin(s.prototype,{constructor:s,_claimedTouches:null,swallowTouches:!1,onTouchBegan:null,onTouchMoved:null,onTouchEnded:null,onTouchCancelled:null,setSwallowTouches:function(t){this.swallowTouches=t},isSwallowTouches:function(){return this.swallowTouches},clone:function(){var t=new s;return t.onTouchBegan=this.onTouchBegan,t.onTouchMoved=this.onTouchMoved,t.onTouchEnded=this.onTouchEnded,t.onTouchCancelled=this.onTouchCancelled,t.swallowTouches=this.swallowTouches,t},checkAvailable:function(){return!!this.onTouchBegan||(cc.logID(1801),!1)}});var o=function(){cc.EventListener.call(this,cc.EventListener.TOUCH_ALL_AT_ONCE,n.TOUCH_ALL_AT_ONCE,null)};i.extend(o,cc.EventListener),i.mixin(o.prototype,{constructor:o,onTouchesBegan:null,onTouchesMoved:null,onTouchesEnded:null,onTouchesCancelled:null,clone:function(){var t=new o;return t.onTouchesBegan=this.onTouchesBegan,t.onTouchesMoved=this.onTouchesMoved,t.onTouchesEnded=this.onTouchesEnded,t.onTouchesCancelled=this.onTouchesCancelled,t},checkAvailable:function(){return null!==this.onTouchesBegan||null!==this.onTouchesMoved||null!==this.onTouchesEnded||null!==this.onTouchesCancelled||(cc.logID(1802),!1)}});var c=function(t){this._onAccelerationEvent=t,cc.EventListener.call(this,cc.EventListener.ACCELERATION,n.ACCELERATION,this._callback)};i.extend(c,cc.EventListener),i.mixin(c.prototype,{constructor:c,_onAccelerationEvent:null,_callback:function(t){this._onAccelerationEvent(t.acc,t)},checkAvailable:function(){return cc.assertID(this._onAccelerationEvent,1803),!0},clone:function(){return new c(this._onAccelerationEvent)}});var l=function(){cc.EventListener.call(this,cc.EventListener.KEYBOARD,n.KEYBOARD,this._callback)};i.extend(l,cc.EventListener),i.mixin(l.prototype,{constructor:l,onKeyPressed:null,onKeyReleased:null,_callback:function(t){t.isPressed?this.onKeyPressed&&this.onKeyPressed(t.keyCode,t):this.onKeyReleased&&this.onKeyReleased(t.keyCode,t)},clone:function(){var t=new l;return t.onKeyPressed=this.onKeyPressed,t.onKeyReleased=this.onKeyReleased,t},checkAvailable:function(){return null!==this.onKeyPressed||null!==this.onKeyReleased||(cc.logID(1800),!1)}}),cc.EventListener.create=function(t){cc.assertID(t&&t.event,1900);var e=t.event;delete t.event;var i=null;for(var n in e===cc.EventListener.TOUCH_ONE_BY_ONE?i=new s:e===cc.EventListener.TOUCH_ALL_AT_ONCE?i=new o:e===cc.EventListener.MOUSE?i=new a:e===cc.EventListener.CUSTOM?(i=new r(t.eventName,t.callback),delete t.eventName,delete t.callback):e===cc.EventListener.KEYBOARD?i=new l:e===cc.EventListener.ACCELERATION&&(i=new c(t.callback),delete t.callback),t)i[n]=t[n];return i},e.exports=cc.EventListener}),{"../platform/js":214}],162:[(function(t,e){"use strict";var i=t("../platform/js");t("./CCEventListener");var n=cc.EventListener.ListenerID,r=function(){this._fixedListeners=[],this._sceneGraphListeners=[],this.gt0Index=0};r.prototype={constructor:r,size:function(){return this._fixedListeners.length+this._sceneGraphListeners.length},empty:function(){return 0===this._fixedListeners.length&&0===this._sceneGraphListeners.length},push:function(t){0===t._getFixedPriority()?this._sceneGraphListeners.push(t):this._fixedListeners.push(t)},clearSceneGraphListeners:function(){this._sceneGraphListeners.length=0},clearFixedListeners:function(){this._fixedListeners.length=0},clear:function(){this._sceneGraphListeners.length=0,this._fixedListeners.length=0},getFixedPriorityListeners:function(){return this._fixedListeners},getSceneGraphPriorityListeners:function(){return this._sceneGraphListeners}};var a=function(t){var e=cc.Event,i=t.type;return i===e.ACCELERATION?n.ACCELERATION:i===e.KEYBOARD?n.KEYBOARD:i.startsWith(e.MOUSE)?n.MOUSE:(i.startsWith(e.TOUCH)&&cc.logID(2e3),"")},s={DIRTY_NONE:0,DIRTY_FIXED_PRIORITY:1,DIRTY_SCENE_GRAPH_PRIORITY:2,DIRTY_ALL:3,_listenersMap:{},_priorityDirtyFlagMap:{},_nodeListenersMap:{},_toAddedListeners:[],_toRemovedListeners:[],_dirtyListeners:{},_inDispatch:0,_isEnabled:!1,_currentTouch:null,_currentTouchListener:null,_internalCustomListenerIDs:[],_setDirtyForNode:function(t){var e=this._nodeListenersMap[t._id];if(void 0!==e)for(var i=0,n=e.length;i<n;i++){var r=e[i]._getListenerID();null==this._dirtyListeners[r]&&(this._dirtyListeners[r]=!0)}if(t.childrenCount>0)for(var a=t._children,s=0,o=a.length;s<o;s++)this._setDirtyForNode(a[s])},pauseTarget:function(t,e){if(t instanceof cc._BaseNode){var i,n,r=this._nodeListenersMap[t._id];if(r)for(i=0,n=r.length;i<n;i++)r[i]._setPaused(!0);if(!0===e){var a=t._children;for(i=0,n=a?a.length:0;i<n;i++)this.pauseTarget(a[i],!0)}}else cc.warnID(3506)},resumeTarget:function(t,e){if(t instanceof cc._BaseNode){var i,n,r=this._nodeListenersMap[t._id];if(r)for(i=0,n=r.length;i<n;i++)r[i]._setPaused(!1);if(this._setDirtyForNode(t),!0===e){var a=t._children;for(i=0,n=a?a.length:0;i<n;i++)this.resumeTarget(a[i],!0)}}else cc.warnID(3506)},_addListener:function(t){0===this._inDispatch?this._forceAddEventListener(t):this._toAddedListeners.push(t)},_forceAddEventListener:function(t){var e=t._getListenerID(),i=this._listenersMap[e];if(i||(i=new r,this._listenersMap[e]=i),i.push(t),0===t._getFixedPriority()){this._setDirty(e,this.DIRTY_SCENE_GRAPH_PRIORITY);var n=t._getSceneGraphPriority();null===n&&cc.logID(3507),this._associateNodeAndEventListener(n,t),n.activeInHierarchy&&this.resumeTarget(n)}else this._setDirty(e,this.DIRTY_FIXED_PRIORITY)},_getListeners:function(t){return this._listenersMap[t]},_updateDirtyFlagForSceneGraph:function(){var t=this._dirtyListeners;for(var e in t)this._setDirty(e,this.DIRTY_SCENE_GRAPH_PRIORITY);this._dirtyListeners={}},_removeAllListenersInVector:function(t){if(t)for(var e,i=t.length-1;i>=0;i--)(e=t[i])._setRegistered(!1),null!=e._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(e._getSceneGraphPriority(),e),e._setSceneGraphPriority(null)),0===this._inDispatch&&cc.js.array.removeAt(t,i)},_removeListenersForListenerID:function(t){var e,i=this._listenersMap[t];if(i){var n=i.getFixedPriorityListeners(),r=i.getSceneGraphPriorityListeners();this._removeAllListenersInVector(r),this._removeAllListenersInVector(n),delete this._priorityDirtyFlagMap[t],this._inDispatch||(i.clear(),delete this._listenersMap[t])}var a,s=this._toAddedListeners;for(e=s.length-1;e>=0;e--)(a=s[e])&&a._getListenerID()===t&&cc.js.array.removeAt(s,e)},_sortEventListeners:function(t){var e=this.DIRTY_NONE,i=this._priorityDirtyFlagMap;i[t]&&(e=i[t]),e!==this.DIRTY_NONE&&(i[t]=this.DIRTY_NONE,e&this.DIRTY_FIXED_PRIORITY&&this._sortListenersOfFixedPriority(t),e&this.DIRTY_SCENE_GRAPH_PRIORITY&&cc.director.getScene()&&this._sortListenersOfSceneGraphPriority(t))},_sortListenersOfSceneGraphPriority:function(t){var e=this._getListeners(t);if(e){var i=e.getSceneGraphPriorityListeners();i&&0!==i.length&&e.getSceneGraphPriorityListeners().sort(this._sortEventListenersOfSceneGraphPriorityDes)}},_sortEventListenersOfSceneGraphPriorityDes:function(t,e){var i=t._getSceneGraphPriority(),n=e._getSceneGraphPriority();if(!(e&&n&&n._activeInHierarchy&&null!==n._parent))return-1;if(!t||!i||!i._activeInHierarchy||null===i._parent)return 1;for(var r=i,a=n,s=!1;r._parent._id!==a._parent._id;)r=null===r._parent._parent?(s=!0)&&n:r._parent,a=null===a._parent._parent?(s=!0)&&i:a._parent;if(r._id===a._id){if(r._id===n._id)return-1;if(r._id===i._id)return 1}return s?r._localZOrder-a._localZOrder:a._localZOrder-r._localZOrder},_sortListenersOfFixedPriority:function(t){var e=this._listenersMap[t];if(e){var i=e.getFixedPriorityListeners();if(i&&0!==i.length){i.sort(this._sortListenersOfFixedPriorityAsc);for(var n=0,r=i.length;n<r&&!(i[n]._getFixedPriority()>=0);)++n;e.gt0Index=n}}},_sortListenersOfFixedPriorityAsc:function(t,e){return t._getFixedPriority()-e._getFixedPriority()},_onUpdateListeners:function(t){var e,i,n,r=t.getFixedPriorityListeners(),a=t.getSceneGraphPriorityListeners(),s=this._toRemovedListeners;if(a)for(e=a.length-1;e>=0;e--)(i=a[e])._isRegistered()||(cc.js.array.removeAt(a,e),-1!==(n=s.indexOf(i))&&s.splice(n,1));if(r)for(e=r.length-1;e>=0;e--)(i=r[e])._isRegistered()||(cc.js.array.removeAt(r,e),-1!==(n=s.indexOf(i))&&s.splice(n,1));a&&0===a.length&&t.clearSceneGraphListeners(),r&&0===r.length&&t.clearFixedListeners()},frameUpdateListeners:function(){var t=this._listenersMap,e=this._priorityDirtyFlagMap;for(var i in t)t[i].empty()&&(delete e[i],delete t[i]);var n=this._toAddedListeners;if(0!==n.length){for(var r=0,a=n.length;r<a;r++)this._forceAddEventListener(n[r]);n.length=0}0!==this._toRemovedListeners.length&&this._cleanToRemovedListeners()},_updateTouchListeners:function(){var t=this._inDispatch;if(cc.assertID(t>0,3508),!(t>1)){var e;(e=this._listenersMap[n.TOUCH_ONE_BY_ONE])&&this._onUpdateListeners(e),(e=this._listenersMap[n.TOUCH_ALL_AT_ONCE])&&this._onUpdateListeners(e),cc.assertID(1===t,3509);var i=this._toAddedListeners;if(0!==i.length){for(var r=0,a=i.length;r<a;r++)this._forceAddEventListener(i[r]);this._toAddedListeners.length=0}0!==this._toRemovedListeners.length&&this._cleanToRemovedListeners()}},_cleanToRemovedListeners:function(){for(var t=this._toRemovedListeners,e=0;e<t.length;e++){var i=t[e],n=this._listenersMap[i._getListenerID()];if(n){var r,a=n.getFixedPriorityListeners(),s=n.getSceneGraphPriorityListeners();s&&-1!==(r=s.indexOf(i))&&s.splice(r,1),a&&-1!==(r=a.indexOf(i))&&a.splice(r,1)}}t.length=0},_onTouchEventCallback:function(t,e){if(!t._isRegistered())return!1;var i=e.event,n=i.currentTouch;i.currentTarget=t._node;var r,a=!1,o=i.getEventCode(),c=cc.Event.EventTouch;if(o===c.BEGAN){if(!cc.macro.ENABLE_MULTI_TOUCH&&s._currentTouch){var l=s._currentTouchListener._node;if(l&&l.activeInHierarchy)return!1}t.onTouchBegan&&(a=t.onTouchBegan(n,i))&&t._registered&&(t._claimedTouches.push(n),s._currentTouchListener=t,s._currentTouch=n)}else if(t._claimedTouches.length>0&&-1!==(r=t._claimedTouches.indexOf(n))){if(a=!0,!cc.macro.ENABLE_MULTI_TOUCH&&s._currentTouch&&s._currentTouch!==n)return!1;o===c.MOVED&&t.onTouchMoved?t.onTouchMoved(n,i):o===c.ENDED?(t.onTouchEnded&&t.onTouchEnded(n,i),t._registered&&t._claimedTouches.splice(r,1),s._clearCurTouch()):o===c.CANCELED&&(t.onTouchCancelled&&t.onTouchCancelled(n,i),t._registered&&t._claimedTouches.splice(r,1),s._clearCurTouch())}return i.isStopped()?(s._updateTouchListeners(i),!0):!(!a||!t.swallowTouches||(e.needsMutableSet&&e.touches.splice(n,1),0))},_dispatchTouchEvent:function(t){this._sortEventListeners(n.TOUCH_ONE_BY_ONE),this._sortEventListeners(n.TOUCH_ALL_AT_ONCE);var e=this._getListeners(n.TOUCH_ONE_BY_ONE),i=this._getListeners(n.TOUCH_ALL_AT_ONCE);if(null!==e||null!==i){var r=t.getTouches(),a=cc.js.array.copy(r),s={event:t,needsMutableSet:e&&i,touches:a,selTouch:null};if(e)for(var o=0;o<r.length;o++)t.currentTouch=r[o],t._propagationStopped=t._propagationImmediateStopped=!1,this._dispatchEventToListeners(e,this._onTouchEventCallback,s);i&&a.length>0&&(this._dispatchEventToListeners(i,this._onTouchesEventCallback,{event:t,touches:a}),t.isStopped())||this._updateTouchListeners(t)}},_onTouchesEventCallback:function(t,e){if(!t._registered)return!1;var i=cc.Event.EventTouch,n=e.event,r=e.touches,a=n.getEventCode();return n.currentTarget=t._node,a===i.BEGAN&&t.onTouchesBegan?t.onTouchesBegan(r,n):a===i.MOVED&&t.onTouchesMoved?t.onTouchesMoved(r,n):a===i.ENDED&&t.onTouchesEnded?t.onTouchesEnded(r,n):a===i.CANCELED&&t.onTouchesCancelled&&t.onTouchesCancelled(r,n),!!n.isStopped()&&(s._updateTouchListeners(n),!0)},_associateNodeAndEventListener:function(t,e){var i=this._nodeListenersMap[t._id];i||(i=[],this._nodeListenersMap[t._id]=i),i.push(e)},_dissociateNodeAndEventListener:function(t,e){var i=this._nodeListenersMap[t._id];i&&(cc.js.array.remove(i,e),0===i.length&&delete this._nodeListenersMap[t._id])},_dispatchEventToListeners:function(t,e,i){var n,r,a=!1,s=t.getFixedPriorityListeners(),o=t.getSceneGraphPriorityListeners(),c=0;if(s&&0!==s.length)for(;c<t.gt0Index;++c)if((r=s[c]).isEnabled()&&!r._isPaused()&&r._isRegistered()&&e(r,i)){a=!0;break}if(o&&!a)for(n=0;n<o.length;n++)if((r=o[n]).isEnabled()&&!r._isPaused()&&r._isRegistered()&&e(r,i)){a=!0;break}if(s&&!a)for(;c<s.length;++c)if((r=s[c]).isEnabled()&&!r._isPaused()&&r._isRegistered()&&e(r,i)){a=!0;break}},_setDirty:function(t,e){var i=this._priorityDirtyFlagMap;null==i[t]?i[t]=e:i[t]=e|i[t]},_sortNumberAsc:function(t,e){return t-e},hasEventListener:function(t){return!!this._getListeners(t)},addListener:function(t,e){if(cc.assertID(t&&e,3503),cc.js.isNumber(e)||e instanceof cc._BaseNode){if(t instanceof cc.EventListener){if(t._isRegistered())return void cc.logID(3505)}else cc.assertID(!cc.js.isNumber(e),3504),t=cc.EventListener.create(t);if(t.checkAvailable()){if(cc.js.isNumber(e)){if(0===e)return void cc.logID(3500);t._setSceneGraphPriority(null),t._setFixedPriority(e),t._setRegistered(!0),t._setPaused(!1),this._addListener(t)}else t._setSceneGraphPriority(e),t._setFixedPriority(0),t._setRegistered(!0),this._addListener(t);return t}}else cc.warnID(3506)},addCustomListener:function(t,e){var i=new cc.EventListener.create({event:cc.EventListener.CUSTOM,eventName:t,callback:e});return this.addListener(i,1),i},removeListener:function(t){if(null!=t){var e,i=this._listenersMap;for(var n in i){var r=i[n],a=r.getFixedPriorityListeners(),s=r.getSceneGraphPriorityListeners();if((e=this._removeListenerInVector(s,t))?this._setDirty(t._getListenerID(),this.DIRTY_SCENE_GRAPH_PRIORITY):(e=this._removeListenerInVector(a,t))&&this._setDirty(t._getListenerID(),this.DIRTY_FIXED_PRIORITY),r.empty()&&(delete this._priorityDirtyFlagMap[t._getListenerID()],delete i[n]),e)break}if(!e)for(var o=this._toAddedListeners,c=o.length-1;c>=0;c--){var l=o[c];if(l===t){cc.js.array.removeAt(o,c),l._setRegistered(!1);break}}this._currentTouchListener===t&&this._clearCurTouch()}},_clearCurTouch:function(){this._currentTouchListener=null,this._currentTouch=null},_removeListenerInCallback:function(t,e){if(null==t)return!1;for(var i=t.length-1;i>=0;i--){var n=t[i];if(n._onCustomEvent===e||n._onEvent===e)return n._setRegistered(!1),null!=n._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(n._getSceneGraphPriority(),n),n._setSceneGraphPriority(null)),0===this._inDispatch?cc.js.array.removeAt(t,i):this._toRemovedListeners.push(n),!0}return!1},_removeListenerInVector:function(t,e){if(null==t)return!1;for(var i=t.length-1;i>=0;i--){var n=t[i];if(n===e)return n._setRegistered(!1),null!=n._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(n._getSceneGraphPriority(),n),n._setSceneGraphPriority(null)),0===this._inDispatch?cc.js.array.removeAt(t,i):this._toRemovedListeners.push(n),!0}return!1},removeListeners:function(t,e){var i=this;if(cc.js.isNumber(t)||t instanceof cc._BaseNode)if(void 0!==t._id){var r,a=i._nodeListenersMap[t._id];if(a){var s=cc.js.array.copy(a);for(r=0;r<s.length;r++)i.removeListener(s[r]);delete i._nodeListenersMap[t._id]}var o=i._toAddedListeners;for(r=0;r<o.length;){var c=o[r];c._getSceneGraphPriority()===t?(c._setSceneGraphPriority(null),c._setRegistered(!1),o.splice(r,1)):++r}if(!0===e){var l,u=t.children;for(r=0,l=u.length;r<l;r++)i.removeListeners(u[r],!0)}}else t===cc.EventListener.TOUCH_ONE_BY_ONE?i._removeListenersForListenerID(n.TOUCH_ONE_BY_ONE):t===cc.EventListener.TOUCH_ALL_AT_ONCE?i._removeListenersForListenerID(n.TOUCH_ALL_AT_ONCE):t===cc.EventListener.MOUSE?i._removeListenersForListenerID(n.MOUSE):t===cc.EventListener.ACCELERATION?i._removeListenersForListenerID(n.ACCELERATION):t===cc.EventListener.KEYBOARD?i._removeListenersForListenerID(n.KEYBOARD):cc.logID(3501);else cc.warnID(3506)},removeCustomListeners:function(t){this._removeListenersForListenerID(t)},removeAllListeners:function(){var t=this._listenersMap,e=this._internalCustomListenerIDs;for(var i in t)-1===e.indexOf(i)&&this._removeListenersForListenerID(i)},setPriority:function(t,e){if(null!=t){var i=this._listenersMap;for(var n in i){var r=i[n].getFixedPriorityListeners();if(r&&-1!==r.indexOf(t))return null!=t._getSceneGraphPriority()&&cc.logID(3502),void(t._getFixedPriority()!==e&&(t._setFixedPriority(e),this._setDirty(t._getListenerID(),this.DIRTY_FIXED_PRIORITY)))}}},setEnabled:function(t){this._isEnabled=t},isEnabled:function(){return this._isEnabled},dispatchEvent:function(t){if(this._isEnabled)if(this._updateDirtyFlagForSceneGraph(),this._inDispatch++,t&&t.getType){if(t.getType().startsWith(cc.Event.TOUCH))return this._dispatchTouchEvent(t),void this._inDispatch--;var e=a(t);this._sortEventListeners(e);var i=this._listenersMap[e];null!=i&&(this._dispatchEventToListeners(i,this._onListenerCallback,t),this._onUpdateListeners(i)),this._inDispatch--}else cc.errorID(3511)},_onListenerCallback:function(t,e){return e.currentTarget=t._target,t._onEvent(e),e.isStopped()},dispatchCustomEvent:function(t,e){var i=new cc.Event.EventCustom(t);i.setUserData(e),this.dispatchEvent(i)}};i.get(cc,"eventManager",(function(){return cc.errorID(1405,"cc.eventManager","cc.EventTarget or cc.systemEvent"),s})),e.exports=cc.internal.eventManager=s}),{"../platform/js":214,"./CCEventListener":161}],163:[(function(){"use strict";cc.Touch=function(t,e,i){this._lastModified=0,this.setTouchInfo(i,t,e)},cc.Touch.prototype={constructor:cc.Touch,getLocation:function(){return cc.v2(this._point.x,this._point.y)},getLocationX:function(){return this._point.x},getLocationY:function(){return this._point.y},getPreviousLocation:function(){return cc.v2(this._prevPoint.x,this._prevPoint.y)},getStartLocation:function(){return cc.v2(this._startPoint.x,this._startPoint.y)},getDelta:function(){return this._point.sub(this._prevPoint)},getLocationInView:function(){return cc.v2(this._point.x,cc.view._designResolutionSize.height-this._point.y)},getPreviousLocationInView:function(){return cc.v2(this._prevPoint.x,cc.view._designResolutionSize.height-this._prevPoint.y)},getStartLocationInView:function(){return cc.v2(this._startPoint.x,cc.view._designResolutionSize.height-this._startPoint.y)},getID:function(){return this._id},setTouchInfo:function(t,e,i){this._prevPoint=this._point,this._point=cc.v2(e||0,i||0),this._id=t,this._startPointCaptured||(this._startPoint=cc.v2(this._point),cc.view._convertPointWithScale(this._startPoint),this._startPointCaptured=!0)},_setPoint:function(t,e){void 0===e?(this._point.x=t.x,this._point.y=t.y):(this._point.x=t,this._point.y=e)},_setPrevPoint:function(t,e){this._prevPoint=void 0===e?cc.v2(t.x,t.y):cc.v2(t||0,e||0)}}}),{}],164:[(function(t,e){"use strict";t("./CCEvent"),t("./CCTouch"),t("./CCEventListener");var i=t("./CCEventManager");e.exports=i}),{"./CCEvent":160,"./CCEventListener":161,"./CCEventManager":162,"./CCTouch":163}],165:[(function(t,e){"use strict";var i=cc.js,n=t("../platform/callbacks-invoker");function r(){n.call(this)}i.extend(r,n),r.prototype.emit=function(t,e){var i=t.type,n=this._callbackTable[i];if(n){var r=!n.isInvoking;n.isInvoking=!0;for(var a=n.callbackInfos,s=0,o=a.length;s<o;++s){var c=a[s];if(c&&c.callback&&(c.callback.call(c.target,t,e),t._propagationImmediateStopped))break}r&&(n.isInvoking=!1,n.containCanceled&&n.purgeCanceled())}},e.exports=r}),{"../platform/callbacks-invoker":206}],166:[(function(t,e){"use strict";var i=t("../platform/js"),n=t("../platform/callbacks-invoker"),r=i.array.fastRemove;function a(){n.call(this)}i.extend(a,n);var s=a.prototype;s.__on=s.on,s.on=function(t,e,i,n){if(e)return this.hasEventListener(t,e,i)||(this.__on(t,e,i,n),i&&i.__eventTargets&&i.__eventTargets.push(this)),e;cc.errorID(6800)},s.__off=s.off,s.off=function(t,e,i){if(e)this.__off(t,e,i),i&&i.__eventTargets&&r(i.__eventTargets,this);else{var n=this._callbackTable[t];if(!n)return;for(var a=n.callbackInfos,s=0;s<a.length;++s){var o=a[s]&&a[s].target;o&&o.__eventTargets&&r(o.__eventTargets,this)}this.removeAll(t)}},s.targetOff=function(t){this.removeAll(t),t&&t.__eventTargets&&r(t.__eventTargets,this)},s.once=function(t,e,i){this.on(t,e,i,!0)},s.dispatchEvent=function(t){this.emit(t.type,t)},s.clear=function(){for(var t in this._callbackTable)for(var e=this._callbackTable[t].callbackInfos,i=e.length-1;i>=0;i--){var n=e[i];n&&this.off(t,n.callback,n.target)}},cc.EventTarget=e.exports=a}),{"../platform/callbacks-invoker":206,"../platform/js":214}],167:[(function(t,e){"use strict";var i=t("../platform/js");cc.Event=function(t,e){this.type=t,this.bubbles=!!e,this.target=null,this.currentTarget=null,this.eventPhase=0,this._propagationStopped=!1,this._propagationImmediateStopped=!1},cc.Event.prototype={constructor:cc.Event,unuse:function(){this.type=cc.Event.NO_TYPE,this.target=null,this.currentTarget=null,this.eventPhase=cc.Event.NONE,this._propagationStopped=!1,this._propagationImmediateStopped=!1},reuse:function(t,e){this.type=t,this.bubbles=e||!1},stopPropagation:function(){this._propagationStopped=!0},stopPropagationImmediate:function(){this._propagationImmediateStopped=!0},isStopped:function(){return this._propagationStopped||this._propagationImmediateStopped},getCurrentTarget:function(){return this.currentTarget},getType:function(){return this.type}},cc.Event.NO_TYPE="no_type",cc.Event.TOUCH="touch",cc.Event.MOUSE="mouse",cc.Event.KEYBOARD="keyboard",cc.Event.ACCELERATION="acceleration",cc.Event.NONE=0,cc.Event.CAPTURING_PHASE=1,cc.Event.AT_TARGET=2,cc.Event.BUBBLING_PHASE=3;var n=function(t,e){cc.Event.call(this,t,e),this.detail=null};i.extend(n,cc.Event),n.prototype.reset=n,n.prototype.setUserData=function(t){this.detail=t},n.prototype.getUserData=function(){return this.detail},n.prototype.getEventName=cc.Event.prototype.getType;var r=new i.Pool(10);n.put=function(t){r.put(t)},n.get=function(t,e){var i=r._get();return i?i.reset(t,e):i=new n(t,e),i},cc.Event.EventCustom=n,e.exports=cc.Event}),{"../platform/js":214}],168:[(function(t){"use strict";t("./event"),t("./event-listeners"),t("./event-target"),t("./system-event")}),{"./event":167,"./event-listeners":165,"./event-target":166,"./system-event":169}],169:[(function(t,e){"use strict";var i=t("../event/event-target"),n=t("../event-manager"),r=t("../platform/CCInputManager"),a=cc.Enum({KEY_DOWN:"keydown",KEY_UP:"keyup",DEVICEMOTION:"devicemotion"}),s=null,o=null,c=cc.Class({name:"SystemEvent",extends:i,statics:{EventType:a},setAccelerometerEnabled:function(t){t&&window.DeviceMotionEvent&&"function"==typeof DeviceMotionEvent.requestPermission?DeviceMotionEvent.requestPermission().then((function(t){console.log("Device Motion Event request permission: "+t),r.setAccelerometerEnabled("granted"===t)})):r.setAccelerometerEnabled(t)},setAccelerometerInterval:function(t){r.setAccelerometerInterval(t)},on:function(t,e,i,r){this._super(t,e,i,r),t!==a.KEY_DOWN&&t!==a.KEY_UP||(s||(s=cc.EventListener.create({event:cc.EventListener.KEYBOARD,onKeyPressed:function(t,e){e.type=a.KEY_DOWN,cc.systemEvent.dispatchEvent(e)},onKeyReleased:function(t,e){e.type=a.KEY_UP,cc.systemEvent.dispatchEvent(e)}})),n.hasEventListener(cc.EventListener.ListenerID.KEYBOARD)||n.addListener(s,1)),t===a.DEVICEMOTION&&(o||(o=cc.EventListener.create({event:cc.EventListener.ACCELERATION,callback:function(t,e){e.type=a.DEVICEMOTION,cc.systemEvent.dispatchEvent(e)}})),n.hasEventListener(cc.EventListener.ListenerID.ACCELERATION)||n.addListener(o,1))},off:function(t,e,i){if(this._super(t,e,i),s&&(t===a.KEY_DOWN||t===a.KEY_UP)){var r=this.hasEventListener(a.KEY_DOWN),c=this.hasEventListener(a.KEY_UP);r||c||n.removeListener(s)}o&&t===a.DEVICEMOTION&&n.removeListener(o)}});cc.SystemEvent=e.exports=c,cc.systemEvent=new cc.SystemEvent}),{"../event-manager":164,"../event/event-target":166,"../platform/CCInputManager":197}],170:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=s(t("../value-types/vec3")),r=s(t("../value-types/mat3")),a=s(t("./enums"));function s(t){return t&&t.__esModule?t:{default:t}}var o=new n.default,c=new n.default,l=new r.default,u=function(t,e,i){var r=l.m,a=i.m;r[0]=Math.abs(a[0]),r[1]=Math.abs(a[1]),r[2]=Math.abs(a[2]),r[3]=Math.abs(a[4]),r[4]=Math.abs(a[5]),r[5]=Math.abs(a[6]),r[6]=Math.abs(a[8]),r[7]=Math.abs(a[9]),r[8]=Math.abs(a[10]),n.default.transformMat3(t,e,l)},h=(function(){function t(t,e,i,r,s,o){this.center=void 0,this.halfExtents=void 0,this._type=void 0,this._type=a.default.SHAPE_AABB,this.center=new n.default(t,e,i),this.halfExtents=new n.default(r,s,o)}t.create=function(e,i,n,r,a,s){return new t(e,i,n,r,a,s)},t.clone=function(e){return new t(e.center.x,e.center.y,e.center.z,e.halfExtents.x,e.halfExtents.y,e.halfExtents.z)},t.copy=function(t,e){return n.default.copy(t.center,e.center),n.default.copy(t.halfExtents,e.halfExtents),t},t.fromPoints=function(t,e,i){return n.default.scale(t.center,n.default.add(o,e,i),.5),n.default.scale(t.halfExtents,n.default.sub(c,i,e),.5),t},t.set=function(t,e,i,r,a,s,o){return n.default.set(t.center,e,i,r),n.default.set(t.halfExtents,a,s,o),t};var e=t.prototype;return e.getBoundary=function(t,e){n.default.sub(t,this.center,this.halfExtents),n.default.add(e,this.center,this.halfExtents)},e.transform=function(t,e,i,r,a){a||(a=this),n.default.transformMat4(a.center,this.center,t),u(a.halfExtents,this.halfExtents,t)},t})();i.default=h,e.exports=i.default}),{"../value-types/mat3":294,"../value-types/vec3":303,"./enums":172}],171:[(function(t,e,i){"use strict";i.__esModule=!0,i.point_plane=f,i.pt_point_plane=function(t,e,i){var r=f(e,i);return n.Vec3.subtract(t,e,n.Vec3.multiplyScalar(t,i.n,r))},i.pt_point_aabb=function(t,e,i){return n.Vec3.copy(t,e),n.Vec3.subtract(c,i.center,i.halfExtents),n.Vec3.add(l,i.center,i.halfExtents),t.x=t.x<c.x?c.x:t.x,t.y=t.y<c.x?c.y:t.y,t.z=t.z<c.x?c.z:t.z,t.x=t.x>l.x?l.x:t.x,t.y=t.y>l.x?l.y:t.y,t.z=t.z>l.x?l.z:t.z,t},i.pt_point_obb=function(t,e,i){var c=i.orientation.m;n.Vec3.set(r,c[0],c[1],c[2]),n.Vec3.set(a,c[3],c[4],c[5]),n.Vec3.set(s,c[6],c[7],c[8]),u[0]=r,u[1]=a,u[2]=s,h[0]=i.halfExtents.x,h[1]=i.halfExtents.y,h[2]=i.halfExtents.z,n.Vec3.subtract(o,e,i.center),n.Vec3.set(t,i.center.x,i.center.y,i.center.z);for(var l=0;l<3;l++){var f=n.Vec3.dot(o,u[l]);f>h[l]&&(f=h[l]),f<-h[l]&&(f=-h[l]),t.x+=f*u[l].x,t.y+=f*u[l].y,t.z+=f*u[l].z}return t};var n=t("../value-types"),r=new n.Vec3,a=new n.Vec3,s=new n.Vec3,o=new n.Vec3,c=new n.Vec3,l=new n.Vec3,u=new Array(3),h=new Array(3);function f(t,e){return n.Vec3.dot(e.n,t)-e.d}}),{"../value-types":293}],172:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0,i.default={SHAPE_RAY:1,SHAPE_LINE:2,SHAPE_SPHERE:4,SHAPE_AABB:8,SHAPE_OBB:16,SHAPE_PLANE:32,SHAPE_TRIANGLE:64,SHAPE_FRUSTUM:128,SHAPE_FRUSTUM_ACCURATE:256},e.exports=i.default}),{}],173:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=t("../value-types"),r=s(t("./enums")),a=s(t("./plane"));function s(t){return t&&t.__esModule?t:{default:t}}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var c=new Array(8);c[0]=new n.Vec3(1,1,1),c[1]=new n.Vec3(-1,1,1),c[2]=new n.Vec3(-1,-1,1),c[3]=new n.Vec3(1,-1,1),c[4]=new n.Vec3(1,1,-1),c[5]=new n.Vec3(-1,1,-1),c[6]=new n.Vec3(-1,-1,-1),c[7]=new n.Vec3(1,-1,-1);var l,u=(function(){var t,e;function i(){this.planes=void 0,this.vertices=void 0,this._type=void 0,this._type=r.default.SHAPE_FRUSTUM,this.planes=new Array(6);for(var t=0;t<6;++t)this.planes[t]=a.default.create(0,0,0,0);this.vertices=new Array(8);for(var e=0;e<8;++e)this.vertices[e]=new n.Vec3}i.create=function(){return new i},i.clone=function(t){return i.copy(new i,t)},i.copy=function(t,e){t._type=e._type;for(var i=0;i<6;++i)a.default.copy(t.planes[i],e.planes[i]);for(var r=0;r<8;++r)n.Vec3.copy(t.vertices[r],e.vertices[r]);return t},t=i,(e=[{key:"accurate",set:function(t){this._type=t?r.default.SHAPE_FRUSTUM_ACCURATE:r.default.SHAPE_FRUSTUM}}])&&o(t.prototype,e);var s=i.prototype;return s.update=function(t,e){var i=t.m;if(n.Vec3.set(this.planes[0].n,i[3]+i[0],i[7]+i[4],i[11]+i[8]),this.planes[0].d=-(i[15]+i[12]),n.Vec3.set(this.planes[1].n,i[3]-i[0],i[7]-i[4],i[11]-i[8]),this.planes[1].d=-(i[15]-i[12]),n.Vec3.set(this.planes[2].n,i[3]+i[1],i[7]+i[5],i[11]+i[9]),this.planes[2].d=-(i[15]+i[13]),n.Vec3.set(this.planes[3].n,i[3]-i[1],i[7]-i[5],i[11]-i[9]),this.planes[3].d=-(i[15]-i[13]),n.Vec3.set(this.planes[4].n,i[3]+i[2],i[7]+i[6],i[11]+i[10]),this.planes[4].d=-(i[15]+i[14]),n.Vec3.set(this.planes[5].n,i[3]-i[2],i[7]-i[6],i[11]-i[10]),this.planes[5].d=-(i[15]-i[14]),this._type===r.default.SHAPE_FRUSTUM_ACCURATE){for(var a=0;a<6;a++){var s=this.planes[a],o=1/s.n.length();n.Vec3.multiplyScalar(s.n,s.n,o),s.d*=o}for(var l=0;l<8;l++)n.Vec3.transformMat4(this.vertices[l],c[l],e)}},s.transform=function(t){if(this._type===r.default.SHAPE_FRUSTUM_ACCURATE){for(var e=0;e<8;e++)n.Vec3.transformMat4(this.vertices[e],this.vertices[e],t);a.default.fromPoints(this.planes[0],this.vertices[1],this.vertices[5],this.vertices[6]),a.default.fromPoints(this.planes[1],this.vertices[3],this.vertices[7],this.vertices[4]),a.default.fromPoints(this.planes[2],this.vertices[6],this.vertices[7],this.vertices[3]),a.default.fromPoints(this.planes[3],this.vertices[0],this.vertices[4],this.vertices[5]),a.default.fromPoints(this.planes[4],this.vertices[2],this.vertices[3],this.vertices[0]),a.default.fromPoints(this.planes[0],this.vertices[7],this.vertices[6],this.vertices[5])}},i})();i.default=u,u.createOrtho=(l=new n.Vec3,function(t,e,i,r,s,o){var c=e/2,u=i/2;n.Vec3.set(l,c,u,r),n.Vec3.transformMat4(t.vertices[0],l,o),n.Vec3.set(l,-c,u,r),n.Vec3.transformMat4(t.vertices[1],l,o),n.Vec3.set(l,-c,-u,r),n.Vec3.transformMat4(t.vertices[2],l,o),n.Vec3.set(l,c,-u,r),n.Vec3.transformMat4(t.vertices[3],l,o),n.Vec3.set(l,c,u,s),n.Vec3.transformMat4(t.vertices[4],l,o),n.Vec3.set(l,-c,u,s),n.Vec3.transformMat4(t.vertices[5],l,o),n.Vec3.set(l,-c,-u,s),n.Vec3.transformMat4(t.vertices[6],l,o),n.Vec3.set(l,c,-u,s),n.Vec3.transformMat4(t.vertices[7],l,o),a.default.fromPoints(t.planes[0],t.vertices[1],t.vertices[6],t.vertices[5]),a.default.fromPoints(t.planes[1],t.vertices[3],t.vertices[4],t.vertices[7]),a.default.fromPoints(t.planes[2],t.vertices[6],t.vertices[3],t.vertices[7]),a.default.fromPoints(t.planes[3],t.vertices[0],t.vertices[5],t.vertices[4]),a.default.fromPoints(t.planes[4],t.vertices[2],t.vertices[0],t.vertices[3]),a.default.fromPoints(t.planes[0],t.vertices[7],t.vertices[5],t.vertices[6])}),e.exports=i.default}),{"../value-types":293,"./enums":172,"./plane":178}],174:[(function(t,e,i){"use strict";i.__esModule=!0;var n={enums:!0,Triangle:!0,Aabb:!0,Ray:!0,intersect:!0,Sphere:!0,Obb:!0,Frustum:!0,Line:!0,Plane:!0};i.Plane=i.Line=i.Frustum=i.Obb=i.Sphere=i.intersect=i.Ray=i.Aabb=i.Triangle=i.enums=void 0;var r=p(t("./enums"));i.enums=r.default;var a=p(t("./triangle"));i.Triangle=a.default;var s=p(t("./aabb"));i.Aabb=s.default;var o=p(t("./ray"));i.Ray=o.default;var c=p(t("./intersect"));i.intersect=c.default;var l=p(t("./sphere"));i.Sphere=l.default;var u=p(t("./obb"));i.Obb=u.default;var h=p(t("./frustum"));i.Frustum=h.default;var f=p(t("./line"));i.Line=f.default;var d=p(t("./plane"));i.Plane=d.default;var _=t("./distance");function p(t){return t&&t.__esModule?t:{default:t}}Object.keys(_).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(n,t)||(i[t]=_[t]))})),cc.geomUtils=e.exports}),{"./aabb":170,"./distance":171,"./enums":172,"./frustum":173,"./intersect":175,"./line":176,"./obb":177,"./plane":178,"./ray":179,"./sphere":180,"./triangle":181}],175:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=f(t("../../renderer/gfx")),r=f(t("../../renderer/memop/recycle-pool")),a=t("../value-types"),s=f(t("./aabb")),o=(function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=h();if(e&&e.has(t))return e.get(t);var i={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var a=n?Object.getOwnPropertyDescriptor(t,r):null;a&&(a.get||a.set)?Object.defineProperty(i,r,a):i[r]=t[r]}return i.default=t,e&&e.set(t,i),i})(t("./distance")),c=f(t("./enums")),l=f(t("./ray")),u=f(t("./triangle"));function h(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return h=function(){return t},t}function f(t){return t&&t.__esModule?t:{default:t}}var d,_,p,m,v,g,y,T,b,E,A,C,x,S,w,M=(function(){var t=u.default.create(),e=1/0;function i(t,e,i,n){a.Vec3.set(t,e[i*n],e[i*n+1],e[i*n+2])}return function(r,a){e=1/0;for(var s=a._subMeshes,o=0;o<s.length;o++)if(s[o]._primitiveType===n.default.PT_TRIANGLES)for(var c=a._subDatas[o]||a._subDatas[0],l=a._getAttrMeshData(o,n.default.ATTR_POSITION),u=c.getIData(Uint16Array),h=c.vfm.element(n.default.ATTR_POSITION).num,f=0;f<u.length;f+=3){i(t.a,l,u[f],h),i(t.b,l,u[f+1],h),i(t.c,l,u[f+2],h);var d=D(r,t);d>0&&d<e&&(e=d)}return e}})(),R=(function(){function t(e,i){for(var n=e.children,r=n.length-1;r>=0;r--)t(n[r],i);i(e)}function e(t,e){return t.distance-e.distance}function i(t,e,i){var n=i.m,r=e.x,a=e.y,s=e.z,o=n[3]*r+n[7]*a+n[11]*s;return o=o?1/o:1,t.x=(n[0]*r+n[4]*a+n[8]*s)*o,t.y=(n[1]*r+n[5]*a+n[9]*s)*o,t.z=(n[2]*r+n[6]*a+n[10]*s)*o,t}var n=new r.default(function(){return{distance:0,node:null}},1),o=[],c=s.default.create(),u=new a.Vec3,h=new a.Vec3,f=new l.default,d=cc.mat4(),_=cc.mat4(),p=new a.Vec3;function m(t){return t>0&&t<1/0}return function(r,l,v,g){return n.reset(),o.length=0,t(r=r||cc.director.getScene(),(function(t){if(!g||g(t)){a.Mat4.invert(_,t.getWorldMatrix(d)),a.Vec3.transformMat4(f.o,l.o,_),a.Vec3.normalize(f.d,i(f.d,l.d,_));var e=1/0,r=t._renderComponent;if(r instanceof cc.MeshRenderer?e=B(f,r._boundingBox):t.width&&t.height&&(a.Vec3.set(u,-t.width*t.anchorX,-t.height*t.anchorY,t.z),a.Vec3.set(h,t.width*(1-t.anchorX),t.height*(1-t.anchorY),t.z),s.default.fromPoints(c,u,h),e=B(f,c)),m(e)&&(v&&(e=v(f,t,e)),m(e))){a.Vec3.scale(p,f.d,e),i(p,p,d);var y=n.add();y.node=t,y.distance=a.Vec3.mag(p),o.push(y)}}})),o.sort(e),o}})(),I=(d=new a.Vec3(0,0,0),function(t,e){var i=a.Vec3.dot(t.d,e.n);if(Math.abs(i)<Number.EPSILON)return 0;a.Vec3.multiplyScalar(d,e.n,e.d);var n=a.Vec3.dot(a.Vec3.subtract(d,d,t.o),e.n)/i;return n<0?0:n}),O=(_=new a.Vec3(0,0,0),function(t,e){a.Vec3.subtract(_,t.e,t.s);var i=(e.d-a.Vec3.dot(t.s,e.n))/a.Vec3.dot(_,e.n);return i<0||i>1?0:i}),D=(function(){var t=new a.Vec3(0,0,0),e=new a.Vec3(0,0,0),i=new a.Vec3(0,0,0),n=new a.Vec3(0,0,0),r=new a.Vec3(0,0,0);return function(s,o,c){a.Vec3.subtract(t,o.b,o.a),a.Vec3.subtract(e,o.c,o.a),a.Vec3.cross(i,s.d,e);var l=a.Vec3.dot(t,i);if(l<Number.EPSILON&&(!c||l>-Number.EPSILON))return 0;var u=1/l;a.Vec3.subtract(n,s.o,o.a);var h=a.Vec3.dot(n,i)*u;if(h<0||h>1)return 0;a.Vec3.cross(r,n,t);var f=a.Vec3.dot(s.d,r)*u;if(f<0||h+f>1)return 0;var d=a.Vec3.dot(e,r)*u;return d<0?0:d}})(),P=D,L=(function(){var t=new a.Vec3(0,0,0),e=new a.Vec3(0,0,0),i=new a.Vec3(0,0,0),n=new a.Vec3(0,0,0),r=new a.Vec3(0,0,0),s=new a.Vec3(0,0,0);return function(o,c,l){a.Vec3.subtract(t,c.b,c.a),a.Vec3.subtract(e,c.c,c.a),a.Vec3.subtract(i,o.s,o.e),a.Vec3.cross(r,t,e);var u=a.Vec3.dot(i,r);if(u<=0)return 0;a.Vec3.subtract(n,o.s,c.a);var h=a.Vec3.dot(n,r);if(h<0||h>u)return 0;a.Vec3.cross(s,i,n);var f=a.Vec3.dot(e,s);if(f<0||f>u)return 0;var d=-a.Vec3.dot(t,s);if(d<0||f+d>u)return 0;if(l){var _=1/u,p=1-(f*=_)-(d*=_);a.Vec3.set(l,c.a.x*p+c.b.x*f+c.c.x*d,c.a.y*p+c.b.y*f+c.c.y*d,c.a.z*p+c.b.z*f+c.c.z*d)}return 1}})(),N=(p=new a.Vec3(0,0,0),m=new a.Vec3(0,0,0),v=new a.Vec3(0,0,0),g=new a.Vec3(0,0,0),y=new a.Vec3(0,0,0),T=new a.Vec3(0,0,0),b=new a.Vec3(0,0,0),function(t,e,i,n,r,s,o){a.Vec3.subtract(p,e,t),a.Vec3.subtract(m,i,t),a.Vec3.subtract(v,n,t),a.Vec3.subtract(g,r,t),a.Vec3.cross(T,g,p);var c=a.Vec3.dot(m,T);if(c>=0){var l=-a.Vec3.dot(v,T);if(l<0)return 0;var u=a.Vec3.dot(a.Vec3.cross(b,p,v),m);if(u<0)return 0;if(o){var h=1/(l+c+u);l*=h,c*=h,u*=h,a.Vec3.set(o,i.x*l+n.x*c+r.x*u,i.y*l+n.y*c+r.y*u,i.z*l+n.z*c+r.z*u)}}else{a.Vec3.subtract(y,s,t);var f=a.Vec3.dot(y,T);if(f<0)return 0;var d=a.Vec3.dot(a.Vec3.cross(b,p,m),y);if(d<0)return 0;if(o){var _=1/(f+(c=-c)+d);f*=_,c*=_,d*=_,a.Vec3.set(o,i.x*f+s.x*c+r.x*d,i.y*f+s.y*c+r.y*d,i.z*f+s.z*c+r.z*d)}}return 1}),F=(function(){var t=new a.Vec3(0,0,0);return function(e,i){var n=i.radius,r=i.center,s=e.o,o=e.d,c=n*n;a.Vec3.subtract(t,r,s);var l=t.lengthSqr(),u=a.Vec3.dot(t,o),h=c-(l-u*u);if(h<0)return 0;var f=Math.sqrt(h),d=l<c?u+f:u-f;return d<0?0:d}})(),B=(E=new a.Vec3,A=new a.Vec3,function(t,e){var i=t.o,n=t.d,r=1/n.x,s=1/n.y,o=1/n.z;a.Vec3.subtract(E,e.center,e.halfExtents),a.Vec3.add(A,e.center,e.halfExtents);var c=(E.x-i.x)*r,l=(A.x-i.x)*r,u=(E.y-i.y)*s,h=(A.y-i.y)*s,f=(E.z-i.z)*o,d=(A.z-i.z)*o,_=Math.max(Math.max(Math.min(c,l),Math.min(u,h)),Math.min(f,d)),p=Math.min(Math.min(Math.max(c,l),Math.max(u,h)),Math.max(f,d));return p<0||_>p?0:_}),k=B,V=(function(){var t=new a.Vec3,e=new a.Vec3,i=new a.Vec3,n=new a.Vec3,r=new a.Vec3,s=new a.Vec3,o=new a.Vec3,c=new Array(3),l=new Array(3),u=new Array(3),h=new Array(6);return function(f,d){c[0]=d.halfExtents.x,c[1]=d.halfExtents.y,c[2]=d.halfExtents.z,t=d.center,e=f.o,i=f.d;var _=d.orientation.m;a.Vec3.set(n,_[0],_[1],_[2]),a.Vec3.set(r,_[3],_[4],_[5]),a.Vec3.set(s,_[6],_[7],_[8]),a.Vec3.subtract(o,t,e),l[0]=a.Vec3.dot(n,i),l[1]=a.Vec3.dot(r,i),l[2]=a.Vec3.dot(s,i),u[0]=a.Vec3.dot(n,o),u[1]=a.Vec3.dot(r,o),u[2]=a.Vec3.dot(s,o);for(var p=0;p<3;++p){if(0===l[p]){if(-u[p]-c[p]>0||-u[p]+c[p]<0)return 0;l[p]=1e-7}h[2*p+0]=(u[p]+c[p])/l[p],h[2*p+1]=(u[p]-c[p])/l[p]}var m=Math.max(Math.max(Math.min(h[0],h[1]),Math.min(h[2],h[3])),Math.min(h[4],h[5])),v=Math.min(Math.min(Math.max(h[0],h[1]),Math.max(h[2],h[3])),Math.max(h[4],h[5]));return v<0||m>v||m<0?0:m}})(),z=(C=new a.Vec3,x=new a.Vec3,S=new a.Vec3,w=new a.Vec3,function(t,e){return a.Vec3.subtract(C,t.center,t.halfExtents),a.Vec3.add(x,t.center,t.halfExtents),a.Vec3.subtract(S,e.center,e.halfExtents),a.Vec3.add(w,e.center,e.halfExtents),C.x<=w.x&&x.x>=S.x&&C.y<=w.y&&x.y>=S.y&&C.z<=w.z&&x.z>=S.z});function U(t,e,i){a.Vec3.set(i[0],t.x,e.y,e.z),a.Vec3.set(i[1],t.x,e.y,t.z),a.Vec3.set(i[2],t.x,t.y,e.z),a.Vec3.set(i[3],t.x,t.y,t.z),a.Vec3.set(i[4],e.x,e.y,e.z),a.Vec3.set(i[5],e.x,e.y,t.z),a.Vec3.set(i[6],e.x,t.y,e.z),a.Vec3.set(i[7],e.x,t.y,t.z)}function H(t,e,i,n,r,s){a.Vec3.set(s[0],t.x+i.x*e.x+n.x*e.y+r.x*e.z,t.y+i.y*e.x+n.y*e.y+r.y*e.z,t.z+i.z*e.x+n.z*e.y+r.z*e.z),a.Vec3.set(s[1],t.x-i.x*e.x+n.x*e.y+r.x*e.z,t.y-i.y*e.x+n.y*e.y+r.y*e.z,t.z-i.z*e.x+n.z*e.y+r.z*e.z),a.Vec3.set(s[2],t.x+i.x*e.x-n.x*e.y+r.x*e.z,t.y+i.y*e.x-n.y*e.y+r.y*e.z,t.z+i.z*e.x-n.z*e.y+r.z*e.z),a.Vec3.set(s[3],t.x+i.x*e.x+n.x*e.y-r.x*e.z,t.y+i.y*e.x+n.y*e.y-r.y*e.z,t.z+i.z*e.x+n.z*e.y-r.z*e.z),a.Vec3.set(s[4],t.x-i.x*e.x-n.x*e.y-r.x*e.z,t.y-i.y*e.x-n.y*e.y-r.y*e.z,t.z-i.z*e.x-n.z*e.y-r.z*e.z),a.Vec3.set(s[5],t.x+i.x*e.x-n.x*e.y-r.x*e.z,t.y+i.y*e.x-n.y*e.y-r.y*e.z,t.z+i.z*e.x-n.z*e.y-r.z*e.z),a.Vec3.set(s[6],t.x-i.x*e.x+n.x*e.y-r.x*e.z,t.y-i.y*e.x+n.y*e.y-r.y*e.z,t.z-i.z*e.x+n.z*e.y-r.z*e.z),a.Vec3.set(s[7],t.x-i.x*e.x-n.x*e.y+r.x*e.z,t.y-i.y*e.x-n.y*e.y+r.y*e.z,t.z-i.z*e.x-n.z*e.y+r.z*e.z)}function W(t,e){for(var i=a.Vec3.dot(e,t[0]),n=i,r=1;r<8;++r){var s=a.Vec3.dot(e,t[r]);i=s<i?s:i,n=s>n?s:n}return[i,n]}var G,j=(function(){for(var t=new Array(15),e=0;e<15;e++)t[e]=new a.Vec3(0,0,0);for(var i=new Array(8),n=new Array(8),r=0;r<8;r++)i[r]=new a.Vec3(0,0,0),n[r]=new a.Vec3(0,0,0);var s=new a.Vec3,o=new a.Vec3;return function(e,r){var c=r.orientation.m;a.Vec3.set(t[0],1,0,0),a.Vec3.set(t[1],0,1,0),a.Vec3.set(t[2],0,0,1),a.Vec3.set(t[3],c[0],c[1],c[2]),a.Vec3.set(t[4],c[3],c[4],c[5]),a.Vec3.set(t[5],c[6],c[7],c[8]);for(var l=0;l<3;++l)a.Vec3.cross(t[6+3*l],t[l],t[0]),a.Vec3.cross(t[7+3*l],t[l],t[1]),a.Vec3.cross(t[7+3*l],t[l],t[2]);a.Vec3.subtract(s,e.center,e.halfExtents),a.Vec3.add(o,e.center,e.halfExtents),U(s,o,i),H(r.center,r.halfExtents,t[3],t[4],t[5],n);for(var u=0;u<15;++u){var h=W(i,t[u]),f=W(n,t[u]);if(f[0]>h[1]||h[0]>f[1])return 0}return 1}})(),Y=function(t,e){var i=t.halfExtents.x*Math.abs(e.n.x)+t.halfExtents.y*Math.abs(e.n.y)+t.halfExtents.z*Math.abs(e.n.z),n=a.Vec3.dot(e.n,t.center);return n+i<e.d?-1:n-i>e.d?0:1},X=function(t,e){for(var i=0;i<e.planes.length;i++)if(-1===Y(t,e.planes[i]))return 0;return 1},q=(function(){for(var t=new Array(8),e=0,i=0,n=0;n<t.length;n++)t[n]=new a.Vec3(0,0,0);return function(n,r){for(var s=0,o=!1,c=0;c<r.planes.length;c++){if(-1===(s=Y(n,r.planes[c])))return 0;1===s&&(o=!0)}if(!o)return 1;for(var l=0;l<r.vertices.length;l++)a.Vec3.subtract(t[l],r.vertices[l],n.center);e=0,i=0;for(var u=0;u<r.vertices.length;u++)t[u].x>n.halfExtents.x?e++:t[u].x<-n.halfExtents.x&&i++;if(e===r.vertices.length||i===r.vertices.length)return 0;e=0,i=0;for(var h=0;h<r.vertices.length;h++)t[h].y>n.halfExtents.y?e++:t[h].y<-n.halfExtents.y&&i++;if(e===r.vertices.length||i===r.vertices.length)return 0;e=0,i=0;for(var f=0;f<r.vertices.length;f++)t[f].z>n.halfExtents.z?e++:t[f].z<-n.halfExtents.z&&i++;return e===r.vertices.length||i===r.vertices.length?0:1}})(),Z=(function(){var t=new a.Vec3(0,0,0),e=new a.Mat3;return function(i,n){return a.Vec3.subtract(t,n,i.center),a.Vec3.transformMat3(t,t,a.Mat3.transpose(e,i.orientation)),r=t,s=i.halfExtents,Math.abs(r.x)<s.x&&Math.abs(r.y)<s.y&&Math.abs(r.z)<s.z;var r,s}})(),K=(G=function(t,e,i,n){return Math.abs(t.x*e+t.y*i+t.z*n)},function(t,e){var i=t.orientation.m,n=t.halfExtents.x*G(e.n,i[0],i[1],i[2])+t.halfExtents.y*G(e.n,i[3],i[4],i[5])+t.halfExtents.z*G(e.n,i[6],i[7],i[8]),r=a.Vec3.dot(e.n,t.center);return r+n<e.d?-1:r-n>e.d?0:1}),Q=function(t,e){for(var i=0;i<e.planes.length;i++)if(-1===K(t,e.planes[i]))return 0;return 1},J=(function(){for(var t=new Array(8),e=0,i=0,n=0,r=0;r<t.length;r++)t[r]=new a.Vec3(0,0,0);var s=function(t,e,i,n){return t.x*e+t.y*i+t.z*n};return function(r,o){for(var c=0,l=!1,u=0;u<o.planes.length;u++){if(-1===(c=K(r,o.planes[u])))return 0;1===c&&(l=!0)}if(!l)return 1;for(var h=0;h<o.vertices.length;h++)a.Vec3.subtract(t[h],o.vertices[h],r.center);i=0,n=0;for(var f=r.orientation.m,d=0;d<o.vertices.length;d++)(e=s(t[d],f[0],f[1],f[2]))>r.halfExtents.x?i++:e<-r.halfExtents.x&&n++;if(i===o.vertices.length||n===o.vertices.length)return 0;i=0,n=0;for(var _=0;_<o.vertices.length;_++)(e=s(t[_],f[3],f[4],f[5]))>r.halfExtents.y?i++:e<-r.halfExtents.y&&n++;if(i===o.vertices.length||n===o.vertices.length)return 0;i=0,n=0;for(var p=0;p<o.vertices.length;p++)(e=s(t[p],f[6],f[7],f[8]))>r.halfExtents.z?i++:e<-r.halfExtents.z&&n++;return i===o.vertices.length||n===o.vertices.length?0:1}})(),$=(function(){for(var t=new Array(15),e=0;e<15;e++)t[e]=new a.Vec3(0,0,0);for(var i=new Array(8),n=new Array(8),r=0;r<8;r++)i[r]=new a.Vec3(0,0,0),n[r]=new a.Vec3(0,0,0);return function(e,r){var s=e.orientation.m,o=r.orientation.m;a.Vec3.set(t[0],s[0],s[1],s[2]),a.Vec3.set(t[1],s[3],s[4],s[5]),a.Vec3.set(t[2],s[6],s[7],s[8]),a.Vec3.set(t[3],o[0],o[1],o[2]),a.Vec3.set(t[4],o[3],o[4],o[5]),a.Vec3.set(t[5],o[6],o[7],o[8]);for(var c=0;c<3;++c)a.Vec3.cross(t[6+3*c],t[c],t[0]),a.Vec3.cross(t[7+3*c],t[c],t[1]),a.Vec3.cross(t[7+3*c],t[c],t[2]);H(e.center,e.halfExtents,t[0],t[1],t[2],i),H(r.center,r.halfExtents,t[3],t[4],t[5],n);for(var l=0;l<15;++l){var u=W(i,t[l]),h=W(n,t[l]);if(h[0]>u[1]||u[0]>h[1])return 0}return 1}})(),tt=function(t,e){var i=a.Vec3.dot(e.n,t.center),n=t.radius*e.n.length();return i+n<e.d?-1:i-n>e.d?0:1},et=function(t,e){for(var i=0;i<e.planes.length;i++)if(-1===tt(t,e.planes[i]))return 0;return 1},it=(function(){var t=new a.Vec3(0,0,0),e=[1,-1,1,-1,1,-1];return function(i,n){for(var r=0;r<6;r++){var s=n.planes[r],o=i.radius,c=i.center,l=s.n,u=s.d,h=a.Vec3.dot(l,c);if(h+o<u)return 0;if(!(h-o>u)){a.Vec3.add(t,c,a.Vec3.multiplyScalar(t,l,o));for(var f=0;f<6;f++)if(f!==r&&f!==r+e[r]){var d=n.planes[f];if(a.Vec3.dot(d.n,t)<d.d)return 0}}}return 1}})(),nt=function(t,e){var i=t.radius+e.radius;return a.Vec3.squaredDistance(t.center,e.center)<i*i},rt=(function(){var t=new a.Vec3;return function(e,i){return o.pt_point_aabb(t,e.center,i),a.Vec3.squaredDistance(e.center,t)<e.radius*e.radius}})(),at=(function(){var t=new a.Vec3;return function(e,i){return o.pt_point_obb(t,e.center,i),a.Vec3.squaredDistance(e.center,t)<e.radius*e.radius}})(),st={rayAabb:k,rayMesh:M,raycast:R,rayTriangle:P,ray_sphere:F,ray_aabb:B,ray_obb:V,ray_plane:I,ray_triangle:D,line_plane:O,line_triangle:L,line_quad:N,sphere_sphere:nt,sphere_aabb:rt,sphere_obb:at,sphere_plane:tt,sphere_frustum:et,sphere_frustum_accurate:it,aabb_aabb:z,aabb_obb:j,aabb_plane:Y,aabb_frustum:X,aabb_frustum_accurate:q,obb_obb:$,obb_plane:K,obb_frustum:Q,obb_frustum_accurate:J,obb_point:Z,resolve:function(t,e,i){void 0===i&&(i=null);var n=t._type,r=e._type,a=this[n|r];return n<r?a(t,e,i):a(e,t,i)}};st[c.default.SHAPE_RAY|c.default.SHAPE_SPHERE]=F,st[c.default.SHAPE_RAY|c.default.SHAPE_AABB]=B,st[c.default.SHAPE_RAY|c.default.SHAPE_OBB]=V,st[c.default.SHAPE_RAY|c.default.SHAPE_PLANE]=I,st[c.default.SHAPE_RAY|c.default.SHAPE_TRIANGLE]=D,st[c.default.SHAPE_LINE|c.default.SHAPE_PLANE]=O,st[c.default.SHAPE_LINE|c.default.SHAPE_TRIANGLE]=L,st[c.default.SHAPE_SPHERE]=nt,st[c.default.SHAPE_SPHERE|c.default.SHAPE_AABB]=rt,st[c.default.SHAPE_SPHERE|c.default.SHAPE_OBB]=at,st[c.default.SHAPE_SPHERE|c.default.SHAPE_PLANE]=tt,st[c.default.SHAPE_SPHERE|c.default.SHAPE_FRUSTUM]=et,st[c.default.SHAPE_SPHERE|c.default.SHAPE_FRUSTUM_ACCURATE]=it,st[c.default.SHAPE_AABB]=z,st[c.default.SHAPE_AABB|c.default.SHAPE_OBB]=j,st[c.default.SHAPE_AABB|c.default.SHAPE_PLANE]=Y,st[c.default.SHAPE_AABB|c.default.SHAPE_FRUSTUM]=X,st[c.default.SHAPE_AABB|c.default.SHAPE_FRUSTUM_ACCURATE]=q,st[c.default.SHAPE_OBB]=$,st[c.default.SHAPE_OBB|c.default.SHAPE_PLANE]=K,st[c.default.SHAPE_OBB|c.default.SHAPE_FRUSTUM]=Q,st[c.default.SHAPE_OBB|c.default.SHAPE_FRUSTUM_ACCURATE]=J;var ot=st;i.default=ot,e.exports=i.default}),{"../../renderer/gfx":326,"../../renderer/memop/recycle-pool":341,"../value-types":293,"./aabb":170,"./distance":171,"./enums":172,"./ray":179,"./triangle":181}],176:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=t("../value-types"),a=(n=t("./enums"))&&n.__esModule?n:{default:n},s=(function(){function t(t,e,i,n,s,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=-1),this.s=void 0,this.e=void 0,this._type=void 0,this._type=a.default.SHAPE_LINE,this.s=new r.Vec3(t,e,i),this.e=new r.Vec3(n,s,o)}return t.create=function(e,i,n,r,a,s){return new t(e,i,n,r,a,s)},t.clone=function(e){return new t(e.s.x,e.s.y,e.s.z,e.e.x,e.e.y,e.e.z)},t.copy=function(t,e){return r.Vec3.copy(t.s,e.s),r.Vec3.copy(t.e,e.e),t},t.fromPoints=function(t,e,i){return r.Vec3.copy(t.s,e),r.Vec3.copy(t.e,i),t},t.set=function(t,e,i,n,r,a,s){return t.s.x=e,t.s.y=i,t.s.z=n,t.e.x=r,t.e.y=a,t.e.z=s,t},t.len=function(t){return r.Vec3.distance(t.s,t.e)},t.prototype.length=function(){return r.Vec3.distance(this.s,this.e)},t})();i.default=s,e.exports=i.default}),{"../value-types":293,"./enums":172}],177:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=t("../value-types"),a=(n=t("./enums"))&&n.__esModule?n:{default:n};function s(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var o=new r.Vec3,c=new r.Vec3,l=new r.Mat3,u=(function(){var t,e;function i(t,e,i,n,s,o,c,l,u,h,f,d,_,p,m){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),void 0===s&&(s=1),void 0===o&&(o=1),void 0===c&&(c=1),void 0===l&&(l=0),void 0===u&&(u=0),void 0===h&&(h=0),void 0===f&&(f=1),void 0===d&&(d=0),void 0===_&&(_=0),void 0===p&&(p=0),void 0===m&&(m=1),this.center=void 0,this.halfExtents=void 0,this.orientation=void 0,this._type=void 0,this._type=a.default.SHAPE_OBB,this.center=new r.Vec3(t,e,i),this.halfExtents=new r.Vec3(n,s,o),this.orientation=new r.Mat3(c,l,u,h,f,d,_,p,m)}i.create=function(t,e,n,r,a,s,o,c,l,u,h,f,d,_,p){return new i(t,e,n,r,a,s,o,c,l,u,h,f,d,_,p)},i.clone=function(t){var e=t.orientation.m;return new i(t.center.x,t.center.y,t.center.z,t.halfExtents.x,t.halfExtents.y,t.halfExtents.z,e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},i.copy=function(t,e){return r.Vec3.copy(t.center,e.center),r.Vec3.copy(t.halfExtents,e.halfExtents),r.Mat3.copy(t.orientation,e.orientation),t},i.fromPoints=function(t,e,i){return r.Vec3.multiplyScalar(t.center,r.Vec3.add(o,e,i),.5),r.Vec3.multiplyScalar(t.halfExtents,r.Vec3.subtract(c,i,e),.5),r.Mat3.identity(t.orientation),t},i.set=function(t,e,i,n,a,s,o,c,l,u,h,f,d,_,p,m){return r.Vec3.set(t.center,e,i,n),r.Vec3.set(t.halfExtents,a,s,o),r.Mat3.set(t.orientation,c,l,u,h,f,d,_,p,m),t},t=i,(e=[{key:"type",get:function(){return this._type}}])&&s(t.prototype,e);var n=i.prototype;return n.getBoundary=function(t,e){var i,n,a,s,c;i=o,n=this.halfExtents,a=this.orientation,s=l.m,c=a.m,s[0]=Math.abs(c[0]),s[1]=Math.abs(c[1]),s[2]=Math.abs(c[2]),s[3]=Math.abs(c[3]),s[4]=Math.abs(c[4]),s[5]=Math.abs(c[5]),s[6]=Math.abs(c[6]),s[7]=Math.abs(c[7]),s[8]=Math.abs(c[8]),r.Vec3.transformMat3(i,n,l),r.Vec3.subtract(t,this.center,o),r.Vec3.add(e,this.center,o)},n.transform=function(t,e,i,n,a){r.Vec3.transformMat4(a.center,this.center,t),r.Mat3.fromQuat(a.orientation,i),r.Vec3.multiply(a.halfExtents,this.halfExtents,n)},n.translateAndRotate=function(t,e,i){r.Vec3.transformMat4(i.center,this.center,t),r.Mat3.fromQuat(i.orientation,e)},n.setScale=function(t,e){r.Vec3.multiply(e.halfExtents,this.halfExtents,t)},i})();i.default=u,e.exports=i.default}),{"../value-types":293,"./enums":172}],178:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=t("../value-types"),a=(n=t("./enums"))&&n.__esModule?n:{default:n},s=new r.Vec3(0,0,0),o=new r.Vec3(0,0,0),c=cc.mat4(),l=cc.v4(),u=(function(){function t(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=1),void 0===i&&(i=0),void 0===n&&(n=0),this.n=void 0,this.d=void 0,this._type=void 0,this._type=a.default.SHAPE_PLANE,this.n=new r.Vec3(t,e,i),this.d=n}return t.create=function(e,i,n,r){return new t(e,i,n,r)},t.clone=function(e){return new t(e.n.x,e.n.y,e.n.z,e.d)},t.copy=function(t,e){return r.Vec3.copy(t.n,e.n),t.d=e.d,t},t.fromPoints=function(t,e,i,n){return r.Vec3.subtract(s,i,e),r.Vec3.subtract(o,n,e),r.Vec3.normalize(t.n,r.Vec3.cross(t.n,s,o)),t.d=r.Vec3.dot(t.n,e),t},t.set=function(t,e,i,n,r){return t.n.x=e,t.n.y=i,t.n.z=n,t.d=r,t},t.fromNormalAndPoint=function(t,e,i){return r.Vec3.copy(t.n,e),t.d=r.Vec3.dot(e,i),t},t.normalize=function(t,e){var i=e.n.len();return r.Vec3.normalize(t.n,e.n),i>0&&(t.d=e.d/i),t},t.prototype.transform=function(t){r.Mat4.invert(c,t),r.Mat4.transpose(c,c),r.Vec4.set(l,this.n.x,this.n.y,this.n.z,this.d),r.Vec4.transformMat4(l,l,c),r.Vec3.set(this.n,l.x,l.y,l.z),this.d=l.w},t})();i.default=u,e.exports=i.default}),{"../value-types":293,"./enums":172}],179:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=t("../value-types"),a=(n=t("./enums"))&&n.__esModule?n:{default:n},s=(function(){function t(t,e,i,n,s,o){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=-1),this.o=void 0,this.d=void 0,this._type=void 0,this._type=a.default.SHAPE_RAY,this.o=new r.Vec3(t,e,i),this.d=new r.Vec3(n,s,o)}return t.create=function(e,i,n,r,a,s){return void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===a&&(a=0),void 0===s&&(s=1),new t(e,i,n,r,a,s)},t.clone=function(e){return new t(e.o.x,e.o.y,e.o.z,e.d.x,e.d.y,e.d.z)},t.copy=function(t,e){return r.Vec3.copy(t.o,e.o),r.Vec3.copy(t.d,e.d),t},t.fromPoints=function(t,e,i){return r.Vec3.copy(t.o,e),r.Vec3.normalize(t.d,r.Vec3.subtract(t.d,i,e)),t},t.set=function(t,e,i,n,r,a,s){return t.o.x=e,t.o.y=i,t.o.z=n,t.d.x=r,t.d.y=a,t.d.z=s,t},t.prototype.computeHit=function(t,e){r.Vec3.normalize(t,this.d),r.Vec3.scaleAndAdd(t,this.o,t,e)},t})();i.default=s,e.exports=i.default}),{"../value-types":293,"./enums":172}],180:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=t("../value-types"),a=(n=t("./enums"))&&n.__esModule?n:{default:n},s=new r.Vec3,o=(function(){function t(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),this.center=void 0,this.radius=void 0,this._type=void 0,this._type=a.default.SHAPE_SPHERE,this.center=new r.Vec3(t,e,i),this.radius=n}t.create=function(e,i,n,r){return new t(e,i,n,r)},t.clone=function(e){return new t(e.center.x,e.center.y,e.center.z,e.radius)},t.copy=function(t,e){return r.Vec3.copy(t.center,e.center),t.radius=e.radius,t},t.fromPoints=function(t,e,i){return r.Vec3.multiplyScalar(t.center,r.Vec3.add(s,e,i),.5),t.radius=.5*r.Vec3.subtract(s,i,e).len(),t},t.set=function(t,e,i,n,r){return t.center.x=e,t.center.y=i,t.center.z=n,t.radius=r,t};var e=t.prototype;return e.clone=function(){return t.clone(this)},e.copy=function(e){return t.copy(this,e)},e.getBoundary=function(t,e){r.Vec3.set(t,this.center.x-this.radius,this.center.y-this.radius,this.center.z-this.radius),r.Vec3.set(e,this.center.x+this.radius,this.center.y+this.radius,this.center.z+this.radius)},e.transform=function(t,e,i,n,a){r.Vec3.transformMat4(a.center,this.center,t),a.radius=this.radius*n.maxAxis()},e.translateAndRotate=function(t,e,i){r.Vec3.transformMat4(i.center,this.center,t)},e.setScale=function(t,e){e.radius=this.radius*t.maxAxis()},t})();i.default=o,e.exports=i.default}),{"../value-types":293,"./enums":172}],181:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=a(t("../value-types/vec3")),r=a(t("./enums"));function a(t){return t&&t.__esModule?t:{default:t}}var s=(function(){function t(t,e,i,a,s,o,c,l,u){this.a=void 0,this.b=void 0,this.c=void 0,this._type=void 0,this.a=new n.default(t,e,i),this.b=new n.default(a,s,o),this.c=new n.default(c,l,u),this._type=r.default.SHAPE_TRIANGLE}return t.create=function(e,i,n,r,a,s,o,c,l){return new t(e,i,n,r,a,s,o,c,l)},t.clone=function(e){return new t(e.a.x,e.a.y,e.a.z,e.b.x,e.b.y,e.b.z,e.c.x,e.c.y,e.c.z)},t.copy=function(t,e){return n.default.copy(t.a,e.a),n.default.copy(t.b,e.b),n.default.copy(t.c,e.c),t},t.fromPoints=function(t,e,i,r){return n.default.copy(t.a,e),n.default.copy(t.b,i),n.default.copy(t.c,r),t},t.set=function(t,e,i,n,r,a,s,o,c,l){return t.a.x=e,t.a.y=i,t.a.z=n,t.b.x=r,t.b.y=a,t.b.z=s,t.c.x=o,t.c.y=c,t.c.z=l,t},t})();i.default=s,e.exports=i.default}),{"../value-types/vec3":303,"./enums":172}],182:[(function(t,e){"use strict";var i=t("../components/CCRenderComponent"),n=t("../assets/material/CCMaterial"),r=t("./types"),a=r.LineCap,s=r.LineJoin,o=cc.Class({name:"cc.Graphics",extends:i,editor:!1,ctor:function(){this._impl=new o._Impl(this)},properties:{_lineWidth:2,_strokeColor:cc.Color.BLACK,_lineJoin:s.MITER,_lineCap:a.BUTT,_fillColor:cc.Color.WHITE,_miterLimit:10,lineWidth:{get:function(){return this._lineWidth},set:function(t){this._lineWidth=t,this._impl.lineWidth=t}},lineJoin:{get:function(){return this._lineJoin},set:function(t){this._lineJoin=t,this._impl.lineJoin=t},type:s},lineCap:{get:function(){return this._lineCap},set:function(t){this._lineCap=t,this._impl.lineCap=t},type:a},strokeColor:{get:function(){return this._strokeColor},set:function(t){this._impl.strokeColor=this._strokeColor=cc.color(t)}},fillColor:{get:function(){return this._fillColor},set:function(t){this._impl.fillColor=this._fillColor=cc.color(t)}},miterLimit:{get:function(){return this._miterLimit},set:function(t){this._miterLimit=t,this._impl.miterLimit=t}}},statics:{LineJoin:s,LineCap:a},onRestore:function(){this._impl||(this._impl=new o._Impl(this))},onDestroy:function(){this.clear(!0),this._super(),this._impl=null},_getDefaultMaterial:function(){return n.getBuiltinMaterial("2d-graphics")},_updateMaterial:function(){var t=this._materials[0];t&&(void 0!==t.getDefine("CC_USE_MODEL")&&t.define("CC_USE_MODEL",!0),void 0!==t.getDefine("CC_SUPPORT_standard_derivatives")&&cc.sys.glExtension("OES_standard_derivatives")&&t.define("CC_SUPPORT_standard_derivatives",!0))},moveTo:function(t,e){this._impl.moveTo(t,e)},lineTo:function(t,e){this._impl.lineTo(t,e)},bezierCurveTo:function(t,e,i,n,r,a){this._impl.bezierCurveTo(t,e,i,n,r,a)},quadraticCurveTo:function(t,e,i,n){this._impl.quadraticCurveTo(t,e,i,n)},arc:function(t,e,i,n,r,a){this._impl.arc(t,e,i,n,r,a)},ellipse:function(t,e,i,n){this._impl.ellipse(t,e,i,n)},circle:function(t,e,i){this._impl.circle(t,e,i)},rect:function(t,e,i,n){this._impl.rect(t,e,i,n)},roundRect:function(t,e,i,n,r){this._impl.roundRect(t,e,i,n,r)},fillRect:function(t,e,i,n){this.rect(t,e,i,n),this.fill()},clear:function(t){this._impl.clear(t),this._assembler&&this._assembler.clear(t)},close:function(){this._impl.close()},stroke:function(){this._assembler||this._resetAssembler(),this._assembler.stroke(this)},fill:function(){this._assembler||this._resetAssembler(),this._assembler.fill(this)}});cc.Graphics=e.exports=o,cc.Graphics.Types=r,cc.Graphics.Helper=t("./helper")}),{"../assets/material/CCMaterial":111,"../components/CCRenderComponent":140,"./helper":183,"./types":185}],183:[(function(t,e){"use strict";var i=t("./types").PointFlags,n=Math.PI,r=Math.min,a=Math.max,s=Math.cos,o=Math.sin,c=Math.abs,l=Math.sign,u=.5522847493;e.exports={arc:function(t,e,i,l,u,h,f){var d,_,p,m=0,v=0,g=0,y=0,T=0,b=0,E=0,A=0,C=0,x=0,S=0,w=0,M=0;if(v=h-u,f=f||!1)if(c(v)>=2*n)v=2*n;else for(;v<0;)v+=2*n;else if(c(v)>=2*n)v=2*-n;else for(;v>0;)v-=2*n;for(p=0|a(1,r(c(v)/(.5*n)+.5,5)),g=c(4/3*(1-s(d=v/p/2))/o(d)),f||(g=-g),_=0;_<=p;_++)b=e+(y=s(m=u+v*(_/p)))*l,E=i+(T=o(m))*l,A=-T*l*g,C=y*l*g,0===_?t.moveTo(b,E):t.bezierCurveTo(x+w,S+M,b-A,E-C,b,E),x=b,S=E,w=A,M=C},ellipse:function(t,e,i,n,r){t.moveTo(e-n,i),t.bezierCurveTo(e-n,i+r*u,e-n*u,i+r,e,i+r),t.bezierCurveTo(e+n*u,i+r,e+n,i+r*u,e+n,i),t.bezierCurveTo(e+n,i-r*u,e+n*u,i-r,e,i-r),t.bezierCurveTo(e-n*u,i-r,e-n,i-r*u,e-n,i),t.close()},roundRect:function(t,e,i,n,a,s){if(s<.1)t.rect(e,i,n,a);else{var o=r(s,.5*c(n))*l(n),h=r(s,.5*c(a))*l(a);t.moveTo(e,i+h),t.lineTo(e,i+a-h),t.bezierCurveTo(e,i+a-h*(1-u),e+o*(1-u),i+a,e+o,i+a),t.lineTo(e+n-o,i+a),t.bezierCurveTo(e+n-o*(1-u),i+a,e+n,i+a-h*(1-u),e+n,i+a-h),t.lineTo(e+n,i+h),t.bezierCurveTo(e+n,i+h*(1-u),e+n-o*(1-u),i,e+n-o,i),t.lineTo(e+o,i),t.bezierCurveTo(e+o*(1-u),i,e,i+h*(1-u),e,i+h),t.close()}},tesselateBezier:function t(e,n,r,a,s,o,l,u,h,f,d){var _,p,m,v,g,y,T,b,E,A,C,x,S,w,M,R;f>10||(g=.5*(o+u),y=.5*(l+h),T=.5*((_=.5*(n+a))+(m=.5*(a+o))),b=.5*((p=.5*(r+s))+(v=.5*(s+l))),((M=c((a-u)*(w=h-r)-(s-h)*(S=u-n)))+(R=c((o-u)*w-(l-h)*S)))*(M+R)<e._tessTol*(S*S+w*w)?e._addPoint(u,h,0===d?d|i.PT_BEVEL:d):(t(e,n,r,_,p,T,b,C=.5*(T+(E=.5*(m+g))),x=.5*(b+(A=.5*(v+y))),f+1,0),t(e,C,x,E,A,g,y,u,h,f+1,d)))}}}),{"./types":185}],184:[(function(t){"use strict";t("./graphics")}),{"./graphics":182}],185:[(function(t,e){"use strict";var i=cc.Enum({BUTT:0,ROUND:1,SQUARE:2}),n=cc.Enum({BEVEL:0,ROUND:1,MITER:2}),r=cc.Enum({PT_CORNER:1,PT_LEFT:2,PT_BEVEL:4,PT_INNERBEVEL:8});e.exports={LineCap:i,LineJoin:n,PointFlags:r}}),{}],186:[(function(t){"use strict";t("./platform"),t("./assets"),t("./CCNode"),t("./CCPrivateNode"),t("./CCScene"),t("./components"),t("./graphics"),t("./collider"),t("./collider/CCIntersection"),t("./physics"),t("./camera/CCCamera"),t("./geom-utils"),t("./mesh"),t("./3d"),t("./base-ui/CCWidgetManager")}),{"./3d":29,"./CCNode":60,"./CCPrivateNode":61,"./CCScene":62,"./assets":109,"./base-ui/CCWidgetManager":120,"./camera/CCCamera":121,"./collider":void 0,"./collider/CCIntersection":122,"./components":158,"./geom-utils":174,"./graphics":184,"./mesh":189,"./physics":void 0,"./platform":211}],187:[(function(t,e){"use strict";var i=a(t("../../renderer/core/input-assembler")),n=a(t("../../renderer/gfx")),r=t("./mesh-data");function a(t){return t&&t.__esModule?t:{default:t}}var s=t("../renderer"),o=t("../event/event-target");function c(t,e,i){t[e]=i._val}function l(t,e,i){t[e]=i.x,t[e+1]=i.y}function u(t,e,i){t[e]=i.x,t[e+1]=i.y,t[e+2]=i.z}var h,f={5120:"getInt8",5121:"getUint8",5122:"getInt16",5123:"getUint16",5124:"getInt32",5125:"getUint32",5126:"getFloat32"},d={5120:"setInt8",5121:"setUint8",5122:"setInt16",5123:"setUint16",5124:"setInt32",5125:"setUint32",5126:"setFloat32"},_=(h=new ArrayBuffer(2),new DataView(h).setInt16(0,256,!0),256===new Int16Array(h)[0]),p=cc.Class({name:"cc.Mesh",extends:cc.Asset,mixins:[o],properties:{_nativeAsset:{override:!0,get:function(){return this._buffer},set:function(t){this._buffer=ArrayBuffer.isView(t)?t.buffer:t,this.initWithBuffer()}},_vertexBundles:{default:null,type:r.VertexBundle},_primitives:{default:null,Primitive:r.Primitive},_minPos:cc.v3(),_maxPos:cc.v3(),subMeshes:{get:function(){return this._subMeshes},set:function(t){this._subMeshes=t}},subDatas:{get:function(){return this._subDatas}}},ctor:function(){this._subMeshes=[],this._subDatas=[],this.loaded=!1},initWithBuffer:function(){this._subMeshes.length=0;for(var t=this._primitives,e=0;e<t.length;e++){var a=t[e],o=a.data,c=new Uint8Array(this._buffer,o.offset,o.length),l=this._vertexBundles[a.vertexBundleIndices[0]],u=l.data,h=new n.default.VertexFormat(l.formats),f=new Uint8Array(this._buffer,u.offset,u.length),d=this._canVertexFormatBatch(h),_=new r.MeshData;_.vData=f,_.iData=c,_.vfm=h,_.offset=u.offset,_.canBatch=d,this._subDatas.push(_);var p=new n.default.VertexBuffer(s.device,h,n.default.USAGE_STATIC,f),m=new n.default.IndexBuffer(s.device,a.indexUnit,n.default.USAGE_STATIC,c);this._subMeshes.push(new i.default(p,m))}this.loaded=!0,this.emit("load")},_canVertexFormatBatch:function(t){var e=t._attr2el[n.default.ATTR_POSITION];return!e||e.type===n.default.ATTR_TYPE_FLOAT32&&t._bytes%4==0},init:function(t,e,a,o){void 0===a&&(a=!1),void 0===o&&(o=0);var c=new Uint8Array(t._bytes*e),l=new r.MeshData;l.vData=c,l.vfm=t,l.vDirty=!0,l.canBatch=this._canVertexFormatBatch(t);var u=new n.default.VertexBuffer(s.device,t,a?n.default.USAGE_DYNAMIC:n.default.USAGE_STATIC,c);l.vb=u,this._subMeshes[o]=new i.default(l.vb);var h=this._subDatas[o];h&&(h.vb&&h.vb.destroy(),h.ib&&h.ib.destroy()),this._subDatas[o]=l,this.loaded=!0,this.emit("load"),this.emit("init-format")},setVertices:function(t,e,i){i=i||0;var r=this._subDatas[i],a=r.vfm.element(t);if(!a)return cc.warn("Cannot find "+t+" attribute in vertex defines.");var s,o="number"==typeof e[0],h=a.num,f=o?e.length/h|0:e.length;r.vData.byteLength<f*a.stride&&r.setVData(new Uint8Array(f*r.vfm._bytes));var d=4;t===n.default.ATTR_COLOR?o?(s=r.getVData(),d=1):s=r.getVData(Uint32Array):s=r.getVData(Float32Array);var _=a.stride/d,p=a.offset/d;if(o)for(var m=0,v=e.length/h;m<v;m++)for(var g=m*h,y=m*_+p,T=0;T<h;T++)s[y+T]=e[g+T];else{var b;b=t===n.default.ATTR_COLOR?c:2===h?l:u;for(var E=0,A=e.length;E<A;E++)b(s,E*_+p,e[E])}r.vDirty=!0},setIndices:function(t,e,i){e=e||0;var r=t;t instanceof Uint16Array?r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(r=new Uint16Array(t),r=new Uint8Array(r.buffer,r.byteOffset,r.byteLength));var a=i?n.default.USAGE_DYNAMIC:n.default.USAGE_STATIC,o=this._subDatas[e];if(o.ib)o.iData=r,o.iDirty=!0;else{o.iData=r;var c=new n.default.IndexBuffer(s.device,n.default.INDEX_FMT_UINT16,a,r,r.byteLength/n.default.IndexBuffer.BYTES_PER_INDEX[n.default.INDEX_FMT_UINT16]);o.ib=c,this._subMeshes[e]._indexBuffer=o.ib}},setPrimitiveType:function(t,e){e=e||0,this._subMeshes[e]?this._subMeshes[e]._primitiveType=t:cc.warn("Do not have sub mesh at index "+e)},clear:function(){this._subMeshes.length=0;for(var t=this._subDatas,e=0,i=t.length;e<i;e++){var n=t[e].vb;n&&n.destroy();var r=t[e].ib;r&&r.destroy()}t.length=0},setBoundingBox:function(t,e){this._minPos=t,this._maxPos=e},destroy:function(){this.clear()},_uploadData:function(){for(var t=this._subDatas,e=0,i=t.length;e<i;e++){var n=t[e];if(n.vDirty){var r=n.vb,a=n.vData;r.update(0,a),n.vDirty=!1}if(n.iDirty){var s=n.ib,o=n.iData;s.update(0,o),n.iDirty=!1}}},_getAttrMeshData:function(t,e){var i=this._subDatas[t];if(!i)return[];var n=i.vfm,r=n.element(e);if(!r)return[];i.attrDatas||(i.attrDatas={});var a=i.attrDatas,s=a[e];if(s)return s;s=a[e]=[];for(var o=i.vData,c=new DataView(o.buffer,o.byteOffset,o.byteLength),l=r.stride,u=r.offset,h=r.num,d=r.bytes/h,p=f[r.type],m=o.byteLength/n._bytes,v=0;v<m;v++)for(var g=v*l+u,y=0;y<h;y++){var T=c[p](g+y*d,_);s.push(T)}return s},copyAttribute:function(t,e,i,n,r){var a=!1,s=this._subDatas[t];if(!s)return a;var o=s.vfm,c=o.element(e);if(!c)return a;var l=d[c.type];if(!l)return a;var u=this._getAttrMeshData(t,e),h=s.vData.byteLength/o._bytes,f=c.bytes/c.num;if(u.length>0){for(var p=new DataView(i,r),m=n,v=c.num,g=0;g<h;++g)for(var y=g*v,T=0;T<v;++T){var b=y+T,E=m*g+f*T;p[l](E,u[b],_)}a=!0}return a},copyIndices:function(t,e){var i=this._subDatas[t];if(!i)return!1;for(var r=i.iData,a=r.length/2,s=new DataView(r.buffer,r.byteOffset,r.byteLength),o=f[n.default.INDEX_FMT_UINT8],c=0;c<a;++c)e[c]=s[o](2*c);return!0}});cc.Mesh=e.exports=p}),{"../../renderer/core/input-assembler":316,"../../renderer/gfx":326,"../event/event-target":166,"../renderer":225,"./mesh-data":190}],188:[(function(t,e){"use strict";var i=a(t("../../renderer/gfx")),n=(a(t("../../renderer/core/input-assembler")),a(t("../geom-utils/aabb"))),r=(a(t("../value-types/vec3")),a(t("../value-types/mat4")),a(t("../assets/material/material-variant")));function a(t){return t&&t.__esModule?t:{default:t}}var s=t("../components/CCRenderComponent"),o=t("./CCMesh"),c=t("../renderer/render-flow"),l=(t("../renderer"),t("../assets/material/CCMaterial")),u=cc.Enum({OFF:0,ON:1}),h=cc.Class({name:"cc.MeshRenderer",extends:s,editor:!1,properties:{_mesh:{default:null,type:o},_receiveShadows:!1,_shadowCastingMode:u.OFF,_enableAutoBatch:!1,mesh:{get:function(){return this._mesh},set:function(t){this._mesh!==t&&(this._setMesh(t),t?(this.markForRender(!0),this.node._renderFlag|=c.FLAG_TRANSFORM):this.disableRender())},type:o,animatable:!1},textures:{default:[],type:cc.Texture2D,visible:!1},receiveShadows:{get:function(){return this._receiveShadows},set:function(t){this._receiveShadows=t,this._updateReceiveShadow()},animatable:!1},shadowCastingMode:{get:function(){return this._shadowCastingMode},set:function(t){this._shadowCastingMode=t,this._updateCastShadow()},type:u,animatable:!1},enableAutoBatch:{get:function(){return this._enableAutoBatch},set:function(t){this._enableAutoBatch=t}}},statics:{ShadowCastingMode:u},ctor:function(){this._boundingBox=cc.geomUtils&&new n.default},onEnable:function(){var t=this;this._super(),this._mesh&&!this._mesh.loaded?(this.disableRender(),this._mesh.once("load",(function(){t.isValid&&(t._setMesh(t._mesh),t.markForRender(!0))})),cc.assetManager.postLoadNative(this._mesh)):this._setMesh(this._mesh),this._updateRenderNode(),this._updateMaterial()},onDestroy:function(){this._setMesh(null),cc.pool.assembler.put(this._assembler)},_updateRenderNode:function(){this._assembler.setRenderNode(this.node)},_setMesh:function(t){cc.geomUtils&&t&&n.default.fromPoints(this._boundingBox,t._minPos,t._maxPos),this._mesh&&this._mesh.off("init-format",this._updateMeshAttribute,this),t&&t.on("init-format",this._updateMeshAttribute,this),this._mesh=t,this._assembler&&(this._assembler._worldDatas={}),this._updateMeshAttribute()},_getDefaultMaterial:function(){return l.getBuiltinMaterial("unlit")},_validateRender:function(){var t=this._mesh;t&&t._subDatas.length>0||this.disableRender()},_updateMaterial:function(){var t=this.textures;if(t&&t.length>0)for(var e=this._getDefaultMaterial(),i=0;i<t.length;i++){var n=this._materials[i];n&&n._uuid!==e._uuid||(n||(n=r.default.create(e,this),this.setMaterial(i,n)),n.setProperty("diffuseTexture",t[i]))}this._updateReceiveShadow(),this._updateCastShadow(),this._updateMeshAttribute()},_updateReceiveShadow:function(){for(var t=this.getMaterials(),e=0;e<t.length;e++)t[e].define("CC_USE_SHADOW_MAP",this._receiveShadows,void 0,!0)},_updateCastShadow:function(){for(var t=this.getMaterials(),e=0;e<t.length;e++)t[e].define("CC_CASTING_SHADOW",this._shadowCastingMode===u.ON,void 0,!0)},_updateMeshAttribute:function(){var t=this._mesh&&this._mesh.subDatas;if(t)for(var e=this.getMaterials(),n=0;n<e.length&&t[n];n++){var r=t[n].vfm,a=e[n];a.define("CC_USE_ATTRIBUTE_COLOR",!!r.element(i.default.ATTR_COLOR),void 0,!0),a.define("CC_USE_ATTRIBUTE_UV0",!!r.element(i.default.ATTR_UV0),void 0,!0),a.define("CC_USE_ATTRIBUTE_NORMAL",!!r.element(i.default.ATTR_NORMAL),void 0,!0),a.define("CC_USE_ATTRIBUTE_TANGENT",!!r.element(i.default.ATTR_TANGENT),void 0,!0)}},_checkBacth:function(){}});cc.MeshRenderer=e.exports=h}),{"../../renderer/core/input-assembler":316,"../../renderer/gfx":326,"../assets/material/CCMaterial":111,"../assets/material/material-variant":118,"../components/CCRenderComponent":140,"../geom-utils/aabb":170,"../renderer":225,"../renderer/render-flow":226,"../value-types/mat4":295,"../value-types/vec3":303,"./CCMesh":187}],189:[(function(t){"use strict";t("./CCMesh"),t("./CCMeshRenderer"),t("./mesh-renderer")}),{"./CCMesh":187,"./CCMeshRenderer":188,"./mesh-renderer":191}],190:[(function(t,e,i){"use strict";i.__esModule=!0,i.MeshData=l,i.Primitive=i.VertexBundle=i.VertexFormat=i.BufferRange=void 0;var n,r=(n=t("../../renderer/gfx"))&&n.__esModule?n:{default:n},a=cc.Class({name:"cc.BufferRange",properties:{offset:0,length:0}});i.BufferRange=a;var s=cc.Class({name:"cc.mesh.VertexFormat",properties:{name:"",type:-1,num:-1,normalize:!1}});i.VertexFormat=s;var o=cc.Class({name:"cc.mesh.VertexBundle",properties:{data:{default:null,type:a},formats:{default:[],type:s},verticesCount:0}});i.VertexBundle=o;var c=cc.Class({name:"cc.mesh.Primitive",properties:{vertexBundleIndices:{default:[],type:cc.Float},data:{default:null,type:a},indexUnit:r.default.INDEX_FMT_UINT16,topology:r.default.PT_TRIANGLES}});function l(){this.vData=null,this.float32VData=null,this.uint32VData=null,this.iData=null,this.uint16IData=null,this.vfm=null,this.offset=0,this.vb=null,this.ib=null,this.vDirty=!1,this.iDirty=!1,this.enable=!0}i.Primitive=c,l.prototype.setVData=function(t){this.vData=t,this.float32VData=null,this.uint32VData=null},l.prototype.getVData=function(t){return t===Float32Array?(this.float32VData||(this.float32VData=new Float32Array(this.vData.buffer,this.vData.byteOffset,this.vData.byteLength/4)),this.float32VData):t===Uint32Array?(this.uint32VData||(this.uint32VData=new Uint32Array(this.vData.buffer,this.vData.byteOffset,this.vData.byteLength/4)),this.uint32VData):this.vData},l.prototype.getIData=function(t){return t===Uint16Array?(this.uint16IData||(this.uint16IData=new Uint16Array(this.iData.buffer,this.iData.byteOffset,this.iData.byteLength/2)),this.uint16IData):this.iData}}),{"../../renderer/gfx":326}],191:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=s(t("../renderer/assembler")),r=s(t("../../renderer/gfx")),a=s(t("../value-types/vec3"));function s(t){return t&&t.__esModule?t:{default:t}}var o=t("./CCMeshRenderer"),c=new a.default,l=(function(t){var e,i;function n(){return t.apply(this,arguments)||this}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var s=n.prototype;return s.init=function(e){t.prototype.init.call(this,e),this._worldDatas={},this._renderNode=null},s.setRenderNode=function(t){this._renderNode=t},s.fillBuffers=function(t,e){if(t.mesh){t.mesh._uploadData();for(var i=e.cullingMask===t.node._cullingMask,n=t.enableAutoBatch,a=t._materials,s=t.mesh._subMeshes,o=t.mesh.subDatas,c=0;c<s.length;c++){var l=s[c],u=o[c],h=a[c]||a[0];n&&u.canBatch&&l._primitiveType===r.default.PT_TRIANGLES?(i&&h.getHash()===e.material.getHash()||e._flush(),e.material=h,e.cullingMask=t.node._cullingMask,e.node=e._dummyNode,this._fillBuffer(t,u,e,c)):(e._flush(),e.material=h,e.cullingMask=t.node._cullingMask,e.node=this._renderNode,e._flushIA(l))}}},s._fillBuffer=function(t,e,i,n){var r=e.getVData(Float32Array),a=e.vfm,s=r.byteLength/a._bytes|0,o=e.getIData(Uint16Array),c=o.length,l=i.getBuffer("mesh",a),u=l.request(s,c),h=u.indiceOffset,f=u.byteOffset>>2,d=u.vertexOffset,_=l._vData,p=l._iData;!i.worldMatDirty&&this._worldDatas[n]||this._updateWorldVertices(n,s,r,a,t.node._worldMatrix),_.set(this._worldDatas[n],f);for(var m=0;m<c;m++)p[h+m]=d+o[m]},s._updateWorldVertices=function(t,e,i,n,s){var o=this._worldDatas[t];o||(o=this._worldDatas[t]=new Float32Array(i.length)).set(i);for(var l=n._bytes/4,u=n._elements,h=0,f=u.length;h<f;h++){var d=u[h],_=d.offset/4;if(d.name===r.default.ATTR_POSITION||d.name===r.default.ATTR_NORMAL)for(var p=d.name===r.default.ATTR_NORMAL?a.default.transformMat4Normal:a.default.transformMat4,m=0;m<e;m++){var v=m*l+_;c.x=i[v],c.y=i[v+1],c.z=i[v+2],p(c,c,s),o[v]=c.x,o[v+1]=c.y,o[v+2]=c.z}}},s._drawDebugDatas=function(t,e,i){var n=t._debugDatas[i];if(n)for(var r=0;r<n.length;r++){var a=n[r];if(a){var s=a.material;e.material=s,e._flushIA(a.ia)}}},n})(n.default);i.default=l,n.default.register(o,l),e.exports=i.default}),{"../../renderer/gfx":326,"../renderer/assembler":222,"../value-types/vec3":303,"./CCMeshRenderer":188}],192:[(function(t,e){"use strict";var i=t("./component-scheduler"),n=t("./platform/CCObject").Flags,r=t("./platform/js"),a=n.IsPreloadStarted,s=n.IsOnLoadStarted,o=n.IsOnLoadCalled,c=n.Deactivating,l=cc.Class({extends:i.LifeCycleInvoker,add:function(t){this._zero.array.push(t)},remove:function(t){this._zero.fastRemove(t)},cancelInactive:function(t){i.LifeCycleInvoker.stableRemoveInactive(this._zero,t)},invoke:function(){this._invoke(this._zero),this._zero.array.length=0}}),u=i.createInvokeImpl((function(t){t.__preload()}),!1,void 0,(function(t){var e=t.array;for(t.i=0;t.i<e.length;++t.i)e[t.i].__preload()})),h=i.createInvokeImpl((function(t){t.onLoad(),t._objFlags|=o}),!1,o,(function(t){var e=t.array;for(t.i=0;t.i<e.length;++t.i){var i=e[t.i];i.onLoad(),i._objFlags|=o}})),f=new r.Pool(4);function d(t,e,i){e?t._removeComponent(e):r.array.removeAt(t._components,i)}function _(){this._activatingStack=[]}f.get=function(){var t=this._get()||{preload:new l(u),onLoad:new i.OneOffInvoker(h),onEnable:new i.OneOffInvoker(i.invokeOnEnable)};t.preload._zero.i=-1;var e=t.onLoad;return e._zero.i=-1,e._neg.i=-1,e._pos.i=-1,(e=t.onEnable)._zero.i=-1,e._neg.i=-1,e._pos.i=-1,t};var p=cc.Class({ctor:_,reset:_,_activateNodeRecursively:function(t,e,i,n){if(t._objFlags&c)cc.errorID(3816,t.name);else{t._activeInHierarchy=!0;for(var r=t._components.length,a=0;a<r;++a){var s=t._components[a];s instanceof cc.Component?this.activateComp(s,e,i,n):(d(t,s,a),--a,--r)}t._childArrivalOrder=t._children.length;for(var o=0,l=t._children.length;o<l;++o){var u=t._children[o];u._localZOrder=4294901760&u._localZOrder|o+1,u._active&&this._activateNodeRecursively(u,e,i,n)}t._onPostActivated(!0)}},_deactivateNodeRecursively:function(t){t._objFlags|=c,t._activeInHierarchy=!1;for(var e=t._components.length,i=0;i<e;++i){var n=t._components[i];if(n._enabled&&(cc.director._compScheduler.disableComp(n),t._activeInHierarchy))return void(t._objFlags&=~c)}for(var r=0,a=t._children.length;r<a;++r){var s=t._children[r];if(s._activeInHierarchy&&(this._deactivateNodeRecursively(s),t._activeInHierarchy))return void(t._objFlags&=~c)}t._onPostActivated(!1),t._objFlags&=~c},activateNode:function(t,e){if(e){var i=f.get();this._activatingStack.push(i),this._activateNodeRecursively(t,i.preload,i.onLoad,i.onEnable),i.preload.invoke(),i.onLoad.invoke(),i.onEnable.invoke(),this._activatingStack.pop(),f.put(i)}else{this._deactivateNodeRecursively(t);for(var n=this._activatingStack,r=0;r<n.length;r++){var o=n[r];o.preload.cancelInactive(a),o.onLoad.cancelInactive(s),o.onEnable.cancelInactive()}}t.emit("active-in-hierarchy-changed",t)},activateComp:function(t,e,i,n){if(cc.isValid(t,!0)&&(t._objFlags&a||(t._objFlags|=a,t.__preload&&(e?e.add(t):t.__preload())),t._objFlags&s||(t._objFlags|=s,t.onLoad?i?i.add(t):(t.onLoad(),t._objFlags|=o):t._objFlags|=o),t._enabled)){if(!t.node._activeInHierarchy)return;cc.director._compScheduler.enableComp(t,n)}},destroyComp:function(t){cc.director._compScheduler.disableComp(t),t.onDestroy&&t._objFlags&o&&t.onDestroy()},resetComp:!1});e.exports=p}),{"./component-scheduler":123,"./platform/CCObject":199,"./platform/js":214,"./utils/misc":278}],193:[(function(t,e){"use strict";var i=t("./js"),n=t("./CCEnum"),r=t("./utils"),a=(r.isPlainEmptyObj_DEV,r.cloneable_DEV,t("./attribute")),s=a.DELIMETER,o=t("./preprocess-class");t("./requiring-frame");var c=["name","extends","mixins","ctor","__ctor__","properties","statics","editor","__ES6__"];function l(t,e){t.indexOf(e)<0&&t.push(e)}var u={datas:null,push:function(t){if(this.datas)this.datas.push(t);else{this.datas=[t];var e=this;setTimeout((function(){e.init()}),0)}},init:function(){var t=this.datas;if(t){for(var e=0;e<t.length;++e){var n=t[e],r=n.cls,a=n.props;"function"==typeof a&&(a=a());var s=i.getClassName(r);a?C(r,s,a,r.$super,n.mixins):cc.errorID(3633,s)}this.datas=null}}};function h(t,e){l(t.__props__,e)}function f(t,e,i,n){var r=n.default;a.setClassAttr(t,i,"default",r),h(t,i),w(t,n,0,i)}function d(t,e,n,r,s){var o=r.get,c=r.set,l=t.prototype,u=!Object.getOwnPropertyDescriptor(l,n);o&&(w(t,r,0,n),a.setClassAttr(t,n,"serializable",!1),s||i.get(l,n,o,u,u)),c&&(s||i.set(l,n,c,u,u))}function _(t){return"function"==typeof t?t():t}function p(t,e,n){for(var r in e)t.hasOwnProperty(r)||n&&!n(r)||Object.defineProperty(t,r,i.getPropertyDescriptor(e,r))}function m(t,e,n,r){var s,o,c=r.__ctor__,l=r.ctor,u=r.__ES6__;u?(s=[l],o=l):(s=c?[c]:b(e,n,r),o=T(s,e,t,r),i.value(o,"extend",(function(t){return t.extends=this,x(t)}),!0)),i.value(o,"__ctors__",s.length>0?s:null,!0);var h=o.prototype;if(e&&(u||(i.extend(o,e),h=o.prototype),o.$super=e),n){for(var f=n.length-1;f>=0;f--){var d=n[f];p(h,d.prototype),p(o,d,(function(t){return d.hasOwnProperty(t)&&!0})),x._isCCClass(d)&&p(a.getClassAttrs(o),a.getClassAttrs(d))}h.constructor=o}return u||(h.__initProps__=y),i.setClassName(t,o),o}function v(t,e,n,r){var a=cc.Component,s=cc._RF.peek();if(s&&i.isChildClassOf(e,a)){if(i.isChildClassOf(s.cls,a))return cc.errorID(3615),null;t=t||s.script}var o=m(t,e,n,r);if(s)if(i.isChildClassOf(e,a)){var c=s.uuid;c&&i._setClassId(c,o),s.cls=o}else i.isChildClassOf(s.cls,a)||(s.cls=o);return o}function g(t,e){var i=null,n=0,r=0;return (function(){for(var a=null,o=null,c=null,l=0;l<e.length;++l){var u=e[l],h=u+s+"default";if(h in t){var f=t[h];"object"==typeof f&&f||"function"==typeof f?f instanceof cc.ValueType?(o||(o=[]),o.push(u,f)):(c||(c=[]),c.push(u,f)):(a||(a=[]),a.push(u,f))}}n=a?a.length:0;var d=(r=n+(o?o.length:0))+(c?c.length:0);i=new Array(d);for(var _=0;_<n;++_)i[_]=a[_];for(var p=n;p<r;++p)i[p]=o[p-n];for(var m=r;m<d;++m)i[m]=c[m-r]})(),function(){for(var t=0;t<n;t+=2)this[i[t]]=i[t+1];for(;t<r;t+=2)this[i[t]]=i[t+1].clone();for(;t<i.length;t+=2){var e,a=i[t+1];Array.isArray(a)?this[i[t]]=[]:(e="object"==typeof a?{}:a(),this[i[t]]=e)}}}function y(t){var e=a.getClassAttrs(t),i=t.__props__;null===i&&(u.init(),i=t.__props__);var n=g(e,i);t.prototype.__initProps__=n,n.call(this)}var T=function(t,e,i,n){var r,a=e&&A(e,n),s=t.length;return r=s>0?a?2===s?function(){this._super=null,this.__initProps__(r),t[0].apply(this,arguments),t[1].apply(this,arguments)}:function(){this._super=null,this.__initProps__(r);for(var e=0;e<t.length;++e)t[e].apply(this,arguments)}:3===s?function(){this.__initProps__(r),t[0].apply(this,arguments),t[1].apply(this,arguments),t[2].apply(this,arguments)}:function(){this.__initProps__(r);for(var t=r.__ctors__,e=0;e<t.length;++e)t[e].apply(this,arguments)}:function(){a&&(this._super=null),this.__initProps__(r)}};function b(t,e,i){for(var n,r=[],a=[t].concat(e),s=0;s<a.length;s++){var o=a[s];if(o)for(var c=(n=o,x._isCCClass(n)?n.__ctors__||[]:[n]),u=0;u<c.length;u++)l(r,c[u])}var h=i.ctor;return h&&r.push(h),r}var E=/xyz/.test((function(){xyz}))?/\b\._super\b/:/.*/;function A(t,e){var n=!1;for(var r in e)if(!(c.indexOf(r)>=0)){var a=e[r];if("function"==typeof a){var s=i.getPropertyDescriptor(t.prototype,r);if(s){var o=s.value;if("function"==typeof o){E.test(a)&&(n=!0,e[r]=(function(t,e){return function(){var i=this._super;this._super=t;var n=e.apply(this,arguments);return this._super=i,n}})(o,a));continue}}}}return n}function C(t,e,i,n,r,c){if(t.__props__=[],n&&n.__props__&&(t.__props__=n.__props__.slice()),r)for(var l=0;l<r.length;++l){var u=r[l];u.__props__&&(t.__props__=t.__props__.concat(u.__props__.filter((function(e){return t.__props__.indexOf(e)<0}))))}if(i)for(var h in o.preprocessAttrs(i,e,t,c),i){var _=i[h];"default"in _?f(t,0,h,_):d(t,0,h,_,c)}var p=a.getClassAttrs(t);t.__values__=t.__props__.filter((function(t){return!1!==p[t+s+"serializable"]}))}function x(t){var e=(t=t||{}).name,n=t.extends,r=t.mixins,a=v(e,n,r,t);e||(e=cc.js.getClassName(a)),a._sealed=!0,n&&(n._sealed=!1);var s=t.properties;"function"==typeof s||n&&null===n.__props__||r&&r.some((function(t){return null===t.__props__}))?(u.push({cls:a,props:s,mixins:r}),a.__props__=a.__values__=null):C(a,e,s,n,t.mixins,t.__ES6__);var l,h=t.statics;if(h)for(l in h)a[l]=h[l];for(var f in t)if(!(c.indexOf(f)>=0)){var d=t[f];o.validateMethodWithProps(d,f,e,a,n)&&i.value(a.prototype,f,d,!0,!0)}var _=t.editor;return _&&i.isChildClassOf(n,cc.Component)&&cc.Component._registerEditorProps(a,_),a}/xyz/.test((function(){xyz})),x._isCCClass=function(t){return t&&t.hasOwnProperty("__ctors__")},x._fastDefine=function(t,e,n){i.setClassName(t,e);for(var r=e.__props__=e.__values__=Object.keys(n),o=a.getClassAttrs(e),c=0;c<r.length;c++){var l=r[c];o[l+s+"visible"]=!1,o[l+s+"default"]=n[l]}},x.Attr=a,x.attr=a.attr,x.getInheritanceChain=function(t){for(var e=[];t=i.getSuper(t);)t!==Object&&e.push(t);return e};var S={Integer:"Number",Float:"Number",Boolean:"Boolean",String:"String"};function w(t,e,i,r){var o=null,c="";function l(){return c=r+s,o=a.getClassAttrs(t)}var u=e.type;u&&(S[u]?(o||l())[c+"type"]=u:"Object"===u||(u===a.ScriptUuid?((o||l())[c+"type"]="Script",o[c+"ctor"]=cc.ScriptAsset):"object"==typeof u?n.isEnum(u)&&((o||l())[c+"type"]="Enum",o[c+"enumList"]=n.getList(u)):"function"==typeof u&&((o||l())[c+"type"]="Object",o[c+"ctor"]=u)));function h(t,i){if(t in e){var n=e[t];typeof n===i&&((o||l())[c+t]=n)}}e.editorOnly&&((o||l())[c+"editorOnly"]=!0),!1===e.serializable&&((o||l())[c+"serializable"]=!1),h("formerlySerializedAs","string");var f=e.range;f&&Array.isArray(f)&&f.length>=2&&((o||l())[c+"min"]=f[0],o[c+"max"]=f[1],f.length>2&&(o[c+"step"]=f[2])),h("min","number"),h("max","number"),h("step","number")}cc.Class=x,e.exports={isArray:function(t){return t=_(t),Array.isArray(t)},fastDefine:x._fastDefine,getNewValueTypeCode:!1,IDENTIFIER_RE:/^[A-Za-z_$][0-9A-Za-z_$]*$/,escapeForJS:function(t){return JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")},getDefault:_}}),{"./CCEnum":195,"./attribute":205,"./js":214,"./preprocess-class":215,"./requiring-frame":216,"./utils":217}],194:[(function(t,e){"use strict";t("./CCClass");var i=t("./preprocess-class"),n=t("./js"),r="__ccclassCache__";function a(t){return t}function s(t,e){return t[e]||(t[e]={})}function o(t){return function(e){return"function"==typeof e?t(e):function(i){return t(i,e)}}}function c(t,e){return function(t){return function(i){return e(i,t)}}}var l=c.bind(null,!1);function u(){return c.bind(null,!1)}var h=u(),f=u();function d(t){return s(t,r)}function _(t){var e;try{e=t()}catch(i){return t}return"object"!=typeof e||null===e?e:t}function p(t){var e;try{e=new t}catch(i){return{}}return e}function m(t,e,r,a,s,o){var c,l=s&&(s.get||s.set);a&&(c=i.getFullFormOfProperty(a,l));var u=e[r],h=n.mixin(u||{},c||a||{});if(l)s.get&&(h.get=s.get),s.set&&(h.set=s.set);else{var f=void 0;if(s)s.initializer&&(f=_(s.initializer));else{var d=o.default||(o.default=p(t));d.hasOwnProperty(r)&&(f=d[r])}h.default=f}e[r]=h}var v=o((function(t,e){var i=n.getSuper(t);i===Object&&(i=null);var a={name:e,extends:i,ctor:t,__ES6__:!0},s=t[r];if(s){var o=s.proto;o&&n.mixin(a,o),t[r]=void 0}return cc.Class(a)}));function g(t,e,i){return t((function(t,n){var r=d(t);if(r){var a=void 0!==i?i:n,o=s(r,"proto");s(o,"editor")[e]=a}}),e)}function y(t){return t(a)}var T=y(o),b=g(l,"requireComponent"),E=y(h),A=g(f,"executionOrder"),C=y(o),x=y(o),S=y(h),w=y(h),M=y(h);cc._decorator=e.exports={ccclass:v,property:function(t,e,i){var n=null;function r(t,e,i){var r=d(t.constructor);if(r){var a=s(r,"proto"),o=s(a,"properties");m(t.constructor,o,e,n,i,r)}}if(void 0===e)return n=t,r;r(t,e,i)},executeInEditMode:T,requireComponent:b,menu:E,executionOrder:A,disallowMultiple:C,playOnFocus:x,inspector:S,icon:w,help:M,mixins:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){var i=d(e);i&&(s(i,"proto").mixins=t)}}}}),{"./CCClass":193,"./js":214,"./preprocess-class":215,"./utils":217}],195:[(function(t,e){"use strict";var i=t("./js");function n(t){if("__enums__"in t)return t;i.value(t,"__enums__",null,!0);for(var e=-1,n=Object.keys(t),r=0;r<n.length;r++){var a=n[r],s=t[a];if(-1===s)s=++e,t[a]=s;else if("number"==typeof s)e=s;else if("string"==typeof s&&Number.isInteger(parseFloat(a)))continue;var o=""+s;a!==o&&i.value(t,o,a)}return t}n.isEnum=function(t){return t&&t.hasOwnProperty("__enums__")},n.getList=function(t){if(t.__enums__)return t.__enums__;var e=t.__enums__=[];for(var i in t){var n=t[i];Number.isInteger(n)&&e.push({name:i,value:n})}return e.sort((function(t,e){return t.value-e.value})),e},e.exports=cc.Enum=n}),{"./js":214}],196:[(function(t){"use strict";var e,i=t("../event-manager"),n=t("./CCInputManager");cc.Acceleration=function(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.timestamp=n||0},n.setAccelerometerEnabled=function(t){var e=this;if(e._accelEnabled!==t){e._accelEnabled=t;var i=cc.director.getScheduler();i.enableForTarget(e),e._accelEnabled?(e._registerAccelerometerEvent(),e._accelCurTime=0,i.scheduleUpdate(e)):(e._unregisterAccelerometerEvent(),e._accelCurTime=0,i.unscheduleUpdate(e))}},n.setAccelerometerInterval=function(t){this._accelInterval!==t&&(this._accelInterval=t)},n._registerKeyboardEvent=function(){cc.game.canvas.addEventListener("keydown",(function(t){i.dispatchEvent(new cc.Event.EventKeyboard(t.keyCode,!0)),t.stopPropagation(),t.preventDefault()}),!1),cc.game.canvas.addEventListener("keyup",(function(t){i.dispatchEvent(new cc.Event.EventKeyboard(t.keyCode,!1)),t.stopPropagation(),t.preventDefault()}),!1)},n._registerAccelerometerEvent=function(){var t=window,i=this;i._acceleration=new cc.Acceleration,i._accelDeviceEvent=t.DeviceMotionEvent||t.DeviceOrientationEvent,cc.sys.browserType===cc.sys.BROWSER_TYPE_MOBILE_QQ&&(i._accelDeviceEvent=window.DeviceOrientationEvent);var n=i._accelDeviceEvent===t.DeviceMotionEvent?"devicemotion":"deviceorientation",r=navigator.userAgent;(/Android/.test(r)||/Adr/.test(r)&&cc.sys.browserType===cc.BROWSER_TYPE_UC)&&(i._minus=-1),e=i.didAccelerate.bind(i),t.addEventListener(n,e,!1)},n._unregisterAccelerometerEvent=function(){var t=window,i=this._accelDeviceEvent===t.DeviceMotionEvent?"devicemotion":"deviceorientation";e&&t.removeEventListener(i,e,!1)},n.didAccelerate=function(t){var e=this,i=window;if(e._accelEnabled){var n,r,a,s=e._acceleration;if(e._accelDeviceEvent===window.DeviceMotionEvent){var o=t.accelerationIncludingGravity;n=e._accelMinus*o.x*.1,r=e._accelMinus*o.y*.1,a=.1*o.z}else n=t.gamma/90*.981,r=-t.beta/90*.981,a=t.alpha/90*.981;if(cc.view._isRotated){var c=n;n=-r,r=c}s.x=n,s.y=r,s.z=a,s.timestamp=t.timeStamp||Date.now();var l=s.x;90===i.orientation?(s.x=-s.y,s.y=l):-90===i.orientation?(s.x=s.y,s.y=-l):180===i.orientation&&(s.x=-s.x,s.y=-s.y),cc.sys.os===cc.sys.OS_ANDROID&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_MOBILE_QQ&&(s.x=-s.x,s.y=-s.y)}}}),{"../event-manager":164,"./CCInputManager":197}],197:[(function(t,e){"use strict";var i=t("./CCMacro"),n=t("./CCSys"),r=t("../event-manager"),a=i.TOUCH_TIMEOUT,s=cc.v2(),o={_mousePressed:!1,_isRegisterEvent:!1,_preTouchPoint:cc.v2(0,0),_prevMousePoint:cc.v2(0,0),_preTouchPool:[],_preTouchPoolPointer:0,_touches:[],_touchesIntegerDict:{},_indexBitsUsed:0,_maxTouches:8,_accelEnabled:!1,_accelInterval:.2,_accelMinus:1,_accelCurTime:0,_acceleration:null,_accelDeviceEvent:null,_canvasBoundingRect:{left:0,top:0,adjustedLeft:0,adjustedTop:0,width:0,height:0},_getUnUsedIndex:function(){for(var t=this._indexBitsUsed,e=cc.sys.now(),i=0;i<this._maxTouches;i++){if(!(1&t))return this._indexBitsUsed|=1<<i,i;var n=this._touches[i];if(e-n._lastModified>a)return this._removeUsedIndexBit(i),delete this._touchesIntegerDict[n.getID()],i;t>>=1}return-1},_removeUsedIndexBit:function(t){if(!(t<0||t>=this._maxTouches)){var e=1<<t;e=~e,this._indexBitsUsed&=e}},_glView:null,_updateCanvasBoundingRect:function(){var t=cc.game.canvas,e=this._canvasBoundingRect,i=document.documentElement,n=window.pageXOffset-i.clientLeft,r=window.pageYOffset-i.clientTop;if(t.getBoundingClientRect){var a=t.getBoundingClientRect();e.left=a.left+n,e.top=a.top+r,e.width=a.width,e.height=a.height}else t instanceof HTMLCanvasElement?(e.left=n,e.top=r,e.width=t.width,e.height=t.height):(e.left=n,e.top=r,e.width=parseInt(t.style.width),e.height=parseInt(t.style.height))},handleTouchesBegin:function(t){for(var e,i,a,s=[],o=this._touchesIntegerDict,c=n.now(),l=0,u=t.length;l<u;l++)if(null==o[a=(e=t[l]).getID()]){var h=this._getUnUsedIndex();if(-1===h){cc.logID(2300,h);continue}(i=this._touches[h]=new cc.Touch(e._point.x,e._point.y,e.getID()))._lastModified=c,i._setPrevPoint(e._prevPoint),o[a]=h,s.push(i)}if(s.length>0){this._glView._convertTouchesWithScale(s);var f=new cc.Event.EventTouch(s);f._eventCode=cc.Event.EventTouch.BEGAN,r.dispatchEvent(f)}},handleTouchesMove:function(t){for(var e,i,a,s=[],o=this._touches,c=n.now(),l=0,u=t.length;l<u;l++)a=(e=t[l]).getID(),null!=(i=this._touchesIntegerDict[a])&&o[i]&&(o[i]._setPoint(e._point),o[i]._setPrevPoint(e._prevPoint),o[i]._lastModified=c,s.push(o[i]));if(s.length>0){this._glView._convertTouchesWithScale(s);var h=new cc.Event.EventTouch(s);h._eventCode=cc.Event.EventTouch.MOVED,r.dispatchEvent(h)}},handleTouchesEnd:function(t){var e=this.getSetOfTouchesEndOrCancel(t);if(e.length>0){this._glView._convertTouchesWithScale(e);var i=new cc.Event.EventTouch(e);i._eventCode=cc.Event.EventTouch.ENDED,r.dispatchEvent(i)}this._preTouchPool.length=0},handleTouchesCancel:function(t){var e=this.getSetOfTouchesEndOrCancel(t);if(e.length>0){this._glView._convertTouchesWithScale(e);var i=new cc.Event.EventTouch(e);i._eventCode=cc.Event.EventTouch.CANCELED,r.dispatchEvent(i)}this._preTouchPool.length=0},getSetOfTouchesEndOrCancel:function(t){for(var e,i,n,r=[],a=this._touches,s=this._touchesIntegerDict,o=0,c=t.length;o<c;o++)null!=(i=s[n=(e=t[o]).getID()])&&a[i]&&(a[i]._setPoint(e._point),a[i]._setPrevPoint(e._prevPoint),r.push(a[i]),this._removeUsedIndexBit(i),delete s[n]);return r},getPreTouch:function(t){for(var e=null,i=this._preTouchPool,n=t.getID(),r=i.length-1;r>=0;r--)if(i[r].getID()===n){e=i[r];break}return e||(e=t),e},setPreTouch:function(t){for(var e=!1,i=this._preTouchPool,n=t.getID(),r=i.length-1;r>=0;r--)if(i[r].getID()===n){i[r]=t,e=!0;break}e||(i.length<=50?i.push(t):(i[this._preTouchPoolPointer]=t,this._preTouchPoolPointer=(this._preTouchPoolPointer+1)%50))},getTouchByXY:function(t,e,i){var n=this._preTouchPoint,r=this._glView.convertToLocationInView(t,e,i),a=new cc.Touch(r.x,r.y,0);return a._setPrevPoint(n.x,n.y),n.x=r.x,n.y=r.y,a},getMouseEvent:function(t,e,i){var n=this._prevMousePoint,r=new cc.Event.EventMouse(i);return r._setPrevCursor(n.x,n.y),n.x=t.x,n.y=t.y,this._glView._convertMouseToLocationInView(n,e),r.setLocation(n.x,n.y),r},getPointByEvent:function(t,e){return cc.sys.browserType!==cc.sys.BROWSER_TYPE_QQ&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_UC&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_SAFARI||this._updateCanvasBoundingRect(),null!=t.pageX?{x:t.pageX,y:t.pageY}:(e.left-=document.body.scrollLeft,e.top-=document.body.scrollTop,{x:t.clientX,y:t.clientY})},getTouchesByEvent:function(t,e){for(var i,r,a,o=[],c=this._glView,l=this._preTouchPoint,u=t.changedTouches.length,h=0;h<u;h++)if(i=t.changedTouches[h]){var f;f=n.BROWSER_TYPE_FIREFOX===n.browserType?c.convertToLocationInView(i.pageX,i.pageY,e,s):c.convertToLocationInView(i.clientX,i.clientY,e,s),null!=i.identifier?(r=new cc.Touch(f.x,f.y,i.identifier),a=this.getPreTouch(r).getLocation(),r._setPrevPoint(a.x,a.y),this.setPreTouch(r)):(r=new cc.Touch(f.x,f.y))._setPrevPoint(l.x,l.y),l.x=f.x,l.y=f.y,o.push(r)}return o},registerSystemEvent:function(t){if(!this._isRegisterEvent){this._glView=cc.view;var e=this,i=this._canvasBoundingRect;window.addEventListener("resize",this._updateCanvasBoundingRect.bind(this));var a=n.isMobile,s="mouse"in n.capabilities,o="touches"in n.capabilities;if(s){a||(window.addEventListener("mousedown",(function(){e._mousePressed=!0}),!1),window.addEventListener("mouseup",(function(t){if(e._mousePressed){e._mousePressed=!1;var n=e.getPointByEvent(t,i);if(!cc.rect(i.left,i.top,i.width,i.height).contains(n)){e.handleTouchesEnd([e.getTouchByXY(n.x,n.y,i)]);var a=e.getMouseEvent(n,i,cc.Event.EventMouse.UP);a.setButton(t.button),r.dispatchEvent(a)}}}),!1));for(var c=cc.Event.EventMouse,l=[!a&&["mousedown",c.DOWN,function(i,n,r,a){e._mousePressed=!0,e.handleTouchesBegin([e.getTouchByXY(r.x,r.y,a)]),t.focus()}],!a&&["mouseup",c.UP,function(t,i,n,r){e._mousePressed=!1,e.handleTouchesEnd([e.getTouchByXY(n.x,n.y,r)])}],!a&&["mousemove",c.MOVE,function(t,i,n,r){e.handleTouchesMove([e.getTouchByXY(n.x,n.y,r)]),e._mousePressed||i.setButton(null)}],["mousewheel",c.SCROLL,function(t,e){e.setScrollData(0,t.wheelDelta)}],["DOMMouseScroll",c.SCROLL,function(t,e){e.setScrollData(0,-120*t.detail)}]],u=0;u<l.length;++u){var h=l[u];h&&(function(){var n=h[0],a=h[1],s=h[2];t.addEventListener(n,(function(t){var n=e.getPointByEvent(t,i),o=e.getMouseEvent(n,i,a);o.setButton(t.button),s(t,o,n,i),r.dispatchEvent(o),t.stopPropagation(),t.preventDefault()}),!1)})()}}if(window.navigator.msPointerEnabled){var f={MSPointerDown:e.handleTouchesBegin,MSPointerMove:e.handleTouchesMove,MSPointerUp:e.handleTouchesEnd,MSPointerCancel:e.handleTouchesCancel},d=function(n){var r=f[n];t.addEventListener(n,(function(t){var n=document.documentElement;i.adjustedLeft=i.left-n.scrollLeft,i.adjustedTop=i.top-n.scrollTop,r.call(e,[e.getTouchByXY(t.clientX,t.clientY,i)]),t.stopPropagation()}),!1)};for(var _ in f)d(_)}if(o){var p={touchstart:function(i){e.handleTouchesBegin(i),t.focus()},touchmove:function(t){e.handleTouchesMove(t)},touchend:function(t){e.handleTouchesEnd(t)},touchcancel:function(t){e.handleTouchesCancel(t)}},m=function(n){var r=p[n];t.addEventListener(n,(function(t){if(t.changedTouches){var n=document.body;i.adjustedLeft=i.left-(n.scrollLeft||window.scrollX||0),i.adjustedTop=i.top-(n.scrollTop||window.scrollY||0),r(e.getTouchesByEvent(t,i)),t.stopPropagation(),t.preventDefault()}}),!1)};for(var v in p)m(v)}this._registerKeyboardEvent(),this._isRegisterEvent=!0}},_registerKeyboardEvent:function(){},_registerAccelerometerEvent:function(){},update:function(t){this._accelCurTime>this._accelInterval&&(this._accelCurTime-=this._accelInterval,r.dispatchEvent(new cc.Event.EventAcceleration(this._acceleration))),this._accelCurTime+=t}};e.exports=cc.internal.inputManager=o}),{"../event-manager":164,"./CCMacro":198,"./CCSys":202}],198:[(function(t,e){"use strict";cc.macro={RAD:Math.PI/180,DEG:180/Math.PI,REPEAT_FOREVER:Number.MAX_VALUE-1,FLT_EPSILON:1.192092896e-7,MIN_ZINDEX:-Math.pow(2,15),MAX_ZINDEX:Math.pow(2,15)-1,ONE:1,ZERO:0,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,DST_ALPHA:772,DST_COLOR:774,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_CONSTANT_ALPHA:32772,ONE_MINUS_CONSTANT_COLOR:32770,ORIENTATION_PORTRAIT:1,ORIENTATION_LANDSCAPE:2,ORIENTATION_AUTO:3,DENSITYDPI_DEVICE:"device-dpi",DENSITYDPI_HIGH:"high-dpi",DENSITYDPI_MEDIUM:"medium-dpi",DENSITYDPI_LOW:"low-dpi",FIX_ARTIFACTS_BY_STRECHING_TEXEL_TMX:!0,DIRECTOR_STATS_POSITION:cc.v2(0,0),ENABLE_STACKABLE_ACTIONS:!0,TOUCH_TIMEOUT:5e3,BATCH_VERTEX_COUNT:2e4,ENABLE_TILEDMAP_CULLING:!0,ENABLE_TRANSPARENT_CANVAS:!1,ENABLE_WEBGL_ANTIALIAS:!1,ENABLE_CULLING:!1,CLEANUP_IMAGE_CACHE:!1,SHOW_MESH_WIREFRAME:!1,SHOW_MESH_NORMAL:!1,ENABLE_MULTI_TOUCH:!0,ALLOW_IMAGE_BITMAP:!cc.sys.isMobile,ENABLE_NATIVE_TTF_RENDERER:!0},Object.defineProperty(cc.macro,"ROTATE_ACTION_CCW",{set:function(t){cc.RotateTo&&cc.RotateBy&&(cc.RotateTo._reverse=cc.RotateBy._reverse=t)}}),cc.macro.SUPPORT_TEXTURE_FORMATS=[".pkm",".pvr",".webp",".jpg",".jpeg",".bmp",".png"],cc.macro.KEY={none:0,back:6,menu:18,backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,escape:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,select:41,insert:45,Delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,num0:96,num1:97,num2:98,num3:99,num4:100,num5:101,num6:102,num7:103,num8:104,num9:105,"*":106,"+":107,"-":109,numdel:110,"/":111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrolllock:145,";":186,semicolon:186,equal:187,"=":187,",":188,comma:188,dash:189,".":190,period:190,forwardslash:191,grave:192,"[":219,openbracket:219,backslash:220,"]":221,closebracket:221,quote:222,dpadLeft:1e3,dpadRight:1001,dpadUp:1003,dpadDown:1004,dpadCenter:1005},cc.macro.ImageFormat=cc.Enum({JPG:0,PNG:1,TIFF:2,WEBP:3,PVR:4,ETC:5,S3TC:6,ATITC:7,TGA:8,RAWDATA:9,UNKNOWN:10}),cc.macro.BlendFactor=cc.Enum({ONE:1,ZERO:0,SRC_ALPHA:770,SRC_COLOR:768,DST_ALPHA:772,DST_COLOR:774,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775}),cc.macro.TextAlignment=cc.Enum({LEFT:0,CENTER:1,RIGHT:2}),cc.macro.VerticalTextAlignment=cc.Enum({TOP:0,CENTER:1,BOTTOM:2}),e.exports=cc.macro}),{}],199:[(function(t,e){"use strict";var i=t("./js"),n=t("./CCClass"),r=1;function a(){this._name="",this._objFlags=0}n.fastDefine("cc.Object",a,{_name:"",_objFlags:0}),i.value(a,"Flags",{Destroyed:r,DontSave:8,EditorOnly:16,Dirty:32,DontDestroy:64,PersistentMask:-4192741,Destroying:128,Deactivating:256,LockedInEditor:512,HideInHierarchy:1024,IsPreloadStarted:8192,IsOnLoadStarted:32768,IsOnLoadCalled:16384,IsOnEnableCalled:2048,IsStartCalled:65536,IsEditorOnEnableCalled:4096,IsPositionLocked:1<<21,IsRotationLocked:1<<17,IsScaleLocked:1<<18,IsAnchorLocked:1<<19,IsSizeLocked:1<<20});var s=[];i.value(a,"_deferredDestroy",(function(){for(var t=s.length,e=0;e<t;++e){var i=s[e];i._objFlags&r||i._destroyImmediate()}t===s.length?s.length=0:s.splice(0,t)}));var o=a.prototype;function c(t,e){var i,n=t instanceof cc._BaseNode||t instanceof cc.Component,r=n?"_id":null,a={};for(i in t)if(t.hasOwnProperty(i)){if(i===r)continue;switch(typeof t[i]){case"string":a[i]="";break;case"object":case"function":a[i]=null}}if(cc.Class._isCCClass(e))for(var s=cc.Class.Attr.getClassAttrs(e),o=e.__props__,c=0;c<o.length;c++){var l=(i=o[c])+cc.Class.Attr.DELIMETER+"default";if(l in s){if(n&&"_id"===i)continue;switch(typeof s[l]){case"string":a[i]="";break;case"object":case"function":a[i]=null;break;case"undefined":a[i]=void 0}}}return function(t){for(var e in a)t[e]=a[e]}}i.getset(o,"name",(function(){return this._name}),(function(t){this._name=t}),!0),i.get(o,"isValid",(function(){return!(this._objFlags&r)}),!0),o.destroy=function(){return this._objFlags&r?(cc.warnID(5e3),!1):!(4&this._objFlags||(this._objFlags|=4,s.push(this),0))},o._destruct=function(){var t=this.constructor,e=t.__destruct__;e||(e=c(this,t),i.value(t,"__destruct__",e,!0)),e(this)},o._onPreDestroy=null,o._destroyImmediate=function(){this._objFlags&r?cc.errorID(5e3):(this._onPreDestroy&&this._onPreDestroy(),this._destruct(),this._objFlags|=r)},o._deserialize=null,cc.isValid=function(t,e){return"object"==typeof t?!(!t||t._objFlags&(e?4|r:r)):void 0!==t},cc.Object=e.exports=a}),{"./CCClass":193,"./js":214}],200:[(function(t,e){"use strict";var i=t("../platform/js");cc.SAXParser=function(){window.DOMParser?(this._isSupportDOMParser=!0,this._parser=new DOMParser):(this._isSupportDOMParser=!1,this._parser=null)},cc.SAXParser.prototype={constructor:cc.SAXParser,parse:function(t){return this._parseXML(t)},_parseXML:function(t){var e;return this._isSupportDOMParser?e=this._parser.parseFromString(t,"text/xml"):((e=new ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(t)),e}},cc.PlistParser=function(){cc.SAXParser.call(this)},i.extend(cc.PlistParser,cc.SAXParser),i.mixin(cc.PlistParser.prototype,{parse:function(t){var e=this._parseXML(t),i=e.documentElement;if("plist"!==i.tagName)return cc.warnID(5100),{};for(var n=null,r=0,a=i.childNodes.length;r<a&&1!==(n=i.childNodes[r]).nodeType;r++);return e=null,this._parseNode(n)},_parseNode:function(t){var e=null,i=t.tagName;if("dict"===i)e=this._parseDict(t);else if("array"===i)e=this._parseArray(t);else if("string"===i)if(1===t.childNodes.length)e=t.firstChild.nodeValue;else{e="";for(var n=0;n<t.childNodes.length;n++)e+=t.childNodes[n].nodeValue}else"false"===i?e=!1:"true"===i?e=!0:"real"===i?e=parseFloat(t.firstChild.nodeValue):"integer"===i&&(e=parseInt(t.firstChild.nodeValue,10));return e},_parseArray:function(t){for(var e=[],i=0,n=t.childNodes.length;i<n;i++){var r=t.childNodes[i];1===r.nodeType&&e.push(this._parseNode(r))}return e},_parseDict:function(t){for(var e={},i=null,n=0,r=t.childNodes.length;n<r;n++){var a=t.childNodes[n];1===a.nodeType&&("key"===a.tagName?i=a.firstChild.nodeValue:e[i]=this._parseNode(a))}return e}}),cc.saxParser=new cc.SAXParser,cc.plistParser=new cc.PlistParser,e.exports={saxParser:cc.saxParser,plistParser:cc.plistParser}}),{"../platform/js":214}],201:[(function(){"use strict";cc.screen={_supportsFullScreen:!1,_onfullscreenchange:null,_onfullscreenerror:null,_preOnFullScreenChange:null,_preOnFullScreenError:null,_preOnTouch:null,_touchEvent:"",_fn:null,_fnMap:[["requestFullscreen","exitFullscreen","fullscreenchange","fullscreenEnabled","fullscreenElement","fullscreenerror"],["requestFullScreen","exitFullScreen","fullScreenchange","fullScreenEnabled","fullScreenElement","fullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitfullscreenchange","webkitIsFullScreen","webkitCurrentFullScreenElement","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozFullScreen","mozFullScreenElement","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","MSFullscreenChange","msFullscreenEnabled","msFullscreenElement","msfullscreenerror"]],init:function(){this._fn={};var t,e,i,n,r=this._fnMap;for(t=0,e=r.length;t<e;t++)if((i=r[t])&&void 0!==document[i[1]]){for(t=0,n=i.length;t<n;t++)this._fn[r[0][t]]=i[t];break}this._supportsFullScreen=void 0!==this._fn.requestFullscreen,this._touchEvent="ontouchend"in window?"touchend":"mousedown"},fullScreen:function(){return!!this._supportsFullScreen&&!!(document[this._fn.fullscreenElement]||document[this._fn.webkitFullscreenElement]||document[this._fn.mozFullScreenElement])},requestFullScreen:function(t,e,i){if(t&&"video"===t.tagName.toLowerCase()){if(cc.sys.os===cc.sys.OS_IOS&&cc.sys.isBrowser&&t.readyState>0)return void(t.webkitEnterFullscreen&&t.webkitEnterFullscreen());t.setAttribute("x5-video-player-fullscreen","true")}if(this._supportsFullScreen){if(t=t||document.documentElement,e){var n=this._fn.fullscreenchange;this._onfullscreenchange&&document.removeEventListener(n,this._onfullscreenchange),this._onfullscreenchange=e,document.addEventListener(n,e,!1)}if(i){var r=this._fn.fullscreenerror;this._onfullscreenerror&&document.removeEventListener(r,this._onfullscreenerror),this._onfullscreenerror=i,document.addEventListener(r,i,{once:!0})}var a=t[this._fn.requestFullscreen]();void 0===document[this._fn.fullscreenerror]&&window.Promise&&a instanceof Promise&&a.catch((function(){}))}},exitFullScreen:function(t){if(t&&"video"===t.tagName.toLowerCase()){if(cc.sys.os===cc.sys.OS_IOS&&cc.sys.isBrowser)return void(t.webkitExitFullscreen&&t.webkitExitFullscreen());t.setAttribute("x5-video-player-fullscreen","false")}return!this._supportsFullScreen||document[this._fn.exitFullscreen]()},autoFullScreen:function(t,e){t=t||document.body,this._ensureFullScreen(t,e),this.requestFullScreen(t,e)},disableAutoFullScreen:function(t){var e=cc.game.canvas||t,i=this._touchEvent;this._preOnTouch&&(e.removeEventListener(i,this._preOnTouch),this._preOnTouch=null)},_ensureFullScreen:function(t,e){var i=this,n=cc.game.canvas||t,r=this._fn.fullscreenerror,a=this._touchEvent;function s(){i._preOnFullScreenError=null,i._preOnTouch&&n.removeEventListener(a,i._preOnTouch),i._preOnTouch=function(){i._preOnTouch=null,i.requestFullScreen(t,e)},n.addEventListener(a,i._preOnTouch,{once:!0})}this._preOnFullScreenError&&t.removeEventListener(r,this._preOnFullScreenError),this._preOnFullScreenError=s,t.addEventListener(r,s,{once:!0})}},cc.screen.init()}),{}],202:[(function(t,e){"use strict";window._CCSettings&&_CCSettings.platform;var i="undefined"==typeof window?global:window,n=cc&&cc.sys?cc.sys:(function(){cc.sys={};var t,e,n=cc.sys;if(n.LANGUAGE_ENGLISH="en",n.LANGUAGE_CHINESE="zh",n.LANGUAGE_FRENCH="fr",n.LANGUAGE_ITALIAN="it",n.LANGUAGE_GERMAN="de",n.LANGUAGE_SPANISH="es",n.LANGUAGE_DUTCH="du",n.LANGUAGE_RUSSIAN="ru",n.LANGUAGE_KOREAN="ko",n.LANGUAGE_JAPANESE="ja",n.LANGUAGE_HUNGARIAN="hu",n.LANGUAGE_PORTUGUESE="pt",n.LANGUAGE_ARABIC="ar",n.LANGUAGE_NORWEGIAN="no",n.LANGUAGE_POLISH="pl",n.LANGUAGE_TURKISH="tr",n.LANGUAGE_UKRAINIAN="uk",n.LANGUAGE_ROMANIAN="ro",n.LANGUAGE_BULGARIAN="bg",n.LANGUAGE_UNKNOWN="unknown",n.OS_IOS="iOS",n.OS_ANDROID="Android",n.OS_WINDOWS="Windows",n.OS_MARMALADE="Marmalade",n.OS_LINUX="Linux",n.OS_BADA="Bada",n.OS_BLACKBERRY="Blackberry",n.OS_OSX="OS X",n.OS_WP8="WP8",n.OS_WINRT="WINRT",n.OS_UNKNOWN="Unknown",n.UNKNOWN=-1,n.WIN32=0,n.LINUX=1,n.MACOS=2,n.ANDROID=3,n.IPHONE=4,n.IPAD=5,n.BLACKBERRY=6,n.NACL=7,n.EMSCRIPTEN=8,n.TIZEN=9,n.WINRT=10,n.WP8=11,n.MOBILE_BROWSER=100,n.DESKTOP_BROWSER=101,n.EDITOR_PAGE=102,n.EDITOR_CORE=103,n.WECHAT_GAME=104,n.QQ_PLAY=105,n.FB_PLAYABLE_ADS=106,n.BAIDU_GAME=107,n.VIVO_GAME=108,n.OPPO_GAME=109,n.HUAWEI_GAME=110,n.XIAOMI_GAME=111,n.JKW_GAME=112,n.ALIPAY_GAME=113,n.WECHAT_GAME_SUB=114,n.BAIDU_GAME_SUB=115,n.QTT_GAME=116,n.BYTEDANCE_GAME=117,n.BYTEDANCE_GAME_SUB=118,n.LINKSURE=119,n.BROWSER_TYPE_WECHAT="wechat",n.BROWSER_TYPE_ANDROID="androidbrowser",n.BROWSER_TYPE_IE="ie",n.BROWSER_TYPE_EDGE="edge",n.BROWSER_TYPE_QQ="qqbrowser",n.BROWSER_TYPE_MOBILE_QQ="mqqbrowser",n.BROWSER_TYPE_UC="ucbrowser",n.BROWSER_TYPE_UCBS="ucbs",n.BROWSER_TYPE_360="360browser",n.BROWSER_TYPE_BAIDU_APP="baiduboxapp",n.BROWSER_TYPE_BAIDU="baidubrowser",n.BROWSER_TYPE_MAXTHON="maxthon",n.BROWSER_TYPE_OPERA="opera",n.BROWSER_TYPE_OUPENG="oupeng",n.BROWSER_TYPE_MIUI="miuibrowser",n.BROWSER_TYPE_FIREFOX="firefox",n.BROWSER_TYPE_SAFARI="safari",n.BROWSER_TYPE_CHROME="chrome",n.BROWSER_TYPE_LIEBAO="liebao",n.BROWSER_TYPE_QZONE="qzone",n.BROWSER_TYPE_SOUGOU="sogou",n.BROWSER_TYPE_HUAWEI="huawei",n.BROWSER_TYPE_UNKNOWN="unknown",n.isNative=!1,n.isBrowser="object"==typeof window&&"object"==typeof document&&!0,n.glExtension=function(t){return!!cc.renderer.device.ext(t)},n.getMaxJointMatrixSize=function(){if(!n._maxJointMatrixSize){var t=cc.game._renderContext,e=Math.floor(t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS)/4)-10;n._maxJointMatrixSize=e<50?0:50}return n._maxJointMatrixSize},n.getSafeAreaRect=function(){var t=cc.view.getVisibleSize();return cc.rect(0,0,t.width,t.height)},i.__globalAdapter&&i.__globalAdapter.adaptSys)i.__globalAdapter.adaptSys(n);else{var r=window,a=r.navigator,s=document,o=s.documentElement,c=a.userAgent.toLowerCase();n.isMobile=/mobile|android|iphone|ipad/.test(c),"undefined"!=typeof FbPlayableAd?n.platform=n.FB_PLAYABLE_ADS:n.platform=n.isMobile?n.MOBILE_BROWSER:n.DESKTOP_BROWSER;var l=a.language;l=l||a.browserLanguage,n.languageCode=l.toLowerCase(),l=l?l.split("-")[0]:n.LANGUAGE_ENGLISH,n.language=l;var u=!1,h=!1,f="",d=0,_=/android\s*(\d+(?:\.\d+)*)/i.exec(c)||/android\s*(\d+(?:\.\d+)*)/i.exec(a.platform);_&&(u=!0,f=_[1]||"",d=parseInt(f)||0),(_=/(iPad|iPhone|iPod).*OS ((\d+_?){2,3})/i.exec(c))?(h=!0,f=_[2]||"",d=parseInt(f)||0):(/(iPhone|iPad|iPod)/.exec(a.platform)||"MacIntel"===a.platform&&a.maxTouchPoints&&a.maxTouchPoints>1)&&(h=!0,f="",d=0);var p=n.OS_UNKNOWN;-1!==a.appVersion.indexOf("Win")?p=n.OS_WINDOWS:h?p=n.OS_IOS:-1!==a.appVersion.indexOf("Mac")?p=n.OS_OSX:-1!==a.appVersion.indexOf("X11")&&-1===a.appVersion.indexOf("Linux")?p=n.OS_UNIX:u?p=n.OS_ANDROID:-1===a.appVersion.indexOf("Linux")&&-1===c.indexOf("ubuntu")||(p=n.OS_LINUX),n.os=p,n.osVersion=f,n.osMainVersion=d,n.browserType=n.BROWSER_TYPE_UNKNOWN,(function(){var t=/mqqbrowser|micromessenger|qqbrowser|sogou|qzone|liebao|maxthon|ucbs|360 aphone|360browser|baiduboxapp|baidubrowser|maxthon|mxbrowser|miuibrowser/i.exec(c)||/qq|ucbrowser|ubrowser|edge|HuaweiBrowser/i.exec(c)||/chrome|safari|firefox|trident|opera|opr\/|oupeng/i.exec(c),e=t?t[0].toLowerCase():n.BROWSER_TYPE_UNKNOWN;"safari"===e&&u?e=n.BROWSER_TYPE_ANDROID:"qq"===e&&c.match(/android.*applewebkit/i)&&(e=n.BROWSER_TYPE_ANDROID);var i={micromessenger:n.BROWSER_TYPE_WECHAT,trident:n.BROWSER_TYPE_IE,edge:n.BROWSER_TYPE_EDGE,"360 aphone":n.BROWSER_TYPE_360,mxbrowser:n.BROWSER_TYPE_MAXTHON,"opr/":n.BROWSER_TYPE_OPERA,ubrowser:n.BROWSER_TYPE_UC,huaweibrowser:n.BROWSER_TYPE_HUAWEI};n.browserType=i[e]||e})(),n.browserVersion="",(e=c.match(/(mqqbrowser|micromessenger|qqbrowser|sogou|qzone|liebao|maxthon|uc|ucbs|360 aphone|360|baiduboxapp|baidu|maxthon|mxbrowser|miui(?:.hybrid)?)(mobile)?(browser)?\/?([\d.]+)/i))||(e=c.match(/(qq|chrome|safari|firefox|trident|opera|opr\/|oupeng)(mobile)?(browser)?\/?([\d.]+)/i)),n.browserVersion=e?e[4]:"";var m=window.innerWidth||document.documentElement.clientWidth,v=window.innerHeight||document.documentElement.clientHeight,g=window.devicePixelRatio||1;n.windowPixelResolution={width:g*m,height:g*v},n._checkWebGLRenderMode=function(){if(cc.game.renderType!==cc.game.RENDER_TYPE_WEBGL)throw new Error("This feature supports WebGL render mode only.")};var y=document.createElement("canvas");try{var T=n.localStorage=r.localStorage;T.setItem("storage",""),T.removeItem("storage"),T=null}catch(M){var b=function(){cc.warnID(5200)};n.localStorage={getItem:b,setItem:b,removeItem:b,clear:b}}var E=y.toDataURL("image/webp").startsWith("data:image/webp"),A=!!y.getContext("2d"),C=!1;r.WebGLRenderingContext&&(C=!0);var x,S=n.capabilities={canvas:A,opengl:C,webp:E,imageBitmap:!1};"undefined"!=typeof createImageBitmap&&"undefined"!=typeof Blob&&(y.width=y.height=2,createImageBitmap(y,{}).then((function(t){S.imageBitmap=!0,t.close&&t.close()})).catch((function(){}))),(void 0!==o.ontouchstart||void 0!==s.ontouchstart||a.msPointerEnabled)&&(S.touches=!0),void 0!==o.onmouseup&&(S.mouse=!0),void 0!==o.onkeyup&&(S.keyboard=!0),(r.DeviceMotionEvent||r.DeviceOrientationEvent)&&(S.accelerometer=!0),(function(){n.browserVersion;var t=!!(window.AudioContext||window.webkitAudioContext||window.mozAudioContext);x={ONLY_ONE:!1,WEB_AUDIO:t,DELAY_CREATE_CTX:!1},n.os===n.OS_IOS&&(x.USE_LOADER_EVENT="loadedmetadata"),n.browserType===n.BROWSER_TYPE_FIREFOX&&(x.DELAY_CREATE_CTX=!0,x.USE_LOADER_EVENT="canplay"),n.os===n.OS_ANDROID&&n.browserType===n.BROWSER_TYPE_UC&&(x.ONE_SOURCE=!0)})();try{x.WEB_AUDIO&&(x.context=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext),x.DELAY_CREATE_CTX&&setTimeout((function(){x.context=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext)}),0))}catch(R){x.WEB_AUDIO=!1,cc.logID(5201)}var w=[];(t=document.createElement("audio")).canPlayType&&(t.canPlayType('audio/ogg; codecs="vorbis"')&&w.push(".ogg"),t.canPlayType("audio/mpeg")&&w.push(".mp3"),t.canPlayType('audio/wav; codecs="1"')&&w.push(".wav"),t.canPlayType("audio/mp4")&&w.push(".mp4"),t.canPlayType("audio/x-m4a")&&w.push(".m4a")),x.format=w,n.__audioSupport=x}return n.NetworkType={NONE:0,LAN:1,WWAN:2},n.getNetworkType=function(){return n.NetworkType.LAN},n.getBatteryLevel=function(){return 1},n.garbageCollect=function(){},n.restartVM=function(){},n.isObjectValid=function(t){return!!t},n.dump=function(){var t="";t+="isMobile : "+this.isMobile+"\r\n",t+="language : "+this.language+"\r\n",t+="browserType : "+this.browserType+"\r\n",t+="browserVersion : "+this.browserVersion+"\r\n",t+="capabilities : "+JSON.stringify(this.capabilities)+"\r\n",t+="os : "+this.os+"\r\n",t+="osVersion : "+this.osVersion+"\r\n",t+="platform : "+this.platform+"\r\n",t+="Using "+(cc.game.renderType===cc.game.RENDER_TYPE_WEBGL?"WEBGL":"CANVAS")+" renderer.\r\n",cc.log(t)},n.openURL=function(t){window.open(t)},n.now=function(){return Date.now?Date.now():+new Date},n})();e.exports=n}),{}],203:[(function(t,e){"use strict";var i=t("../event/event-target"),n=t("../platform/js"),r=t("../renderer");t("../platform/CCClass");var a={init:function(){this.html=document.getElementsByTagName("html")[0]},availWidth:function(t){return t&&t!==this.html?t.clientWidth:window.innerWidth},availHeight:function(t){return t&&t!==this.html?t.clientHeight:window.innerHeight},meta:{width:"device-width"},adaptationType:cc.sys.browserType};switch(cc.sys.os===cc.sys.OS_IOS&&(a.adaptationType=cc.sys.BROWSER_TYPE_SAFARI),a.adaptationType){case cc.sys.BROWSER_TYPE_SAFARI:case cc.sys.BROWSER_TYPE_SOUGOU:case cc.sys.BROWSER_TYPE_UC:a.meta["minimal-ui"]="true",a.availWidth=function(t){return t.clientWidth},a.availHeight=function(t){return t.clientHeight}}var s=null,o=function(){i.call(this);var t=this,e=cc.ContainerStrategy,n=cc.ContentStrategy;a.init(this),t._frameSize=cc.size(0,0),t._designResolutionSize=cc.size(0,0),t._originalDesignResolutionSize=cc.size(0,0),t._scaleX=1,t._scaleY=1,t._viewportRect=cc.rect(0,0,0,0),t._visibleRect=cc.rect(0,0,0,0),t._autoFullScreen=!1,t._devicePixelRatio=1,t._maxPixelRatio=2,t._retinaEnabled=!1,t._resizeCallback=null,t._resizing=!1,t._resizeWithBrowserSize=!1,t._orientationChanging=!0,t._isRotated=!1,t._orientation=cc.macro.ORIENTATION_AUTO,t._isAdjustViewport=!0,t._antiAliasEnabled=!1,t._resolutionPolicy=null,t._rpExactFit=new cc.ResolutionPolicy(e.EQUAL_TO_FRAME,n.EXACT_FIT),t._rpShowAll=new cc.ResolutionPolicy(e.EQUAL_TO_FRAME,n.SHOW_ALL),t._rpNoBorder=new cc.ResolutionPolicy(e.EQUAL_TO_FRAME,n.NO_BORDER),t._rpFixedHeight=new cc.ResolutionPolicy(e.EQUAL_TO_FRAME,n.FIXED_HEIGHT),t._rpFixedWidth=new cc.ResolutionPolicy(e.EQUAL_TO_FRAME,n.FIXED_WIDTH),cc.game.once(cc.game.EVENT_ENGINE_INITED,this.init,this)};cc.js.extend(o,i),cc.js.mixin(o.prototype,{init:function(){this._initFrameSize();var t=cc.game.canvas.width,e=cc.game.canvas.height;this._designResolutionSize.width=t,this._designResolutionSize.height=e,this._originalDesignResolutionSize.width=t,this._originalDesignResolutionSize.height=e,this._viewportRect.width=t,this._viewportRect.height=e,this._visibleRect.width=t,this._visibleRect.height=e,cc.winSize.width=this._visibleRect.width,cc.winSize.height=this._visibleRect.height,cc.visibleRect&&cc.visibleRect.init(this._visibleRect)},_resizeEvent:function(t){var e;e=this.setDesignResolutionSize?this:cc.view;var i=cc.sys;if(i.browserType!==i.BROWSER_TYPE_UC||i.os!==i.OS_IOS){var n=e._frameSize.width,r=e._frameSize.height,a=e._isRotated;if(cc.sys.isMobile){var s=cc.game.container.style,o=s.margin;s.margin="0",s.display="none",e._initFrameSize(),s.margin=o,s.display="block"}else e._initFrameSize();if(!0===t||e._isRotated!==a||e._frameSize.width!==n||e._frameSize.height!==r){var c=e._originalDesignResolutionSize.width,l=e._originalDesignResolutionSize.height;e._resizing=!0,c>0&&e.setDesignResolutionSize(c,l,e._resolutionPolicy),e._resizing=!1,e.emit("canvas-resize"),e._resizeCallback&&e._resizeCallback.call()}}else setTimeout((function(){e._resizeEvent(t)}),0)},_orientationChange:function(){cc.view._orientationChanging=!0,cc.view._resizeEvent(),cc.sys.browserType===cc.sys.BROWSER_TYPE_SAFARI&&cc.sys.isMobile&&setTimeout((function(){window.innerHeight>window.innerWidth&&window.scrollTo(0,1)}),500)},_resize:function(){cc.view._resizeEvent(!1)},resizeWithBrowserSize:function(t){t?this._resizeWithBrowserSize||(this._resizeWithBrowserSize=!0,window.addEventListener("resize",this._resize),window.addEventListener("orientationchange",this._orientationChange)):this._resizeWithBrowserSize&&(this._resizeWithBrowserSize=!1,window.removeEventListener("resize",this._resize),window.removeEventListener("orientationchange",this._orientationChange))},setResizeCallback:function(t){"function"!=typeof t&&null!=t||(this._resizeCallback=t)},setOrientation:function(t){if((t&=cc.macro.ORIENTATION_AUTO)&&this._orientation!==t){this._orientation=t;var e=this._originalDesignResolutionSize.width,i=this._originalDesignResolutionSize.height;this.setDesignResolutionSize(e,i,this._resolutionPolicy)}},_initFrameSize:function(){var t=this._frameSize,e=a.availWidth(cc.game.frame),i=a.availHeight(cc.game.frame),n=e>=i;!cc.sys.isMobile||n&&this._orientation&cc.macro.ORIENTATION_LANDSCAPE||!n&&this._orientation&cc.macro.ORIENTATION_PORTRAIT?(t.width=e,t.height=i,cc.game.container.style["-webkit-transform"]="rotate(0deg)",cc.game.container.style.transform="rotate(0deg)",this._isRotated=!1):(t.width=i,t.height=e,cc.game.container.style["-webkit-transform"]="rotate(90deg)",cc.game.container.style.transform="rotate(90deg)",cc.game.container.style["-webkit-transform-origin"]="0px 0px 0px",cc.game.container.style.transformOrigin="0px 0px 0px",this._isRotated=!0),this._orientationChanging&&setTimeout((function(){cc.view._orientationChanging=!1}),1e3)},_setViewportMeta:function(t,e){var i=document.getElementById("cocosMetaElement");i&&e&&document.head.removeChild(i);var n,r,a,s=document.getElementsByName("viewport"),o=s?s[0]:null;for(r in n=o?o.content:"",(i=i||document.createElement("meta")).id="cocosMetaElement",i.name="viewport",i.content="",t)-1==n.indexOf(r)?n+=","+r+"="+t[r]:e&&(a=new RegExp(r+"s*=s*[^,]+"),n=n.replace(a,r+"="+t[r]));/^,/.test(n)&&(n=n.substr(1)),i.content=n,o&&(o.content=n),document.head.appendChild(i)},_adjustViewportMeta:function(){this._isAdjustViewport&&(this._setViewportMeta(a.meta,!1),this._isAdjustViewport=!1)},adjustViewportMeta:function(t){this._isAdjustViewport=t},enableRetina:function(t){this._retinaEnabled=!!t},isRetinaEnabled:function(){return this._retinaEnabled},enableAntiAlias:function(t){if(cc.warnID(9200),this._antiAliasEnabled!==t)if(this._antiAliasEnabled=t,cc.game.renderType===cc.game.RENDER_TYPE_WEBGL)cc.assetManager.assets.forEach((function(e){if(e instanceof cc.Texture2D){var i=cc.Texture2D.Filter;t?e.setFilters(i.LINEAR,i.LINEAR):e.setFilters(i.NEAREST,i.NEAREST)}}));else if(cc.game.renderType===cc.game.RENDER_TYPE_CANVAS){var e=cc.game.canvas.getContext("2d");e.imageSmoothingEnabled=t,e.mozImageSmoothingEnabled=t}},isAntiAliasEnabled:function(){return this._antiAliasEnabled},enableAutoFullScreen:function(t){t&&t!==this._autoFullScreen&&cc.sys.isMobile?(this._autoFullScreen=!0,cc.screen.autoFullScreen(cc.game.frame)):(this._autoFullScreen=!1,cc.screen.disableAutoFullScreen(cc.game.frame))},isAutoFullScreenEnabled:function(){return this._autoFullScreen},setCanvasSize:function(t,e){var i=cc.game.canvas,n=cc.game.container;i.width=t*this._devicePixelRatio,i.height=e*this._devicePixelRatio,i.style.width=t+"px",i.style.height=e+"px",n.style.width=t+"px",n.style.height=e+"px",this._resizeEvent()},getCanvasSize:function(){return cc.size(cc.game.canvas.width,cc.game.canvas.height)},getFrameSize:function(){return cc.size(this._frameSize.width,this._frameSize.height)},setFrameSize:function(t,e){this._frameSize.width=t,this._frameSize.height=e,cc.game.frame.style.width=t+"px",cc.game.frame.style.height=e+"px",this._resizeEvent(!0)},getVisibleSize:function(){return cc.size(this._visibleRect.width,this._visibleRect.height)},getVisibleSizeInPixel:function(){return cc.size(this._visibleRect.width*this._scaleX,this._visibleRect.height*this._scaleY)},getVisibleOrigin:function(){return cc.v2(this._visibleRect.x,this._visibleRect.y)},getVisibleOriginInPixel:function(){return cc.v2(this._visibleRect.x*this._scaleX,this._visibleRect.y*this._scaleY)},getResolutionPolicy:function(){return this._resolutionPolicy},setResolutionPolicy:function(t){var e=this;if(t instanceof cc.ResolutionPolicy)e._resolutionPolicy=t;else{var i=cc.ResolutionPolicy;t===i.EXACT_FIT&&(e._resolutionPolicy=e._rpExactFit),t===i.SHOW_ALL&&(e._resolutionPolicy=e._rpShowAll),t===i.NO_BORDER&&(e._resolutionPolicy=e._rpNoBorder),t===i.FIXED_HEIGHT&&(e._resolutionPolicy=e._rpFixedHeight),t===i.FIXED_WIDTH&&(e._resolutionPolicy=e._rpFixedWidth)}},setDesignResolutionSize:function(t,e,i){if(t>0&&e>0){this.setResolutionPolicy(i);var n=this._resolutionPolicy;if(n&&n.preApply(this),cc.sys.isMobile&&this._adjustViewportMeta(),this._orientationChanging=!0,this._resizing||this._initFrameSize(),n){this._originalDesignResolutionSize.width=this._designResolutionSize.width=t,this._originalDesignResolutionSize.height=this._designResolutionSize.height=e;var a=n.apply(this,this._designResolutionSize);if(a.scale&&2===a.scale.length&&(this._scaleX=a.scale[0],this._scaleY=a.scale[1]),a.viewport){var s=this._viewportRect,o=this._visibleRect,c=a.viewport;s.x=c.x,s.y=c.y,s.width=c.width,s.height=c.height,o.x=0,o.y=0,o.width=c.width/this._scaleX,o.height=c.height/this._scaleY}n.postApply(this),cc.winSize.width=this._visibleRect.width,cc.winSize.height=this._visibleRect.height,cc.visibleRect&&cc.visibleRect.init(this._visibleRect),r.updateCameraViewport(),cc.internal.inputManager._updateCanvasBoundingRect(),this.emit("design-resolution-changed")}else cc.logID(2201)}else cc.errorID(2200)},getDesignResolutionSize:function(){return cc.size(this._designResolutionSize.width,this._designResolutionSize.height)},setRealPixelResolution:function(t,e,i){this._setViewportMeta({width:t},!0),document.documentElement.style.width=t+"px",document.body.style.width=t+"px",document.body.style.left="0px",document.body.style.top="0px",this.setDesignResolutionSize(t,e,i)},setViewportInPoints:function(t,e,i,n){var r=this._scaleX,a=this._scaleY;cc.game._renderContext.viewport(t*r+this._viewportRect.x,e*a+this._viewportRect.y,i*r,n*a)},setScissorInPoints:function(t,e,i,n){var r=this._scaleX,a=this._scaleY,o=Math.ceil(t*r+this._viewportRect.x),c=Math.ceil(e*a+this._viewportRect.y),l=Math.ceil(i*r),u=Math.ceil(n*a),h=cc.game._renderContext;if(!s){var f=h.getParameter(h.SCISSOR_BOX);s=cc.rect(f[0],f[1],f[2],f[3])}s.x===o&&s.y===c&&s.width===l&&s.height===u||(s.x=o,s.y=c,s.width=l,s.height=u,h.scissor(o,c,l,u))},isScissorEnabled:function(){return cc.game._renderContext.isEnabled(gl.SCISSOR_TEST)},getScissorRect:function(){if(!s){var t=gl.getParameter(gl.SCISSOR_BOX);s=cc.rect(t[0],t[1],t[2],t[3])}var e=1/this._scaleX,i=1/this._scaleY;return cc.rect((s.x-this._viewportRect.x)*e,(s.y-this._viewportRect.y)*i,s.width*e,s.height*i)},getViewportRect:function(){return this._viewportRect},getScaleX:function(){return this._scaleX},getScaleY:function(){return this._scaleY},getDevicePixelRatio:function(){return this._devicePixelRatio},convertToLocationInView:function(t,e,i,n){var r=n||cc.v2(),a=i.adjustedLeft?i.adjustedLeft:i.left,s=i.adjustedTop?i.adjustedTop:i.top,o=this._devicePixelRatio*(t-a),c=this._devicePixelRatio*(s+i.height-e);return this._isRotated?(r.x=cc.game.canvas.width-c,r.y=o):(r.x=o,r.y=c),r},_convertMouseToLocationInView:function(t,e){var i=this._viewportRect;t.x=(this._devicePixelRatio*(t.x-e.left)-i.x)/this._scaleX,t.y=(this._devicePixelRatio*(e.top+e.height-t.y)-i.y)/this._scaleY},_convertPointWithScale:function(t){var e=this._viewportRect;t.x=(t.x-e.x)/this._scaleX,t.y=(t.y-e.y)/this._scaleY},_convertTouchesWithScale:function(t){for(var e,i,n,r=this._viewportRect,a=this._scaleX,s=this._scaleY,o=0;o<t.length;o++)i=(e=t[o])._point,n=e._prevPoint,i.x=(i.x-r.x)/a,i.y=(i.y-r.y)/s,n.x=(n.x-r.x)/a,n.y=(n.y-r.y)/s}}),cc.ContainerStrategy=cc.Class({name:"ContainerStrategy",preApply:function(){},apply:function(){},postApply:function(){},_setupContainer:function(t,e,i){var n=cc.game.canvas;this._setupStyle(t,e,i);var r=t._devicePixelRatio=1;t.isRetinaEnabled()&&(r=t._devicePixelRatio=Math.min(t._maxPixelRatio,window.devicePixelRatio||1)),n.width=e*r,n.height=i*r},_setupStyle:function(t,e,i){var n=cc.game.canvas,r=cc.game.container;cc.sys.os===cc.sys.OS_ANDROID&&(document.body.style.width=(t._isRotated?i:e)+"px",document.body.style.height=(t._isRotated?e:i)+"px"),r.style.width=n.style.width=e+"px",r.style.height=n.style.height=i+"px"},_fixContainer:function(){document.body.insertBefore(cc.game.container,document.body.firstChild);var t=document.body.style;t.width=window.innerWidth+"px",t.height=window.innerHeight+"px",t.overflow="hidden";var e=cc.game.container.style;e.position="fixed",e.left=e.top="0px",document.body.scrollTop=0}}),cc.ContentStrategy=cc.Class({name:"ContentStrategy",ctor:function(){this._result={scale:[1,1],viewport:null}},_buildResult:function(t,e,i,n,r,a){Math.abs(t-i)<2&&(i=t),Math.abs(e-n)<2&&(n=e);var s=cc.rect((t-i)/2,(e-n)/2,i,n);return cc.game.renderType,cc.game.RENDER_TYPE_CANVAS,this._result.scale=[r,a],this._result.viewport=s,this._result},preApply:function(){},apply:function(){return{scale:[1,1]}},postApply:function(){}}),(function(){var t=cc.Class({name:"EqualToFrame",extends:cc.ContainerStrategy,apply:function(t){var e=t._frameSize.height,i=cc.game.container.style;this._setupContainer(t,t._frameSize.width,t._frameSize.height),t._isRotated?i.margin="0 0 0 "+e+"px":i.margin="0px",i.padding="0px"}}),e=cc.Class({name:"ProportionalToFrame",extends:cc.ContainerStrategy,apply:function(t,e){var i,n,r=t._frameSize.width,a=t._frameSize.height,s=cc.game.container.style,o=e.width,c=e.height,l=r/o,u=a/c;l<u?(i=r,n=c*l):(i=o*u,n=a);var h=Math.round((r-i)/2),f=Math.round((a-n)/2);i=r-2*h,n=a-2*f,this._setupContainer(t,i,n),t._isRotated?s.margin="0 0 0 "+a+"px":s.margin="0px",s.paddingLeft=h+"px",s.paddingRight=h+"px",s.paddingTop=f+"px",s.paddingBottom=f+"px"}}),i=(cc.Class({name:"EqualToWindow",extends:t,preApply:function(t){this._super(t),cc.game.frame=document.documentElement},apply:function(t){this._super(t),this._fixContainer()}}),cc.Class({name:"ProportionalToWindow",extends:e,preApply:function(t){this._super(t),cc.game.frame=document.documentElement},apply:function(t,e){this._super(t,e),this._fixContainer()}}),cc.Class({name:"OriginalContainer",extends:cc.ContainerStrategy,apply:function(t){this._setupContainer(t,cc.game.canvas.width,cc.game.canvas.height)}})),n=("undefined"==typeof window?global:window).__globalAdapter;n&&(n.adaptContainerStrategy&&n.adaptContainerStrategy(cc.ContainerStrategy.prototype),n.adaptView&&n.adaptView(o.prototype)),cc.ContainerStrategy.EQUAL_TO_FRAME=new t,cc.ContainerStrategy.PROPORTION_TO_FRAME=new e,cc.ContainerStrategy.ORIGINAL_CONTAINER=new i;var r=cc.Class({name:"ExactFit",extends:cc.ContentStrategy,apply:function(t,e){var i=cc.game.canvas.width,n=cc.game.canvas.height,r=i/e.width,a=n/e.height;return this._buildResult(i,n,i,n,r,a)}}),a=cc.Class({name:"ShowAll",extends:cc.ContentStrategy,apply:function(t,e){var i,n,r=cc.game.canvas.width,a=cc.game.canvas.height,s=e.width,o=e.height,c=r/s,l=a/o,u=0;return c<l?(i=r,n=o*(u=c)):(i=s*(u=l),n=a),this._buildResult(r,a,i,n,u,u)}}),s=cc.Class({name:"NoBorder",extends:cc.ContentStrategy,apply:function(t,e){var i,n,r,a=cc.game.canvas.width,s=cc.game.canvas.height,o=e.width,c=e.height,l=a/o,u=s/c;return l<u?(n=o*(i=u),r=s):(n=a,r=c*(i=l)),this._buildResult(a,s,n,r,i,i)}}),c=cc.Class({name:"FixedHeight",extends:cc.ContentStrategy,apply:function(t,e){var i=cc.game.canvas.width,n=cc.game.canvas.height,r=n/e.height,a=i,s=n;return this._buildResult(i,n,a,s,r,r)}}),l=cc.Class({name:"FixedWidth",extends:cc.ContentStrategy,apply:function(t,e){var i=cc.game.canvas.width,n=cc.game.canvas.height,r=i/e.width,a=i,s=n;return this._buildResult(i,n,a,s,r,r)}});cc.ContentStrategy.EXACT_FIT=new r,cc.ContentStrategy.SHOW_ALL=new a,cc.ContentStrategy.NO_BORDER=new s,cc.ContentStrategy.FIXED_HEIGHT=new c,cc.ContentStrategy.FIXED_WIDTH=new l})(),cc.ResolutionPolicy=cc.Class({name:"cc.ResolutionPolicy",ctor:function(t,e){this._containerStrategy=null,this._contentStrategy=null,this.setContainerStrategy(t),this.setContentStrategy(e)},preApply:function(t){this._containerStrategy.preApply(t),this._contentStrategy.preApply(t)},apply:function(t,e){return this._containerStrategy.apply(t,e),this._contentStrategy.apply(t,e)},postApply:function(t){this._containerStrategy.postApply(t),this._contentStrategy.postApply(t)},setContainerStrategy:function(t){t instanceof cc.ContainerStrategy&&(this._containerStrategy=t)},setContentStrategy:function(t){t instanceof cc.ContentStrategy&&(this._contentStrategy=t)}}),n.get(cc.ResolutionPolicy.prototype,"canvasSize",(function(){return cc.v2(cc.game.canvas.width,cc.game.canvas.height)})),cc.ResolutionPolicy.EXACT_FIT=0,cc.ResolutionPolicy.NO_BORDER=1,cc.ResolutionPolicy.SHOW_ALL=2,cc.ResolutionPolicy.FIXED_HEIGHT=3,cc.ResolutionPolicy.FIXED_WIDTH=4,cc.ResolutionPolicy.UNKNOWN=5,cc.view=new o,cc.winSize=cc.size(),e.exports=cc.view}),{"../event/event-target":166,"../platform/CCClass":193,"../platform/js":214,"../renderer":225}],204:[(function(){"use strict";cc.visibleRect={topLeft:cc.v2(0,0),topRight:cc.v2(0,0),top:cc.v2(0,0),bottomLeft:cc.v2(0,0),bottomRight:cc.v2(0,0),bottom:cc.v2(0,0),center:cc.v2(0,0),left:cc.v2(0,0),right:cc.v2(0,0),width:0,height:0,init:function(t){var e=this.width=t.width,i=this.height=t.height,n=t.x,r=t.y,a=r+i,s=n+e;this.topLeft.x=n,this.topLeft.y=a,this.topRight.x=s,this.topRight.y=a,this.top.x=n+e/2,this.top.y=a,this.bottomLeft.x=n,this.bottomLeft.y=r,this.bottomRight.x=s,this.bottomRight.y=r,this.bottom.x=n+e/2,this.bottom.y=r,this.center.x=n+e/2,this.center.y=r+i/2,this.left.x=n,this.left.y=r+i/2,this.right.x=s,this.right.y=r+i/2}}}),{}],205:[(function(t,e){"use strict";var i=t("./js"),n=(t("./utils").isPlainEmptyObj_DEV,"$_$");function r(t,e){var n=e?Object.create(e):{};return i.value(t,"__attrs__",n),n}function a(t){if("function"!=typeof t)return r(t,s(t.constructor));for(var e,i=cc.Class.getInheritanceChain(t),n=i.length-1;n>=0;n--){var a=i[n];a.hasOwnProperty("__attrs__")&&a.__attrs__||r(a,(e=i[n+1])&&e.__attrs__)}return r(t,(e=i[0])&&e.__attrs__),t.__attrs__}function s(t){return t.hasOwnProperty("__attrs__")&&t.__attrs__||a(t)}function o(t,e){this.name=t,this.default=e}o.prototype.toString=function(){return this.name},cc.Integer=new o("Integer",0),cc.Float=new o("Float",0),cc.Boolean=new o("Boolean",!1),cc.String=new o("String",""),e.exports={PrimitiveType:o,attr:function(t,e){var i=s(t),r=e+n,a={};for(var o in i)o.startsWith(r)&&(a[o.slice(r.length)]=i[o]);return a},getClassAttrs:s,setClassAttr:function(t,e,i,r){s(t)[e+n+i]=r},DELIMETER:n,getTypeChecker_ET:!1,getObjTypeChecker_ET:!1,ScriptUuid:{}}}),{"./CCClass":193,"./js":214,"./utils":217}],206:[(function(t,e){"use strict";var i=t("./js"),n=i.array.fastRemoveAt;function r(){}function a(){this.callback=r,this.target=void 0,this.once=!1}a.prototype.set=function(t,e,i){this.callback=t,this.target=e,this.once=!!i};var s=new i.Pool(function(t){return t.callback=r,t.target=void 0,t.once=!1,!0},32);function o(){this.callbackInfos=[],this.isInvoking=!1,this.containCanceled=!1}s.get=function(){return this._get()||new a};var c=o.prototype;c.removeByCallback=function(t){for(var e=0;e<this.callbackInfos.length;++e){var i=this.callbackInfos[e];i&&i.callback===t&&(s.put(i),n(this.callbackInfos,e),--e)}},c.removeByTarget=function(t){for(var e=0;e<this.callbackInfos.length;++e){var i=this.callbackInfos[e];i&&i.target===t&&(s.put(i),n(this.callbackInfos,e),--e)}},c.cancel=function(t){var e=this.callbackInfos[t];e&&(s.put(e),this.callbackInfos[t]=null),this.containCanceled=!0},c.cancelAll=function(){for(var t=0;t<this.callbackInfos.length;t++){var e=this.callbackInfos[t];e&&(s.put(e),this.callbackInfos[t]=null)}this.containCanceled=!0},c.purgeCanceled=function(){for(var t=this.callbackInfos.length-1;t>=0;--t)this.callbackInfos[t]||n(this.callbackInfos,t);this.containCanceled=!1},c.clear=function(){this.cancelAll(),this.callbackInfos.length=0,this.isInvoking=!1,this.containCanceled=!1};var l=new i.Pool(function(t){return t.callbackInfos=[],t.isInvoking=!1,t.containCanceled=!1,!0},16);function u(){this._callbackTable=i.createMap(!0)}l.get=function(){return this._get()||new o},(c=u.prototype).on=function(t,e,i,n){var r=this._callbackTable[t];r||(r=this._callbackTable[t]=l.get());var a=s.get();a.set(e,i,n),r.callbackInfos.push(a)},c.hasEventListener=function(t,e,i){var n=this._callbackTable[t];if(!n)return!1;var r=n.callbackInfos;if(!e){if(n.isInvoking){for(var a=0;a<r.length;++a)if(r[a])return!0;return!1}return r.length>0}for(var s=0;s<r.length;++s){var o=r[s];if(o&&o.callback===e&&o.target===i)return!0}return!1},c.removeAll=function(t){if("string"==typeof t){var e=this._callbackTable[t];e&&(e.isInvoking?e.cancelAll():(e.clear(),l.put(e),delete this._callbackTable[t]))}else if(t)for(var i in this._callbackTable){var n=this._callbackTable[i];if(n.isInvoking)for(var r=n.callbackInfos,a=0;a<r.length;++a){var s=r[a];s&&s.target===t&&n.cancel(a)}else n.removeByTarget(t)}},c.off=function(t,e,i){var r=this._callbackTable[t];if(r)for(var a=r.callbackInfos,o=0;o<a.length;++o){var c=a[o];if(c&&c.callback===e&&c.target===i){r.isInvoking?r.cancel(o):(n(a,o),s.put(c));break}}},c.emit=function(t,e,i,n,r,a){var s=this._callbackTable[t];if(s){var o=!s.isInvoking;s.isInvoking=!0;for(var c=s.callbackInfos,l=0,u=c.length;l<u;++l){var h=c[l];if(h){var f=h.target,d=h.callback;h.once&&this.off(t,d,f),f?d.call(f,e,i,n,r,a):d(e,i,n,r,a)}}o&&(s.isInvoking=!1,s.containCanceled&&s.purgeCanceled())}},e.exports=u}),{"./js":214}],207:[(function(t,e){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];Array.isArray(r)?i(t,r):t.push(r)}}e.exports={flattenCodeArray:function(t){var e=[];return i(e,t),e.join("")}}}),{}],208:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=L,i.unpackJSONs=function(t,e){if(t[0]<1)throw new Error(cc.debug.getError(5304,t[0]));O(t,!0,e),D(t);for(var i=new N(t[0]),n=t[1],r=t[2],a=t[3],s=t[4],o=t[g],c=0;c<o.length;++c)o[c].unshift(i,n,r,a,s);return o},i.packCustomObjData=function(t,e){return[1,d,d,[t],d,[e],[0],d,[],[],[]]},i.hasNativeDep=function(t){var e=t[5],i=e[e.length-1];return"number"==typeof i&&i<0},i.getDependUuidList=function(t){var e=t[1];return t[10].map((function(t){return e[t]}))};var n=f(t("./js")),r=f(t("../value-types/vec2")),a=f(t("../value-types/vec3")),s=f(t("../value-types/vec4")),o=f(t("../value-types/color")),c=f(t("../value-types/size")),l=f(t("../value-types/rect")),u=f(t("../value-types/quat")),h=f(t("../value-types/mat4"));function f(t){return t&&t.__esModule?t:{default:t}}var d=0,_=[r.default,a.default,s.default,u.default,o.default,c.default,l.default,h.default];function p(t,e){t.x=e[1],t.y=e[2],t.z=e[3],t.w=e[4]}var m=[function(t,e){t.x=e[1],t.y=e[2]},function(t,e){t.x=e[1],t.y=e[2],t.z=e[3]},p,p,function(t,e){t._val=e[1]},function(t,e){t.width=e[1],t.height=e[2]},function(t,e){t.x=e[1],t.y=e[2],t.width=e[3],t.height=e[4]},function(t,e){h.default.fromArray(t,e,1)}],v=0,g=5,y=(function(){function t(){this.uuidObjList=null,this.uuidPropList=null,this.uuidList=null}var e=t.prototype;return e.init=function(t){this.uuidObjList=t[8],this.uuidPropList=t[9],this.uuidList=t[10]},e.reset=function(){this.uuidList=null,this.uuidObjList=null,this.uuidPropList=null},e.push=function(t,e,i){this.uuidObjList.push(t),this.uuidPropList.push(e),this.uuidList.push(i)},t})();function T(t,e,i){for(var n=t.length-1,r=0,a=3*t[n];r<a;r+=3){var s=t[r],o=e[t[r+2]],c=t[r+1];c>=0?s[i[c]]=o:s[~c]=o}for(;r<n;r+=3){var l=e[t[r]],u=e[t[r+2]],h=t[r+1];h>=0?l[i[h]]=u:l[~h]=u}}function b(t,e){for(var i=t[4][e[0]],n=i[0],r=new(0,n[0]),a=n[1],s=n[2],o=i[i.length-1],c=1;c<o;++c)r[a[i[c]]]=e[c];for(;c<e.length;++c){var l=a[i[c]],u=n[i[c]+s];(0,w[u])(t,r,l,e[c])}return r}function E(t,e,i){var r=new e;return r._deserialize?r._deserialize(i,t[0]):cc.errorID(5303,n.default.getClassName(e)),r}function A(t,e,i,n){n>=0?e[i]=t[5][n]:t[7][3*~n]=e}function C(t){return function(e,i,n,r){i[n]=r;for(var a=0;a<r.length;++a)t(e,r,a,r[a])}}function x(t,e,i,n){e[i]=null,t[8][n]=e}function S(t,e,i,n){e[i]=b(t,n)}y.pool=new n.default.Pool(function(t){t.reset()},5),y.pool.get=function(){return this._get()||new y};var w=new Array(13);function M(t){var e=t[5],i=t[6],n=0===i?0:i.length,r=e[e.length-1],a=e.length-n;"number"!=typeof r?r=0:(r<0&&(r=~r),--a);for(var s=0;s<a;++s)e[s]=b(t,e[s]);for(var o=t[3],c=0;c<n;++c,++s){var l=i[c],u=e[s];if(l>=0){var h=o[l];e[s]=E(t,h,u)}else(0,w[l=~l])(t,e,s,u)}return r}function R(t,e){return t||L.reportMissingClass(e),Object}function I(t,e,i,n,r,a){var s=t(e);if(!s){if(r)return void(i[n]=(function(e,i,n){return function(){var r=t(n)||R(a,n);return e[i]=r,new r}})(i,n,e));s=R(a,e)}i[n]=s}function O(t,e,i){for(var r=i||n.default._getClassById,a=t[3],s=0;s<a.length;++s){var o=a[s];"string"!=typeof o?I(r,o[0],o,v,e,i):I(r,o,a,s,e,i)}}function D(t){var e=t[4];if(e)for(var i=t[3],n=0;n<e.length;++n){var r=e[n];r[0]=i[r[0]]}}function P(t){for(var e=t[5],i=t[2],n=t[1],r=t[8],a=t[9],s=t[10],o=0;o<r.length;++o){var c=r[o];"number"==typeof c&&(r[o]=e[c]);var l=a[o];"number"==typeof l&&(l=l>=0?i[l]:~l,a[o]=l);var u=s[o];"number"==typeof u&&(s[o]=n[u])}}function L(t,e,i){"string"==typeof t&&(t=JSON.parse(t));var n=!e;(e=e||y.pool.get()).init(t),i=i||{};var r=t[0],a=!1;if("object"==typeof r&&(a=r.preprocessed,r=r.version),r<1)throw new Error(cc.debug.getError(5304,r));i._version=r,i.result=e,t[0]=i,a||(O(t,!1,i.classFinder),D(t)),cc.game._isCloning=!0;var s=t[5],o=M(t);return cc.game._isCloning=!1,t[7]&&T(t[7],s,t[2]),P(t),n&&y.pool.put(e),s[o]}w[0]=function(t,e,i,n){e[i]=n},w[1]=A,w[2]=C(A),w[3]=C(x),w[4]=S,w[5]=function(t,e,i,n){m[n[0]](e[i],n)},w[6]=x,w[7]=function(t,e,i,n){e[i].set(n)},w[8]=function(t,e,i,n){var r=new _[n[0]];m[n[0]](r,n),e[i]=r},w[9]=C(S),w[10]=function(t,e,i,n){var r=t[3][n[0]];e[i]=E(t,r,n[1])},w[11]=function(t,e,i,n){var r=n[0];e[i]=r;for(var a=1;a<n.length;a+=3){var s=n[a],o=n[a+1],c=n[a+2];(0,w[o])(t,r,s,c)}},w[12]=function(t,e,i,n){var r=n[0];e[i]=r;for(var a=0;a<r.length;++a){var s=r[a],o=n[a+1];0!==o&&(0,w[o])(t,r,a,s)}},L.Details=y;var N=function(t){this.preprocessed=!0,this.version=t}}),{"../value-types/color":292,"../value-types/mat4":295,"../value-types/quat":296,"../value-types/rect":297,"../value-types/size":298,"../value-types/vec2":302,"../value-types/vec3":303,"../value-types/vec4":304,"./js":214}],209:[(function(t){"use strict";var e,i=(e=t("./deserialize-compiled"))&&e.__esModule?e:{default:e};i.default.reportMissingClass=function(t){cc.warnID(5302,t)},cc.deserialize=i.default}),{"./deserialize-compiled":208,"./deserialize-editor":void 0}],210:[(function(t,e){"use strict";var i=".";function n(t){this.id=0|998*Math.random(),this.prefix=t?t+i:""}n.prototype.getNewId=function(){return this.prefix+ ++this.id},n.global=new n("global"),e.exports=n}),{}],211:[(function(t){"use strict";t("./js"),t("./CCClass"),t("./CCClassDecorator"),t("./CCEnum"),t("./CCObject"),t("./callbacks-invoker"),t("./deserialize"),t("./instantiate"),t("./instantiate-jit"),t("./requiring-frame"),t("./CCSys"),t("./CCMacro"),t("./CCVisibleRect")}),{"./CCClass":193,"./CCClassDecorator":194,"./CCEnum":195,"./CCMacro":198,"./CCObject":199,"./CCSys":202,"./CCVisibleRect":204,"./callbacks-invoker":206,"./deserialize":209,"./instantiate":213,"./instantiate-jit":212,"./js":214,"./requiring-frame":216}],212:[(function(t,e){"use strict";var i=t("./CCObject"),n=i.Flags.Destroyed,r=i.Flags.PersistentMask,a=t("./attribute"),s=t("./js"),o=t("./CCClass"),c=t("./compiler"),l=a.DELIMETER+"default",u=o.IDENTIFIER_RE,h=o.escapeForJS,f="var ",d="o",_="t",p={"cc.Node":"cc.Node","cc.Sprite":"cc.Sprite","cc.Label":"cc.Label","cc.Button":"cc.Button","cc.Widget":"cc.Widget","cc.Animation":"cc.Animation","cc.ClickEvent":!1,"cc.PrefabInfo":!1};try{!Float32Array.name&&(Float32Array.name="Float32Array"),!Float64Array.name&&(Float64Array.name="Float64Array"),!Int8Array.name&&(Int8Array.name="Int8Array"),!Int16Array.name&&(Int16Array.name="Int16Array"),!Int32Array.name&&(Int32Array.name="Int32Array"),!Uint8Array.name&&(Uint8Array.name="Uint8Array"),!Uint16Array.name&&(Uint16Array.name="Uint16Array"),!Uint32Array.name&&(Uint32Array.name="Uint32Array"),!Uint8ClampedArray.name&&(Uint8ClampedArray.name="Uint8ClampedArray")}catch(x){}function m(t){if(t===Float32Array)return"Float32Array";if(t===Float64Array)return"Float64Array";if(t===Int8Array)return"Int8Array";if(t===Int16Array)return"Int16Array";if(t===Int32Array)return"Int32Array";if(t===Uint8Array)return"Uint8Array";if(t===Uint16Array)return"Uint16Array";if(t===Uint32Array)return"Uint32Array";if(t===Uint8ClampedArray)return"Uint8ClampedArray";throw new Error("Unknown TypedArray to instantiate: "+t)}function v(t,e){this.varName=t,this.expression=e}function g(t,e){return e instanceof v?new v(e.varName,t+e.expression):t+e}function y(t,e,i){Array.isArray(i)?(i[0]=g(e,i[0]),t.push(i)):t.push(g(e,i)+";")}function T(t){this._exps=[],this._targetExp=t}function b(t,e){if("function"==typeof t)try{t=t()}catch(x){return!1}if(t===e)return!0;if(t&&e&&"object"==typeof t&&"object"==typeof e&&t.constructor===e.constructor)if(t instanceof cc.ValueType){if(t.equals(e))return!0}else{if(Array.isArray(t))return 0===t.length&&0===e.length;if(t.constructor===Object)return s.isEmptyObject(t)&&s.isEmptyObject(e)}return!1}function E(t){return u.test(t)?"."+t:"["+h(t)+"]"}function A(t,e){var i;this.parent=e,this.objsToClear_iN$t=[],this.codeArray=[],this.objs=[],this.funcs=[],this.funcModuleCache=s.createMap(),s.mixin(this.funcModuleCache,p),this.globalVariables=[],this.globalVariableId=0,this.localVariableId=0,this.codeArray.push(f+d+","+_+";","if(R){",d+"=R;","}else{",d+"=R=new "+this.getFuncModule(t.constructor,!0)+"();","}"),s.value(t,"_iN$t",{globalVar:"R"},!0),this.objsToClear_iN$t.push(t),this.enumerateObject(this.codeArray,t),this.globalVariables.length>0&&(i=f+this.globalVariables.join(",")+";");var n=c.flattenCodeArray(["return (function(R){",i||[],this.codeArray,"return o;","})"]);this.result=Function("O","F",n)(this.objs,this.funcs);for(var r=0,a=this.objsToClear_iN$t.length;r<a;++r)this.objsToClear_iN$t[r]._iN$t=null;this.objsToClear_iN$t.length=0}v.prototype.toString=function(){return f+this.varName+"="+this.expression+";"},T.prototype.append=function(t,e){this._exps.push([t,e])},T.prototype.writeCode=function(t){var e;if(this._exps.length>1)t.push(_+"="+this._targetExp+";"),e=_;else{if(1!==this._exps.length)return;e=this._targetExp}for(var i=0;i<this._exps.length;i++){var n=this._exps[i];y(t,e+E(n[0])+"=",n[1])}},T.pool=new s.Pool(function(t){t._exps.length=0,t._targetExp=null},1),T.pool.get=function(t){var e=this._get()||new T;return e._targetExp=t,e};var C=A.prototype;C.getFuncModule=function(t,e){var i=s.getClassName(t);if(i){var n=this.funcModuleCache[i];if(n)return n;if(void 0===n){var r=-1!==i.indexOf(".");if(r)try{if(r=t===Function("return "+i)())return this.funcModuleCache[i]=i,i}catch(x){}}}var a=this.funcs.indexOf(t);a<0&&(a=this.funcs.length,this.funcs.push(t));var o="F["+a+"]";return e&&(o="("+o+")"),this.funcModuleCache[i]=o,o},C.getObjRef=function(t){var e=this.objs.indexOf(t);return e<0&&(e=this.objs.length,this.objs.push(t)),"O["+e+"]"},C.setValueType=function(t,e,i,n){var r=T.pool.get(n),a=e.constructor.__props__;a||(a=Object.keys(e));for(var s=0;s<a.length;s++){var o=a[s],c=i[o];if(e[o]!==c){var l=this.enumerateField(i,o,c);r.append(o,l)}}r.writeCode(t),T.pool.put(r)},C.enumerateCCClass=function(t,e,i){for(var n=i.__values__,r=a.getClassAttrs(i),s=0;s<n.length;s++){var c=n[s],u=e[c],h=r[c+l];if(!b(h,u))if("object"==typeof u&&u instanceof cc.ValueType&&(h=o.getDefault(h))&&h.constructor===u.constructor){var f=d+E(c);this.setValueType(t,h,u,f)}else this.setObjProp(t,e,c,u)}},C.instantiateArray=function(t){if(0===t.length)return"[]";var e="a"+ ++this.localVariableId,i=[new v(e,"new Array("+t.length+")")];s.value(t,"_iN$t",{globalVar:"",source:i},!0),this.objsToClear_iN$t.push(t);for(var n=0;n<t.length;++n)y(i,e+"["+n+"]=",this.enumerateField(t,n,t[n]));return i},C.instantiateTypedArray=function(t){var e=t.constructor.name||m(t.constructor);if(0===t.length)return"new "+e;var i="a"+ ++this.localVariableId,n=[new v(i,"new "+e+"("+t.length+")")];t._iN$t={globalVar:"",source:n},this.objsToClear_iN$t.push(t);for(var r=0;r<t.length;++r)0!==t[r]&&y(n,i+"["+r+"]=",t[r]);return n},C.enumerateField=function(t,e,n){if("object"==typeof n&&n){var a=n._iN$t;if(a){var s=a.globalVar;if(!s){s=a.globalVar="v"+ ++this.globalVariableId,this.globalVariables.push(s);var o=a.source[0];a.source[0]=g(s+"=",o)}return s}return ArrayBuffer.isView(n)?this.instantiateTypedArray(n):Array.isArray(n)?this.instantiateArray(n):this.instantiateObj(n)}return"function"==typeof n?this.getFuncModule(n):"string"==typeof n?h(n):("_objFlags"===e&&t instanceof i&&(n&=r),n)},C.setObjProp=function(t,e,i,n){y(t,d+E(i)+"=",this.enumerateField(e,i,n))},C.enumerateObject=function(t,e){var i=e.constructor;if(cc.Class._isCCClass(i))this.enumerateCCClass(t,e,i);else for(var n in e)if(e.hasOwnProperty(n)&&(95!==n.charCodeAt(0)||95!==n.charCodeAt(1)||"__type__"===n)){var r=e[n];"object"==typeof r&&r&&r===e._iN$t||this.setObjProp(t,e,n,r)}},C.instantiateObj=function(t){if(t instanceof cc.ValueType)return o.getNewValueTypeCode(t);if(t instanceof cc.Asset)return this.getObjRef(t);if(t._objFlags&n)return null;var e,i=t.constructor;if(cc.Class._isCCClass(i)){if(this.parent)if(this.parent instanceof cc.Component){if(t instanceof cc._BaseNode||t instanceof cc.Component)return this.getObjRef(t)}else if(this.parent instanceof cc._BaseNode)if(t instanceof cc._BaseNode){if(!t.isChildOf(this.parent))return this.getObjRef(t)}else if(t instanceof cc.Component&&!t.node.isChildOf(this.parent))return this.getObjRef(t);e=new v(d,"new "+this.getFuncModule(i,!0)+"()")}else if(i===Object)e=new v(d,"{}");else{if(i)return this.getObjRef(t);e=new v(d,"Object.create(null)")}var r=[e];return s.value(t,"_iN$t",{globalVar:"",source:r},!0),this.objsToClear_iN$t.push(t),this.enumerateObject(r,t),["(function(){",r,"return o;})();"]},e.exports={compile:function(t){return new A(t,t instanceof cc._BaseNode&&t).result},equalsToDefault:b}}),{"./CCClass":193,"./CCObject":199,"./attribute":205,"./compiler":207,"./js":214}],213:[(function(t,e){"use strict";var i=t("./CCObject"),n=t("../value-types/value-type"),r=i.Flags.Destroyed,a=i.Flags.PersistentMask,s=t("./utils").isDomNode,o=t("./js");function c(t,e){if(!e){if("object"!=typeof t||Array.isArray(t))return null;if(!t)return null;if(!cc.isValid(t))return null}var n;if(t instanceof i){if(t._instantiate)return cc.game._isCloning=!0,n=t._instantiate(null,!0),cc.game._isCloning=!1,n;if(t instanceof cc.Asset)return null}return cc.game._isCloning=!0,n=u(t),cc.game._isCloning=!1,n}var l=[];function u(t,e){if(Array.isArray(t))return null;if(s&&s(t))return null;var i;f(t,i=t._iN$t?t._iN$t:t.constructor?new(0,t.constructor):Object.create(null),e);for(var n=0,r=l.length;n<r;++n)l[n]._iN$t=null;return l.length=0,i}function h(t,e,i,r){for(var a=t.__values__,s=0;s<a.length;s++){var o=a[s],c=e[o];if("object"==typeof c&&c){var l=i[o];l instanceof n&&l.constructor===c.constructor?l.set(c):i[o]=c._iN$t||d(c,r)}else i[o]=c}}function f(t,e,n){o.value(t,"_iN$t",e,!0),l.push(t);var r=t.constructor;if(cc.Class._isCCClass(r))h(r,t,e,n);else for(var s in t)if(t.hasOwnProperty(s)&&(95!==s.charCodeAt(0)||95!==s.charCodeAt(1)||"__type__"===s)){var c=t[s];if("object"==typeof c&&c){if(c===e)continue;e[s]=c._iN$t||d(c,n)}else e[s]=c}t instanceof i&&(e._objFlags&=a)}function d(t,e){if(t instanceof n)return t.clone();if(t instanceof cc.Asset)return t;var i;if(ArrayBuffer.isView(t)){var a=t.length;i=new t.constructor(a),t._iN$t=i,l.push(t);for(var s=0;s<a;++s)i[s]=t[s];return i}if(Array.isArray(t)){var c=t.length;i=new Array(c),o.value(t,"_iN$t",i,!0),l.push(t);for(var u=0;u<c;++u){var h=t[u];i[u]="object"==typeof h&&h?h._iN$t||d(h,e):h}return i}if(t._objFlags&r)return null;var _=t.constructor;if(cc.Class._isCCClass(_)){if(e)if(e instanceof cc.Component){if(t instanceof cc._BaseNode||t instanceof cc.Component)return t}else if(e instanceof cc._BaseNode)if(t instanceof cc._BaseNode){if(!t.isChildOf(e))return t}else if(t instanceof cc.Component&&!t.node.isChildOf(e))return t;i=new _}else if(_===Object)i={};else{if(_)return t;i=Object.create(null)}return f(t,i,e),i}c._clone=u,cc.instantiate=c,e.exports=c}),{"../value-types/value-type":301,"./CCObject":199,"./js":214,"./utils":217}],214:[(function(t,e){"use strict";var i=new(t("./id-generater"))("TmpCId.");function n(t,e){for(;t;){var i=Object.getOwnPropertyDescriptor(t,e);if(i)return i;t=Object.getPrototypeOf(t)}return null}function r(t,e,i){var r=n(e,t);Object.defineProperty(i,t,r)}var a={isNumber:function(t){return"number"==typeof t||t instanceof Number},isString:function(t){return"string"==typeof t||t instanceof String},addon:function(t){t=t||{};for(var e=1,i=arguments.length;e<i;e++){var n=arguments[e];if(n){if("object"!=typeof n){cc.errorID(5402,n);continue}for(var a in n)a in t||r(a,n,t)}}return t},mixin:function(t){t=t||{};for(var e=1,i=arguments.length;e<i;e++){var n=arguments[e];if(n){if("object"!=typeof n){cc.errorID(5403,n);continue}for(var a in n)r(a,n,t)}}return t},extend:function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t.prototype=Object.create(e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),t},getSuper:function(t){var e=t.prototype,i=e&&Object.getPrototypeOf(e);return i&&i.constructor},isChildClassOf:function(t,e){if(t&&e){if("function"!=typeof t)return!1;if("function"!=typeof e)return!1;if(t===e)return!0;for(;;){if(!(t=a.getSuper(t)))return!1;if(t===e)return!0}}return!1},clear:function(t){for(var e=Object.keys(t),i=0;i<e.length;i++)delete t[e[i]]},isEmptyObject:function(t){for(var e in t)return!1;return!0},getPropertyDescriptor:n},s={value:void 0,enumerable:!1,writable:!1,configurable:!0};a.value=function(t,e,i,n,r){s.value=i,s.writable=n,s.enumerable=r,Object.defineProperty(t,e,s),s.value=void 0};var o={get:null,set:null,enumerable:!1};a.getset=function(t,e,i,n,r,a){"function"!=typeof n&&(r=n,n=void 0),o.get=i,o.set=n,o.enumerable=r,o.configurable=a,Object.defineProperty(t,e,o),o.get=null,o.set=null};var c={get:null,enumerable:!1,configurable:!1};a.get=function(t,e,i,n,r){c.get=i,c.enumerable=n,c.configurable=r,Object.defineProperty(t,e,c),c.get=null};var l={set:null,enumerable:!1,configurable:!1};a.set=function(t,e,i,n,r){l.set=i,l.enumerable=n,l.configurable=r,Object.defineProperty(t,e,l),l.set=null},a.getClassName=function(t){if("function"==typeof t){var e=t.prototype;if(e&&e.hasOwnProperty("__classname__")&&e.__classname__)return e.__classname__;var i="";if(t.name&&(i=t.name),t.toString){var n,r=t.toString();(n="["===r.charAt(0)?r.match(/\[\w+\s*(\w+)\]/):r.match(/function\s*(\w+)/))&&2===n.length&&(i=n[1])}return"Object"!==i?i:""}return t&&t.constructor?a.getClassName(t.constructor):""},(function(){var t={},e={};function n(t,e,i){return a.getset(a,e,(function(){return Object.assign({},i)}),(function(t){a.clear(i),Object.assign(i,t)})),function(e,n){if(n.prototype.hasOwnProperty(t)&&delete i[n.prototype[t]],a.value(n.prototype,t,e),e){var r=i[e];if(r&&r!==n){var s="A Class already exists with the same "+t+' : "'+e+'".';cc.error(s)}else i[e]=n}}}a._setClassId=n("__cid__","_registeredClassIds",t);var r=n("__classname__","_registeredClassNames",e);a.setClassName=function(t,e){if(r(t,e),!e.prototype.hasOwnProperty("__cid__")){var n=t||i.getNewId();n&&a._setClassId(n,e)}},a.unregisterClass=function(){for(var i=0;i<arguments.length;i++){var n=arguments[i].prototype,r=n.__cid__;r&&delete t[r];var a=n.__classname__;a&&delete e[a]}},a._getClassById=function(e){return t[e]},a.getClassByName=function(t){return e[t]},a._getClassId=function(t,e){if(e=void 0===e||e,"function"==typeof t&&t.prototype.hasOwnProperty("__cid__"))return t.prototype.__cid__;if(t&&t.constructor){var i=t.constructor.prototype;if(i&&i.hasOwnProperty("__cid__"))return t.__cid__}return""}})(),a.obsolete=function(t,e,i,n){var r=/([^.]+)$/,s=r.exec(e)[0],o=r.exec(i)[0];function c(){return this[o]}n?a.getset(t,s,c,(function(t){this[o]=t})):a.get(t,s,c)},a.obsoletes=function(t,e,i,n){for(var r in i){var s=i[r];a.obsolete(t,e+"."+r,s,n)}};var u=/(%d)|(%s)/,h=/%s/;function f(t,e){t.splice(e,1)}function d(t,e){var i=t.indexOf(e);return i>=0&&(f(t,i),!0)}function _(t,e){void 0===e&&(e=t,t=null),this.get=null,this.count=0,this._pool=new Array(e),this._cleanup=t}a.formatStr=function(){var t=arguments.length;if(0===t)return"";var e=arguments[0];if(1===t)return""+e;var i="string"==typeof e&&u.test(e);if(i)for(var n=1;n<t;++n){var r=arguments[n],a="number"==typeof r?u:h;if(a.test(e)){var s=""+r;e=e.replace(a,s)}else e+=" "+r}else for(var o=1;o<t;++o)e+=" "+arguments[o];return e},a.shiftArguments=function(){for(var t=arguments.length-1,e=new Array(t),i=0;i<t;++i)e[i]=arguments[i+1];return e},a.createMap=function(t){var e=Object.create(null);return t&&(e["."]=!0,e["/"]=!0,delete e["."],delete e["/"]),e},a.array={remove:d,fastRemove:function(t,e){var i=t.indexOf(e);i>=0&&(t[i]=t[t.length-1],--t.length)},removeAt:f,fastRemoveAt:function(t,e){var i=t.length;e<0||e>=i||(t[e]=t[i-1],t.length=i-1)},contains:function(t,e){return t.indexOf(e)>=0},verifyType:function(t,e){if(t&&t.length>0)for(var i=0;i<t.length;i++)if(!(t[i]instanceof e))return cc.logID(1300),!1;return!0},removeArray:function(t,e){for(var i=0,n=e.length;i<n;i++)d(t,e[i])},appendObjectsAt:function(t,e,i){return t.splice.apply(t,[i,0].concat(e)),t},copy:function(t){var e,i=t.length,n=new Array(i);for(e=0;e<i;e+=1)n[e]=t[e];return n},MutableForwardIterator:t("../utils/mutable-forward-iterator")},_.prototype._get=function(){if(this.count>0){--this.count;var t=this._pool[this.count];return this._pool[this.count]=null,t}return null},_.prototype.put=function(t){var e=this._pool;if(this.count<e.length){if(this._cleanup&&!1===this._cleanup(t))return;e[this.count]=t,++this.count}},_.prototype.resize=function(t){t>=0&&(this._pool.length=t,this.count>t&&(this.count=t))},a.Pool=_,cc.js=a,e.exports=a}),{"../utils/mutable-forward-iterator":279,"./id-generater":210}],215:[(function(t,e,i){"use strict";var n=t("./js"),r=t("./attribute"),a={default:{},serializable:{},editorOnly:{},formerlySerializedAs:{}};function s(t,e,i,n){if(!t.get&&!t.set&&t.hasOwnProperty("default")){var r="_N$"+e;t.get=function(){return this[r]},t.set=function(t){var e=this[r];this[r]=t,i.call(this,e)};var s={};for(var o in n[r]=s,a){var c=a[o];t.hasOwnProperty(o)&&(s[o]=t[o],c.canUsedInGet||delete t[o])}}}function o(t,e,i,n){if(Array.isArray(e)){if(!(e.length>0))return cc.errorID(5508,i,n);t.type=e=e[0]}"function"==typeof e&&(e===String?t.type=cc.String:e===Boolean?t.type=cc.Boolean:e===Number&&(t.type=cc.Float))}function c(t,e,i){var n=t?{_short:!0}:{_short:!0,default:e};return i&&(n.type=i),n}i.getFullFormOfProperty=function(t,e){return t&&t.constructor===Object?null:Array.isArray(t)&&t.length>0?c(e,[],t):"function"==typeof t?c(e,n.isChildClassOf(t,cc.ValueType)?new t:null,t):t instanceof r.PrimitiveType?c(e,t.default):c(e,t)},i.preprocessAttrs=function(t,e){for(var n in t){var r=t[n],a=i.getFullFormOfProperty(r,!1);if(a&&(r=t[n]=a),r){var c=r.notify;c&&s(r,n,c,t),"type"in r&&o(r,r.type,e,n)}}},i.validateMethodWithProps=function(t){return"function"==typeof t||null===t}}),{"./CCClass":193,"./attribute":205,"./js":214}],216:[(function(){"use strict";var t=[];cc._RF={push:function(e,i,n){void 0===n&&(n=i,i=""),t.push({uuid:i,script:n,module:e,exports:e.exports,beh:null})},pop:function(){var e=t.pop(),i=e.module,n=i.exports;if(n===e.exports){for(var r in n)return;i.exports=n=e.cls}},peek:function(){return t[t.length-1]}}}),{}],217:[(function(t,e){"use strict";t("./js"),e.exports={contains:function(t,e){if("function"==typeof t.contains)return t.contains(e);if("function"==typeof t.compareDocumentPosition)return!!(16&t.compareDocumentPosition(e));var i=e.parentNode;if(i)do{if(i===t)return!0;i=i.parentNode}while(null!==i);return!1},isDomNode:"object"==typeof window&&("function"==typeof Node?function(t){return t instanceof Node}:function(t){return t&&"object"==typeof t&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName}),callInNextTick:function(t,e,i){t&&setTimeout((function(){t(e,i)}),0)}}}),{"./js":214}],218:[(function(t){"use strict";t("./platform/js"),t("./value-types"),t("./utils"),t("./platform/CCInputManager"),t("./platform/CCInputExtension"),t("./event"),t("./platform/CCSys"),t("./platform/CCMacro"),t("./asset-manager"),t("./CCDirector"),t("./renderer"),t("./platform/CCView"),t("./platform/CCScreen"),t("./CCScheduler"),t("./event-manager")}),{"./CCDirector":58,"./CCScheduler":63,"./asset-manager":81,"./event":168,"./event-manager":164,"./platform/CCInputExtension":196,"./platform/CCInputManager":197,"./platform/CCMacro":198,"./platform/CCScreen":201,"./platform/CCSys":202,"./platform/CCView":203,"./platform/js":214,"./renderer":225,"./utils":277,"./value-types":293}],219:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=s(t("./assembler")),r=s(t("./utils/dynamic-atlas/manager")),a=s(t("./webgl/render-data"));function s(t){return t&&t.__esModule?t:{default:t}}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}t("../value-types");var l=(function(t){var e,i;function n(){var e;return(e=t.call(this)||this)._renderData=new a.default,e._renderData.init(c(e)),e.initData(),e.initLocal(),e}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var s,l,u=n.prototype;return u.initData=function(){this._renderData.createQuadData(0,this.verticesFloats,this.indicesCount)},u.initLocal=function(){this._local=[],this._local.length=4},u.updateColor=function(t,e){var i=this._renderData.uintVDatas[0];if(i){e=null!=e?e:t.node.color._val;for(var n=this.floatsPerVert,r=this.colorOffset,a=i.length;r<a;r+=n)i[r]=e}},u.getBuffer=function(){return cc.renderer._handle._meshBuffer},u.updateWorldVerts=function(t){var e=this._local,i=this._renderData.vDatas[0],n=t.node._worldMatrix.m,r=n[0],a=n[1],s=n[4],o=n[5],c=n[12],l=n[13],u=e[0],h=e[2],f=e[1],d=e[3],_=this.floatsPerVert,p=0;if(1===r&&0===a&&0===s&&1===o)i[p]=u+c,i[p+1]=f+l,i[p+=_]=h+c,i[p+1]=f+l,i[p+=_]=u+c,i[p+1]=d+l,i[p+=_]=h+c,i[p+1]=d+l;else{var m=r*u,v=r*h,g=a*u,y=a*h,T=s*f,b=s*d,E=o*f,A=o*d;i[p]=m+T+c,i[p+1]=g+E+l,i[p+=_]=v+T+c,i[p+1]=y+E+l,i[p+=_]=m+b+c,i[p+1]=g+A+l,i[p+=_]=v+b+c,i[p+1]=y+A+l}},u.fillBuffers=function(t,e){e.worldMatDirty&&this.updateWorldVerts(t);var i=this._renderData,n=i.vDatas[0],r=i.iDatas[0],a=this.getBuffer(e),s=a.request(this.verticesCount,this.indicesCount),o=s.byteOffset>>2,c=a._vData;n.length+o>c.length?c.set(n.subarray(0,c.length-o),o):c.set(n,o);for(var l=a._iData,u=s.indiceOffset,h=s.vertexOffset,f=0,d=r.length;f<d;f++)l[u++]=h+r[f]},u.packToDynamicAtlas=function(t,e){if(!e._original&&r.default&&e._texture.packable){var i=r.default.insertSpriteFrame(e);i&&e._setDynamicAtlasFrame(i)}var n=t._materials[0];n&&n.getProperty("texture")!==e._texture&&(t._vertsDirty=!0,t._updateMaterial())},s=n,(l=[{key:"verticesFloats",get:function(){return this.verticesCount*this.floatsPerVert}}])&&o(s.prototype,l),n})(n.default);i.default=l,cc.js.addon(l.prototype,{floatsPerVert:5,verticesCount:4,indicesCount:6,uvOffset:2,colorOffset:4}),cc.Assembler2D=l,e.exports=i.default}),{"../value-types":293,"./assembler":222,"./utils/dynamic-atlas/manager":228,"./webgl/render-data":265}],220:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;for(var n,r=t("./webgl/vertex-format"),a=(n=t("../value-types/vec3"))&&n.__esModule?n:{default:n},s=[],o=0;o<4;o++)s.push(cc.v3());var c={floatsPerVert:6,uvOffset:3,colorOffset:5,getBuffer:function(t){return t._meshBuffer3D},getVfmt:function(){return r.vfmt3D},updateWorldVerts:function(t){var e=t.node._worldMatrix,i=this._local,n=this._renderData.vDatas[0];a.default.set(s[0],i[0],i[1],0),a.default.set(s[1],i[2],i[1],0),a.default.set(s[2],i[0],i[3],0),a.default.set(s[3],i[2],i[3],0);for(var r=this.floatsPerVert,o=0;o<4;o++){var c=s[o];a.default.transformMat4(c,c,e);var l=r*o;n[l]=c.x,n[l+1]=c.y,n[l+2]=c.z}}};cc.Assembler3D=c;var l=c;i.default=l,e.exports=i.default}),{"../value-types/vec3":303,"./webgl/vertex-format":267}],221:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=(n=t("../utils/pool"))&&n.__esModule?n:{default:n},a=0;function s(t){return Object.getOwnPropertyDescriptor(t,"__assemblerId__")||(t.__assemblerId__=++a),t.__assemblerId__}var o=new(function(t){var e,i;function n(){for(var e,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this)._pool={},e}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var r=n.prototype;return r.put=function(t){if(t&&this.enabled){var e=s(t.constructor),i=this._pool;i[e]||(i[e]=[]),this.count>this.maxSize||(this._clean(t),i[e].push(t),this.count++)}},r.get=function(t){var e;if(this.enabled){var i=this._pool,n=s(t);e=i[n]&&i[n].pop()}return e?this.count--:e=new t,e},r.clear=function(){this._pool={},this.count=0},r._clean=function(t){t._renderComp=null},n}(r.default));r.default.register("assembler",o);var c=o;i.default=c,e.exports=i.default}),{"../utils/pool":280}],222:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=t("./webgl/vertex-format"),a=(n=t("./assembler-pool"))&&n.__esModule?n:{default:n},s=(function(){function t(){this._extendNative&&this._extendNative()}var e=t.prototype;return e.init=function(t){this._renderComp=t},e.updateRenderData=function(){},e.fillBuffers=function(){},e.getVfmt=function(){return r.vfmtPosUvColor},t})();i.default=s,s.register=function(t,e){t.__assembler__=e},s.init=function(t){for(var e=t.constructor,i=e.__assembler__;!i;){if(!(e=e.$super))return void cc.warn("Can not find assembler for render component : ["+cc.js.getClassName(t)+"]");i=e.__assembler__}if(i.getConstructor&&(i=i.getConstructor(t)),!t._assembler||t._assembler.constructor!==i){var n=a.default.get(i);n.init(t),t._assembler=n}},cc.Assembler=s,e.exports=i.default}),{"./assembler-pool":221,"./webgl/vertex-format":267}],223:[(function(t,e){"use strict";var i=function(t){var e;try{e=t.getContext("2d")}catch(i){return void console.error(i)}this._canvas=t,this._ctx=e,this._caps={},this._stats={drawcalls:0},this._vx=this._vy=this._vw=this._vh=0,this._sx=this._sy=this._sw=this._sh=0};i.prototype._restoreTexture=function(){},i.prototype.setViewport=function(t,e,i,n){this._vx===t&&this._vy===e&&this._vw===i&&this._vh===n||(this._vx=t,this._vy=e,this._vw=i,this._vh=n)},i.prototype.setScissor=function(t,e,i,n){this._sx===t&&this._sy===e&&this._sw===i&&this._sh===n||(this._sx=t,this._sy=e,this._sw=i,this._sh=n)},i.prototype.clear=function(t){var e=this._ctx;e.clearRect(this._vx,this._vy,this._vw,this._vh),!t||0===t[0]&&0===t[1]&&0===t[2]||(e.fillStyle="rgb("+t[0]+","+t[1]+","+t[2]+")",e.globalAlpha=t[3],e.fillRect(this._vx,this._vy,this._vw,this._vh))},i.prototype.resetDrawCalls=function(){this._stats.drawcalls=0},i.prototype.getDrawCalls=function(){return this._stats.drawcalls},e.exports=i}),{}],224:[(function(t,e){"use strict";var i=function(t,e){this._device=t,this._width=4,this._height=4,this._image=null,e&&(void 0!==e.width&&(this._width=e.width),void 0!==e.height&&(this._height=e.height),this.updateImage(e))};i.prototype.update=function(t){this.updateImage(t)},i.prototype.updateImage=function(t){if(t.images&&t.images[0]){var e=t.images[0];e&&e!==this._image&&(this._image=e)}},i.prototype.destroy=function(){this._image=null},e.exports=i}),{}],225:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=s(t("../../renderer/gfx")),r=s(t("../../renderer/core/input-assembler")),a=s(t("../../renderer/core/pass"));function s(t){return t&&t.__esModule?t:{default:t}}var o=cc.renderer={Texture2D:null,InputAssembler:r.default,Pass:a.default,renderEngine:null,canvas:null,device:null,scene:null,drawCalls:0,_handle:null,_cameraNode:null,_camera:null,_forward:null,_flow:null,initWebGL:function(e,i){t("./webgl/assemblers");var r=t("./webgl/model-batcher");this.Texture2D=n.default.Texture2D,this.canvas=e,this._flow=cc.RenderFlow;var a=t("../../renderer/scene/scene"),s=t("../../renderer/renderers/forward-renderer");this.device=new n.default.Device(e,i),this.scene=new a;var o,c=(o=this.device,{defaultTexture:new n.default.Texture2D(o,{images:[],width:128,height:128,wrapS:n.default.WRAP_REPEAT,wrapT:n.default.WRAP_REPEAT,format:n.default.TEXTURE_FMT_RGB8,genMipmaps:!1}),programTemplates:[],programChunks:{}});this._forward=new s(this.device,c),this._handle=new r(this.device,this.scene),this._flow.init(this._handle,this._forward)},initCanvas:function(e){var i=t("./canvas"),n=t("./canvas/Texture2D"),r=t("./canvas/Device");this.Device=r,this.Texture2D=n,this.canvas=e,this.device=new r(e),this._camera={a:1,b:0,c:0,d:1,tx:0,ty:0},this._handle=new i.RenderComponentHandle(this.device,this._camera),this._forward=new i.ForwardRenderer,this._flow=cc.RenderFlow,this._flow.init(this._handle,this._forward)},updateCameraViewport:function(){if(cc.director){var t=cc.director.getScene();t&&t.setScale(1,1,1)}if(cc.game.renderType===cc.game.RENDER_TYPE_CANVAS){var e=cc.view.getViewportRect();this.device.setViewport(e.x,e.y,e.width,e.height),this._camera.a=cc.view.getScaleX(),this._camera.d=cc.view.getScaleY(),this._camera.tx=e.x,this._camera.ty=e.y+e.height}},render:function(t,e){this.device.resetDrawCalls(),t&&(this._flow.render(t,e),this.drawCalls=this.device.getDrawCalls())},clear:function(){this._handle.reset(),this._forward.clear()}};i.default=o,e.exports=i.default}),{"../../renderer/core/input-assembler":316,"../../renderer/core/pass":317,"../../renderer/gfx":326,"../../renderer/renderers/forward-renderer":345,"../../renderer/scene/scene":349,"./canvas":void 0,"./canvas/Device":223,"./canvas/Texture2D":224,"./webgl/assemblers":237,"./webgl/model-batcher":263}],226:[(function(t,e){"use strict";var i,n,r=0,a=1<<r++,s=1<<r++,o=1<<r++,c=1<<r++,l=o|c,u=1<<r++,h=1<<r++,f=1<<r++,d=h|f,_=1<<r++,p=1<<r++,m=1<<r++,v=1<<r++,g=0;function y(){this._func=x,this._next=null}var T=y.prototype;T._doNothing=function(){},T._localTransform=function(t){t._updateLocalMatrix(),t._renderFlag&=~o,this._next._func(t)},T._worldTransform=function(t){i.worldMatDirty++;var e=t._matrix,n=t._trs,r=e.m;r[12]=n[0],r[13]=n[1],r[14]=n[2],t._mulMat(t._worldMatrix,t._parent._worldMatrix,e),t._renderFlag&=~c,this._next._func(t),i.worldMatDirty--},T._opacity=function(t){i.parentOpacityDirty++,this._next._func(t),t._renderFlag&=~h,i.parentOpacityDirty--},T._color=function(t){var e=t._renderComponent;e&&e._updateColor(),t._renderFlag&=~f,this._next._func(t)},T._updateRenderData=function(t){var e=t._renderComponent;e._assembler.updateRenderData(e),t._renderFlag&=~u,this._next._func(t)},T._render=function(t){var e=t._renderComponent;e._checkBacth(i,t._cullingMask),e._assembler.fillBuffers(e,i),this._next._func(t)},T._children=function(t){for(var e=g,n=i,r=n.parentOpacity,a=n.parentOpacity*=t._opacity/255,s=(n.worldMatDirty?c:0)|(n.parentOpacityDirty?d:0),o=t._children,l=0,u=o.length;l<u;l++){var h=o[l];if(h._renderFlag|=s,h._activeInHierarchy&&0!==h._opacity){g=h._cullingMask=0===h.groupIndex?e:1<<h.groupIndex;var f=h._color._val;h._color._fastSetA(h._opacity*a),E[h._renderFlag]._func(h),h._color._val=f}}n.parentOpacity=r,this._next._func(t)},T._postRender=function(t){var e=t._renderComponent;e._checkBacth(i,t._cullingMask),e._assembler.postFillBuffers(e,i),this._next._func(t)};var b=new y;b._func=b._doNothing,b._next=b;var E={};function A(t,e){var i=new y;switch(i._next=e||b,t){case a:case s:i._func=i._doNothing;break;case o:i._func=i._localTransform;break;case c:i._func=i._worldTransform;break;case h:i._func=i._opacity;break;case f:i._func=i._color;break;case u:i._func=i._updateRenderData;break;case _:i._func=i._render;break;case p:i._func=i._children;break;case m:i._func=i._postRender}return i}function C(t){for(var e=null,i=v;i>0;)i&t&&(e=A(i,e)),i>>=1;return e}function x(t){var e=t._renderFlag;(E[e]=C(e))._func(t)}y.flows=E,y.createFlow=A;var S=[];y.registerValidate=function(t){t._inValidateList||(S.push(t),t._inValidateList=!0)},y.validateRenderers=function(){for(var t=0,e=S.length;t<e;t++){var i=S[t];i.isValid&&(i.enabledInHierarchy?i._validateRender():i.disableRender(),i._inValidateList=!1)}S.length=0},y.visitRootNode=function(t){y.validateRenderers();var e=g;g=t._cullingMask,t._renderFlag&c?(i.worldMatDirty++,t._calculWorldMatrix(),t._renderFlag&=~c,E[t._renderFlag]._func(t),i.worldMatDirty--):E[t._renderFlag]._func(t),g=e},y.render=function(t,e){i.reset(),i.walking=!0,y.visitRootNode(t),i.terminate(),i.walking=!1,n.render(i._renderScene,e)},y.renderCamera=function(t,e){i.reset(),i.walking=!0,y.visitRootNode(e),i.terminate(),i.walking=!1,n.renderCamera(t,i._renderScene)},y.init=function(t,e){i=t,n=e,E[0]=b;for(var r=1;r<v;r++)E[r]=new y},y.getBachther=function(){return i},y.FLAG_DONOTHING=a,y.FLAG_BREAK_FLOW=s,y.FLAG_LOCAL_TRANSFORM=o,y.FLAG_WORLD_TRANSFORM=c,y.FLAG_TRANSFORM=l,y.FLAG_OPACITY=h,y.FLAG_COLOR=f,y.FLAG_OPACITY_COLOR=d,y.FLAG_UPDATE_RENDER_DATA=u,y.FLAG_RENDER=_,y.FLAG_CHILDREN=p,y.FLAG_POST_RENDER=m,y.FLAG_FINAL=v,e.exports=cc.RenderFlow=y}),{}],227:[(function(t,e){"use strict";var i=t("../../../assets/CCRenderTexture"),n=2;function r(t,e){var r=new i;r.initWithSize(t,e),r.update(),this._texture=r,this._x=n,this._y=n,this._nexty=n,this._width=t,this._height=e,this._innerTextureInfos={},this._innerSpriteFrames=[],this._count=0}r.DEFAULT_HASH=(new i)._getHash(),cc.js.mixin(r.prototype,{insertSpriteFrame:function(t){var e=t._rect,i=t._texture,r=this._innerTextureInfos[i._id],a=e.x,s=e.y;if(r)a+=r.x,s+=r.y;else{var o=i.width,c=i.height;if(this._x+o+n>this._width&&(this._x=n,this._y=this._nexty),this._y+c+n>this._nexty&&(this._nexty=this._y+c+n),this._nexty>this._height)return null;cc.dynamicAtlasManager.textureBleeding&&((o<=8||c<=8)&&(this._texture.drawTextureAt(i,this._x-1,this._y-1),this._texture.drawTextureAt(i,this._x-1,this._y+1),this._texture.drawTextureAt(i,this._x+1,this._y-1),this._texture.drawTextureAt(i,this._x+1,this._y+1)),this._texture.drawTextureAt(i,this._x-1,this._y),this._texture.drawTextureAt(i,this._x+1,this._y),this._texture.drawTextureAt(i,this._x,this._y-1),this._texture.drawTextureAt(i,this._x,this._y+1)),this._texture.drawTextureAt(i,this._x,this._y),this._innerTextureInfos[i._id]={x:this._x,y:this._y,texture:i},this._count++,a+=this._x,s+=this._y,this._x+=o+n,this._dirty=!0}var l={x:a,y:s,texture:this._texture};return this._innerSpriteFrames.push(t),l},update:function(){this._dirty&&(this._texture.update(),this._dirty=!1)},deleteInnerTexture:function(t){t&&this._innerTextureInfos[t._id]&&(delete this._innerTextureInfos[t._id],this._count--)},isEmpty:function(){return this._count<=0},reset:function(){this._x=n,this._y=n,this._nexty=n;for(var t=this._innerSpriteFrames,e=0,i=t.length;e<i;e++){var r=t[e];r.isValid&&r._resetDynamicAtlasFrame()}this._innerSpriteFrames.length=0,this._innerTextureInfos={}},destroy:function(){this.reset(),this._texture.destroy()}}),e.exports=r}),{"../../../assets/CCRenderTexture":101}],228:[(function(t,e){"use strict";var i=t("./atlas"),n=[],r=-1,a=5,s=2048,o=512,c=!0;function l(){var t=n[++r];return t||(t=new i(s,s),n.push(t)),t}function u(){f.reset()}var h=!1,f={Atlas:i,get enabled(){return h},set enabled(t){h!==t&&(t?(this.reset(),cc.director.on(cc.Director.EVENT_BEFORE_SCENE_LAUNCH,u)):cc.director.off(cc.Director.EVENT_BEFORE_SCENE_LAUNCH,u),h=t)},get maxAtlasCount(){return a},set maxAtlasCount(t){a=t},get textureBleeding(){return c},set textureBleeding(t){c=t},get textureSize(){return s},set textureSize(t){s=t},get maxFrameSize(){return o},set maxFrameSize(t){o=t},insertSpriteFrame:function(t){if(!h||r===a||!t||t._original)return null;if(!t._texture.packable)return null;var e=n[r];e||(e=l());var i=e.insertSpriteFrame(t);return i||r===a?i:(e=l()).insertSpriteFrame(t)},reset:function(){for(var t=0,e=n.length;t<e;t++)n[t].destroy();n.length=0,r=-1},deleteAtlasSpriteFrame:function(t){if(t._original){var e=t._original._texture;this.deleteAtlasTexture(e)}},deleteAtlasTexture:function(t){if(t)for(var e=n.length-1;e>=0;e--)n[e].deleteInnerTexture(t),n[e].isEmpty()&&(n[e].destroy(),n.splice(e,1),r--)},showDebug:!1,update:function(){if(this.enabled)for(var t=0;t<=r;t++)n[t].update()}};e.exports=cc.dynamicAtlasManager=f}),{"./atlas":227}],229:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=(n=t("../../assembler-2d"))&&n.__esModule?n:{default:n},a=t("../../../utils/text-utils"),s=t("../../../platform/CCMacro"),o=t("../../../components/CCLabel").Overflow,c=t("../utils").shareLabelInfo,l=function(){this.char="",this.valid=!0,this.x=0,this.y=0,this.line=0,this.hash=""},u=cc.rect(),h=null,f=[],d=[],_=[],p=[],m=null,v=0,g=0,y=0,T=0,b=0,E=1,A=null,C=cc.size(),x="",S=0,w=0,M=0,R=0,I=0,O=0,D=0,P=!1,L=0,N=0,F=0,B=(function(t){var e,i;function n(){return t.apply(this,arguments)||this}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var r=n.prototype;return r.updateRenderData=function(t){t._vertsDirty&&h!==t&&(h=t,this._reserveQuads(t,t.string.toString().length),this._updateFontFamily(t),this._updateProperties(t),this._updateLabelInfo(t),this._updateContent(),this.updateWorldVerts(t),h._actualFontSize=S,h.node.setContentSize(C),h._vertsDirty=!1,h=null,this._resetProperties())},r._updateFontScale=function(){E=S/w},r._updateFontFamily=function(t){var e=t.font;A=e.spriteFrame,m=e._fntConfig,c.fontAtlas=e._fontDefDictionary,this.packToDynamicAtlas(t,A)},r._updateLabelInfo=function(){c.hash="",c.margin=0},r._updateProperties=function(t){x=t.string.toString(),S=t.fontSize,w=m?m.fontSize:t.fontSize,M=t.horizontalAlign,R=t.verticalAlign,I=t.spacingX,D=t.overflow,O=t._lineHeight,C.width=t.node.width,C.height=t.node.height,D===o.NONE?(P=!1,C.width+=2*c.margin,C.height+=2*c.margin):D===o.RESIZE_HEIGHT?(P=!0,C.height+=2*c.margin):P=t.enableWrapText,c.lineHeight=O,c.fontSize=S,this._setupBMFontOverflowMetrics()},r._resetProperties=function(){m=null,A=null,c.hash="",c.margin=0},r._updateContent=function(){this._updateFontScale(),this._computeHorizontalKerningForText(),this._alignText()},r._computeHorizontalKerningForText=function(){var t,e=x,i=e.length,n=f;if(m&&(t=m.kerningDict),t&&!cc.js.isEmptyObject(t))for(var r=-1,a=0;a<i;++a){var s=e.charCodeAt(a),o=t[r<<16|65535&s]||0;n[a]=a<i-1?o:0,r=s}else n.length=0},r._multilineTextWrap=function(t){for(var e=x.length,i=0,n=0,r=0,s=0,l=0,u=0,h=0,d=null,p=cc.v2(0,0),y=0;y<e;){var A=x.charAt(y);if("\n"!==A){for(var S=t(x,y,e),w=u,M=h,R=l,B=n,k=!1,V=0;V<S;++V){var z=y+V;if("\r"!==(A=x.charAt(z)))if(d=c.fontAtlas.getLetterDefinitionForChar(A,c)){var U=B+d.offsetX*E-c.margin;if(P&&F>0&&n>0&&U+d.w*E>F&&!a.isUnicodeSpace(A)){_.push(l),l=0,i++,n=0,r-=O*this._getFontScale()+0,k=!0;break}p.x=U,p.y=r-d.offsetY*E+c.margin,this._recordLetterInfo(p,A,z,i),z+1<f.length&&z<e-1&&(B+=f[z+1]),B+=d.xAdvance*E+I-2*c.margin,R=p.x+d.w*E-c.margin,w<p.y&&(w=p.y),M>p.y-d.h*E&&(M=p.y-d.h*E)}else{this._recordPlaceholderInfo(z,A);var H="";m&&(H=m.atlasName),console.log("Can't find letter definition in texture atlas "+H+" for letter:"+A)}else this._recordPlaceholderInfo(z,A)}k||(n=B,u<w&&(u=w),h>M&&(h=M),s<(l=R)&&(s=l),y+=S)}else _.push(l),l=0,i++,n=0,r-=O*this._getFontScale()+0,this._recordPlaceholderInfo(y,A),y++}return _.push(l),g=(v=i+1)*O*this._getFontScale(),v>1&&(g+=0*(v-1)),C.width=L,C.height=N,L<=0&&(C.width=parseFloat(s.toFixed(2))+2*c.margin),N<=0&&(C.height=parseFloat(g.toFixed(2))+2*c.margin),T=C.height,b=0,D!==o.CLAMP&&(u>0&&(T=C.height+u),h<-g&&(b=g+h)),!0},r._getFirstCharLen=function(){return 1},r._getFontScale=function(){return D===o.SHRINK?E:1},r._getFirstWordLen=function(t,e,i){var n=t.charAt(e);if(a.isUnicodeCJK(n)||"\n"===n||a.isUnicodeSpace(n))return 1;var r=1,s=c.fontAtlas.getLetterDefinitionForChar(n,c);if(!s)return r;for(var o=s.xAdvance*E+I,l=e+1;l<i&&(n=t.charAt(l),s=c.fontAtlas.getLetterDefinitionForChar(n,c));++l){if(o+s.offsetX*E+s.w*E>F&&!a.isUnicodeSpace(n)&&F>0)return r;if(o+=s.xAdvance*E+I,"\n"===n||a.isUnicodeSpace(n)||a.isUnicodeCJK(n))break;r++}return r},r._multilineTextWrapByWord=function(){return this._multilineTextWrap(this._getFirstWordLen)},r._multilineTextWrapByChar=function(){return this._multilineTextWrap(this._getFirstCharLen)},r._recordPlaceholderInfo=function(t,e){if(t>=d.length){var i=new l;d.push(i)}d[t].char=e,d[t].hash=e.charCodeAt(0)+c.hash,d[t].valid=!1},r._recordLetterInfo=function(t,e,i,n){if(i>=d.length){var r=new l;d.push(r)}var a=e.charCodeAt(0)+c.hash;d[i].line=n,d[i].char=e,d[i].hash=a,d[i].valid=c.fontAtlas.getLetter(a).valid,d[i].x=t.x,d[i].y=t.y},r._alignText=function(){g=0,_.length=0,this._multilineTextWrapByWord(),this._computeAlignmentOffset(),D===o.SHRINK&&S>0&&this._isVerticalClamp()&&this._shrinkLabelToContentSize(this._isVerticalClamp),this._updateQuads()||D===o.SHRINK&&this._shrinkLabelToContentSize(this._isHorizontalClamp)},r._scaleFontSizeDown=function(t){var e=!0;t||(t=.1,e=!1),S=t,e&&this._updateContent()},r._shrinkLabelToContentSize=function(t){for(var e=0,i=0|S,n=0;e<i;){var r=n=e+i+1>>1;if(r<=0)break;E=r/w,this._multilineTextWrapByWord(),this._computeAlignmentOffset(),t()?i=n-1:e=n}var a=e;a>=0&&this._scaleFontSizeDown(a)},r._isVerticalClamp=function(){return g>C.height},r._isHorizontalClamp=function(){for(var t=!1,e=0,i=x.length;e<i;++e){var n=d[e];if(n.valid){var r=c.fontAtlas.getLetter(n.hash),a=n.x+r.w*E,s=n.line;if(L>0)if(P){if(_[s]>C.width&&(a>C.width||a<0)){t=!0;break}}else if(a>C.width){t=!0;break}}}return t},r._isHorizontalClamped=function(t,e){var i=_[e],n=t>C.width||t<0;return P?i>C.width&&n:n},r._updateQuads=function(){var t=A?A._texture:c.fontAtlas.getTexture(),e=h.node;this.verticesCount=this.indicesCount=0,this._renderData&&(this._renderData.dataLength=0);for(var i=C,n=e._anchorPoint.x*i.width,r=e._anchorPoint.y*i.height,a=!0,s=0,l=x.length;s<l;++s){var f=d[s];if(f.valid){var _=c.fontAtlas.getLetter(f.hash);u.height=_.h,u.width=_.w,u.x=_.u,u.y=_.v;var m=f.y+y;if(N>0){if(m>T){var v=m-T;u.y+=v,u.height-=v,m-=v}m-_.h*E<b&&D===o.CLAMP&&(u.height=m<b?0:(m-b)/E)}var g=f.line,S=f.x+_.w/2*E+p[g];if(L>0&&this._isHorizontalClamped(S,g))if(D===o.CLAMP)u.width=0;else if(D===o.SHRINK){if(C.width>_.w){a=!1;break}u.width=0}if(u.height>0&&u.width>0){var w=this._determineRect(u),M=f.x+p[f.line];this.appendQuad(h,t,u,w,M-n,m-r,E)}}}return this._quadsUpdated(h),a},r._determineRect=function(t){var e=A.isRotated(),i=A._originalSize,n=A._rect,r=A._offset,a=r.x+(i.width-n.width)/2,s=r.y-(i.height-n.height)/2;if(e){var o=t.x;t.x=n.x+n.height-t.y-t.height-s,t.y=o+n.y-a,t.y<0&&(t.height=t.height+s)}else t.x+=n.x-a,t.y+=n.y+s;return e},r._computeAlignmentOffset=function(){switch(p.length=0,M){case s.TextAlignment.LEFT:for(var t=0;t<v;++t)p.push(0);break;case s.TextAlignment.CENTER:for(var e=0,i=_.length;e<i;e++)p.push((C.width-_[e])/2);break;case s.TextAlignment.RIGHT:for(var n=0,r=_.length;n<r;n++)p.push(C.width-_[n])}if(y=C.height,R!==s.VerticalTextAlignment.TOP){var a=C.height-g+O*this._getFontScale()-w*E;R===s.VerticalTextAlignment.BOTTOM?y-=a:y-=a/2}},r._setupBMFontOverflowMetrics=function(){var t=C.width,e=C.height;D===o.RESIZE_HEIGHT&&(e=0),D===o.NONE&&(t=0,e=0),L=t,N=e,F=t},r.updateWorldVerts=function(){},r.appendQuad=function(){},r._quadsUpdated=function(){},r._reserveQuads=function(){},n})(r.default);i.default=B,e.exports=i.default}),{"../../../components/CCLabel":131,"../../../platform/CCMacro":198,"../../../utils/text-utils":285,"../../assembler-2d":219,"../utils":233}],230:[(function(t,e){"use strict";function i(){this._rect=null,this.uv=[],this._texture=null,this._original=null}i.prototype={constructor:i,getRect:function(){return cc.rect(this._rect)},setRect:function(t){this._rect=t,this._texture&&this._calculateUV()},_setDynamicAtlasFrame:function(t){t&&(this._original={_texture:this._texture,_x:this._rect.x,_y:this._rect.y},this._texture=t.texture,this._rect.x=t.x,this._rect.y=t.y,this._calculateUV())},_resetDynamicAtlasFrame:function(){this._original&&(this._rect.x=this._original._x,this._rect.y=this._original._y,this._texture=this._original._texture,this._original=null,this._calculateUV())},_refreshTexture:function(t){this._texture=t,this._rect=cc.rect(0,0,t.width,t.height),this._calculateUV()},_calculateUV:function(){var t=this._rect,e=this._texture,i=this.uv,n=e.width,r=e.height,a=0===n?0:t.x/n,s=0===n?0:(t.x+t.width)/n,o=0===r?0:(t.y+t.height)/r,c=0===r?0:t.y/r;i[0]=a,i[1]=o,i[2]=s,i[3]=o,i[4]=a,i[5]=c,i[6]=s,i[7]=c}},e.exports=i}),{}],231:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=(n=t("../../webgl/assemblers/label/2d/bmfont"))&&n.__esModule?n:{default:n},a=t("../../../components/CCLabel"),s=t("../../../components/CCLabelOutline"),o=t("../../../utils/text-utils"),c=t("../../../components/CCComponent"),l=t("../../../assets/CCRenderTexture"),u=cc.js.isChildClassOf(s,c),h=t("../utils").getFontFamily,f=t("../utils").shareLabelInfo,d=cc.BitmapFont.FontLetterDefinition,_=cc.BitmapFont.FontAtlas,p=cc.Color.WHITE,m=0,v=(1/255).toFixed(3);function g(t,e){this._texture=null,this._labelInfo=e,this._char=t,this._hash=null,this._data=null,this._canvas=null,this._context=null,this._width=0,this._height=0,this._offsetY=0,this._hash=t.charCodeAt(0)+e.hash}function y(t,e){var i=new l;i.initWithSize(t,e),i.update(),this._fontDefDictionary=new _(i),this._x=m,this._y=m,this._nexty=m,this._width=t,this._height=e,cc.director.on(cc.Director.EVENT_BEFORE_SCENE_LAUNCH,this.beforeSceneLoad,this)}g.prototype={constructor:g,updateRenderData:function(){this._updateProperties(),this._updateTexture()},_updateProperties:function(){this._texture=new cc.Texture2D,this._data=a._canvasPool.get(),this._canvas=this._data.canvas,this._context=this._data.context,this._context.font=this._labelInfo.fontDesc;var t=o.safeMeasureText(this._context,this._char,this._labelInfo.fontDesc),e=2*this._labelInfo.margin+2;this._width=parseFloat(t.toFixed(2))+e,this._height=(1+o.BASELINE_RATIO)*this._labelInfo.fontSize+e,this._offsetY=-this._labelInfo.fontSize*o.BASELINE_RATIO/2,this._canvas.width!==this._width&&(this._canvas.width=this._width),this._canvas.height!==this._height&&(this._canvas.height=this._height),this._texture.initWithElement(this._canvas)},_updateTexture:function(){var t=this._context,e=this._labelInfo,i=this._canvas.width,n=this._canvas.height,r=this._labelInfo.fontSize,a=i/2,s=n/2+r*o.MIDDLE_RATIO+r*o.BASELINE_OFFSET,c=e.color;if(t.lineJoin="round",t.textAlign="center",t.clearRect(0,0,i,n),t.fillStyle="rgba("+c.r+", "+c.g+", "+c.b+", "+v+")",t.fillRect(0,0,i,n),t.font=e.fontDesc,t.fillStyle="rgba("+c.r+", "+c.g+", "+c.b+", 1)",e.isOutlined&&e.margin>0){var l=e.out||p;t.strokeStyle="rgba("+l.r+", "+l.g+", "+l.b+", "+l.a/255+")",t.lineWidth=2*e.margin,t.strokeText(this._char,a,s)}t.fillText(this._char,a,s),this._texture.handleLoadedTexture()},destroy:function(){this._texture.destroy(),this._texture=null,a._canvasPool.put(this._data)}},cc.js.mixin(y.prototype,{insertLetterTexture:function(t){var e=t._texture,i=e.width,n=e.height;if(this._x+i+m>this._width&&(this._x=m,this._y=this._nexty),this._y+n>this._nexty&&(this._nexty=this._y+n+m),this._nexty>this._height)return null;this._fontDefDictionary._texture.drawTextureAt(e,this._x,this._y),this._dirty=!0;var r=new d;return r.u=this._x+1,r.v=this._y+1,r.texture=this._fontDefDictionary._texture,r.valid=!0,r.w=t._width-2,r.h=t._height-2,r.xAdvance=r.w,r.offsetY=t._offsetY,this._x+=i+m,this._fontDefDictionary.addLetterDefinitions(t._hash,r),r},update:function(){this._dirty&&(this._fontDefDictionary._texture.update(),this._dirty=!1)},reset:function(){this._x=m,this._y=m,this._nexty=m;for(var t=this._fontDefDictionary._letterDefinitions,e=0,i=t.length;e<i;e++){var n=t[e];n.isValid&&n.destroy()}this._fontDefDictionary.clear()},destroy:function(){this.reset(),this._fontDefDictionary._texture.destroy(),this._fontDefDictionary._texture=null},beforeSceneLoad:function(){this.clearAllCache()},clearAllCache:function(){this.destroy();var t=new l;t.initWithSize(this._width,this._height),t.update(),this._fontDefDictionary._texture=t},getLetter:function(t){return this._fontDefDictionary._letterDefinitions[t]},getTexture:function(){return this._fontDefDictionary.getTexture()},getLetterDefinitionForChar:function(t,e){var i=t.charCodeAt(0)+e.hash,n=this._fontDefDictionary._letterDefinitions[i];if(!n){var r=new g(t,e);r.updateRenderData(),n=this.insertLetterTexture(r),r.destroy()}return n}});var T=null,b=(function(t){var e,i;function n(){return t.apply(this,arguments)||this}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var r=n.prototype;return r._getAssemblerData=function(){return T||(T=new y(2048,2048),cc.Label._shareAtlas=T),T.getTexture()},r._updateFontFamily=function(t){f.fontAtlas=T,f.fontFamily=h(t);var e=u&&t.getComponent(s);e&&e.enabled?(f.isOutlined=!0,f.margin=e.width,f.out=e.color.clone(),f.out.a=e.color.a*t.node.color.a/255):(f.isOutlined=!1,f.margin=0)},r._updateLabelInfo=function(t){var e,i,n;f.fontDesc=this._getFontDesc(),f.color=t.node.color,f.hash=(i=(e=f).color.toHEX(),n="",e.isOutlined&&e.margin>0&&(n=n+e.margin+e.out.toHEX()),""+e.fontSize+e.fontFamily+i+n)},r._getFontDesc=function(){return f.fontSize.toString()+"px "+f.fontFamily},r._computeHorizontalKerningForText=function(){},r._determineRect=function(){return!1},n})(r.default);i.default=b,e.exports=i.default}),{"../../../assets/CCRenderTexture":101,"../../../components/CCComponent":129,"../../../components/CCLabel":131,"../../../components/CCLabelOutline":132,"../../../utils/text-utils":285,"../../webgl/assemblers/label/2d/bmfont":238,"../utils":233}],232:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r,a=(n=t("../../assembler-2d"))&&n.__esModule?n:{default:n},s=t("../../../utils/text-utils"),o=t("../../../platform/CCMacro"),c=t("../../../components/CCLabel"),l=t("../../../components/CCLabelOutline"),u=t("../../../components/CCLabelShadow"),h=c.Overflow,f=t("../utils").deleteFromDynamicAtlas,d=t("../utils").getFontFamily,_=(1/255).toFixed(3),p=null,m=null,v=null,g="",y="",T=0,b=0,E=[],A=cc.Size.ZERO,C=0,x=0,S=0,w=null,M="",R=h.NONE,I=!1,O=!1,D=null,P=cc.Color.WHITE,L=null,N=cc.Color.BLACK,F=cc.rect(),B=cc.Size.ZERO,k=cc.Size.ZERO,V=!1,z=!1,U=!1,H=0,W=cc.Vec2.ZERO,G=0,j=["left","center","right"],Y=(function(t){var e,i;function n(){return t.apply(this,arguments)||this}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var a=n.prototype;return a._getAssemblerData=function(){return(r=c._canvasPool.get()).canvas.width=r.canvas.height=1,r},a._resetAssemblerData=function(t){t&&c._canvasPool.put(t)},a.updateRenderData=function(e){t.prototype.updateRenderData.call(this,e),e._vertsDirty&&(this._updateProperties(e),this._calculateLabelFont(),this._updateLabelDimensions(),this._updateTexture(e),this._calDynamicAtlas(e),e._actualFontSize=T,e.node.setContentSize(k),this.updateVerts(e),e._vertsDirty=!1,p=null,m=null,v=null)},a.updateVerts=function(){},a._updatePaddingRect=function(){var t=0,e=0,i=0,n=0,r=0;if(B.width=B.height=0,D&&(t=e=i=n=r=D.width,B.width=B.height=2*r),L){var a=L.blur+r;i=Math.max(i,-L._offset.x+a),n=Math.max(n,L._offset.x+a),t=Math.max(t,L._offset.y+a),e=Math.max(e,-L._offset.y+a)}if(z){var s=b*Math.tan(.20943951);n+=s,B.width+=s}F.x=i,F.y=t,F.width=i+n,F.height=t+e},a._updateProperties=function(t){var e=t._assemblerData;p=e.context,m=e.canvas,v=t._frame._original?t._frame._original._texture:t._frame._texture,y=t.string.toString(),T=t._fontSize,b=T,H=t.underlineHeight||b/8,R=t.overflow,A.width=t.node.width,A.height=t.node.height,k=t.node.getContentSize(),C=t._lineHeight,x=t.horizontalAlign,S=t.verticalAlign,w=t.node.color,V=t.enableBold,z=t.enableItalic,U=t.enableUnderline,M=d(t),O=t.srcBlendFactor===cc.macro.BlendFactor.ONE,I=R!==h.NONE&&(R===h.RESIZE_HEIGHT||t.enableWrapText),(D=(D=l&&t.getComponent(l))&&D.enabled&&D.width>0?D:null)&&P.set(D.color),(L=(L=u&&t.getComponent(u))&&L.enabled?L:null)&&(N.set(L.color),N.a=N.a*t.node.color.a/255),this._updatePaddingRect()},a._calculateFillTextStartPosition=function(){var t=0;x===o.TextAlignment.RIGHT?t=A.width-F.width:x===o.TextAlignment.CENTER&&(t=(A.width-F.width)/2);var e=this._getLineHeight()*(E.length-1),i=T*(1-s.BASELINE_RATIO/2);if(S!==o.VerticalTextAlignment.TOP){var n=e+F.height+T-A.height;S===o.VerticalTextAlignment.BOTTOM?i-=n+=s.BASELINE_RATIO/2*T:i-=n/2}return i+=s.BASELINE_OFFSET*T,cc.v2(t+F.x,i+F.y)},a._setupOutline=function(){p.strokeStyle="rgba("+P.r+", "+P.g+", "+P.b+", "+P.a/255+")",p.lineWidth=2*D.width},a._setupShadow=function(){p.shadowColor="rgba("+N.r+", "+N.g+", "+N.b+", "+N.a/255+")",p.shadowBlur=L.blur,p.shadowOffsetX=L.offset.x,p.shadowOffsetY=-L.offset.y},a._drawTextEffect=function(t,e){if(L||D||U){var i=E.length>1&&L,n=this._measureText(p,g),r=0,a=0;L&&this._setupShadow(),D&&this._setupOutline();for(var s=0;s<E.length;++s)r=t.x,a=t.y+s*e,i&&(D&&p.strokeText(E[s],r,a),p.fillText(E[s],r,a)),U&&(G=n(E[s]),x===o.TextAlignment.RIGHT?W.x=t.x-G:x===o.TextAlignment.CENTER?W.x=t.x-G/2:W.x=t.x,W.y=a+b/8,p.fillRect(W.x,W.y,G,H));i&&(p.shadowColor="transparent")}},a._updateTexture=function(){if(p.clearRect(0,0,m.width,m.height),p.lineJoin="round",O)p.fillStyle="rgba("+w.r+", "+w.g+", "+w.b+", "+w.a/255+")";else{var t=D?P:w;p.fillStyle="rgba("+t.r+", "+t.g+", "+t.b+", "+_+")",p.fillRect(0,0,m.width,m.height),p.fillStyle="rgba("+w.r+", "+w.g+", "+w.b+", 1)"}var e=this._calculateFillTextStartPosition(),i=this._getLineHeight(),n=e.x,r=0;this._drawTextEffect(e,i);for(var a=0;a<E.length;++a)r=e.y+a*i,D&&p.strokeText(E[a],n,r),p.fillText(E[a],n,r);L&&(p.shadowColor="transparent"),v.handleLoadedTexture()},a._calDynamicAtlas=function(t){if(t.cacheMode===c.CacheMode.BITMAP){var e=t._frame;f(t,e),e._original||e.setRect(cc.rect(0,0,m.width,m.height)),this.packToDynamicAtlas(t,e)}},a._updateLabelDimensions=function(){A.width=Math.min(A.width,2048),A.height=Math.min(A.height,2048);var t=!1;m.width!==A.width&&(m.width=A.width,t=!0),m.height!==A.height&&(m.height=A.height,t=!0),t&&(p.font=g),p.textAlign=j[x]},a._getFontDesc=function(){var t=T.toString()+"px ";return t+=M,V&&(t="bold "+t),z&&(t="italic "+t),t},a._getLineHeight=function(){return 0|(0===C?T:C*T/b)},a._calculateParagraphLength=function(t,e){for(var i=[],n=0;n<t.length;++n){var r=s.safeMeasureText(e,t[n],g);i.push(r)}return i},a._measureText=function(t,e){return function(i){return s.safeMeasureText(t,i,e)}},a._calculateShrinkFont=function(t){var e=this._calculateParagraphLength(t,p),i=0,n=0,r=0;if(I){var a=k.width,o=k.height;if(a<0||o<0)return;n=o+1;for(var c=0,l=0|T+1,u=0;c<l;){if((u=c+l+1>>1)<=0){cc.logID(4003);break}T=u,g=this._getFontDesc(),p.font=g;var h=this._getLineHeight();for(n=0,i=0;i<t.length;++i){var f=s.safeMeasureText(p,t[i],g);n+=s.fragmentText(t[i],f,a,this._measureText(p,g)).length*h}n>o?l=u-1:c=u}0===c?cc.logID(4003):(T=c,g=this._getFontDesc(),p.font=g)}else{for(n=t.length*this._getLineHeight(),i=0;i<t.length;++i)r<e[i]&&(r=e[i]);var d=(A.width-F.width)/r,_=A.height/n;T=b*Math.min(1,d,_)|0,g=this._getFontDesc(),p.font=g}},a._calculateWrapText=function(t){if(I){E=[];for(var e=k.width,i=0;i<t.length;++i){var n=s.safeMeasureText(p,t[i],g),r=s.fragmentText(t[i],n,e,this._measureText(p,g));E=E.concat(r)}}},a._calculateLabelFont=function(){var t=y.split("\n");switch(E=t,g=this._getFontDesc(),p.font=g,R){case h.NONE:for(var e=0,i=0,n=0;n<t.length;++n){var r=s.safeMeasureText(p,t[n],g);e=e>r?e:r}i=(E.length+s.BASELINE_RATIO)*this._getLineHeight();var a=parseFloat(e.toFixed(2)),o=parseFloat(i.toFixed(2));A.width=a+F.width,A.height=o+F.height,k.width=a+B.width,k.height=o+B.height;break;case h.SHRINK:this._calculateShrinkFont(t),this._calculateWrapText(t);break;case h.CLAMP:this._calculateWrapText(t);break;case h.RESIZE_HEIGHT:this._calculateWrapText(t);var c=(E.length+s.BASELINE_RATIO)*this._getLineHeight();A.height=c+F.height,k.height=c+B.height}},n})(a.default);i.default=Y,e.exports=i.default}),{"../../../components/CCLabel":131,"../../../components/CCLabelOutline":132,"../../../components/CCLabelShadow":133,"../../../platform/CCMacro":198,"../../../utils/text-utils":285,"../../assembler-2d":219,"../utils":233}],233:[(function(t,e){"use strict";var i=t("./dynamic-atlas/manager"),n=cc.Color.WHITE,r={fontAtlas:null,fontSize:0,lineHeight:0,hAlign:0,vAlign:0,hash:"",fontFamily:"",fontDesc:"Arial",color:n,isOutlined:!1,out:n,margin:0};e.exports={deleteFromDynamicAtlas:function(t,e){e&&e._original&&i&&(i.deleteAtlasSpriteFrame(e),e._resetDynamicAtlasFrame())},getFontFamily:function(t){return t.useSystemFont?t.fontFamily||"Arial":t.font?t.font._nativeAsset?t.font._nativeAsset:(cc.assetManager.postLoadNative(t.font,(function(){t.setVertsDirty()})),"Arial"):"Arial"},shareLabelInfo:r}}),{"./dynamic-atlas/manager":228}],234:[(function(t,e){"use strict";function i(t,e,i){i=i||2;var r,s,o,c,l,h,f,d=e&&e.length,_=d?e[0]*i:t.length,p=n(t,0,_,i,!0),m=[];if(!p)return m;if(d&&(p=u(t,e,p,i)),t.length>80*i){r=o=t[0],s=c=t[1];for(var v=i;v<_;v+=i)(l=t[v])<r&&(r=l),(h=t[v+1])<s&&(s=h),l>o&&(o=l),h>c&&(c=h);f=Math.max(o-r,c-s)}return a(p,m,i,r,s,f),m}function n(t,e,i,n,r){var a,s;if(r===I(t,e,i,n)>0)for(a=e;a<i;a+=n)s=w(a,t[a],t[a+1],s);else for(a=i-n;a>=e;a-=n)s=w(a,t[a],t[a+1],s);return s&&b(s,s.next)&&(M(s),s=s.next),s}function r(t,e){if(!t)return t;e||(e=t);var i,n=t;do{if(i=!1,n.steiner||!b(n,n.next)&&0!==T(n.prev,n,n.next))n=n.next;else{if(M(n),(n=e=n.prev)===n.next)return null;i=!0}}while(i||n!==e);return e}function a(t,e,i,n,u,h,f){if(t){!f&&h&&_(t,n,u,h);for(var d,p,m=t;t.prev!==t.next;)if(d=t.prev,p=t.next,h?o(t,n,u,h):s(t))e.push(d.i/i),e.push(t.i/i),e.push(p.i/i),M(t),t=p.next,m=p.next;else if((t=p)===m){f?1===f?a(t=c(t,e,i),e,i,n,u,h,2):2===f&&l(t,e,i,n,u,h):a(r(t),e,i,n,u,h,1);break}}}function s(t){var e=t.prev,i=t,n=t.next;if(T(e,i,n)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(g(e.x,e.y,i.x,i.y,n.x,n.y,r.x,r.y)&&T(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function o(t,e,i,n){var r=t.prev,a=t,s=t.next;if(T(r,a,s)>=0)return!1;for(var o=r.x<a.x?r.x<s.x?r.x:s.x:a.x<s.x?a.x:s.x,c=r.y<a.y?r.y<s.y?r.y:s.y:a.y<s.y?a.y:s.y,l=r.x>a.x?r.x>s.x?r.x:s.x:a.x>s.x?a.x:s.x,u=r.y>a.y?r.y>s.y?r.y:s.y:a.y>s.y?a.y:s.y,h=m(o,c,e,i,n),f=m(l,u,e,i,n),d=t.nextZ;d&&d.z<=f;){if(d!==t.prev&&d!==t.next&&g(r.x,r.y,a.x,a.y,s.x,s.y,d.x,d.y)&&T(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(d=t.prevZ;d&&d.z>=h;){if(d!==t.prev&&d!==t.next&&g(r.x,r.y,a.x,a.y,s.x,s.y,d.x,d.y)&&T(d.prev,d,d.next)>=0)return!1;d=d.prevZ}return!0}function c(t,e,i){var n=t;do{var r=n.prev,a=n.next.next;!b(r,a)&&E(r,n,n.next,a)&&C(r,a)&&C(a,r)&&(e.push(r.i/i),e.push(n.i/i),e.push(a.i/i),M(n),M(n.next),n=t=a),n=n.next}while(n!==t);return n}function l(t,e,i,n,s,o){var c=t;do{for(var l=c.next.next;l!==c.prev;){if(c.i!==l.i&&y(c,l)){var u=S(c,l);return c=r(c,c.next),u=r(u,u.next),a(c,e,i,n,s,o),void a(u,e,i,n,s,o)}l=l.next}c=c.next}while(c!==t)}function u(t,e,i,a){var s,o,c,l=[];for(s=0,o=e.length;s<o;s++)(c=n(t,e[s]*a,s<o-1?e[s+1]*a:t.length,a,!1))===c.next&&(c.steiner=!0),l.push(v(c));for(l.sort(h),s=0;s<l.length;s++)f(l[s],i),i=r(i,i.next);return i}function h(t,e){return t.x-e.x}function f(t,e){if(e=d(t,e)){var i=S(e,t);r(i,i.next)}}function d(t,e){var i,n=e,r=t.x,a=t.y,s=-1/0;do{if(a<=n.y&&a>=n.next.y){var o=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(o<=r&&o>s){if(s=o,o===r){if(a===n.y)return n;if(a===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!i)return null;if(r===s)return i.prev;var c,l=i,u=i.x,h=i.y,f=1/0;for(n=i.next;n!==l;)r>=n.x&&n.x>=u&&g(a<h?r:s,a,u,h,a<h?s:r,a,n.x,n.y)&&((c=Math.abs(a-n.y)/(r-n.x))<f||c===f&&n.x>i.x)&&C(n,t)&&(i=n,f=c),n=n.next;return i}function _(t,e,i,n){var r=t;do{null===r.z&&(r.z=m(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,p(r)}function p(t){var e,i,n,r,a,s,o,c,l=1;do{for(i=t,t=null,a=null,s=0;i;){for(s++,n=i,o=0,e=0;e<l&&(o++,n=n.nextZ);e++);for(c=l;o>0||c>0&&n;)0===o?(r=n,n=n.nextZ,c--):0!==c&&n?i.z<=n.z?(r=i,i=i.nextZ,o--):(r=n,n=n.nextZ,c--):(r=i,i=i.nextZ,o--),a?a.nextZ=r:t=r,r.prevZ=a,a=r;i=n}a.nextZ=null,l*=2}while(s>1);return t}function m(t,e,i,n,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)/r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)/r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function v(t){var e=t,i=t;do{e.x<i.x&&(i=e),e=e.next}while(e!==t);return i}function g(t,e,i,n,r,a,s,o){return(r-s)*(e-o)-(t-s)*(a-o)>=0&&(t-s)*(n-o)-(i-s)*(e-o)>=0&&(i-s)*(a-o)-(r-s)*(n-o)>=0}function y(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!A(t,e)&&C(t,e)&&C(e,t)&&x(t,e)}function T(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function b(t,e){return t.x===e.x&&t.y===e.y}function E(t,e,i,n){return!!(b(t,e)&&b(i,n)||b(t,n)&&b(i,e))||T(t,e,i)>0!=T(t,e,n)>0&&T(i,n,t)>0!=T(i,n,e)>0}function A(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&E(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}function C(t,e){return T(t.prev,t,t.next)<0?T(t,e,t.next)>=0&&T(t,t.prev,e)>=0:T(t,e,t.prev)<0||T(t,t.next,e)<0}function x(t,e){var i=t,n=!1,r=(t.x+e.x)/2,a=(t.y+e.y)/2;do{i.y>a!=i.next.y>a&&r<(i.next.x-i.x)*(a-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==t);return n}function S(t,e){var i=new R(t.i,t.x,t.y),n=new R(e.i,e.x,e.y),r=t.next,a=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,n.next=i,i.prev=n,a.next=n,n.prev=a,n}function w(t,e,i,n){var r=new R(t,e,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function M(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function R(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function I(t,e,i,n){for(var r=0,a=e,s=i-n;a<i;a+=n)r+=(t[s]-t[a])*(t[a+1]+t[s+1]),s=a;return r}cc.Graphics.earcut=e.exports=i,i.deviation=function(t,e,i,n){var r=e&&e.length,a=r?e[0]*i:t.length,s=Math.abs(I(t,0,a,i));if(r)for(var o=0,c=e.length;o<c;o++){var l=e[o]*i,u=o<c-1?e[o+1]*i:t.length;s-=Math.abs(I(t,l,u,i))}var h=0;for(o=0;o<n.length;o+=3){var f=n[o]*i,d=n[o+1]*i,_=n[o+2]*i;h+=Math.abs((t[f]-t[_])*(t[d+1]-t[f+1])-(t[f]-t[d])*(t[_+1]-t[f+1]))}return 0===s&&0===h?0:Math.abs((h-s)/s)},i.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},n=0,r=0;r<t.length;r++){for(var a=0;a<t[r].length;a++)for(var s=0;s<e;s++)i.vertices.push(t[r][a][s]);r>0&&(n+=t[r-1].length,i.holes.push(n))}return i}}),{}],235:[(function(t,e){"use strict";var i=t("../../../../graphics/helper"),n=t("../../../../graphics/types").PointFlags,r=cc.Graphics.Point=cc.Class({name:"cc.GraphicsPoint",extends:cc.Vec2,ctor:function(){this.reset()},reset:function(){this.dx=0,this.dy=0,this.dmx=0,this.dmy=0,this.flags=0,this.len=0}});function a(){this.reset()}function s(){this._tessTol=.25,this._distTol=.01,this._updatePathOffset=!1,this._paths=null,this._pathLength=0,this._pathOffset=0,this._points=null,this._pointsOffset=0,this._commandx=0,this._commandy=0,this._paths=[],this._points=[]}cc.js.mixin(a.prototype,{reset:function(){this.closed=!1,this.nbevel=0,this.complex=!0,this.points?this.points.length=0:this.points=[]}}),cc.js.mixin(s.prototype,{moveTo:function(t,e){this._updatePathOffset&&(this._pathOffset=this._pathLength,this._updatePathOffset=!1),this._addPath(),this._addPoint(t,e,n.PT_CORNER),this._commandx=t,this._commandy=e},lineTo:function(t,e){this._addPoint(t,e,n.PT_CORNER),this._commandx=t,this._commandy=e},bezierCurveTo:function(t,e,r,a,s,o){var c=this._curPath,l=c.points[c.points.length-1];l.x!==t||l.y!==e||r!==s||a!==o?(i.tesselateBezier(this,l.x,l.y,t,e,r,a,s,o,0,n.PT_CORNER),this._commandx=s,this._commandy=o):this.lineTo(s,o)},quadraticCurveTo:function(t,e,i,n){var r=this._commandx,a=this._commandy;this.bezierCurveTo(r+2/3*(t-r),a+2/3*(e-a),i+2/3*(t-i),n+2/3*(e-n),i,n)},arc:function(t,e,n,r,a,s){i.arc(this,t,e,n,r,a,s)},ellipse:function(t,e,n,r){i.ellipse(this,t,e,n,r),this._curPath.complex=!1},circle:function(t,e,n){i.ellipse(this,t,e,n,n),this._curPath.complex=!1},rect:function(t,e,i,n){this.moveTo(t,e),this.lineTo(t,e+n),this.lineTo(t+i,e+n),this.lineTo(t+i,e),this.close(),this._curPath.complex=!1},roundRect:function(t,e,n,r,a){i.roundRect(this,t,e,n,r,a),this._curPath.complex=!1},clear:function(t){this._pathLength=0,this._pathOffset=0,this._pointsOffset=0,this._curPath=null,t&&(this._paths.length=0,this._points.length=0)},close:function(){this._curPath.closed=!0},_addPath:function(){var t=this._pathLength,e=this._paths[t];return e?e.reset():(e=new a,this._paths.push(e)),this._pathLength++,this._curPath=e,e},_addPoint:function(t,e,i){var n=this._curPath;if(n){var a,s=this._points,o=n.points;(a=s[this._pointsOffset++])?(a.x=t,a.y=e):(a=new r(t,e),s.push(a)),a.flags=i,o.push(a)}}}),cc.Graphics._Impl=s,e.exports=s}),{"../../../../graphics/helper":183,"../../../../graphics/types":185}],236:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=a(t("../../../assembler")),r=a(t("../../../../../renderer/core/input-assembler"));function a(t){return t&&t.__esModule?t:{default:t}}var s=t("../../mesh-buffer"),o=t("../../../index"),c=t("../../../../graphics/graphics"),l=t("../../../../graphics/types").PointFlags,u=c.LineJoin,h=c.LineCap,f=t("./earcut");t("./impl");var d=Math.PI,_=Math.min,p=Math.max,m=Math.ceil,v=Math.acos,g=Math.cos,y=Math.sin,T=Math.atan2;function b(t,e,i){return t<e?e:t>i?i:t}var E=cc.gfx,A=new E.VertexFormat([{name:E.ATTR_POSITION,type:E.ATTR_TYPE_FLOAT32,num:2},{name:E.ATTR_COLOR,type:E.ATTR_TYPE_UINT8,num:4,normalize:!0},{name:"a_dist",type:E.ATTR_TYPE_FLOAT32,num:1}]);A.name="vfmtPosColorSdf";var C=(function(t){var e,i;function n(e){var i;return(i=t.call(this,e)||this)._buffer=null,i._buffers=[],i._bufferOffset=0,i}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var a=n.prototype;return a.getVfmt=function(){return A},a.getVfmtFloatCount=function(){return 4},a.requestBuffer=function(){var t={indiceStart:0,vertexStart:0},e=new s(o._handle,this.getVfmt());t.meshbuffer=e;var i=new r.default(e._vb,e._ib);return t.ia=i,this._buffers.push(t),t},a.getBuffers=function(){return 0===this._buffers.length&&this.requestBuffer(),this._buffers},a.clear=function(t){this._bufferOffset=0;var e=this._buffers;if(t){for(var i=0,n=e.length;i<n;i++){var r=e[i];r.meshbuffer.destroy(),r.meshbuffer=null}e.length=0}else for(var a=0,s=e.length;a<s;a++){var o=e[a];o.indiceStart=0,o.vertexStart=0,o.meshbuffer.reset()}},a.fillBuffers=function(t,e){e._flush(),e.node=t.node,e.material=t._materials[0];for(var i=this.getBuffers(),n=0,r=i.length;n<r;n++){var a=i[n],s=a.meshbuffer;a.ia._count=a.indiceStart,e._flushIA(a.ia),s.uploadData()}},a.genBuffer=function(t,e){var i=this.getBuffers(),n=i[this._bufferOffset],r=n.meshbuffer,a=n.vertexStart+e;return(a>65535||3*a>131070)&&(++this._bufferOffset,a=e,this._bufferOffset<i.length?n=i[this._bufferOffset]:(n=this.requestBuffer(t),i[this._bufferOffset]=n),r=n.meshbuffer),a>r.vertexOffset&&r.requestStatic(e,3*e),this._buffer=n,n},a.stroke=function(t){this._curColor=t._strokeColor._val,this._flattenPaths(t._impl),this._expandStroke(t),t._impl._updatePathOffset=!0},a.fill=function(t){this._curColor=t._fillColor._val,this._expandFill(t),t._impl._updatePathOffset=!0},a._expandStroke=function(t){var e,i,n,r,a=.5*t.lineWidth,s=t.lineCap,o=t.lineJoin,c=t.miterLimit,f=t._impl,_=(e=a,i=d,n=f._tessTol,r=2*v(e/(e+n)),p(2,m(i/r)));this._calculateJoins(f,a,o,c);for(var g=f._paths,y=0,T=f._pathOffset,b=f._pathLength;T<b;T++){var E=g[T],A=E.points.length;o===u.ROUND?y+=2*(A+E.nbevel*(_+2)+1):y+=2*(A+5*E.nbevel+1),E.closed||(s===h.ROUND?y+=2*(2*_+2):y+=12)}for(var C=this.genBuffer(t,y),x=C.meshbuffer,S=x._vData,w=x._iData,M=f._pathOffset,R=f._pathLength;M<R;M++){var I,O=g[M],D=O.points,P=D.length,L=C.vertexStart,N=void 0,F=void 0,B=void 0,k=void 0;if((I=O.closed)?(N=D[P-1],F=D[0],B=0,k=P):(N=D[0],F=D[1],B=1,k=P-1),F=F||N,!I){var V=F.sub(N);V.normalizeSelf();var z=V.x,U=V.y;s===h.BUTT?this._buttCapStart(N,z,U,a,0):s===h.SQUARE?this._buttCapStart(N,z,U,a,a):s===h.ROUND&&this._roundCapStart(N,z,U,a,_)}for(var H=B;H<k;++H)o===u.ROUND?this._roundJoin(N,F,a,a,_):0!=(F.flags&(l.PT_BEVEL|l.PT_INNERBEVEL))?this._bevelJoin(N,F,a,a):(this._vset(F.x+F.dmx*a,F.y+F.dmy*a,1),this._vset(F.x-F.dmx*a,F.y-F.dmy*a,-1)),N=F,F=D[H+1];if(I){var W=this.getVfmtFloatCount(),G=L*W;this._vset(S[G],S[G+1],1),this._vset(S[G+W],S[G+W+1],-1)}else{var j=F.sub(N);j.normalizeSelf();var Y=j.x,X=j.y;s===h.BUTT?this._buttCapEnd(F,Y,X,a,0):s===h.SQUARE?this._buttCapEnd(F,Y,X,a,a):s===h.ROUND&&this._roundCapEnd(F,Y,X,a,_)}for(var q=C.indiceStart,Z=L+2,K=C.vertexStart;Z<K;Z++)w[q++]=Z-2,w[q++]=Z-1,w[q++]=Z;C.indiceStart=q}},a._expandFill=function(t){for(var e=t._impl,i=e._paths,n=0,r=e._pathOffset,a=e._pathLength;r<a;r++)n+=i[r].points.length;for(var s=this.genBuffer(t,n),o=s.meshbuffer,c=o._vData,l=o._iData,u=e._pathOffset,h=e._pathLength;u<h;u++){var d=i[u],_=d.points,p=_.length;if(0!==p){for(var m=s.vertexStart,v=0;v<p;++v)this._vset(_[v].x,_[v].y);var g=s.indiceStart;if(d.complex){for(var y=[],T=this.getVfmtFloatCount(),b=m,E=s.vertexStart;b<E;b++){var A=b*T;y.push(c[A]),y.push(c[A+1])}var C=f(y,null,2);if(!C||0===C.length)continue;for(var x=0,S=C.length;x<S;x++)l[g++]=C[x]+m}else for(var w=m,M=m+2,R=s.vertexStart;M<R;M++)l[g++]=w,l[g++]=M-1,l[g++]=M;s.indiceStart=g}}},a._calculateJoins=function(t,e,i,n){var r=0;e>0&&(r=1/e);for(var a=t._paths,s=t._pathOffset,o=t._pathLength;s<o;s++){var c=a[s],h=c.points,f=h.length,d=h[f-1],m=h[0];c.nbevel=0;for(var v=0;v<f;v++){var g,y,T=d.dy,b=-d.dx,E=m.dy,A=-m.dx;if(m.dmx=.5*(T+E),m.dmy=.5*(b+A),(g=m.dmx*m.dmx+m.dmy*m.dmy)>1e-6){var C=1/g;C>600&&(C=600),m.dmx*=C,m.dmy*=C}m.dx*d.dy-d.dx*m.dy>0&&(m.flags|=l.PT_LEFT),g*(y=p(11,_(d.len,m.len)*r))*y<1&&(m.flags|=l.PT_INNERBEVEL),m.flags&l.PT_CORNER&&(g*n*n<1||i===u.BEVEL||i===u.ROUND)&&(m.flags|=l.PT_BEVEL),0!=(m.flags&(l.PT_BEVEL|l.PT_INNERBEVEL))&&c.nbevel++,d=m,m=h[v+1]}}},a._flattenPaths=function(t){for(var e=t._paths,i=t._pathOffset,n=t._pathLength;i<n;i++){var r=e[i],a=r.points,s=a[a.length-1],o=a[0];a.length>2&&s.equals(o)&&(r.closed=!0,a.pop(),s=a[a.length-1]);for(var c=0,l=a.length;c<l;c++){var u=o.sub(s);s.len=u.mag(),(u.x||u.y)&&u.normalizeSelf(),s.dx=u.x,s.dy=u.y,s=o,o=a[c+1]}}},a._chooseBevel=function(t,e,i,n){var r,a,s,o,c=i.x,l=i.y;return 0!==t?(r=c+e.dy*n,a=l-e.dx*n,s=c+i.dy*n,o=l-i.dx*n):(r=s=c+i.dmx*n,a=o=l+i.dmy*n),[r,a,s,o]},a._buttCapStart=function(t,e,i,n,r){var a=t.x-e*r,s=t.y-i*r,o=i,c=-e;this._vset(a+o*n,s+c*n,1),this._vset(a-o*n,s-c*n,-1)},a._buttCapEnd=function(t,e,i,n,r){var a=t.x+e*r,s=t.y+i*r,o=i,c=-e;this._vset(a+o*n,s+c*n,1),this._vset(a-o*n,s-c*n,-1)},a._roundCapStart=function(t,e,i,n,r){for(var a=t.x,s=t.y,o=i,c=-e,l=0;l<r;l++){var u=l/(r-1)*d,h=g(u)*n,f=y(u)*n;this._vset(a-o*h-e*f,s-c*h-i*f,1),this._vset(a,s,0)}this._vset(a+o*n,s+c*n,1),this._vset(a-o*n,s-c*n,-1)},a._roundCapEnd=function(t,e,i,n,r){var a=t.x,s=t.y,o=i,c=-e;this._vset(a+o*n,s+c*n,1),this._vset(a-o*n,s-c*n,-1);for(var l=0;l<r;l++){var u=l/(r-1)*d,h=g(u)*n,f=y(u)*n;this._vset(a,s,0),this._vset(a-o*h+e*f,s-c*h+i*f,1)}},a._roundJoin=function(t,e,i,n,r){var a=t.dy,s=-t.dx,o=e.dy,c=-e.dx,u=e.x,h=e.y;if(0!=(e.flags&l.PT_LEFT)){var f=this._chooseBevel(e.flags&l.PT_INNERBEVEL,t,e,i),_=f[0],p=f[1],v=f[2],E=f[3],A=T(-s,-a),C=T(-c,-o);C>A&&(C-=2*d),this._vset(_,p,1),this._vset(u-a*n,e.y-s*n,-1);for(var x=b(m((A-C)/d)*r,2,r),S=0;S<x;S++){var w=A+S/(x-1)*(C-A),M=u+g(w)*n,R=h+y(w)*n;this._vset(u,h,0),this._vset(M,R,-1)}this._vset(v,E,1),this._vset(u-o*n,h-c*n,-1)}else{var I=this._chooseBevel(e.flags&l.PT_INNERBEVEL,t,e,-n),O=I[0],D=I[1],P=I[2],L=I[3],N=T(s,a),F=T(c,o);F<N&&(F+=2*d),this._vset(u+a*n,h+s*n,1),this._vset(O,D,-1);for(var B=b(m((F-N)/d)*r,2,r),k=0;k<B;k++){var V=N+k/(B-1)*(F-N),z=u+g(V)*i,U=h+y(V)*i;this._vset(z,U,1),this._vset(u,h,0)}this._vset(u+o*n,h+c*n,1),this._vset(P,L,-1)}},a._bevelJoin=function(t,e,i,n){var r,a,s,o,c,u,h,f,d=t.dy,_=-t.dx,p=e.dy,m=-e.dx;if(e.flags&l.PT_LEFT){var v=this._chooseBevel(e.flags&l.PT_INNERBEVEL,t,e,i);c=v[0],u=v[1],h=v[2],f=v[3],this._vset(c,u,1),this._vset(e.x-d*n,e.y-_*n,-1),this._vset(h,f,1),this._vset(e.x-p*n,e.y-m*n,-1)}else{var g=this._chooseBevel(e.flags&l.PT_INNERBEVEL,t,e,-n);r=g[0],a=g[1],s=g[2],o=g[3],this._vset(e.x+d*i,e.y+_*i,1),this._vset(r,a,-1),this._vset(e.x+p*i,e.y+m*i,1),this._vset(s,o,-1)}},a._vset=function(t,e,i){void 0===i&&(i=0);var n=this._buffer,r=n.meshbuffer,a=n.vertexStart*this.getVfmtFloatCount(),s=r._vData,o=r._uintVData;s[a]=t,s[a+1]=e,o[a+2]=this._curColor,s[a+3]=i,n.vertexStart++,r._dirty=!0},n})(n.default);i.default=C,n.default.register(cc.Graphics,C),e.exports=i.default}),{"../../../../../renderer/core/input-assembler":316,"../../../../graphics/graphics":182,"../../../../graphics/types":185,"../../../assembler":222,"../../../index":225,"../../mesh-buffer":262,"./earcut":234,"./impl":235}],237:[(function(t){"use strict";cc.assemblers={},t("./sprite"),t("./mask-assembler"),t("./graphics"),t("./label"),t("./motion-streak")}),{"./graphics":236,"./label":245,"./mask-assembler":246,"./motion-streak":247,"./sprite":260}],238:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=(n=t("../../../../utils/label/bmfont"))&&n.__esModule?n:{default:n},a=0,s=(function(t){var e,i;function n(){return t.apply(this,arguments)||this}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var r=n.prototype;return r.initData=function(){this._renderData.createFlexData(0,4,6,this.getVfmt())},r._reserveQuads=function(t,e){var i=4*e,n=6*e,r=this._renderData._flexBuffer;r.reserve(i,n),r.used(i,n);for(var s=this._renderData.iDatas[0],o=0,c=0,l=n;o<l;o+=6,c+=4)s[o]=c,s[o+1]=c+1,s[o+2]=c+2,s[o+3]=c+1,s[o+4]=c+3,s[o+5]=c+2;a=0},r._quadsUpdated=function(){a=0,this._renderData._flexBuffer.used(this.verticesCount,this.indicesCount)},r._getColor=function(t){return t.node._color._val},r.appendQuad=function(t,e,i,n,r,s,o){var c=this._renderData,l=c.vDatas[0],u=c.uintVDatas[0];this.verticesCount+=4,this.indicesCount=this.verticesCount/2*3;var h,f,d,_,p=e.width,m=e.height,v=i.width,g=i.height,y=this._getColor(t),T=this.floatsPerVert,b=a+this.uvOffset;n?(h=i.x/p,d=(i.x+g)/p,f=(i.y+v)/m,_=i.y/m,l[b]=h,l[b+1]=_,l[b+=T]=h,l[b+1]=f,l[b+=T]=d,l[b+1]=_,l[b+=T]=d,l[b+1]=f):(h=i.x/p,d=(i.x+v)/p,f=(i.y+g)/m,_=i.y/m,l[b]=h,l[b+1]=f,l[b+=T]=d,l[b+1]=f,l[b+=T]=h,l[b+1]=_,l[b+=T]=d,l[b+1]=_),h=r,d=r+v*o,f=s-g*o,_=s,this.appendVerts(t,a,h,d,f,_);for(var E=a+this.colorOffset,A=0;A<4;A++)u[E]=y,E+=T;a+=4*this.floatsPerVert},r.appendVerts=function(t,e,i,n,r,a){var s=this._local,o=this.floatsPerVert;s[e]=i,s[e+1]=r,s[e+=o]=n,s[e+1]=r,s[e+=o]=i,s[e+1]=a,s[e+=o]=n,s[e+1]=a},r.updateWorldVerts=function(t){for(var e=t.node._worldMatrix.m,i=e[0],n=e[1],r=e[4],a=e[5],s=e[12],o=e[13],c=this._local,l=this._renderData.vDatas[0],u=this.floatsPerVert,h=0;h<c.length;h+=u){var f=c[h],d=c[h+1];l[h]=f*i+d*r+s,l[h+1]=f*n+d*a+o}},n})(r.default);i.default=s,e.exports=i.default}),{"../../../../utils/label/bmfont":229}],239:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0,t("../../../../../platform/js"),t("./bmfont");var n=t("../../../../utils/label/letter-font"),r=cc.color(255,255,255,255),a=(function(t){var e,i;function n(){return t.apply(this,arguments)||this}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var a=n.prototype;return a.createData=function(t){return t.requestRenderData()},a._getColor=function(t){return r._fastSetA(t.node._color.a),r._val},a.updateColor=function(e){var i=this._getColor(e);t.prototype.updateColor.call(this,e,i)},n})(n);i.default=a,e.exports=i.default}),{"../../../../../platform/js":214,"../../../../utils/label/letter-font":231,"./bmfont":238}],240:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=(n=t("../../../../../assets/material/material-variant"))&&n.__esModule?n:{default:n};t("../../../../../components/CCLabel"),t("../../../../../components/CCLabelShadow"),t("../../../../../components/CCLabelOutline"),t("../../../../../assets/material/CCMaterial");var a=(function(){function t(){}var e=t.prototype;return e.init=function(t){this.labelMaterial=null,this._label=this._renderComp=t,renderer.CustomAssembler.prototype.ctor.call(this),t.node._proxy.setAssembler(this),this._layout=new jsb.LabelRenderer,this._layout.init(),this._cfg=new DataView(this._layout._cfg),this._layoutInfo=new DataView(this._layout._layout),this._cfgFields=jsb.LabelRenderer._cfgFields,this._layoutFields=jsb.LabelRenderer._layoutFields,this._layout.bindNodeProxy(t.node._proxy),this._bindMaterial(t)},e._setBufferFlag=function(t,e,i,n,r){if("int8"==n&&1==i){var a=t.getInt8(e);t.setInt8(e,r|a)}else if("int32"==n&&4==i){var s=t.getInt32(e,jsb.__isLittleEndian__);t.setInt32(e,r|s,jsb.__isLittleEndian__)}else cc.warn("flag storage type should be int8/int32 only, type/size -> "+n+"/"+i+".")},e._updateCfgFlag=function(t){var e=this._cfgFields.updateFlags;this._setBufferFlag(this._cfg,e.offset,e.size,e.type,t)},e._setBufferValue=function(t,e,i,n,r){"float"==n&&4==i?t.setFloat32(e,r,jsb.__isLittleEndian__):"int32"==n&&4==i?t.setInt32(e,r,jsb.__isLittleEndian__):"bool"==n&&1==i?t.setInt8(e,r?1:0,jsb.__isLittleEndian__):"Color4B"==n&&4==i?(t.setUint8(e,r.r),t.setUint8(e+1,r.g),t.setUint8(e+2,r.b),t.setUint8(e+3,r.a)):"int8"==n&&1==i?t.setUint8(e,r):cc.warn("dont know how to set value to buffer, type/size -> "+n+"/"+i+".")},e._setFieldValue=function(t,e,i,n){var r=e[i];this._setBufferValue(t,r.offset,r.size,r.type,n)},e._getBufferValue=function(t,e,i,n){return"float"==n&&4==i?t.getFloat32(e,jsb.__isLittleEndian__):"int32"==n&&4==i?t.getInt32(e,jsb.__isLittleEndian__):"bool"==n&&1==i?0!=t.getInt8(e,jsb.__isLittleEndian__):"Color4B"==n&&4==i?{r:t.getUint8(e),g:t.getUint8(e+1),b:t.getUint8(e+2),a:t.getUint8(e+3)}:"int8"==n&&1==i?t.getUint8(e):void cc.warn("dont know how to get value from buffer, type/size -> "+n+"/"+i+".")},e._getFieldValue=function(t,e,i){var n=e[i];return this._getBufferValue(t,n.offset,n.size,n.type)},e._getLayoutValue=function(t){return this._getFieldValue(this._layoutInfo,this._layoutFields,t)},e._setLayoutValue=function(t,e){return this._setFieldValue(this._layoutInfo,this._layoutFields,t,e)},e._updateCfgFlag_Content=function(){this._updateCfgFlag(1)},e._updateCfgFlag_Font=function(){this._updateCfgFlag(2)},e._colorEqual=function(t,e){return t.r==e.r&&t.g==e.g&&t.b==e.b&&t.a==e.a},e._colorToObj=function(t,e,i,n){return{r:t,g:e,b:i,a:n}},e.setString=function(t){t!=this._layout.string&&(this._layout.string=t,this._updateCfgFlag_Content())},e.setFontPath=function(t){t!=this._layout.fontPath&&(this._layout.fontPath=t,this._updateCfgFlag_Font())},e.setFontSize=function(t,e){this._getFieldValue(this._cfg,this._cfgFields,"fontSize")!=t&&(this._setFieldValue(this._cfg,this._cfgFields,"fontSize",t),this._setFieldValue(this._cfg,this._cfgFields,"fontSizeRetina",e),this._updateCfgFlag_Font())},e.setOutline=function(t){var e=this._getLayoutValue("outlineSize");e>0!=t>0&&this._updateCfgFlag_Font(),e!=t&&(this._updateCfgFlag_Content(),this._setLayoutValue("outlineSize",t))},e.setOutlineColor=function(t){var e=this._getLayoutValue("outlineColor");this._colorEqual(e,t)||(this._setLayoutValue("outlineColor",t),this._updateCfgFlag_Content())},e.setLineHeight=function(t){this._getLayoutValue("lineHeight")!=t&&(this._setLayoutValue("lineHeight",t),this._updateCfgFlag_Content())},e.setOverFlow=function(t){this._getLayoutValue("overflow")!=t&&(this._setLayoutValue("overflow",t),this._updateCfgFlag_Content())},e.setEnableWrap=function(t){this._getLayoutValue("wrap")!=t&&(this._setLayoutValue("wrap",t),this._updateCfgFlag_Content())},e.setVerticalAlign=function(t){this._getLayoutValue("valign")!=t&&(this._setLayoutValue("valign",t),this._updateCfgFlag_Content())},e.setHorizontalAlign=function(t){this._getLayoutValue("halign")!=t&&(this._setLayoutValue("halign",t),this._updateCfgFlag_Content())},e.setContentSize=function(t,e){var i=this._getLayoutValue("width"),n=this._getLayoutValue("height");i==t&&n==e||(this._setLayoutValue("height",e),this._setLayoutValue("width",t),this._updateCfgFlag_Content())},e.setAnchorPoint=function(t,e){var i=this._getLayoutValue("anchorX"),n=this._getLayoutValue("anchorY");i==t&&n==e||(this._setLayoutValue("anchorX",t),this._setLayoutValue("anchorY",e),this._updateCfgFlag_Content())},e.setColor=function(t){var e=this._getLayoutValue("color");this._colorEqual(e,t)||(this._setLayoutValue("color",t),this._updateCfgFlag_Content())},e.setShadow=function(t,e,i){var n=this._getLayoutValue("shadowBlur"),r=this._getLayoutValue("shadowX"),a=this._getLayoutValue("shadowY");n>0!=i>0&&this._updateCfgFlag_Font();var s=!1;n!=i&&(this._setLayoutValue("shadowBlur",i),s=!0),r!=t&&(this._setLayoutValue("shadowX",t),s=!0),a!=e&&(this._setLayoutValue("shadowY",e),s=!0),s&&this._updateCfgFlag_Content()},e.setShadowColor=function(t){var e=this._getLayoutValue("shadowColor");this._colorEqual(e,t)||(this._setLayoutValue("shadowColor",t),this._updateCfgFlag_Content())},e.setItalic=function(t){this._getLayoutValue("italic")!=t&&(this._setLayoutValue("italic",t),this._updateCfgFlag_Content())},e.setBold=function(t){this._getLayoutValue("bold")!=t&&(this._setLayoutValue("bold",t),this._updateCfgFlag_Content(),this._updateCfgFlag_Font())},e.setUnderline=function(t){this._getLayoutValue("underline")!=t&&(this._setLayoutValue("underline",t),this._updateCfgFlag_Content())},e.setSpacingX=function(t){this._getLayoutValue("spaceX")==t||"number"!=typeof t||isNaN(t)||(this._setLayoutValue("spaceX",t),this._updateCfgFlag_Content())},e.updateRenderData=function(t){if(t._vertsDirty){t.font&&t.font.nativeUrl&&this.setFontPath(cc.assetManager.cacheManager.getCache(t.font.nativeUrl)||t.font.nativeUrl);var e=this._layout,i=t.node.color,n=t.node,r=t.fontSize;this.setString(t.string),this.setFontSize(t.fontSize,r/72*t.fontSize),this.setLineHeight(t.lineHeight),this.setEnableWrap(t.enableWrapText),this.setItalic(t.enableItalic),this.setUnderline(t.enableUnderline),this.setBold(t.enableBold),this.setOverFlow(t.overflow),this.setVerticalAlign(t.verticalAlign),this.setHorizontalAlign(t.horizontalAlign),this.setSpacingX(t.spacingX),this.setContentSize(n.getContentSize().width,n.getContentSize().height),this.setAnchorPoint(n.anchorX,n.anchorY),this.setColor(this._colorToObj(i.getR(),i.getG(),i.getB(),Math.ceil(i.getA()*n.opacity/255)));var a=n.getComponent(cc.LabelShadow);if(a&&a.enabled){var s=a.color;this.setShadow(a.offset.x,a.offset.y,a.blur),this.setShadowColor(this._colorToObj(s.getR(),s.getG(),s.getB(),Math.ceil(s.getA()*n.opacity/255)))}else this.setShadow(0,0,-1);this._updateTTFMaterial(t),e.render()}},e._bindMaterial=function(t){var e=this.labelMaterial;return e||(e=r.default.createWithBuiltin("2d-label",t),this.labelMaterial=e),e},e._updateTTFMaterial=function(t){var e=this._bindMaterial(t),i=this._label.node,n=this._layout,r=i.getComponent(cc.LabelOutline),a=0;if(r&&r.enabled&&r.width>0){a=Math.max(Math.min(r.width/10,.4),.1);var s=r.color;this.setOutlineColor(this._colorToObj(s.getR(),s.getG(),s.getB(),Math.ceil(s.getA()*i.opacity/255)))}this.setOutline(a),e.define("CC_USE_MODEL",!0),e.define("USE_TEXTURE_ALPHAONLY",!0),e.define("USE_SDF",a>0||t.enableBold),e.define("USE_SDF_EXTEND",t.enableBold?1:0),void 0!==e.getDefine("CC_SUPPORT_standard_derivatives")&&cc.sys.glExtension("OES_standard_derivatives")&&e.define("CC_SUPPORT_standard_derivatives",!0),n.setEffect(e.effect._nativeObj)},e.fillBuffers=function(){this._layout.render()},e.getVfmt=function(){},t})();i.default=a,e.exports=i.default}),{"../../../../../assets/material/CCMaterial":111,"../../../../../assets/material/material-variant":118,"../../../../../components/CCLabel":131,"../../../../../components/CCLabelOutline":132,"../../../../../components/CCLabelShadow":133}],241:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=(n=t("../../../../utils/label/ttf"))&&n.__esModule?n:{default:n},a=t("../../../../../components/CCLabelShadow"),s=cc.color(255,255,255,255),o=(function(t){var e,i;function n(){return t.apply(this,arguments)||this}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var r=n.prototype;return r.updateUVs=function(t){for(var e=this._renderData.vDatas[0],i=t._frame.uv,n=this.uvOffset,r=this.floatsPerVert,a=0;a<4;a++){var s=2*a,o=r*a+n;e[o]=i[s],e[o+1]=i[s+1]}},r.updateColor=function(e){s._fastSetA(e.node._color.a);var i=s._val;t.prototype.updateColor.call(this,e,i)},r.updateVerts=function(t){var e=t.node,i=t._ttfTexture.width,n=t._ttfTexture.height,r=e.anchorX*e.width,s=e.anchorY*e.height,o=a&&t.getComponent(a);if(o&&o._enabled){var c=(i-e.width)/2,l=(n-e.height)/2,u=o.offset;-u.x>c?r+=i-e.width:c>u.x&&(r+=c-u.x),-u.y>l?s+=n-e.height:l>u.y&&(s+=l-u.y)}var h=this._local;h[0]=-r,h[1]=-s,h[2]=i-r,h[3]=n-s,this.updateUVs(t),this.updateWorldVerts(t)},n})(r.default);i.default=o,e.exports=i.default}),{"../../../../../components/CCLabelShadow":133,"../../../../utils/label/ttf":232}],242:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=(n=t("../../../../../value-types/vec3"))&&n.__esModule?n:{default:n},a=t("../../../../assembler-3d"),s=t("../2d/bmfont"),o=new r.default,c=new r.default,l=(function(t){var e,i;function n(){return t.apply(this,arguments)||this}return i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i,n})(s);i.default=l,cc.js.mixin(l.prototype,a,{updateWorldVerts:function(t){for(var e=t.node._worldMatrix,i=this._local,n=this._renderData.vDatas[0],a=this.floatsPerVert,s=0;s<n.length;s+=a)r.default.set(o,i[s],i[s+1],0),r.default.transformMat4(c,o,e),n[s]=c.x,n[s+1]=c.y,n[s+2]=c.z}}),e.exports=i.default}),{"../../../../../value-types/vec3":303,"../../../../assembler-3d":220,"../2d/bmfont":238}],243:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=(n=t("../../../../../value-types/vec3"))&&n.__esModule?n:{default:n},a=t("../../../../assembler-3d"),s=t("../2d/letter"),o=new r.default,c=new r.default,l=(function(t){var e,i;function n(){return t.apply(this,arguments)||this}return i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i,n})(s);i.default=l,cc.js.mixin(l.prototype,a,{updateWorldVerts:function(t){for(var e=t.node._worldMatrix,i=this._local,n=this._renderData.vDatas[0],a=this.floatsPerVert,s=0;s<n.length;s+=a)r.default.set(o,i[s],i[s+1],0),r.default.transformMat4(c,o,e),n[s]=c.x,n[s+1]=c.y,n[s+2]=c.z}}),e.exports=i.default}),{"../../../../../value-types/vec3":303,"../../../../assembler-3d":220,"../2d/letter":239}],244:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=t("../../../../assembler-3d"),r=(function(t){var e,i;function n(){return t.apply(this,arguments)||this}return i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i,n})(t("../2d/ttf"));i.default=r,cc.js.mixin(r.prototype,n),e.exports=i.default}),{"../../../../assembler-3d":220,"../2d/ttf":241}],245:[(function(t){"use strict";var e=l(t("../../../assembler")),i=l(t("../../../../components/CCLabel")),n=l(t("./2d/ttf")),r=l(t("./2d/bmfont")),a=l(t("./2d/letter")),s=l(t("./3d/ttf")),o=l(t("./3d/bmfont")),c=l(t("./3d/letter"));function l(t){return t&&t.__esModule?t:{default:t}}i.default._canvasPool={pool:[],get:function(){var t=this.pool.pop();if(!t){var e=document.createElement("canvas"),i=e.getContext("2d");t={canvas:e,context:i},i.textBaseline="alphabetic"}return t},put:function(t){this.pool.length>=32||this.pool.push(t)}},e.default.register(cc.Label,{getConstructor:function(t){var e=t.node.is3DNode,l=e?s.default:n.default;return t.font instanceof cc.BitmapFont?l=e?o.default:r.default:t.cacheMode===i.default.CacheMode.CHAR&&(cc.sys.platform===cc.sys.WECHAT_GAME_SUB?cc.warn("sorry, subdomain does not support CHAR mode currently!"):l=e?c.default:a.default),l},TTF:n.default,Bmfont:r.default,Letter:a.default,TTF3D:s.default,Bmfont3D:o.default,Letter3D:c.default,NativeTTF:void 0})}),{"../../../../components/CCLabel":131,"../../../assembler":222,"./2d/bmfont":238,"./2d/letter":239,"./2d/nativeTTF":240,"./2d/ttf":241,"./3d/bmfont":242,"./3d/letter":243,"./3d/ttf":244}],246:[(function(t,e,i){"use strict";i.__esModule=!0,i.MaskAssembler=void 0;var n,r=(n=t("../../assembler"))&&n.__esModule?n:{default:n},a=t("../../../components/CCMask"),s=t("../../render-flow"),o=t("./sprite/2d/simple"),c=t("./graphics"),l=t("../../../../renderer/gfx"),u=t("../vertex-format").vfmtPos,h=8,f=[];function d(){return 1<<f.length-1}function _(){for(var t=0,e=0;e<f.length;++e)t+=1<<e;return t}function p(t,e,i,n,r,a){var s=t.effect,o=l.STENCIL_OP_KEEP,c=l.STENCIL_OP_KEEP;s.setStencil(l.STENCIL_ENABLE,e,n,r,i,o,c,a)}function m(t){f.length+1>h&&cc.errorID(9e3,h),f.push(t)}function v(t,e){0===f.length&&cc.errorID(9001),f.pop(),0===f.length?e._flushMaterial(t._exitMaterial):T(e)}function g(t,e){var i=l.DS_FUNC_NEVER,n=d(),r=n,a=n,s=t.inverted?l.STENCIL_OP_REPLACE:l.STENCIL_OP_ZERO;p(t._clearMaterial,i,s,n,r,a);var o=e.getBuffer("mesh",u),c=o.request(4,6),h=c.indiceOffset,f=c.byteOffset>>2,_=c.vertexOffset,m=o._vData,v=o._iData;m[f++]=-1,m[f++]=-1,m[f++]=-1,m[f++]=1,m[f++]=1,m[f++]=1,m[f++]=1,m[f++]=-1,v[h++]=_,v[h++]=_+3,v[h++]=_+1,v[h++]=_+1,v[h++]=_+3,v[h++]=_+2,e.node=e._dummyNode,e.material=t._clearMaterial,e._flush()}function y(t,e){var i=l.DS_FUNC_NEVER,n=d(),r=n,s=n,u=t.inverted?l.STENCIL_OP_ZERO:l.STENCIL_OP_REPLACE;p(t._materials[0],i,u,n,r,s),e.material=t._materials[0],t._type===a.Type.IMAGE_STENCIL?(e.node=e._dummyNode,o.prototype.fillBuffers.call(t._assembler,t,e),e._flush()):(e.node=t.node,c.prototype.fillBuffers.call(t._graphics._assembler,t._graphics,e))}function T(t){var e=l.DS_FUNC_EQUAL,i=l.STENCIL_OP_KEEP,n=_(),r=n,a=d(),s=f[f.length-1];p(s._enableMaterial,e,i,n,r,a),t._flushMaterial(s._enableMaterial)}var b=(function(t){var e,i;function n(){return t.apply(this,arguments)||this}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var r=n.prototype;return r.updateRenderData=function(t){t._type===a.Type.IMAGE_STENCIL?t.spriteFrame?o.prototype.updateRenderData.call(this,t):t.setMaterial(0,null):(t._graphics.setMaterial(0,t._materials[0]),c.prototype.updateRenderData.call(t._graphics._assembler,t._graphics,t._graphics))},r.fillBuffers=function(t,e){(t._type!==a.Type.IMAGE_STENCIL||t.spriteFrame)&&(m(t),g(t,e),y(t,e),T(e)),t.node._renderFlag|=s.FLAG_UPDATE_RENDER_DATA},r.postFillBuffers=function(t,e){(t._type!==a.Type.IMAGE_STENCIL||t.spriteFrame)&&v(t,e),t.node._renderFlag|=s.FLAG_UPDATE_RENDER_DATA},n})(o);i.MaskAssembler=b,r.default.register(a,b)}),{"../../../../renderer/gfx":326,"../../../components/CCMask":135,"../../assembler":222,"../../render-flow":226,"../vertex-format":267,"./graphics":236,"./sprite/2d/simple":251}],247:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=(n=t("../../assembler-2d"))&&n.__esModule?n:{default:n},a=t("../../../components/CCMotionStreak"),s=t("../../render-flow");function o(t,e){this.point=t||cc.v2(),this.dir=e||cc.v2(),this.distance=0,this.time=0}o.prototype.setPoint=function(t,e){this.point.x=t,this.point.y=e},o.prototype.setDir=function(t,e){this.dir.x=t,this.dir.y=e},cc.v2(),cc.v2();var c=cc.v2(),l=cc.v2();function u(t,e){return t.x=-e.y,t.y=e.x,t}var h=(function(t){var e,i;function n(){return t.apply(this,arguments)||this}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var r=n.prototype;return r.initData=function(){this._renderData.createFlexData(0,16,42)},r.update=function(t,e){var i,n=t._stroke/2,r=t.node._worldMatrix.m,a=r[12],s=r[13],h=t._points;if(h.length>1){var f=h[0].point.x-a,d=h[0].point.y-s;f*f+d*d<t.minSeg&&(i=h[0])}i||(i=new o,h.splice(0,0,i)),i.setPoint(a,s),i.time=t._fadeTime+e;var _,p=0;if(!(h.length<2)){var m=t._color,v=m.r,g=m.g,y=m.b,T=m.a,b=h[1];b.distance=i.point.sub(b.point,l).mag(),l.normalizeSelf(),b.setDir(l.x,l.y),i.setDir(l.x,l.y);var E=this._renderData._flexBuffer;E.reserve(2*h.length,6*(h.length-1));for(var A=E.vData,C=E.uintVData,x=t._fadeTime,S=!1,w=h.length-1;w>=0;w--){var M=h[w],R=M.point,I=M.dir;if(M.time-=e,M.time<0)h.splice(w,1);else{var O=M.time/x,D=h[w-1];if(!S){if(!D){h.splice(w,1);continue}R.x=D.point.x-I.x*O,R.y=D.point.y-I.y*O}S=!0,u(c,I);var P=(O*T<<24>>>0)+(y<<16)+(g<<8)+v,L=5*p;A[L]=R.x+c.x*n,A[L+1]=R.y+c.y*n,A[L+2]=1,A[L+3]=O,C[L+4]=P,A[L+=5]=R.x-c.x*n,A[L+1]=R.y-c.y*n,A[L+2]=0,A[L+3]=O,C[L+4]=P,p+=2}}_=p<=2?0:3*(p-2),E.used(p,_)}},r.fillBuffers=function(t,e){var i=this._renderData._flexBuffer,n=i.vData,r=i.usedVertices,a=i.usedIndices,o=i.usedVerticesFloats,c=e._meshBuffer,l=c.request(r,a),u=l.byteOffset>>2,h=c._vData;n.length+u>h.length?h.set(n.subarray(0,o),u):h.set(n,u);for(var f=c._iData,d=l.indiceOffset,_=l.vertexOffset,p=0,m=r;p<m;p+=2){var v=_+p;f[d++]=v,f[d++]=v+2,f[d++]=v+1,f[d++]=v+1,f[d++]=v+2,f[d++]=v+3}t.node._renderFlag|=s.FLAG_UPDATE_RENDER_DATA},n})(r.default);i.default=h,h.register(a,h),e.exports=i.default}),{"../../../components/CCMotionStreak":136,"../../assembler-2d":219,"../../render-flow":226}],248:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=(n=t("../../../../assembler-2d"))&&n.__esModule?n:{default:n},a=t("../../../../../components/CCSprite").FillType,s=(function(t){var e,i;function n(){return t.apply(this,arguments)||this}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var r=n.prototype;return r.updateRenderData=function(t){var e=t._spriteFrame;if(this.packToDynamicAtlas(t,e),t._vertsDirty){var i=t._fillStart,n=t._fillRange;n<0&&(i+=n,n=-n),n=(n=(n=i+n)>1?1:n)<0?0:n;var r=(i=(i=i>1?1:i)<0?0:i)+(n=(n-=i)<0?0:n);r=r>1?1:r,this.updateUVs(t,i,r),this.updateVerts(t,i,r),t._vertsDirty=!1}},r.updateUVs=function(t,e,i){var n,r,s,o,c,l,u,h,f,d,_=t._spriteFrame,p=_._texture.width,m=_._texture.height,v=_._rect;_._rotated?(n=v.x/p,r=(v.y+v.width)/m,s=c=n,u=f=(v.x+v.height)/p,l=d=r,o=h=v.y/m):(n=v.x/p,r=(v.y+v.height)/m,s=u=n,c=f=(v.x+v.width)/p,o=l=r,h=d=v.y/m);var g=this._renderData.vDatas[0],y=this.uvOffset,T=this.floatsPerVert;switch(t._fillType){case a.HORIZONTAL:g[y]=s+(c-s)*e,g[y+1]=o+(l-o)*e,g[y+T]=s+(c-s)*i,g[y+T+1]=o+(l-o)*i,g[y+2*T]=u+(f-u)*e,g[y+2*T+1]=h+(d-h)*e,g[y+3*T]=u+(f-u)*i,g[y+3*T+1]=h+(d-h)*i;break;case a.VERTICAL:g[y]=s+(u-s)*e,g[y+1]=o+(h-o)*e,g[y+T]=c+(f-c)*e,g[y+T+1]=l+(d-l)*e,g[y+2*T]=s+(u-s)*i,g[y+2*T+1]=o+(h-o)*i,g[y+3*T]=c+(f-c)*i,g[y+3*T+1]=l+(d-l)*i;break;default:cc.errorID(2626)}},r.updateVerts=function(t,e,i){var n,r=t.node,s=r.width,o=r.height,c=r.anchorX*s,l=r.anchorY*o,u=-c,h=-l,f=s-c,d=o-l;switch(t._fillType){case a.HORIZONTAL:n=u+(f-u)*i,u+=(f-u)*e,f=n;break;case a.VERTICAL:n=h+(d-h)*i,h+=(d-h)*e,d=n;break;default:cc.errorID(2626)}var _=this._local;_[0]=u,_[1]=h,_[2]=f,_[3]=d,this.updateWorldVerts(t)},n})(r.default);i.default=s,e.exports=i.default}),{"../../../../../components/CCSprite":146,"../../../../assembler-2d":219}],249:[(function(t,e,i){"use strict";var n;i.__esModule=!0,i.default=void 0;var r=(function(t){var e,i;function n(){return t.apply(this,arguments)||this}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var r=n.prototype;return r.initData=function(){this._renderData.createFlexData(0,4,6,this.getVfmt())},r.updateRenderData=function(t){this.packToDynamicAtlas(t,t._spriteFrame);var e=t.spriteFrame;if(e){var i=e.vertices;if(i){this.verticesCount=i.x.length,this.indicesCount=i.triangles.length;var n=this._renderData._flexBuffer;n.reserve(this.verticesCount,this.indicesCount)&&(this.updateColor(t),t._vertsDirty=!0),n.used(this.verticesCount,this.indicesCount),this.updateIndices(i.triangles),t._vertsDirty&&(this.updateUVs(t),this.updateVerts(t),this.updateWorldVerts(t),t._vertsDirty=!1)}}},r.updateIndices=function(t){this._renderData.iDatas[0].set(t)},r.updateUVs=function(t){for(var e=t.spriteFrame.vertices,i=e.nu,n=e.nv,r=this.uvOffset,a=this.floatsPerVert,s=this._renderData.vDatas[0],o=0;o<i.length;o++){var c=a*o+r;s[c]=i[o],s[c+1]=n[o]}},r.updateVerts=function(t){var e=t.node,i=Math.abs(e.width),n=Math.abs(e.height),r=e.anchorX*i,a=e.anchorY*n,s=t.spriteFrame,o=s.vertices,c=o.x,l=o.y,u=s._originalSize.width,h=s._originalSize.height,f=s._rect.width,d=s._rect.height,_=s._offset.x+(u-f)/2,p=s._offset.y+(h-d)/2,m=i/(t.trim?f:u),v=n/(t.trim?d:h),g=this._local;if(t.trim)for(var y=0,T=c.length;y<T;y++){var b=2*y;g[b]=(c[y]-_)*m-r,g[b+1]=(h-l[y]-p)*v-a}else for(var E=0,A=c.length;E<A;E++){var C=2*E;g[C]=c[E]*m-r,g[C+1]=(h-l[E])*v-a}},r.updateWorldVerts=function(t){for(var e=t.node._worldMatrix.m,i=e[0],n=e[1],r=e[4],a=e[5],s=e[12],o=e[13],c=this._local,l=this._renderData.vDatas[0],u=this.floatsPerVert,h=0,f=this.verticesCount;h<f;h++){var d=c[2*h],_=c[2*h+1];l[u*h]=d*i+_*r+s,l[u*h+1]=d*n+_*a+o}},n})(((n=t("../../../../assembler-2d"))&&n.__esModule?n:{default:n}).default);i.default=r,e.exports=i.default}),{"../../../../assembler-2d":219}],250:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=(n=t("../../../../assembler-2d"))&&n.__esModule?n:{default:n},a=2*Math.PI,s=[cc.v2(0,0),cc.v2(0,0),cc.v2(0,0),cc.v2(0,0)],o=[0,0,0,0],c=[0,0,0,0,0,0,0,0],l=[cc.v2(0,0),cc.v2(0,0),cc.v2(0,0),cc.v2(0,0)],u=[cc.v2(0,0),cc.v2(0,0),cc.v2(0,0),cc.v2(0,0)],h=cc.v2(0,0),f=[];function d(t,e,i,n,r,a,s){var o,c,l=Math.sin(a),u=Math.cos(a);if(0!==Math.cos(a)){if(o=l/u,(t-r.x)*u>0){var h=r.y+o*(t-r.x);s[0].x=t,s[0].y=h}if((e-r.x)*u>0){var f=r.y+o*(e-r.x);s[2].x=e,s[2].y=f}}if(0!==Math.sin(a)){if(c=u/l,(n-r.y)*l>0){var d=r.x+c*(n-r.y);s[3].x=d,s[3].y=n}if((i-r.y)*l>0){var _=r.x+c*(i-r.y);s[1].x=_,s[1].y=i}}}function _(t){var e=t.node,i=e.width,n=e.height,r=e.anchorX*i,a=e.anchorY*n,c=-r,l=-a,u=i-r,d=n-a,_=o;_[0]=c,_[1]=l,_[2]=u,_[3]=d;var p=t._fillCenter,m=h.x=Math.min(Math.max(0,p.x),1)*(u-c)+c,v=h.y=Math.min(Math.max(0,p.y),1)*(d-l)+l;s[0].x=s[3].x=c,s[1].x=s[2].x=u,s[0].y=s[1].y=l,s[2].y=s[3].y=d,f.length=0,m!==_[0]&&(f[0]=[3,0]),m!==_[2]&&(f[2]=[1,2]),v!==_[1]&&(f[1]=[0,1]),v!==_[3]&&(f[3]=[2,3])}function p(t,e){var i,n;if(i=e.x-t.x,n=e.y-t.y,0!==i||0!==n){if(0===i)return n>0?.5*Math.PI:1.5*Math.PI;var r=Math.atan(n/i);return i<0&&(r+=Math.PI),r}}var m=(function(t){var e,i;function n(){return t.apply(this,arguments)||this}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var r=n.prototype;return r.initData=function(){this._renderData.createFlexData(0,4,6,this.getVfmt()),this.updateIndices()},r.updateRenderData=function(e){t.prototype.updateRenderData.call(this,e);var i,n,r,s,f,p,m,v,g,y=e.spriteFrame;if(this.packToDynamicAtlas(e,y),e._vertsDirty){var T=e._fillStart,b=e._fillRange;for(b<0&&(T+=b,b=-b);T>=1;)T-=1;for(;T<0;)T+=1;T*=a,b*=a,_(e),p=(i=y)._texture.width,m=i._texture.height,v=i._rect,g=c,i._rotated?(n=v.x/p,r=(v.x+v.height)/p,s=v.y/m,f=(v.y+v.width)/m,g[0]=g[2]=n,g[4]=g[6]=r,g[3]=g[7]=f,g[1]=g[5]=s):(n=v.x/p,r=(v.x+v.width)/p,s=v.y/m,f=(v.y+v.height)/m,g[0]=g[4]=n,g[2]=g[6]=r,g[1]=g[3]=f,g[5]=g[7]=s),d(o[0],o[2],o[1],o[3],h,T,l),d(o[0],o[2],o[1],o[3],h,T+b,u),this.updateVerts(e,T,b),e._vertsDirty=!1}},r.updateVerts=function(t,e,i){var n=e+i,r=this._local;r.length=0;for(var o=0,c=3*this.floatsPerVert,d=0;d<4;++d){var _=f[d];if(_)if(i>=a)r.length=o+c,this._generateTriangle(r,o,h,s[_[0]],s[_[1]]),o+=c;else{var m=p(h,s[_[0]]),v=p(h,s[_[1]]);v<m&&(v+=a),m-=a,v-=a;for(var g=0;g<3;++g)m>=n||(m>=e?(r.length=o+c,v>=n?this._generateTriangle(r,o,h,s[_[0]],u[d]):this._generateTriangle(r,o,h,s[_[0]],s[_[1]]),o+=c):v<=e||(v<=n?(r.length=o+c,this._generateTriangle(r,o,h,l[d],s[_[1]]),o+=c):(r.length=o+c,this._generateTriangle(r,o,h,l[d],u[d]),o+=c))),m+=a,v+=a}}this.allocWorldVerts(t),this.updateWorldVerts(t)},r.allocWorldVerts=function(t){var e=t.node._color._val,i=this._renderData,n=this.floatsPerVert,r=this._local,a=r.length/n;this.verticesCount=this.indicesCount=a;var s=i._flexBuffer;s.reserve(a,a)&&this.updateIndices(),s.used(this.verticesCount,this.indicesCount);for(var o=i.vDatas[0],c=i.uintVDatas[0],l=this.uvOffset,u=0;u<r.length;u+=n){var h=u+l;o[h]=r[h],o[h+1]=r[h+1],c[h+2]=e}},r.updateIndices=function(){for(var t=this._renderData.iDatas[0],e=0;e<t.length;e++)t[e]=e},r.updateWorldVerts=function(t){for(var e=t.node._worldMatrix.m,i=e[0],n=e[1],r=e[4],a=e[5],s=e[12],o=e[13],c=this._local,l=this._renderData.vDatas[0],u=this.floatsPerVert,h=0;h<c.length;h+=u){var f=c[h],d=c[h+1];l[h]=f*i+d*r+s,l[h+1]=f*n+d*a+o}},r._generateTriangle=function(t,e,i,n,r){var a=o,s=a[0],c=a[1],l=a[2],u=a[3],h=this.floatsPerVert;t[e]=i.x,t[e+1]=i.y,t[e+h]=n.x,t[e+h+1]=n.y,t[e+2*h]=r.x,t[e+2*h+1]=r.y;var f,d,_=this.uvOffset;f=(i.x-s)/(l-s),d=(i.y-c)/(u-c),this._generateUV(f,d,t,e+_),f=(n.x-s)/(l-s),d=(n.y-c)/(u-c),this._generateUV(f,d,t,e+h+_),f=(r.x-s)/(l-s),d=(r.y-c)/(u-c),this._generateUV(f,d,t,e+2*h+_)},r._generateUV=function(t,e,i,n){var r=c[0]+(c[2]-c[0])*t,a=c[4]+(c[6]-c[4])*t,s=c[1]+(c[3]-c[1])*t,o=c[5]+(c[7]-c[5])*t;i[n]=r+(a-r)*e,i[n+1]=s+(o-s)*e},n})(r.default);i.default=m,e.exports=i.default}),{"../../../../assembler-2d":219}],251:[(function(t,e,i){"use strict";var n;i.__esModule=!0,i.default=void 0;var r=(function(t){var e,i;function n(){return t.apply(this,arguments)||this}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var r=n.prototype;return r.updateRenderData=function(t){this.packToDynamicAtlas(t,t._spriteFrame),t._vertsDirty&&(this.updateUVs(t),this.updateVerts(t),t._vertsDirty=!1)},r.updateUVs=function(t){for(var e=t._spriteFrame.uv,i=this.uvOffset,n=this.floatsPerVert,r=this._renderData.vDatas[0],a=0;a<4;a++){var s=2*a,o=n*a+i;r[o]=e[s],r[o+1]=e[s+1]}},r.updateVerts=function(t){var e,i,n,r,a=t.node,s=a.width,o=a.height,c=a.anchorX*s,l=a.anchorY*o;if(t.trim)e=-c,i=-l,n=s-c,r=o-l;else{var u=t.spriteFrame,h=u._originalSize.width,f=u._originalSize.height,d=u._rect.width,_=u._rect.height,p=u._offset,m=s/h,v=o/f,g=p.x+(h-d)/2,y=p.x-(h-d)/2;e=g*m-c,i=(p.y+(f-_)/2)*v-l,n=s+y*m-c,r=o+(p.y-(f-_)/2)*v-l}var T=this._local;T[0]=e,T[1]=i,T[2]=n,T[3]=r,this.updateWorldVerts(t)},n})(((n=t("../../../../assembler-2d"))&&n.__esModule?n:{default:n}).default);i.default=r,e.exports=i.default}),{"../../../../assembler-2d":219}],252:[(function(t,e,i){"use strict";var n;i.__esModule=!0,i.default=void 0;var r=(function(t){var e,i;function n(){return t.apply(this,arguments)||this}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var r=n.prototype;return r.initData=function(){if(!(this._renderData.meshCount>0)){this._renderData.createData(0,this.verticesFloats,this.indicesCount);for(var t=this._renderData.iDatas[0],e=0,i=0;i<3;++i)for(var n=0;n<3;++n){var r=4*i+n;t[e++]=r,t[e++]=r+1,t[e++]=r+4,t[e++]=r+1,t[e++]=r+5,t[e++]=r+4}}},r.initLocal=function(){this._local=[],this._local.length=8},r.updateRenderData=function(t){var e=t._spriteFrame;this.packToDynamicAtlas(t,e),t._vertsDirty&&(this.updateUVs(t),this.updateVerts(t),t._vertsDirty=!1)},r.updateVerts=function(t){var e=t.node,i=e.width,n=e.height,r=e.anchorX*i,a=e.anchorY*n,s=t.spriteFrame,o=s.insetLeft,c=s.insetRight,l=s.insetTop,u=s.insetBottom,h=i-o-c,f=n-l-u,d=i/(o+c),_=n/(l+u);d=isNaN(d)||d>1?1:d,_=isNaN(_)||_>1?1:_,h=h<0?0:h,f=f<0?0:f;var p=this._local;p[0]=-r,p[1]=-a,p[2]=o*d-r,p[3]=u*_-a,p[4]=p[2]+h,p[5]=p[3]+f,p[6]=i-r,p[7]=n-a,this.updateWorldVerts(t)},r.updateUVs=function(t){for(var e=this._renderData.vDatas[0],i=t.spriteFrame.uvSliced,n=this.uvOffset,r=this.floatsPerVert,a=0;a<4;++a)for(var s=0;s<4;++s){var o=4*a+s,c=i[o],l=o*r;e[l+n]=c.u,e[l+n+1]=c.v}},r.updateWorldVerts=function(t){for(var e=t.node._worldMatrix.m,i=e[0],n=e[1],r=e[4],a=e[5],s=e[12],o=e[13],c=this._local,l=this._renderData.vDatas[0],u=this.floatsPerVert,h=0;h<4;++h)for(var f=c[2*h+1],d=0;d<4;++d){var _=c[2*d],p=(4*h+d)*u;l[p]=_*i+f*r+s,l[p+1]=_*n+f*a+o}},n})(((n=t("../../../../assembler-2d"))&&n.__esModule?n:{default:n}).default);i.default=r,Object.assign(r.prototype,{verticesCount:16,indicesCount:54}),e.exports=i.default}),{"../../../../assembler-2d":219}],253:[(function(t,e,i){"use strict";var n;i.__esModule=!0,i.default=void 0;var r=(function(t){var e,i;function n(){return t.apply(this,arguments)||this}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var r=n.prototype;return r.initData=function(){this.verticesCount=0,this.contentWidth=0,this.contentHeight=0,this.rectWidth=0,this.rectHeight=0,this.hRepeat=0,this.vRepeat=0,this.row=0,this.col=0,this._renderData.createFlexData(0,4,6,this.getVfmt()),this._updateIndices()},r.initLocal=function(){this._local={x:[],y:[]}},r._updateIndices=function(){for(var t=this._renderData.iDatas[0],e=0,i=0,n=t.length;e<n;e+=6,i+=4)t[e]=i,t[e+1]=i+1,t[e+2]=i+2,t[e+3]=i+1,t[e+4]=i+3,t[e+5]=i+2},r.updateRenderData=function(t){var e=t._spriteFrame;this.packToDynamicAtlas(t,e);var i=t.node,n=this.contentWidth=Math.abs(i.width),r=this.contentHeight=Math.abs(i.height),a=e._rect,s=e.insetLeft,o=e.insetRight,c=a.width-s-o,l=e.insetTop,u=e.insetBottom,h=a.height-l-u;this.sizableWidth=n-s-o,this.sizableHeight=r-l-u,this.sizableWidth=this.sizableWidth>0?this.sizableWidth:0,this.sizableHeight=this.sizableHeight>0?this.sizableHeight:0;var f=this.hRepeat=0===c?this.sizableWidth:this.sizableWidth/c,d=this.vRepeat=0===h?this.sizableHeight:this.sizableHeight/h,_=(this.row=Math.ceil(d+2))*(this.col=Math.ceil(f+2));this.verticesCount=4*_,this.indicesCount=6*_;var p=this._renderData._flexBuffer;p.reserve(this.verticesCount,this.indicesCount)&&(this._updateIndices(),this.updateColor(t)),p.used(this.verticesCount,this.indicesCount),t._vertsDirty&&(this.updateUVs(t),this.updateVerts(t),t._vertsDirty=!1)},r.updateVerts=function(t){var e=t._spriteFrame,i=e._rect,n=t.node,r=n.anchorX*n.width,a=n.anchorY*n.height,s=this.row,o=this.col,c=this.contentWidth,l=this.contentHeight,u=this._local,h=u.x,f=u.y;h.length=f.length=0;var d,_,p=e.insetLeft,m=e.insetRight,v=i.width-p-m,g=e.insetTop,y=e.insetBottom,T=i.height-g-y,b=n.width/(p+m)>1?1:n.width/(p+m),E=n.height/(g+y)>1?1:n.height/(g+y);d=v>0?Math.floor(1e3*this.sizableWidth)/1e3%v==0?v:this.sizableWidth%v:this.sizableWidth,_=T>0?Math.floor(1e3*this.sizableHeight)/1e3%T==0?T:this.sizableHeight%T:this.sizableHeight;for(var A=0;A<=o;A++)0===A?h[A]=-r:A>0&&A<o?h[A]=1===A?p*b+Math.min(v,this.sizableWidth)-r:v>0?A===o-1?p+d+v*(A-2)-r:p+Math.min(v,this.sizableWidth)+v*(A-2)-r:p+this.sizableWidth-r:A===o&&(h[A]=Math.min(p+this.sizableWidth+m,c)-r);for(var C=0;C<=s;C++)0===C?f[C]=-a:C>0&&C<s?f[C]=1===C?y*E+Math.min(T,this.sizableHeight)-a:T>0?C===s-1?y+_+(C-2)*T-a:y+Math.min(T,this.sizableHeight)+(C-2)*T-a:y+this.sizableHeight-a:C===s&&(f[C]=Math.min(y+this.sizableHeight+g,l)-a);this.updateWorldVerts(t)},r.updateWorldVerts=function(t){for(var e,i,n,r,a=this._renderData,s=this._local,o=s.x,c=s.y,l=a.vDatas[0],u=this.row,h=this.col,f=t.node._worldMatrix.m,d=f[0],_=f[1],p=f[4],m=f[5],v=f[12],g=f[13],y=this.floatsPerVert,T=0,b=0,E=u;b<E;++b){n=c[b],r=c[b+1];for(var A=0,C=h;A<C;++A)e=o[A],i=o[A+1],l[T]=e*d+n*p+v,l[T+1]=e*_+n*m+g,l[T+=y]=i*d+n*p+v,l[T+1]=i*_+n*m+g,l[T+=y]=e*d+r*p+v,l[T+1]=e*_+r*m+g,l[T+=y]=i*d+r*p+v,l[T+1]=i*_+r*m+g,T+=y}},r.updateUVs=function(t){var e=this._renderData.vDatas[0];if(e)for(var i=t._spriteFrame,n=i._rect,r=i.insetLeft,a=i.insetRight,s=n.width-r-a,o=i.insetTop,c=i.insetBottom,l=n.height-o-c,u=this.row,h=this.col,f=this.hRepeat,d=this.vRepeat,_=0,p=0,m=t.spriteFrame.uv,v=t.spriteFrame.uvSliced,g=t.spriteFrame._rotated,y=this.floatsPerVert,T=this.uvOffset,b=0,E=u;b<E;++b){p=this.sizableHeight>l?this.sizableHeight>=b*l?1:d%1:d;for(var A=0,C=h;A<C;++A)_=this.sizableWidth>s?this.sizableWidth>=A*s?1:f%1:f,g?(e[T]=m[0],e[T+1]=m[1],e[T+=y]=m[0],e[T+1]=m[1]+(m[7]-m[1])*_,e[T+=y]=m[0]+(m[6]-m[0])*p,e[T+1]=m[1],e[T+=y]=e[T-y],e[T+1]=e[T+1-2*y],T+=y):(0===A?e[T]=m[0]:A>0&&A<h-1?e[T]=v[1].u:A===h-1&&(e[T]=v[2].u),0===b?e[T+1]=v[0].v:b>0&&b<u-1?e[T+1]=v[4].v:b===u-1&&(e[T+1]=v[8].v),T+=y,0===A?e[T]=v[1].u+(v[2].u-v[1].u)*_:A>0&&A<h-1?e[T]=v[1].u+(v[2].u-v[1].u)*_:A===h-1&&(e[T]=v[3].u),0===b?e[T+1]=v[0].v:b>0&&b<u-1?e[T+1]=v[4].v:b===u-1&&(e[T+1]=v[8].v),T+=y,0===A?e[T]=m[0]:A>0&&A<h-1?e[T]=v[1].u:A===h-1&&(e[T]=v[2].u),0===b?e[T+1]=v[4].v+(v[8].v-v[4].v)*p:b>0&&b<u-1?e[T+1]=v[4].v+(v[8].v-v[4].v)*p:b===u-1&&(e[T+1]=v[12].v),e[T+=y]=e[T-2*y],e[T+1]=e[T+1-y],T+=y)}},n})(((n=t("../../../../assembler-2d"))&&n.__esModule?n:{default:n}).default);i.default=r,e.exports=i.default}),{"../../../../assembler-2d":219}],254:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=t("../../../../assembler-3d"),r=(function(t){var e,i;function n(){return t.apply(this,arguments)||this}return i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i,n})(t("../2d/bar-filled"));i.default=r,cc.js.mixin(r.prototype,n),e.exports=i.default}),{"../../../../assembler-3d":220,"../2d/bar-filled":248}],255:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=(n=t("../../../../../value-types/vec3"))&&n.__esModule?n:{default:n},a=t("../../../../assembler-3d"),s=t("../2d/mesh"),o=new r.default,c=(function(t){var e,i;function n(){return t.apply(this,arguments)||this}return i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i,n})(s);i.default=c,cc.js.mixin(c.prototype,a,{updateWorldVerts:function(t){for(var e=t.node._worldMatrix,i=this._local,n=this._renderData.vDatas[0],a=this.floatsPerVert,s=0,c=i.length/2;s<c;s++){r.default.set(o,i[2*s],i[2*s+1],0),r.default.transformMat4(o,o,e);var l=a*s;n[l]=o.x,n[l+1]=o.y,n[l+2]=o.z}}}),e.exports=i.default}),{"../../../../../value-types/vec3":303,"../../../../assembler-3d":220,"../2d/mesh":249}],256:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=(n=t("../../../../../value-types/vec3"))&&n.__esModule?n:{default:n},a=t("../../../../assembler-3d"),s=t("../2d/radial-filled"),o=new r.default,c=new r.default,l=(function(t){var e,i;function n(){return t.apply(this,arguments)||this}return i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i,n})(s);i.default=l,cc.js.mixin(l.prototype,a,{updateWorldVerts:function(t){for(var e=t.node._worldMatrix,i=this._local,n=this._renderData.vDatas[0],a=this.floatsPerVert,s=0;s<n.length;s+=a)r.default.set(o,i[s],i[s+1],0),r.default.transformMat4(c,o,e),n[s]=c.x,n[s+1]=c.y,n[s+2]=c.z}}),e.exports=i.default}),{"../../../../../value-types/vec3":303,"../../../../assembler-3d":220,"../2d/radial-filled":250}],257:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=t("../../../../assembler-3d"),r=(function(t){var e,i;function n(){return t.apply(this,arguments)||this}return i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i,n})(t("../2d/simple"));i.default=r,cc.js.mixin(r.prototype,n),e.exports=i.default}),{"../../../../assembler-3d":220,"../2d/simple":251}],258:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=(n=t("../../../../../value-types/vec3"))&&n.__esModule?n:{default:n},a=t("../../../../assembler-3d"),s=t("../2d/sliced"),o=new r.default,c=new r.default,l=(function(t){var e,i;function n(){return t.apply(this,arguments)||this}return i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i,n})(s);i.default=l,cc.js.mixin(l.prototype,a,{updateWorldVerts:function(t){for(var e=t.node._worldMatrix,i=this._local,n=this._renderData.vDatas[0],a=this.floatsPerVert,s=0;s<4;++s)for(var l=i[2*s+1],u=0;u<4;++u){var h=i[2*u];r.default.set(o,h,l,0),r.default.transformMat4(c,o,e);var f=(4*s+u)*a;n[f]=c.x,n[f+1]=c.y,n[f+2]=c.z}}}),e.exports=i.default}),{"../../../../../value-types/vec3":303,"../../../../assembler-3d":220,"../2d/sliced":252}],259:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;for(var n,r=(n=t("../../../../../value-types/vec3"))&&n.__esModule?n:{default:n},a=t("../../../../assembler-3d"),s=t("../2d/tiled"),o=[],c=0;c<4;c++)o.push(new r.default);var l=(function(t){var e,i;function n(){return t.apply(this,arguments)||this}return i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i,n})(s);i.default=l,cc.js.mixin(l.prototype,a,{updateWorldVerts:function(t){for(var e,i,n,a,s=this._local,c=s.x,l=s.y,u=this._renderData.vDatas[0],h=this.row,f=this.col,d=t.node._worldMatrix,_=0,p=0,m=h;p<m;++p){n=l[p],a=l[p+1];for(var v=0,g=f;v<g;++v){e=c[v],i=c[v+1],r.default.set(o[0],e,n,0),r.default.set(o[1],i,n,0),r.default.set(o[2],e,a,0),r.default.set(o[3],i,a,0);for(var y=0;y<4;y++){var T=o[y];r.default.transformMat4(T,T,d);var b=6*y;u[_+b]=T.x,u[_+b+1]=T.y,u[_+b+2]=T.z}_+=24}}}}),e.exports=i.default}),{"../../../../../value-types/vec3":303,"../../../../assembler-3d":220,"../2d/tiled":253}],260:[(function(t){"use strict";var e=p(t("../../../assembler")),i=t("../../../../components/CCSprite"),n=p(t("./2d/simple")),r=p(t("./2d/sliced")),a=p(t("./2d/tiled")),s=p(t("./2d/radial-filled")),o=p(t("./2d/bar-filled")),c=p(t("./2d/mesh")),l=p(t("./3d/simple")),u=p(t("./3d/sliced")),h=p(t("./3d/tiled")),f=p(t("./3d/radial-filled")),d=p(t("./3d/bar-filled")),_=p(t("./3d/mesh"));function p(t){return t&&t.__esModule?t:{default:t}}var m={getConstructor:function(t){var e=t.node.is3DNode,p=e?l.default:n.default;switch(t.type){case i.Type.SLICED:p=e?u.default:r.default;break;case i.Type.TILED:p=e?h.default:a.default;break;case i.Type.FILLED:p=t._fillType===i.FillType.RADIAL?e?f.default:s.default:e?d.default:o.default;break;case i.Type.MESH:p=e?_.default:c.default}return p},Simple:n.default,Sliced:r.default,Tiled:a.default,RadialFilled:s.default,BarFilled:o.default,Mesh:c.default,Simple3D:l.default,Sliced3D:u.default,Tiled3D:h.default,RadialFilled3D:f.default,BarFilled3D:d.default,Mesh3D:_.default};e.default.register(cc.Sprite,m)}),{"../../../../components/CCSprite":146,"../../../assembler":222,"./2d/bar-filled":248,"./2d/mesh":249,"./2d/radial-filled":250,"./2d/simple":251,"./2d/sliced":252,"./2d/tiled":253,"./3d/bar-filled":254,"./3d/mesh":255,"./3d/radial-filled":256,"./3d/simple":257,"./3d/sliced":258,"./3d/tiled":259}],261:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=(function(){function t(t,e,i,n,r){this._handler=t,this._index=e,this._vfmt=r,this._verticesBytes=r._bytes,this._initVerticesCount=i,this._initIndicesCount=n,this.reset()}var e=t.prototype;return e._reallocVData=function(t,e){this.vData=new Float32Array(t),this.uintVData=new Uint32Array(this.vData.buffer),e&&this.vData.set(e),this._handler.updateMesh(this._index,this.vData,this.iData)},e._reallocIData=function(t,e){this.iData=new Uint16Array(t),e&&this.iData.set(e),this._handler.updateMesh(this._index,this.vData,this.iData)},e.reserve=function(t,e){var i=t*this._verticesBytes>>2,n=this.vData.length,r=!1;if(i>n){for(;n<i;)n*=2;this._reallocVData(n,this.vData),r=!0}var a=this.iData.length;if(e>a){for(;a<e;)a*=2;this._reallocIData(e,this.iData),r=!0}return r},e.used=function(t,e){this.usedVertices=t,this.usedIndices=e,this.usedVerticesFloats=t*this._verticesBytes>>2,this._handler.updateMeshRange(t,e)},e.reset=function(){var t=this._initVerticesCount*this._verticesBytes>>2;this._reallocVData(t),this._reallocIData(this._initIndicesCount),this.usedVertices=0,this.usedVerticesFloats=0,this.usedIndices=0},t})();i.default=n,cc.FlexBuffer=n,e.exports=i.default}),{}],262:[(function(t,e){"use strict";var i,n=(i=t("../../../renderer/gfx"))&&i.__esModule?i:{default:i},r=cc.sys.os===cc.sys.OS_IOS&&cc.sys.isBrowser&&cc.sys.isMobile&&/iPhone OS 14/.test(window.navigator.userAgent),a=cc.Class({name:"cc.MeshBuffer",ctor:function(t,e){this.init(t,e)},init:function(t,e){this.byteOffset=0,this.indiceOffset=0,this.vertexOffset=0,this.indiceStart=0,this._dirty=!1,this._vertexFormat=e,this._vertexBytes=this._vertexFormat._bytes,this._arrOffset=0,this._vbArr=[],this._vb=new n.default.VertexBuffer(t._device,e,n.default.USAGE_DYNAMIC,new ArrayBuffer,0),this._vbArr[0]=this._vb,this._ibArr=[],this._ib=new n.default.IndexBuffer(t._device,n.default.INDEX_FMT_UINT16,n.default.USAGE_STATIC,new ArrayBuffer,0),this._ibArr[0]=this._ib,this._vData=null,this._uintVData=null,this._iData=null,this._batcher=t,this._initVDataCount=256*e._bytes,this._initIDataCount=1536,this._offsetInfo={byteOffset:0,vertexOffset:0,indiceOffset:0},this._reallocBuffer()},uploadData:function(){if(0!==this.byteOffset&&this._dirty){var t=new Float32Array(this._vData.buffer,0,this.byteOffset>>2),e=new Uint16Array(this._iData.buffer,0,this.indiceOffset);this._vb.update(0,t),this._ib.update(0,e),this._dirty=!1}},switchBuffer:function(){var t=++this._arrOffset;this.byteOffset=0,this.vertexOffset=0,this.indiceOffset=0,this.indiceStart=0,t<this._vbArr.length?(this._vb=this._vbArr[t],this._ib=this._ibArr[t]):(this._vb=new n.default.VertexBuffer(this._batcher._device,this._vertexFormat,n.default.USAGE_DYNAMIC,new ArrayBuffer,0),this._vbArr[t]=this._vb,this._ib=new n.default.IndexBuffer(this._batcher._device,n.default.INDEX_FMT_UINT16,n.default.USAGE_STATIC,new ArrayBuffer,0),this._ibArr[t]=this._ib)},checkAndSwitchBuffer:function(t){this.vertexOffset+t>65535&&(this.uploadData(),this._batcher._flush(),this.switchBuffer())},requestStatic:function(t,e){this.checkAndSwitchBuffer(t);var i=this.byteOffset+t*this._vertexBytes,n=this.indiceOffset+e,r=this._vData.byteLength,a=this._iData.length;if(i>r||n>a){for(;r<i||a<n;)this._initVDataCount*=2,this._initIDataCount*=2,r=4*this._initVDataCount,a=this._initIDataCount;this._reallocBuffer()}this._updateOffset(t,e,i)},_updateOffset:function(t,e,i){var n=this._offsetInfo;n.vertexOffset=this.vertexOffset,this.vertexOffset+=t,n.indiceOffset=this.indiceOffset,this.indiceOffset+=e,n.byteOffset=this.byteOffset,this.byteOffset=i,this._dirty=!0},request:function(t,e){return this._batcher._buffer!==this&&(this._batcher._flush(),this._batcher._buffer=this),this.requestStatic(t,e),this._offsetInfo},_reallocBuffer:function(){this._reallocVData(!0),this._reallocIData(!0)},_reallocVData:function(t){var e;this._vData&&(e=new Uint8Array(this._vData.buffer)),this._vData=new Float32Array(this._initVDataCount),this._uintVData=new Uint32Array(this._vData.buffer);var i=new Uint8Array(this._uintVData.buffer);if(e&&t)for(var n=0,r=e.length;n<r;n++)i[n]=e[n]},_reallocIData:function(t){var e=this._iData;if(this._iData=new Uint16Array(this._initIDataCount),e&&t)for(var i=this._iData,n=0,r=e.length;n<r;n++)i[n]=e[n]},reset:function(){this._arrOffset=0,this._vb=this._vbArr[0],this._ib=this._ibArr[0],this.byteOffset=0,this.indiceOffset=0,this.vertexOffset=0,this.indiceStart=0,this._dirty=!1},destroy:function(){this.reset();for(var t=0;t<this._vbArr.length;t++)this._vbArr[t].destroy();this._vbArr=null;for(var e=0;e<this._ibArr.length;e++)this._ibArr[e].destroy();this._ibArr=null,this._ib=null,this._vb=null},forwardIndiceStartToOffset:function(){this.indiceStart=this.indiceOffset}});r&&(a.prototype.checkAndSwitchBuffer=function(t){this.vertexOffset+t>65535&&(this.uploadData(),this._batcher._flush())},a.prototype.forwardIndiceStartToOffset=function(){this.uploadData(),this.switchBuffer()}),cc.MeshBuffer=e.exports=a}),{"../../../renderer/gfx":326}],263:[(function(t,e){"use strict";var i=a(t("../../../renderer/core/input-assembler")),n=a(t("../../../renderer/memop/recycle-pool")),r=a(t("../../../renderer/scene/model"));function a(t){return t&&t.__esModule?t:{default:t}}var s=t("./vertex-format"),o=s.vfmtPosUvColor,c=s.vfmt3D,l=t("./quad-buffer"),u=t("./mesh-buffer"),h=t("./spine-buffer"),f=t("../../assets/material/CCMaterial"),d=(new(t("../../platform/id-generater"))("VertextFormat"),{}),_=new f,p=new i.default;p._count=0;var m=function(t,e){this._renderScene=e,this._device=t,this.walking=!1,this.material=_,this.cullingMask=1,this._iaPool=new n.default(function(){return new i.default},16),this._modelPool=new n.default(function(){return new r.default},16),this._quadBuffer=this.getBuffer("quad",o),this._meshBuffer=this.getBuffer("mesh",o),this._quadBuffer3D=this.getBuffer("quad",c),this._meshBuffer3D=this.getBuffer("mesh",c),this._buffer=this._meshBuffer,this._batchedModels=[],this._dummyNode=new cc.Node,this._sortKey=0,this.node=this._dummyNode,this.parentOpacity=1,this.parentOpacityDirty=0,this.worldMatDirty=0};m.prototype={constructor:m,reset:function(){this._iaPool.reset();for(var t=this._renderScene,e=this._batchedModels,i=0;i<e.length;++i)e[i].setInputAssembler(null),e[i].setEffect(null),t.removeModel(e[i]);for(var n in this._modelPool.reset(),e.length=0,this._sortKey=0,d)d[n].reset();this._buffer=this._meshBuffer,this.node=this._dummyNode,this.material=_,this.cullingMask=1,this.parentOpacity=1,this.parentOpacityDirty=0,this.worldMatDirty=0},_flushMaterial:function(t){if(t){this.material=t;var e=t.effect;if(e){var i=this._modelPool.add();this._batchedModels.push(i),i.sortKey=this._sortKey++,i._cullingMask=this.cullingMask,i.setNode(this.node),i.setEffect(e,null),i.setInputAssembler(p),this._renderScene.addModel(i)}}},_flush:function(){var t=this.material,e=this._buffer,i=e.indiceOffset-e.indiceStart;if(this.walking&&t&&!(i<=0)){var n=t.effect;if(n){var r=this._iaPool.add();r._vertexBuffer=e._vb,r._indexBuffer=e._ib,r._start=e.indiceStart,r._count=i;var a=this._modelPool.add();this._batchedModels.push(a),a.sortKey=this._sortKey++,a._cullingMask=this.cullingMask,a.setNode(this.node),a.setEffect(n),a.setInputAssembler(r),this._renderScene.addModel(a),e.forwardIndiceStartToOffset()}}},_flushIA:function(t){if(t){var e=this.material.effect;if(e){var i=this._modelPool.add();this._batchedModels.push(i),i.sortKey=this._sortKey++,i._cullingMask=this.cullingMask,i.setNode(this.node),i.setEffect(e),i.setInputAssembler(t),this._renderScene.addModel(i)}}},terminate:function(){for(var t in cc.dynamicAtlasManager&&cc.dynamicAtlasManager.enabled&&cc.dynamicAtlasManager.update(),this._flush(),d)d[t].uploadData();this.walking=!1},getBuffer:function(t,e){var i=t+e.getHash(),n=d[i];if(!n){if("mesh"===t)n=new u(this,e);else if("quad"===t)n=new l(this,e);else{if("spine"!==t)return cc.error("Not support buffer type ["+t+"]"),null;n=new h(this,e)}d[i]=n}return n}},e.exports=m}),{"../../../renderer/core/input-assembler":316,"../../../renderer/memop/recycle-pool":341,"../../../renderer/scene/model":348,"../../assets/material/CCMaterial":111,"../../platform/id-generater":210,"./mesh-buffer":262,"./quad-buffer":264,"./spine-buffer":266,"./vertex-format":267}],264:[(function(t,e){"use strict";var i=t("./mesh-buffer"),n=cc.Class({name:"cc.QuadBuffer",extends:i,_fillQuadBuffer:function(){for(var t=this._initIDataCount/6,e=this._iData,i=0,n=0;i<t;i++){var r=4*i;e[n++]=r,e[n++]=r+1,e[n++]=r+2,e[n++]=r+1,e[n++]=r+3,e[n++]=r+2}var a=new Uint16Array(this._iData.buffer,0,6*t);this._ib.update(0,a)},uploadData:function(){if(0!==this.byteOffset&&this._dirty){var t=new Float32Array(this._vData.buffer,0,this.byteOffset>>2);this._vb.update(0,t),this._dirty=!1}},switchBuffer:function(){this._super();var t=new Uint16Array(this._iData.buffer,0,this._initIDataCount);this._ib.update(0,t)},_reallocBuffer:function(){this._reallocVData(!0),this._reallocIData(),this._fillQuadBuffer()}});cc.QuadBuffer=e.exports=n}),{"./mesh-buffer":262}],265:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=s;var n,r=(n=t("./flex-buffer"))&&n.__esModule?n:{default:n},a=t("./vertex-format");function s(){this.vDatas=[],this.uintVDatas=[],this.iDatas=[],this.meshCount=0,this._infos=null,this._flexBuffer=null}cc.js.mixin(s.prototype,{init:function(){},clear:function(){this.vDatas.length=0,this.iDatas.length=0,this.uintVDatas.length=0,this.meshCount=0,this._infos=null,this._flexBuffer&&this._flexBuffer.reset()},updateMesh:function(t,e,i){this.vDatas[t]=e,this.uintVDatas[t]=new Uint32Array(e.buffer,0,e.length),this.iDatas[t]=i,this.meshCount=this.vDatas.length},updateMeshRange:function(){},createData:function(t,e,i){var n=new Float32Array(e),r=new Uint16Array(i);this.updateMesh(t,n,r)},createQuadData:function(t,e,i){this.createData(t,e,i),this.initQuadIndices(this.iDatas[t])},createFlexData:function(t,e,i,n){n=n||a.vfmtPosUvColor,this._flexBuffer=new r.default(this,t,e,i,n)},initQuadIndices:function(t){for(var e=t.length/6,i=0,n=0;i<e;i++){var r=4*i;t[n++]=r,t[n++]=r+1,t[n++]=r+2,t[n++]=r+1,t[n++]=r+3,t[n++]=r+2}}}),cc.RenderData=s,e.exports=i.default}),{"./flex-buffer":261,"./vertex-format":267}],266:[(function(t,e){"use strict";var i=cc.Class({name:"cc.SpineBuffer",extends:t("./mesh-buffer"),requestStatic:function(t,e){this.checkAndSwitchBuffer(t);var i=this.byteOffset+t*this._vertexBytes,n=this.indiceOffset+e,r=this._vData.byteLength,a=this._iData.length;if(i>r||n>a){for(;r<i||a<n;)this._initVDataCount*=2,this._initIDataCount*=2,r=4*this._initVDataCount,a=this._initIDataCount;this._reallocBuffer()}var s=this._offsetInfo;s.vertexOffset=this.vertexOffset,s.indiceOffset=this.indiceOffset,s.byteOffset=this.byteOffset},adjust:function(t,e){this.vertexOffset+=t,this.indiceOffset+=e,this.byteOffset=this.byteOffset+t*this._vertexBytes,this._dirty=!0}});cc.SpineBuffer=e.exports=i}),{"./mesh-buffer":262}],267:[(function(t,e){"use strict";var i,n=(i=t("../../../renderer/gfx"))&&i.__esModule?i:{default:i},r=new n.default.VertexFormat([{name:n.default.ATTR_POSITION,type:n.default.ATTR_TYPE_FLOAT32,num:3},{name:n.default.ATTR_UV0,type:n.default.ATTR_TYPE_FLOAT32,num:2},{name:n.default.ATTR_COLOR,type:n.default.ATTR_TYPE_UINT8,num:4,normalize:!0}]);r.name="vfmt3D",n.default.VertexFormat.XYZ_UV_Color=r;var a=new n.default.VertexFormat([{name:n.default.ATTR_POSITION,type:n.default.ATTR_TYPE_FLOAT32,num:2},{name:n.default.ATTR_UV0,type:n.default.ATTR_TYPE_FLOAT32,num:2},{name:n.default.ATTR_COLOR,type:n.default.ATTR_TYPE_UINT8,num:4,normalize:!0}]);a.name="vfmtPosUvColor",n.default.VertexFormat.XY_UV_Color=a;var s=new n.default.VertexFormat([{name:n.default.ATTR_POSITION,type:n.default.ATTR_TYPE_FLOAT32,num:2},{name:n.default.ATTR_UV0,type:n.default.ATTR_TYPE_FLOAT32,num:2},{name:n.default.ATTR_COLOR,type:n.default.ATTR_TYPE_UINT8,num:4,normalize:!0},{name:n.default.ATTR_COLOR0,type:n.default.ATTR_TYPE_UINT8,num:4,normalize:!0}]);s.name="vfmtPosUvTwoColor",n.default.VertexFormat.XY_UV_Two_Color=s;var o=new n.default.VertexFormat([{name:n.default.ATTR_POSITION,type:n.default.ATTR_TYPE_FLOAT32,num:2},{name:n.default.ATTR_UV0,type:n.default.ATTR_TYPE_FLOAT32,num:2}]);o.name="vfmtPosUv",n.default.VertexFormat.XY_UV=o;var c=new n.default.VertexFormat([{name:n.default.ATTR_POSITION,type:n.default.ATTR_TYPE_FLOAT32,num:2},{name:n.default.ATTR_COLOR,type:n.default.ATTR_TYPE_UINT8,num:4,normalize:!0}]);c.name="vfmtPosColor",n.default.VertexFormat.XY_Color=c;var l=new n.default.VertexFormat([{name:n.default.ATTR_POSITION,type:n.default.ATTR_TYPE_FLOAT32,num:2}]);l.name="vfmtPos",n.default.VertexFormat.XY=l,e.exports={vfmt3D:r,vfmtPosUvColor:a,vfmtPosUvTwoColor:s,vfmtPosUv:o,vfmtPosColor:c,vfmtPos:l}}),{"../../../renderer/gfx":326}],268:[(function(t,e){"use strict";t("../platform/CCSys");var i=/(\.[^\.\/\?\\]*)(\?.*)?$/,n=/((.*)(\/|\\|\\\\))?(.*?\..*$)?/,r=/[^\.\/]+\/\.\.\//;cc.path={join:function(){for(var t=arguments.length,e="",i=0;i<t;i++)e=(e+(""===e?"":"/")+arguments[i]).replace(/(\/|\\\\)$/,"");return e},extname:function(t){var e=i.exec(t);return e?e[1]:""},mainFileName:function(t){if(t){var e=t.lastIndexOf(".");if(-1!==e)return t.substring(0,e)}return t},basename:function(t,e){var i=t.indexOf("?");i>0&&(t=t.substring(0,i));var n=/(\/|\\)([^\/\\]+)$/g.exec(t.replace(/(\/|\\)$/,""));if(!n)return t;var r=n[2];return e&&t.substring(t.length-e.length).toLowerCase()===e.toLowerCase()?r.substring(0,r.length-e.length):r},dirname:function(t){var e=n.exec(t);return e?e[2]:""},changeExtname:function(t,e){e=e||"";var i=t.indexOf("?"),n="";return i>0&&(n=t.substring(i),t=t.substring(0,i)),(i=t.lastIndexOf("."))<0?t+e+n:t.substring(0,i)+e+n},changeBasename:function(t,e,i){if(0===e.indexOf("."))return this.changeExtname(t,e);var n=t.indexOf("?"),r="",a=i?this.extname(t):"";return n>0&&(r=t.substring(n),t=t.substring(0,n)),n=(n=t.lastIndexOf("/"))<=0?0:n+1,t.substring(0,n)+e+a+r},_normalize:function(t){var e=t=String(t);do{e=t,t=t.replace(r,"")}while(e.length!==t.length);return t},sep:cc.sys.os===cc.sys.OS_WINDOWS?"\\":"/",stripSep:function(t){return t.replace(/[\/\\]$/,"")}},e.exports=cc.path}),{"../platform/CCSys":202}],269:[(function(t,e){"use strict";var i=function(t,e,i,n,r,a){this.a=t,this.b=e,this.c=i,this.d=n,this.tx=r,this.ty=a};i.create=function(t,e,i,n,r,a){return{a:t,b:e,c:i,d:n,tx:r,ty:a}},i.identity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}},i.clone=function(t){return{a:t.a,b:t.b,c:t.c,d:t.d,tx:t.tx,ty:t.ty}},i.concat=function(t,e,i){var n=e.a,r=e.b,a=e.c,s=e.d,o=e.tx,c=e.ty;return t.a=n*i.a+r*i.c,t.b=n*i.b+r*i.d,t.c=a*i.a+s*i.c,t.d=a*i.b+s*i.d,t.tx=o*i.a+c*i.c+i.tx,t.ty=o*i.b+c*i.d+i.ty,t},i.invert=function(t,e){var i=e.a,n=e.b,r=e.c,a=e.d,s=1/(i*a-n*r),o=e.tx,c=e.ty;return t.a=s*a,t.b=-s*n,t.c=-s*r,t.d=s*i,t.tx=s*(r*c-a*o),t.ty=s*(n*o-i*c),t},i.fromMat4=function(t,e){var i=e.m;return t.a=i[0],t.b=i[1],t.c=i[4],t.d=i[5],t.tx=i[12],t.ty=i[13],t},i.transformVec2=function(t,e,i,n){var r,a;return void 0===n?(n=i,r=e.x,a=e.y):(r=e,a=i),t.x=n.a*r+n.c*a+n.tx,t.y=n.b*r+n.d*a+n.ty,t},i.transformSize=function(t,e,i){return t.width=i.a*e.width+i.c*e.height,t.height=i.b*e.width+i.d*e.height,t},i.transformRect=function(t,e,i){var n=e.x,r=e.y,a=n+e.width,s=r+e.height,o=i.a*n+i.c*r+i.tx,c=i.b*n+i.d*r+i.ty,l=i.a*a+i.c*r+i.tx,u=i.b*a+i.d*r+i.ty,h=i.a*n+i.c*s+i.tx,f=i.b*n+i.d*s+i.ty,d=i.a*a+i.c*s+i.tx,_=i.b*a+i.d*s+i.ty,p=Math.min(o,l,h,d),m=Math.max(o,l,h,d),v=Math.min(c,u,f,_),g=Math.max(c,u,f,_);return t.x=p,t.y=v,t.width=m-p,t.height=g-v,t},i.transformObb=function(t,e,i,n,r,a){var s=r.x,o=r.y,c=r.width,l=r.height,u=a.a*s+a.c*o+a.tx,h=a.b*s+a.d*o+a.ty,f=a.a*c,d=a.b*c,_=a.c*l,p=a.d*l;e.x=u,e.y=h,i.x=f+u,i.y=d+h,t.x=_+u,t.y=p+h,n.x=f+_+u,n.y=d+p+h},cc.AffineTransform=e.exports=i}),{}],270:[(function(t,e){"use strict";var i=t("../platform/CCObject").Flags,n=t("./misc"),r=t("../platform/js"),a=t("../platform/id-generater"),s=t("../event-manager"),o=t("../renderer/render-flow"),c=i.Destroying,l=i.DontDestroy,u=i.Deactivating,h=new a("Node");function f(t){return t?"string"==typeof t?r.getClassByName(t):t:(cc.errorID(3804),null)}function d(t,e){if(e._sealed)for(var i=0;i<t._components.length;++i){var n=t._components[i];if(n.constructor===e)return n}else for(var r=0;r<t._components.length;++r){var a=t._components[r];if(a instanceof e)return a}return null}function _(t,e,i){if(e._sealed)for(var n=0;n<t._components.length;++n){var r=t._components[n];r.constructor===e&&i.push(r)}else for(var a=0;a<t._components.length;++a){var s=t._components[a];s instanceof e&&i.push(s)}}function p(t,e){for(var i=0;i<t.length;++i){var n=t[i],r=d(n,e);if(r)return r;if(n._children.length>0&&(r=p(n._children,e)))return r}return null}function m(t,e,i){for(var n=0;n<t.length;++n){var r=t[n];_(r,e,i),r._children.length>0&&m(r._children,e,i)}}var v=cc.Class({name:"cc._BaseNode",extends:cc.Object,properties:{_parent:null,_children:[],_active:!0,_components:[],_prefab:null,_persistNode:{get:function(){return(this._objFlags&l)>0},set:function(t){t?this._objFlags|=l:this._objFlags&=~l}},name:{get:function(){return this._name},set:function(t){this._name=t}},uuid:{get:function(){return this._id}},children:{get:function(){return this._children}},childrenCount:{get:function(){return this._children.length}},active:{get:function(){return this._active},set:function(t){if(t=!!t,this._active!==t){this._active=t;var e=this._parent;e&&e._activeInHierarchy&&cc.director._nodeActivator.activateNode(this,t)}}},activeInHierarchy:{get:function(){return this._activeInHierarchy}}},ctor:function(t){this._name=void 0!==t?t:"New Node",this._activeInHierarchy=!1,this._id=h.getNewId(),cc.director._scheduler&&cc.director._scheduler.enableForTarget(this),this.__eventTargets=[]},getParent:function(){return this._parent},setParent:function(t){if(this._parent!==t){var e=this._parent;if(this._parent=t||null,this._onSetParent(t),t&&(s._setDirtyForNode(this),t._children.push(this),t.emit&&t.emit("child-added",this),t._renderFlag|=o.FLAG_CHILDREN),e){if(!(e._objFlags&c)){var i=e._children.indexOf(this);e._children.splice(i,1),e.emit&&e.emit("child-removed",this),this._onHierarchyChanged(e),0===e._children.length&&(e._renderFlag&=~o.FLAG_CHILDREN)}}else t&&this._onHierarchyChanged(null)}},attr:function(t){r.mixin(this,t)},getChildByUuid:function(t){if(!t)return cc.log("Invalid uuid"),null;for(var e=this._children,i=0,n=e.length;i<n;i++)if(e[i]._id===t)return e[i];return null},getChildByName:function(t){if(!t)return cc.log("Invalid name"),null;for(var e=this._children,i=0,n=e.length;i<n;i++)if(e[i]._name===t)return e[i];return null},addChild:function(t){cc.assertID(t,1606),cc.assertID(null===t._parent,1605),t.setParent(this)},insertChild:function(t,e){t.parent=this,t.setSiblingIndex(e)},getSiblingIndex:function(){return this._parent?this._parent._children.indexOf(this):0},setSiblingIndex:function(t){if(this._parent)if(this._parent._objFlags&u)cc.errorID(3821);else{var e=this._parent._children;t=-1!==t?t:e.length-1;var i=e.indexOf(this);t!==i&&(e.splice(i,1),t<e.length?e.splice(t,0,this):e.push(this),this._onSiblingIndexChanged&&this._onSiblingIndexChanged(t))}},walk:function(t,e){var i,n,r,a,s=cc._BaseNode,o=1,c=s._stacks[s._stackId];c||(c=[],s._stacks.push(c)),s._stackId++,c.length=0,c[0]=this;var l=null;for(a=!1;o;)if(n=c[--o])if(!a&&t?t(n):a&&e&&e(n),c[o]=null,a){if(l===this._parent)break;if(a=!1,i)if(i[++r])c[o]=i[r],o++;else if(l&&(c[o]=l,o++,a=!0,l._parent?(r=(i=l._parent._children).indexOf(l),l=l._parent):(l=null,i=null),r<0))break}else n._children.length>0?(l=n,i=n._children,r=0,c[o]=i[r],o++):(c[o]=n,o++,a=!0);c.length=0,s._stackId--},cleanup:function(){},removeFromParent:function(t){this._parent&&(void 0===t&&(t=!0),this._parent.removeChild(this,t))},removeChild:function(t,e){this._children.indexOf(t)>-1&&((e||void 0===e)&&t.cleanup(),t.parent=null)},removeAllChildren:function(t){var e=this._children;void 0===t&&(t=!0);for(var i=e.length-1;i>=0;i--){var n=e[i];n&&(t&&n.cleanup(),n.parent=null)}this._children.length=0},isChildOf:function(t){var e=this;do{if(e===t)return!0;e=e._parent}while(e);return!1},getComponent:function(t){var e=f(t);return e?d(this,e):null},getComponents:function(t){var e=f(t),i=[];return e&&_(this,e,i),i},getComponentInChildren:function(t){var e=f(t);return e?p(this._children,e):null},getComponentsInChildren:function(t){var e=f(t),i=[];return e&&(_(this,e,i),m(this._children,e,i)),i},_checkMultipleComp:!1,addComponent:function(t){var e;if("string"==typeof t){if(!(e=r.getClassByName(t)))return cc.errorID(3807,t),cc._RFpeek()&&cc.errorID(3808,t),null}else{if(!t)return cc.errorID(3804),null;e=t}if("function"!=typeof e)return cc.errorID(3809),null;if(!r.isChildClassOf(e,cc.Component))return cc.errorID(3810),null;var i=e._requireComponent;if(i&&!this.getComponent(i)&&!this.addComponent(i))return null;var n=new e;return n.node=this,this._components.push(n),this._activeInHierarchy&&cc.director._nodeActivator.activateComp(n),n},_addComponentAt:!1,removeComponent:function(t){t?(t instanceof cc.Component||(t=this.getComponent(t)),t&&t.destroy()):cc.errorID(3813)},_getDependComponent:!1,_removeComponent:function(t){if(t){if(!(this._objFlags&c)){var e=this._components.indexOf(t);-1!==e?this._components.splice(e,1):t.node!==this&&cc.errorID(3815)}}else cc.errorID(3814)},destroy:function(){cc.Object.prototype.destroy.call(this)&&(this.active=!1)},destroyAllChildren:function(){for(var t=this._children,e=0;e<t.length;++e)t[e].destroy()},_onSetParent:function(){},_onPostActivated:function(){},_onBatchCreated:function(){},_onHierarchyChanged:function(){var t=this._parent;!this._persistNode||t instanceof cc.Scene||cc.game.removePersistRootNode(this);var e=this._active&&!(!t||!t._activeInHierarchy);this._activeInHierarchy!==e&&cc.director._nodeActivator.activateNode(this,e)},_instantiate:function(t,e){return t||(t=cc.instantiate._clone(this,this)),t._prefab,t._parent=null,t._onBatchCreated(e),t},_registerIfAttached:!1,_onPreDestroy:function(){var t,e;this._objFlags|=c;var i=this._parent,n=i&&i._objFlags&c,r=this._children;for(t=0,e=r.length;t<e;++t)r[t]._destroyImmediate();for(t=0,e=this._components.length;t<e;++t)this._components[t]._destroyImmediate();var a=this.__eventTargets;for(t=0,e=a.length;t<e;++t){var s=a[t];s&&s.targetOff(this)}if(a.length=0,this._persistNode&&cc.game.removePersistRootNode(this),!n&&i){var o=i._children.indexOf(this);i._children.splice(o,1),i.emit&&i.emit("child-removed",this)}return n},onRestore:!1});v.idGenerater=h,v._stacks=[[]],v._stackId=0,v.prototype._onPreDestroyBase=v.prototype._onPreDestroy,v.prototype._onHierarchyChangedBase=v.prototype._onHierarchyChanged,n.propertyDefine(v,["parent","name","children","childrenCount"],{}),cc._BaseNode=e.exports=v}),{"../event-manager":164,"../platform/CCObject":199,"../platform/id-generater":210,"../platform/js":214,"../renderer/render-flow":226,"./misc":278}],271:[(function(t,e){"use strict";e.exports={binarySearchEpsilon:function(t,e){for(var i=0,n=t.length-1,r=n>>>1;i<=n;r=i+n>>>1){var a=t[r];if(a>e+1e-6)n=r-1;else{if(!(a<e-1e-6))return r;i=r+1}}return~i}}}),{}],272:[(function(t,e){"use strict";var i=t("../components/CCRenderComponent"),n=t("../platform/CCMacro").BlendFactor,r=t("../../renderer/gfx"),a=cc.Class({properties:{_srcBlendFactor:n.SRC_ALPHA,_dstBlendFactor:n.ONE_MINUS_SRC_ALPHA,srcBlendFactor:{get:function(){return this._srcBlendFactor},set:function(t){this._srcBlendFactor!==t&&(this._srcBlendFactor=t,this._updateBlendFunc(!0),this._onBlendChanged&&this._onBlendChanged())},animatable:!1,type:n,tooltip:!1,visible:!0},dstBlendFactor:{get:function(){return this._dstBlendFactor},set:function(t){this._dstBlendFactor!==t&&(this._dstBlendFactor=t,this._updateBlendFunc(!0))},animatable:!1,type:n,tooltip:!1,visible:!0}},setMaterial:function(t,e){var r=i.prototype.setMaterial.call(this,t,e);return this._srcBlendFactor===n.SRC_ALPHA&&this._dstBlendFactor===n.ONE_MINUS_SRC_ALPHA||this._updateMaterialBlendFunc(r),r},_updateMaterial:function(){this._updateBlendFunc()},_updateBlendFunc:function(t){if(t||this._srcBlendFactor!==n.SRC_ALPHA||this._dstBlendFactor!==n.ONE_MINUS_SRC_ALPHA)for(var e=this.getMaterials(),i=0;i<e.length;i++){var r=e[i];this._updateMaterialBlendFunc(r)}},_updateMaterialBlendFunc:function(t){t.setBlend(!0,r.BLEND_FUNC_ADD,this._srcBlendFactor,this._dstBlendFactor,r.BLEND_FUNC_ADD,this._srcBlendFactor,this._dstBlendFactor)}});e.exports=cc.BlendFunc=a}),{"../../renderer/gfx":326,"../components/CCRenderComponent":140,"../platform/CCMacro":198}],273:[(function(t,e){"use strict";var i=t("./misc").BASE64_VALUES,n="0123456789abcdef".split(""),r=["","","",""],a=r.concat(r,"-",r,"-",r,"-",r,"-",r,r,r),s=a.map((function(t,e){return"-"===t?NaN:e})).filter(isFinite);e.exports=function(t){if(22!==t.length)return t;a[0]=t[0],a[1]=t[1];for(var e=2,r=2;e<22;e+=2){var o=i[t.charCodeAt(e)],c=i[t.charCodeAt(e+1)];a[s[r++]]=n[o>>2],a[s[r++]]=n[(3&o)<<2|c>>4],a[s[r++]]=n[15&c]}return a.join("")}}),{"./misc":278}],274:[(function(t,e){"use strict";cc.find=e.exports=function(t,e){if(null==t)return cc.errorID(3814),null;if(e);else{var i=cc.director.getScene();if(!i)return null;e=i}for(var n=e,r="/"!==t[0]?0:1,a=t.split("/"),s=r;s<a.length;s++){var o=a[s],c=n._children;n=null;for(var l=0,u=c.length;l<u;++l){var h=c[l];if(h.name===o){n=h;break}}if(!n)return null}return n}}),{}],275:[(function(t,e){"use strict";var i,n=(i=t("../assets/material/material-variant"))&&i.__esModule?i:{default:i},r=t("../assets/material/CCMaterial"),a=cc.Class({properties:{_normalMaterial:null,normalMaterial:{get:function(){return this._normalMaterial},set:function(t){this._normalMaterial=t,this._updateDisabledState&&this._updateDisabledState()},type:r,tooltip:!1,animatable:!1},_grayMaterial:null,grayMaterial:{get:function(){return this._grayMaterial},set:function(t){this._grayMaterial=t,this._updateDisabledState&&this._updateDisabledState()},type:r,tooltip:!1,animatable:!1}},_switchGrayMaterial:function(t,e){var i;t?((i=this._grayMaterial)||(i=r.getBuiltinMaterial("2d-gray-sprite")),i=this._grayMaterial=n.default.create(i,e)):((i=this._normalMaterial)||(i=r.getBuiltinMaterial("2d-sprite",e)),i=this._normalMaterial=n.default.create(i,e)),e.setMaterial(0,i)}});e.exports=a}),{"../assets/material/CCMaterial":111,"../assets/material/material-variant":118}],276:[(function(t,e){"use strict";var i=/^(click)(\s)*=|(param)(\s)*=/,n=/(\s)*src(\s)*=|(\s)*height(\s)*=|(\s)*width(\s)*=|(\s)*align(\s)*=|(\s)*offset(\s)*=|(\s)*click(\s)*=|(\s)*param(\s)*=/,r=function(){this._parsedObject={},this._specialSymbolArray=[],this._specialSymbolArray.push([/&lt;/g,"<"]),this._specialSymbolArray.push([/&gt;/g,">"]),this._specialSymbolArray.push([/&amp;/g,"&"]),this._specialSymbolArray.push([/&quot;/g,'"']),this._specialSymbolArray.push([/&apos;/g,"'"]),this._specialSymbolArray.push([/&nbsp;/g," "])};r.prototype={constructor:r,parse:function(t){this._resultObjectArray=[],this._stack=[];for(var e=0,i=t.length;e<i;){var n=t.indexOf(">",e),r=-1;if(n>=0&&(r=t.lastIndexOf("<",n))<e-1&&(r=t.indexOf("<",n+1),n=t.indexOf(">",r+1)),r<0)this._stack.pop(),this._processResult(t.substring(e)),e=i;else{var a=t.substring(e,r),s=t.substring(r+1,n);""===s&&(a=t.substring(e,n+1)),this._processResult(a),-1===n?n=r:"/"===t.charAt(r+1)?this._stack.pop():this._addToStack(s),e=n+1}}return this._resultObjectArray},_attributeToObject:function(t){var e,i,r,a,s={},o=(t=t.trim()).match(/^(color|size)(\s)*=/);if(o){if(e=o[0],""===(t=t.substring(e.length).trim()))return s;switch(i=t.indexOf(" "),e[0]){case"c":s.color=i>-1?t.substring(0,i).trim():t;break;case"s":s.size=parseInt(t)}return i>-1&&(a=t.substring(i+1).trim(),r=this._processEventHandler(a),s.event=r),s}if((o=t.match(/^(br(\s)*\/)/))&&o[0].length>0&&(e=o[0].trim()).startsWith("br")&&"/"===e[e.length-1])return s.isNewLine=!0,this._resultObjectArray.push({text:"",style:{newline:!0}}),s;if((o=t.match(/^(img(\s)*src(\s)*=[^>]+\/)/))&&o[0].length>0&&(e=o[0].trim()).startsWith("img")&&"/"===e[e.length-1]){var c;o=t.match(n);for(var l=!1;o;){if(e=(t=t.substring(t.indexOf(o[0]))).substr(0,o[0].length),h=(i=(c=t.substring(e.length).trim()).indexOf(" "))>-1?c.substr(0,i):c,e=(e=e.replace(/[^a-zA-Z]/g,"").trim()).toLocaleLowerCase(),t=c.substring(i).trim(),h.endsWith("/")&&(h=h.slice(0,-1)),"src"===e){switch(h.charCodeAt(0)){case 34:case 39:l=!0,h=h.slice(1,-1)}s.isImage=!0,s.src=h}else if("height"===e)s.imageHeight=parseInt(h);else if("width"===e)s.imageWidth=parseInt(h);else if("align"===e){switch(h.charCodeAt(0)){case 34:case 39:h=h.slice(1,-1)}s.imageAlign=h.toLocaleLowerCase()}else"offset"===e?s.imageOffset=h:"click"===e&&(s.event=this._processEventHandler(e+"="+h));s.event&&"param"===e&&(s.event.param=h.replace(/^\"|\"$/g,"")),o=t.match(n)}return l&&s.isImage&&this._resultObjectArray.push({text:"",style:s}),{}}if(o=t.match(/^(outline(\s)*[^>]*)/)){var u={color:"#ffffff",width:1};if(t=o[0].substring("outline".length).trim()){var h,f=/(\s)*color(\s)*=|(\s)*width(\s)*=|(\s)*click(\s)*=|(\s)*param(\s)*=/;for(o=t.match(f);o;)e=(t=t.substring(t.indexOf(o[0]))).substr(0,o[0].length),h=(i=(c=t.substring(e.length).trim()).indexOf(" "))>-1?c.substr(0,i):c,e=(e=e.replace(/[^a-zA-Z]/g,"").trim()).toLocaleLowerCase(),t=c.substring(i).trim(),"click"===e?s.event=this._processEventHandler(e+"="+h):"color"===e?u.color=h:"width"===e&&(u.width=parseInt(h)),s.event&&"param"===e&&(s.event.param=h.replace(/^\"|\"$/g,"")),o=t.match(f)}s.outline=u}if((o=t.match(/^(on|u|b|i)(\s)*/))&&o[0].length>0){switch(e=o[0],t=t.substring(e.length).trim(),e[0]){case"u":s.underline=!0;break;case"i":s.italic=!0;break;case"b":s.bold=!0}if(""===t)return s;r=this._processEventHandler(t),s.event=r}return s},_processEventHandler:function(t){for(var e=0,n={},r=t.match(i),a=!1;r;){var s=r[0],o="";if(a=!1,'"'===(t=t.substring(s.length).trim()).charAt(0))(e=t.indexOf('"',1))>-1&&(o=t.substring(1,e).trim(),a=!0),e++;else if("'"===t.charAt(0))(e=t.indexOf("'",1))>-1&&(o=t.substring(1,e).trim(),a=!0),e++;else{var c=t.match(/(\S)+/);e=(o=c?c[0]:"").length}a&&(n[s=s.substring(0,s.length-1).trim()]=o),r=(t=t.substring(e).trim()).match(i)}return n},_addToStack:function(t){var e=this._attributeToObject(t);if(0===this._stack.length)this._stack.push(e);else{if(e.isNewLine||e.isImage)return;var i=this._stack[this._stack.length-1];for(var n in i)e[n]||(e[n]=i[n]);this._stack.push(e)}},_processResult:function(t){""!==t&&(t=this._escapeSpecialSymbol(t),this._stack.length>0?this._resultObjectArray.push({text:t,style:this._stack[this._stack.length-1]}):this._resultObjectArray.push({text:t}))},_escapeSpecialSymbol:function(t){for(var e=0;e<this._specialSymbolArray.length;++e){var i=this._specialSymbolArray[e][0],n=this._specialSymbolArray[e][1];t=t.replace(i,n)}return t}},e.exports=r}),{}],277:[(function(t){"use strict";t("./CCPath"),t("./profiler/CCProfiler"),t("./find"),t("./mutable-forward-iterator")}),{"./CCPath":268,"./find":274,"./mutable-forward-iterator":279,"./profiler/CCProfiler":282}],278:[(function(t,e){"use strict";for(var i=t("../platform/js"),n={propertyDefine:function(t,e,n){function r(t,e,n,r){var a=Object.getOwnPropertyDescriptor(t,e);if(a)a.get&&(t[n]=a.get),a.set&&r&&(t[r]=a.set);else{var s=t[n];i.getset(t,e,s,t[r])}}for(var a,s=t.prototype,o=0;o<e.length;o++){var c=(a=e[o])[0].toUpperCase()+a.slice(1);r(s,a,"get"+c,"set"+c)}for(a in n){var l=n[a];r(s,a,l[0],l[1])}},NextPOT:function(t){return t-=1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,1+(t|=t>>16)},BUILTIN_CLASSID_RE:/^(?:cc|dragonBones|sp|ccsg)\..+/},r=new Array(123),a=0;a<123;++a)r[a]=64;for(var s=0;s<64;++s)r["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charCodeAt(s)]=s;n.BASE64_VALUES=r,n.pushToMap=function(t,e,i,n){var r=t[e];r?Array.isArray(r)?n?(r.push(r[0]),r[0]=i):r.push(i):t[e]=n?[i,r]:[r,i]:t[e]=i},n.clampf=function(t,e,i){if(e>i){var n=e;e=i,i=n}return t<e?e:t<i?t:i},n.clamp01=function(t){return t<0?0:t<1?t:1},n.lerp=function(t,e,i){return t+(e-t)*i},n.degreesToRadians=function(t){return t*cc.macro.RAD},n.radiansToDegrees=function(t){return t*cc.macro.DEG},cc.misc=e.exports=n}),{"../platform/js":214}],279:[(function(t,e){"use strict";function i(t){this.i=0,this.array=t}var n=i.prototype;n.remove=function(t){var e=this.array.indexOf(t);e>=0&&this.removeAt(e)},n.removeAt=function(t){this.array.splice(t,1),t<=this.i&&--this.i},n.fastRemove=function(t){var e=this.array.indexOf(t);e>=0&&this.fastRemoveAt(e)},n.fastRemoveAt=function(t){var e=this.array;e[t]=e[e.length-1],--e.length,t<=this.i&&--this.i},n.push=function(t){this.array.push(t)},e.exports=i}),{}],280:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=(function(){function t(){this.enabled=!1,this.count=0,this.maxSize=1024}var e=t.prototype;return e.get=function(){},e.put=function(){},e.clear=function(){},t})();i.default=n,cc.pool={},n.register=function(t,e){cc.pool[t]=e},e.exports=i.default}),{}],281:[(function(t,e){"use strict";cc._PrefabInfo=cc.Class({name:"cc.PrefabInfo",properties:{root:null,asset:null,fileId:"",sync:!1}}),e.exports={syncWithPrefab:function(t){var e=t._prefab;if(!e.asset)return cc.errorID(3701,t.name),void(t._prefab=null);var i=t._objFlags,n=t._parent,r=t._id,a=t._name,s=t._active,o=t._eulerAngles.x,c=t._eulerAngles.y,l=t._eulerAngles.z,u=t._localZOrder,h=t._trs,f=h[0],d=h[1],_=h[2];cc.game._isCloning=!0;var p=e.asset.data;p._iN$t=t,cc.instantiate._clone(p,p),cc.game._isCloning=!1,t._objFlags=i,t._parent=n,t._id=r,t._prefab=e,t._name=a,t._active=s,t._localZOrder=u,(h=t._trs)[0]=f,h[1]=d,h[2]=_,t._eulerAngles.x=o,t._eulerAngles.y=c,t._eulerAngles.z=l}}}),{}],282:[(function(t,e){"use strict";var i=t("../../platform/CCMacro"),n=t("./perf-counter"),r=!1,a=15,s=null,o=null,c=null;function l(){if(!s){s={frame:{desc:"Frame time (ms)",min:0,max:50,average:500},fps:{desc:"Framerate (FPS)",below:30,average:500},draws:{desc:"Draw call"},logic:{desc:"Game Logic (ms)",min:0,max:50,average:500,color:"#080"},render:{desc:"Renderer (ms)",min:0,max:50,average:500,color:"#f90"},mode:{desc:cc.game.renderType===cc.game.RENDER_TYPE_WEBGL?"WebGL":"Canvas",min:1}};var t=performance.now();for(var e in s)s[e]._counter=new n(e,s[e],t)}}function u(){if(!o||!o.isValid){(o=new cc.Node("PROFILER-NODE")).x=o.y=10,o.groupIndex=cc.Node.BuiltinGroupIndex.DEBUG,cc.Camera._setupDebugCamera(),o.zIndex=i.MAX_ZINDEX,cc.game.addPersistRootNode(o);var t=new cc.Node("LEFT-PANEL");t.anchorX=t.anchorY=0;var e=t.addComponent(cc.Label);e.fontSize=a,e.lineHeight=a,t.parent=o;var n=new cc.Node("RIGHT-PANEL");n.anchorX=1,n.anchorY=0,n.x=200;var r=n.addComponent(cc.Label);r.horizontalAlign=cc.Label.HorizontalAlign.RIGHT,r.fontSize=a,r.lineHeight=a,n.parent=o,cc.sys.platform!==cc.sys.BAIDU_GAME_SUB&&cc.sys.platform!==cc.sys.WECHAT_GAME_SUB&&(e.cacheMode=cc.Label.CacheMode.CHAR,r.cacheMode=cc.Label.CacheMode.CHAR),c={left:e,right:r}}}function h(){u();var t=cc.director._lastUpdate;s.frame._counter.start(t),s.logic._counter.start(t)}function f(){var t=performance.now();cc.director.isPaused()?s.frame._counter.start(t):s.logic._counter.end(t),s.render._counter.start(t)}function d(){var t=performance.now();s.render._counter.end(t),s.draws._counter.value=cc.renderer.drawCalls,s.frame._counter.end(t),s.fps._counter.frame(t);var e="",i="";for(var n in s){var r=s[n];r._counter.sample(t),e+=r.desc+"\n",i+=r._counter.human()+"\n"}c&&(c.left.string=e,c.right.string=i)}cc.profiler=e.exports={isShowingStats:function(){return r},hideStats:function(){r&&(o&&(o.active=!1),cc.director.off(cc.Director.EVENT_BEFORE_UPDATE,h),cc.director.off(cc.Director.EVENT_AFTER_UPDATE,f),cc.director.off(cc.Director.EVENT_AFTER_DRAW,d),r=!1)},showStats:function(){r||(l(),o&&(o.active=!0),cc.director.on(cc.Director.EVENT_BEFORE_UPDATE,h),cc.director.on(cc.Director.EVENT_AFTER_UPDATE,f),cc.director.on(cc.Director.EVENT_AFTER_DRAW,d),r=!0)}}}),{"../../platform/CCMacro":198,"./perf-counter":284}],283:[(function(t,e){"use strict";var i=cc.Class({name:"cc.Counter",ctor:function(t,e,i){this._id=t,this._opts=e||{},this._value=0,this._total=0,this._averageValue=0,this._accumValue=0,this._accumSamples=0,this._accumStart=i},properties:{value:{get:function(){return this._value},set:function(t){this._value=t}}},_average:function(t,e){if(this._opts.average){this._accumValue+=t,++this._accumSamples;var i=e;i-this._accumStart>=this._opts.average&&(this._averageValue=this._accumValue/this._accumSamples,this._accumValue=0,this._accumStart=i,this._accumSamples=0)}},sample:function(t){this._average(this._value,t)},human:function(){var t=this._opts.average?this._averageValue:this._value;return Math.round(100*t)/100},alarm:function(){return this._opts.below&&this._value<this._opts.below||this._opts.over&&this._value>this._opts.over}});e.exports=i}),{}],284:[(function(t,e){"use strict";var i=t("./counter"),n=cc.Class({name:"cc.PerfCounter",extends:i,ctor:function(t,e,i){this._time=i},start:function(t){this._time=t},end:function(t){this._value=t-this._time,this._average(this._value)},tick:function(){this.end(),this.start()},frame:function(t){var e=t,i=e-this._time;this._total++,i>(this._opts.average||1e3)&&(this._value=1e3*this._total/i,this._total=0,this._time=e,this._average(this._value))}});e.exports=n}),{"./counter":283}],285:[(function(t,e){"use strict";var i,n=new(((i=t("../platform/js"))&&i.__esModule?i:{default:i}).default.Pool)(2);function r(t){this.count=0,this.limit=t,this.datas={},this.head=null,this.tail=null}n.get=function(){return this._get()||{key:null,value:null,prev:null,next:null}},r.prototype.moveToHead=function(t){t.next=this.head,t.prev=null,null!==this.head&&(this.head.prev=t),this.head=t,null===this.tail&&(this.tail=t),this.count++,this.datas[t.key]=t},r.prototype.put=function(t,e){var i=n.get();if(i.key=t,i.value=e,this.count>=this.limit){var r=this.tail;delete this.datas[r.key],this.count--,this.tail=r.prev,this.tail.next=null,r.prev=null,r.next=null,n.put(r)}this.moveToHead(i)},r.prototype.remove=function(t){null!==t.prev?t.prev.next=t.next:this.head=t.next,null!==t.next?t.next.prev=t.prev:this.tail=t.prev,delete this.datas[t.key],this.count--},r.prototype.get=function(t){var e=this.datas[t];return e?(this.remove(e),this.moveToHead(e),e.value):null},r.prototype.clear=function(){this.count=0,this.datas={},this.head=null,this.tail=null},r.prototype.has=function(t){return!!this.datas[t]},r.prototype.delete=function(t){var e=this.datas[t];this.remove(e)};var a=new r(100),s={BASELINE_RATIO:.26,MIDDLE_RATIO:.37,BASELINE_OFFSET:0,label_wordRex:/([a-zA-Z0-9\xc4\xd6\xdc\xe4\xf6\xfc\xdf\xe9\xe8\xe7\xe0\xf9\xea\xe2\xee\xf4\xfb\u0430-\u044f\u0410-\u042f\u0401\u0451]+|\S)/,label_symbolRex:/^[!,.:;'}\]%\?>\u3001\u2018\u201c\u300b\uff1f\u3002\uff0c\uff01]/,label_lastWordRex:/([a-zA-Z0-9\xc4\xd6\xdc\xe4\xf6\xfc\xdf\xe9\xe8\xe7\xe0\xf9\xea\xe2\xee\xf4\xfb\u0430\xed\xec\xcd\xcc\xef\xc1\xc0\xe1\xe0\xc9\xc8\xd2\xd3\xf2\xf3\u0150\u0151\xd9\xda\u0170\xfa\u0171\xf1\xd1\xe6\xc6\u0153\u0152\xc3\xc2\xe3\xd4\xf5\u011b\u0161\u010d\u0159\u017e\xfd\xe1\xed\xe9\xf3\xfa\u016f\u0165\u010f\u0148\u011a\u0160\u010c\u0158\u017d\xc1\xcd\xc9\xd3\xda\u0164\u017c\u017a\u015b\xf3\u0144\u0142\u0119\u0107\u0105\u017b\u0179\u015a\xd3\u0143\u0141\u0118\u0106\u0104-\u044f\u0410-\u042f\u0401\u0451]+|\S)$/,label_lastEnglish:/[a-zA-Z0-9\xc4\xd6\xdc\xe4\xf6\xfc\xdf\xe9\xe8\xe7\xe0\xf9\xea\xe2\xee\xf4\xfb\u0430\xed\xec\xcd\xcc\xef\xc1\xc0\xe1\xe0\xc9\xc8\xd2\xd3\xf2\xf3\u0150\u0151\xd9\xda\u0170\xfa\u0171\xf1\xd1\xe6\xc6\u0153\u0152\xc3\xc2\xe3\xd4\xf5\u011b\u0161\u010d\u0159\u017e\xfd\xe1\xed\xe9\xf3\xfa\u016f\u0165\u010f\u0148\u011a\u0160\u010c\u0158\u017d\xc1\xcd\xc9\xd3\xda\u0164\u017c\u017a\u015b\xf3\u0144\u0142\u0119\u0107\u0105\u017b\u0179\u015a\xd3\u0143\u0141\u0118\u0106\u0104-\u044f\u0410-\u042f\u0401\u0451]+$/,label_firstEnglish:/^[a-zA-Z0-9\xc4\xd6\xdc\xe4\xf6\xfc\xdf\xe9\xe8\xe7\xe0\xf9\xea\xe2\xee\xf4\xfb\u0430\xed\xec\xcd\xcc\xef\xc1\xc0\xe1\xe0\xc9\xc8\xd2\xd3\xf2\xf3\u0150\u0151\xd9\xda\u0170\xfa\u0171\xf1\xd1\xe6\xc6\u0153\u0152\xc3\xc2\xe3\xd4\xf5\u011b\u0161\u010d\u0159\u017e\xfd\xe1\xed\xe9\xf3\xfa\u016f\u0165\u010f\u0148\u011a\u0160\u010c\u0158\u017d\xc1\xcd\xc9\xd3\xda\u0164\u017c\u017a\u015b\xf3\u0144\u0142\u0119\u0107\u0105\u017b\u0179\u015a\xd3\u0143\u0141\u0118\u0106\u0104-\u044f\u0410-\u042f\u0401\u0451]/,highSurrogateRex:/[\uD800-\uDBFF]/,lowSurrogateRex:/[\uDC00-\uDFFF]/,label_wrapinspection:!0,__CHINESE_REG:/^[\u4E00-\u9FFF\u3400-\u4DFF]+$/,__JAPANESE_REG:/[\u3000-\u303F]|[\u3040-\u309F]|[\u30A0-\u30FF]|[\uFF00-\uFFEF]|[\u4E00-\u9FAF]|[\u2605-\u2606]|[\u2190-\u2195]|\u203B/g,__KOREAN_REG:/^[\u1100-\u11FF]|[\u3130-\u318F]|[\uA960-\uA97F]|[\uAC00-\uD7AF]|[\uD7B0-\uD7FF]+$/,isUnicodeCJK:function(t){return this.__CHINESE_REG.test(t)||this.__JAPANESE_REG.test(t)||this.__KOREAN_REG.test(t)},isUnicodeSpace:function(t){return(t=t.charCodeAt(0))>=9&&t<=13||32===t||133===t||160===t||5760===t||t>=8192&&t<=8202||8232===t||8233===t||8239===t||8287===t||12288===t},safeMeasureText:function(t,e,i){var n=(i||t.font)+"\ud83c\udfae"+e,r=a.get(n);if(null!==r)return r;var s=t.measureText(e),o=s&&s.width||0;return a.put(n,o),o},_safeSubstring:function(t,e,i){var n=e,r=i,a=t[e];if(this.lowSurrogateRex.test(a)&&n--,void 0!==i)if(i-1!==e){var s=t[i-1];this.highSurrogateRex.test(s)&&r--}else this.highSurrogateRex.test(a)&&r++;return t.substring(n,r)},fragmentText:function(t,e,i,n){var r=[];if(0===t.length||i<0)return r.push(""),r;for(var a=t;e>i&&a.length>1;){for(var s=a.length*(i/e)|0,o=this._safeSubstring(a,s),c=e-n(o),l=o,u=0,h=0;c>i&&h++<10;)s*=i/c,s|=0,c=e-n(o=this._safeSubstring(a,s));for(h=0;c<=i&&h++<10;){if(o){var f=this.label_wordRex.exec(o);u=f?f[0].length:1,l=o}s+=u,c=e-n(o=this._safeSubstring(a,s))}0==(s-=u)?(s=1,l=this._safeSubstring(a,1)):1===s&&this.highSurrogateRex.test(a[0])&&(s=2,l=this._safeSubstring(a,2));var d,_=this._safeSubstring(a,0,s);this.label_wrapinspection&&this.label_symbolRex.test(l||o)&&(0==(s-=(d=this.label_lastWordRex.exec(_))?d[0].length:0)&&(s=1),l=this._safeSubstring(a,s),_=this._safeSubstring(a,0,s)),this.label_firstEnglish.test(l)&&(d=this.label_lastEnglish.exec(_))&&_!==d[0]&&(s-=d[0].length,l=this._safeSubstring(a,s),_=this._safeSubstring(a,0,s)),0===r.length?r.push(_):(_=_.trimLeft()).length>0&&r.push(_),e=n(a=l||o)}return 0===r.length?r.push(a):(a=a.trimLeft()).length>0&&r.push(a),r}};cc.textUtils=e.exports=s}),{"../platform/js":214}],286:[(function(t,e){"use strict";var i=t("../assets/CCTexture2D"),n={loadImage:function(t,e,i){cc.assertID(t,3103);var n=cc.assetManager.assets.get(t);if(n)return n.loaded?(e&&e.call(i,null,n),n):(n.once("load",(function(){e&&e.call(i,null,n)}),i),n);cc.assetManager.loadRemote(t,(function(t,n){e&&e.call(i,t,n)}))},cacheImage:function(t,e){if(t&&e){var n=new i;return n.initWithElement(e),cc.assetManager.assets.add(t,n),n}},postLoadTexture:function(t,e){t.loaded?e&&e():t.nativeUrl?cc.assetManager.loadNativeFile(t,(function(i,n){i||(t._nativeAsset=n),e&&e(i)})):e&&e()}};e.exports=n}),{"../assets/CCTexture2D":108}],287:[(function(t,e){"use strict";var i=t("./node-unit"),n=t("./node-mem-pool");e.exports={NodeMemPool:new n(i)}}),{"./node-mem-pool":289,"./node-unit":290}],288:[(function(t,e){"use strict";var i=function(t){this._unitClass=t,this._pool=[],this._findOrder=[]},n=i.prototype;n._initNative=function(){this._nativeMemPool=new renderer.MemPool},n._buildUnit=function(t){return new this._unitClass(t,this)},n._destroyUnit=function(t){this._pool[t]=null;for(var e=0,i=this._findOrder.length;e<i;e++){var n=this._findOrder[e];if(n&&n.unitID==t){this._findOrder.splice(e,1);break}}},n._findUnitID=function(){for(var t=0,e=this._pool;e[t];)t++;return t},n.pop=function(){for(var t=null,e=0,i=this._findOrder,n=this._pool,r=i.length;e<r;e++){var a=i[e];if(a&&a.hasSpace()){t=a;break}}if(!t){var s=this._findUnitID();t=this._buildUnit(s),n[s]=t,i.push(t),e=i.length-1}var o=i[0];return o!==t&&(i[0]=t,i[e]=o),t.pop()},n.push=function(t){var e=this._pool[t.unitID];return e.push(t.index),this._findOrder.length>1&&e.isAllFree()&&this._destroyUnit(t.unitID),e},e.exports=i}),{}],289:[(function(t,e){"use strict";var i,n=t("./mem-pool"),r=function(t){n.call(this,t)};(i=function(){}).prototype=n.prototype;var a=r.prototype=new i;a._initNative=function(){this._nativeMemPool=new renderer.NodeMemPool},a._destroyUnit=function(t){n.prototype._destroyUnit.call(this,t)},e.exports=r}),{"./mem-pool":288}],290:[(function(t,e){"use strict";var i,n=t("../../value-types/utils"),r=(Uint32Array,10*n.FLOAT_BYTES),a=16*n.FLOAT_BYTES,s=16*n.FLOAT_BYTES,o=(Uint32Array,Uint32Array,Int32Array,Uint8Array,Uint8Array,Uint32Array,n.FLOAT_BYTES,t("./unit-base")),c=function(t,e){o.call(this,t,e);var i=this._contentNum;this.trsList=new n.FLOAT_ARRAY_TYPE(10*i),this.localMatList=new n.FLOAT_ARRAY_TYPE(16*i),this.worldMatList=new n.FLOAT_ARRAY_TYPE(16*i);for(var c=0;c<i;c++){var l=this._spacesData[c];l.trs=new n.FLOAT_ARRAY_TYPE(this.trsList.buffer,c*r,10),l.localMat=new n.FLOAT_ARRAY_TYPE(this.localMatList.buffer,c*a,16),l.worldMat=new n.FLOAT_ARRAY_TYPE(this.worldMatList.buffer,c*s,16)}};(i=function(){}).prototype=o.prototype,c.prototype=new i,e.exports=c}),{"../../value-types/utils":300,"./unit-base":291}],291:[(function(t,e){"use strict";var i=function(t,e,i){i=i||128,this.unitID=t,this._memPool=e,this._data=new Uint16Array(2),this._data[0]=0,this._data[1]=0,this._contentNum=i,this._signData=new Uint16Array(2*this._contentNum),this._spacesData=[];for(var n=0;n<i;n++){var r=2*n;this._signData[r+0]=n+1,this._signData[r+1]=0,this._spacesData[n]={index:n,unitID:t}}this._signData[2*(i-1)]=65535},n=i.prototype;n.hasSpace=function(){return 65535!==this._data[0]},n.isAllFree=function(){return 0==this._data[1]},n.pop=function(){var t=this._data[0];if(65535===t)return null;var e=t,i=2*e,n=this._spacesData[e];return this._signData[i+1]=1,this._data[0]=this._signData[i+0],this._data[1]++,n},n.push=function(t){var e=2*t;this._signData[e+1]=0,this._signData[e+0]=this._data[0],this._data[0]=t,this._data[1]--},n.dump=function(){for(var t=0,e=this._data[0],i="";65535!=e;)t++,i+=e+"->",e=this._signData[2*e+0];for(var n=0,r="",a=this._contentNum,s=0;s<a;s++)1==this._signData[2*s+1]&&(n++,r+=s+"->");var o=t+n;console.log("unitID:",this.unitID,"spaceNum:",t,"calc using num:",n,"store using num:",this._data[1],"calc total num:",o,"actually total num:",this._contentNum),console.log("free info:",i),console.log("using info:",r),n!=this._data[1]&&cc.error("using num error","calc using num:",n,"store using num:",this._data[1]),t+n!=this._contentNum&&cc.error("total num error","calc total num:",o,"actually total num:",this._contentNum)},e.exports=i}),{}],292:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=s(t("./value-type")),r=s(t("../platform/CCClass")),a=s(t("../utils/misc"));function s(t){return t&&t.__esModule?t:{default:t}}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,i){return e&&o(t.prototype,e),i&&o(t,i),t}var l=(function(t){var e,i;function n(e,i,n,r){var a;return void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=255),(a=t.call(this)||this)._val=0,"object"==typeof e&&(i=e.g,n=e.b,r=e.a,e=e.r),a._val=(r<<24>>>0)+(n<<16)+(i<<8)+(0|e),a}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i,n.copy=function(t,e){return t.r=e.r,t.g=e.g,t.b=e.b,t.a=e.a,t},n.clone=function(t){return new n(t.r,t.g,t.b,t.a)},n.set=function(t,e,i,n,r){return void 0===e&&(e=255),void 0===i&&(i=255),void 0===n&&(n=255),void 0===r&&(r=255),t.r=e,t.g=i,t.b=n,t.a=r,t},n.fromHex=function(t,e){var i=(e>>24)/255,n=(e>>16&255)/255,r=(e>>8&255)/255,a=(255&e)/255;return t.r=i,t.g=n,t.b=r,t.a=a,t},n.fromHEX=function(t,e){return e=0===e.indexOf("#")?e.substring(1):e,t.r=parseInt(e.substr(0,2),16)||0,t.g=parseInt(e.substr(2,2),16)||0,t.b=parseInt(e.substr(4,2),16)||0,t.a=parseInt(e.substr(6,2),16)||255,t._val=(t.a<<24>>>0)+(t.b<<16)+(t.g<<8)+t.r,t},n.add=function(t,e,i){return t.r=e.r+i.r,t.g=e.g+i.g,t.b=e.b+i.b,t.a=e.a+i.a,t},n.subtract=function(t,e,i){return t.r=e.r-i.r,t.g=e.g-i.g,t.b=e.b-i.b,t.a=e.a-i.a,t},n.multiply=function(t,e,i){return t.r=e.r*i.r,t.g=e.g*i.g,t.b=e.b*i.b,t.a=e.a*i.a,t},n.divide=function(t,e,i){return t.r=e.r/i.r,t.g=e.g/i.g,t.b=e.b/i.b,t.a=e.a/i.a,t},n.scale=function(t,e,i){return t.r=e.r*i,t.g=e.g*i,t.b=e.b*i,t.a=e.a*i,t},n.lerp=function(t,e,i,n){var r=e.r,a=e.g,s=e.b,o=e.a;return t.r=r+n*(i.r-r),t.g=a+n*(i.g-a),t.b=s+n*(i.b-s),t.a=o+n*(i.a-o),t},n.toArray=function(t,e,i){void 0===i&&(i=0);var r=e instanceof n||e.a>1?1/255:1;return t[i+0]=e.r*r,t[i+1]=e.g*r,t[i+2]=e.b*r,t[i+3]=e.a*r,t},n.fromArray=function(t,e,i){return void 0===i&&(i=0),e.r=255*t[i+0],e.g=255*t[i+1],e.b=255*t[i+2],e.a=255*t[i+3],e},n.premultiplyAlpha=function(t,e){var i=e.a/255;return t.r=e.r*i,t.g=e.g*i,t.b=e.b*i,t._fastSetA(e.a),t},c(n,null,[{key:"WHITE",get:function(){return new n(255,255,255,255)}},{key:"BLACK",get:function(){return new n(0,0,0,255)}},{key:"TRANSPARENT",get:function(){return new n(0,0,0,0)}},{key:"GRAY",get:function(){return new n(127.5,127.5,127.5)}},{key:"RED",get:function(){return new n(255,0,0)}},{key:"GREEN",get:function(){return new n(0,255,0)}},{key:"BLUE",get:function(){return new n(0,0,255)}},{key:"YELLOW",get:function(){return new n(255,235,4)}},{key:"ORANGE",get:function(){return new n(255,127,0)}},{key:"CYAN",get:function(){return new n(0,255,255)}},{key:"MAGENTA",get:function(){return new n(255,0,255)}}]);var r=n.prototype;return r.clone=function(){var t=new n;return t._val=this._val,t},r.equals=function(t){return t&&this._val===t._val},r.lerp=function(t,e,i){i=i||new n;var r=this.r,a=this.g,s=this.b,o=this.a;return i.r=r+(t.r-r)*e,i.g=a+(t.g-a)*e,i.b=s+(t.b-s)*e,i.a=o+(t.a-o)*e,i},r.toString=function(){return"rgba("+this.r.toFixed()+", "+this.g.toFixed()+", "+this.b.toFixed()+", "+this.a.toFixed()+")"},r.getR=function(){return 255&this._val},r.setR=function(t){return t=~~a.default.clampf(t,0,255),this._val=(4294967040&this._val|t)>>>0,this},r.getG=function(){return(65280&this._val)>>8},r.setG=function(t){return t=~~a.default.clampf(t,0,255),this._val=(4294902015&this._val|t<<8)>>>0,this},r.getB=function(){return(16711680&this._val)>>16},r.setB=function(t){return t=~~a.default.clampf(t,0,255),this._val=(4278255615&this._val|t<<16)>>>0,this},r.getA=function(){return(4278190080&this._val)>>>24},r.setA=function(t){return t=~~a.default.clampf(t,0,255),this._val=(16777215&this._val|t<<24)>>>0,this},r.toCSS=function(t){return t&&"rgba"!==t?"rgb"===t?"rgb("+this.r+","+this.g+","+this.b+")":"#"+this.toHEX(t):"rgba("+this.r+","+this.g+","+this.b+","+(this.a/255).toFixed(2)+")"},r.fromHEX=function(t){t=0===t.indexOf("#")?t.substring(1):t;var e=parseInt(t.substr(0,2),16)||0,i=parseInt(t.substr(2,2),16)||0,n=parseInt(t.substr(4,2),16)||0,r=parseInt(t.substr(6,2),16)||255;return this._val=(r<<24>>>0)+(n<<16)+(i<<8)+e,this},r.toHEX=function(t){var e=[(this.r<16?"0":"")+this.r.toString(16),(this.g<16?"0":"")+this.g.toString(16),(this.b<16?"0":"")+this.b.toString(16)];return"#rgb"===t?(e[0]=e[0][0],e[1]=e[1][0],e[2]=e[2][0]):"#rrggbbaa"===t&&e.push((this.a<16?"0":"")+this.a.toString(16)),e.join("")},r.toRGBValue=function(){return 16777215&this._val},r.fromHSV=function(t,e,i){var n,r,a;if(0===e)n=r=a=i;else if(0===i)n=r=a=0;else{1===t&&(t=0),t*=6;var s=Math.floor(t),o=t-s,c=i*(1-e),l=i*(1-e*o),u=i*(1-e*(1-o));switch(s){case 0:n=i,r=u,a=c;break;case 1:n=l,r=i,a=c;break;case 2:n=c,r=i,a=u;break;case 3:n=c,r=l,a=i;break;case 4:n=u,r=c,a=i;break;case 5:n=i,r=c,a=l}}return n*=255,r*=255,a*=255,this._val=(this.a<<24>>>0)+(a<<16)+(r<<8)+(0|n),this},r.toHSV=function(){var t=this.r/255,e=this.g/255,i=this.b/255,n={h:0,s:0,v:0},r=Math.max(t,e,i),a=Math.min(t,e,i),s=0;return n.v=r,n.s=r?(r-a)/r:0,n.s?(s=r-a,n.h=t===r?(e-i)/s:e===r?2+(i-t)/s:4+(t-e)/s,n.h/=6,n.h<0&&(n.h+=1)):n.h=0,n},r.set=function(t){return t._val?this._val=t._val:(this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a),this},r._fastSetA=function(t){this._val=(16777215&this._val|t<<24)>>>0},r.multiply=function(t){var e=(255&this._val)*t.r>>8,i=(65280&this._val)*t.g>>8,n=(16711680&this._val)*t.b>>8,r=((4278190080&this._val)>>>8)*t.a;return this._val=4278190080&r|16711680&n|65280&i|255&e,this},c(n,[{key:"r",get:function(){return this.getR()},set:function(t){this.setR(t)}},{key:"g",get:function(){return this.getG()},set:function(t){this.setG(t)}},{key:"b",get:function(){return this.getB()},set:function(t){this.setB(t)}},{key:"a",get:function(){return this.getA()},set:function(t){this.setA(t)}}]),n})(n.default);i.default=l,l.div=l.divide,l.sub=l.subtract,l.mul=l.multiply,l.WHITE_R=l.WHITE,l.BLACK_R=l.BLACK,l.TRANSPARENT_R=l.TRANSPARENT,l.GRAY_R=l.GRAY,l.RED_R=l.RED,l.GREEN_R=l.GREEN,l.BLUE_R=l.BLUE,l.YELLOW_R=l.YELLOW,l.ORANGE_R=l.ORANGE,l.CYAN_R=l.CYAN,l.MAGENTA_R=l.MAGENTA,r.default.fastDefine("cc.Color",l,{r:0,g:0,b:0,a:255}),cc.Color=l,cc.color=function(t,e,i,n){return"string"==typeof t?(new l).fromHEX(t):"object"==typeof t?new l(t.r,t.g,t.b,t.a):new l(t,e,i,n)},e.exports=i.default}),{"../platform/CCClass":193,"../utils/misc":278,"./value-type":301}],293:[(function(t,e,i){"use strict";i.__esModule=!0;var n={Vec2:!0,Vec3:!0,Vec4:!0,Mat4:!0,Mat3:!0,Rect:!0,Size:!0,Color:!0,Quat:!0,Trs:!0};i.Trs=i.Quat=i.Color=i.Size=i.Rect=i.Mat3=i.Mat4=i.Vec4=i.Vec3=i.Vec2=void 0;var r=p(t("./vec2"));i.Vec2=r.default;var a=p(t("./vec3"));i.Vec3=a.default;var s=p(t("./vec4"));i.Vec4=s.default;var o=p(t("./mat4"));i.Mat4=o.default;var c=p(t("./mat3"));i.Mat3=c.default;var l=p(t("./rect"));i.Rect=l.default;var u=p(t("./size"));i.Size=u.default;var h=p(t("./color"));i.Color=h.default;var f=p(t("./quat"));i.Quat=f.default;var d=p(t("./trs"));i.Trs=d.default;var _=t("./utils");function p(t){return t&&t.__esModule?t:{default:t}}Object.keys(_).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(n,t)||(i[t]=_[t]))})),cc.math=e.exports}),{"./color":292,"./mat3":294,"./mat4":295,"./quat":296,"./rect":297,"./size":298,"./trs":299,"./utils":300,"./vec2":302,"./vec3":303,"./vec4":304}],294:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=t("../value-types/utils"),a=(n=t("./vec3"))&&n.__esModule?n:{default:n},s=(function(){function t(t,e,i,n,a,s,o,c,l){if(void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===a&&(a=1),void 0===s&&(s=0),void 0===o&&(o=0),void 0===c&&(c=0),void 0===l&&(l=1),this.m=void 0,t instanceof r.FLOAT_ARRAY_TYPE)this.m=t;else{this.m=new r.FLOAT_ARRAY_TYPE(9);var u=this.m;u[0]=t,u[1]=e,u[2]=i,u[3]=n,u[4]=a,u[5]=s,u[6]=o,u[7]=c,u[8]=l}}return t.create=function(e,i,n,r,a,s,o,c,l){return void 0===e&&(e=1),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===a&&(a=1),void 0===s&&(s=0),void 0===o&&(o=0),void 0===c&&(c=0),void 0===l&&(l=1),new t(e,i,n,r,a,s,o,c,l)},t.clone=function(e){var i=e.m;return new t(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8])},t.copy=function(t,e){return t.m.set(e.m),t},t.set=function(t,e,i,n,r,a,s,o,c,l){var u=t.m;return u[0]=e,u[1]=i,u[2]=n,u[3]=r,u[4]=a,u[5]=s,u[6]=o,u[7]=c,u[8]=l,t},t.identity=function(t){var e=t.m;return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,t},t.transpose=function(t,e){var i=e.m,n=t.m;if(t===e){var r=i[1],a=i[2],s=i[5];n[1]=i[3],n[2]=i[6],n[3]=r,n[5]=i[7],n[6]=a,n[7]=s}else n[0]=i[0],n[1]=i[3],n[2]=i[6],n[3]=i[1],n[4]=i[4],n[5]=i[7],n[6]=i[2],n[7]=i[5],n[8]=i[8];return t},t.invert=function(t,e){var i=e.m,n=t.m,r=i[0],a=i[1],s=i[2],o=i[3],c=i[4],l=i[5],u=i[6],h=i[7],f=i[8],d=f*c-l*h,_=-f*o+l*u,p=h*o-c*u,m=r*d+a*_+s*p;return m?(m=1/m,n[0]=d*m,n[1]=(-f*a+s*h)*m,n[2]=(l*a-s*c)*m,n[3]=_*m,n[4]=(f*r-s*u)*m,n[5]=(-l*r+s*o)*m,n[6]=p*m,n[7]=(-h*r+a*u)*m,n[8]=(c*r-a*o)*m,t):t},t.adjoint=function(t,e){var i=e.m,n=t.m,r=i[0],a=i[1],s=i[2],o=i[3],c=i[4],l=i[5],u=i[6],h=i[7],f=i[8];return n[0]=c*f-l*h,n[1]=s*h-a*f,n[2]=a*l-s*c,n[3]=l*u-o*f,n[4]=r*f-s*u,n[5]=s*o-r*l,n[6]=o*h-c*u,n[7]=a*u-r*h,n[8]=r*c-a*o,t},t.determinant=function(t){var e=t.m,i=e[0],n=e[1],r=e[2],a=e[3],s=e[4],o=e[5],c=e[6],l=e[7],u=e[8];return i*(u*s-o*l)+n*(-u*a+o*c)+r*(l*a-s*c)},t.multiply=function(t,e,i){var n=e.m,r=i.m,a=t.m,s=n[0],o=n[1],c=n[2],l=n[3],u=n[4],h=n[5],f=n[6],d=n[7],_=n[8],p=r[0],m=r[1],v=r[2],g=r[3],y=r[4],T=r[5],b=r[6],E=r[7],A=r[8];return a[0]=p*s+m*l+v*f,a[1]=p*o+m*u+v*d,a[2]=p*c+m*h+v*_,a[3]=g*s+y*l+T*f,a[4]=g*o+y*u+T*d,a[5]=g*c+y*h+T*_,a[6]=b*s+E*l+A*f,a[7]=b*o+E*u+A*d,a[8]=b*c+E*h+A*_,t},t.multiplyMat4=function(t,e,i){var n=e.m,r=i.m,a=t.m,s=n[0],o=n[1],c=n[2],l=n[3],u=n[4],h=n[5],f=n[6],d=n[7],_=n[8],p=r[0],m=r[1],v=r[2],g=r[4],y=r[5],T=r[6],b=r[8],E=r[9],A=r[10];return a[0]=p*s+m*l+v*f,a[1]=p*o+m*u+v*d,a[2]=p*c+m*h+v*_,a[3]=g*s+y*l+T*f,a[4]=g*o+y*u+T*d,a[5]=g*c+y*h+T*_,a[6]=b*s+E*l+A*f,a[7]=b*o+E*u+A*d,a[8]=b*c+E*h+A*_,t},t.translate=function(t,e,i){var n=e.m,r=t.m,a=n[0],s=n[1],o=n[2],c=n[3],l=n[4],u=n[5],h=n[6],f=n[7],d=n[8],_=i.x,p=i.y;return r[0]=a,r[1]=s,r[2]=o,r[3]=c,r[4]=l,r[5]=u,r[6]=_*a+p*c+h,r[7]=_*s+p*l+f,r[8]=_*o+p*u+d,t},t.rotate=function(t,e,i){var n=e.m,r=t.m,a=n[0],s=n[1],o=n[2],c=n[3],l=n[4],u=n[5],h=n[6],f=n[7],d=n[8],_=Math.sin(i),p=Math.cos(i);return r[0]=p*a+_*c,r[1]=p*s+_*l,r[2]=p*o+_*u,r[3]=p*c-_*a,r[4]=p*l-_*s,r[5]=p*u-_*o,r[6]=h,r[7]=f,r[8]=d,t},t.scale=function(t,e,i){var n=i.x,r=i.y,a=e.m,s=t.m;return s[0]=n*a[0],s[1]=n*a[1],s[2]=n*a[2],s[3]=r*a[3],s[4]=r*a[4],s[5]=r*a[5],s[6]=a[6],s[7]=a[7],s[8]=a[8],t},t.fromMat4=function(t,e){var i=e.m,n=t.m;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[4],n[4]=i[5],n[5]=i[6],n[6]=i[8],n[7]=i[9],n[8]=i[10],t},t.fromTranslation=function(t,e){var i=t.m;return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=1,i[5]=0,i[6]=e.x,i[7]=e.y,i[8]=1,t},t.fromRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e),r=t.m;return r[0]=n,r[1]=i,r[2]=0,r[3]=-i,r[4]=n,r[5]=0,r[6]=0,r[7]=0,r[8]=1,t},t.fromScaling=function(t,e){var i=t.m;return i[0]=e.x,i[1]=0,i[2]=0,i[3]=0,i[4]=e.y,i[5]=0,i[6]=0,i[7]=0,i[8]=1,t},t.fromQuat=function(t,e){var i=t.m,n=e.x,r=e.y,a=e.z,s=e.w,o=n+n,c=r+r,l=a+a,u=n*o,h=r*o,f=r*c,d=a*o,_=a*c,p=a*l,m=s*o,v=s*c,g=s*l;return i[0]=1-f-p,i[3]=h-g,i[6]=d+v,i[1]=h+g,i[4]=1-u-p,i[7]=_-m,i[2]=d-v,i[5]=_+m,i[8]=1-u-f,t},t.fromViewUp=function(e,i,n){var s,o,c;return(s=new a.default(0,1,0),o=new a.default,c=new a.default,function(e,i,n){return a.default.lengthSqr(i)<r.EPSILON*r.EPSILON?(t.identity(e),e):(n=n||s,a.default.normalize(o,a.default.cross(o,n,i)),a.default.lengthSqr(o)<r.EPSILON*r.EPSILON?(t.identity(e),e):(a.default.cross(c,i,o),t.set(e,o.x,o.y,o.z,c.x,c.y,c.z,i.x,i.y,i.z),e))})(e,i,n)},t.normalFromMat4=function(t,e){var i=e.m,n=t.m,r=i[0],a=i[1],s=i[2],o=i[3],c=i[4],l=i[5],u=i[6],h=i[7],f=i[8],d=i[9],_=i[10],p=i[11],m=i[12],v=i[13],g=i[14],y=i[15],T=r*l-a*c,b=r*u-s*c,E=r*h-o*c,A=a*u-s*l,C=a*h-o*l,x=s*h-o*u,S=f*v-d*m,w=f*g-_*m,M=f*y-p*m,R=d*g-_*v,I=d*y-p*v,O=_*y-p*g,D=T*O-b*I+E*R+A*M-C*w+x*S;return D?(D=1/D,n[0]=(l*O-u*I+h*R)*D,n[1]=(u*M-c*O-h*w)*D,n[2]=(c*I-l*M+h*S)*D,n[3]=(s*I-a*O-o*R)*D,n[4]=(r*O-s*M+o*w)*D,n[5]=(a*M-r*I-o*S)*D,n[6]=(v*x-g*C+y*A)*D,n[7]=(g*E-m*x-y*b)*D,n[8]=(m*C-v*E+y*T)*D,t):t},t.frob=function(t){var e=t.m;return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))},t.add=function(t,e,i){var n=e.m,r=i.m,a=t.m;return a[0]=n[0]+r[0],a[1]=n[1]+r[1],a[2]=n[2]+r[2],a[3]=n[3]+r[3],a[4]=n[4]+r[4],a[5]=n[5]+r[5],a[6]=n[6]+r[6],a[7]=n[7]+r[7],a[8]=n[8]+r[8],t},t.subtract=function(t,e,i){var n=e.m,r=i.m,a=t.m;return a[0]=n[0]-r[0],a[1]=n[1]-r[1],a[2]=n[2]-r[2],a[3]=n[3]-r[3],a[4]=n[4]-r[4],a[5]=n[5]-r[5],a[6]=n[6]-r[6],a[7]=n[7]-r[7],a[8]=n[8]-r[8],t},t.multiplyScalar=function(t,e,i){var n=e.m,r=t.m;return r[0]=n[0]*i,r[1]=n[1]*i,r[2]=n[2]*i,r[3]=n[3]*i,r[4]=n[4]*i,r[5]=n[5]*i,r[6]=n[6]*i,r[7]=n[7]*i,r[8]=n[8]*i,t},t.multiplyScalarAndAdd=function(t,e,i,n){var r=e.m,a=i.m,s=t.m;return s[0]=r[0]+a[0]*n,s[1]=r[1]+a[1]*n,s[2]=r[2]+a[2]*n,s[3]=r[3]+a[3]*n,s[4]=r[4]+a[4]*n,s[5]=r[5]+a[5]*n,s[6]=r[6]+a[6]*n,s[7]=r[7]+a[7]*n,s[8]=r[8]+a[8]*n,t},t.exactEquals=function(t,e){var i=t.m,n=e.m;return i[0]===n[0]&&i[1]===n[1]&&i[2]===n[2]&&i[3]===n[3]&&i[4]===n[4]&&i[5]===n[5]&&i[6]===n[6]&&i[7]===n[7]&&i[8]===n[8]},t.equals=function(t,e){var i=t.m,n=e.m,a=i[0],s=i[1],o=i[2],c=i[3],l=i[4],u=i[5],h=i[6],f=i[7],d=i[8],_=n[0],p=n[1],m=n[2],v=n[3],g=n[4],y=n[5],T=n[6],b=n[7],E=n[8];return Math.abs(a-_)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(s-p)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(o-m)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(c-v)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(l-g)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(u-y)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(h-T)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(T))&&Math.abs(f-b)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(b))&&Math.abs(d-E)<=r.EPSILON*Math.max(1,Math.abs(d),Math.abs(E))},t.toArray=function(t,e,i){void 0===i&&(i=0);for(var n=e.m,r=0;r<9;r++)t[i+r]=n[r];return t},t.fromArray=function(t,e,i){void 0===i&&(i=0);for(var n=t.m,r=0;r<9;r++)n[r]=e[i+r];return t},t.prototype.toString=function(){var t=this.m;return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},t})();i.default=s,s.sub=s.subtract,s.mul=s.multiply,s.IDENTITY=Object.freeze(new s),cc.Mat3=s,e.exports=i.default}),{"../value-types/utils":300,"./vec3":303}],295:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=l(t("./value-type")),r=l(t("../platform/CCClass")),a=l(t("./vec3")),s=l(t("./quat")),o=t("./utils"),c=l(t("./mat3"));function l(t){return t&&t.__esModule?t:{default:t}}var u=0,h=0,f=0,d=0,_=0,p=0,m=0,v=0,g=0,y=0,T=0,b=0,E=0,A=0,C=0,x=0,S=(function(t){var e,i;i=t,(e=r).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var n=r.prototype;function r(e,i,n,r,a,s,c,l,u,h,f,d,_,p,m,v){var g;if(void 0===e&&(e=1),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===a&&(a=0),void 0===s&&(s=1),void 0===c&&(c=0),void 0===l&&(l=0),void 0===u&&(u=0),void 0===h&&(h=0),void 0===f&&(f=1),void 0===d&&(d=0),void 0===_&&(_=0),void 0===p&&(p=0),void 0===m&&(m=0),void 0===v&&(v=1),(g=t.call(this)||this).m=void 0,e instanceof o.FLOAT_ARRAY_TYPE)g.m=e;else{g.m=new o.FLOAT_ARRAY_TYPE(16);var y=g.m;y[0]=e,y[1]=i,y[2]=n,y[3]=r,y[4]=a,y[5]=s,y[6]=c,y[7]=l,y[8]=u,y[9]=h,y[10]=f,y[11]=d,y[12]=_,y[13]=p,y[14]=m,y[15]=v}return g}return n.mul=function(t,e){return r.multiply(e||new r,this,t)},n.mulScalar=function(t,e){r.multiplyScalar(e||new r,this,t)},n.sub=function(t,e){r.subtract(e||new r,this,t)},r.clone=function(t){var e=t.m;return new r(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},r.copy=function(t,e){var i=t.m,n=e.m;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],t},r.set=function(t,e,i,n,r,a,s,o,c,l,u,h,f,d,_,p,m){var v=t.m;return v[0]=e,v[1]=i,v[2]=n,v[3]=r,v[4]=a,v[5]=s,v[6]=o,v[7]=c,v[8]=l,v[9]=u,v[10]=h,v[11]=f,v[12]=d,v[13]=_,v[14]=p,v[15]=m,t},r.identity=function(t){var e=t.m;return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,t},r.transpose=function(t,e){var i=t.m,n=e.m;if(t===e){var r=n[1],a=n[2],s=n[3],o=n[6],c=n[7],l=n[11];i[1]=n[4],i[2]=n[8],i[3]=n[12],i[4]=r,i[6]=n[9],i[7]=n[13],i[8]=a,i[9]=o,i[11]=n[14],i[12]=s,i[13]=c,i[14]=l}else i[0]=n[0],i[1]=n[4],i[2]=n[8],i[3]=n[12],i[4]=n[1],i[5]=n[5],i[6]=n[9],i[7]=n[13],i[8]=n[2],i[9]=n[6],i[10]=n[10],i[11]=n[14],i[12]=n[3],i[13]=n[7],i[14]=n[11],i[15]=n[15];return t},r.invert=function(t,e){var i=e.m;u=i[0],h=i[1],f=i[2],d=i[3],_=i[4],p=i[5],m=i[6],v=i[7],g=i[8],y=i[9],T=i[10],b=i[11],E=i[12],A=i[13],C=i[14],x=i[15];var n=u*p-h*_,r=u*m-f*_,a=u*v-d*_,s=h*m-f*p,o=h*v-d*p,c=f*v-d*m,l=g*A-y*E,S=g*C-T*E,w=g*x-b*E,M=y*C-T*A,R=y*x-b*A,I=T*x-b*C,O=n*I-r*R+a*M+s*w-o*S+c*l;if(0===O)return null;O=1/O;var D=t.m;return D[0]=(p*I-m*R+v*M)*O,D[1]=(f*R-h*I-d*M)*O,D[2]=(A*c-C*o+x*s)*O,D[3]=(T*o-y*c-b*s)*O,D[4]=(m*w-_*I-v*S)*O,D[5]=(u*I-f*w+d*S)*O,D[6]=(C*a-E*c-x*r)*O,D[7]=(g*c-T*a+b*r)*O,D[8]=(_*R-p*w+v*l)*O,D[9]=(h*w-u*R-d*l)*O,D[10]=(E*o-A*a+x*n)*O,D[11]=(y*a-g*o-b*n)*O,D[12]=(p*S-_*M-m*l)*O,D[13]=(u*M-h*S+f*l)*O,D[14]=(A*r-E*s-C*n)*O,D[15]=(g*s-y*r+T*n)*O,t},r.determinant=function(t){var e=t.m;return u=e[0],h=e[1],f=e[2],d=e[3],_=e[4],p=e[5],m=e[6],v=e[7],g=e[8],y=e[9],T=e[10],b=e[11],E=e[12],A=e[13],C=e[14],x=e[15],(u*p-h*_)*(T*x-b*C)-(u*m-f*_)*(y*x-b*A)+(u*v-d*_)*(y*C-T*A)+(h*m-f*p)*(g*x-b*E)-(h*v-d*p)*(g*C-T*E)+(f*v-d*m)*(g*A-y*E)},r.multiply=function(t,e,i){var n=t.m,r=e.m,a=i.m;u=r[0],h=r[1],f=r[2],d=r[3],_=r[4],p=r[5],m=r[6],v=r[7],g=r[8],y=r[9],T=r[10],b=r[11],E=r[12],A=r[13],C=r[14],x=r[15];var s=a[0],o=a[1],c=a[2],l=a[3];return n[0]=s*u+o*_+c*g+l*E,n[1]=s*h+o*p+c*y+l*A,n[2]=s*f+o*m+c*T+l*C,n[3]=s*d+o*v+c*b+l*x,s=a[4],o=a[5],c=a[6],l=a[7],n[4]=s*u+o*_+c*g+l*E,n[5]=s*h+o*p+c*y+l*A,n[6]=s*f+o*m+c*T+l*C,n[7]=s*d+o*v+c*b+l*x,s=a[8],o=a[9],c=a[10],l=a[11],n[8]=s*u+o*_+c*g+l*E,n[9]=s*h+o*p+c*y+l*A,n[10]=s*f+o*m+c*T+l*C,n[11]=s*d+o*v+c*b+l*x,s=a[12],o=a[13],c=a[14],l=a[15],n[12]=s*u+o*_+c*g+l*E,n[13]=s*h+o*p+c*y+l*A,n[14]=s*f+o*m+c*T+l*C,n[15]=s*d+o*v+c*b+l*x,t},r.transform=function(t,e,i){var n=i.x,r=i.y,a=i.z,s=t.m,o=e.m;return e===t?(s[12]=o[0]*n+o[4]*r+o[8]*a+o[12],s[13]=o[1]*n+o[5]*r+o[9]*a+o[13],s[14]=o[2]*n+o[6]*r+o[10]*a+o[14],s[15]=o[3]*n+o[7]*r+o[11]*a+o[15]):(u=o[0],h=o[1],f=o[2],d=o[3],_=o[4],p=o[5],m=o[6],v=o[7],g=o[8],y=o[9],T=o[10],b=o[11],E=o[12],A=o[13],C=o[14],x=o[15],s[0]=u,s[1]=h,s[2]=f,s[3]=d,s[4]=_,s[5]=p,s[6]=m,s[7]=v,s[8]=g,s[9]=y,s[10]=T,s[11]=b,s[12]=u*n+_*r+g*a+o[12],s[13]=h*n+p*r+y*a+o[13],s[14]=f*n+m*r+T*a+o[14],s[15]=d*n+v*r+b*a+o[15]),t},r.translate=function(t,e,i){var n=t.m,r=e.m;return e===t?(n[12]+=i.x,n[13]+=i.y,n[14]+=i.z):(n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]+=i.x,n[13]+=i.y,n[14]+=i.z,n[15]=r[15]),t},r.scale=function(t,e,i){var n=i.x,r=i.y,a=i.z,s=t.m,o=e.m;return s[0]=o[0]*n,s[1]=o[1]*n,s[2]=o[2]*n,s[3]=o[3]*n,s[4]=o[4]*r,s[5]=o[5]*r,s[6]=o[6]*r,s[7]=o[7]*r,s[8]=o[8]*a,s[9]=o[9]*a,s[10]=o[10]*a,s[11]=o[11]*a,s[12]=o[12],s[13]=o[13],s[14]=o[14],s[15]=o[15],t},r.rotate=function(t,e,i,n){var r=n.x,a=n.y,s=n.z,c=Math.sqrt(r*r+a*a+s*s);if(Math.abs(c)<o.EPSILON)return null;r*=c=1/c,a*=c,s*=c;var l=Math.sin(i),E=Math.cos(i),A=1-E,C=e.m;u=C[0],h=C[1],f=C[2],d=C[3],_=C[4],p=C[5],m=C[6],v=C[7],g=C[8],y=C[9],T=C[10],b=C[11];var x=r*r*A+E,S=a*r*A+s*l,w=s*r*A-a*l,M=r*a*A-s*l,R=a*a*A+E,I=s*a*A+r*l,O=r*s*A+a*l,D=a*s*A-r*l,P=s*s*A+E,L=t.m;return L[0]=u*x+_*S+g*w,L[1]=h*x+p*S+y*w,L[2]=f*x+m*S+T*w,L[3]=d*x+v*S+b*w,L[4]=u*M+_*R+g*I,L[5]=h*M+p*R+y*I,L[6]=f*M+m*R+T*I,L[7]=d*M+v*R+b*I,L[8]=u*O+_*D+g*P,L[9]=h*O+p*D+y*P,L[10]=f*O+m*D+T*P,L[11]=d*O+v*D+b*P,e!==t&&(L[12]=C[12],L[13]=C[13],L[14]=C[14],L[15]=C[15]),t},r.rotateX=function(t,e,i){var n=t.m,r=e.m,a=Math.sin(i),s=Math.cos(i),o=r[4],c=r[5],l=r[6],u=r[7],h=r[8],f=r[9],d=r[10],_=r[11];return e!==t&&(n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15]),n[4]=o*s+h*a,n[5]=c*s+f*a,n[6]=l*s+d*a,n[7]=u*s+_*a,n[8]=h*s-o*a,n[9]=f*s-c*a,n[10]=d*s-l*a,n[11]=_*s-u*a,t},r.rotateY=function(t,e,i){var n=t.m,r=e.m,a=Math.sin(i),s=Math.cos(i),o=r[0],c=r[1],l=r[2],u=r[3],h=r[8],f=r[9],d=r[10],_=r[11];return e!==t&&(n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15]),n[0]=o*s-h*a,n[1]=c*s-f*a,n[2]=l*s-d*a,n[3]=u*s-_*a,n[8]=o*a+h*s,n[9]=c*a+f*s,n[10]=l*a+d*s,n[11]=u*a+_*s,t},r.rotateZ=function(t,e,i){var n=e.m,r=t.m,a=Math.sin(i),s=Math.cos(i),o=e.m[0],c=e.m[1],l=e.m[2],u=e.m[3],h=e.m[4],f=e.m[5],d=e.m[6],_=e.m[7];return e!==t&&(r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15]),r[0]=o*s+h*a,r[1]=c*s+f*a,r[2]=l*s+d*a,r[3]=u*s+_*a,r[4]=h*s-o*a,r[5]=f*s-c*a,r[6]=d*s-l*a,r[7]=_*s-u*a,t},r.fromTranslation=function(t,e){var i=t.m;return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,t},r.fromScaling=function(t,e){var i=t.m;return i[0]=e.x,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=e.y,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=e.z,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,t},r.fromRotation=function(t,e,i){var n=i.x,r=i.y,a=i.z,s=Math.sqrt(n*n+r*r+a*a);if(Math.abs(s)<o.EPSILON)return null;n*=s=1/s,r*=s,a*=s;var c=Math.sin(e),l=Math.cos(e),u=1-l,h=t.m;return h[0]=n*n*u+l,h[1]=r*n*u+a*c,h[2]=a*n*u-r*c,h[3]=0,h[4]=n*r*u-a*c,h[5]=r*r*u+l,h[6]=a*r*u+n*c,h[7]=0,h[8]=n*a*u+r*c,h[9]=r*a*u-n*c,h[10]=a*a*u+l,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,t},r.fromXRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e),r=t.m;return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=n,r[6]=i,r[7]=0,r[8]=0,r[9]=-i,r[10]=n,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,t},r.fromYRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e),r=t.m;return r[0]=n,r[1]=0,r[2]=-i,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=i,r[9]=0,r[10]=n,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,t},r.fromZRotation=function(t,e){var i=Math.sin(e),n=Math.cos(e),r=t.m;return r[0]=n,r[1]=i,r[2]=0,r[3]=0,r[4]=-i,r[5]=n,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,t},r.fromRT=function(t,e,i){var n=e.x,r=e.y,a=e.z,s=e.w,o=n+n,c=r+r,l=a+a,u=n*o,h=n*c,f=n*l,d=r*c,_=r*l,p=a*l,m=s*o,v=s*c,g=s*l,y=t.m;return y[0]=1-(d+p),y[1]=h+g,y[2]=f-v,y[3]=0,y[4]=h-g,y[5]=1-(u+p),y[6]=_+m,y[7]=0,y[8]=f+v,y[9]=_-m,y[10]=1-(u+d),y[11]=0,y[12]=i.x,y[13]=i.y,y[14]=i.z,y[15]=1,t},r.getTranslation=function(t,e){var i=e.m;return t.x=i[12],t.y=i[13],t.z=i[14],t},r.getScaling=function(t,e){var i=e.m,n=M.m,r=n[0]=i[0],a=n[1]=i[1],s=n[2]=i[2],o=n[3]=i[4],l=n[4]=i[5],u=n[5]=i[6],h=n[6]=i[8],f=n[7]=i[9],d=n[8]=i[10];return t.x=Math.sqrt(r*r+a*a+s*s),t.y=Math.sqrt(o*o+l*l+u*u),t.z=Math.sqrt(h*h+f*f+d*d),c.default.determinant(M)<0&&(t.x*=-1),t},r.getRotation=function(t,e){var i=e.m,n=i[0]+i[5]+i[10],r=0;return n>0?(r=2*Math.sqrt(n+1),t.w=.25*r,t.x=(i[6]-i[9])/r,t.y=(i[8]-i[2])/r,t.z=(i[1]-i[4])/r):i[0]>i[5]&&i[0]>i[10]?(r=2*Math.sqrt(1+i[0]-i[5]-i[10]),t.w=(i[6]-i[9])/r,t.x=.25*r,t.y=(i[1]+i[4])/r,t.z=(i[8]+i[2])/r):i[5]>i[10]?(r=2*Math.sqrt(1+i[5]-i[0]-i[10]),t.w=(i[8]-i[2])/r,t.x=(i[1]+i[4])/r,t.y=.25*r,t.z=(i[6]+i[9])/r):(r=2*Math.sqrt(1+i[10]-i[0]-i[5]),t.w=(i[1]-i[4])/r,t.x=(i[8]+i[2])/r,t.y=(i[6]+i[9])/r,t.z=.25*r),t},r.toRTS=function(t,e,i,n){var r=t.m,o=M.m;n.x=a.default.set(w,r[0],r[1],r[2]).mag(),o[0]=r[0]/n.x,o[1]=r[1]/n.x,o[2]=r[2]/n.x,n.y=a.default.set(w,r[4],r[5],r[6]).mag(),o[3]=r[4]/n.y,o[4]=r[5]/n.y,o[5]=r[6]/n.y,n.z=a.default.set(w,r[8],r[9],r[10]).mag(),o[6]=r[8]/n.z,o[7]=r[9]/n.z,o[8]=r[10]/n.z,c.default.determinant(M)<0&&(n.x*=-1,o[0]*=-1,o[1]*=-1,o[2]*=-1),s.default.fromMat3(e,M),a.default.set(i,r[12],r[13],r[14])},r.fromRTS=function(t,e,i,n){var r=e.x,a=e.y,s=e.z,o=e.w,c=r+r,l=a+a,u=s+s,h=r*c,f=r*l,d=r*u,_=a*l,p=a*u,m=s*u,v=o*c,g=o*l,y=o*u,T=n.x,b=n.y,E=n.z,A=t.m;return A[0]=(1-(_+m))*T,A[1]=(f+y)*T,A[2]=(d-g)*T,A[3]=0,A[4]=(f-y)*b,A[5]=(1-(h+m))*b,A[6]=(p+v)*b,A[7]=0,A[8]=(d+g)*E,A[9]=(p-v)*E,A[10]=(1-(h+_))*E,A[11]=0,A[12]=i.x,A[13]=i.y,A[14]=i.z,A[15]=1,t},r.fromRTSOrigin=function(t,e,i,n,r){var a=e.x,s=e.y,o=e.z,c=e.w,l=a+a,u=s+s,h=o+o,f=a*l,d=a*u,_=a*h,p=s*u,m=s*h,v=o*h,g=c*l,y=c*u,T=c*h,b=n.x,E=n.y,A=n.z,C=r.x,x=r.y,S=r.z,w=t.m;return w[0]=(1-(p+v))*b,w[1]=(d+T)*b,w[2]=(_-y)*b,w[3]=0,w[4]=(d-T)*E,w[5]=(1-(f+v))*E,w[6]=(m+g)*E,w[7]=0,w[8]=(_+y)*A,w[9]=(m-g)*A,w[10]=(1-(f+p))*A,w[11]=0,w[12]=i.x+C-(w[0]*C+w[4]*x+w[8]*S),w[13]=i.y+x-(w[1]*C+w[5]*x+w[9]*S),w[14]=i.z+S-(w[2]*C+w[6]*x+w[10]*S),w[15]=1,t},r.fromQuat=function(t,e){var i=e.x,n=e.y,r=e.z,a=e.w,s=i+i,o=n+n,c=r+r,l=i*s,u=n*s,h=n*o,f=r*s,d=r*o,_=r*c,p=a*s,m=a*o,v=a*c,g=t.m;return g[0]=1-h-_,g[1]=u+v,g[2]=f-m,g[3]=0,g[4]=u-v,g[5]=1-l-_,g[6]=d+p,g[7]=0,g[8]=f+m,g[9]=d-p,g[10]=1-l-h,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,t},r.frustum=function(t,e,i,n,r,a,s){var o=1/(i-e),c=1/(r-n),l=1/(a-s),u=t.m;return u[0]=2*a*o,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=2*a*c,u[6]=0,u[7]=0,u[8]=(i+e)*o,u[9]=(r+n)*c,u[10]=(s+a)*l,u[11]=-1,u[12]=0,u[13]=0,u[14]=s*a*2*l,u[15]=0,t},r.perspective=function(t,e,i,n,r){var a=1/Math.tan(e/2),s=1/(n-r),o=t.m;return o[0]=a/i,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=a,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=(r+n)*s,o[11]=-1,o[12]=0,o[13]=0,o[14]=2*r*n*s,o[15]=0,t},r.ortho=function(t,e,i,n,r,a,s){var o=1/(e-i),c=1/(n-r),l=1/(a-s),u=t.m;return u[0]=-2*o,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*c,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*l,u[11]=0,u[12]=(e+i)*o,u[13]=(r+n)*c,u[14]=(s+a)*l,u[15]=1,t},r.lookAt=function(t,e,i,n){var r=e.x,a=e.y,s=e.z,o=n.x,c=n.y,l=n.z,u=r-i.x,h=a-i.y,f=s-i.z,d=1/Math.sqrt(u*u+h*h+f*f),_=c*(f*=d)-l*(h*=d),p=l*(u*=d)-o*f,m=o*h-c*u,v=h*(m*=d=1/Math.sqrt(_*_+p*p+m*m))-f*(p*=d),g=f*(_*=d)-u*m,y=u*p-h*_,T=t.m;return T[0]=_,T[1]=v,T[2]=u,T[3]=0,T[4]=p,T[5]=g,T[6]=h,T[7]=0,T[8]=m,T[9]=y,T[10]=f,T[11]=0,T[12]=-(_*r+p*a+m*s),T[13]=-(v*r+g*a+y*s),T[14]=-(u*r+h*a+f*s),T[15]=1,t},r.inverseTranspose=function(t,e){var i=e.m;u=i[0],h=i[1],f=i[2],d=i[3],_=i[4],p=i[5],m=i[6],v=i[7],g=i[8],y=i[9],T=i[10],b=i[11],E=i[12],A=i[13],C=i[14],x=i[15];var n=u*p-h*_,r=u*m-f*_,a=u*v-d*_,s=h*m-f*p,o=h*v-d*p,c=f*v-d*m,l=g*A-y*E,S=g*C-T*E,w=g*x-b*E,M=y*C-T*A,R=y*x-b*A,I=T*x-b*C,O=n*I-r*R+a*M+s*w-o*S+c*l;return O?(O=1/O,(i=t.m)[0]=(p*I-m*R+v*M)*O,i[1]=(m*w-_*I-v*S)*O,i[2]=(_*R-p*w+v*l)*O,i[3]=0,i[4]=(f*R-h*I-d*M)*O,i[5]=(u*I-f*w+d*S)*O,i[6]=(h*w-u*R-d*l)*O,i[7]=0,i[8]=(A*c-C*o+x*s)*O,i[9]=(C*a-E*c-x*r)*O,i[10]=(E*o-A*a+x*n)*O,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,t):null},r.add=function(t,e,i){var n=t.m,r=e.m,a=i.m;return n[0]=r[0]+a[0],n[1]=r[1]+a[1],n[2]=r[2]+a[2],n[3]=r[3]+a[3],n[4]=r[4]+a[4],n[5]=r[5]+a[5],n[6]=r[6]+a[6],n[7]=r[7]+a[7],n[8]=r[8]+a[8],n[9]=r[9]+a[9],n[10]=r[10]+a[10],n[11]=r[11]+a[11],n[12]=r[12]+a[12],n[13]=r[13]+a[13],n[14]=r[14]+a[14],n[15]=r[15]+a[15],t},r.subtract=function(t,e,i){var n=t.m,r=e.m,a=i.m;return n[0]=r[0]-a[0],n[1]=r[1]-a[1],n[2]=r[2]-a[2],n[3]=r[3]-a[3],n[4]=r[4]-a[4],n[5]=r[5]-a[5],n[6]=r[6]-a[6],n[7]=r[7]-a[7],n[8]=r[8]-a[8],n[9]=r[9]-a[9],n[10]=r[10]-a[10],n[11]=r[11]-a[11],n[12]=r[12]-a[12],n[13]=r[13]-a[13],n[14]=r[14]-a[14],n[15]=r[15]-a[15],t},r.multiplyScalar=function(t,e,i){var n=t.m,r=e.m;return n[0]=r[0]*i,n[1]=r[1]*i,n[2]=r[2]*i,n[3]=r[3]*i,n[4]=r[4]*i,n[5]=r[5]*i,n[6]=r[6]*i,n[7]=r[7]*i,n[8]=r[8]*i,n[9]=r[9]*i,n[10]=r[10]*i,n[11]=r[11]*i,n[12]=r[12]*i,n[13]=r[13]*i,n[14]=r[14]*i,n[15]=r[15]*i,t},r.multiplyScalarAndAdd=function(t,e,i,n){var r=t.m,a=e.m,s=i.m;return r[0]=a[0]+s[0]*n,r[1]=a[1]+s[1]*n,r[2]=a[2]+s[2]*n,r[3]=a[3]+s[3]*n,r[4]=a[4]+s[4]*n,r[5]=a[5]+s[5]*n,r[6]=a[6]+s[6]*n,r[7]=a[7]+s[7]*n,r[8]=a[8]+s[8]*n,r[9]=a[9]+s[9]*n,r[10]=a[10]+s[10]*n,r[11]=a[11]+s[11]*n,r[12]=a[12]+s[12]*n,r[13]=a[13]+s[13]*n,r[14]=a[14]+s[14]*n,r[15]=a[15]+s[15]*n,t},r.strictEquals=function(t,e){var i=t.m,n=e.m;return i[0]===n[0]&&i[1]===n[1]&&i[2]===n[2]&&i[3]===n[3]&&i[4]===n[4]&&i[5]===n[5]&&i[6]===n[6]&&i[7]===n[7]&&i[8]===n[8]&&i[9]===n[9]&&i[10]===n[10]&&i[11]===n[11]&&i[12]===n[12]&&i[13]===n[13]&&i[14]===n[14]&&i[15]===n[15]},r.equals=function(t,e,i){void 0===i&&(i=o.EPSILON);var n=t.m,r=e.m;return Math.abs(n[0]-r[0])<=i*Math.max(1,Math.abs(n[0]),Math.abs(r[0]))&&Math.abs(n[1]-r[1])<=i*Math.max(1,Math.abs(n[1]),Math.abs(r[1]))&&Math.abs(n[2]-r[2])<=i*Math.max(1,Math.abs(n[2]),Math.abs(r[2]))&&Math.abs(n[3]-r[3])<=i*Math.max(1,Math.abs(n[3]),Math.abs(r[3]))&&Math.abs(n[4]-r[4])<=i*Math.max(1,Math.abs(n[4]),Math.abs(r[4]))&&Math.abs(n[5]-r[5])<=i*Math.max(1,Math.abs(n[5]),Math.abs(r[5]))&&Math.abs(n[6]-r[6])<=i*Math.max(1,Math.abs(n[6]),Math.abs(r[6]))&&Math.abs(n[7]-r[7])<=i*Math.max(1,Math.abs(n[7]),Math.abs(r[7]))&&Math.abs(n[8]-r[8])<=i*Math.max(1,Math.abs(n[8]),Math.abs(r[8]))&&Math.abs(n[9]-r[9])<=i*Math.max(1,Math.abs(n[9]),Math.abs(r[9]))&&Math.abs(n[10]-r[10])<=i*Math.max(1,Math.abs(n[10]),Math.abs(r[10]))&&Math.abs(n[11]-r[11])<=i*Math.max(1,Math.abs(n[11]),Math.abs(r[11]))&&Math.abs(n[12]-r[12])<=i*Math.max(1,Math.abs(n[12]),Math.abs(r[12]))&&Math.abs(n[13]-r[13])<=i*Math.max(1,Math.abs(n[13]),Math.abs(r[13]))&&Math.abs(n[14]-r[14])<=i*Math.max(1,Math.abs(n[14]),Math.abs(r[14]))&&Math.abs(n[15]-r[15])<=i*Math.max(1,Math.abs(n[15]),Math.abs(r[15]))},r.adjoint=function(t,e){var i=e.m,n=t.m,r=i[0],a=i[1],s=i[2],o=i[3],c=i[4],l=i[5],u=i[6],h=i[7],f=i[8],d=i[9],_=i[10],p=i[11],m=i[12],v=i[13],g=i[14],y=i[15];return n[0]=l*(_*y-p*g)-d*(u*y-h*g)+v*(u*p-h*_),n[1]=-(a*(_*y-p*g)-d*(s*y-o*g)+v*(s*p-o*_)),n[2]=a*(u*y-h*g)-l*(s*y-o*g)+v*(s*h-o*u),n[3]=-(a*(u*p-h*_)-l*(s*p-o*_)+d*(s*h-o*u)),n[4]=-(c*(_*y-p*g)-f*(u*y-h*g)+m*(u*p-h*_)),n[5]=r*(_*y-p*g)-f*(s*y-o*g)+m*(s*p-o*_),n[6]=-(r*(u*y-h*g)-c*(s*y-o*g)+m*(s*h-o*u)),n[7]=r*(u*p-h*_)-c*(s*p-o*_)+f*(s*h-o*u),n[8]=c*(d*y-p*v)-f*(l*y-h*v)+m*(l*p-h*d),n[9]=-(r*(d*y-p*v)-f*(a*y-o*v)+m*(a*p-o*d)),n[10]=r*(l*y-h*v)-c*(a*y-o*v)+m*(a*h-o*l),n[11]=-(r*(l*p-h*d)-c*(a*p-o*d)+f*(a*h-o*l)),n[12]=-(c*(d*g-_*v)-f*(l*g-u*v)+m*(l*_-u*d)),n[13]=r*(d*g-_*v)-f*(a*g-s*v)+m*(a*_-s*d),n[14]=-(r*(l*g-u*v)-c*(a*g-s*v)+m*(a*u-s*l)),n[15]=r*(l*_-u*d)-c*(a*_-s*d)+f*(a*u-s*l),t},r.toArray=function(t,e,i){void 0===i&&(i=0);for(var n=e.m,r=0;r<16;r++)t[i+r]=n[r];return t},r.fromArray=function(t,e,i){void 0===i&&(i=0);for(var n=t.m,r=0;r<16;r++)n[r]=e[i+r];return t},n.clone=function(){var t=this.m;return new r(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},n.set=function(t){var e=this.m,i=t.m;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],this},n.equals=function(t){return r.strictEquals(this,t)},n.fuzzyEquals=function(t){return r.equals(this,t)},n.toString=function(){var t=this.m;return t?"[\n"+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+",\n"+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+",\n"+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+",\n"+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+"\n]":"[\n1, 0, 0, 0\n0, 1, 0, 0\n0, 0, 1, 0\n0, 0, 0, 1\n]"},n.identity=function(){return r.identity(this)},n.transpose=function(t){return t=t||new r,r.transpose(t,this)},n.invert=function(t){return t=t||new r,r.invert(t,this)},n.adjoint=function(t){return t=t||new r,r.adjoint(t,this)},n.determinant=function(){return r.determinant(this)},n.add=function(t,e){return e=e||new r,r.add(e,this,t)},n.subtract=function(t){return r.subtract(this,this,t)},n.multiply=function(t){return r.multiply(this,this,t)},n.multiplyScalar=function(t){return r.multiplyScalar(this,this,t)},n.translate=function(t,e){return e=e||new r,r.translate(e,this,t)},n.scale=function(t,e){return e=e||new r,r.scale(e,this,t)},n.rotate=function(t,e,i){return i=i||new r,r.rotate(i,this,t,e)},n.getTranslation=function(t){return t=t||new a.default,r.getTranslation(t,this)},n.getScale=function(t){return t=t||new a.default,r.getScaling(t,this)},n.getRotation=function(t){return t=t||new s.default,r.getRotation(t,this)},n.fromRTS=function(t,e,i){return r.fromRTS(this,t,e,i)},n.fromQuat=function(t){return r.fromQuat(this,t)},r})(n.default);i.default=S,S.mul=S.multiply,S.sub=S.subtract,S.IDENTITY=Object.freeze(new S);var w=new a.default,M=new c.default;r.default.fastDefine("cc.Mat4",S,{m00:1,m01:0,m02:0,m03:0,m04:0,m05:1,m06:0,m07:0,m08:0,m09:0,m10:1,m11:0,m12:0,m13:0,m14:0,m15:1});for(var R=function(t){Object.defineProperty(S.prototype,"m"+t,{get:function(){return this.m[t]},set:function(e){this.m[t]=e}})},I=0;I<16;I++)R(I);cc.mat4=function(t,e,i,n,r,a,s,o,c,l,u,h,f,d,_,p){var m=new S(t,e,i,n,r,a,s,o,c,l,u,h,f,d,_,p);return void 0===t&&S.identity(m),m},cc.Mat4=S,e.exports=i.default}),{"../platform/CCClass":193,"./mat3":294,"./quat":296,"./utils":300,"./value-type":301,"./vec3":303}],296:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=c(t("./value-type")),r=c(t("../platform/CCClass")),a=c(t("./vec3")),s=c(t("./mat3")),o=t("./utils");function c(t){return t&&t.__esModule?t:{default:t}}var l=0,u=0,h=0,f=0,d=(function(t){var e,i;i=t,(e=r).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var n=r.prototype;function r(e,i,n,r){var a;return void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=1),(a=t.call(this)||this).x=void 0,a.y=void 0,a.z=void 0,a.w=void 0,e&&"object"==typeof e?(a.x=e.x,a.y=e.y,a.z=e.z,a.w=e.w):(a.x=e,a.y=i,a.z=n,a.w=r),a}return n.mul=function(t,e){return r.multiply(e||new r,this,t)},r.clone=function(t){return new r(t.x,t.y,t.z,t.w)},r.copy=function(t,e){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t},r.set=function(t,e,i,n,r){return t.x=e,t.y=i,t.z=n,t.w=r,t},r.identity=function(t){return t.x=0,t.y=0,t.z=0,t.w=1,t},r.rotationTo=function(t,e,i){var n=a.default.dot(e,i);return n<-.999999?(a.default.cross(m,a.default.RIGHT,e),m.mag()<1e-6&&a.default.cross(m,a.default.UP,e),a.default.normalize(m,m),r.fromAxisAngle(t,m,Math.PI),t):n>.999999?(t.x=0,t.y=0,t.z=0,t.w=1,t):(a.default.cross(m,e,i),t.x=m.x,t.y=m.y,t.z=m.z,t.w=1+n,r.normalize(t,t))},r.getAxisAngle=function(t,e){var i=2*Math.acos(e.w),n=Math.sin(i/2);return 0!==n?(t.x=e.x/n,t.y=e.y/n,t.z=e.z/n):(t.x=1,t.y=0,t.z=0),i},r.multiply=function(t,e,i){return l=e.x*i.w+e.w*i.x+e.y*i.z-e.z*i.y,u=e.y*i.w+e.w*i.y+e.z*i.x-e.x*i.z,h=e.z*i.w+e.w*i.z+e.x*i.y-e.y*i.x,f=e.w*i.w-e.x*i.x-e.y*i.y-e.z*i.z,t.x=l,t.y=u,t.z=h,t.w=f,t},r.multiplyScalar=function(t,e,i){return t.x=e.x*i,t.y=e.y*i,t.z=e.z*i,t.w=e.w*i,t},r.scaleAndAdd=function(t,e,i,n){return t.x=e.x+i.x*n,t.y=e.y+i.y*n,t.z=e.z+i.z*n,t.w=e.w+i.w*n,t},r.rotateX=function(t,e,i){i*=.5;var n=Math.sin(i),r=Math.cos(i);return l=e.x*r+e.w*n,u=e.y*r+e.z*n,h=e.z*r-e.y*n,f=e.w*r-e.x*n,t.x=l,t.y=u,t.z=h,t.w=f,t},r.rotateY=function(t,e,i){i*=.5;var n=Math.sin(i),r=Math.cos(i);return l=e.x*r-e.z*n,u=e.y*r+e.w*n,h=e.z*r+e.x*n,f=e.w*r-e.y*n,t.x=l,t.y=u,t.z=h,t.w=f,t},r.rotateZ=function(t,e,i){i*=.5;var n=Math.sin(i),r=Math.cos(i);return l=e.x*r+e.y*n,u=e.y*r-e.x*n,h=e.z*r+e.w*n,f=e.w*r-e.z*n,t.x=l,t.y=u,t.z=h,t.w=f,t},r.rotateAround=function(t,e,i,n){return r.invert(_,e),a.default.transformQuat(m,i,_),r.fromAxisAngle(_,m,n),r.multiply(t,e,_),t},r.rotateAroundLocal=function(t,e,i,n){return r.fromAxisAngle(_,i,n),r.multiply(t,e,_),t},r.calculateW=function(t,e){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=Math.sqrt(Math.abs(1-e.x*e.x-e.y*e.y-e.z*e.z)),t},r.dot=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w},r.lerp=function(t,e,i,n){return t.x=e.x+n*(i.x-e.x),t.y=e.y+n*(i.y-e.y),t.z=e.z+n*(i.z-e.z),t.w=e.w+n*(i.w-e.w),t},r.slerp=function(t,e,i,n){var r=0,a=0,s=e.x*i.x+e.y*i.y+e.z*i.z+e.w*i.w;if(s<0&&(s=-s,i.x=-i.x,i.y=-i.y,i.z=-i.z,i.w=-i.w),1-s>1e-6){var o=Math.acos(s),c=Math.sin(o);r=Math.sin((1-n)*o)/c,a=Math.sin(n*o)/c}else r=1-n,a=n;return t.x=r*e.x+a*i.x,t.y=r*e.y+a*i.y,t.z=r*e.z+a*i.z,t.w=r*e.w+a*i.w,t},r.sqlerp=function(t,e,i,n,a,s){return r.slerp(_,e,a,s),r.slerp(p,i,n,s),r.slerp(t,_,p,2*s*(1-s)),t},r.invert=function(t,e){var i=e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w,n=i?1/i:0;return t.x=-e.x*n,t.y=-e.y*n,t.z=-e.z*n,t.w=e.w*n,t},r.conjugate=function(t,e){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=e.w,t},r.len=function(t){return Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z+t.w*t.w)},r.lengthSqr=function(t){return t.x*t.x+t.y*t.y+t.z*t.z+t.w*t.w},r.normalize=function(t,e){var i=e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w;return i>0&&(i=1/Math.sqrt(i),t.x=e.x*i,t.y=e.y*i,t.z=e.z*i,t.w=e.w*i),t},r.fromAxes=function(t,e,i,n){return s.default.set(v,e.x,e.y,e.z,i.x,i.y,i.z,n.x,n.y,n.z),r.normalize(t,r.fromMat3(t,v))},r.fromViewUp=function(t,e,i){return s.default.fromViewUp(v,e,i),r.normalize(t,r.fromMat3(t,v))},r.fromAxisAngle=function(t,e,i){i*=.5;var n=Math.sin(i);return t.x=n*e.x,t.y=n*e.y,t.z=n*e.z,t.w=Math.cos(i),t},r.fromAngleZ=function(t,e){return e*=g,t.x=t.y=0,t.z=Math.sin(e),t.w=Math.cos(e),t},r.fromMat3=function(t,e){var i=e.m,n=i[0],r=i[1],a=i[2],s=i[3],o=i[4],c=i[5],l=i[6],u=i[7],h=i[8],f=n+o+h;if(f>0){var d=.5/Math.sqrt(f+1);t.w=.25/d,t.x=(c-u)*d,t.y=(l-a)*d,t.z=(r-s)*d}else if(n>o&&n>h){var _=2*Math.sqrt(1+n-o-h);t.w=(c-u)/_,t.x=.25*_,t.y=(s+r)/_,t.z=(l+a)/_}else if(o>h){var p=2*Math.sqrt(1+o-n-h);t.w=(l-a)/p,t.x=(s+r)/p,t.y=.25*p,t.z=(u+c)/p}else{var m=2*Math.sqrt(1+h-n-o);t.w=(r-s)/m,t.x=(l+a)/m,t.y=(u+c)/m,t.z=.25*m}return t},r.fromEuler=function(t,e,i,n){e*=g,i*=g,n*=g;var r=Math.sin(e),a=Math.cos(e),s=Math.sin(i),o=Math.cos(i),c=Math.sin(n),l=Math.cos(n);return t.x=r*o*l+a*s*c,t.y=a*s*l+r*o*c,t.z=a*o*c-r*s*l,t.w=a*o*l-r*s*c,t},r.toAxisX=function(t,e){var i=2*e.y,n=2*e.z;return t.x=1-i*e.y-n*e.z,t.y=i*e.x+n*e.w,t.z=n*e.x+i*e.w,t},r.toAxisY=function(t,e){var i=2*e.x,n=2*e.y,r=2*e.z;return t.x=n*e.x-r*e.w,t.y=1-i*e.x-r*e.z,t.z=r*e.y+i*e.w,t},r.toAxisZ=function(t,e){var i=2*e.x,n=2*e.y,r=2*e.z;return t.x=r*e.x-n*e.w,t.y=r*e.y-i*e.w,t.z=1-i*e.x-n*e.y,t},r.toEuler=function(t,e,i){var n=e.x,r=e.y,a=e.z,s=e.w,c=0,l=0,u=0,h=n*r+a*s;if(h>.499999)c=0,l=(0,o.toDegree)(2*Math.atan2(n,s)),u=90;else if(h<-.499999)c=0,l=-(0,o.toDegree)(2*Math.atan2(n,s)),u=-90;else{var f=n*n,d=r*r,_=a*a;c=(0,o.toDegree)(Math.atan2(2*n*s-2*r*a,1-2*f-2*_)),l=(0,o.toDegree)(Math.atan2(2*r*s-2*n*a,1-2*d-2*_)),u=(0,o.toDegree)(Math.asin(2*h)),i&&(c=-180*Math.sign(c+1e-6)+c,l=-180*Math.sign(l+1e-6)+l,u=180*Math.sign(u+1e-6)-u)}return t.x=c,t.y=l,t.z=u,t},r.strictEquals=function(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z&&t.w===e.w},r.equals=function(t,e,i){return void 0===i&&(i=o.EPSILON),Math.abs(t.x-e.x)<=i*Math.max(1,Math.abs(t.x),Math.abs(e.x))&&Math.abs(t.y-e.y)<=i*Math.max(1,Math.abs(t.y),Math.abs(e.y))&&Math.abs(t.z-e.z)<=i*Math.max(1,Math.abs(t.z),Math.abs(e.z))&&Math.abs(t.w-e.w)<=i*Math.max(1,Math.abs(t.w),Math.abs(e.w))},r.toArray=function(t,e,i){return void 0===i&&(i=0),t[i+0]=e.x,t[i+1]=e.y,t[i+2]=e.z,t[i+3]=e.w,t},r.fromArray=function(t,e,i){return void 0===i&&(i=0),t.x=e[i+0],t.y=e[i+1],t.z=e[i+2],t.w=e[i+3],t},n.clone=function(){return new r(this.x,this.y,this.z,this.w)},n.set=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},n.equals=function(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},n.toEuler=function(t){return r.toEuler(t,this)},n.fromEuler=function(t){return r.fromEuler(this,t.x,t.y,t.z)},n.lerp=function(t,e,i){return i=i||new r,r.slerp(i,this,t,e),i},n.multiply=function(t){return r.multiply(this,this,t)},n.rotateAround=function(t,e,i,n){return n=n||new r,r.rotateAround(n,t,e,i)},r})(n.default);i.default=d,d.mul=d.multiply,d.scale=d.multiplyScalar,d.mag=d.len,d.IDENTITY=Object.freeze(new d);var _=new d,p=new d,m=new a.default,v=new s.default,g=.5*Math.PI/180;r.default.fastDefine("cc.Quat",d,{x:0,y:0,z:0,w:1}),cc.quat=function(t,e,i,n){return new d(t,e,i,n)},cc.Quat=d,e.exports=i.default}),{"../platform/CCClass":193,"./mat3":294,"./utils":300,"./value-type":301,"./vec3":303}],297:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=o(t("./value-type")),r=o(t("../platform/CCClass")),a=o(t("./vec2")),s=o(t("./size"));function o(t){return t&&t.__esModule?t:{default:t}}function c(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var l=(function(t){var e,i;function n(e,i,n,r){var a;return void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),(a=t.call(this)||this).x=void 0,a.y=void 0,a.width=void 0,a.height=void 0,e&&"object"==typeof e&&(i=e.y,n=e.width,r=e.height,e=e.x),a.x=e||0,a.y=i||0,a.width=n||0,a.height=r||0,a}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i,n.fromMinMax=function(t,e){var i=Math.min(t.x,e.x),r=Math.min(t.y,e.y);return new n(i,r,Math.max(t.x,e.x)-i,Math.max(t.y,e.y)-r)};var r,o,l=n.prototype;return l.clone=function(){return new n(this.x,this.y,this.width,this.height)},l.equals=function(t){return t&&this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height},l.lerp=function(t,e,i){i=i||new n;var r=this.x,a=this.y,s=this.width,o=this.height;return i.x=r+(t.x-r)*e,i.y=a+(t.y-a)*e,i.width=s+(t.width-s)*e,i.height=o+(t.height-o)*e,i},l.set=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},l.intersects=function(t){var e=this.x+this.width,i=this.y+this.height,n=t.x+t.width,r=t.y+t.height;return!(e<t.x||n<this.x||i<t.y||r<this.y)},l.intersection=function(t,e){var i=this.x,n=this.y,r=this.x+this.width,a=this.y+this.height,s=e.x,o=e.y,c=e.x+e.width,l=e.y+e.height;return t.x=Math.max(i,s),t.y=Math.max(n,o),t.width=Math.min(r,c)-t.x,t.height=Math.min(a,l)-t.y,t},l.contains=function(t){return this.x<=t.x&&this.x+this.width>=t.x&&this.y<=t.y&&this.y+this.height>=t.y},l.containsRect=function(t){return this.x<=t.x&&this.x+this.width>=t.x+t.width&&this.y<=t.y&&this.y+this.height>=t.y+t.height},l.union=function(t,e){var i=this.x,n=this.y,r=this.width,a=this.height,s=e.x,o=e.y,c=e.width,l=e.height;return t.x=Math.min(i,s),t.y=Math.min(n,o),t.width=Math.max(i+r,s+c)-t.x,t.height=Math.max(n+a,o+l)-t.y,t},l.transformMat4=function(t,e){var i=this.x,n=this.y,r=i+this.width,a=n+this.height,s=e.m,o=s[0]*i+s[4]*n+s[12],c=s[1]*i+s[5]*n+s[13],l=s[0]*r+s[4]*n+s[12],u=s[1]*r+s[5]*n+s[13],h=s[0]*i+s[4]*a+s[12],f=s[1]*i+s[5]*a+s[13],d=s[0]*r+s[4]*a+s[12],_=s[1]*r+s[5]*a+s[13],p=Math.min(o,l,h,d),m=Math.max(o,l,h,d),v=Math.min(c,u,f,_),g=Math.max(c,u,f,_);return t.x=p,t.y=v,t.width=m-p,t.height=g-v,t},l.toString=function(){return"("+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.width.toFixed(2)+", "+this.height.toFixed(2)+")"},r=n,(o=[{key:"xMin",get:function(){return this.x},set:function(t){this.width+=this.x-t,this.x=t}},{key:"yMin",get:function(){return this.y},set:function(t){this.height+=this.y-t,this.y=t}},{key:"xMax",get:function(){return this.x+this.width},set:function(t){this.width=t-this.x}},{key:"yMax",get:function(){return this.y+this.height},set:function(t){this.height=t-this.y}},{key:"center",get:function(){return new a.default(this.x+.5*this.width,this.y+.5*this.height)},set:function(t){this.x=t.x-.5*this.width,this.y=t.y-.5*this.height}},{key:"origin",get:function(){return new a.default(this.x,this.y)},set:function(t){this.x=t.x,this.y=t.y}},{key:"size",get:function(){return new s.default(this.width,this.height)},set:function(t){this.width=t.width,this.height=t.height}}])&&c(r.prototype,o),n})(n.default);i.default=l,r.default.fastDefine("cc.Rect",l,{x:0,y:0,width:0,height:0}),cc.Rect=l,cc.rect=function(t,e,i,n){return new l(t,e,i,n)},e.exports=i.default}),{"../platform/CCClass":193,"./size":298,"./value-type":301,"./vec2":302}],298:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=a(t("./value-type")),r=a(t("../platform/CCClass"));function a(t){return t&&t.__esModule?t:{default:t}}function s(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var o=(function(t){var e,i,n,r;function a(e,i){var n;return void 0===e&&(e=0),void 0===i&&(i=0),(n=t.call(this)||this).width=void 0,n.height=void 0,e&&"object"==typeof e?(n.width=e.width,n.height=e.height):(n.width=e||0,n.height=i||0),n}i=t,(e=a).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i,n=a,r=[{key:"ZERO",get:function(){return new a}}],null&&s(n.prototype,null),r&&s(n,r);var o=a.prototype;return o.clone=function(){return new a(this.width,this.height)},o.equals=function(t){return t&&this.width===t.width&&this.height===t.height},o.lerp=function(t,e,i){i=i||new a;var n=this.width,r=this.height;return i.width=n+(t.width-n)*e,i.height=r+(t.height-r)*e,i},o.set=function(t){return this.width=t.width,this.height=t.height,this},o.toString=function(){return"("+this.width.toFixed(2)+", "+this.height.toFixed(2)+")"},a})(n.default);i.default=o,o.ZERO_R=o.ZERO,r.default.fastDefine("cc.Size",o,{width:0,height:0}),cc.size=function(t,e){return new o(t,e)},cc.Size=o,e.exports=i.default}),{"../platform/CCClass":193,"./value-type":301}],299:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=(n=t("./quat"))&&n.__esModule?n:{default:n},a=new r.default,s=(function(){function t(){}return t.toRotation=function(t,e){return t.x=e[3],t.y=e[4],t.z=e[5],t.w=e[6],t},t.fromRotation=function(t,e){return t[3]=e.x,t[4]=e.y,t[5]=e.z,t[6]=e.w,t},t.toEuler=function(e,i){return t.toRotation(a,i),r.default.toEuler(e,a),e},t.fromEuler=function(e,i){return r.default.fromEuler(a,i.x,i.y,i.z),t.fromRotation(e,a),e},t.fromEulerNumber=function(e,i,n,s){return r.default.fromEuler(a,i,n,s),t.fromRotation(e,a),e},t.toScale=function(t,e){return t.x=e[7],t.y=e[8],t.z=e[9],t},t.fromScale=function(t,e){return t[7]=e.x,t[8]=e.y,t[9]=e.z,t},t.toPosition=function(t,e){return t.x=e[0],t.y=e[1],t.z=e[2],t},t.fromPosition=function(t,e){return t[0]=e.x,t[1]=e.y,t[2]=e.z,t},t.fromAngleZ=function(e,i){return r.default.fromAngleZ(a,i),t.fromRotation(e,a),e},t.toMat4=function(t,e){var i=e[3],n=e[4],r=e[5],a=e[6],s=i+i,o=n+n,c=r+r,l=i*s,u=i*o,h=i*c,f=n*o,d=n*c,_=r*c,p=a*s,m=a*o,v=a*c,g=e[7],y=e[8],T=e[9],b=t.m;return b[0]=(1-(f+_))*g,b[1]=(u+v)*g,b[2]=(h-m)*g,b[3]=0,b[4]=(u-v)*y,b[5]=(1-(l+_))*y,b[6]=(d+p)*y,b[7]=0,b[8]=(h+m)*T,b[9]=(d-p)*T,b[10]=(1-(l+f))*T,b[11]=0,b[12]=e[0],b[13]=e[1],b[14]=e[2],b[15]=1,t},t})();i.default=s,cc.Trs=s,e.exports=i.default}),{"./quat":296}],300:[(function(t,e,i){"use strict";i.__esModule=!0,i.equals=function(t,e){return Math.abs(t-e)<=a*Math.max(1,Math.abs(t),Math.abs(e))},i.approx=function(t,e,i){return i=i||a,Math.abs(t-e)<=i},i.clamp=function(t,e,i){return t<e?e:t>i?i:t},i.clamp01=function(t){return t<0?0:t>1?1:t},i.lerp=function(t,e,i){return t+(e-t)*i},i.toRadian=function(t){return t*n},i.toDegree=function(t){return t*r},i.randomRange=c,i.randomRangeInt=function(t,e){return Math.floor(c(t,e))},i.pseudoRandom=l,i.pseudoRandomRange=u,i.pseudoRandomRangeInt=function(t,e,i){return Math.floor(u(t,e,i))},i.nextPow2=function(t){return--t,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t},i.repeat=h,i.pingPong=function(t,e){return t=h(t,2*e),e-Math.abs(t-e)},i.inverseLerp=function(t,e,i){return(i-t)/(e-t)},i.sign=function(t){return(t>0)-(t<0)},i.random=i.FLOAT_BYTES=i.FLOAT_ARRAY_TYPE=i.INT_MIN=i.INT_MAX=i.INT_BITS=i.EPSILON=void 0;var n=Math.PI/180,r=180/Math.PI,a=1e-6;i.EPSILON=a,i.INT_BITS=32,i.INT_MAX=2147483647,i.INT_MIN=-1<<31;var s=Float64Array;i.FLOAT_ARRAY_TYPE=s,i.FLOAT_BYTES=8;var o=Math.random;function c(t,e){return Math.random()*(e-t)+t}function l(t){return(t=(9301*t+49297)%233280)/233280}function u(t,e,i){return l(t)*(i-e)+e}function h(t,e){return t-Math.floor(t/e)*e}i.random=o}),{}],301:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=(n=t("../platform/js"))&&n.__esModule?n:{default:n},a=(function(){function t(){}var e=t.prototype;return e.clone=function(){return cc.errorID("0100",r.default.getClassName(this)+".clone"),null},e.equals=function(){return cc.errorID("0100",r.default.getClassName(this)+".equals"),!1},e.lerp=function(){return cc.errorID("0100",r.default.getClassName(this)+".lerp"),this.clone()},e.set=function(){cc.errorID("0100",r.default.getClassName(this)+".set")},e.toString=function(){return""+{}},t})();i.default=a,r.default.setClassName("cc.ValueType",a),cc.ValueType=a,e.exports=i.default}),{"../platform/js":214}],302:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=o(t("./value-type")),r=o(t("../platform/CCClass")),a=o(t("../utils/misc")),s=t("./utils");function o(t){return t&&t.__esModule?t:{default:t}}function c(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var l=0,u=0,h=(function(t){var e,i;i=t,(e=h).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var n,r,o=h.prototype;function h(e,i){var n;return void 0===e&&(e=0),void 0===i&&(i=0),(n=t.call(this)||this).mag=h.prototype.len,n.magSqr=h.prototype.lengthSqr,n.subSelf=h.prototype.subtract,n.mulSelf=h.prototype.multiplyScalar,n.divSelf=h.prototype.divide,n.scaleSelf=h.prototype.multiply,n.negSelf=h.prototype.negate,n.x=void 0,n.y=void 0,n.z=0,e&&"object"==typeof e?(n.x=e.x||0,n.y=e.y||0):(n.x=e||0,n.y=i||0),n}return o.sub=function(t,e){return h.subtract(e||new h,this,t)},o.mul=function(t,e){return h.multiplyScalar(e||new h,this,t)},o.div=function(t,e){return h.multiplyScalar(e||new h,this,1/t)},o.scale=function(t,e){return h.multiply(e||new h,this,t)},o.neg=function(t){return h.negate(t||new h,this)},h.clone=function(t){return new h(t.x,t.y)},h.copy=function(t,e){return t.x=e.x,t.y=e.y,t},h.set=function(t,e,i){return t.x=e,t.y=i,t},h.add=function(t,e,i){return t.x=e.x+i.x,t.y=e.y+i.y,t},h.subtract=function(t,e,i){return t.x=e.x-i.x,t.y=e.y-i.y,t},h.multiply=function(t,e,i){return t.x=e.x*i.x,t.y=e.y*i.y,t},h.divide=function(t,e,i){return t.x=e.x/i.x,t.y=e.y/i.y,t},h.ceil=function(t,e){return t.x=Math.ceil(e.x),t.y=Math.ceil(e.y),t},h.floor=function(t,e){return t.x=Math.floor(e.x),t.y=Math.floor(e.y),t},h.min=function(t,e,i){return t.x=Math.min(e.x,i.x),t.y=Math.min(e.y,i.y),t},h.max=function(t,e,i){return t.x=Math.max(e.x,i.x),t.y=Math.max(e.y,i.y),t},h.round=function(t,e){return t.x=Math.round(e.x),t.y=Math.round(e.y),t},h.multiplyScalar=function(t,e,i){return t.x=e.x*i,t.y=e.y*i,t},h.scaleAndAdd=function(t,e,i,n){return t.x=e.x+i.x*n,t.y=e.y+i.y*n,t},h.distance=function(t,e){return l=e.x-t.x,u=e.y-t.y,Math.sqrt(l*l+u*u)},h.squaredDistance=function(t,e){return l=e.x-t.x,u=e.y-t.y,l*l+u*u},h.len=function(t){return l=t.x,u=t.y,Math.sqrt(l*l+u*u)},h.lengthSqr=function(t){return l=t.x,u=t.y,l*l+u*u},h.negate=function(t,e){return t.x=-e.x,t.y=-e.y,t},h.inverse=function(t,e){return t.x=1/e.x,t.y=1/e.y,t},h.inverseSafe=function(t,e){return l=e.x,u=e.y,Math.abs(l)<s.EPSILON?t.x=0:t.x=1/l,Math.abs(u)<s.EPSILON?t.y=0:t.y=1/u,t},h.normalize=function(t,e){l=e.x,u=e.y;var i=l*l+u*u;return i>0&&(i=1/Math.sqrt(i),t.x=l*i,t.y=u*i),t},h.dot=function(t,e){return t.x*e.x+t.y*e.y},h.cross=function(t,e,i){return t.x=t.y=0,t.z=e.x*i.y-e.y*i.x,t},h.lerp=function(t,e,i,n){return l=e.x,u=e.y,t.x=l+n*(i.x-l),t.y=u+n*(i.y-u),t},h.random=function(t,e){e=e||1;var i=2*(0,s.random)()*Math.PI;return t.x=Math.cos(i)*e,t.y=Math.sin(i)*e,t},h.transformMat3=function(t,e,i){l=e.x,u=e.y;var n=i.m;return t.x=n[0]*l+n[3]*u+n[6],t.y=n[1]*l+n[4]*u+n[7],t},h.transformMat4=function(t,e,i){l=e.x,u=e.y;var n=i.m;return t.x=n[0]*l+n[4]*u+n[12],t.y=n[1]*l+n[5]*u+n[13],t},h.strictEquals=function(t,e){return t.x===e.x&&t.y===e.y},h.equals=function(t,e,i){return void 0===i&&(i=s.EPSILON),Math.abs(t.x-e.x)<=i*Math.max(1,Math.abs(t.x),Math.abs(e.x))&&Math.abs(t.y-e.y)<=i*Math.max(1,Math.abs(t.y),Math.abs(e.y))},h.angle=function(t,e){h.normalize(f,t),h.normalize(d,e);var i=h.dot(f,d);return i>1?0:i<-1?Math.PI:Math.acos(i)},h.toArray=function(t,e,i){return void 0===i&&(i=0),t[i+0]=e.x,t[i+1]=e.y,t},h.fromArray=function(t,e,i){return void 0===i&&(i=0),t.x=e[i+0],t.y=e[i+1],t},n=h,r=[{key:"ONE",get:function(){return new h(1,1)}},{key:"ZERO",get:function(){return new h(0,0)}},{key:"UP",get:function(){return new h(0,1)}},{key:"RIGHT",get:function(){return new h(1,0)}}],null&&c(n.prototype,null),r&&c(n,r),o.clone=function(){return new h(this.x,this.y)},o.set=function(t){return this.x=t.x,this.y=t.y,this},o.equals=function(t){return t&&this.x===t.x&&this.y===t.y},o.fuzzyEquals=function(t,e){return this.x-e<=t.x&&t.x<=this.x+e&&this.y-e<=t.y&&t.y<=this.y+e},o.toString=function(){return"("+this.x.toFixed(2)+", "+this.y.toFixed(2)+")"},o.lerp=function(t,e,i){i=i||new h;var n=this.x,r=this.y;return i.x=n+(t.x-n)*e,i.y=r+(t.y-r)*e,i},o.clampf=function(t,e){return this.x=a.default.clampf(this.x,t.x,e.x),this.y=a.default.clampf(this.y,t.y,e.y),this},o.add=function(t,e){return(e=e||new h).x=this.x+t.x,e.y=this.y+t.y,e},o.addSelf=function(t){return this.x+=t.x,this.y+=t.y,this},o.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},o.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},o.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},o.divide=function(t){return this.x/=t,this.y/=t,this},o.negate=function(){return this.x=-this.x,this.y=-this.y,this},o.dot=function(t){return this.x*t.x+this.y*t.y},o.cross=function(t){return this.x*t.y-this.y*t.x},o.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},o.lengthSqr=function(){return this.x*this.x+this.y*this.y},o.normalizeSelf=function(){var t=this.x*this.x+this.y*this.y;if(1===t)return this;if(0===t)return this;var e=1/Math.sqrt(t);return this.x*=e,this.y*=e,this},o.normalize=function(t){return(t=t||new h).x=this.x,t.y=this.y,t.normalizeSelf(),t},o.angle=function(t){var e=this.magSqr(),i=t.magSqr();if(0===e||0===i)return console.warn("Can't get angle between zero vector"),0;var n=this.dot(t)/Math.sqrt(e*i);return n=a.default.clampf(n,-1,1),Math.acos(n)},o.signAngle=function(t){var e=this.angle(t);return this.cross(t)<0?-e:e},o.rotate=function(t,e){return(e=e||new h).x=this.x,e.y=this.y,e.rotateSelf(t)},o.rotateSelf=function(t){var e=Math.sin(t),i=Math.cos(t),n=this.x;return this.x=i*n-e*this.y,this.y=e*n+i*this.y,this},o.project=function(t){return t.multiplyScalar(this.dot(t)/t.dot(t))},o.transformMat4=function(t,e){return e=e||new h,h.transformMat4(e,this,t),e},o.maxAxis=function(){return Math.max(this.x,this.y)},h})(n.default);i.default=h,h.sub=h.subtract,h.mul=h.multiply,h.scale=h.multiplyScalar,h.mag=h.len,h.squaredMagnitude=h.lengthSqr,h.div=h.divide,h.ONE_R=h.ONE,h.ZERO_R=h.ZERO,h.UP_R=h.UP,h.RIGHT_R=h.RIGHT;var f=new h,d=new h;r.default.fastDefine("cc.Vec2",h,{x:0,y:0}),cc.v2=function(t,e){return new h(t,e)},cc.Vec2=h,e.exports=i.default}),{"../platform/CCClass":193,"../utils/misc":278,"./utils":300,"./value-type":301}],303:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=c(t("./value-type")),r=c(t("../platform/CCClass")),a=c(t("../utils/misc")),s=c(t("./vec2")),o=t("./utils");function c(t){return t&&t.__esModule?t:{default:t}}function l(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var u=0,h=0,f=0,d=(function(t){var e,i;i=t,(e=d).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var n,r,c=d.prototype;function d(e,i,n){var r;return void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),(r=t.call(this)||this).mag=d.prototype.len,r.magSqr=d.prototype.lengthSqr,r.subSelf=d.prototype.subtract,r.mulSelf=d.prototype.multiplyScalar,r.divSelf=d.prototype.divide,r.scaleSelf=d.prototype.multiply,r.negSelf=d.prototype.negate,r.x=void 0,r.y=void 0,r.z=void 0,r.angle=s.default.prototype.angle,r.project=s.default.prototype.project,e&&"object"==typeof e?(r.x=e.x,r.y=e.y,r.z=e.z):(r.x=e,r.y=i,r.z=n),r}return c.sub=function(t,e){return d.subtract(e||new d,this,t)},c.mul=function(t,e){return d.multiplyScalar(e||new d,this,t)},c.div=function(t,e){return d.multiplyScalar(e||new d,this,1/t)},c.scale=function(t,e){return d.multiply(e||new d,this,t)},c.neg=function(t){return d.negate(t||new d,this)},d.zero=function(t){return t.x=0,t.y=0,t.z=0,t},d.clone=function(t){return new d(t.x,t.y,t.z)},d.copy=function(t,e){return t.x=e.x,t.y=e.y,t.z=e.z,t},d.set=function(t,e,i,n){return t.x=e,t.y=i,t.z=n,t},d.add=function(t,e,i){return t.x=e.x+i.x,t.y=e.y+i.y,t.z=e.z+i.z,t},d.subtract=function(t,e,i){return t.x=e.x-i.x,t.y=e.y-i.y,t.z=e.z-i.z,t},d.multiply=function(t,e,i){return t.x=e.x*i.x,t.y=e.y*i.y,t.z=e.z*i.z,t},d.divide=function(t,e,i){return t.x=e.x/i.x,t.y=e.y/i.y,t.z=e.z/i.z,t},d.ceil=function(t,e){return t.x=Math.ceil(e.x),t.y=Math.ceil(e.y),t.z=Math.ceil(e.z),t},d.floor=function(t,e){return t.x=Math.floor(e.x),t.y=Math.floor(e.y),t.z=Math.floor(e.z),t},d.min=function(t,e,i){return t.x=Math.min(e.x,i.x),t.y=Math.min(e.y,i.y),t.z=Math.min(e.z,i.z),t},d.max=function(t,e,i){return t.x=Math.max(e.x,i.x),t.y=Math.max(e.y,i.y),t.z=Math.max(e.z,i.z),t},d.round=function(t,e){return t.x=Math.round(e.x),t.y=Math.round(e.y),t.z=Math.round(e.z),t},d.multiplyScalar=function(t,e,i){return t.x=e.x*i,t.y=e.y*i,t.z=e.z*i,t},d.scaleAndAdd=function(t,e,i,n){return t.x=e.x+i.x*n,t.y=e.y+i.y*n,t.z=e.z+i.z*n,t},d.distance=function(t,e){return u=e.x-t.x,h=e.y-t.y,f=e.z-t.z,Math.sqrt(u*u+h*h+f*f)},d.squaredDistance=function(t,e){return u=e.x-t.x,h=e.y-t.y,f=e.z-t.z,u*u+h*h+f*f},d.len=function(t){return u=t.x,h=t.y,f=t.z,Math.sqrt(u*u+h*h+f*f)},d.lengthSqr=function(t){return u=t.x,h=t.y,f=t.z,u*u+h*h+f*f},d.negate=function(t,e){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t},d.inverse=function(t,e){return t.x=1/e.x,t.y=1/e.y,t.z=1/e.z,t},d.inverseSafe=function(t,e){return u=e.x,h=e.y,f=e.z,Math.abs(u)<o.EPSILON?t.x=0:t.x=1/u,Math.abs(h)<o.EPSILON?t.y=0:t.y=1/h,Math.abs(f)<o.EPSILON?t.z=0:t.z=1/f,t},d.normalize=function(t,e){u=e.x,h=e.y,f=e.z;var i=u*u+h*h+f*f;return i>0&&(i=1/Math.sqrt(i),t.x=u*i,t.y=h*i,t.z=f*i),t},d.dot=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},d.cross=function(t,e,i){var n=e.x,r=e.y,a=e.z,s=i.x,o=i.y,c=i.z;return t.x=r*c-a*o,t.y=a*s-n*c,t.z=n*o-r*s,t},d.lerp=function(t,e,i,n){return t.x=e.x+n*(i.x-e.x),t.y=e.y+n*(i.y-e.y),t.z=e.z+n*(i.z-e.z),t},d.random=function(t,e){e=e||1;var i=2*(0,o.random)()*Math.PI,n=2*(0,o.random)()-1,r=Math.sqrt(1-n*n);return t.x=r*Math.cos(i)*e,t.y=r*Math.sin(i)*e,t.z=n*e,t},d.transformMat4=function(t,e,i){u=e.x,h=e.y,f=e.z;var n=i.m,r=n[3]*u+n[7]*h+n[11]*f+n[15];return r=r?1/r:1,t.x=(n[0]*u+n[4]*h+n[8]*f+n[12])*r,t.y=(n[1]*u+n[5]*h+n[9]*f+n[13])*r,t.z=(n[2]*u+n[6]*h+n[10]*f+n[14])*r,t},d.transformMat4Normal=function(t,e,i){u=e.x,h=e.y,f=e.z;var n=i.m,r=n[3]*u+n[7]*h+n[11]*f;return r=r?1/r:1,t.x=(n[0]*u+n[4]*h+n[8]*f)*r,t.y=(n[1]*u+n[5]*h+n[9]*f)*r,t.z=(n[2]*u+n[6]*h+n[10]*f)*r,t},d.transformMat3=function(t,e,i){u=e.x,h=e.y,f=e.z;var n=i.m;return t.x=u*n[0]+h*n[3]+f*n[6],t.y=u*n[1]+h*n[4]+f*n[7],t.z=u*n[2]+h*n[5]+f*n[8],t},d.transformAffine=function(t,e,i){u=e.x,h=e.y,f=e.z;var n=i.m;return t.x=n[0]*u+n[1]*h+n[2]*f+n[3],t.y=n[4]*u+n[5]*h+n[6]*f+n[7],t.x=n[8]*u+n[9]*h+n[10]*f+n[11],t},d.transformQuat=function(t,e,i){var n=i.w*e.x+i.y*e.z-i.z*e.y,r=i.w*e.y+i.z*e.x-i.x*e.z,a=i.w*e.z+i.x*e.y-i.y*e.x,s=-i.x*e.x-i.y*e.y-i.z*e.z;return t.x=n*i.w+s*-i.x+r*-i.z-a*-i.y,t.y=r*i.w+s*-i.y+a*-i.x-n*-i.z,t.z=a*i.w+s*-i.z+n*-i.y-r*-i.x,t},d.transformRTS=function(t,e,i,n,r){var a=e.x*r.x,s=e.y*r.y,o=e.z*r.z,c=i.w*a+i.y*o-i.z*s,l=i.w*s+i.z*a-i.x*o,u=i.w*o+i.x*s-i.y*a,h=-i.x*a-i.y*s-i.z*o;return t.x=c*i.w+h*-i.x+l*-i.z-u*-i.y+n.x,t.y=l*i.w+h*-i.y+u*-i.x-c*-i.z+n.y,t.z=u*i.w+h*-i.z+c*-i.y-l*-i.x+n.z,t},d.transformInverseRTS=function(t,e,i,n,r){var a=e.x-n.x,s=e.y-n.y,o=e.z-n.z,c=i.w*a-i.y*o+i.z*s,l=i.w*s-i.z*a+i.x*o,u=i.w*o-i.x*s+i.y*a,h=i.x*a+i.y*s+i.z*o;return t.x=(c*i.w+h*i.x+l*i.z-u*i.y)/r.x,t.y=(l*i.w+h*i.y+u*i.x-c*i.z)/r.y,t.z=(u*i.w+h*i.z+c*i.y-l*i.x)/r.z,t},d.rotateX=function(t,e,i,n){u=e.x-i.x,h=e.y-i.y,f=e.z-i.z;var r=Math.cos(n),a=Math.sin(n),s=u,o=h*r-f*a,c=h*a+f*r;return t.x=s+i.x,t.y=o+i.y,t.z=c+i.z,t},d.rotateY=function(t,e,i,n){u=e.x-i.x,h=e.y-i.y,f=e.z-i.z;var r=Math.cos(n),a=Math.sin(n),s=f*a+u*r,o=h,c=f*r-u*a;return t.x=s+i.x,t.y=o+i.y,t.z=c+i.z,t},d.rotateZ=function(t,e,i,n){u=e.x-i.x,h=e.y-i.y,f=e.z-i.z;var r=Math.cos(n),a=Math.sin(n),s=u*r-h*a,o=u*a+h*r,c=f;return t.x=s+i.x,t.y=o+i.y,t.z=c+i.z,t},d.strictEquals=function(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z},d.equals=function(t,e,i){void 0===i&&(i=o.EPSILON);var n=t.x,r=t.y,a=t.z,s=e.x,c=e.y,l=e.z;return Math.abs(n-s)<=i*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(r-c)<=i*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(a-l)<=i*Math.max(1,Math.abs(a),Math.abs(l))},d.angle=function(t,e){d.normalize(_,t),d.normalize(p,e);var i=d.dot(_,p);return i>1?0:i<-1?Math.PI:Math.acos(i)},d.projectOnPlane=function(t,e,i){return d.subtract(t,e,d.project(t,e,i))},d.project=function(t,e,i){var n=d.lengthSqr(i);return n<1e-6?d.set(t,0,0,0):d.multiplyScalar(t,i,d.dot(e,i)/n)},d.toArray=function(t,e,i){return void 0===i&&(i=0),t[i+0]=e.x,t[i+1]=e.y,t[i+2]=e.z,t},d.fromArray=function(t,e,i){return void 0===i&&(i=0),t.x=e[i+0],t.y=e[i+1],t.z=e[i+2],t},n=d,r=[{key:"ONE",get:function(){return new d(1,1,1)}},{key:"ZERO",get:function(){return new d}},{key:"UP",get:function(){return new d(0,1,0)}},{key:"RIGHT",get:function(){return new d(1,0,0)}},{key:"FORWARD",get:function(){return new d(0,0,1)}}],null&&l(n.prototype,null),r&&l(n,r),c.clone=function(){return new d(this.x,this.y,this.z)},c.set=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},c.equals=function(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z},c.fuzzyEquals=function(t,e){return this.x-e<=t.x&&t.x<=this.x+e&&this.y-e<=t.y&&t.y<=this.y+e&&this.z-e<=t.z&&t.z<=this.z+e},c.toString=function(){return"("+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.z.toFixed(2)+")"},c.lerp=function(t,e,i){return i=i||new d,d.lerp(i,this,t,e),i},c.clampf=function(t,e){return this.x=a.default.clampf(this.x,t.x,e.x),this.y=a.default.clampf(this.y,t.y,e.y),this.z=a.default.clampf(this.z,t.z,e.z),this},c.addSelf=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},c.add=function(t,e){return(e=e||new d).x=this.x+t.x,e.y=this.y+t.y,e.z=this.z+t.z,e},c.subtract=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},c.multiplyScalar=function(t){return this.x*=t,this.y*=t,this.z*=t,this},c.multiply=function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this},c.divide=function(t){return this.x/=t,this.y/=t,this.z/=t,this},c.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},c.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},c.cross=function(t,e){return e=e||new d,d.cross(e,this,t),e},c.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},c.lengthSqr=function(){return this.x*this.x+this.y*this.y+this.z*this.z},c.normalizeSelf=function(){return d.normalize(this,this),this},c.normalize=function(t){return t=t||new d,d.normalize(t,this),t},c.transformMat4=function(t,e){return e=e||new d,d.transformMat4(e,this,t),e},c.maxAxis=function(){return Math.max(this.x,this.y,this.z)},c.signAngle=function(t){cc.warnID(1408,"vec3.signAngle","v2.1","cc.v2(selfVector).signAngle(vector)");var e=new s.default(this.x,this.y),i=new s.default(t.x,t.y);return e.signAngle(i)},c.rotate=function(t,e){return cc.warnID(1408,"vec3.rotate","v2.1","cc.v2(selfVector).rotate(radians, out)"),s.default.prototype.rotate.call(this,t,e)},c.rotateSelf=function(t){return cc.warnID(1408,"vec3.rotateSelf","v2.1","cc.v2(selfVector).rotateSelf(radians)"),s.default.prototype.rotateSelf.call(this,t)},d})(n.default);i.default=d,d.sub=d.subtract,d.mul=d.multiply,d.scale=d.multiplyScalar,d.mag=d.len,d.squaredMagnitude=d.lengthSqr,d.div=d.divide,d.ONE_R=d.ONE,d.ZERO_R=d.ZERO,d.UP_R=d.UP,d.RIGHT_R=d.RIGHT,d.FRONT_R=d.FORWARD;var _=new d,p=new d;r.default.fastDefine("cc.Vec3",d,{x:0,y:0,z:0}),cc.v3=function(t,e,i){return new d(t,e,i)},cc.Vec3=d,e.exports=i.default}),{"../platform/CCClass":193,"../utils/misc":278,"./utils":300,"./value-type":301,"./vec2":302}],304:[(function(t,e,i){"use strict";i.__esModule=!0,i.v4=d,i.default=void 0;var n=s(t("../platform/CCClass")),r=s(t("./value-type")),a=t("./utils");function s(t){return t&&t.__esModule?t:{default:t}}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var c=0,l=0,u=0,h=0,f=(function(t){var e,i;i=t,(e=f).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var n,r,s=f.prototype;function f(e,i,n,r){var a;return void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),void 0===r&&(r=0),(a=t.call(this)||this).mag=f.prototype.len,a.magSqr=f.prototype.lengthSqr,a.subSelf=f.prototype.subtract,a.mulSelf=f.prototype.multiplyScalar,a.divSelf=f.prototype.divide,a.scaleSelf=f.prototype.multiply,a.negSelf=f.prototype.negate,a.x=void 0,a.y=void 0,a.z=void 0,a.w=void 0,e&&"object"==typeof e?(a.x=e.x,a.y=e.y,a.z=e.z,a.w=e.w):(a.x=e,a.y=i,a.z=n,a.w=r),a}return s.sub=function(t,e){return f.subtract(e||new f,this,t)},s.mul=function(t,e){return f.multiplyScalar(e||new f,this,t)},s.div=function(t,e){return f.multiplyScalar(e||new f,this,1/t)},s.scale=function(t,e){return f.multiply(e||new f,this,t)},s.neg=function(t){return f.negate(t||new f,this)},f.clone=function(t){return new f(t.x,t.y,t.z,t.w)},f.copy=function(t,e){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t},f.set=function(t,e,i,n,r){return t.x=e,t.y=i,t.z=n,t.w=r,t},f.add=function(t,e,i){return t.x=e.x+i.x,t.y=e.y+i.y,t.z=e.z+i.z,t.w=e.w+i.w,t},f.subtract=function(t,e,i){return t.x=e.x-i.x,t.y=e.y-i.y,t.z=e.z-i.z,t.w=e.w-i.w,t},f.multiply=function(t,e,i){return t.x=e.x*i.x,t.y=e.y*i.y,t.z=e.z*i.z,t.w=e.w*i.w,t},f.divide=function(t,e,i){return t.x=e.x/i.x,t.y=e.y/i.y,t.z=e.z/i.z,t.w=e.w/i.w,t},f.ceil=function(t,e){return t.x=Math.ceil(e.x),t.y=Math.ceil(e.y),t.z=Math.ceil(e.z),t.w=Math.ceil(e.w),t},f.floor=function(t,e){return t.x=Math.floor(e.x),t.y=Math.floor(e.y),t.z=Math.floor(e.z),t.w=Math.floor(e.w),t},f.min=function(t,e,i){return t.x=Math.min(e.x,i.x),t.y=Math.min(e.y,i.y),t.z=Math.min(e.z,i.z),t.w=Math.min(e.w,i.w),t},f.max=function(t,e,i){return t.x=Math.max(e.x,i.x),t.y=Math.max(e.y,i.y),t.z=Math.max(e.z,i.z),t.w=Math.max(e.w,i.w),t},f.round=function(t,e){return t.x=Math.round(e.x),t.y=Math.round(e.y),t.z=Math.round(e.z),t.w=Math.round(e.w),t},f.multiplyScalar=function(t,e,i){return t.x=e.x*i,t.y=e.y*i,t.z=e.z*i,t.w=e.w*i,t},f.scaleAndAdd=function(t,e,i,n){return t.x=e.x+i.x*n,t.y=e.y+i.y*n,t.z=e.z+i.z*n,t.w=e.w+i.w*n,t},f.distance=function(t,e){var i=e.x-t.x,n=e.y-t.y,r=e.z-t.z,a=e.w-t.w;return Math.sqrt(i*i+n*n+r*r+a*a)},f.squaredDistance=function(t,e){var i=e.x-t.x,n=e.y-t.y,r=e.z-t.z,a=e.w-t.w;return i*i+n*n+r*r+a*a},f.len=function(t){return c=t.x,l=t.y,u=t.z,h=t.w,Math.sqrt(c*c+l*l+u*u+h*h)},f.lengthSqr=function(t){return c=t.x,l=t.y,u=t.z,h=t.w,c*c+l*l+u*u+h*h},f.negate=function(t,e){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t},f.inverse=function(t,e){return t.x=1/e.x,t.y=1/e.y,t.z=1/e.z,t.w=1/e.w,t},f.inverseSafe=function(t,e){return c=e.x,l=e.y,u=e.z,h=e.w,Math.abs(c)<a.EPSILON?t.x=0:t.x=1/c,Math.abs(l)<a.EPSILON?t.y=0:t.y=1/l,Math.abs(u)<a.EPSILON?t.z=0:t.z=1/u,Math.abs(h)<a.EPSILON?t.w=0:t.w=1/h,t},f.normalize=function(t,e){c=e.x,l=e.y,u=e.z,h=e.w;var i=c*c+l*l+u*u+h*h;return i>0&&(i=1/Math.sqrt(i),t.x=c*i,t.y=l*i,t.z=u*i,t.w=h*i),t},f.dot=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w},f.lerp=function(t,e,i,n){return t.x=e.x+n*(i.x-e.x),t.y=e.y+n*(i.y-e.y),t.z=e.z+n*(i.z-e.z),t.w=e.w+n*(i.w-e.w),t},f.random=function(t,e){e=e||1;var i=2*(0,a.random)()*Math.PI,n=2*(0,a.random)()-1,r=Math.sqrt(1-n*n);return t.x=r*Math.cos(i)*e,t.y=r*Math.sin(i)*e,t.z=n*e,t.w=0,t},f.transformMat4=function(t,e,i){c=e.x,l=e.y,u=e.z,h=e.w;var n=i.m;return t.x=n[0]*c+n[4]*l+n[8]*u+n[12]*h,t.y=n[1]*c+n[5]*l+n[9]*u+n[13]*h,t.z=n[2]*c+n[6]*l+n[10]*u+n[14]*h,t.w=n[3]*c+n[7]*l+n[11]*u+n[15]*h,t},f.transformAffine=function(t,e,i){c=e.x,l=e.y,u=e.z,h=e.w;var n=i.m;return t.x=n[0]*c+n[1]*l+n[2]*u+n[3]*h,t.y=n[4]*c+n[5]*l+n[6]*u+n[7]*h,t.x=n[8]*c+n[9]*l+n[10]*u+n[11]*h,t.w=e.w,t},f.transformQuat=function(t,e,i){var n=e.x,r=e.y,a=e.z;c=i.x,l=i.y,u=i.z;var s=(h=i.w)*n+l*a-u*r,o=h*r+u*n-c*a,f=h*a+c*r-l*n,d=-c*n-l*r-u*a;return t.x=s*h+d*-c+o*-u-f*-l,t.y=o*h+d*-l+f*-c-s*-u,t.z=f*h+d*-u+s*-l-o*-c,t.w=e.w,t},f.strictEquals=function(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z&&t.w===e.w},f.equals=function(t,e,i){return void 0===i&&(i=a.EPSILON),Math.abs(t.x-e.x)<=i*Math.max(1,Math.abs(t.x),Math.abs(e.x))&&Math.abs(t.y-e.y)<=i*Math.max(1,Math.abs(t.y),Math.abs(e.y))&&Math.abs(t.z-e.z)<=i*Math.max(1,Math.abs(t.z),Math.abs(e.z))&&Math.abs(t.w-e.w)<=i*Math.max(1,Math.abs(t.w),Math.abs(e.w))},f.toArray=function(t,e,i){return void 0===i&&(i=0),t[i+0]=e.x,t[i+1]=e.y,t[i+2]=e.z,t[i+3]=e.w,t},f.fromArray=function(t,e,i){return void 0===i&&(i=0),t.x=e[i+0],t.y=e[i+1],t.z=e[i+2],t.w=e[i+3],t},n=f,r=[{key:"ZERO",get:function(){return new f(0,0,0,0)}},{key:"ONE",get:function(){return new f(1,1,1,1)}},{key:"NEG_ONE",get:function(){return new f(-1,-1,-1,-1)}}],null&&o(n.prototype,null),r&&o(n,r),s.clone=function(){return new f(this.x,this.y,this.z,this.w)},s.set=function(t,e,i,n){return t&&"object"==typeof t?(this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w):(this.x=t||0,this.y=e||0,this.z=i||0,this.w=n||0),this},s.equals=function(t,e){return void 0===e&&(e=a.EPSILON),Math.abs(this.x-t.x)<=e*Math.max(1,Math.abs(this.x),Math.abs(t.x))&&Math.abs(this.y-t.y)<=e*Math.max(1,Math.abs(this.y),Math.abs(t.y))&&Math.abs(this.z-t.z)<=e*Math.max(1,Math.abs(this.z),Math.abs(t.z))&&Math.abs(this.w-t.w)<=e*Math.max(1,Math.abs(this.w),Math.abs(t.w))},s.equals4f=function(t,e,i,n,r){return void 0===r&&(r=a.EPSILON),Math.abs(this.x-t)<=r*Math.max(1,Math.abs(this.x),Math.abs(t))&&Math.abs(this.y-e)<=r*Math.max(1,Math.abs(this.y),Math.abs(e))&&Math.abs(this.z-i)<=r*Math.max(1,Math.abs(this.z),Math.abs(i))&&Math.abs(this.w-n)<=r*Math.max(1,Math.abs(this.w),Math.abs(n))},s.strictEquals=function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},s.strictEquals4f=function(t,e,i,n){return this.x===t&&this.y===e&&this.z===i&&this.w===n},s.lerp=function(t,e){return c=this.x,l=this.y,u=this.z,h=this.w,this.x=c+e*(t.x-c),this.y=l+e*(t.y-l),this.z=u+e*(t.z-u),this.w=h+e*(t.w-h),this},s.toString=function(){return"("+this.x.toFixed(2)+", "+this.y.toFixed(2)+", "+this.z.toFixed(2)+", "+this.w.toFixed(2)+")"},s.clampf=function(t,e){return this.x=(0,a.clamp)(this.x,t.x,e.x),this.y=(0,a.clamp)(this.y,t.y,e.y),this.z=(0,a.clamp)(this.z,t.z,e.z),this.w=(0,a.clamp)(this.w,t.w,e.w),this},s.addSelf=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},s.add=function(t,e){return(e=e||new f).x=this.x+t.x,e.y=this.y+t.y,e.z=this.z+t.z,e.w=this.w+t.w,e},s.subtract=function(t,e){return(e=e||new f).x=this.x-t.x,e.y=this.y-t.y,e.z=this.z-t.z,e.w=this.w-t.w,e},s.multiplyScalar=function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},s.multiply=function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this},s.divide=function(t){return this.x/=t,this.y/=t,this.z/=t,this.w/=t,this},s.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},s.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},s.cross=function(t,e){e=e||new f;var i=this.x,n=this.y,r=this.z,a=t.x,s=t.y,o=t.z;return e.x=n*o-r*s,e.y=r*a-i*o,e.z=i*s-n*a,e},s.len=function(){var t=this.x,e=this.y,i=this.z,n=this.w;return Math.sqrt(t*t+e*e+i*i+n*n)},s.lengthSqr=function(){var t=this.x,e=this.y,i=this.z,n=this.w;return t*t+e*e+i*i+n*n},s.normalizeSelf=function(){return this.normalize(this),this},s.normalize=function(t){t=t||new f,c=this.x,l=this.y,u=this.z,h=this.w;var e=c*c+l*l+u*u+h*h;return e>0&&(e=1/Math.sqrt(e),t.x=c*e,t.y=l*e,t.z=u*e,t.w=h*e),t},s.transformMat4=function(t,e){e=e||new f,c=this.x,l=this.y,u=this.z,h=this.w;var i=t.m;return e.x=i[0]*c+i[4]*l+i[8]*u+i[12]*h,e.y=i[1]*c+i[5]*l+i[9]*u+i[13]*h,e.z=i[2]*c+i[6]*l+i[10]*u+i[14]*h,e.w=i[3]*c+i[7]*l+i[11]*u+i[15]*h,e},s.maxAxis=function(){return Math.max(this.x,this.y,this.z,this.w)},f})(r.default);function d(t,e,i,n){return new f(t,e,i,n)}i.default=f,f.sub=f.subtract,f.mul=f.multiply,f.div=f.divide,f.scale=f.multiplyScalar,f.mag=f.len,f.squaredMagnitude=f.lengthSqr,f.ZERO_R=f.ZERO,f.ONE_R=f.ONE,f.NEG_ONE_R=f.NEG_ONE,n.default.fastDefine("cc.Vec4",f,{x:0,y:0,z:0,w:0}),cc.v4=d,cc.Vec4=f}),{"../platform/CCClass":193,"./utils":300,"./value-type":301}],305:[(function(){"use strict";cc.js}),{}],306:[(function(t){"use strict";t("./core/CCGame"),t("./actions")}),{"./actions":7,"./core/CCGame":59}],307:[(function(t,e){"use strict";var i=t("../compression/zlib.min"),n=t("../core/CCDebug"),r=function(t){var e,i,r,a,s,o,c,l,u,h,f,d,_;for(this.data=t,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},s=null;;){switch(e=this.readUInt32(),l=function(){var t,e;for(e=[],t=0;t<4;++t)e.push(String.fromCharCode(this.data[this.pos++]));return e}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(e);break;case"fcTL":s&&this.animation.frames.push(s),this.pos+=4,s={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},a=this.readUInt16(),r=this.readUInt16()||100,s.delay=1e3*a/r,s.disposeOp=this.data[this.pos++],s.blendOp=this.data[this.pos++],s.data=[];break;case"IDAT":case"fdAT":for("fdAT"===l&&(this.pos+=4,e-=4),t=(null!=s?s.data:void 0)||this.imgData,f=0;0<=e?f<e:f>e;0<=e?++f:--f)t.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(this.transparency.indexed=this.read(e),(u=255-this.transparency.indexed.length)>0)for(d=0;0<=u?d<u:d>u;0<=u?++d:--d)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(e)[0];break;case 2:this.transparency.rgb=this.read(e)}break;case"tEXt":o=(h=this.read(e)).indexOf(0),c=String.fromCharCode.apply(String,h.slice(0,o)),this.text[c]=String.fromCharCode.apply(String,h.slice(o+1));break;case"IEND":return s&&this.animation.frames.push(s),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=4===(_=this.colorType)||6===_,i=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*i,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(Uint8Array!=Array&&(this.imgData=new Uint8Array(this.imgData)));default:this.pos+=e}if(this.pos+=4,this.pos>this.data.length)throw new Error(n.getError(6017))}};r.prototype={constructor:r,read:function(t){var e,i;for(i=[],e=0;0<=t?e<t:e>t;0<=t?++e:--e)i.push(this.data[this.pos++]);return i},readUInt32:function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},readUInt16:function(){return this.data[this.pos++]<<8|this.data[this.pos++]},decodePixels:function(t){var e,r,a,s,o,c,l,u,h,f,d,_,p,m,v,g,y,T,b,E,A,C,x;if(null==t&&(t=this.imgData),0===t.length)return new Uint8Array(0);for(t=new i.Inflate(t,{index:0,verify:!1}).decompress(),g=(_=this.pixelBitlength/8)*this.width,p=new Uint8Array(g*this.height),c=t.length,v=0,m=0,r=0;m<c;){switch(t[m++]){case 0:for(s=b=0;b<g;s=b+=1)p[r++]=t[m++];break;case 1:for(s=E=0;E<g;s=E+=1)e=t[m++],o=s<_?0:p[r-_],p[r++]=(e+o)%256;break;case 2:for(s=A=0;A<g;s=A+=1)e=t[m++],a=(s-s%_)/_,y=v&&p[(v-1)*g+a*_+s%_],p[r++]=(y+e)%256;break;case 3:for(s=C=0;C<g;s=C+=1)e=t[m++],a=(s-s%_)/_,o=s<_?0:p[r-_],y=v&&p[(v-1)*g+a*_+s%_],p[r++]=(e+Math.floor((o+y)/2))%256;break;case 4:for(s=x=0;x<g;s=x+=1)e=t[m++],a=(s-s%_)/_,o=s<_?0:p[r-_],0===v?y=T=0:(y=p[(v-1)*g+a*_+s%_],T=a&&p[(v-1)*g+(a-1)*_+s%_]),l=o+y-T,u=Math.abs(l-o),f=Math.abs(l-y),d=Math.abs(l-T),h=u<=f&&u<=d?o:f<=d?y:T,p[r++]=(e+h)%256;break;default:throw new Error(n.getError(6018,t[m-1]))}v++}return p},copyToImageData:function(t,e){var i,n,r,a,s,o,c,l,u,h,f;if(n=this.colors,u=null,i=this.hasAlphaChannel,this.palette.length&&(u=null!=(f=this._decodedPalette)?f:this._decodedPalette=this.decodePalette(),n=4,i=!0),l=(r=t.data||t).length,s=u||e,a=o=0,1===n)for(;a<l;)c=u?4*e[a/4]:o,h=s[c++],r[a++]=h,r[a++]=h,r[a++]=h,r[a++]=i?s[c++]:255,o=c;else for(;a<l;)c=u?4*e[a/4]:o,r[a++]=s[c++],r[a++]=s[c++],r[a++]=s[c++],r[a++]=i?s[c++]:255,o=c},decodePalette:function(){var t,e,i,n,r,a,s,o,c;for(i=this.palette,a=this.transparency.indexed||[],r=new Uint8Array((a.length||0)+i.length),n=0,t=0,e=s=0,o=i.length;s<o;e=s+=3)r[n++]=i[e],r[n++]=i[e+1],r[n++]=i[e+2],r[n++]=null!=(c=a[t++])?c:255;return r},render:function(t){var e,i;return t.width=this.width,t.height=this.height,i=(e=t.getContext("2d")).createImageData(this.width,this.height),this.copyToImageData(i,this.decodePixels()),e.putImageData(i,0,0)}},e.exports=r}),{"../compression/zlib.min":25,"../core/CCDebug":57}],308:[(function(t,e){"use strict";var i=t("../core/assets/CCAsset"),n=t("../core/assets/CCSpriteFrame"),r=cc.Class({name:"cc.ParticleAsset",extends:i,properties:{spriteFrame:{default:null,type:n}}});cc.ParticleAsset=e.exports=r}),{"../core/assets/CCAsset":93,"../core/assets/CCSpriteFrame":105}],309:[(function(t,e){"use strict";var i=t("../core/platform/CCMacro"),n=t("./CCParticleAsset"),r=t("../core/components/CCRenderComponent"),a=t("../compression/ZipUtils"),s=t("./CCPNGReader"),o=t("./CCTIFFReader"),c=t("../core/utils/texture-util"),l=(t("../core/renderer/render-flow"),t("./particle-simulator")),u=(t("../core/assets/material/CCMaterial"),t("../core/utils/blend-func")),h=cc.Enum({GRAVITY:0,RADIUS:1}),f=cc.Enum({FREE:0,RELATIVE:1,GROUPED:2}),d={preview:{default:!0,editorOnly:!0,notify:!1,animatable:!1,tooltip:!1},_custom:!1,custom:{get:function(){return this._custom},set:function(t){this._custom!==t&&(this._custom=t,this._applyFile())},animatable:!1,tooltip:!1},_file:{default:null,type:n},file:{get:function(){return this._file},set:function(t){this._file!==t&&(this._file=t,t?this._applyFile():this.custom=!0)},animatable:!1,type:n,tooltip:!1},_spriteFrame:{default:null,type:cc.SpriteFrame},spriteFrame:{get:function(){return this._spriteFrame},set:function(t){var e=this._renderSpriteFrame;e!==t&&(this._renderSpriteFrame=t,t&&!t._uuid||(this._spriteFrame=t),this._applySpriteFrame(e))},type:cc.SpriteFrame,tooltip:!1},_texture:{default:null,type:cc.Texture2D,editorOnly:!0},texture:{get:function(){return this._getTexture()},set:function(t){t&&cc.warnID(6017)},type:cc.Texture2D,tooltip:!1,readonly:!0,visible:!1,animatable:!1},particleCount:{visible:!1,get:function(){return this._simulator.particles.length},readonly:!0},_stopped:!0,stopped:{get:function(){return this._stopped},animatable:!1,visible:!1},playOnLoad:!0,autoRemoveOnFinish:{default:!1,animatable:!1,tooltip:!1},active:{get:function(){return this._simulator.active},visible:!1},totalParticles:150,duration:-1,emissionRate:10,life:1,lifeVar:0,_startColor:null,startColor:{type:cc.Color,get:function(){return this._startColor},set:function(t){this._startColor.r=t.r,this._startColor.g=t.g,this._startColor.b=t.b,this._startColor.a=t.a}},_startColorVar:null,startColorVar:{type:cc.Color,get:function(){return this._startColorVar},set:function(t){this._startColorVar.r=t.r,this._startColorVar.g=t.g,this._startColorVar.b=t.b,this._startColorVar.a=t.a}},_endColor:null,endColor:{type:cc.Color,get:function(){return this._endColor},set:function(t){this._endColor.r=t.r,this._endColor.g=t.g,this._endColor.b=t.b,this._endColor.a=t.a}},_endColorVar:null,endColorVar:{type:cc.Color,get:function(){return this._endColorVar},set:function(t){this._endColorVar.r=t.r,this._endColorVar.g=t.g,this._endColorVar.b=t.b,this._endColorVar.a=t.a}},angle:90,angleVar:20,startSize:50,startSizeVar:0,endSize:0,endSizeVar:0,startSpin:0,startSpinVar:0,endSpin:0,endSpinVar:0,sourcePos:cc.Vec2.ZERO,posVar:cc.Vec2.ZERO,_positionType:{default:f.FREE,formerlySerializedAs:"positionType"},positionType:{type:f,get:function(){return this._positionType},set:function(t){this._positionType=t,this._updateMaterial()}},emitterMode:{default:h.GRAVITY,type:h},gravity:cc.Vec2.ZERO,speed:180,speedVar:50,tangentialAccel:80,tangentialAccelVar:0,radialAccel:0,radialAccelVar:0,rotationIsDir:!1,startRadius:0,startRadiusVar:0,endRadius:0,endRadiusVar:0,rotatePerS:0,rotatePerSVar:0},_=cc.Class({name:"cc.ParticleSystem",extends:r,mixins:[u],editor:!1,ctor:function(){this.initProperties()},initProperties:function(){this._previewTimer=null,this._focused=!1,this._aspectRatio=1,this._simulator=new l(this),this._startColor=cc.color(255,255,255,255),this._startColorVar=cc.color(0,0,0,0),this._endColor=cc.color(255,255,255,0),this._endColorVar=cc.color(0,0,0,0),this._renderSpriteFrame=null},properties:d,statics:{DURATION_INFINITY:-1,START_SIZE_EQUAL_TO_END_SIZE:-1,START_RADIUS_EQUAL_TO_END_RADIUS:-1,EmitterMode:h,PositionType:f,_PNGReader:s,_TIFFReader:o},onFocusInEditor:!1,onLostFocusInEditor:!1,_startPreview:!1,_stopPreview:!1,_convertTextureToSpriteFrame:!1,__preload:function(){this._super(),this._custom&&this.spriteFrame&&!this._renderSpriteFrame?this._applySpriteFrame(this.spriteFrame):this._file&&(this._custom?!this._getTexture()&&this._applyFile():this._applyFile()),this.playOnLoad&&this.resetSystem()},onDestroy:function(){this.autoRemoveOnFinish&&(this.autoRemoveOnFinish=!1),this._buffer&&(this._buffer.destroy(),this._buffer=null),this._simulator._uvFilled=0,this._super()},lateUpdate:function(t){this._simulator.finished||this._simulator.step(t)},addParticle:function(){},stopSystem:function(){this._stopped=!0,this._simulator.stop()},resetSystem:function(){this._stopped=!1,this._simulator.reset(),this.markForRender(!0)},isFull:function(){return this.particleCount>=this.totalParticles},setTextureWithRect:function(t,e){t instanceof cc.Texture2D&&(this.spriteFrame=new cc.SpriteFrame(t,e))},_applyFile:function(){var t=this._file;if(t){var e=this;cc.assetManager.postLoadNative(t,(function(i){!i&&t._nativeAsset?e.isValid&&(e._plistFile=t.nativeUrl,e._custom||e._initWithDictionary(t._nativeAsset),e._spriteFrame?!e._renderSpriteFrame&&e._spriteFrame&&e._applySpriteFrame(e.spriteFrame):t.spriteFrame?e.spriteFrame=t.spriteFrame:e._custom&&e._initTextureWithDictionary(t._nativeAsset)):cc.errorID(6029)}))}},_initTextureWithDictionary:function(t){var e,n=cc.path.changeBasename(this._plistFile,t.textureFileName||"");if(t.textureFileName)c.loadImage(n,(function(e,i){e?(t.textureFileName=void 0,this._initTextureWithDictionary(t)):(cc.assetManager.assets.add(n,i),this.spriteFrame=new cc.SpriteFrame(i))}),this);else if(t.textureImageData){var r=t.textureImageData;if(!(r&&r.length>0))return!1;var l=cc.assetManager.assets.get(n);if(!l){var u=a.unzipBase64AsArray(r,1);if(!u)return cc.warnID(6030,this._file.name),!1;var h=(e=u).length>8&&137===e[0]&&80===e[1]&&78===e[2]&&71===e[3]&&13===e[4]&&10===e[5]&&26===e[6]&&10===e[7]?i.ImageFormat.PNG:e.length>2&&(73===e[0]&&73===e[1]||77===e[0]&&77===e[1]||255===e[0]&&216===e[1])?i.ImageFormat.TIFF:i.ImageFormat.UNKNOWN;if(h!==i.ImageFormat.TIFF&&h!==i.ImageFormat.PNG)return cc.warnID(6031,this._file.name),!1;var f=document.createElement("canvas");h===i.ImageFormat.PNG?new s(u).render(f):o.parseTIFF(u,f),l=c.cacheImage(n,f)}l||cc.warnID(6032,this._file.name),this.spriteFrame=new cc.SpriteFrame(l)}return!0},_initWithDictionary:function(t){this.totalParticles=parseInt(t.maxParticles||0),this.life=parseFloat(t.particleLifespan||0),this.lifeVar=parseFloat(t.particleLifespanVariance||0);var e=t.emissionRate;this.emissionRate=e||Math.min(this.totalParticles/this.life,Number.MAX_VALUE),this.duration=parseFloat(t.duration||0),this.srcBlendFactor=parseInt(t.blendFuncSource||i.SRC_ALPHA),this.dstBlendFactor=parseInt(t.blendFuncDestination||i.ONE_MINUS_SRC_ALPHA);var n=this._startColor;n.r=255*parseFloat(t.startColorRed||0),n.g=255*parseFloat(t.startColorGreen||0),n.b=255*parseFloat(t.startColorBlue||0),n.a=255*parseFloat(t.startColorAlpha||0);var r=this._startColorVar;r.r=255*parseFloat(t.startColorVarianceRed||0),r.g=255*parseFloat(t.startColorVarianceGreen||0),r.b=255*parseFloat(t.startColorVarianceBlue||0),r.a=255*parseFloat(t.startColorVarianceAlpha||0);var a=this._endColor;a.r=255*parseFloat(t.finishColorRed||0),a.g=255*parseFloat(t.finishColorGreen||0),a.b=255*parseFloat(t.finishColorBlue||0),a.a=255*parseFloat(t.finishColorAlpha||0);var s=this._endColorVar;if(s.r=255*parseFloat(t.finishColorVarianceRed||0),s.g=255*parseFloat(t.finishColorVarianceGreen||0),s.b=255*parseFloat(t.finishColorVarianceBlue||0),s.a=255*parseFloat(t.finishColorVarianceAlpha||0),this.startSize=parseFloat(t.startParticleSize||0),this.startSizeVar=parseFloat(t.startParticleSizeVariance||0),this.endSize=parseFloat(t.finishParticleSize||0),this.endSizeVar=parseFloat(t.finishParticleSizeVariance||0),this.positionType=parseFloat(void 0!==t.positionType?t.positionType:f.RELATIVE),this.sourcePos.x=0,this.sourcePos.y=0,this.posVar.x=parseFloat(t.sourcePositionVariancex||0),this.posVar.y=parseFloat(t.sourcePositionVariancey||0),this.angle=parseFloat(t.angle||0),this.angleVar=parseFloat(t.angleVariance||0),this.startSpin=parseFloat(t.rotationStart||0),this.startSpinVar=parseFloat(t.rotationStartVariance||0),this.endSpin=parseFloat(t.rotationEnd||0),this.endSpinVar=parseFloat(t.rotationEndVariance||0),this.emitterMode=parseInt(t.emitterType||h.GRAVITY),this.emitterMode===h.GRAVITY){this.gravity.x=parseFloat(t.gravityx||0),this.gravity.y=parseFloat(t.gravityy||0),this.speed=parseFloat(t.speed||0),this.speedVar=parseFloat(t.speedVariance||0),this.radialAccel=parseFloat(t.radialAcceleration||0),this.radialAccelVar=parseFloat(t.radialAccelVariance||0),this.tangentialAccel=parseFloat(t.tangentialAcceleration||0),this.tangentialAccelVar=parseFloat(t.tangentialAccelVariance||0);var o=t.rotationIsDir||"";null!==o?(o=o.toString().toLowerCase(),this.rotationIsDir="true"===o||"1"===o):this.rotationIsDir=!1}else{if(this.emitterMode!==h.RADIUS)return cc.warnID(6009),!1;this.startRadius=parseFloat(t.maxRadius||0),this.startRadiusVar=parseFloat(t.maxRadiusVariance||0),this.endRadius=parseFloat(t.minRadius||0),this.endRadiusVar=parseFloat(t.minRadiusVariance||0),this.rotatePerS=parseFloat(t.rotatePerSecond||0),this.rotatePerSVar=parseFloat(t.rotatePerSecondVariance||0)}return this._initTextureWithDictionary(t),!0},_validateRender:function(){var t=this._getTexture();t&&t.loaded?this._super():this.disableRender()},_onTextureLoaded:function(){this._simulator.updateUVs(!0),this._syncAspect(),this._updateMaterial(),this.markForRender(!0)},_syncAspect:function(){var t=this._renderSpriteFrame._rect;this._aspectRatio=t.width/t.height},_applySpriteFrame:function(){this._renderSpriteFrame=this._renderSpriteFrame||this._spriteFrame,this._renderSpriteFrame&&(this._renderSpriteFrame.textureLoaded()?this._onTextureLoaded():this._renderSpriteFrame.onTextureLoaded(this._onTextureLoaded,this))},_getTexture:function(){return this._renderSpriteFrame&&this._renderSpriteFrame.getTexture()||this._texture},_updateMaterial:function(){var t=this.getMaterial(0);t&&(t.define("CC_USE_MODEL",this._positionType!==f.FREE),t.setProperty("texture",this._getTexture()),u.prototype._updateMaterial.call(this))},_finishedSimulation:function(){this.resetSystem(),this.stopSystem(),this.disableRender(),this.autoRemoveOnFinish&&this._stopped&&this.node.destroy()}});cc.ParticleSystem=e.exports=_}),{"../compression/ZipUtils":22,"../core/assets/material/CCMaterial":111,"../core/components/CCRenderComponent":140,"../core/platform/CCMacro":198,"../core/renderer/render-flow":226,"../core/utils/blend-func":272,"../core/utils/texture-util":286,"./CCPNGReader":307,"./CCParticleAsset":308,"./CCTIFFReader":310,"./particle-simulator":312,"fire-url":void 0}],310:[(function(t,e){"use strict";var i=t("../core/CCDebug"),n={_littleEndian:!1,_tiffData:null,_fileDirectories:[],getUint8:function(t){return this._tiffData[t]},getUint16:function(t){return this._littleEndian?this._tiffData[t+1]<<8|this._tiffData[t]:this._tiffData[t]<<8|this._tiffData[t+1]},getUint32:function(t){var e=this._tiffData;return this._littleEndian?e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]:e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]},checkLittleEndian:function(){var t=this.getUint16(0);if(18761===t)this.littleEndian=!0;else{if(19789!==t)throw console.log(t),TypeError(i.getError(6019));this.littleEndian=!1}return this.littleEndian},hasTowel:function(){if(42!==this.getUint16(2))throw RangeError(i.getError(6020));return!0},getFieldTypeName:function(t){var e=this.fieldTypeNames;return t in e?e[t]:null},getFieldTagName:function(t){var e=this.fieldTagNames;return t in e?e[t]:(cc.logID(6021,t),"Tag"+t)},getFieldTypeLength:function(t){return-1!==["BYTE","ASCII","SBYTE","UNDEFINED"].indexOf(t)?1:-1!==["SHORT","SSHORT"].indexOf(t)?2:-1!==["LONG","SLONG","FLOAT"].indexOf(t)?4:-1!==["RATIONAL","SRATIONAL","DOUBLE"].indexOf(t)?8:null},getFieldValues:function(t,e,i,n){var r=[],a=this.getFieldTypeLength(e);if(a*i<=4)!1===this.littleEndian?r.push(n>>>8*(4-a)):r.push(n);else for(var s=0;s<i;s++){var o=a*s;a>=8?-1!==["RATIONAL","SRATIONAL"].indexOf(e)?(r.push(this.getUint32(n+o)),r.push(this.getUint32(n+o+4))):cc.logID(8e3):r.push(this.getBytes(a,n+o))}return"ASCII"===e&&r.forEach((function(t,e,i){i[e]=String.fromCharCode(t)})),r},getBytes:function(t,e){if(t<=0)cc.logID(8001);else{if(t<=1)return this.getUint8(e);if(t<=2)return this.getUint16(e);if(t<=3)return this.getUint32(e)>>>8;if(t<=4)return this.getUint32(e);cc.logID(8002)}},getBits:function(t,e,i){i=i||0;var n,r,a=e+Math.floor(i/8),s=i+t,o=32-t;return s<=0?cc.logID(6023):s<=8?(n=24+i,r=this.getUint8(a)):s<=16?(n=16+i,r=this.getUint16(a)):s<=32?(n=i,r=this.getUint32(a)):cc.logID(6022),{bits:r<<n>>>o,byteOffset:a+Math.floor(s/8),bitOffset:s%8}},parseFileDirectory:function(t){for(var e=this.getUint16(t),i=[],n=t+2,r=0;r<e;n+=12,r++){var a=this.getUint16(n),s=this.getUint16(n+2),o=this.getUint32(n+4),c=this.getUint32(n+8),l=this.getFieldTagName(a),u=this.getFieldTypeName(s),h=this.getFieldValues(l,u,o,c);i[l]={type:u,values:h}}this._fileDirectories.push(i);var f=this.getUint32(n);0!==f&&this.parseFileDirectory(f)},clampColorSample:function(t,e){var i=Math.pow(2,8-e);return Math.floor(t*i+(i-1))},parseTIFF:function(t,e){if(e=e||document.createElement("canvas"),this._tiffData=t,this.canvas=e,this.checkLittleEndian(),this.hasTowel()){var n=this.getUint32(4);this._fileDirectories.length=0,this.parseFileDirectory(n);var r=this._fileDirectories[0],a=r.ImageWidth.values[0],s=r.ImageLength.values[0];this.canvas.width=a,this.canvas.height=s;var o=[],c=r.Compression?r.Compression.values[0]:1,l=r.SamplesPerPixel.values[0],u=[],h=0,f=!1;if(r.BitsPerSample.values.forEach((function(t,e){u[e]={bitsPerSample:t,hasBytesPerSample:!1,bytesPerSample:void 0},t%8==0&&(u[e].hasBytesPerSample=!0,u[e].bytesPerSample=t/8),h+=t}),this),h%8==0){f=!0;var d=h/8}var _=r.StripOffsets.values,p=_.length;if(r.StripByteCounts)var m=r.StripByteCounts.values;else{if(cc.logID(8003),1!==p)throw Error(i.getError(6024));m=[Math.ceil(a*s*h/8)]}for(var v=0;v<p;v++){var g=_[v];o[v]=[];for(var y=m[v],T=0,b=0,E=1,A=!0,C=[],x=0,S=0,w=0;T<y;T+=E)switch(c){case 1:var M=0;for(C=[];M<l;M++){if(!u[M].hasBytesPerSample){var R=this.getBits(u[M].bitsPerSample,g+T,b);throw C.push(R.bits),T=R.byteOffset-g,b=R.bitOffset,RangeError(i.getError(6025))}var I=u[M].bytesPerSample*M;C.push(this.getBytes(u[M].bytesPerSample,g+T+I))}if(o[v].push(C),!f)throw E=0,RangeError(i.getError(6026));E=d;break;case 2:case 3:case 4:case 5:case 6:case 7:break;case 32773:if(A){A=!1;var O=1,D=1,P=this.getInt8(g+T);P>=0&&P<=127?O=P+1:P>=-127&&P<=-1?D=1-P:A=!0}else{var L=this.getUint8(g+T);for(M=0;M<D;M++){if(!u[S].hasBytesPerSample)throw RangeError(i.getError(6025));w=w<<8*x|L,++x===u[S].bytesPerSample&&(C.push(w),w=x=0,S++),S===l&&(o[v].push(C),C=[],S=0)}0==--O&&(A=!0)}E=1}}if(e.getContext){var N=this.canvas.getContext("2d");N.fillStyle="rgba(255, 255, 255, 0)";var F=r.RowsPerStrip?r.RowsPerStrip.values[0]:s,B=o.length,k=s%F,V=0===k?F:k,z=F,U=0,H=r.PhotometricInterpretation.values[0],W=[],G=0;if(r.ExtraSamples&&(G=(W=r.ExtraSamples.values).length),r.ColorMap)var j=r.ColorMap.values,Y=Math.pow(2,u[0].bitsPerSample);for(v=0;v<B;v++){v+1===B&&(z=V);for(var X=o[v].length,q=U*v,Z=0,K=0;K<X;Z++)for(var Q=0;Q<a;Q++,K++){var J=o[v][K],$=0,tt=0,et=0,it=1;if(G>0)for(var nt=0;nt<G;nt++)if(1===W[nt]||2===W[nt]){it=J[3+nt]/256;break}switch(H){case 0:if(u[0].hasBytesPerSample)var rt=Math.pow(16,2*u[0].bytesPerSample);J.forEach((function(t,e,i){i[e]=rt-t}));case 1:$=tt=et=this.clampColorSample(J[0],u[0].bitsPerSample);break;case 2:$=this.clampColorSample(J[0],u[0].bitsPerSample),tt=this.clampColorSample(J[1],u[1].bitsPerSample),et=this.clampColorSample(J[2],u[2].bitsPerSample);break;case 3:if(void 0===j)throw Error(i.getError(6027));var at=J[0];$=this.clampColorSample(j[at],16),tt=this.clampColorSample(j[Y+at],16),et=this.clampColorSample(j[2*Y+at],16);break;default:throw RangeError(i.getError(6028,H))}N.fillStyle="rgba("+$+", "+tt+", "+et+", "+it+")",N.fillRect(Q,q+Z,1,1)}U=z}}return this.canvas}},fieldTagNames:{315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop"},fieldTypeNames:{1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE"}};e.exports=n}),{"../core/CCDebug":57}],311:[(function(t){"use strict";t("./CCParticleAsset"),t("./CCParticleSystem"),t("./particle-simulator"),t("./particle-system-assembler")}),{"./CCParticleAsset":308,"./CCParticleSystem":309,"./particle-simulator":312,"./particle-system-assembler":313}],312:[(function(t,e){"use strict";var i=t("../core/platform/js"),n=t("../core/utils/misc"),r=cc.v2(0,0),a=cc.v2(),s=cc.v2(),o=cc.v2(),c=cc.v2(),l=function(){this.pos=cc.v2(0,0),this.startPos=cc.v2(0,0),this.color=cc.color(0,0,0,255),this.deltaColor={r:0,g:0,b:0,a:255},this.size=0,this.deltaSize=0,this.rotation=0,this.deltaRotation=0,this.timeToLive=0,this.drawPos=cc.v2(0,0),this.aspectRatio=1,this.dir=cc.v2(0,0),this.radialAccel=0,this.tangentialAccel=0,this.angle=0,this.degreesPerSecond=0,this.radius=0,this.deltaRadius=0},u=new i.Pool(function(t){t.pos.set(r),t.startPos.set(r),t.color._val=4278190080,t.deltaColor.r=t.deltaColor.g=t.deltaColor.b=0,t.deltaColor.a=255,t.size=0,t.deltaSize=0,t.rotation=0,t.deltaRotation=0,t.timeToLive=0,t.drawPos.set(r),t.aspectRatio=1,t.dir.set(r),t.radialAccel=0,t.tangentialAccel=0,t.angle=0,t.degreesPerSecond=0,t.radius=0,t.deltaRadius=0},1024);u.get=function(){return this._get()||new l};var h=function(t){this.sys=t,this.particles=[],this.active=!1,this.readyToPlay=!0,this.finished=!1,this.elapsed=0,this.emitCounter=0,this._uvFilled=0,this._worldRotation=0};function f(t){for(var e=0,i=t;i;)e+=i.angle,i=i.parent;return e}h.prototype.stop=function(){this.active=!1,this.readyToPlay=!1,this.elapsed=this.sys.duration,this.emitCounter=0},h.prototype.reset=function(){this.active=!0,this.readyToPlay=!0,this.elapsed=0,this.emitCounter=0,this.finished=!1;for(var t=this.particles,e=0;e<t.length;++e)u.put(t[e]);t.length=0},h.prototype.emitParticle=function(t){var e=this.sys,i=n.clampf,r=u.get();this.particles.push(r),r.timeToLive=e.life+e.lifeVar*(Math.random()-.5)*2;var a,s,o,c,l=r.timeToLive=Math.max(0,r.timeToLive);r.pos.x=e.sourcePos.x+e.posVar.x*(Math.random()-.5)*2,r.pos.y=e.sourcePos.y+e.posVar.y*(Math.random()-.5)*2;var h=e._startColor,f=e._startColorVar,d=e._endColor,_=e._endColorVar;r.color.r=a=i(h.r+f.r*(Math.random()-.5)*2,0,255),r.color.g=s=i(h.g+f.g*(Math.random()-.5)*2,0,255),r.color.b=o=i(h.b+f.b*(Math.random()-.5)*2,0,255),r.color.a=c=i(h.a+f.a*(Math.random()-.5)*2,0,255),r.deltaColor.r=(i(d.r+_.r*(Math.random()-.5)*2,0,255)-a)/l,r.deltaColor.g=(i(d.g+_.g*(Math.random()-.5)*2,0,255)-s)/l,r.deltaColor.b=(i(d.b+_.b*(Math.random()-.5)*2,0,255)-o)/l,r.deltaColor.a=(i(d.a+_.a*(Math.random()-.5)*2,0,255)-c)/l;var p=e.startSize+e.startSizeVar*(Math.random()-.5)*2;if(p=Math.max(0,p),r.size=p,e.endSize===cc.ParticleSystem.START_SIZE_EQUAL_TO_END_SIZE)r.deltaSize=0;else{var m=e.endSize+e.endSizeVar*(Math.random()-.5)*2;m=Math.max(0,m),r.deltaSize=(m-p)/l}var v=e.startSpin+e.startSpinVar*(Math.random()-.5)*2,g=e.endSpin+e.endSpinVar*(Math.random()-.5)*2;r.rotation=v,r.deltaRotation=(g-v)/l,r.startPos.x=t.x,r.startPos.y=t.y,r.aspectRatio=e._aspectRatio||1;var y=n.degreesToRadians(e.angle+this._worldRotation+e.angleVar*(Math.random()-.5)*2);if(e.emitterMode===cc.ParticleSystem.EmitterMode.GRAVITY){var T=e.speed+e.speedVar*(Math.random()-.5)*2;r.dir.x=Math.cos(y),r.dir.y=Math.sin(y),r.dir.mulSelf(T),r.radialAccel=e.radialAccel+e.radialAccelVar*(Math.random()-.5)*2,r.tangentialAccel=e.tangentialAccel+e.tangentialAccelVar*(Math.random()-.5)*2,e.rotationIsDir&&(r.rotation=-n.radiansToDegrees(Math.atan2(r.dir.y,r.dir.x)))}else{var b=e.startRadius+e.startRadiusVar*(Math.random()-.5)*2,E=e.endRadius+e.endRadiusVar*(Math.random()-.5)*2;r.radius=b,r.deltaRadius=e.endRadius===cc.ParticleSystem.START_RADIUS_EQUAL_TO_END_RADIUS?0:(E-b)/l,r.angle=y,r.degreesPerSecond=n.degreesToRadians(e.rotatePerS+e.rotatePerSVar*(Math.random()-.5)*2)}},h.prototype.updateUVs=function(t){var e=this.sys._assembler;if(e){var i=e.getBuffer();if(i&&this.sys._renderSpriteFrame){for(var n=4*e._vfmt._bytes/4,r=i._vData,a=this.sys._renderSpriteFrame.uv,s=t?0:this._uvFilled,o=this.particles.length,c=s;c<o;c++){var l=c*n;r[l+2]=a[0],r[l+3]=a[1],r[l+7]=a[2],r[l+8]=a[3],r[l+12]=a[4],r[l+13]=a[5],r[l+17]=a[6],r[l+18]=a[7]}this._uvFilled=o}}},h.prototype.updateParticleBuffer=function(t,e,i,r){var a=i._vData,s=i._uintVData,o=e.x,c=e.y,l=t.size,u=l,h=t.aspectRatio;h>1?u=l/h:l=u*h;var f=l/2,d=u/2;if(t.rotation){var _=-f,p=-d,m=f,v=d,g=-n.degreesToRadians(t.rotation),y=Math.cos(g),T=Math.sin(g);a[r]=_*y-p*T+o,a[r+1]=_*T+p*y+c,a[r+5]=m*y-p*T+o,a[r+6]=m*T+p*y+c,a[r+10]=_*y-v*T+o,a[r+11]=_*T+v*y+c,a[r+15]=m*y-v*T+o,a[r+16]=m*T+v*y+c}else a[r]=o-f,a[r+1]=c-d,a[r+5]=o+f,a[r+6]=c-d,a[r+10]=o-f,a[r+11]=c+d,a[r+15]=o+f,a[r+16]=c+d;s[r+4]=t.color._val,s[r+9]=t.color._val,s[r+14]=t.color._val,s[r+19]=t.color._val},h.prototype.step=function(t){t=t>cc.director._maxParticleDeltaTime?cc.director._maxParticleDeltaTime:t;var e=this.sys,i=e.node,n=this.particles,r=4*this.sys._assembler._vfmt._bytes/4,l=cc.ParticleSystem.PositionType;if(i._updateWorldMatrix(),e.positionType===l.FREE){this._worldRotation=f(i);var h=i._worldMatrix.m;a.x=h[12],a.y=h[13]}else e.positionType===l.RELATIVE?(this._worldRotation=i.angle,a.x=i.x,a.y=i.y):this._worldRotation=0;if(this.active&&e.emissionRate){var d=1/e.emissionRate;for(n.length<e.totalParticles&&(this.emitCounter+=t);n.length<e.totalParticles&&this.emitCounter>d;)this.emitParticle(a),this.emitCounter-=d;this.elapsed+=t,-1!==e.duration&&e.duration<this.elapsed&&e.stopSystem()}var _=e._assembler.getBuffer(),p=n.length;_.reset(),_.request(4*p,6*p),p>this._uvFilled&&this.updateUVs();for(var m=0;m<n.length;){s.x=s.y=o.x=o.y=c.x=c.y=0;var v=n[m];if(v.timeToLive-=t,v.timeToLive>0){if(e.emitterMode===cc.ParticleSystem.EmitterMode.GRAVITY){var g=c,y=s,T=o;(v.pos.x||v.pos.y)&&(y.set(v.pos),y.normalizeSelf()),T.set(y),y.mulSelf(v.radialAccel);var b=T.x;T.x=-T.y,T.y=b,T.mulSelf(v.tangentialAccel),g.set(y),g.addSelf(T),g.addSelf(e.gravity),g.mulSelf(t),v.dir.addSelf(g),g.set(v.dir),g.mulSelf(t),v.pos.addSelf(g)}else v.angle+=v.degreesPerSecond*t,v.radius+=v.deltaRadius*t,v.pos.x=-Math.cos(v.angle)*v.radius,v.pos.y=-Math.sin(v.angle)*v.radius;v.color.r+=v.deltaColor.r*t,v.color.g+=v.deltaColor.g*t,v.color.b+=v.deltaColor.b*t,v.color.a+=v.deltaColor.a*t,v.size+=v.deltaSize*t,v.size<0&&(v.size=0),v.rotation+=v.deltaRotation*t;var E=s;E.set(v.pos),e.positionType!==l.GROUPED&&E.addSelf(v.startPos);var A=r*m;this.updateParticleBuffer(v,E,_,A),++m}else{var C=n[m];m!==n.length-1&&(n[m]=n[n.length-1]),u.put(C),n.length--}}e._assembler._ia._count=6*n.length,n.length>0?_.uploadData():this.active||this.readyToPlay||(this.finished=!0,e._finishedSimulation())},e.exports=h}),{"../core/platform/js":214,"../core/utils/misc":278}],313:[(function(t,e){"use strict";var i=r(t("../core/renderer/assembler")),n=r(t("../renderer/core/input-assembler"));function r(t){return t&&t.__esModule?t:{default:t}}var a=t("./CCParticleSystem"),s=t("../core/renderer/"),o=t("../core/renderer/webgl/quad-buffer"),c=t("../core/renderer/webgl/vertex-format").vfmtPosUvColor,l=(function(t){var e,i;function r(e){var i;return(i=t.call(this,e)||this)._buffer=null,i._ia=null,i._vfmt=c,i}i=t,(e=r).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var a=r.prototype;return a.getBuffer=function(){return this._buffer||(this._buffer=new o(s._handle,c),this._ia=new n.default,this._ia._vertexBuffer=this._buffer._vb,this._ia._indexBuffer=this._buffer._ib,this._ia._start=0,this._ia._count=0),this._buffer},a.fillBuffers=function(t,e){if(this._ia){var i=cc.ParticleSystem.PositionType;t.positionType===i.RELATIVE?e.node=t.node.parent:e.node=t.node,e.material=t._materials[0],e._flushIA(this._ia)}},r})(i.default);i.default.register(a,l),e.exports=l}),{"../core/renderer/":225,"../core/renderer/assembler":222,"../core/renderer/webgl/quad-buffer":264,"../core/renderer/webgl/vertex-format":267,"../renderer/core/input-assembler":316,"./CCParticleSystem":309}],314:[(function(t,e){"use strict";var i,n,r,a,s,o,c,l,u,h,f,d,_,p,m,v,g,y,T,b,E,A,C,x,S,w,M,R,I,O,D,P,L,N,F,B,k,V,z,U,H,W;(function(t){t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL"})(i||(i={})),(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.BUFFER=1]="BUFFER",t[t.TEXTURE=2]="TEXTURE",t[t.TEXTURE_VIEW=3]="TEXTURE_VIEW",t[t.RENDER_PASS=4]="RENDER_PASS",t[t.FRAMEBUFFER=5]="FRAMEBUFFER",t[t.SAMPLER=6]="SAMPLER",t[t.SHADER=7]="SHADER",t[t.PIPELINE_LAYOUT=8]="PIPELINE_LAYOUT",t[t.PIPELINE_STATE=9]="PIPELINE_STATE",t[t.BINDING_LAYOUT=10]="BINDING_LAYOUT",t[t.INPUT_ASSEMBLER=11]="INPUT_ASSEMBLER",t[t.COMMAND_ALLOCATOR=12]="COMMAND_ALLOCATOR",t[t.COMMAND_BUFFER=13]="COMMAND_BUFFER",t[t.QUEUE=14]="QUEUE",t[t.WINDOW=15]="WINDOW"})(n||(n={})),(function(t){t[t.UNREADY=0]="UNREADY",t[t.FAILED=1]="FAILED",t[t.SUCCESS=2]="SUCCESS"})(r||(r={})),(function(){function t(t){this._gfxType=n.UNKNOWN,this._status=r.UNREADY,this._gfxType=t}Object.defineProperty(t.prototype,"gfxType",{get:function(){return this._gfxType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0})})(),(function(t){t.ATTR_POSITION="a_position",t.ATTR_NORMAL="a_normal",t.ATTR_TANGENT="a_tangent",t.ATTR_BITANGENT="a_bitangent",t.ATTR_WEIGHTS="a_weights",t.ATTR_JOINTS="a_joints",t.ATTR_COLOR="a_color",t.ATTR_COLOR1="a_color1",t.ATTR_COLOR2="a_color2",t.ATTR_TEX_COORD="a_texCoord",t.ATTR_TEX_COORD1="a_texCoord1",t.ATTR_TEX_COORD2="a_texCoord2",t.ATTR_TEX_COORD3="a_texCoord3",t.ATTR_TEX_COORD4="a_texCoord4",t.ATTR_TEX_COORD5="a_texCoord5",t.ATTR_TEX_COORD6="a_texCoord6",t.ATTR_TEX_COORD7="a_texCoord7",t.ATTR_TEX_COORD8="a_texCoord8"})(a||(a={})),(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.BOOL=1]="BOOL",t[t.BOOL2=2]="BOOL2",t[t.BOOL3=3]="BOOL3",t[t.BOOL4=4]="BOOL4",t[t.INT=5]="INT",t[t.INT2=6]="INT2",t[t.INT3=7]="INT3",t[t.INT4=8]="INT4",t[t.UINT=9]="UINT",t[t.UINT2=10]="UINT2",t[t.UINT3=11]="UINT3",t[t.UINT4=12]="UINT4",t[t.FLOAT=13]="FLOAT",t[t.FLOAT2=14]="FLOAT2",t[t.FLOAT3=15]="FLOAT3",t[t.FLOAT4=16]="FLOAT4",t[t.COLOR4=17]="COLOR4",t[t.MAT2=18]="MAT2",t[t.MAT2X3=19]="MAT2X3",t[t.MAT2X4=20]="MAT2X4",t[t.MAT3X2=21]="MAT3X2",t[t.MAT3=22]="MAT3",t[t.MAT3X4=23]="MAT3X4",t[t.MAT4X2=24]="MAT4X2",t[t.MAT4X3=25]="MAT4X3",t[t.MAT4=26]="MAT4",t[t.SAMPLER1D=27]="SAMPLER1D",t[t.SAMPLER1D_ARRAY=28]="SAMPLER1D_ARRAY",t[t.SAMPLER2D=29]="SAMPLER2D",t[t.SAMPLER2D_ARRAY=30]="SAMPLER2D_ARRAY",t[t.SAMPLER3D=31]="SAMPLER3D",t[t.SAMPLER_CUBE=32]="SAMPLER_CUBE",t[t.COUNT=33]="COUNT"})(s||(s={})),(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.A8=1]="A8",t[t.L8=2]="L8",t[t.LA8=3]="LA8",t[t.R8=4]="R8",t[t.R8SN=5]="R8SN",t[t.R8UI=6]="R8UI",t[t.R8I=7]="R8I",t[t.R16F=8]="R16F",t[t.R16UI=9]="R16UI",t[t.R16I=10]="R16I",t[t.R32F=11]="R32F",t[t.R32UI=12]="R32UI",t[t.R32I=13]="R32I",t[t.RG8=14]="RG8",t[t.RG8SN=15]="RG8SN",t[t.RG8UI=16]="RG8UI",t[t.RG8I=17]="RG8I",t[t.RG16F=18]="RG16F",t[t.RG16UI=19]="RG16UI",t[t.RG16I=20]="RG16I",t[t.RG32F=21]="RG32F",t[t.RG32UI=22]="RG32UI",t[t.RG32I=23]="RG32I",t[t.RGB8=24]="RGB8",t[t.SRGB8=25]="SRGB8",t[t.RGB8SN=26]="RGB8SN",t[t.RGB8UI=27]="RGB8UI",t[t.RGB8I=28]="RGB8I",t[t.RGB16F=29]="RGB16F",t[t.RGB16UI=30]="RGB16UI",t[t.RGB16I=31]="RGB16I",t[t.RGB32F=32]="RGB32F",t[t.RGB32UI=33]="RGB32UI",t[t.RGB32I=34]="RGB32I",t[t.RGBA8=35]="RGBA8",t[t.SRGB8_A8=36]="SRGB8_A8",t[t.RGBA8SN=37]="RGBA8SN",t[t.RGBA8UI=38]="RGBA8UI",t[t.RGBA8I=39]="RGBA8I",t[t.RGBA16F=40]="RGBA16F",t[t.RGBA16UI=41]="RGBA16UI",t[t.RGBA16I=42]="RGBA16I",t[t.RGBA32F=43]="RGBA32F",t[t.RGBA32UI=44]="RGBA32UI",t[t.RGBA32I=45]="RGBA32I",t[t.R5G6B5=46]="R5G6B5",t[t.R11G11B10F=47]="R11G11B10F",t[t.RGB5A1=48]="RGB5A1",t[t.RGBA4=49]="RGBA4",t[t.RGB10A2=50]="RGB10A2",t[t.RGB10A2UI=51]="RGB10A2UI",t[t.RGB9E5=52]="RGB9E5",t[t.D16=53]="D16",t[t.D16S8=54]="D16S8",t[t.D24=55]="D24",t[t.D24S8=56]="D24S8",t[t.D32F=57]="D32F",t[t.D32F_S8=58]="D32F_S8",t[t.BC1=59]="BC1",t[t.BC1_ALPHA=60]="BC1_ALPHA",t[t.BC1_SRGB=61]="BC1_SRGB",t[t.BC1_SRGB_ALPHA=62]="BC1_SRGB_ALPHA",t[t.BC2=63]="BC2",t[t.BC2_SRGB=64]="BC2_SRGB",t[t.BC3=65]="BC3",t[t.BC3_SRGB=66]="BC3_SRGB",t[t.BC4=67]="BC4",t[t.BC4_SNORM=68]="BC4_SNORM",t[t.BC5=69]="BC5",t[t.BC5_SNORM=70]="BC5_SNORM",t[t.BC6H_UF16=71]="BC6H_UF16",t[t.BC6H_SF16=72]="BC6H_SF16",t[t.BC7=73]="BC7",t[t.BC7_SRGB=74]="BC7_SRGB",t[t.ETC_RGB8=75]="ETC_RGB8",t[t.ETC2_RGB8=76]="ETC2_RGB8",t[t.ETC2_SRGB8=77]="ETC2_SRGB8",t[t.ETC2_RGB8_A1=78]="ETC2_RGB8_A1",t[t.ETC2_SRGB8_A1=79]="ETC2_SRGB8_A1",t[t.ETC2_RGBA8=80]="ETC2_RGBA8",t[t.ETC2_SRGB8_A8=81]="ETC2_SRGB8_A8",t[t.EAC_R11=82]="EAC_R11",t[t.EAC_R11SN=83]="EAC_R11SN",t[t.EAC_RG11=84]="EAC_RG11",t[t.EAC_RG11SN=85]="EAC_RG11SN",t[t.PVRTC_RGB2=86]="PVRTC_RGB2",t[t.PVRTC_RGBA2=87]="PVRTC_RGBA2",t[t.PVRTC_RGB4=88]="PVRTC_RGB4",t[t.PVRTC_RGBA4=89]="PVRTC_RGBA4",t[t.PVRTC2_2BPP=90]="PVRTC2_2BPP",t[t.PVRTC2_4BPP=91]="PVRTC2_4BPP"})(o||(o={})),(function(t){t[t.NONE=0]="NONE",t[t.TRANSFER_SRC=1]="TRANSFER_SRC",t[t.TRANSFER_DST=2]="TRANSFER_DST",t[t.INDEX=4]="INDEX",t[t.VERTEX=8]="VERTEX",t[t.UNIFORM=16]="UNIFORM",t[t.STORAGE=32]="STORAGE",t[t.INDIRECT=64]="INDIRECT"})(c||(c={})),(function(t){t[t.NONE=0]="NONE",t[t.DEVICE=1]="DEVICE",t[t.HOST=2]="HOST"})(l||(l={})),(function(t){t[t.NONE=0]="NONE",t[t.READ=1]="READ",t[t.WRITE=2]="WRITE"})(u||(u={})),(function(t){t[t.POINT_LIST=0]="POINT_LIST",t[t.LINE_LIST=1]="LINE_LIST",t[t.LINE_STRIP=2]="LINE_STRIP",t[t.LINE_LOOP=3]="LINE_LOOP",t[t.LINE_LIST_ADJACENCY=4]="LINE_LIST_ADJACENCY",t[t.LINE_STRIP_ADJACENCY=5]="LINE_STRIP_ADJACENCY",t[t.ISO_LINE_LIST=6]="ISO_LINE_LIST",t[t.TRIANGLE_LIST=7]="TRIANGLE_LIST",t[t.TRIANGLE_STRIP=8]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=9]="TRIANGLE_FAN",t[t.TRIANGLE_LIST_ADJACENCY=10]="TRIANGLE_LIST_ADJACENCY",t[t.TRIANGLE_STRIP_ADJACENCY=11]="TRIANGLE_STRIP_ADJACENCY",t[t.TRIANGLE_PATCH_ADJACENCY=12]="TRIANGLE_PATCH_ADJACENCY",t[t.QUAD_PATCH_LIST=13]="QUAD_PATCH_LIST"})(h||(h={})),(function(t){t[t.FILL=0]="FILL",t[t.POINT=1]="POINT",t[t.LINE=2]="LINE"})(f||(f={})),(function(t){t[t.GOURAND=0]="GOURAND",t[t.FLAT=1]="FLAT"})(d||(d={})),(function(t){t[t.NONE=0]="NONE",t[t.FRONT=1]="FRONT",t[t.BACK=2]="BACK"})(_||(_={})),(function(t){t[t.NEVER=0]="NEVER",t[t.LESS=1]="LESS",t[t.EQUAL=2]="EQUAL",t[t.LESS_EQUAL=3]="LESS_EQUAL",t[t.GREATER=4]="GREATER",t[t.NOT_EQUAL=5]="NOT_EQUAL",t[t.GREATER_EQUAL=6]="GREATER_EQUAL",t[t.ALWAYS=7]="ALWAYS"})(p||(p={})),(function(t){t[t.ZERO=0]="ZERO",t[t.KEEP=1]="KEEP",t[t.REPLACE=2]="REPLACE",t[t.INCR=3]="INCR",t[t.DECR=4]="DECR",t[t.INVERT=5]="INVERT",t[t.INCR_WRAP=6]="INCR_WRAP",t[t.DECR_WRAP=7]="DECR_WRAP"})(m||(m={})),(function(t){t[t.ADD=0]="ADD",t[t.SUB=1]="SUB",t[t.REV_SUB=2]="REV_SUB",t[t.MIN=3]="MIN",t[t.MAX=4]="MAX"})(v||(v={})),(function(t){t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_ALPHA=2]="SRC_ALPHA",t[t.DST_ALPHA=3]="DST_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=4]="ONE_MINUS_SRC_ALPHA",t[t.ONE_MINUS_DST_ALPHA=5]="ONE_MINUS_DST_ALPHA",t[t.SRC_COLOR=6]="SRC_COLOR",t[t.DST_COLOR=7]="DST_COLOR",t[t.ONE_MINUS_SRC_COLOR=8]="ONE_MINUS_SRC_COLOR",t[t.ONE_MINUS_DST_COLOR=9]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=10]="SRC_ALPHA_SATURATE",t[t.CONSTANT_COLOR=11]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=12]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=13]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=14]="ONE_MINUS_CONSTANT_ALPHA"})(g||(g={})),(function(t){t[t.NONE=0]="NONE",t[t.R=1]="R",t[t.G=2]="G",t[t.B=4]="B",t[t.A=8]="A",t[t.ALL=15]="ALL"})(y||(y={})),(function(t){t[t.NONE=0]="NONE",t[t.POINT=1]="POINT",t[t.LINEAR=2]="LINEAR",t[t.ANISOTROPIC=3]="ANISOTROPIC"})(T||(T={})),(function(t){t[t.WRAP=0]="WRAP",t[t.MIRROR=1]="MIRROR",t[t.CLAMP=2]="CLAMP",t[t.BORDER=3]="BORDER"})(b||(b={})),(function(t){t[t.TEX1D=0]="TEX1D",t[t.TEX2D=1]="TEX2D",t[t.TEX3D=2]="TEX3D"})(E||(E={})),(function(t){t[t.NONE=0]="NONE",t[t.TRANSFER_SRC=1]="TRANSFER_SRC",t[t.TRANSFER_DST=2]="TRANSFER_DST",t[t.SAMPLED=4]="SAMPLED",t[t.STORAGE=8]="STORAGE",t[t.COLOR_ATTACHMENT=16]="COLOR_ATTACHMENT",t[t.DEPTH_STENCIL_ATTACHMENT=32]="DEPTH_STENCIL_ATTACHMENT",t[t.TRANSIENT_ATTACHMENT=64]="TRANSIENT_ATTACHMENT",t[t.INPUT_ATTACHMENT=128]="INPUT_ATTACHMENT"})(A||(A={})),(function(t){t[t.X1=0]="X1",t[t.X2=1]="X2",t[t.X4=2]="X4",t[t.X8=3]="X8",t[t.X16=4]="X16",t[t.X32=5]="X32",t[t.X64=6]="X64"})(C||(C={})),(function(t){t[t.NONE=0]="NONE",t[t.GEN_MIPMAP=1]="GEN_MIPMAP",t[t.CUBEMAP=2]="CUBEMAP",t[t.BAKUP_BUFFER=4]="BAKUP_BUFFER"})(x||(x={})),(function(t){t[t.TV1D=0]="TV1D",t[t.TV2D=1]="TV2D",t[t.TV3D=2]="TV3D",t[t.CUBE=3]="CUBE",t[t.TV1D_ARRAY=4]="TV1D_ARRAY",t[t.TV2D_ARRAY=5]="TV2D_ARRAY"})(S||(S={})),(function(t){t[t.VERTEX=0]="VERTEX",t[t.HULL=1]="HULL",t[t.DOMAIN=2]="DOMAIN",t[t.GEOMETRY=3]="GEOMETRY",t[t.FRAGMENT=4]="FRAGMENT",t[t.COMPUTE=5]="COMPUTE",t[t.COUNT=6]="COUNT"})(w||(w={})),(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.UNIFORM_BUFFER=1]="UNIFORM_BUFFER",t[t.SAMPLER=2]="SAMPLER",t[t.STORAGE_BUFFER=3]="STORAGE_BUFFER"})(M||(M={})),(function(t){t[t.PRIMARY=0]="PRIMARY",t[t.SECONDARY=1]="SECONDARY"})(R||(R={})),(function(t){t[t.LOAD=0]="LOAD",t[t.CLEAR=1]="CLEAR",t[t.DISCARD=2]="DISCARD"})(I||(I={})),(function(t){t[t.STORE=0]="STORE",t[t.DISCARD=1]="DISCARD"})(O||(O={})),(function(t){t[t.UNDEFINED=0]="UNDEFINED",t[t.GENERAL=1]="GENERAL",t[t.COLOR_ATTACHMENT_OPTIMAL=2]="COLOR_ATTACHMENT_OPTIMAL",t[t.DEPTH_STENCIL_ATTACHMENT_OPTIMAL=3]="DEPTH_STENCIL_ATTACHMENT_OPTIMAL",t[t.DEPTH_STENCIL_READONLY_OPTIMAL=4]="DEPTH_STENCIL_READONLY_OPTIMAL",t[t.SHADER_READONLY_OPTIMAL=5]="SHADER_READONLY_OPTIMAL",t[t.TRANSFER_SRC_OPTIMAL=6]="TRANSFER_SRC_OPTIMAL",t[t.TRANSFER_DST_OPTIMAL=7]="TRANSFER_DST_OPTIMAL",t[t.PREINITIALIZED=8]="PREINITIALIZED",t[t.PRESENT_SRC=9]="PRESENT_SRC"})(D||(D={})),(function(t){t[t.GRAPHICS=0]="GRAPHICS",t[t.COMPUTE=1]="COMPUTE",t[t.RAY_TRACING=2]="RAY_TRACING"})(P||(P={})),(function(t){t[t.VIEWPORT=0]="VIEWPORT",t[t.SCISSOR=1]="SCISSOR",t[t.LINE_WIDTH=2]="LINE_WIDTH",t[t.DEPTH_BIAS=3]="DEPTH_BIAS",t[t.BLEND_CONSTANTS=4]="BLEND_CONSTANTS",t[t.DEPTH_BOUNDS=5]="DEPTH_BOUNDS",t[t.STENCIL_WRITE_MASK=6]="STENCIL_WRITE_MASK",t[t.STENCIL_COMPARE_MASK=7]="STENCIL_COMPARE_MASK"})(L||(L={})),(function(t){t[t.FRONT=0]="FRONT",t[t.BACK=1]="BACK",t[t.ALL=2]="ALL"})(N||(N={})),(function(t){t[t.GRAPHICS=0]="GRAPHICS",t[t.COMPUTE=1]="COMPUTE",t[t.TRANSFER=2]="TRANSFER"})(F||(F={})),(function(t){t[t.NONE=0]="NONE",t[t.COLOR=1]="COLOR",t[t.DEPTH=2]="DEPTH",t[t.STENCIL=4]="STENCIL",t[t.DEPTH_STENCIL=6]="DEPTH_STENCIL",t[t.ALL=7]="ALL"})(B||(B={})),(function(t){t[t.DEFAULT=100]="DEFAULT"})(k||(k={})),(function(t){t[t.MIN=0]="MIN",t[t.MAX=255]="MAX",t[t.DEFAULT=128]="DEFAULT"})(V||(V={})),(function(t){t[t.UBO_GLOBAL=23]="UBO_GLOBAL",t[t.UBO_SHADOW=22]="UBO_SHADOW",t[t.UBO_LOCAL=21]="UBO_LOCAL",t[t.UBO_FORWARD_LIGHTS=20]="UBO_FORWARD_LIGHTS",t[t.UBO_SKINNING=19]="UBO_SKINNING",t[t.UBO_SKINNING_TEXTURE=18]="UBO_SKINNING_TEXTURE",t[t.UBO_UI=17]="UBO_UI",t[t.SAMPLER_JOINTS=25]="SAMPLER_JOINTS",t[t.SAMPLER_ENVIRONMENT=26]="SAMPLER_ENVIRONMENT",t[t.CUSTUM_UBO_BINDING_END_POINT=17]="CUSTUM_UBO_BINDING_END_POINT",t[t.CUSTOM_SAMPLER_BINDING_START_POINT=30]="CUSTOM_SAMPLER_BINDING_START_POINT"})(z||(z={})),(function(t){t[t.minFilter=0]="minFilter",t[t.magFilter=1]="magFilter",t[t.mipFilter=2]="mipFilter",t[t.addressU=3]="addressU",t[t.addressV=4]="addressV",t[t.addressW=5]="addressW",t[t.maxAnisotropy=6]="maxAnisotropy",t[t.cmpFunc=7]="cmpFunc",t[t.minLOD=8]="minLOD",t[t.maxLOD=9]="maxLOD",t[t.mipLODBias=10]="mipLODBias",t[t.borderColor=11]="borderColor",t[t.total=15]="total"})(W||(W={}));var G={};G[G.bool=s.BOOL]="bool",G[G.int=s.INT]="int",G[G.ivec2=s.INT2]="ivec2invTypeParams",G[G.ivec3=s.INT3]="ivec3",G[G.ivec4=s.INT4]="ivec4",G[G.float=s.FLOAT]="float",G[G.vec2=s.FLOAT2]="vec2",G[G.vec3=s.FLOAT3]="vec3",G[G.vec4=s.FLOAT4]="vec4",G[G.mat2=s.MAT2]="mat2",G[G.mat3=s.MAT3]="mat3",G[G.mat4=s.MAT4]="mat4",G[G.sampler2D=s.SAMPLER2D]="sampler2D",G[G.samplerCube=s.SAMPLER_CUBE]="samplerCube";var j=((U={})[s.BOOL]=4,U[s.INT]=4,U[s.INT2]=8,U[s.INT3]=12,U[s.INT4]=16,U[s.FLOAT]=4,U[s.FLOAT2]=8,U[s.FLOAT3]=12,U[s.FLOAT4]=16,U[s.MAT2]=16,U[s.MAT3]=36,U[s.MAT4]=64,U[s.SAMPLER2D]=4,U[s.SAMPLER_CUBE]=4,U),Y=((H={})[s.BOOL]=o.R32I,H[s.INT]=o.R32I,H[s.INT2]=o.RG32I,H[s.INT3]=o.RGB32I,H[s.INT4]=o.RGBA32I,H[s.FLOAT]=o.R32F,H[s.FLOAT2]=o.RG32F,H[s.FLOAT3]=o.RGB32F,H[s.FLOAT4]=o.RGBA32F,H),X={BACK:1029,FRONT:1028,NONE:0,ADD:32774,SUB:32778,REV_SUB:32779,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,SRC_ALPHA_SATURATE:776,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,INCR_WRAP:34055,DECR:7683,DECR_WRAP:34056,INVERT:5386};Object.assign(X,k);var q={murmurhash2_32_gc:function(t,e){for(var i,n=t.length,r=e^n,a=0;n>=4;)i=1540483477*(65535&(i=255&t.charCodeAt(a)|(255&t.charCodeAt(++a))<<8|(255&t.charCodeAt(++a))<<16|(255&t.charCodeAt(++a))<<24))+((1540483477*(i>>>16)&65535)<<16),r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),n-=4,++a;switch(n){case 3:r^=(255&t.charCodeAt(a+2))<<16;case 2:r^=(255&t.charCodeAt(a+1))<<8;case 1:r=1540483477*(65535&(r^=255&t.charCodeAt(a)))+((1540483477*(r>>>16)&65535)<<16)}return r=1540483477*(65535&(r^=r>>>13))+((1540483477*(r>>>16)&65535)<<16),(r^=r>>>15)>>>0},SamplerInfoIndex:W,effectStructure:{$techniques:[{$passes:[{depthStencilState:{},rasterizerState:{},blendState:{targets:[{}]},properties:{any:{sampler:{},inspector:{}}}}]}]},typeMap:G,sizeMap:j,formatMap:Y,passParams:X,RenderQueue:{OPAQUE:0,TRANSPARENT:1,OVERLAY:2},RenderPriority:V,GFXGetTypeSize:function(t){switch(t){case s.BOOL:case s.INT:case s.UINT:case s.FLOAT:return 4;case s.BOOL2:case s.INT2:case s.UINT2:case s.FLOAT2:return 8;case s.BOOL3:case s.INT3:case s.UINT3:case s.FLOAT3:return 12;case s.BOOL4:case s.INT4:case s.UINT4:case s.FLOAT4:case s.MAT2:return 16;case s.MAT2X3:return 24;case s.MAT2X4:return 32;case s.MAT3X2:return 24;case s.MAT3:return 36;case s.MAT3X4:return 48;case s.MAT4X2:case s.MAT4X2:return 32;case s.MAT4:return 64;case s.SAMPLER1D:case s.SAMPLER1D_ARRAY:case s.SAMPLER2D:case s.SAMPLER2D_ARRAY:case s.SAMPLER3D:case s.SAMPLER_CUBE:return 4;default:return 0}},UniformBinding:z};e.exports=q}),{}],315:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=t("../memop"),r=l(t("../enums")),a=t("../../core/value-types"),s=l(t("./program-lib")),o=l(t("./view")),c=l(t("../gfx"));function l(t){return t&&t.__esModule?t:{default:t}}var u=new a.Mat4,h=new n.RecyclePool(function(){return{stage:null,items:null}},8),f=new n.RecyclePool(function(){return new Float32Array(2)},8),d=new n.RecyclePool(function(){return new Float32Array(3)},8),_=new n.RecyclePool(function(){return new Float32Array(4)},8),p=new n.RecyclePool(function(){return new Float32Array(9)},8),m=new n.RecyclePool(function(){return new Float32Array(16)},8),v=new n.RecyclePool(function(){return new Float32Array(64)},8),g=new n.RecyclePool(function(){return new Int32Array(2)},8),y=new n.RecyclePool(function(){return new Int32Array(3)},8),T=new n.RecyclePool(function(){return new Int32Array(4)},8),b=new n.RecyclePool(function(){return new Int32Array(64)},8),E=(function(){function t(t,e){var i;this._device=t,this._programLib=new s.default(t),this._opts=e,this._type2defaultValue=((i={})[r.default.PARAM_INT]=0,i[r.default.PARAM_INT2]=new a.Vec2(0,0),i[r.default.PARAM_INT3]=new a.Vec3(0,0,0),i[r.default.PARAM_INT4]=new a.Vec4(0,0,0,0),i[r.default.PARAM_FLOAT]=0,i[r.default.PARAM_FLOAT2]=new a.Vec2(0,0),i[r.default.PARAM_FLOAT3]=new a.Vec3(0,0,0),i[r.default.PARAM_FLOAT4]=new a.Vec4(0,0,0,0),i[r.default.PARAM_COLOR4]=new a.Color(0,0,0,1),i[r.default.PARAM_MAT3]=new a.Mat3,i[r.default.PARAM_MAT4]=new a.Mat4,i[r.default.PARAM_TEXTURE_2D]=e.defaultTexture,i[r.default.PARAM_TEXTURE_CUBE]=e.defaultTextureCube,i),this._stage2fn={},this._usedTextureUnits=0,this._viewPools=new n.RecyclePool(function(){return new o.default},8),this._drawItemsPools=new n.RecyclePool(function(){return{model:null,node:null,ia:null,effect:null,defines:null,uniforms:null}},100),this._stageItemsPools=new n.RecyclePool(function(){return new n.RecyclePool(function(){return{model:null,node:null,ia:null,effect:null,defines:null,passes:[],sortKey:-1,uniforms:null}},100)},16)}var e=t.prototype;return e._resetTextuerUnit=function(){this._usedTextureUnits=0},e._allocTextureUnit=function(){var t=this._device,e=this._usedTextureUnits;return e>=t._caps.maxTextureUnits&&console.warn("Trying to use "+e+" texture units while this GPU supports only "+t._caps.maxTextureUnits),this._usedTextureUnits+=1,e},e._registerStage=function(t,e){this._stage2fn[t]=e},e.clear=function(){this._programLib.clear(),this.reset()},e.reset=function(){this._viewPools.reset(),this._stageItemsPools.reset()},e._requestView=function(){return this._viewPools.add()},e._render=function(t,e){var i=this._device;i.setFrameBuffer(t._framebuffer),i.setViewport(t._rect.x,t._rect.y,t._rect.w,t._rect.h);var n={};t._clearFlags&r.default.CLEAR_COLOR&&(n.color=a.Vec4.toArray([],t._color)),t._clearFlags&r.default.CLEAR_DEPTH&&(n.depth=t._depth),t._clearFlags&r.default.CLEAR_STENCIL&&(n.stencil=t._stencil),i.clear(n),this._drawItemsPools.reset();for(var s=0;s<e._models.length;++s){var o=e._models.data[s];if(0!=(o._cullingMask&t._cullingMask)){var c=this._drawItemsPools.add();o.extractDrawItem(c)}}h.reset();for(var l=0;l<t._stages.length;++l){var u=t._stages[l],f=this._stageItemsPools.add();f.reset();for(var d=0;d<this._drawItemsPools.length;++d){var _=this._drawItemsPools.data[d],p=_.effect.stagePasses[u];if(p&&0!==p.length){var m=f.add();m.passes=p,m.model=_.model,m.node=_.node,m.ia=_.ia,m.effect=_.effect,m.defines=_.defines,m.sortKey=-1,m.uniforms=_.uniforms}}var v=h.add();v.stage=u,v.items=f}for(var g=0;g<h.length;++g){var y=h.data[g];(0,this._stage2fn[y.stage])(t,y.items)}},e._setProperty=function(t){var e=this._device,i=t.value;if(void 0===i&&(i=t.val),void 0===i&&(i=this._type2defaultValue[t.type]),void 0!==i)if(t.type===r.default.PARAM_TEXTURE_2D||t.type===r.default.PARAM_TEXTURE_CUBE)if(Array.isArray(i)){if(i.length>t.count)return void console.error("Failed to set property ["+t.name+"] : The length of texture array ["+i.length+"] is bigger than ["+t.count+"].");for(var n=b.add(),a=0;a<i.length;++a)n[a]=this._allocTextureUnit();e.setTextureArray(t.name,i,n)}else e.setTexture(t.name,i,this._allocTextureUnit());else t.directly?e.setUniformDirectly(t.name,i):e.setUniform(t.name,i);else console.warn("Failed to set technique property "+t.name+", value not found.")},e._draw=function(t){var e=this._device,i=this._programLib,n=t.node,r=t.ia,s=t.passes,o=t.effect;f.reset(),d.reset(),_.reset(),p.reset(),m.reset(),v.reset(),g.reset(),y.reset(),T.reset(),b.reset(),n.getWorldMatrix(u),e.setUniform("cc_matWorld",a.Mat4.toArray(m.add(),u)),a.Mat4.invert(u,u),a.Mat4.transpose(u,u),e.setUniform("cc_matWorldIT",a.Mat4.toArray(m.add(),u));for(var l=this._defines,h=0;h<s.length;++h){var E=s[h],A=r.count;r._vertexBuffer&&e.setVertexBuffer(0,r._vertexBuffer),r._indexBuffer&&e.setIndexBuffer(r._indexBuffer),e.setPrimitiveType(r._primitiveType),Object.setPrototypeOf(l,E._defines);var C=i.getProgram(E._programName,l,o.name);e.setProgram(C);for(var x=C._uniforms,S=E._properties,w=0;w<x.length;w++){var M=S[x[w].name];void 0!==M&&this._setProperty(M)}e.setCullMode(E._cullMode),E._blend&&(e.enableBlend(),e.setBlendFuncSep(E._blendSrc,E._blendDst,E._blendSrcAlpha,E._blendDstAlpha),e.setBlendEqSep(E._blendEq,E._blendAlphaEq),e.setBlendColor32(E._blendColor)),E._depthTest&&(e.enableDepthTest(),e.setDepthFunc(E._depthFunc)),E._depthWrite&&e.enableDepthWrite(),e.setStencilTest(E._stencilTest),E._stencilTest===c.default.STENCIL_ENABLE&&(e.setStencilFuncFront(E._stencilFuncFront,E._stencilRefFront,E._stencilMaskFront),e.setStencilOpFront(E._stencilFailOpFront,E._stencilZFailOpFront,E._stencilZPassOpFront,E._stencilWriteMaskFront),e.setStencilFuncBack(E._stencilFuncBack,E._stencilRefBack,E._stencilMaskBack),e.setStencilOpBack(E._stencilFailOpBack,E._stencilZFailOpBack,E._stencilZPassOpBack,E._stencilWriteMaskBack)),e.draw(r._start,A),this._resetTextuerUnit()}},t})();i.default=E,e.exports=i.default}),{"../../core/value-types":293,"../enums":321,"../gfx":326,"../memop":338,"./program-lib":318,"./view":320}],316:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=(n=t("../gfx"))&&n.__esModule?n:{default:n};function a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=(function(){function t(t,e,i){void 0===i&&(i=r.default.PT_TRIANGLES),this._vertexBuffer=t,this._indexBuffer=e,this._primitiveType=i,this._start=0,this._count=-1}var e,i;return e=t,(i=[{key:"count",get:function(){return-1!==this._count?this._count:this._indexBuffer?this._indexBuffer.count:this._vertexBuffer?this._vertexBuffer.count:0}}])&&a(e.prototype,i),t})();i.default=s,e.exports=i.default}),{"../gfx":326}],317:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=s(t("../gfx")),r=s(t("../enums")),a=s(t("../../core/value-types/value-type"));function s(t){return t&&t.__esModule?t:{default:t}}var o=(function(){function t(t,e,i,r,a,s){void 0===a&&(a={}),void 0===s&&(s={}),this._name=t,this._detailName=e,this._programName=i,this._stage=r,this._properties=a,this._defines=s,this._cullMode=n.default.CULL_BACK,this._blend=!1,this._blendEq=n.default.BLEND_FUNC_ADD,this._blendAlphaEq=n.default.BLEND_FUNC_ADD,this._blendSrc=n.default.BLEND_SRC_ALPHA,this._blendDst=n.default.BLEND_ONE_MINUS_SRC_ALPHA,this._blendSrcAlpha=n.default.BLEND_SRC_ALPHA,this._blendDstAlpha=n.default.BLEND_ONE_MINUS_SRC_ALPHA,this._blendColor=4294967295,this._depthTest=!1,this._depthWrite=!1,this._depthFunc=n.default.DS_FUNC_LESS,this._stencilTest=n.default.STENCIL_INHERIT,this._stencilFuncFront=n.default.DS_FUNC_ALWAYS,this._stencilRefFront=0,this._stencilMaskFront=255,this._stencilFailOpFront=n.default.STENCIL_OP_KEEP,this._stencilZFailOpFront=n.default.STENCIL_OP_KEEP,this._stencilZPassOpFront=n.default.STENCIL_OP_KEEP,this._stencilWriteMaskFront=255,this._stencilFuncBack=n.default.DS_FUNC_ALWAYS,this._stencilRefBack=0,this._stencilMaskBack=255,this._stencilFailOpBack=n.default.STENCIL_OP_KEEP,this._stencilZFailOpBack=n.default.STENCIL_OP_KEEP,this._stencilZPassOpBack=n.default.STENCIL_OP_KEEP,this._stencilWriteMaskBack=255}var e=t.prototype;return e.setCullMode=function(t){void 0===t&&(t=n.default.CULL_BACK),this._cullMode=t},e.setBlend=function(t,e,i,r,a,s,o,c){void 0===t&&(t=!1),void 0===e&&(e=n.default.BLEND_FUNC_ADD),void 0===i&&(i=n.default.BLEND_SRC_ALPHA),void 0===r&&(r=n.default.BLEND_ONE_MINUS_SRC_ALPHA),void 0===a&&(a=n.default.BLEND_FUNC_ADD),void 0===s&&(s=n.default.BLEND_SRC_ALPHA),void 0===o&&(o=n.default.BLEND_ONE_MINUS_SRC_ALPHA),void 0===c&&(c=4294967295),this._blend=t,this._blendEq=e,this._blendSrc=i,this._blendDst=r,this._blendAlphaEq=a,this._blendSrcAlpha=s,this._blendDstAlpha=o,this._blendColor=c},e.setDepth=function(t,e,i){void 0===t&&(t=!1),void 0===e&&(e=!1),void 0===i&&(i=n.default.DS_FUNC_LESS),this._depthTest=t,this._depthWrite=e,this._depthFunc=i},e.setStencilFront=function(t,e,i,r,a,s,o,c){void 0===t&&(t=n.default.STENCIL_INHERIT),void 0===e&&(e=n.default.DS_FUNC_ALWAYS),void 0===i&&(i=0),void 0===r&&(r=255),void 0===a&&(a=n.default.STENCIL_OP_KEEP),void 0===s&&(s=n.default.STENCIL_OP_KEEP),void 0===o&&(o=n.default.STENCIL_OP_KEEP),void 0===c&&(c=255),this._stencilTest=t,this._stencilFuncFront=e,this._stencilRefFront=i,this._stencilMaskFront=r,this._stencilFailOpFront=a,this._stencilZFailOpFront=s,this._stencilZPassOpFront=o,this._stencilWriteMaskFront=c},e.setStencilEnabled=function(t){void 0===t&&(t=n.default.STENCIL_INHERIT),this._stencilTest=t},e.setStencilBack=function(t,e,i,r,a,s,o,c){void 0===t&&(t=n.default.STENCIL_INHERIT),void 0===e&&(e=n.default.DS_FUNC_ALWAYS),void 0===i&&(i=0),void 0===r&&(r=255),void 0===a&&(a=n.default.STENCIL_OP_KEEP),void 0===s&&(s=n.default.STENCIL_OP_KEEP),void 0===o&&(o=n.default.STENCIL_OP_KEEP),void 0===c&&(c=255),this._stencilTest=t,this._stencilFuncBack=e,this._stencilRefBack=i,this._stencilMaskBack=r,this._stencilFailOpBack=a,this._stencilZFailOpBack=s,this._stencilZPassOpBack=o,this._stencilWriteMaskBack=c},e.setStage=function(t){this._stage=t},e.setProperties=function(t){this._properties=t},e.getProperty=function(t){if(this._properties[t])return this._properties[t].value},e.setProperty=function(t,e,i){var n=this._properties[t];if(!n)return!1;if(n.directly=i,Array.isArray(e)){var s=n.value;if(s.length!==e.length)return void cc.warnID(9105,this._name,t);for(var o=0;o<e.length;o++)s[o]=e[o]}else e&&!ArrayBuffer.isView(e)?n.type===r.default.PARAM_TEXTURE_2D?n.value=e.getImpl():e instanceof a.default?e.constructor.toArray(n.value,e):("object"==typeof e&&cc.warnID(9106,this._name,t),n.value=e):n.value=e;return!0},e.getDefine=function(t){return this._defines[t]},e.define=function(t,e,i){return!(!i&&void 0===this._defines[t])&&(this._defines[t]=e,!0)},e.clone=function(){var e=new t(this._programName);Object.assign(e,this);var i={},n=this._properties;for(var r in n){var a=n[r],s=i[r]={},o=a.value;for(var c in Array.isArray(o)?s.value=o.concat():ArrayBuffer.isView(o)?s.value=new o.__proto__.constructor(o):s.value=o,a)"value"!==c&&(s[c]=a[c])}return e._properties=i,e._defines=Object.assign({},this._defines),e},t})();i.default=o,e.exports=i.default}),{"../../core/value-types/value-type":301,"../enums":321,"../gfx":326}],318:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=(n=t("../gfx"))&&n.__esModule?n:{default:n},a=0;function s(t,e){for(var i=[],n=0;n<t.length;n++){var r=t[n].name,a=e[r];"number"!=typeof a&&(a=a?1:0),i.push("#define "+r+" "+a)}return i.join("\n")+"\n"}function o(t,e,i){for(var n=t,r=0;r<e.length;r++){var a=e[r].name,s=i[a];if(Number.isInteger(s)){var o=new RegExp(a,"g");n=n.replace(o,s)}}return n}function c(t){return t.replace(/#pragma for (\w+) in range\(\s*(\d+)\s*,\s*(\d+)\s*\)([\s\S]+?)#pragma endFor/g,(function(t,e,i,n,r){var a="",s=parseInt(i),o=parseInt(n);(s.isNaN||o.isNaN)&&console.error("Unroll For Loops Error: begin and end of range must be an int num.");for(var c=s;c<o;++c)a+=r.replace(new RegExp("{"+e+"}","g"),c);return a}))}function l(t){return t.replace(/\bhighp\b/g,"mediump")}var u=(function(){function t(t){this._device=t,this._templates={},this._cache={},this._checkPrecision()}var e=t.prototype;return e.clear=function(){this._templates={},this._cache={}},e.define=function(t){var e=t.name,i=t.defines,n=t.glsl1||t,r=n.vert,s=n.frag;if(!this._templates[e]){for(var o=++a,c=0,l=0;l<i.length;++l){var u=i[l],h=1;if("number"===u.type){var f=u.range||[];u.min=f[0]||0,u.max=f[1]||4,h=Math.ceil(Math.log2(u.max-u.min)),u._map=function(t){return t-this.min<<this._offset}.bind(u)}else u._map=function(t){return t?1<<this._offset:0}.bind(u);u._offset=c,c+=h}var d=t.uniforms||[];if(t.samplers)for(var _=0;_<t.samplers.length;_++)d.push(t.samplers[_]);if(t.blocks)for(var p=0;p<t.blocks.length;p++)for(var m=t.blocks[p].defines,v=t.blocks[p].members,g=0;g<v.length;g++)d.push({defines:m,name:v[g].name,type:v[g].type});this._templates[e]={id:o,name:e,vert:r,frag:s,defines:i,attributes:t.attributes,uniforms:d,extensions:t.extensions}}},e.getTemplate=function(t){return this._templates[t]},e.hasProgram=function(t){return void 0!==this._templates[t]},e.getKey=function(t,e){for(var i=this._templates[t],n=0,r=0;r<i.defines.length;++r){var a=i.defines[r],s=e[a.name];void 0!==s&&(n|=a._map(s))}return i.id+":"+n},e.getProgram=function(t,e,i){var n=this.getKey(t,e),a=this._cache[n];if(a)return a;var u=this._templates[t],h=s(u.defines,e),f=o(u.vert,u.defines,e);f=h+c(f),this._highpSupported||(f=l(f));var d=o(u.frag,u.defines,e);d=h+c(d),this._highpSupported||(d=l(d));var _=(a=new r.default.Program(this._device,{vert:f,frag:d})).link();if(_){var p=f.split("\n"),m=d.split("\n"),v=u.defines.length;_.forEach((function(t){var e=t.line-1,n=t.line-v,r=("vs"===t.type?p:m)[e],a=t.info||"Failed to compile "+t.type+" "+t.fileID+" (ln "+n+"): \n "+t.message+": \n  "+r;cc.error(i+" : "+a)}))}return this._cache[n]=a,a},e._checkPrecision=function(){var t=this._device._gl,e=!1;if(t.getShaderPrecisionFormat){var i=t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT),n=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);e=i&&i.precision>0&&n&&n.precision>0}e||cc.warnID(9102),this._highpSupported=e},t})();i.default=u,e.exports=i.default}),{"../gfx":326}],319:[(function(t,e,i){"use strict";function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}i.__esModule=!0,i.default=void 0;var r=(function(){function t(t,e){this._name=t,this._passes=e}var e,i;return t.prototype.clone=function(){for(var e=[],i=0;i<this._passes.length;i++)e.push(this._passes[i].clone());return new t(this._name,e)},e=t,(i=[{key:"name",get:function(){return this._name}},{key:"passes",get:function(){return this._passes}}])&&n(e.prototype,i),t})();i.default=r,e.exports=i.default}),{}],320:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=t("../../core/value-types"),a=(n=t("../enums"))&&n.__esModule?n:{default:n},s=new r.Mat4,o=0,c=(function(){function t(){this._id=o++,this._priority=0,this._rect={x:0,y:0,w:1,h:1},this._color=new r.Vec4(.3,.3,.3,1),this._depth=1,this._stencil=0,this._clearFlags=a.default.CLEAR_COLOR|a.default.CLEAR_DEPTH,this._clearModel=null,this._matView=cc.mat4(),this._matViewInv=cc.mat4(),this._matProj=cc.mat4(),this._matViewProj=cc.mat4(),this._matInvViewProj=cc.mat4(),this._stages=[],this._cullingByID=!1,this._framebuffer=null,this._shadowLight=null,this._cullingMask=4294967295}var e=t.prototype;return e.getForward=function(t){var e=this._matView.m;return r.Vec3.set(t,-e[2],-e[6],-e[10])},e.getPosition=function(t){return r.Mat4.invert(s,this._matView),r.Mat4.getTranslation(t,s)},t})();i.default=c,e.exports=i.default}),{"../../core/value-types":293,"../enums":321}],321:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=t("./build/mappings"),r={PROJ_PERSPECTIVE:0,PROJ_ORTHO:1,LIGHT_DIRECTIONAL:0,LIGHT_POINT:1,LIGHT_SPOT:2,LIGHT_AMBIENT:3,SHADOW_NONE:0,SHADOW_HARD:1,SHADOW_SOFT:2,PARAM_INT:n.typeMap.int,PARAM_INT2:n.typeMap.ivec2,PARAM_INT3:n.typeMap.ivec3,PARAM_INT4:n.typeMap.ivec4,PARAM_FLOAT:n.typeMap.float,PARAM_FLOAT2:n.typeMap.vec2,PARAM_FLOAT3:n.typeMap.vec3,PARAM_FLOAT4:n.typeMap.vec4,PARAM_MAT2:n.typeMap.mat2,PARAM_MAT3:n.typeMap.mat3,PARAM_MAT4:n.typeMap.mat4,PARAM_TEXTURE_2D:n.typeMap.sampler2D,PARAM_TEXTURE_CUBE:n.typeMap.samplerCube,CLEAR_COLOR:1,CLEAR_DEPTH:2,CLEAR_STENCIL:4,CLEAR_SKYBOX:8,BUFFER_VIEW_INT8:0,BUFFER_VIEW_UINT8:1,BUFFER_VIEW_INT16:2,BUFFER_VIEW_UINT16:3,BUFFER_VIEW_INT32:4,BUFFER_VIEW_UINT32:5,BUFFER_VIEW_FLOAT32:6};i.default=r,e.exports=i.default}),{"./build/mappings":314}],322:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r,a=l(t("./state")),s=t("./enums"),o=l(t("./texture-2d")),c=l(t("./texture-cube"));function l(t){return t&&t.__esModule?t:{default:t}}function u(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var h=((n={})[5124]=function(t,e,i){t.uniform1i(e,i)},n[5126]=function(t,e,i){t.uniform1f(e,i)},n[35664]=function(t,e,i){t.uniform2fv(e,i)},n[35665]=function(t,e,i){t.uniform3fv(e,i)},n[35666]=function(t,e,i){t.uniform4fv(e,i)},n[35667]=function(t,e,i){t.uniform2iv(e,i)},n[35668]=function(t,e,i){t.uniform3iv(e,i)},n[35669]=function(t,e,i){t.uniform4iv(e,i)},n[35670]=function(t,e,i){t.uniform1i(e,i)},n[35671]=function(t,e,i){t.uniform2iv(e,i)},n[35672]=function(t,e,i){t.uniform3iv(e,i)},n[35673]=function(t,e,i){t.uniform4iv(e,i)},n[35674]=function(t,e,i){t.uniformMatrix2fv(e,!1,i)},n[35675]=function(t,e,i){t.uniformMatrix3fv(e,!1,i)},n[35676]=function(t,e,i){t.uniformMatrix4fv(e,!1,i)},n[35678]=function(t,e,i){t.uniform1i(e,i)},n[35680]=function(t,e,i){t.uniform1i(e,i)},n),f=((r={})[5124]=function(t,e,i){t.uniform1iv(e,i)},r[5126]=function(t,e,i){t.uniform1fv(e,i)},r[35664]=function(t,e,i){t.uniform2fv(e,i)},r[35665]=function(t,e,i){t.uniform3fv(e,i)},r[35666]=function(t,e,i){t.uniform4fv(e,i)},r[35667]=function(t,e,i){t.uniform2iv(e,i)},r[35668]=function(t,e,i){t.uniform3iv(e,i)},r[35669]=function(t,e,i){t.uniform4iv(e,i)},r[35670]=function(t,e,i){t.uniform1iv(e,i)},r[35671]=function(t,e,i){t.uniform2iv(e,i)},r[35672]=function(t,e,i){t.uniform3iv(e,i)},r[35673]=function(t,e,i){t.uniform4iv(e,i)},r[35674]=function(t,e,i){t.uniformMatrix2fv(e,!1,i)},r[35675]=function(t,e,i){t.uniformMatrix3fv(e,!1,i)},r[35676]=function(t,e,i){t.uniformMatrix4fv(e,!1,i)},r[35678]=function(t,e,i){t.uniform1iv(e,i)},r[35680]=function(t,e,i){t.uniform1iv(e,i)},r);function d(t,e,i){if(e.blend!==i.blend)return i.blend?(t.enable(t.BLEND),i.blendSrc!==s.enums.BLEND_CONSTANT_COLOR&&i.blendSrc!==s.enums.BLEND_ONE_MINUS_CONSTANT_COLOR&&i.blendDst!==s.enums.BLEND_CONSTANT_COLOR&&i.blendDst!==s.enums.BLEND_ONE_MINUS_CONSTANT_COLOR||t.blendColor((i.blendColor>>24)/255,(i.blendColor>>16&255)/255,(i.blendColor>>8&255)/255,(255&i.blendColor)/255),void(i.blendSep?(t.blendFuncSeparate(i.blendSrc,i.blendDst,i.blendSrcAlpha,i.blendDstAlpha),t.blendEquationSeparate(i.blendEq,i.blendAlphaEq)):(t.blendFunc(i.blendSrc,i.blendDst),t.blendEquation(i.blendEq)))):void t.disable(t.BLEND);!1!==i.blend&&(e.blendColor!==i.blendColor&&t.blendColor((i.blendColor>>24)/255,(i.blendColor>>16&255)/255,(i.blendColor>>8&255)/255,(255&i.blendColor)/255),e.blendSep===i.blendSep?i.blendSep?(e.blendSrc===i.blendSrc&&e.blendDst===i.blendDst&&e.blendSrcAlpha===i.blendSrcAlpha&&e.blendDstAlpha===i.blendDstAlpha||t.blendFuncSeparate(i.blendSrc,i.blendDst,i.blendSrcAlpha,i.blendDstAlpha),e.blendEq===i.blendEq&&e.blendAlphaEq===i.blendAlphaEq||t.blendEquationSeparate(i.blendEq,i.blendAlphaEq)):(e.blendSrc===i.blendSrc&&e.blendDst===i.blendDst||t.blendFunc(i.blendSrc,i.blendDst),e.blendEq!==i.blendEq&&t.blendEquation(i.blendEq)):i.blendSep?(t.blendFuncSeparate(i.blendSrc,i.blendDst,i.blendSrcAlpha,i.blendDstAlpha),t.blendEquationSeparate(i.blendEq,i.blendAlphaEq)):(t.blendFunc(i.blendSrc,i.blendDst),t.blendEquation(i.blendEq)))}function _(t,e,i){if(e.depthTest!==i.depthTest)return i.depthTest?(t.enable(t.DEPTH_TEST),t.depthFunc(i.depthFunc),void t.depthMask(i.depthWrite)):void t.disable(t.DEPTH_TEST);e.depthWrite!==i.depthWrite&&t.depthMask(i.depthWrite),!1!==i.depthTest?e.depthFunc!==i.depthFunc&&t.depthFunc(i.depthFunc):i.depthWrite&&(i.depthTest=!0,i.depthFunc=s.enums.DS_FUNC_ALWAYS,t.enable(t.DEPTH_TEST),t.depthFunc(i.depthFunc))}function p(t,e,i){if(i.stencilTest!==s.enums.STENCIL_INHERIT)return i.stencilTest!==e.stencilTest?i.stencilTest===s.enums.STENCIL_DISABLE?void t.disable(t.STENCIL_TEST):(t.enable(t.STENCIL_TEST),void(i.stencilSep?(t.stencilFuncSeparate(t.FRONT,i.stencilFuncFront,i.stencilRefFront,i.stencilMaskFront),t.stencilMaskSeparate(t.FRONT,i.stencilWriteMaskFront),t.stencilOpSeparate(t.FRONT,i.stencilFailOpFront,i.stencilZFailOpFront,i.stencilZPassOpFront),t.stencilFuncSeparate(t.BACK,i.stencilFuncBack,i.stencilRefBack,i.stencilMaskBack),t.stencilMaskSeparate(t.BACK,i.stencilWriteMaskBack),t.stencilOpSeparate(t.BACK,i.stencilFailOpBack,i.stencilZFailOpBack,i.stencilZPassOpBack)):(t.stencilFunc(i.stencilFuncFront,i.stencilRefFront,i.stencilMaskFront),t.stencilMask(i.stencilWriteMaskFront),t.stencilOp(i.stencilFailOpFront,i.stencilZFailOpFront,i.stencilZPassOpFront)))):void(i.stencilTest!==s.enums.STENCIL_DISABLE&&(e.stencilSep===i.stencilSep?i.stencilSep?(e.stencilFuncFront===i.stencilFuncFront&&e.stencilRefFront===i.stencilRefFront&&e.stencilMaskFront===i.stencilMaskFront||t.stencilFuncSeparate(t.FRONT,i.stencilFuncFront,i.stencilRefFront,i.stencilMaskFront),e.stencilWriteMaskFront!==i.stencilWriteMaskFront&&t.stencilMaskSeparate(t.FRONT,i.stencilWriteMaskFront),e.stencilFailOpFront===i.stencilFailOpFront&&e.stencilZFailOpFront===i.stencilZFailOpFront&&e.stencilZPassOpFront===i.stencilZPassOpFront||t.stencilOpSeparate(t.FRONT,i.stencilFailOpFront,i.stencilZFailOpFront,i.stencilZPassOpFront),e.stencilFuncBack===i.stencilFuncBack&&e.stencilRefBack===i.stencilRefBack&&e.stencilMaskBack===i.stencilMaskBack||t.stencilFuncSeparate(t.BACK,i.stencilFuncBack,i.stencilRefBack,i.stencilMaskBack),e.stencilWriteMaskBack!==i.stencilWriteMaskBack&&t.stencilMaskSeparate(t.BACK,i.stencilWriteMaskBack),e.stencilFailOpBack===i.stencilFailOpBack&&e.stencilZFailOpBack===i.stencilZFailOpBack&&e.stencilZPassOpBack===i.stencilZPassOpBack||t.stencilOpSeparate(t.BACK,i.stencilFailOpBack,i.stencilZFailOpBack,i.stencilZPassOpBack)):(e.stencilFuncFront===i.stencilFuncFront&&e.stencilRefFront===i.stencilRefFront&&e.stencilMaskFront===i.stencilMaskFront||t.stencilFunc(i.stencilFuncFront,i.stencilRefFront,i.stencilMaskFront),e.stencilWriteMaskFront!==i.stencilWriteMaskFront&&t.stencilMask(i.stencilWriteMaskFront),e.stencilFailOpFront===i.stencilFailOpFront&&e.stencilZFailOpFront===i.stencilZFailOpFront&&e.stencilZPassOpFront===i.stencilZPassOpFront||t.stencilOp(i.stencilFailOpFront,i.stencilZFailOpFront,i.stencilZPassOpFront)):i.stencilSep?(t.stencilFuncSeparate(t.FRONT,i.stencilFuncFront,i.stencilRefFront,i.stencilMaskFront),t.stencilMaskSeparate(t.FRONT,i.stencilWriteMaskFront),t.stencilOpSeparate(t.FRONT,i.stencilFailOpFront,i.stencilZFailOpFront,i.stencilZPassOpFront),t.stencilFuncSeparate(t.BACK,i.stencilFuncBack,i.stencilRefBack,i.stencilMaskBack),t.stencilMaskSeparate(t.BACK,i.stencilWriteMaskBack),t.stencilOpSeparate(t.BACK,i.stencilFailOpBack,i.stencilZFailOpBack,i.stencilZPassOpBack)):(t.stencilFunc(i.stencilFuncFront,i.stencilRefFront,i.stencilMaskFront),t.stencilMask(i.stencilWriteMaskFront),t.stencilOp(i.stencilFailOpFront,i.stencilZFailOpFront,i.stencilZPassOpFront))))}function m(t,e,i){e.cullMode!==i.cullMode&&(i.cullMode!==s.enums.CULL_NONE?(t.enable(t.CULL_FACE),t.cullFace(i.cullMode)):t.disable(t.CULL_FACE))}function v(t,e,i,n){var r=!1;if(-1!==n.maxStream){if(i.maxStream!==n.maxStream)r=!0;else if(i.program!==n.program)r=!0;else for(var a=0;a<n.maxStream+1;++a)if(i.vertexBuffers[a]!==n.vertexBuffers[a]||i.vertexBufferOffsets[a]!==n.vertexBufferOffsets[a]){r=!0;break}if(r){for(var s=0;s<t._caps.maxVertexAttribs;++s)t._newAttributes[s]=0;for(var o=0;o<n.maxStream+1;++o){var c=n.vertexBuffers[o],l=n.vertexBufferOffsets[o];if(c&&-1!==c._glID){e.bindBuffer(e.ARRAY_BUFFER,c._glID);for(var u=0;u<n.program._attributes.length;++u){var h=n.program._attributes[u],f=c._format.element(h.name);f?(0===t._enabledAttributes[h.location]&&(e.enableVertexAttribArray(h.location),t._enabledAttributes[h.location]=1),t._newAttributes[h.location]=1,e.vertexAttribPointer(h.location,f.num,f.type,f.normalize,f.stride,f.offset+l*f.stride)):console.warn("Can not find vertex attribute: "+h.name)}}}for(var d=0;d<t._caps.maxVertexAttribs;++d)t._enabledAttributes[d]!==t._newAttributes[d]&&(e.disableVertexAttribArray(d),t._enabledAttributes[d]=0)}}}function g(t,e,i){for(var n=0;n<i.maxTextureSlot+1;++n)if(e.textureUnits[n]!==i.textureUnits[n]){var r=i.textureUnits[n];r&&-1!==r._glID&&(t.activeTexture(t.TEXTURE0+n),t.bindTexture(r._target,r._glID))}}function y(t,e,i,n){void 0===n&&(n=0),i instanceof o.default?t.framebufferTexture2D(t.FRAMEBUFFER,e,t.TEXTURE_2D,i._glID,0):i instanceof c.default?t.framebufferTexture2D(t.FRAMEBUFFER,e,t.TEXTURE_CUBE_MAP_POSITIVE_X+n,i._glID,0):t.framebufferRenderbuffer(t.FRAMEBUFFER,e,t.RENDERBUFFER,i._glID)}var T=(function(){var t,e;function i(t,e){var i;void 0===(e=e||{}).alpha&&(e.alpha=!1),void 0===e.stencil&&(e.stencil=!0),void 0===e.depth&&(e.depth=!0),void 0===e.antialias&&(e.antialias=!1),void 0===e.preserveDrawingBuffer&&(e.preserveDrawingBuffer=!1);try{i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)||t.getContext("webkit-3d",e)||t.getContext("moz-webgl",e)}catch(r){return void console.error(r)}i||console.error("This device does not support webgl"),this._gl=i,this._extensions={},this._caps={},this._stats={texture:0,vb:0,ib:0,drawcalls:0},this._initExtensions(["EXT_texture_filter_anisotropic","EXT_shader_texture_lod","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_depth_texture","WEBGL_draw_buffers"]),this._initCaps(),this._initStates(),a.default.initDefault(this),this._current=new a.default(this),this._next=new a.default(this),this._uniforms={},this._vx=this._vy=this._vw=this._vh=0,this._sx=this._sy=this._sw=this._sh=0,this._framebuffer=null,this._enabledAttributes=new Array(this._caps.maxVertexAttribs),this._newAttributes=new Array(this._caps.maxVertexAttribs);for(var n=0;n<this._caps.maxVertexAttribs;++n)this._enabledAttributes[n]=0,this._newAttributes[n]=0}t=i,(e=[{key:"caps",get:function(){return this._caps}}])&&u(t.prototype,e);var n=i.prototype;return n._initExtensions=function(t){for(var e=this._gl,i=0;i<t.length;++i)for(var n=t[i],r=["","WEBKIT_","MOZ_"],a=0;a<r.length;a++)try{var s=e.getExtension(r[a]+n);if(s){this._extensions[n]=s;break}}catch(o){console.error(o)}},n._initCaps=function(){var t=this._gl,e=this.ext("WEBGL_draw_buffers");this._caps.maxVertexStreams=4,this._caps.maxVertexTextures=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),this._caps.maxFragUniforms=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),this._caps.maxTextureUnits=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),this._caps.maxVertexAttribs=t.getParameter(t.MAX_VERTEX_ATTRIBS),this._caps.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this._caps.maxDrawBuffers=e?t.getParameter(e.MAX_DRAW_BUFFERS_WEBGL):1,this._caps.maxColorAttachments=e?t.getParameter(e.MAX_COLOR_ATTACHMENTS_WEBGL):1},n._initStates=function(){var t=this._gl;t.disable(t.BLEND),t.blendFunc(t.ONE,t.ZERO),t.blendEquation(t.FUNC_ADD),t.blendColor(1,1,1,1),t.colorMask(!0,!0,!0,!0),t.enable(t.CULL_FACE),t.cullFace(t.BACK),t.disable(t.DEPTH_TEST),t.depthFunc(t.LESS),t.depthMask(!1),t.disable(t.POLYGON_OFFSET_FILL),t.depthRange(0,1),t.disable(t.STENCIL_TEST),t.stencilFunc(t.ALWAYS,0,255),t.stencilMask(255),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearDepth(1),t.clearColor(0,0,0,0),t.clearStencil(0),t.disable(t.SCISSOR_TEST)},n._restoreTexture=function(t){var e=this._gl,i=this._current.textureUnits[t];i&&-1!==i._glID?e.bindTexture(i._target,i._glID):e.bindTexture(e.TEXTURE_2D,null)},n._restoreIndexBuffer=function(){var t=this._gl,e=this._current.indexBuffer;e&&-1!==e._glID?t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e._glID):t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)},n.ext=function(t){return this._extensions[t]},n.allowFloatTexture=function(){return null!=this.ext("OES_texture_float")},n.setFrameBuffer=function(t){if(this._framebuffer!==t){this._framebuffer=t;var e=this._gl;if(t){e.bindFramebuffer(e.FRAMEBUFFER,t._glID);for(var i=t._colors.length,n=0;n<i;++n){var r=t._colors[n];y(e,e.COLOR_ATTACHMENT0+n,r)}for(var a=i;a<this._caps.maxColorAttachments;++a)e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+a,e.TEXTURE_2D,null,0);t._depth&&y(e,e.DEPTH_ATTACHMENT,t._depth),t._stencil&&y(e,e.STENCIL_ATTACHMENT,t._stencil),t._depthStencil&&y(e,e.DEPTH_STENCIL_ATTACHMENT,t._depthStencil)}else e.bindFramebuffer(e.FRAMEBUFFER,null)}},n.setViewport=function(t,e,i,n){this._vx===t&&this._vy===e&&this._vw===i&&this._vh===n||(this._gl.viewport(t,e,i,n),this._vx=t,this._vy=e,this._vw=i,this._vh=n)},n.setScissor=function(t,e,i,n){this._sx===t&&this._sy===e&&this._sw===i&&this._sh===n||(this._gl.scissor(t,e,i,n),this._sx=t,this._sy=e,this._sw=i,this._sh=n)},n.clear=function(t){if(void 0!==t.color||void 0!==t.depth||void 0!==t.stencil){var e=this._gl,i=0;void 0!==t.color&&(i|=e.COLOR_BUFFER_BIT,e.clearColor(t.color[0],t.color[1],t.color[2],t.color[3])),void 0!==t.depth&&(i|=e.DEPTH_BUFFER_BIT,e.clearDepth(t.depth),e.enable(e.DEPTH_TEST),e.depthMask(!0),e.depthFunc(e.ALWAYS)),void 0!==t.stencil&&(i|=e.STENCIL_BUFFER_BIT,e.clearStencil(t.stencil)),e.clear(i),void 0!==t.depth&&(!1===this._current.depthTest?e.disable(e.DEPTH_TEST):(!1===this._current.depthWrite&&e.depthMask(!1),this._current.depthFunc!==s.enums.DS_FUNC_ALWAYS&&e.depthFunc(this._current.depthFunc)))}},n.enableBlend=function(){this._next.blend=!0},n.enableDepthTest=function(){this._next.depthTest=!0},n.enableDepthWrite=function(){this._next.depthWrite=!0},n.setStencilTest=function(t){this._next.stencilTest=t},n.setStencilFunc=function(t,e,i){this._next.stencilSep=!1,this._next.stencilFuncFront=this._next.stencilFuncBack=t,this._next.stencilRefFront=this._next.stencilRefBack=e,this._next.stencilMaskFront=this._next.stencilMaskBack=i},n.setStencilFuncFront=function(t,e,i){this._next.stencilSep=!0,this._next.stencilFuncFront=t,this._next.stencilRefFront=e,this._next.stencilMaskFront=i},n.setStencilFuncBack=function(t,e,i){this._next.stencilSep=!0,this._next.stencilFuncBack=t,this._next.stencilRefBack=e,this._next.stencilMaskBack=i},n.setStencilOp=function(t,e,i,n){this._next.stencilFailOpFront=this._next.stencilFailOpBack=t,this._next.stencilZFailOpFront=this._next.stencilZFailOpBack=e,this._next.stencilZPassOpFront=this._next.stencilZPassOpBack=i,this._next.stencilWriteMaskFront=this._next.stencilWriteMaskBack=n},n.setStencilOpFront=function(t,e,i,n){this._next.stencilSep=!0,this._next.stencilFailOpFront=t,this._next.stencilZFailOpFront=e,this._next.stencilZPassOpFront=i,this._next.stencilWriteMaskFront=n},n.setStencilOpBack=function(t,e,i,n){this._next.stencilSep=!0,this._next.stencilFailOpBack=t,this._next.stencilZFailOpBack=e,this._next.stencilZPassOpBack=i,this._next.stencilWriteMaskBack=n},n.setDepthFunc=function(t){this._next.depthFunc=t},n.setBlendColor32=function(t){this._next.blendColor=t},n.setBlendColor=function(t,e,i,n){this._next.blendColor=(255*t<<24|255*e<<16|255*i<<8|255*n)>>>0},n.setBlendFunc=function(t,e){this._next.blendSep=!1,this._next.blendSrc=t,this._next.blendDst=e},n.setBlendFuncSep=function(t,e,i,n){this._next.blendSep=!0,this._next.blendSrc=t,this._next.blendDst=e,this._next.blendSrcAlpha=i,this._next.blendDstAlpha=n},n.setBlendEq=function(t){this._next.blendSep=!1,this._next.blendEq=t},n.setBlendEqSep=function(t,e){this._next.blendSep=!0,this._next.blendEq=t,this._next.blendAlphaEq=e},n.setCullMode=function(t){this._next.cullMode=t},n.setVertexBuffer=function(t,e,i){void 0===i&&(i=0),this._next.vertexBuffers[t]=e,this._next.vertexBufferOffsets[t]=i,this._next.maxStream<t&&(this._next.maxStream=t)},n.setIndexBuffer=function(t){this._next.indexBuffer=t},n.setProgram=function(t){this._next.program=t},n.setTexture=function(t,e,i){i>=this._caps.maxTextureUnits?console.warn("Can not set texture "+t+" at stage "+i+", max texture exceed: "+this._caps.maxTextureUnits):(this._next.textureUnits[i]=e,this.setUniform(t,i),this._next.maxTextureSlot<i&&(this._next.maxTextureSlot=i))},n.setTextureArray=function(t,e,i){var n=e.length;if(n>=this._caps.maxTextureUnits)console.warn("Can not set "+n+" textures for "+t+", max texture exceed: "+this._caps.maxTextureUnits);else{for(var r=0;r<n;++r){var a=i[r];this._next.textureUnits[a]=e[r],this._next.maxTextureSlot<a&&(this._next.maxTextureSlot=a)}this.setUniform(t,i)}},n.setUniform=function(t,e){var i=this._uniforms[t],n=!1,r=!1,a=!1,s=!1;do{if(!i)break;if(a=Array.isArray(e)||e instanceof Float32Array,s=e instanceof Int32Array,r=a||s,i.isArray!==r)break;if(i.isArray&&i.value.length!==e.length)break;n=!0}while(0);if(n){var o=i.value,c=!1;if(i.isArray)for(var l=0,u=o.length;l<u;l++)o[l]!==e[l]&&(c=!0,o[l]=e[l]);else o!==e&&(c=!0,i.value=e);c&&(i.dirty=!0)}else{var h=e;a?h=new Float32Array(e):s&&(h=new Int32Array(e)),i={dirty:!0,value:h,isArray:r}}this._uniforms[t]=i},n.setUniformDirectly=function(t,e){var i=this._uniforms[t];i||(this._uniforms[t]=i={}),i.dirty=!0,i.value=e},n.setPrimitiveType=function(t){this._next.primitiveType=t},n.resetDrawCalls=function(){this._stats.drawcalls=0},n.getDrawCalls=function(){return this._stats.drawcalls},n.draw=function(t,e){var i=this._gl,n=this._current,r=this._next;d(i,n,r),_(i,n,r),p(i,n,r),m(i,n,r),v(this,i,n,r),n.indexBuffer!==r.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,r.indexBuffer&&-1!==r.indexBuffer._glID?r.indexBuffer._glID:null);var a=!1;n.program!==r.program&&(r.program._linked?i.useProgram(r.program._glID):console.warn("Failed to use program: has not linked yet."),a=!0),g(i,n,r);for(var s=0;s<r.program._uniforms.length;++s){var o=r.program._uniforms[s],c=this._uniforms[o.name];if(c&&(a||c.dirty)){c.dirty=!1;var l=void 0===o.size?h[o.type]:f[o.type];l?l(i,o.location,c.value):console.warn("Can not find commit function for uniform "+o.name)}}e&&(r.indexBuffer?i.drawElements(this._next.primitiveType,e,r.indexBuffer._format,t*r.indexBuffer._bytesPerIndex):i.drawArrays(this._next.primitiveType,t,e),this._stats.drawcalls++),n.set(r),r.reset()},i})();i.default=T,e.exports=i.default}),{"./enums":323,"./state":330,"./texture-2d":331,"./texture-cube":332}],323:[(function(t,e,i){"use strict";i.__esModule=!0,i.attrTypeBytes=function(t){return t===a.ATTR_TYPE_INT8?1:t===a.ATTR_TYPE_UINT8?1:t===a.ATTR_TYPE_INT16?2:t===a.ATTR_TYPE_UINT16?2:t===a.ATTR_TYPE_INT32?4:t===a.ATTR_TYPE_UINT32?4:t===a.ATTR_TYPE_FLOAT32?4:(console.warn("Unknown ATTR_TYPE: "+t),0)},i.glFilter=function(t,e,i){void 0===i&&(i=-1);var r=n[e][i+1];return void 0===r?(console.warn("Unknown FILTER: "+e),-1===i?t.LINEAR:t.LINEAR_MIPMAP_LINEAR):r},i.glTextureFmt=function(t){var e=r[t];return void 0===e?(console.warn("Unknown TEXTURE_FMT: "+t),r[a.TEXTURE_FMT_RGBA8]):e},i.enums=void 0;var n=[[9728,9984,9986],[9729,9985,9987]],r=[{format:6407,internalFormat:33776,pixelType:null},{format:6408,internalFormat:33777,pixelType:null},{format:6408,internalFormat:33778,pixelType:null},{format:6408,internalFormat:33779,pixelType:null},{format:6407,internalFormat:36196,pixelType:null},{format:6407,internalFormat:35841,pixelType:null},{format:6408,internalFormat:35843,pixelType:null},{format:6407,internalFormat:35840,pixelType:null},{format:6408,internalFormat:35842,pixelType:null},{format:6406,internalFormat:6406,pixelType:5121},{format:6409,internalFormat:6409,pixelType:5121},{format:6410,internalFormat:6410,pixelType:5121},{format:6407,internalFormat:6407,pixelType:33635},{format:6408,internalFormat:6408,pixelType:32820},{format:6408,internalFormat:6408,pixelType:32819},{format:6407,internalFormat:6407,pixelType:5121},{format:6408,internalFormat:6408,pixelType:5121},{format:6407,internalFormat:6407,pixelType:36193},{format:6408,internalFormat:6408,pixelType:36193},{format:6407,internalFormat:6407,pixelType:5126},{format:6408,internalFormat:6408,pixelType:5126},{format:null,internalFormat:null,pixelType:null},{format:null,internalFormat:null,pixelType:null},{format:null,internalFormat:null,pixelType:null},{format:null,internalFormat:null,pixelType:null},{format:6402,internalFormat:6402,pixelType:5123},{format:6402,internalFormat:6402,pixelType:5125},{format:6402,internalFormat:6402,pixelType:5125},{format:6407,internalFormat:37492,pixelType:null},{format:6408,internalFormat:37496,pixelType:null}],a={USAGE_STATIC:35044,USAGE_DYNAMIC:35048,USAGE_STREAM:35040,INDEX_FMT_UINT8:5121,INDEX_FMT_UINT16:5123,INDEX_FMT_UINT32:5125,ATTR_POSITION:"a_position",ATTR_NORMAL:"a_normal",ATTR_TANGENT:"a_tangent",ATTR_BITANGENT:"a_bitangent",ATTR_WEIGHTS:"a_weights",ATTR_JOINTS:"a_joints",ATTR_COLOR:"a_color",ATTR_COLOR0:"a_color0",ATTR_COLOR1:"a_color1",ATTR_UV:"a_uv",ATTR_UV0:"a_uv0",ATTR_UV1:"a_uv1",ATTR_UV2:"a_uv2",ATTR_UV3:"a_uv3",ATTR_UV4:"a_uv4",ATTR_UV5:"a_uv5",ATTR_UV6:"a_uv6",ATTR_UV7:"a_uv7",ATTR_TEX_COORD:"a_texCoord",ATTR_TEX_COORD1:"a_texCoord1",ATTR_TEX_COORD2:"a_texCoord2",ATTR_TEX_COORD3:"a_texCoord3",ATTR_TEX_COORD4:"a_texCoord4",ATTR_TEX_COORD5:"a_texCoord5",ATTR_TEX_COORD6:"a_texCoord6",ATTR_TEX_COORD7:"a_texCoord7",ATTR_TEX_COORD8:"a_texCoord8",ATTR_TYPE_INT8:5120,ATTR_TYPE_UINT8:5121,ATTR_TYPE_INT16:5122,ATTR_TYPE_UINT16:5123,ATTR_TYPE_INT32:5124,ATTR_TYPE_UINT32:5125,ATTR_TYPE_FLOAT32:5126,FILTER_NEAREST:0,FILTER_LINEAR:1,WRAP_REPEAT:10497,WRAP_CLAMP:33071,WRAP_MIRROR:33648,TEXTURE_FMT_RGB_DXT1:0,TEXTURE_FMT_RGBA_DXT1:1,TEXTURE_FMT_RGBA_DXT3:2,TEXTURE_FMT_RGBA_DXT5:3,TEXTURE_FMT_RGB_ETC1:4,TEXTURE_FMT_RGB_PVRTC_2BPPV1:5,TEXTURE_FMT_RGBA_PVRTC_2BPPV1:6,TEXTURE_FMT_RGB_PVRTC_4BPPV1:7,TEXTURE_FMT_RGBA_PVRTC_4BPPV1:8,TEXTURE_FMT_A8:9,TEXTURE_FMT_L8:10,TEXTURE_FMT_L8_A8:11,TEXTURE_FMT_R5_G6_B5:12,TEXTURE_FMT_R5_G5_B5_A1:13,TEXTURE_FMT_R4_G4_B4_A4:14,TEXTURE_FMT_RGB8:15,TEXTURE_FMT_RGBA8:16,TEXTURE_FMT_RGB16F:17,TEXTURE_FMT_RGBA16F:18,TEXTURE_FMT_RGB32F:19,TEXTURE_FMT_RGBA32F:20,TEXTURE_FMT_R32F:21,TEXTURE_FMT_111110F:22,TEXTURE_FMT_SRGB:23,TEXTURE_FMT_SRGBA:24,TEXTURE_FMT_D16:25,TEXTURE_FMT_D32:26,TEXTURE_FMT_D24S8:27,TEXTURE_FMT_RGB_ETC2:28,TEXTURE_FMT_RGBA_ETC2:29,DS_FUNC_NEVER:512,DS_FUNC_LESS:513,DS_FUNC_EQUAL:514,DS_FUNC_LEQUAL:515,DS_FUNC_GREATER:516,DS_FUNC_NOTEQUAL:517,DS_FUNC_GEQUAL:518,DS_FUNC_ALWAYS:519,RB_FMT_RGBA4:32854,RB_FMT_RGB5_A1:32855,RB_FMT_RGB565:36194,RB_FMT_D16:33189,RB_FMT_S8:36168,RB_FMT_D24S8:34041,BLEND_FUNC_ADD:32774,BLEND_FUNC_SUBTRACT:32778,BLEND_FUNC_REVERSE_SUBTRACT:32779,BLEND_ZERO:0,BLEND_ONE:1,BLEND_SRC_COLOR:768,BLEND_ONE_MINUS_SRC_COLOR:769,BLEND_DST_COLOR:774,BLEND_ONE_MINUS_DST_COLOR:775,BLEND_SRC_ALPHA:770,BLEND_ONE_MINUS_SRC_ALPHA:771,BLEND_DST_ALPHA:772,BLEND_ONE_MINUS_DST_ALPHA:773,BLEND_CONSTANT_COLOR:32769,BLEND_ONE_MINUS_CONSTANT_COLOR:32770,BLEND_CONSTANT_ALPHA:32771,BLEND_ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_SRC_ALPHA_SATURATE:776,STENCIL_DISABLE:0,STENCIL_ENABLE:1,STENCIL_INHERIT:2,STENCIL_OP_KEEP:7680,STENCIL_OP_ZERO:0,STENCIL_OP_REPLACE:7681,STENCIL_OP_INCR:7682,STENCIL_OP_INCR_WRAP:34055,STENCIL_OP_DECR:7683,STENCIL_OP_DECR_WRAP:34056,STENCIL_OP_INVERT:5386,CULL_NONE:0,CULL_FRONT:1028,CULL_BACK:1029,CULL_FRONT_AND_BACK:1032,PT_POINTS:0,PT_LINES:1,PT_LINE_LOOP:2,PT_LINE_STRIP:3,PT_TRIANGLES:4,PT_TRIANGLE_STRIP:5,PT_TRIANGLE_FAN:6};i.enums=a}),{}],324:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=(function(){function t(t,e,i,n){this._device=t,this._width=e,this._height=i,this._colors=n.colors||[],this._depth=n.depth||null,this._stencil=n.stencil||null,this._depthStencil=n.depthStencil||null,this._glID=t._gl.createFramebuffer()}var e=t.prototype;return e.destroy=function(){null!==this._glID?(this._device._gl.deleteFramebuffer(this._glID),this._glID=null):console.error("The frame-buffer already destroyed")},e.getHandle=function(){return this._glID},t})();i.default=n,e.exports=i.default}),{}],325:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=t("./enums");function a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=((n={})[r.enums.INDEX_FMT_UINT8]=1,n[r.enums.INDEX_FMT_UINT16]=2,n[r.enums.INDEX_FMT_UINT32]=4,n),o=(function(){function t(t,e,i,n){this._device=t,this._format=e,this._usage=i,this._bytesPerIndex=s[e],this._bytes=n.byteLength,this._numIndices=this._bytes/this._bytesPerIndex,this._needExpandDataStore=!0,this._glID=t._gl.createBuffer(),this.update(0,n),t._stats.ib+=this._bytes}var e,i,n=t.prototype;return n.destroy=function(){-1!==this._glID?(this._device._gl.deleteBuffer(this._glID),this._device._stats.ib-=this.bytes,this._glID=-1):console.error("The buffer already destroyed")},n.update=function(t,e){if(-1!==this._glID){if(0!==e.byteLength){if(t+e.byteLength>this._bytes){if(t)return void console.error("Failed to update data, bytes exceed.");this._needExpandDataStore=!0,this._bytes=t+e.byteLength,this._numIndices=this._bytes/this._bytesPerIndex}var i=this._device._gl,n=this._usage;i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this._glID),this._needExpandDataStore?(i.bufferData(i.ELEMENT_ARRAY_BUFFER,e,n),this._needExpandDataStore=!1):i.bufferSubData(i.ELEMENT_ARRAY_BUFFER,t,e),this._device._restoreIndexBuffer()}}else console.error("The buffer is destroyed")},n.setUsage=function(t){this._usage=t},e=t,(i=[{key:"count",get:function(){return this._numIndices}}])&&a(e.prototype,i),t})();o.BYTES_PER_INDEX=s;var c=o;i.default=c,e.exports=i.default}),{"./enums":323}],326:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=t("./enums");n={VertexFormat:t("./vertex-format"),IndexBuffer:t("./index-buffer"),VertexBuffer:t("./vertex-buffer"),Program:t("./program"),Texture:t("./texture"),Texture2D:t("./texture-2d"),TextureCube:t("./texture-cube"),RenderBuffer:t("./render-buffer"),FrameBuffer:t("./frame-buffer"),Device:t("./device"),attrTypeBytes:r.attrTypeBytes,glFilter:r.glFilter,glTextureFmt:r.glTextureFmt},Object.assign(n,r.enums);var a=n;i.default=a,cc.gfx=n,e.exports=i.default}),{"./device":322,"./enums":323,"./frame-buffer":324,"./index-buffer":325,"./program":328,"./render-buffer":329,"./texture":333,"./texture-2d":331,"./texture-cube":332,"./vertex-buffer":334,"./vertex-format":335}],327:[(function(t,e,i){"use strict";i.__esModule=!0,i.isPow2=function(t){return!(t&t-1||!t)}}),{}],328:[(function(t,e,i){"use strict";function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}i.__esModule=!0,i.default=void 0;var r=0;function a(t,e,i){i.split("\n").forEach((function(i){if(!(i.length<5)){var n=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(i);n?t.push({type:e,fileID:0|n[1],line:0|n[2],message:n[3].trim()}):i.length>0&&t.push({type:e,fileID:-1,line:0,message:i})}}))}var s=(function(){function t(t,e){this._device=t,this._attributes=[],this._uniforms=[],this._samplers=[],this._errors=[],this._linked=!1,this._vertSource=e.vert,this._fragSource=e.frag,this._glID=null,this._id=r++}var e,i,s=t.prototype;return s.link=function(){if(!this._linked){var t=this._device._gl,e=o(t,t.VERTEX_SHADER,this._vertSource),i=o(t,t.FRAGMENT_SHADER,this._fragSource),n=t.createProgram();t.attachShader(n,e),t.attachShader(n,i),t.linkProgram(n);var r=!1,s=this._errors;if(t.getShaderParameter(e,t.COMPILE_STATUS)||(a(s,"vs",t.getShaderInfoLog(e)),r=!0),t.getShaderParameter(i,t.COMPILE_STATUS)||(a(s,"fs",t.getShaderInfoLog(i)),r=!0),t.deleteShader(e),t.deleteShader(i),r)return s;if(!t.getProgramParameter(n,t.LINK_STATUS))return s.push({info:"Failed to link shader program: "+t.getProgramInfoLog(n)}),s;this._glID=n;for(var c=t.getProgramParameter(n,t.ACTIVE_ATTRIBUTES),l=0;l<c;++l){var u=t.getActiveAttrib(n,l),h=t.getAttribLocation(n,u.name);this._attributes.push({name:u.name,location:h,type:u.type})}for(var f=t.getProgramParameter(n,t.ACTIVE_UNIFORMS),d=0;d<f;++d){var _=t.getActiveUniform(n,d),p=_.name,m=t.getUniformLocation(n,p),v="[0]"===p.substr(p.length-3);v&&(p=p.substr(0,p.length-3));var g={name:p,location:m,type:_.type,size:v?_.size:void 0};this._uniforms.push(g)}this._linked=!0}},s.destroy=function(){this._device._gl.deleteProgram(this._glID),this._linked=!1,this._glID=null,this._attributes=[],this._uniforms=[],this._samplers=[]},e=t,(i=[{key:"id",get:function(){return this._id}}])&&n(e.prototype,i),t})();function o(t,e,i){var n=t.createShader(e);return t.shaderSource(n,i),t.compileShader(n),n}i.default=s,e.exports=i.default}),{}],329:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=(function(){function t(t,e,i,n){this._device=t,this._format=e,this._glID=t._gl.createRenderbuffer(),this.update(i,n)}var e=t.prototype;return e.update=function(t,e){this._width=t,this._height=e;var i=this._device._gl;i.bindRenderbuffer(i.RENDERBUFFER,this._glID),i.renderbufferStorage(i.RENDERBUFFER,this._format,t,e),i.bindRenderbuffer(i.RENDERBUFFER,null)},e.destroy=function(){if(null!==this._glID){var t=this._device._gl;t.bindRenderbuffer(t.RENDERBUFFER,null),t.deleteRenderbuffer(this._glID),this._glID=null}else console.error("The render-buffer already destroyed")},t})();i.default=n,e.exports=i.default}),{}],330:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=t("./enums"),r={blend:!1,blendSep:!1,blendColor:4294967295,blendEq:n.enums.BLEND_FUNC_ADD,blendAlphaEq:n.enums.BLEND_FUNC_ADD,blendSrc:n.enums.BLEND_ONE,blendDst:n.enums.BLEND_ZERO,blendSrcAlpha:n.enums.BLEND_ONE,blendDstAlpha:n.enums.BLEND_ZERO,depthTest:!1,depthWrite:!1,depthFunc:n.enums.DS_FUNC_LESS,stencilTest:!1,stencilSep:!1,stencilFuncFront:n.enums.DS_FUNC_ALWAYS,stencilRefFront:0,stencilMaskFront:255,stencilFailOpFront:n.enums.STENCIL_OP_KEEP,stencilZFailOpFront:n.enums.STENCIL_OP_KEEP,stencilZPassOpFront:n.enums.STENCIL_OP_KEEP,stencilWriteMaskFront:255,stencilFuncBack:n.enums.DS_FUNC_ALWAYS,stencilRefBack:0,stencilMaskBack:255,stencilFailOpBack:n.enums.STENCIL_OP_KEEP,stencilZFailOpBack:n.enums.STENCIL_OP_KEEP,stencilZPassOpBack:n.enums.STENCIL_OP_KEEP,stencilWriteMaskBack:255,cullMode:n.enums.CULL_BACK,primitiveType:n.enums.PT_TRIANGLES,maxStream:-1,vertexBuffers:[],vertexBufferOffsets:[],indexBuffer:null,maxTextureSlot:-1,textureUnits:[],program:null},a=(function(){function t(t){this.vertexBuffers=new Array(t._caps.maxVertexStreams),this.vertexBufferOffsets=new Array(t._caps.maxVertexStreams),this.textureUnits=new Array(t._caps.maxTextureUnits),this.set(r)}t.initDefault=function(t){r.vertexBuffers=new Array(t._caps.maxVertexStreams),r.vertexBufferOffsets=new Array(t._caps.maxVertexStreams),r.textureUnits=new Array(t._caps.maxTextureUnits)};var e=t.prototype;return e.reset=function(){this.set(r)},e.set=function(t){this.blend=t.blend,this.blendSep=t.blendSep,this.blendColor=t.blendColor,this.blendEq=t.blendEq,this.blendAlphaEq=t.blendAlphaEq,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.depthFunc=t.depthFunc,this.stencilTest=t.stencilTest,this.stencilSep=t.stencilSep,this.stencilFuncFront=t.stencilFuncFront,this.stencilRefFront=t.stencilRefFront,this.stencilMaskFront=t.stencilMaskFront,this.stencilFailOpFront=t.stencilFailOpFront,this.stencilZFailOpFront=t.stencilZFailOpFront,this.stencilZPassOpFront=t.stencilZPassOpFront,this.stencilWriteMaskFront=t.stencilWriteMaskFront,this.stencilFuncBack=t.stencilFuncBack,this.stencilRefBack=t.stencilRefBack,this.stencilMaskBack=t.stencilMaskBack,this.stencilFailOpBack=t.stencilFailOpBack,this.stencilZFailOpBack=t.stencilZFailOpBack,this.stencilZPassOpBack=t.stencilZPassOpBack,this.stencilWriteMaskBack=t.stencilWriteMaskBack,this.cullMode=t.cullMode,this.primitiveType=t.primitiveType,this.maxStream=t.maxStream;for(var e=0;e<t.vertexBuffers.length;++e)this.vertexBuffers[e]=t.vertexBuffers[e];for(var i=0;i<t.vertexBufferOffsets.length;++i)this.vertexBufferOffsets[i]=t.vertexBufferOffsets[i];this.indexBuffer=t.indexBuffer,this.maxTextureSlot=t.maxTextureSlot;for(var n=0;n<t.textureUnits.length;++n)this.textureUnits[n]=t.textureUnits[n];this.program=t.program},t})();i.default=a,e.exports=i.default}),{"./enums":323}],331:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=(n=t("./texture"))&&n.__esModule?n:{default:n},a=t("./enums"),s=t("./misc"),o=(function(t){var e,i;function n(e,i){var n,r=(n=t.call(this,e)||this)._device._gl;return n._target=r.TEXTURE_2D,n._glID=r.createTexture(),i.images=i.images||[null],n.update(i),n}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var r=n.prototype;return r.update=function(t){var e=this._device._gl,i=this._genMipmap;if(t){void 0!==t.width&&(this._width=t.width),void 0!==t.height&&(this._height=t.height),void 0!==t.anisotropy&&(this._anisotropy=t.anisotropy),void 0!==t.minFilter&&(this._minFilter=t.minFilter),void 0!==t.magFilter&&(this._magFilter=t.magFilter),void 0!==t.mipFilter&&(this._mipFilter=t.mipFilter),void 0!==t.wrapS&&(this._wrapS=t.wrapS),void 0!==t.wrapT&&(this._wrapT=t.wrapT),void 0!==t.format&&(this._format=t.format,this._compressed=this._format>=a.enums.TEXTURE_FMT_RGB_DXT1&&this._format<=a.enums.TEXTURE_FMT_RGBA_PVRTC_4BPPV1||this._format>=a.enums.TEXTURE_FMT_RGB_ETC2&&this._format<=a.enums.TEXTURE_FMT_RGBA_ETC2),void 0!==t.genMipmaps&&(this._genMipmap=t.genMipmaps,i=t.genMipmaps);var n=this._device.caps.maxTextureSize||Number.MAX_VALUE,r=Math.max(t.width||0,t.height||0);n<r&&console.warn("The current texture size "+r+" exceeds the maximum size ["+n+"] supported on the device."),void 0!==t.images&&t.images.length>1&&(i=!1,(t.width>t.height?t.width:t.height)>>t.images.length-1!=1&&console.error("texture-2d mipmap is invalid, should have a 1x1 mipmap."))}(0,s.isPow2)(this._width)&&(0,s.isPow2)(this._height)||(i=!1),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this._glID),void 0!==t.images&&t.images.length>0&&(this._setMipmap(t.images,t.flipY,t.premultiplyAlpha),t.images.length>1&&(this._genMipmap=!0)),i&&(e.hint(e.GENERATE_MIPMAP_HINT,e.NICEST),e.generateMipmap(e.TEXTURE_2D),this._genMipmap=!0),this._setTexInfo(),this._device._restoreTexture(0)},r.updateSubImage=function(t){var e=this._device._gl,i=(0,a.glTextureFmt)(this._format);e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this._glID),this._setSubImage(i,t),this._device._restoreTexture(0)},r.updateImage=function(t){var e=this._device._gl,i=(0,a.glTextureFmt)(this._format);e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,this._glID),this._setImage(i,t),this._device._restoreTexture(0)},r._setSubImage=function(t,e){var i=this._device._gl,n=e.flipY,r=e.premultiplyAlpha,a=e.image;!a||ArrayBuffer.isView(a)||a instanceof ArrayBuffer?(void 0===n?i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!1):i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,n),void 0===r?i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1):i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this._compressed?i.compressedTexSubImage2D(i.TEXTURE_2D,e.level,e.x,e.y,e.width,e.height,t.format,a):i.texSubImage2D(i.TEXTURE_2D,e.level,e.x,e.y,e.width,e.height,t.format,t.pixelType,a)):(void 0===n?i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!0):i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,n),void 0===r?i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1):i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),i.texSubImage2D(i.TEXTURE_2D,e.level,e.x,e.y,t.format,t.pixelType,a))},r._setImage=function(t,e){var i=this._device._gl,n=e.flipY,r=e.premultiplyAlpha,a=e.image;!a||ArrayBuffer.isView(a)||a instanceof ArrayBuffer?(void 0===n?i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!1):i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,n),void 0===r?i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1):i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this._compressed?i.compressedTexImage2D(i.TEXTURE_2D,e.level,t.internalFormat,e.width,e.height,0,a):i.texImage2D(i.TEXTURE_2D,e.level,t.internalFormat,e.width,e.height,0,t.format,t.pixelType,a)):(void 0===n?i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!0):i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,n),void 0===r?i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1):i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),i.texImage2D(i.TEXTURE_2D,e.level,t.internalFormat,t.format,t.pixelType,a))},r._setMipmap=function(t,e,i){for(var n=(0,a.glTextureFmt)(this._format),r={width:this._width,height:this._height,flipY:e,premultiplyAlpha:i,level:0,image:null},s=0;s<t.length;++s)r.level=s,r.width=this._width>>s,r.height=this._height>>s,r.image=t[s],this._setImage(n,r)},r._setTexInfo=function(){var t=this._device._gl,e=(0,s.isPow2)(this._width)&&(0,s.isPow2)(this._height);e||this._wrapS===a.enums.WRAP_CLAMP&&this._wrapT===a.enums.WRAP_CLAMP||(console.warn("WebGL1 doesn't support all wrap modes with NPOT textures"),this._wrapS=a.enums.WRAP_CLAMP,this._wrapT=a.enums.WRAP_CLAMP);var i=this._genMipmap?this._mipFilter:-1;e||-1===i||(console.warn("NPOT textures do not support mipmap filter"),i=-1),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,(0,a.glFilter)(t,this._minFilter,i)),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,(0,a.glFilter)(t,this._magFilter,-1)),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,this._wrapS),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,this._wrapT);var n=this._device.ext("EXT_texture_filter_anisotropic");n&&t.texParameteri(t.TEXTURE_2D,n.TEXTURE_MAX_ANISOTROPY_EXT,this._anisotropy)},n})(r.default);i.default=o,e.exports=i.default}),{"./enums":323,"./misc":327,"./texture":333}],332:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=(n=t("./texture"))&&n.__esModule?n:{default:n},a=t("./enums"),s=t("./misc"),o=(function(t){var e,i;function n(e,i){var n,r=(n=t.call(this,e)||this)._device._gl;return n._target=r.TEXTURE_CUBE_MAP,n._glID=r.createTexture(),n.update(i),n}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var r=n.prototype;return r.update=function(t){var e=this._device._gl,i=this._genMipmaps;t&&(void 0!==t.width&&(this._width=t.width),void 0!==t.height&&(this._height=t.height),void 0!==t.anisotropy&&(this._anisotropy=t.anisotropy),void 0!==t.minFilter&&(this._minFilter=t.minFilter),void 0!==t.magFilter&&(this._magFilter=t.magFilter),void 0!==t.mipFilter&&(this._mipFilter=t.mipFilter),void 0!==t.wrapS&&(this._wrapS=t.wrapS),void 0!==t.wrapT&&(this._wrapT=t.wrapT),void 0!==t.format&&(this._format=t.format,this._compressed=this._format>=a.enums.TEXTURE_FMT_RGB_DXT1&&this._format<=a.enums.TEXTURE_FMT_RGBA_PVRTC_4BPPV1||this._format>=a.enums.TEXTURE_FMT_RGB_ETC2&&this._format<=a.enums.TEXTURE_FMT_RGBA_ETC2),void 0!==t.genMipmaps&&(this._genMipmaps=t.genMipmaps,i=t.genMipmaps),void 0!==t.images&&t.images.length>1&&(i=!1,t.width!==t.height&&console.warn("texture-cube width and height should be identical."),t.width>>t.images.length-1!=1&&console.error("texture-cube mipmap is invalid. please set mipmap as 1x1, 2x2, 4x4 ... nxn"))),(0,s.isPow2)(this._width)&&(0,s.isPow2)(this._height)||(i=!1),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_CUBE_MAP,this._glID),void 0!==t.images&&t.images.length>0&&(this._setMipmap(t.images,t.flipY,t.premultiplyAlpha),t.images.length>1&&(this._genMipmaps=!0)),i&&(e.hint(e.GENERATE_MIPMAP_HINT,e.NICEST),e.generateMipmap(e.TEXTURE_CUBE_MAP),this._genMipmaps=!0),this._setTexInfo(),this._device._restoreTexture(0)},r.updateSubImage=function(t){var e=this._device._gl,i=(0,a.glTextureFmt)(this._format);e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_CUBE_MAP,this._glID),this._setSubImage(i,t),this._device._restoreTexture(0)},r.updateImage=function(t){var e=this._device._gl,i=(0,a.glTextureFmt)(this._format);e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_CUBE_MAP,this._glID),this._setImage(i,t),this._device._restoreTexture(0)},r._setSubImage=function(t,e){var i=this._device._gl,n=e.flipY,r=e.premultiplyAlpha,a=e.faceIndex,s=e.image;void 0===n?i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!1):i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,n),void 0===r?i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1):i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),!s||ArrayBuffer.isView(s)||s instanceof ArrayBuffer?this._compressed?i.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+a,e.level,e.x,e.y,e.width,e.height,t.format,s):i.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+a,e.level,e.x,e.y,e.width,e.height,t.format,t.pixelType,s):i.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+a,e.level,e.x,e.y,t.format,t.pixelType,s)},r._setImage=function(t,e){var i=this._device._gl,n=e.flipY,r=e.premultiplyAlpha,a=e.faceIndex,s=e.image;void 0===n?i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!1):i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,n),void 0===r?i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1):i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),!s||ArrayBuffer.isView(s)||s instanceof ArrayBuffer?this._compressed?i.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+a,e.level,t.internalFormat,e.width,e.height,0,s):i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+a,e.level,t.internalFormat,e.width,e.height,0,t.format,t.pixelType,s):i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+a,e.level,t.internalFormat,t.format,t.pixelType,s)},r._setMipmap=function(t,e,i){for(var n=(0,a.glTextureFmt)(this._format),r={width:this._width,height:this._height,faceIndex:0,flipY:e,premultiplyAlpha:i,level:0,image:null},s=0;s<t.length;++s){var o=t[s];r.level=s,r.width=this._width>>s,r.height=this._height>>s;for(var c=0;c<6;++c)r.faceIndex=c,r.image=o[c],this._setImage(n,r)}},r._setTexInfo=function(){var t=this._device._gl,e=(0,s.isPow2)(this._width)&&(0,s.isPow2)(this._height);e||this._wrapS===a.enums.WRAP_CLAMP&&this._wrapT===a.enums.WRAP_CLAMP||(console.warn("WebGL1 doesn't support all wrap modes with NPOT textures"),this._wrapS=a.enums.WRAP_CLAMP,this._wrapT=a.enums.WRAP_CLAMP);var i=this._genMipmaps?this._mipFilter:-1;e||-1===i||(console.warn("NPOT textures do not support mipmap filter"),i=-1),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,(0,a.glFilter)(t,this._minFilter,i)),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,(0,a.glFilter)(t,this._magFilter,-1)),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_S,this._wrapS),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_T,this._wrapT);var n=this._device.ext("EXT_texture_filter_anisotropic");n&&t.texParameteri(t.TEXTURE_CUBE_MAP,n.TEXTURE_MAX_ANISOTROPY_EXT,this._anisotropy)},n})(r.default);i.default=o,e.exports=i.default}),{"./enums":323,"./misc":327,"./texture":333}],333:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=t("./enums"),r=0,a=(function(){function t(t){this._device=t,this._width=4,this._height=4,this._genMipmaps=!1,this._compressed=!1,this._anisotropy=1,this._minFilter=n.enums.FILTER_LINEAR,this._magFilter=n.enums.FILTER_LINEAR,this._mipFilter=n.enums.FILTER_LINEAR,this._wrapS=n.enums.WRAP_REPEAT,this._wrapT=n.enums.WRAP_REPEAT,this._format=n.enums.TEXTURE_FMT_RGBA8,this._target=-1,this._id=r++}return t.prototype.destroy=function(){null!==this._glID?(this._device._gl.deleteTexture(this._glID),this._device._stats.tex-=this.bytes,this._glID=null):console.error("The texture already destroyed")},t})();i.default=a,e.exports=i.default}),{"./enums":323}],334:[(function(t,e,i){"use strict";function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}i.__esModule=!0,i.default=void 0,t("./enums");var r=(function(){function t(t,e,i,n){this._device=t,this._format=e,this._usage=i,this._bytesPerVertex=this._format._bytes,this._bytes=n.byteLength,this._numVertices=this._bytes/this._bytesPerVertex,this._needExpandDataStore=!0,this._glID=t._gl.createBuffer(),this.update(0,n),t._stats.vb+=this._bytes}var e,i,r=t.prototype;return r.destroy=function(){-1!==this._glID?(this._device._gl.deleteBuffer(this._glID),this._device._stats.vb-=this.bytes,this._glID=-1):console.error("The buffer already destroyed")},r.update=function(t,e){if(-1!==this._glID){if(0!==e.byteLength){if(t+e.byteLength>this._bytes){if(t)return void console.error("Failed to update data, bytes exceed.");this._needExpandDataStore=!0,this._bytes=t+e.byteLength,this._numVertices=this._bytes/this._bytesPerVertex}var i=this._device._gl,n=this._usage;i.bindBuffer(i.ARRAY_BUFFER,this._glID),this._needExpandDataStore?(i.bufferData(i.ARRAY_BUFFER,e,n),this._needExpandDataStore=!1):i.bufferSubData(i.ARRAY_BUFFER,t,e),i.bindBuffer(i.ARRAY_BUFFER,null)}}else console.error("The buffer is destroyed")},r.getFormat=function(t){return this._format.element(t)},r.setUsage=function(t){this._usage=t},e=t,(i=[{key:"count",get:function(){return this._numVertices}}])&&n(e.prototype,i),t})();i.default=r,e.exports=i.default}),{"./enums":323}],335:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=t("./enums"),a=(n=t("../murmurhash2_gc"))&&n.__esModule?n:{default:n},s=(function(){function t(t){this._attr2el={},this._elements=[],this._bytes=0;for(var e="",i=0,n=t.length;i<n;++i){var s=t[i],o={name:s.name,offset:this._bytes,stride:0,stream:-1,type:s.type,num:s.num,normalize:void 0!==s.normalize&&s.normalize,bytes:s.num*(0,r.attrTypeBytes)(s.type)};this._attr2el[o.name]=o,this._elements.push(o),this._bytes+=o.bytes,e+=o.name+":"+o.num+":"+o.type+":"+o.normalize}for(var c=0,l=this._elements.length;c<l;++c)this._elements[c].stride=this._bytes;this._hash=(0,a.default)(e,666)}var e=t.prototype;return e.element=function(t){return this._attr2el[t]},e.getHash=function(){return this._hash},t})();i.default=s,e.exports=i.default}),{"../murmurhash2_gc":344,"./enums":323}],336:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=(function(){function t(t,e){this._cursor=0,this._data=new Array(e);for(var i=0;i<e;++i)this._data[i]=t()}return t.prototype.request=function(){var t=this._data[this._cursor];return this._cursor=(this._cursor+1)%this._data.length,t},t})();i.default=n,e.exports=i.default}),{}],337:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=(n=t("./timsort"))&&n.__esModule?n:{default:n};function a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=(function(){function t(t){this._count=0,this._data=new Array(t)}var e,i,n=t.prototype;return n._resize=function(t){if(t>this._data.length)for(var e=this._data.length;e<t;++e)this._data[e]=void 0},n.reset=function(){for(var t=0;t<this._count;++t)this._data[t]=void 0;this._count=0},n.push=function(t){this._count>=this._data.length&&this._resize(2*this._data.length),this._data[this._count]=t,++this._count},n.pop=function(){--this._count,this._count<0&&(this._count=0);var t=this._data[this._count];return this._data[this._count]=void 0,t},n.fastRemove=function(t){if(!(t>=this._count||t<0)){var e=this._count-1;this._data[t]=this._data[e],this._data[e]=void 0,this._count-=1}},n.indexOf=function(t){return this._data.indexOf(t)},n.sort=function(t){return(0,r.default)(this._data,0,this._count,t)},e=t,(i=[{key:"length",get:function(){return this._count}},{key:"data",get:function(){return this._data}}])&&a(e.prototype,i),t})();i.default=s,e.exports=i.default}),{"./timsort":342}],338:[(function(t,e,i){"use strict";i.__esModule=!0,i.TypedArrayPool=i.RecyclePool=i.Pool=i.LinkedArray=i.FixedArray=i.CircularPool=void 0;var n=l(t("./circular-pool"));i.CircularPool=n.default;var r=l(t("./fixed-array"));i.FixedArray=r.default;var a=l(t("./linked-array"));i.LinkedArray=a.default;var s=l(t("./pool"));i.Pool=s.default;var o=l(t("./recycle-pool"));i.RecyclePool=o.default;var c=l(t("./typed-array-pool"));function l(t){return t&&t.__esModule?t:{default:t}}i.TypedArrayPool=c.default}),{"./circular-pool":336,"./fixed-array":337,"./linked-array":339,"./pool":340,"./recycle-pool":341,"./typed-array-pool":343}],339:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=(n=t("./pool"))&&n.__esModule?n:{default:n};function a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=(function(){function t(t,e){this._fn=t,this._count=0,this._head=null,this._tail=null,this._pool=new r.default(t,e)}var e,i,n=t.prototype;return n.add=function(){var t=this._pool.alloc();return this._tail?(this._tail._next=t,t._prev=this._tail):this._head=t,this._tail=t,this._count+=1,t},n.remove=function(t){t._prev?t._prev._next=t._next:this._head=t._next,t._next?t._next._prev=t._prev:this._tail=t._prev,t._next=null,t._prev=null,this._pool.free(t),this._count-=1},n.forEach=function(t,e){var i=this._head;if(i){e&&(t=t.bind(e));for(var n=0,r=i;i;)r=i._next,t(i,n,this),i=r,++n}},e=t,(i=[{key:"head",get:function(){return this._head}},{key:"tail",get:function(){return this._tail}},{key:"length",get:function(){return this._count}}])&&a(e.prototype,i),t})();i.default=s,e.exports=i.default}),{"./pool":340}],340:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=(function(){function t(t,e){this._fn=t,this._idx=e-1,this._frees=new Array(e);for(var i=0;i<e;++i)this._frees[i]=t()}var e=t.prototype;return e._expand=function(t){var e=this._frees;this._frees=new Array(t);for(var i=t-e.length,n=0;n<i;++n)this._frees[n]=this._fn();for(var r=i,a=0;r<t;++r,++a)this._frees[r]=e[a];this._idx+=i},e.alloc=function(){this._idx<0&&this._expand(Math.round(1.2*this._frees.length)+1);var t=this._frees[this._idx];return this._frees[this._idx]=null,--this._idx,t},e.free=function(t){++this._idx,this._frees[this._idx]=t},e.clear=function(t){for(var e=0;e<=this._idx;e++)t&&t(this._frees[e]);this._frees.length=0,this._idx=-1},t})();i.default=n,e.exports=i.default}),{}],341:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=(n=t("./timsort"))&&n.__esModule?n:{default:n};function a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=(function(){function t(t,e){this._fn=t,this._count=0,this._data=new Array(e);for(var i=0;i<e;++i)this._data[i]=t()}var e,i,n=t.prototype;return n.reset=function(){this._count=0},n.resize=function(t){if(t>this._data.length)for(var e=this._data.length;e<t;++e)this._data[e]=this._fn()},n.add=function(){return this._count>=this._data.length&&this.resize(2*this._data.length),this._data[this._count++]},n.remove=function(t){if(!(t>=this._count)){var e=this._count-1,i=this._data[t];this._data[t]=this._data[e],this._data[e]=i,this._count-=1}},n.sort=function(t){return(0,r.default)(this._data,0,this._count,t)},e=t,(i=[{key:"length",get:function(){return this._count}},{key:"data",get:function(){return this._data}}])&&a(e.prototype,i),t})();i.default=s,cc.RecyclePool=s,e.exports=i.default}),{"./timsort":342}],342:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t,e,i,r){if(!Array.isArray(t))throw new TypeError("Can only sort arrays");void 0===e&&(e=0),void 0===i&&(i=t.length),void 0===r&&(r=c);var a=i-e;if(!(a<2)){var s=0;if(a<n)return void f(t,e,i,e+(s=u(t,e,i,r)),r);var o=new p(t,r),h=l(a);do{if((s=u(t,e,i,r))<h){var d=a;d>h&&(d=h),f(t,e,e+d,e+s,r),s=d}o.pushRun(e,s),o.mergeRuns(),a-=s,e+=s}while(0!==a);o.forceMergeRuns()}};var n=32,r=7,a=256,s=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];function o(t){return t<1e5?t<100?t<10?0:1:t<1e4?t<1e3?2:3:4:t<1e7?t<1e6?5:6:t<1e9?t<1e8?7:8:9}function c(t,e){if(t===e)return 0;if(~~t===t&&~~e===e){if(0===t||0===e)return t<e?-1:1;if(t<0||e<0){if(e>=0)return-1;if(t>=0)return 1;t=-t,e=-e}var i=o(t),n=o(e),r=0;return i<n?(t*=s[n-i-1],e/=10,r=-1):i>n&&(e*=s[i-n-1],t/=10,r=1),t===e?r:t<e?-1:1}var a=String(t),c=String(e);return a===c?0:a<c?-1:1}function l(t){for(var e=0;t>=n;)e|=1&t,t>>=1;return t+e}function u(t,e,i,n){var r=e+1;if(r===i)return 1;if(n(t[r++],t[e])<0){for(;r<i&&n(t[r],t[r-1])<0;)r++;h(t,e,r)}else for(;r<i&&n(t[r],t[r-1])>=0;)r++;return r-e}function h(t,e,i){for(i--;e<i;){var n=t[e];t[e++]=t[i],t[i--]=n}}function f(t,e,i,n,r){for(n===e&&n++;n<i;n++){for(var a=t[n],s=e,o=n;s<o;){var c=s+o>>>1;r(a,t[c])<0?o=c:s=c+1}var l=n-s;switch(l){case 3:t[s+3]=t[s+2];case 2:t[s+2]=t[s+1];case 1:t[s+1]=t[s];break;default:for(;l>0;)t[s+l]=t[s+l-1],l--}t[s]=a}}function d(t,e,i,n,r,a){var s=0,o=0,c=1;if(a(t,e[i+r])>0){for(o=n-r;c<o&&a(t,e[i+r+c])>0;)s=c,(c=1+(c<<1))<=0&&(c=o);c>o&&(c=o),s+=r,c+=r}else{for(o=r+1;c<o&&a(t,e[i+r-c])<=0;)s=c,(c=1+(c<<1))<=0&&(c=o);c>o&&(c=o);var l=s;s=r-c,c=r-l}for(s++;s<c;){var u=s+(c-s>>>1);a(t,e[i+u])>0?s=u+1:c=u}return c}function _(t,e,i,n,r,a){var s=0,o=0,c=1;if(a(t,e[i+r])<0){for(o=r+1;c<o&&a(t,e[i+r-c])<0;)s=c,(c=1+(c<<1))<=0&&(c=o);c>o&&(c=o);var l=s;s=r-c,c=r-l}else{for(o=n-r;c<o&&a(t,e[i+r+c])>=0;)s=c,(c=1+(c<<1))<=0&&(c=o);c>o&&(c=o),s+=r,c+=r}for(s++;s<c;){var u=s+(c-s>>>1);a(t,e[i+u])<0?c=u:s=u+1}return c}var p=(function(){function t(t,e){this.array=t,this.compare=e,this.minGallop=r,this.length=t.length,this.tmpStorageLength=a,this.length<2*a&&(this.tmpStorageLength=this.length>>>1),this.tmp=new Array(this.tmpStorageLength),this.stackLength=this.length<120?5:this.length<1542?10:this.length<119151?19:40,this.runStart=new Array(this.stackLength),this.runLength=new Array(this.stackLength),this.stackSize=0}var e=t.prototype;return e.pushRun=function(t,e){this.runStart[this.stackSize]=t,this.runLength[this.stackSize]=e,this.stackSize+=1},e.mergeRuns=function(){for(;this.stackSize>1;){var t=this.stackSize-2;if(t>=1&&this.runLength[t-1]<=this.runLength[t]+this.runLength[t+1]||t>=2&&this.runLength[t-2]<=this.runLength[t]+this.runLength[t-1])this.runLength[t-1]<this.runLength[t+1]&&t--;else if(this.runLength[t]>this.runLength[t+1])break;this.mergeAt(t)}},e.forceMergeRuns=function(){for(;this.stackSize>1;){var t=this.stackSize-2;t>0&&this.runLength[t-1]<this.runLength[t+1]&&t--,this.mergeAt(t)}},e.mergeAt=function(t){var e=this.compare,i=this.array,n=this.runStart[t],r=this.runLength[t],a=this.runStart[t+1],s=this.runLength[t+1];this.runLength[t]=r+s,t===this.stackSize-3&&(this.runStart[t+1]=this.runStart[t+2],this.runLength[t+1]=this.runLength[t+2]),this.stackSize--;var o=_(i[a],i,n,r,0,e);n+=o,0!=(r-=o)&&0!==(s=d(i[n+r-1],i,a,s,s-1,e))&&(r<=s?this.mergeLow(n,r,a,s):this.mergeHigh(n,r,a,s))},e.mergeLow=function(t,e,i,n){var a=this.compare,s=this.array,o=this.tmp,c=0;for(c=0;c<e;c++)o[c]=s[t+c];var l=0,u=i,h=t;if(s[h++]=s[u++],0!=--n)if(1!==e){for(var f=this.minGallop;;){var p=0,m=0,v=!1;do{if(a(s[u],o[l])<0){if(s[h++]=s[u++],m++,p=0,0==--n){v=!0;break}}else if(s[h++]=o[l++],p++,m=0,1==--e){v=!0;break}}while((p|m)<f);if(v)break;do{if(0!==(p=_(s[u],o,l,e,0,a))){for(c=0;c<p;c++)s[h+c]=o[l+c];if(h+=p,l+=p,(e-=p)<=1){v=!0;break}}if(s[h++]=s[u++],0==--n){v=!0;break}if(0!==(m=d(o[l],s,u,n,0,a))){for(c=0;c<m;c++)s[h+c]=s[u+c];if(h+=m,u+=m,0==(n-=m)){v=!0;break}}if(s[h++]=o[l++],1==--e){v=!0;break}f--}while(p>=r||m>=r);if(v)break;f<0&&(f=0),f+=2}if(this.minGallop=f,f<1&&(this.minGallop=1),1===e){for(c=0;c<n;c++)s[h+c]=s[u+c];s[h+n]=o[l]}else{if(0===e)throw new Error("mergeLow preconditions were not respected");for(c=0;c<e;c++)s[h+c]=o[l+c]}}else{for(c=0;c<n;c++)s[h+c]=s[u+c];s[h+n]=o[l]}else for(c=0;c<e;c++)s[h+c]=o[l+c]},e.mergeHigh=function(t,e,i,n){var a=this.compare,s=this.array,o=this.tmp,c=0;for(c=0;c<n;c++)o[c]=s[i+c];var l=t+e-1,u=n-1,h=i+n-1,f=0,p=0;if(s[h--]=s[l--],0!=--e)if(1!==n){for(var m=this.minGallop;;){var v=0,g=0,y=!1;do{if(a(o[u],s[l])<0){if(s[h--]=s[l--],v++,g=0,0==--e){y=!0;break}}else if(s[h--]=o[u--],g++,v=0,1==--n){y=!0;break}}while((v|g)<m);if(y)break;do{if(0!=(v=e-_(o[u],s,t,e,e-1,a))){for(e-=v,p=1+(h-=v),f=1+(l-=v),c=v-1;c>=0;c--)s[p+c]=s[f+c];if(0===e){y=!0;break}}if(s[h--]=o[u--],1==--n){y=!0;break}if(0!=(g=n-d(s[l],o,0,n,n-1,a))){for(n-=g,p=1+(h-=g),f=1+(u-=g),c=0;c<g;c++)s[p+c]=o[f+c];if(n<=1){y=!0;break}}if(s[h--]=s[l--],0==--e){y=!0;break}m--}while(v>=r||g>=r);if(y)break;m<0&&(m=0),m+=2}if(this.minGallop=m,m<1&&(this.minGallop=1),1===n){for(p=1+(h-=e),f=1+(l-=e),c=e-1;c>=0;c--)s[p+c]=s[f+c];s[h]=o[u]}else{if(0===n)throw new Error("mergeHigh preconditions were not respected");for(f=h-(n-1),c=0;c<n;c++)s[f+c]=o[c]}}else{for(p=1+(h-=e),f=1+(l-=e),c=e-1;c>=0;c--)s[p+c]=s[f+c];s[h]=o[u]}else for(f=h-(n-1),c=0;c<n;c++)s[f+c]=o[c]},t})();e.exports=i.default}),{}],343:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;for(var n=Array(8),r=0;r<8;++r)n[r]=[];function a(t){for(var e=16;e<=1<<28;e*=16)if(t<=e)return e;return 0}function s(t){var e,i;return e=(t>65535)<<4,e|=i=((t>>>=e)>255)<<3,e|=i=((t>>>=i)>15)<<2,(e|=i=((t>>>=i)>3)<<1)|(t>>>=i)>>1}function o(t){var e=a(t),i=n[s(e)>>2];return i.length>0?i.pop():new ArrayBuffer(e)}var c={alloc_int8:function(t){var e=new Int8Array(o(t),0,t);return e.length!==t?e.subarray(0,t):e},alloc_uint8:function(t){var e=new Uint8Array(o(t),0,t);return e.length!==t?e.subarray(0,t):e},alloc_int16:function(t){var e=new Int16Array(o(2*t),0,t);return e.length!==t?e.subarray(0,t):e},alloc_uint16:function(t){var e=new Uint16Array(o(2*t),0,t);return e.length!==t?e.subarray(0,t):e},alloc_int32:function(t){var e=new Int32Array(o(4*t),0,t);return e.length!==t?e.subarray(0,t):e},alloc_uint32:function(t){var e=new Uint32Array(o(4*t),0,t);return e.length!==t?e.subarray(0,t):e},alloc_float32:function(t){var e=new Float32Array(o(4*t),0,t);return e.length!==t?e.subarray(0,t):e},alloc_float64:function(t){var e=new Float64Array(o(8*t),0,t);return e.length!==t?e.subarray(0,t):e},alloc_dataview:function(t){var e=new DataView(o(t),0,t);return e.length!==t?e.subarray(0,t):e},free:function(t){var e;e=t.buffer,n[s(e.byteLength)>>2].push(e)},reset:function(){for(var t=Array(8),e=0;e<8;++e)t[e]=[]}};i.default=c,e.exports=i.default}),{}],344:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=function(t,e){for(var i,n=t.length,r=e^n,a=0;n>=4;)i=1540483477*(65535&(i=255&t.charCodeAt(a)|(255&t.charCodeAt(++a))<<8|(255&t.charCodeAt(++a))<<16|(255&t.charCodeAt(++a))<<24))+((1540483477*(i>>>16)&65535)<<16),r=1540483477*(65535&r)+((1540483477*(r>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),n-=4,++a;switch(n){case 3:r^=(255&t.charCodeAt(a+2))<<16;case 2:r^=(255&t.charCodeAt(a+1))<<8;case 1:r=1540483477*(65535&(r^=255&t.charCodeAt(a)))+((1540483477*(r>>>16)&65535)<<16)}return r=1540483477*(65535&(r^=r>>>13))+((1540483477*(r>>>16)&65535)<<16),(r^=r>>>15)>>>0},e.exports=i.default}),{}],345:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=t("../../core/value-types"),r=o(t("../core/base-renderer")),a=o(t("../enums")),s=t("../memop");function o(t){return t&&t.__esModule?t:{default:t}}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var l=new Float32Array(16),u=new Float32Array(16),h=new Float32Array(16),f=new Float32Array(16),d=new Float32Array(4),_=new Float32Array(64),p=[],m=new Float32Array(4),v=new n.Vec4(0,0,0,0),g=new n.Vec3(0,0,0),y=new n.Vec3(0,0,0),T=new s.RecyclePool(function(){return new Float32Array(16)},8);function b(t,e){return t._priority-e._priority}var E=(function(t){var e,i;function r(e,i){var n;return(n=t.call(this,e,i)||this)._time=new Float32Array(4),n._lights=[],n._shadowLights=[],n._numLights=0,n._defines={},n._registerStage("shadowcast",n._shadowStage.bind(c(n))),n._registerStage("opaque",n._opaqueStage.bind(c(n))),n._registerStage("transparent",n._transparentStage.bind(c(n))),n}i=t,(e=r).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var s=r.prototype;return s.reset=function(){T.reset(),t.prototype.reset.call(this)},s.render=function(t,e){this.reset(),e&&(this._time[0]+=e,this._time[1]=e,this._time[2]++),this._device.setUniform("cc_time",this._time),this._updateLights(t);for(var i=this._device._gl.canvas,n=0;n<t._cameras.length;++n){var r=this._requestView(),a=i.width,s=i.height;t._cameras.data[n].extractView(r,a,s)}this._viewPools.sort(b);for(var o=0;o<this._viewPools.length;++o){var c=this._viewPools.data[o];this._render(c,t)}},s.renderCamera=function(t,e){this.reset(),this._updateLights(e);var i=this._device._gl.canvas,n=i.width,r=i.height,a=this._requestView();t.extractView(a,n,r),this._viewPools.sort(b);for(var s=0;s<this._viewPools.length;++s){var o=this._viewPools.data[s];this._render(o,e)}},s._updateLights=function(t){this._lights.length=0,this._shadowLights.length=0;for(var e=t._lights,i=0;i<e.length;++i){var n=e.data[i];if(n.update(this._device),n.shadowType!==a.default.SHADOW_NONE){this._shadowLights.length<2&&this._shadowLights.splice(0,0,n);var r=this._requestView();n.extractView(r,["shadowcast"]),this._lights.splice(0,0,n)}else this._lights.push(n)}this._updateLightDefines(),this._numLights=e._count},s._updateLightDefines=function(){for(var t=this._defines,e=0;e<this._lights.length;++e){var i=this._lights[e];t["CC_LIGHT_"+e+"_TYPE"]=i._type,t["CC_SHADOW_"+e+"_TYPE"]=i._shadowType}t.CC_NUM_LIGHTS=Math.min(4,this._lights.length),t.CC_NUM_SHADOW_LIGHTS=Math.min(4,this._shadowLights.length)},s._submitLightsUniforms=function(){var t=this._device;if(this._lights.length>0){for(var e=T.add(),i=T.add(),n=T.add(),r=Math.min(4,this._lights.length),s=0;s<r;++s){var o=this._lights[s],c=4*s;n.set(o._colorUniform,c),i.set(o._directionUniform,c),e.set(o._positionUniform,c),e[c+3]=o._range,o._type===a.default.LIGHT_SPOT?(i[c+3]=o._spotUniform[0],n[c+3]=o._spotUniform[1]):(i[c+3]=0,n[c+3]=0)}t.setUniform("cc_lightDirection",i),t.setUniform("cc_lightColor",n),t.setUniform("cc_lightPositionAndRange",e)}},s._submitShadowStageUniforms=function(t){var e=t._shadowLight,i=m;i[0]=e.shadowMinDepth,i[1]=e.shadowMaxDepth,i[2]=e.shadowDepthScale,i[3]=e.shadowDarkness,this._device.setUniform("cc_shadow_map_lightViewProjMatrix",n.Mat4.toArray(f,t._matViewProj)),this._device.setUniform("cc_shadow_map_info",i),this._device.setUniform("cc_shadow_map_bias",e.shadowBias),this._defines.CC_SHADOW_TYPE=e._shadowType},s._submitOtherStagesUniforms=function(){for(var t=T.add(),e=0;e<this._shadowLights.length;++e){var i=this._shadowLights[e],r=p[e];r||(r=p[e]=new Float32Array(_.buffer,64*e,16)),n.Mat4.toArray(r,i.viewProjMatrix);var a=4*e;t[a]=i.shadowMinDepth,t[a+1]=i.shadowMaxDepth,t[a+2]=i._shadowResolution,t[a+3]=i.shadowDarkness}this._device.setUniform("cc_shadow_lightViewProjMatrix",_),this._device.setUniform("cc_shadow_info",t)},s._sortItems=function(t){t.sort((function(t,e){return t.passes.length!==e.passes.length?t.passes.length-e.passes.length:t.sortKey-e.sortKey}))},s._shadowStage=function(t,e){this._submitShadowStageUniforms(t);for(var i=0;i<e.length;++i){var n=e.data[i];n.effect.getDefine("CC_CASTING_SHADOW")&&this._draw(n)}},s._drawItems=function(t,e){var i=this._shadowLights;if(0===i.length&&0===this._numLights)for(var n=0;n<e.length;++n){var r=e.data[n];this._draw(r)}else for(var a=0;a<e.length;++a){for(var s=e.data[a],o=0;o<i.length;++o)this._device.setTexture("cc_shadow_map_"+o,i[o].shadowMap,this._allocTextureUnit());this._draw(s)}},s._opaqueStage=function(t,e){t.getPosition(v),this._device.setUniform("cc_matView",n.Mat4.toArray(l,t._matView)),this._device.setUniform("cc_matViewInv",n.Mat4.toArray(u,t._matViewInv)),this._device.setUniform("cc_matProj",n.Mat4.toArray(h,t._matProj)),this._device.setUniform("cc_matViewProj",n.Mat4.toArray(f,t._matViewProj)),this._device.setUniform("cc_cameraPos",n.Vec4.toArray(d,v)),this._submitLightsUniforms(),this._submitOtherStagesUniforms(),this._drawItems(t,e)},s._transparentStage=function(t,e){t.getPosition(v),t.getForward(g),this._device.setUniform("cc_matView",n.Mat4.toArray(l,t._matView)),this._device.setUniform("cc_matViewInv",n.Mat4.toArray(u,t._matViewInv)),this._device.setUniform("cc_matProj",n.Mat4.toArray(h,t._matProj)),this._device.setUniform("cc_matViewProj",n.Mat4.toArray(f,t._matViewProj)),this._device.setUniform("cc_cameraPos",n.Vec4.toArray(d,v)),this._submitLightsUniforms(),this._submitOtherStagesUniforms();for(var i=0;i<e.length;++i){var r=e.data[i];r.node.getWorldPosition(y),n.Vec3.sub(y,y,v),r.sortKey=-n.Vec3.dot(y,g)}this._sortItems(e),this._drawItems(t,e)},r})(r.default);i.default=E,e.exports=i.default}),{"../../core/value-types":293,"../core/base-renderer":315,"../enums":321,"../memop":338}],346:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r=t("../../core/value-types"),a=t("../../core/geom-utils"),s=(n=t("../enums"))&&n.__esModule?n:{default:n};function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var c=new r.Mat4,l=new r.Mat4,u=new r.Mat4,h=new r.Mat4,f=new r.Mat4,d=new r.Mat4,_=new r.Vec3,p=new r.Vec3,m=(function(){function t(){this._poolID=-1,this._node=null,this._projection=s.default.PROJ_PERSPECTIVE,this._priority=0,this._color=new r.Vec4(.2,.3,.47,1),this._depth=1,this._stencil=0,this._clearFlags=s.default.CLEAR_COLOR|s.default.CLEAR_DEPTH,this._clearModel=null,this._stages=[],this._framebuffer=null,this._near=.01,this._far=1e3,this._fov=Math.PI/4,this._rect={x:0,y:0,w:1,h:1},this._orthoHeight=10,this._cullingMask=4294967295}var e,i,n=t.prototype;return n.setCullingMask=function(t){this._cullingMask=t},n.getNode=function(){return this._node},n.setNode=function(t){this._node=t},n.getType=function(){return this._projection},n.setType=function(t){this._projection=t},n.getPriority=function(){return this._priority},n.setPriority=function(t){this._priority=t},n.getOrthoHeight=function(){return this._orthoHeight},n.setOrthoHeight=function(t){this._orthoHeight=t},n.getFov=function(){return this._fov},n.setFov=function(t){this._fov=t},n.getNear=function(){return this._near},n.setNear=function(t){this._near=t},n.getFar=function(){return this._far},n.setFar=function(t){this._far=t},n.getColor=function(t){return r.Vec4.copy(t,this._color)},n.setColor=function(t,e,i,n){r.Vec4.set(this._color,t,e,i,n)},n.getDepth=function(){return this._depth},n.setDepth=function(t){this._depth=t},n.getStencil=function(){return this._stencil},n.setStencil=function(t){this._stencil=t},n.getClearFlags=function(){return this._clearFlags},n.setClearFlags=function(t){this._clearFlags=t},n.getRect=function(t){return t.x=this._rect.x,t.y=this._rect.y,t.w=this._rect.w,t.h=this._rect.h,t},n.setRect=function(t,e,i,n){this._rect.x=t,this._rect.y=e,this._rect.w=i,this._rect.h=n},n.getStages=function(){return this._stages},n.setStages=function(t){this._stages=t},n.getFramebuffer=function(){return this._framebuffer},n.setFrameBuffer=function(t){this._framebuffer=t},n._calcMatrices=function(t,e){this._node.getWorldRT(u),r.Mat4.invert(l,u);var i=t/e;if(this._projection===s.default.PROJ_PERSPECTIVE)r.Mat4.perspective(h,this._fov,i,this._near,this._far);else{var n=this._orthoHeight*i,a=this._orthoHeight;r.Mat4.ortho(h,-n,n,-a,a,this._near,this._far)}r.Mat4.mul(f,h,l),r.Mat4.invert(d,f)},n.extractView=function(t,e,i){this._framebuffer&&(e=this._framebuffer._width,i=this._framebuffer._height),t._priority=this._priority,t._rect.x=this._rect.x*e,t._rect.y=this._rect.y*i,t._rect.w=this._rect.w*e,t._rect.h=this._rect.h*i,this.getColor(t._color),t._depth=this._depth,t._stencil=this._stencil,t._clearFlags=this._clearFlags,t._clearModel=this._clearModel,t._stages=this._stages,t._framebuffer=this._framebuffer,this._calcMatrices(e,i),r.Mat4.copy(t._matView,l),r.Mat4.copy(t._matViewInv,u),r.Mat4.copy(t._matProj,h),r.Mat4.copy(t._matViewProj,f),r.Mat4.copy(t._matInvViewProj,d),t._cullingMask=this._cullingMask},n.screenPointToRay=function(t,e,i,n,o){if(!cc.geomUtils)return o;o=o||new a.Ray,this._calcMatrices(i,n);var c=this._rect.x*i,l=this._rect.y*n,u=this._rect.w*i,h=this._rect.h*n;return r.Vec3.set(p,(t-c)/u*2-1,(e-l)/h*2-1,1),r.Vec3.transformMat4(p,p,d),this._projection===s.default.PROJ_PERSPECTIVE?this._node.getWorldPosition(_):(r.Vec3.set(_,(t-c)/u*2-1,(e-l)/h*2-1,-1),r.Vec3.transformMat4(_,_,d)),a.Ray.fromPoints(o,_,p)},n.screenToWorld=function(t,e,i,n){this._calcMatrices(i,n);var a=this._rect.x*i,o=this._rect.y*n,c=this._rect.w*i,l=this._rect.h*n;return this._projection===s.default.PROJ_PERSPECTIVE?(r.Vec3.set(t,(e.x-a)/c*2-1,(e.y-o)/l*2-1,.9999),r.Vec3.transformMat4(t,t,d),this._node.getWorldPosition(_),r.Vec3.lerp(t,_,t,(0,r.lerp)(this._near/this._far,1,e.z))):(r.Vec3.set(t,(e.x-a)/c*2-1,(e.y-o)/l*2-1,2*e.z-1),r.Vec3.transformMat4(t,t,d)),t},n.worldToScreen=function(t,e,i,n){this._calcMatrices(i,n);var a=this._rect.x*i,s=this._rect.y*n,o=this._rect.w*i,c=this._rect.h*n;return r.Vec3.transformMat4(t,e,f),t.x=a+.5*(t.x+1)*o,t.y=s+.5*(t.y+1)*c,t.z=.5*t.z+.5,t},n.worldMatrixToScreen=function(t,e,i,n){this._calcMatrices(i,n),r.Mat4.mul(t,f,e);var a=i/2,s=n/2;return r.Mat4.identity(c),r.Mat4.transform(c,c,r.Vec3.set(_,a,s,0)),r.Mat4.scale(c,c,r.Vec3.set(_,a,s,1)),r.Mat4.mul(t,c,t),t},e=t,(i=[{key:"cullingMask",get:function(){return this._cullingMask},set:function(t){this._cullingMask=t}}])&&o(e.prototype,i),t})();i.default=m,e.exports=i.default}),{"../../core/geom-utils":174,"../../core/value-types":293,"../enums":321}],347:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=t("../../core/value-types"),r=s(t("../gfx")),a=s(t("../enums"));function s(t){return t&&t.__esModule?t:{default:t}}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var c=cc.v3(0,0,-1),l=cc.mat4(),u=n.Mat3.create(),h=cc.v3(0,0,0);function f(t,e,i){t._node.getWorldRT(e),n.Mat4.invert(e,e);var r=t._shadowFrustumSize/2;n.Mat4.ortho(i,-r,r,-r,r,t._shadowMinDepth,t._shadowMaxDepth)}function d(t,e,i){t._node.getWorldRT(e),n.Mat4.invert(e,e),n.Mat4.perspective(i,(0,n.toRadian)(179),1,t._shadowMinDepth,t._shadowMaxDepth)}var _=(function(){function t(){this._poolID=-1,this._node=null,this._type=a.default.LIGHT_DIRECTIONAL,this._color=new n.Vec3(1,1,1),this._intensity=1,this._range=1,this._spotAngle=(0,n.toRadian)(60),this._spotExp=1,this._directionUniform=new Float32Array(3),this._positionUniform=new Float32Array(3),this._colorUniform=new Float32Array([this._color.x*this._intensity,this._color.y*this._intensity,this._color.z*this._intensity]),this._spotUniform=new Float32Array([Math.cos(.5*this._spotAngle),this._spotExp]),this._shadowType=a.default.SHADOW_NONE,this._shadowFrameBuffer=null,this._shadowMap=null,this._shadowMapDirty=!1,this._shadowDepthBuffer=null,this._shadowResolution=1024,this._shadowBias=5e-4,this._shadowDarkness=1,this._shadowMinDepth=1,this._shadowMaxDepth=1e3,this._frustumEdgeFalloff=0,this._viewProjMatrix=cc.mat4(),this._spotAngleScale=1,this._shadowFrustumSize=50}var e,i,s=t.prototype;return s.getNode=function(){return this._node},s.setNode=function(t){this._node=t},s.setColor=function(t,e,i){n.Vec3.set(this._color,t,e,i),this._colorUniform[0]=t*this._intensity,this._colorUniform[1]=e*this._intensity,this._colorUniform[2]=i*this._intensity},s.setIntensity=function(t){this._intensity=t,this._colorUniform[0]=t*this._color.x,this._colorUniform[1]=t*this._color.y,this._colorUniform[2]=t*this._color.z},s.setType=function(t){this._type=t},s.setSpotAngle=function(t){this._spotAngle=t,this._spotUniform[0]=Math.cos(.5*this._spotAngle)},s.setSpotExp=function(t){this._spotExp=t,this._spotUniform[1]=t},s.setRange=function(t){this._range=t},s.setShadowType=function(t){this._shadowType===a.default.SHADOW_NONE&&t!==a.default.SHADOW_NONE&&(this._shadowMapDirty=!0),this._shadowType=t},s.setShadowResolution=function(t){this._shadowResolution!==t&&(this._shadowMapDirty=!0),this._shadowResolution=t},s.setShadowBias=function(t){this._shadowBias=t},s.setShadowDarkness=function(t){this._shadowDarkness=t},s.setShadowMinDepth=function(t){this._shadowMinDepth=t},s.setShadowMaxDepth=function(t){this._shadowMaxDepth=t},s.setFrustumEdgeFalloff=function(t){this._frustumEdgeFalloff=t},s.setShadowFrustumSize=function(t){this._shadowFrustumSize=t},s.extractView=function(t,e){switch(t._shadowLight=this,t._priority=-1,t._rect.x=0,t._rect.y=0,t._rect.w=this._shadowResolution,t._rect.h=this._shadowResolution,n.Vec3.set(t._color,1,1,1),t._depth=1,t._stencil=1,t._clearFlags=a.default.CLEAR_COLOR|a.default.CLEAR_DEPTH,t._stages=e,t._framebuffer=this._shadowFrameBuffer,this._type){case a.default.LIGHT_SPOT:this,i=t._matView,r=t._matProj,this._node.getWorldRT(i),n.Mat4.invert(i,i),n.Mat4.perspective(r,this._spotAngle*this._spotAngleScale,1,this._shadowMinDepth,this._shadowMaxDepth);break;case a.default.LIGHT_DIRECTIONAL:f(this,t._matView,t._matProj);break;case a.default.LIGHT_POINT:d(this,t._matView,t._matProj);break;case a.default.LIGHT_AMBIENT:break;default:console.warn("shadow of this light type is not supported")}var i,r;n.Mat4.mul(t._matViewProj,t._matProj,t._matView),this._viewProjMatrix=t._matViewProj,n.Mat4.invert(t._matInvViewProj,t._matViewProj),t._cullingMask=4294967295},s._updateLightPositionAndDirection=function(){this._node.getWorldMatrix(l),n.Mat3.fromMat4(u,l),n.Vec3.transformMat3(h,c,u),n.Vec3.toArray(this._directionUniform,h);var t=this._positionUniform,e=l.m;t[0]=e[12],t[1]=e[13],t[2]=e[14]},s._generateShadowMap=function(t){this._shadowMap=new r.default.Texture2D(t,{width:this._shadowResolution,height:this._shadowResolution,format:r.default.TEXTURE_FMT_RGBA8,wrapS:r.default.WRAP_CLAMP,wrapT:r.default.WRAP_CLAMP}),this._shadowDepthBuffer=new r.default.RenderBuffer(t,r.default.RB_FMT_D16,this._shadowResolution,this._shadowResolution),this._shadowFrameBuffer=new r.default.FrameBuffer(t,this._shadowResolution,this._shadowResolution,{colors:[this._shadowMap],depth:this._shadowDepthBuffer})},s._destroyShadowMap=function(){this._shadowMap&&(this._shadowMap.destroy(),this._shadowDepthBuffer.destroy(),this._shadowFrameBuffer.destroy(),this._shadowMap=null,this._shadowDepthBuffer=null,this._shadowFrameBuffer=null)},s.update=function(t){this._updateLightPositionAndDirection(),this._shadowType===a.default.SHADOW_NONE?this._destroyShadowMap():this._shadowMapDirty&&(this._destroyShadowMap(),this._generateShadowMap(t),this._shadowMapDirty=!1)},e=t,(i=[{key:"color",get:function(){return this._color}},{key:"intensity",get:function(){return this._intensity}},{key:"type",get:function(){return this._type}},{key:"spotAngle",get:function(){return this._spotAngle}},{key:"spotExp",get:function(){return this._spotExp}},{key:"range",get:function(){return this._range}},{key:"shadowType",get:function(){return this._shadowType}},{key:"shadowMap",get:function(){return this._shadowMap}},{key:"viewProjMatrix",get:function(){return this._viewProjMatrix}},{key:"shadowResolution",get:function(){return this._shadowResolution}},{key:"shadowBias",get:function(){return this._shadowBias}},{key:"shadowDarkness",get:function(){return this._shadowDarkness}},{key:"shadowMinDepth",get:function(){return this._type===a.default.LIGHT_DIRECTIONAL?1:this._shadowMinDepth}},{key:"shadowMaxDepth",get:function(){return this._type===a.default.LIGHT_DIRECTIONAL?1:this._shadowMaxDepth}},{key:"frustumEdgeFalloff",get:function(){return this._frustumEdgeFalloff}},{key:"shadowFrustumSize",get:function(){return this._shadowFrustumSize}}])&&o(e.prototype,i),t})();i.default=_,e.exports=i.default}),{"../../core/value-types":293,"../enums":321,"../gfx":326}],348:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=(function(){function t(){this._type="default",this._poolID=-1,this._node=null,this._inputAssembler=null,this._effect=null,this._viewID=-1,this._cameraID=-1,this._userKey=-1,this._castShadow=!1,this._boundingShape=null}var e=t.prototype;return e.setNode=function(t){this._node=t},e.setInputAssembler=function(t){this._inputAssembler=t},e.setEffect=function(t){this._effect=t},e.setUserKey=function(t){this._userKey=t},e.extractDrawItem=function(t){t.model=this,t.node=this._node,t.ia=this._inputAssembler,t.effect=this._effect},t})();i.default=n,e.exports=i.default}),{}],349:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n=t("../memop"),r=(function(){function t(t){this._lights=new n.FixedArray(16),this._models=new n.FixedArray(16),this._cameras=new n.FixedArray(16),this._debugCamera=null,this._app=t,this._views=[]}var e=t.prototype;return e._add=function(t,e){-1===e._poolID&&(t.push(e),e._poolID=t.length-1)},e._remove=function(t,e){-1!==e._poolID&&(t.data[t.length-1]._poolID=e._poolID,t.fastRemove(e._poolID),e._poolID=-1)},e.reset=function(){for(var t=0;t<this._models.length;++t)this._models.data[t]._viewID=-1},e.setDebugCamera=function(t){this._debugCamera=t},e.getCameraCount=function(){return this._cameras.length},e.getCamera=function(t){return this._cameras.data[t]},e.addCamera=function(t){this._add(this._cameras,t)},e.removeCamera=function(t){this._remove(this._cameras,t)},e.getModelCount=function(){return this._models.length},e.getModel=function(t){return this._models.data[t]},e.addModel=function(t){this._add(this._models,t)},e.removeModel=function(t){this._remove(this._models,t)},e.getLightCount=function(){return this._lights.length},e.getLight=function(t){return this._lights.data[t]},e.addLight=function(t){this._add(this._lights,t)},e.removeLight=function(t){this._remove(this._lights,t)},e.addView=function(t){-1===this._views.indexOf(t)&&this._views.push(t)},e.removeView=function(t){var e=this._views.indexOf(t);-1!==e&&this._views.splice(e,1)},t})();i.default=r,e.exports=i.default}),{"../memop":338}],350:[(function(t,e,i){"use strict";i.__esModule=!0,i.getInspectorProps=function(t){var e={type:t.type};Object.assign(e,t.editor||t.inspector),e.defines=t.defines,e.value=g(e.type)(t.value),t.range&&(e.range=t.range);var i=y(e.type);return e.typeName=T[i]||i,e.valueCtor=_[e.type],"cc.Texture2D"==e.typeName&&(e.typeName="cc.Asset",e.assetType="cc.Texture2D"),e},i.getClassName=i.getInstanceCtor=i.getInstanceType=i.enums2default=i.ctor2enums=void 0;var n,r,a,s,o=u(t("./enums")),c=t("../core/value-types"),l=u(t("../core/assets/CCTexture2D"));function u(t){return t&&t.__esModule?t:{default:t}}var h;h=t("./gfx/texture-2d");var f=cc.Object,d=((n={})[Boolean]=function(t){return t||!1},n[Number]=function(t){return t?ArrayBuffer.isView(t)?t[0]:t:0},n[c.Vec2]=function(t){return t?cc.v2(t[0],t[1]):cc.v2()},n[c.Vec3]=function(t){return t?cc.v3(t[0],t[1],t[2]):cc.v3()},n[c.Vec4]=function(t){return t?cc.v4(t[0],t[1],t[2],t[3]):cc.v4()},n[c.Color]=function(t){return t?cc.color(255*t[0],255*t[1],255*t[2],255*(t[3]||1)):cc.color()},n[c.Mat4]=function(t){return t?cc.mat4(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]):cc.mat4()},n[l.default]=function(){return null},n[f]=function(){return null},n),_=((r={})[o.default.PARAM_INT]=Number,r[o.default.PARAM_INT2]=c.Vec2,r[o.default.PARAM_INT3]=c.Vec3,r[o.default.PARAM_INT4]=c.Vec4,r[o.default.PARAM_FLOAT]=Number,r[o.default.PARAM_FLOAT2]=c.Vec2,r[o.default.PARAM_FLOAT3]=c.Vec3,r[o.default.PARAM_FLOAT4]=c.Vec4,r[o.default.PARAM_MAT4]=c.Mat4,r[o.default.PARAM_TEXTURE_2D]=l.default,r.color=c.Color,r.number=Number,r.boolean=Boolean,r.default=f,r),p=((a={})[Number]=o.default.PARAM_FLOAT,a[c.Vec2]=o.default.PARAM_FLOAT2,a[c.Vec3]=o.default.PARAM_FLOAT3,a[c.Vec4]=o.default.PARAM_FLOAT4,a[c.Color]=o.default.PARAM_COLOR3,a[c.Color]=o.default.PARAM_COLOR4,a[c.Mat4]=o.default.PARAM_MAT4,a[l.default]=o.default.PARAM_TEXTURE_2D,a[h]=o.default.PARAM_TEXTURE_2D,a);i.ctor2enums=p;var m=((s={})[o.default.PARAM_INT]=new Uint32Array([0]),s[o.default.PARAM_INT2]=new Uint32Array([0,0]),s[o.default.PARAM_INT3]=new Uint32Array([0,0,0]),s[o.default.PARAM_INT4]=new Uint32Array([0,0,0,0]),s[o.default.PARAM_FLOAT]=new Float32Array([0]),s[o.default.PARAM_FLOAT2]=new Float32Array([0,0]),s[o.default.PARAM_FLOAT3]=new Float32Array([0,0,0]),s[o.default.PARAM_FLOAT4]=new Float32Array([0,0,0,0]),s[o.default.PARAM_MAT4]=cc.mat4().m,s[o.default.PARAM_TEXTURE_2D]=null,s.number=0,s.boolean=!1,s);i.enums2default=m;var v=function(t){return _[t]||_.default};i.getInstanceType=v;var g=function(t){return d[v(t)]};i.getInstanceCtor=g;var y=function(t){return cc.js.getClassName(v(t))};i.getClassName=y;var T={Number:"number",Boolean:"boolean"}}),{"../core/assets/CCTexture2D":108,"../core/value-types":293,"./enums":321,"./gfx/texture-2d":331}],351:[(function(t,e){"use strict";var i=cc.Class({name:"cc.TiledMapAsset",extends:cc.Asset,properties:{tmxXmlStr:"",textures:{default:[],type:[cc.Texture2D]},textureNames:[cc.String],textureSizes:{default:[],type:[cc.Size]},imageLayerTextures:{default:[],type:[cc.Texture2D]},imageLayerTextureNames:[cc.String],tsxFiles:[cc.TextAsset],tsxFileNames:[cc.String]},statics:{preventDeferredLoadDependents:!0},createNode:!1});cc.TiledMapAsset=i,e.exports=i}),{}],352:[(function(t){"use strict";t("./cocos2d/core"),t("./cocos2d/animation"),t("./cocos2d/particle"),t("./cocos2d/tilemap"),t("./cocos2d/videoplayer/CCVideoPlayer"),t("./cocos2d/webview/CCWebView"),t("./cocos2d/core/components/CCStudioComponent"),t("./extensions/ccpool/CCNodePool"),t("./cocos2d/actions"),t("./extensions/spine"),t("./extensions/dragonbones"),t("./cocos2d/deprecated")}),{"./cocos2d/actions":7,"./cocos2d/animation":16,"./cocos2d/core":186,"./cocos2d/core/components/CCStudioComponent":void 0,"./cocos2d/deprecated":305,"./cocos2d/particle":311,"./cocos2d/particle/CCParticleAsset":308,"./cocos2d/tilemap":void 0,"./cocos2d/tilemap/CCTiledMapAsset":351,"./cocos2d/videoplayer/CCVideoPlayer":void 0,"./cocos2d/webview/CCWebView":void 0,"./extensions/ccpool/CCNodePool":353,"./extensions/dragonbones":void 0,"./extensions/spine":356}],353:[(function(t,e){"use strict";cc.NodePool=function(t){this.poolHandlerComp=t,this._pool=[]},cc.NodePool.prototype={constructor:cc.NodePool,size:function(){return this._pool.length},clear:function(){for(var t=this._pool.length,e=0;e<t;++e)this._pool[e].destroy();this._pool.length=0},put:function(t){if(t&&-1===this._pool.indexOf(t)){t.removeFromParent(!1);var e=this.poolHandlerComp?t.getComponent(this.poolHandlerComp):null;e&&e.unuse&&e.unuse(),this._pool.push(t)}},get:function(){var t=this._pool.length-1;if(t<0)return null;var e=this._pool[t];this._pool.length=t;var i=this.poolHandlerComp?e.getComponent(this.poolHandlerComp):null;return i&&i.reuse&&i.reuse.apply(i,arguments),e}},e.exports=cc.NodePool}),{}],354:[(function(t,e){"use strict";var i,n=(i=t("../../cocos2d/core/value-types/mat4"))&&i.__esModule?i:{default:i},r=t("../../cocos2d/core/renderer/render-flow").FLAG_TRANSFORM,a=function(){},s=function(t){Object.defineProperty(t,"_worldMatDirty",{get:function(){return!0},set:function(){}}),t._calculWorldMatrix=a,t._mulMat=a},o=new n.default,c=cc.Class({name:"sp.AttachUtil",ctor:function(){this._inited=!1,this._skeleton=null,this._skeletonNode=null,this._skeletonComp=null,this._attachedRootNode=null,this._attachedNodeArray=[],this._boneIndexToNode={}},init:function(t){this._inited=!0,this._skeleton=t._skeleton,this._skeletonNode=t.node,this._skeletonComp=t},reset:function(){this._inited=!1,this._skeleton=null,this._skeletonNode=null,this._skeletonComp=null},_prepareAttachNode:function(){if(this._skeleton){var t=this._skeletonNode.getChildByName("ATTACHED_NODE_TREE");return t&&t.isValid||(t=new cc.Node("ATTACHED_NODE_TREE"),s(t),this._skeletonNode.addChild(t)),this._skeletonComp.isAnimationCached()&&this._skeletonComp._frameCache&&this._skeletonComp._frameCache.enableCacheAttachedInfo(),this._attachedRootNode=t,t}},_buildBoneAttachedNode:function(t,e){var i="ATTACHED_NODE:"+t.data.name,n=new cc.Node(i);return this._buildBoneRelation(n,t,e),n},_buildBoneRelation:function(t,e,i){s(t),t._bone=e,t._boneIndex=i,this._attachedNodeArray.push(t),this._boneIndexToNode[i]=t},getAttachedRootNode:function(){return this._attachedRootNode},getAttachedNodes:function(t){var e=this._attachedNodeArray,i=[];if(!this._inited)return i;for(var n=0,r=e.length;n<r;n++){var a=e[n];a&&a.isValid&&a.name==="ATTACHED_NODE:"+t&&i.push(a)}return i},_rebuildNodeArray:function(){for(var t=this._boneIndexToNode={},e=this._attachedNodeArray,i=this._attachedNodeArray=[],n=0,r=e.length;n<r;n++){var a=e[n];a&&a.isValid&&!a._toRemove&&(i.push(a),t[a._boneIndex]=a)}},_sortNodeArray:function(){this._attachedNodeArray.sort((function(t,e){return t._boneIndex<e._boneIndex?-1:1}))},_getNodeByBoneIndex:function(t){var e=this._boneIndexToNode[t];return e&&e.isValid?e:null},destroyAttachedNodes:function(t){if(this._inited){for(var e=this._attachedNodeArray,i=function t(e){for(var i=e.children,n=0,r=i.length;n<r;n++){var a=i[n];a&&t(a)}e._toRemove=!0},n=0,r=e.length;n<r;n++){var a=e[n];a&&a.isValid&&a.name.split("ATTACHED_NODE:")[1]===t&&(i(a),a.removeFromParent(!0),a.destroy(),e[n]=null)}this._rebuildNodeArray()}},generateAttachedNodes:function(t){var e=[];if(!this._inited)return e;var i=this._prepareAttachNode();if(!i)return e;for(var n=[],r=this._skeleton.bones,a=0,s=r.length;a<s;a++){var o=r[a];o.data.name==t&&n.push(o)}for(var c=function(t){if(t){var e=t.data,n=this._getNodeByBoneIndex(e.index);if(n)return n;n=this._buildBoneAttachedNode(t,e.index);var r=c(t.parent)||i;return n.parent=r,n}}.bind(this),l=0,u=n.length;l<u;l++){var h=c(n[l]);e.push(h)}return this._sortNodeArray(),e},destroyAllAttachedNodes:function(){if(this._attachedRootNode=null,this._attachedNodeArray.length=0,this._boneIndexToNode={},this._inited){var t=this._skeletonNode.getChildByName("ATTACHED_NODE_TREE");t&&(t.removeFromParent(!0),t.destroy(),t=null)}},generateAllAttachedNodes:function(){if(this._inited){this._boneIndexToNode={},this._attachedNodeArray.length=0;var t=this._prepareAttachNode();if(t){for(var e=this._skeleton.bones,i=0,n=e.length;i<n;i++){var r=e[i],a=r.data,s=null;if(r.parent){var o=r.parent.data.index;s=this._boneIndexToNode[o]}else s=t;if(s){var c=s.getChildByName("ATTACHED_NODE:"+a.name);c&&c.isValid?this._buildBoneRelation(c,r,a.index):(c=this._buildBoneAttachedNode(r,a.index),s.addChild(c))}}return t}}},_hasAttachedNode:function(){return!!this._inited&&!!this._skeletonNode.getChildByName("ATTACHED_NODE_TREE")},_associateAttachedNode:function(){if(this._inited){var t=this._skeletonNode.getChildByName("ATTACHED_NODE_TREE");if(t&&t.isValid){this._attachedRootNode=t,this._boneIndexToNode={},this._attachedNodeArray.length=0,s(t),this._skeletonComp.isAnimationCached()&&this._skeletonComp._frameCache&&this._skeletonComp._frameCache.enableCacheAttachedInfo();for(var e=this._skeleton.bones,i=0,n=e.length;i<n;i++){var r=e[i],a=r.data,o=null;if(r.parent){var c=r.parent.data.index;o=this._boneIndexToNode[c]}else o=t;if(o){var l=o.getChildByName("ATTACHED_NODE:"+a.name);l&&l.isValid&&this._buildBoneRelation(l,r,a.index)}}}}},_syncAttachedNode:function(){if(this._inited){var t=this._attachedRootNode,e=this._attachedNodeArray;if(!t||!t.isValid)return this._attachedRootNode=null,void(e.length=0);var i=this._skeletonNode._worldMatrix;n.default.copy(t._worldMatrix,i),t._renderFlag&=~r;var a;if(a=this._skeletonComp.isAnimationCached()?this._skeletonComp._curFrame&&this._skeletonComp._curFrame.boneInfos:this._skeleton.bones){for(var s=this._skeletonNode._mulMat,c=function(t,e,i){var n=o.m;n[0]=i.a,n[1]=i.c,n[4]=i.b,n[5]=i.d,n[12]=i.worldX,n[13]=i.worldY,s(t,e,o)},l=!1,u=0,h=e.length;u<h;u++){var f=e[u];if(f&&f.isValid){var d=a[f._boneIndex];d?(c(f._worldMatrix,t._worldMatrix,d),f._renderFlag&=~r):(f.removeFromParent(!0),f.destroy(),e[u]=null,l=!0)}else e[u]=null,l=!0}l&&this._rebuildNodeArray()}}}});e.exports=sp.AttachUtil=c}),{"../../cocos2d/core/renderer/render-flow":226,"../../cocos2d/core/value-types/mat4":295}],355:[(function(t,e){"use strict";var i=t("./track-entry-listeners"),n=t("../../cocos2d/core/components/CCRenderComponent"),r=t("./lib/spine"),a=t("../../cocos2d/core/graphics/graphics"),s=t("../../cocos2d/core/renderer/render-flow").FLAG_POST_RENDER,o=t("./skeleton-cache"),c=t("./AttachUtil"),l=cc.Enum({default:-1}),u=cc.Enum({"<None>":0}),h=cc.Enum({REALTIME:0,SHARED_CACHE:1,PRIVATE_CACHE:2});sp.Skeleton=cc.Class({name:"sp.Skeleton",extends:n,editor:!1,statics:{AnimationCacheMode:h},properties:{paused:{default:!1,visible:!1},skeletonData:{default:null,type:sp.SkeletonData,notify:function(){this.defaultSkin="",this.defaultAnimation="",this._updateSkeletonData()},tooltip:!1},defaultSkin:{default:"",visible:!1},defaultAnimation:{default:"",visible:!1},animation:{get:function(){if(this.isAnimationCached())return this._animationName;var t=this.getCurrent(0);return t&&t.animation.name||""},set:function(t){this.defaultAnimation=t,t?this.setAnimation(0,t,this.loop):this.isAnimationCached()||(this.clearTrack(0),this.setToSetupPose())},visible:!1},_defaultSkinIndex:{get:function(){if(this.skeletonData){var t=this.skeletonData.getSkinsEnum();if(t)if(""===this.defaultSkin){if(t.hasOwnProperty(0))return this._defaultSkinIndex=0,0}else{var e=t[this.defaultSkin];if(void 0!==e)return e}}return 0},set:function(t){var e;if(this.skeletonData&&(e=this.skeletonData.getSkinsEnum()),!e)return cc.errorID("",this.name);var i=e[t];void 0!==i?(this.defaultSkin=i,this.setSkin(this.defaultSkin)):cc.errorID(7501,this.name)},type:l,visible:!0,animatable:!1,displayName:"Default Skin",tooltip:!1},_animationIndex:{get:function(){var t=this.animation;if(this.skeletonData&&t){var e=this.skeletonData.getAnimsEnum();if(e){var i=e[t];if(void 0!==i)return i}}return 0},set:function(t){if(0!==t){var e;if(this.skeletonData&&(e=this.skeletonData.getAnimsEnum()),!e)return cc.errorID(7502,this.name);var i=e[t];void 0!==i?this.animation=i:cc.errorID(7503,this.name)}else this.animation=""},type:u,visible:!0,animatable:!1,displayName:"Animation",tooltip:!1},_preCacheMode:-1,_cacheMode:h.REALTIME,_defaultCacheMode:{default:0,type:h,notify:function(){this.setAnimationCacheMode(this._defaultCacheMode)},editorOnly:!0,visible:!0,animatable:!1,displayName:"Animation Cache Mode",tooltip:!1},loop:{default:!0,tooltip:!1},premultipliedAlpha:{default:!0,tooltip:!1},timeScale:{default:1,tooltip:!1},debugSlots:{default:!1,editorOnly:!0,tooltip:!1,notify:function(){this._updateDebugDraw()}},debugBones:{default:!1,editorOnly:!0,tooltip:!1,notify:function(){this._updateDebugDraw()}},debugMesh:{default:!1,editorOnly:!0,tooltip:!1,notify:function(){this._updateDebugDraw()}},useTint:{default:!1,tooltip:!1,notify:function(){this._updateUseTint()}},enableBatch:{default:!1,notify:function(){this._updateBatch()},tooltip:!1},_accTime:0,_playCount:0,_frameCache:null,_curFrame:null,_skeletonCache:null,_animationName:"",_animationQueue:[],_headAniInfo:null,_playTimes:0,_isAniComplete:!0},ctor:function(){this._effectDelegate=null,this._skeleton=null,this._rootBone=null,this._listener=null,this._materialCache={},this._debugRenderer=null,this._startSlotIndex=-1,this._endSlotIndex=-1,this._startEntry={animation:{name:""},trackIndex:0},this._endEntry={animation:{name:""},trackIndex:0},this.attachUtil=new c},_getDefaultMaterial:function(){return cc.Material.getBuiltinMaterial("2d-spine")},_updateMaterial:function(){var t=this.useTint||this.isAnimationCached()&&!0,e=this.getMaterial(0);if(e){e.define("USE_TINT",t),e.define("CC_USE_MODEL",!this.enableBatch);var i=this.premultipliedAlpha?cc.gfx.BLEND_ONE:cc.gfx.BLEND_SRC_ALPHA,n=cc.gfx.BLEND_ONE_MINUS_SRC_ALPHA;e.setBlend(!0,cc.gfx.BLEND_FUNC_ADD,i,i,cc.gfx.BLEND_FUNC_ADD,n,n)}this._materialCache={}},disableRender:function(){this._super(),this.node._renderFlag&=~s},markForRender:function(t){this._super(t),t?this.node._renderFlag|=s:this.node._renderFlag&=~s},_updateUseTint:function(){var t=this.getMaterial(0);if(t){var e=this.useTint||this.isAnimationCached()&&!0;t.define("USE_TINT",e)}this._materialCache={}},_updateBatch:function(){var t=this.getMaterial(0);t&&t.define("CC_USE_MODEL",!this.enableBatch),this._materialCache={}},_validateRender:function(){var t=this.skeletonData;t&&t.isTexturesLoaded()?this._super():this.disableRender()},setSkeletonData:function(t){if(null!=t.width&&null!=t.height&&this.node.setContentSize(t.width,t.height),this._cacheMode===h.SHARED_CACHE?this._skeletonCache=o.sharedCache:this._cacheMode===h.PRIVATE_CACHE&&(this._skeletonCache=new o,this._skeletonCache.enablePrivateMode()),this.isAnimationCached()){(this.debugBones||this.debugSlots)&&cc.warn("Debug bones or slots is invalid in cached mode");var e=this._skeletonCache.getSkeletonCache(this.skeletonData._uuid,t);this._skeleton=e.skeleton,this._clipper=e.clipper,this._rootBone=this._skeleton.getRootBone()}else this._skeleton=new r.Skeleton(t),this._clipper=new r.SkeletonClipping,this._rootBone=this._skeleton.getRootBone();this.markForRender(!0)},setSlotsRange:function(t,e){this.isAnimationCached()?cc.warn("Slots visible range can not be modified in cached mode."):(this._startSlotIndex=t,this._endSlotIndex=e)},setAnimationStateData:function(t){if(this.isAnimationCached())cc.warn("'setAnimationStateData' interface can not be invoked in cached mode.");else{var e=new r.AnimationState(t);this._listener&&(this._state&&this._state.removeListener(this._listener),e.addListener(this._listener)),this._state=e}},__preload:function(){this._super();for(var t=this.node.children,e=0,i=t.length;e<i;e++){var n=t[e];n&&"DEBUG_DRAW_NODE"===n._name&&n.destroy()}this._updateSkeletonData(),this._updateDebugDraw(),this._updateUseTint(),this._updateBatch()},setAnimationCacheMode:function(t){this._preCacheMode!==t&&(this._cacheMode=t,this._updateSkeletonData(),this._updateUseTint())},isAnimationCached:function(){return this._cacheMode!==h.REALTIME},update:function(t){if(!this.paused)if(t*=this.timeScale*sp.timeScale,this.isAnimationCached()){if(this._isAniComplete){if(0===this._animationQueue.length&&!this._headAniInfo){var e=this._frameCache;if(e&&e.isInvalid()){e.updateToFrame();var i=e.frames;this._curFrame=i[i.length-1]}return}if(this._headAniInfo||(this._headAniInfo=this._animationQueue.shift()),this._accTime+=t,this._accTime>this._headAniInfo.delay){var n=this._headAniInfo;this._headAniInfo=null,this.setAnimation(0,n.animationName,n.loop)}return}this._updateCache(t)}else this._updateRealtime(t)},_emitCacheCompleteEvent:function(){this._listener&&(this._endEntry.animation.name=this._animationName,this._listener.complete&&this._listener.complete(this._endEntry),this._listener.end&&this._listener.end(this._endEntry))},_updateCache:function(t){var e=this._frameCache;if(e.isInited()){var i=e.frames,n=o.FrameTime;0==this._accTime&&0==this._playCount&&(this._startEntry.animation.name=this._animationName,this._listener&&this._listener.start&&this._listener.start(this._startEntry)),this._accTime+=t;var r=Math.floor(this._accTime/n);if(e.isCompleted||e.updateToFrame(r),e.isCompleted&&r>=i.length){if(this._playCount++,this._playTimes>0&&this._playCount>=this._playTimes)return this._curFrame=i[i.length-1],this._accTime=0,this._playCount=0,this._isAniComplete=!0,void this._emitCacheCompleteEvent();this._accTime=0,r=0,this._emitCacheCompleteEvent()}this._curFrame=i[r]}},_updateRealtime:function(t){var e=this._skeleton,i=this._state;e&&(e.update(t),i&&(i.update(t),i.apply(e)))},setVertexEffectDelegate:function(t){this._effectDelegate=t},updateWorldTransform:function(){this.isAnimationCached()&&this._skeleton&&this._skeleton.updateWorldTransform()},setToSetupPose:function(){this._skeleton&&this._skeleton.setToSetupPose()},setBonesToSetupPose:function(){this._skeleton&&this._skeleton.setBonesToSetupPose()},setSlotsToSetupPose:function(){this._skeleton&&this._skeleton.setSlotsToSetupPose()},updateAnimationCache:function(t){if(this.isAnimationCached()){var e=this.skeletonData._uuid;this._skeletonCache&&this._skeletonCache.updateAnimationCache(e,t)}},invalidAnimationCache:function(){this.isAnimationCached()&&this._skeletonCache&&this._skeletonCache.invalidAnimationCache(this.skeletonData._uuid)},findBone:function(t){return this._skeleton?this._skeleton.findBone(t):null},findSlot:function(t){return this._skeleton?this._skeleton.findSlot(t):null},setSkin:function(t){this._skeleton&&(this._skeleton.setSkinByName(t),this._skeleton.setSlotsToSetupPose()),this.invalidAnimationCache()},getAttachment:function(t,e){return this._skeleton?this._skeleton.getAttachmentByName(t,e):null},setAttachment:function(t,e){this._skeleton&&this._skeleton.setAttachment(t,e),this.invalidAnimationCache()},getTextureAtlas:function(t){return t.region},setMix:function(t,e,i){this._state&&this._state.data.setMix(t,e,i)},setAnimation:function(t,e,i){if(this._playTimes=i?0:1,this._animationName=e,this.isAnimationCached()){if(0!==t&&cc.warn("Track index can not greater than 0 in cached mode."),!this._skeletonCache)return null;var n=this._skeletonCache.getAnimationCache(this.skeletonData._uuid,e);n||(n=this._skeletonCache.initAnimationCache(this.skeletonData._uuid,e)),n&&(this._isAniComplete=!1,this._accTime=0,this._playCount=0,this._frameCache=n,this.attachUtil._hasAttachedNode()&&this._frameCache.enableCacheAttachedInfo(),this._frameCache.updateToFrame(0),this._curFrame=this._frameCache.frames[0])}else if(this._skeleton){var r=this._skeleton.data.findAnimation(e);if(!r)return cc.logID(7509,e),null;var a=this._state.setAnimationWith(t,r,i);return this._state.apply(this._skeleton),a}return null},addAnimation:function(t,e,i,n){if(n=n||0,this.isAnimationCached())0!==t&&cc.warn("Track index can not greater than 0 in cached mode."),this._animationQueue.push({animationName:e,loop:i,delay:n});else if(this._skeleton){var r=this._skeleton.data.findAnimation(e);return r?this._state.addAnimationWith(t,r,i,n):(cc.logID(7510,e),null)}return null},findAnimation:function(t){return this._skeleton?this._skeleton.data.findAnimation(t):null},getCurrent:function(t){if(this.isAnimationCached())cc.warn("'getCurrent' interface can not be invoked in cached mode.");else if(this._state)return this._state.getCurrent(t);return null},clearTracks:function(){this.isAnimationCached()?cc.warn("'clearTracks' interface can not be invoked in cached mode."):this._state&&this._state.clearTracks()},clearTrack:function(t){this.isAnimationCached()?cc.warn("'clearTrack' interface can not be invoked in cached mode."):this._state&&this._state.clearTrack(t)},setStartListener:function(t){this._ensureListener(),this._listener.start=t},setInterruptListener:function(t){this._ensureListener(),this._listener.interrupt=t},setEndListener:function(t){this._ensureListener(),this._listener.end=t},setDisposeListener:function(t){this._ensureListener(),this._listener.dispose=t},setCompleteListener:function(t){this._ensureListener(),this._listener.complete=t},setEventListener:function(t){this._ensureListener(),this._listener.event=t},setTrackStartListener:function(t,e){i.getListeners(t).start=e},setTrackInterruptListener:function(t,e){i.getListeners(t).interrupt=e},setTrackEndListener:function(t,e){i.getListeners(t).end=e},setTrackDisposeListener:function(t,e){i.getListeners(t).dispose=e},setTrackCompleteListener:function(t,e){i.getListeners(t).complete=function(t){var i=Math.floor(t.trackTime/t.animationEnd);e(t,i)}},setTrackEventListener:function(t,e){i.getListeners(t).event=e},getState:function(){return this._state},_updateAnimEnum:!1,_updateSkinEnum:!1,_ensureListener:function(){this._listener||(this._listener=new i,this._state&&this._state.addListener(this._listener))},_updateSkeletonData:function(){if(this.skeletonData){var t=this.skeletonData.getRuntimeData();if(t){try{this.setSkeletonData(t),this.isAnimationCached()||this.setAnimationStateData(new r.AnimationStateData(this._skeleton.data)),this.defaultSkin&&this.setSkin(this.defaultSkin)}catch(e){cc.warn(e)}this.attachUtil.init(this),this.attachUtil._associateAttachedNode(),this._preCacheMode=this._cacheMode,this.animation=this.defaultAnimation}else this.disableRender()}else this.disableRender()},_refreshInspector:function(){this._updateAnimEnum(),this._updateSkinEnum(),Editor.Utils.refreshSelectedInspector("node",this.node.uuid)},_updateDebugDraw:function(){if(this.debugBones||this.debugSlots){if(!this._debugRenderer){var t=new cc.PrivateNode;t.name="DEBUG_DRAW_NODE";var e=t.addComponent(a);e.lineWidth=1,e.strokeColor=cc.color(255,0,0,255),this._debugRenderer=e}this._debugRenderer.node.parent=this.node,this.isAnimationCached()&&cc.warn("Debug bones or slots is invalid in cached mode")}else this._debugRenderer&&(this._debugRenderer.node.parent=null)}}),e.exports=sp.Skeleton}),{"../../cocos2d/core/components/CCRenderComponent":140,"../../cocos2d/core/graphics/graphics":182,"../../cocos2d/core/renderer/render-flow":226,"./AttachUtil":354,"./lib/spine":357,"./skeleton-cache":358,"./track-entry-listeners":362}],356:[(function(t){"use strict";var e="undefined"==typeof window?global:window;e.spine=t("./lib/spine"),e.sp={},sp._timeScale=1,Object.defineProperty(sp,"timeScale",{get:function(){return this._timeScale},set:function(t){this._timeScale=t},configurable:!0}),sp.ATTACHMENT_TYPE={REGION:0,BOUNDING_BOX:1,MESH:2,SKINNED_MESH:3},sp.AnimationEventType=cc.Enum({START:0,INTERRUPT:1,END:2,DISPOSE:3,COMPLETE:4,EVENT:5}),sp.spine=e.spine,t("./skeleton-texture"),t("./skeleton-data"),t("./vertex-effect-delegate"),t("./Skeleton"),t("./spine-assembler")}),{"./Skeleton":355,"./lib/spine":357,"./skeleton-data":359,"./skeleton-texture":360,"./spine-assembler":361,"./vertex-effect-delegate":363}],357:[(function(t,e){"use strict";var i,n,r,a=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});(function(t){var e,i,n,r=(function(){function t(t,e,i){if(null==t)throw new Error("name cannot be null.");if(null==e)throw new Error("timelines cannot be null.");this.name=t,this.timelines=e,this.timelineIds=[];for(var n=0;n<e.length;n++)this.timelineIds[e[n].getPropertyId()]=!0;this.duration=i}return t.prototype.hasTimeline=function(t){return 1==this.timelineIds[t]},t.prototype.apply=function(t,e,i,n,r,a,s,o){if(null==t)throw new Error("skeleton cannot be null.");n&&0!=this.duration&&(i%=this.duration,e>0&&(e%=this.duration));for(var c=this.timelines,l=0,u=c.length;l<u;l++)c[l].apply(t,e,i,r,a,s,o)},t.binarySearch=function(t,e,i){void 0===i&&(i=1);var n=0,r=t.length/i-2;if(0==r)return i;for(var a=r>>>1;;){if(t[(a+1)*i]<=e?n=a+1:r=a,n==r)return(n+1)*i;a=n+r>>>1}},t.linearSearch=function(t,e,i){for(var n=0,r=t.length-i;n<=r;n+=i)if(t[n]>e)return n;return-1},t})();t.Animation=r,(function(t){t[t.setup=0]="setup",t[t.first=1]="first",t[t.replace=2]="replace",t[t.add=3]="add"})(e=t.MixBlend||(t.MixBlend={})),(function(t){t[t.mixIn=0]="mixIn",t[t.mixOut=1]="mixOut"})(i=t.MixDirection||(t.MixDirection={})),(function(t){t[t.rotate=0]="rotate",t[t.translate=1]="translate",t[t.scale=2]="scale",t[t.shear=3]="shear",t[t.attachment=4]="attachment",t[t.color=5]="color",t[t.deform=6]="deform",t[t.event=7]="event",t[t.drawOrder=8]="drawOrder",t[t.ikConstraint=9]="ikConstraint",t[t.transformConstraint=10]="transformConstraint",t[t.pathConstraintPosition=11]="pathConstraintPosition",t[t.pathConstraintSpacing=12]="pathConstraintSpacing",t[t.pathConstraintMix=13]="pathConstraintMix",t[t.twoColor=14]="twoColor"})(n=t.TimelineType||(t.TimelineType={}));var s=(function(){function e(i){if(i<=0)throw new Error("frameCount must be > 0: "+i);this.curves=t.Utils.newFloatArray((i-1)*e.BEZIER_SIZE)}return e.prototype.getFrameCount=function(){return this.curves.length/e.BEZIER_SIZE+1},e.prototype.setLinear=function(t){this.curves[t*e.BEZIER_SIZE]=e.LINEAR},e.prototype.setStepped=function(t){this.curves[t*e.BEZIER_SIZE]=e.STEPPED},e.prototype.getCurveType=function(t){var i=t*e.BEZIER_SIZE;if(i==this.curves.length)return e.LINEAR;var n=this.curves[i];return n==e.LINEAR?e.LINEAR:n==e.STEPPED?e.STEPPED:e.BEZIER},e.prototype.setCurve=function(t,i,n,r,a){var s=.03*(2*-i+r),o=.03*(2*-n+a),c=.006*(3*(i-r)+1),l=.006*(3*(n-a)+1),u=2*s+c,h=2*o+l,f=.3*i+s+.16666667*c,d=.3*n+o+.16666667*l,_=t*e.BEZIER_SIZE,p=this.curves;p[_++]=e.BEZIER;for(var m=f,v=d,g=_+e.BEZIER_SIZE-1;_<g;_+=2)p[_]=m,p[_+1]=v,f+=u,d+=h,u+=c,h+=l,m+=f,v+=d},e.prototype.getCurvePercent=function(i,n){n=t.MathUtils.clamp(n,0,1);var r=this.curves,a=i*e.BEZIER_SIZE,s=r[a];if(s==e.LINEAR)return n;if(s==e.STEPPED)return 0;for(var o=0,c=++a,l=a+e.BEZIER_SIZE-1;a<l;a+=2)if((o=r[a])>=n){var u=void 0,h=void 0;return a==c?(u=0,h=0):(u=r[a-2],h=r[a-1]),h+(r[a+1]-h)*(n-u)/(o-u)}var f=r[a-1];return f+(1-f)*(n-o)/(1-o)},e.LINEAR=0,e.STEPPED=1,e.BEZIER=2,e.BEZIER_SIZE=19,e})();t.CurveTimeline=s;var o=(function(i){function s(e){var n=i.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e<<1),n}return a(s,i),s.prototype.getPropertyId=function(){return(n.rotate<<24)+this.boneIndex},s.prototype.setFrame=function(t,e,i){t<<=1,this.frames[t]=e,this.frames[t+s.ROTATION]=i},s.prototype.apply=function(t,i,n,a,o,c){var l=this.frames,u=t.bones[this.boneIndex];if(u.active)if(n<l[0])switch(c){case e.setup:return void(u.rotation=u.data.rotation);case e.first:var h=u.data.rotation-u.rotation;u.rotation+=(h-360*(16384-(16384.499999999996-h/360|0)))*o}else if(n>=l[l.length-s.ENTRIES]){var f=l[l.length+s.PREV_ROTATION];switch(c){case e.setup:u.rotation=u.data.rotation+f*o;break;case e.first:case e.replace:f+=u.data.rotation-u.rotation,f-=360*(16384-(16384.499999999996-f/360|0));case e.add:u.rotation+=f*o}}else{var d=r.binarySearch(l,n,s.ENTRIES),_=l[d+s.PREV_ROTATION],p=l[d],m=this.getCurvePercent((d>>1)-1,1-(n-p)/(l[d+s.PREV_TIME]-p)),v=l[d+s.ROTATION]-_;switch(v=_+(v-360*(16384-(16384.499999999996-v/360|0)))*m,c){case e.setup:u.rotation=u.data.rotation+(v-360*(16384-(16384.499999999996-v/360|0)))*o;break;case e.first:case e.replace:v+=u.data.rotation-u.rotation;case e.add:u.rotation+=(v-360*(16384-(16384.499999999996-v/360|0)))*o}}},s.ENTRIES=2,s.PREV_TIME=-2,s.PREV_ROTATION=-1,s.ROTATION=1,s})(s);t.RotateTimeline=o;var c=(function(i){function s(e){var n=i.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*s.ENTRIES),n}return a(s,i),s.prototype.getPropertyId=function(){return(n.translate<<24)+this.boneIndex},s.prototype.setFrame=function(t,e,i,n){t*=s.ENTRIES,this.frames[t]=e,this.frames[t+s.X]=i,this.frames[t+s.Y]=n},s.prototype.apply=function(t,i,n,a,o,c){var l=this.frames,u=t.bones[this.boneIndex];if(u.active)if(n<l[0])switch(c){case e.setup:return u.x=u.data.x,void(u.y=u.data.y);case e.first:u.x+=(u.data.x-u.x)*o,u.y+=(u.data.y-u.y)*o}else{var h=0,f=0;if(n>=l[l.length-s.ENTRIES])h=l[l.length+s.PREV_X],f=l[l.length+s.PREV_Y];else{var d=r.binarySearch(l,n,s.ENTRIES);h=l[d+s.PREV_X],f=l[d+s.PREV_Y];var _=l[d],p=this.getCurvePercent(d/s.ENTRIES-1,1-(n-_)/(l[d+s.PREV_TIME]-_));h+=(l[d+s.X]-h)*p,f+=(l[d+s.Y]-f)*p}switch(c){case e.setup:u.x=u.data.x+h*o,u.y=u.data.y+f*o;break;case e.first:case e.replace:u.x+=(u.data.x+h-u.x)*o,u.y+=(u.data.y+f-u.y)*o;break;case e.add:u.x+=h*o,u.y+=f*o}}},s.ENTRIES=3,s.PREV_TIME=-3,s.PREV_X=-2,s.PREV_Y=-1,s.X=1,s.Y=2,s})(s);t.TranslateTimeline=c;var l=(function(s){function o(t){return s.call(this,t)||this}return a(o,s),o.prototype.getPropertyId=function(){return(n.scale<<24)+this.boneIndex},o.prototype.apply=function(n,a,s,c,l,u,h){var f=this.frames,d=n.bones[this.boneIndex];if(d.active)if(s<f[0])switch(u){case e.setup:return d.scaleX=d.data.scaleX,void(d.scaleY=d.data.scaleY);case e.first:d.scaleX+=(d.data.scaleX-d.scaleX)*l,d.scaleY+=(d.data.scaleY-d.scaleY)*l}else{var _=0,p=0;if(s>=f[f.length-o.ENTRIES])_=f[f.length+o.PREV_X]*d.data.scaleX,p=f[f.length+o.PREV_Y]*d.data.scaleY;else{var m=r.binarySearch(f,s,o.ENTRIES);_=f[m+o.PREV_X],p=f[m+o.PREV_Y];var v=f[m],g=this.getCurvePercent(m/o.ENTRIES-1,1-(s-v)/(f[m+o.PREV_TIME]-v));_=(_+(f[m+o.X]-_)*g)*d.data.scaleX,p=(p+(f[m+o.Y]-p)*g)*d.data.scaleY}if(1==l)u==e.add?(d.scaleX+=_-d.data.scaleX,d.scaleY+=p-d.data.scaleY):(d.scaleX=_,d.scaleY=p);else{var y=0,T=0;if(h==i.mixOut)switch(u){case e.setup:y=d.data.scaleX,T=d.data.scaleY,d.scaleX=y+(Math.abs(_)*t.MathUtils.signum(y)-y)*l,d.scaleY=T+(Math.abs(p)*t.MathUtils.signum(T)-T)*l;break;case e.first:case e.replace:y=d.scaleX,T=d.scaleY,d.scaleX=y+(Math.abs(_)*t.MathUtils.signum(y)-y)*l,d.scaleY=T+(Math.abs(p)*t.MathUtils.signum(T)-T)*l;break;case e.add:y=d.scaleX,T=d.scaleY,d.scaleX=y+(Math.abs(_)*t.MathUtils.signum(y)-d.data.scaleX)*l,d.scaleY=T+(Math.abs(p)*t.MathUtils.signum(T)-d.data.scaleY)*l}else switch(u){case e.setup:y=Math.abs(d.data.scaleX)*t.MathUtils.signum(_),T=Math.abs(d.data.scaleY)*t.MathUtils.signum(p),d.scaleX=y+(_-y)*l,d.scaleY=T+(p-T)*l;break;case e.first:case e.replace:y=Math.abs(d.scaleX)*t.MathUtils.signum(_),T=Math.abs(d.scaleY)*t.MathUtils.signum(p),d.scaleX=y+(_-y)*l,d.scaleY=T+(p-T)*l;break;case e.add:y=t.MathUtils.signum(_),T=t.MathUtils.signum(p),d.scaleX=Math.abs(d.scaleX)*y+(_-Math.abs(d.data.scaleX)*y)*l,d.scaleY=Math.abs(d.scaleY)*T+(p-Math.abs(d.data.scaleY)*T)*l}}}},o})(c);t.ScaleTimeline=l;var u=(function(t){function i(e){return t.call(this,e)||this}return a(i,t),i.prototype.getPropertyId=function(){return(n.shear<<24)+this.boneIndex},i.prototype.apply=function(t,n,a,s,o,c){var l=this.frames,u=t.bones[this.boneIndex];if(u.active)if(a<l[0])switch(c){case e.setup:return u.shearX=u.data.shearX,void(u.shearY=u.data.shearY);case e.first:u.shearX+=(u.data.shearX-u.shearX)*o,u.shearY+=(u.data.shearY-u.shearY)*o}else{var h=0,f=0;if(a>=l[l.length-i.ENTRIES])h=l[l.length+i.PREV_X],f=l[l.length+i.PREV_Y];else{var d=r.binarySearch(l,a,i.ENTRIES);h=l[d+i.PREV_X],f=l[d+i.PREV_Y];var _=l[d],p=this.getCurvePercent(d/i.ENTRIES-1,1-(a-_)/(l[d+i.PREV_TIME]-_));h+=(l[d+i.X]-h)*p,f+=(l[d+i.Y]-f)*p}switch(c){case e.setup:u.shearX=u.data.shearX+h*o,u.shearY=u.data.shearY+f*o;break;case e.first:case e.replace:u.shearX+=(u.data.shearX+h-u.shearX)*o,u.shearY+=(u.data.shearY+f-u.shearY)*o;break;case e.add:u.shearX+=h*o,u.shearY+=f*o}}},i})(c);t.ShearTimeline=u;var h=(function(i){function s(e){var n=i.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*s.ENTRIES),n}return a(s,i),s.prototype.getPropertyId=function(){return(n.color<<24)+this.slotIndex},s.prototype.setFrame=function(t,e,i,n,r,a){t*=s.ENTRIES,this.frames[t]=e,this.frames[t+s.R]=i,this.frames[t+s.G]=n,this.frames[t+s.B]=r,this.frames[t+s.A]=a},s.prototype.apply=function(t,i,n,a,o,c){var l=t.slots[this.slotIndex];if(l.bone.active){var u=this.frames;if(n<u[0])switch(c){case e.setup:return void l.color.setFromColor(l.data.color);case e.first:var h=l.color,f=l.data.color;h.add((f.r-h.r)*o,(f.g-h.g)*o,(f.b-h.b)*o,(f.a-h.a)*o)}else{var d=0,_=0,p=0,m=0;if(n>=u[u.length-s.ENTRIES]){var v=u.length;d=u[v+s.PREV_R],_=u[v+s.PREV_G],p=u[v+s.PREV_B],m=u[v+s.PREV_A]}else{var g=r.binarySearch(u,n,s.ENTRIES);d=u[g+s.PREV_R],_=u[g+s.PREV_G],p=u[g+s.PREV_B],m=u[g+s.PREV_A];var y=u[g],T=this.getCurvePercent(g/s.ENTRIES-1,1-(n-y)/(u[g+s.PREV_TIME]-y));d+=(u[g+s.R]-d)*T,_+=(u[g+s.G]-_)*T,p+=(u[g+s.B]-p)*T,m+=(u[g+s.A]-m)*T}1==o?l.color.set(d,_,p,m):(h=l.color,c==e.setup&&h.setFromColor(l.data.color),h.add((d-h.r)*o,(_-h.g)*o,(p-h.b)*o,(m-h.a)*o))}}},s.ENTRIES=5,s.PREV_TIME=-5,s.PREV_R=-4,s.PREV_G=-3,s.PREV_B=-2,s.PREV_A=-1,s.R=1,s.G=2,s.B=3,s.A=4,s})(s);t.ColorTimeline=h;var f=(function(i){function s(e){var n=i.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*s.ENTRIES),n}return a(s,i),s.prototype.getPropertyId=function(){return(n.twoColor<<24)+this.slotIndex},s.prototype.setFrame=function(t,e,i,n,r,a,o,c,l){t*=s.ENTRIES,this.frames[t]=e,this.frames[t+s.R]=i,this.frames[t+s.G]=n,this.frames[t+s.B]=r,this.frames[t+s.A]=a,this.frames[t+s.R2]=o,this.frames[t+s.G2]=c,this.frames[t+s.B2]=l},s.prototype.apply=function(t,i,n,a,o,c){var l=t.slots[this.slotIndex];if(l.bone.active){var u=this.frames;if(n<u[0])switch(c){case e.setup:return l.color.setFromColor(l.data.color),void l.darkColor.setFromColor(l.data.darkColor);case e.first:var h=l.color,f=l.darkColor,d=l.data.color,_=l.data.darkColor;h.add((d.r-h.r)*o,(d.g-h.g)*o,(d.b-h.b)*o,(d.a-h.a)*o),f.add((_.r-f.r)*o,(_.g-f.g)*o,(_.b-f.b)*o,0)}else{var p=0,m=0,v=0,g=0,y=0,T=0,b=0;if(n>=u[u.length-s.ENTRIES]){var E=u.length;p=u[E+s.PREV_R],m=u[E+s.PREV_G],v=u[E+s.PREV_B],g=u[E+s.PREV_A],y=u[E+s.PREV_R2],T=u[E+s.PREV_G2],b=u[E+s.PREV_B2]}else{var A=r.binarySearch(u,n,s.ENTRIES);p=u[A+s.PREV_R],m=u[A+s.PREV_G],v=u[A+s.PREV_B],g=u[A+s.PREV_A],y=u[A+s.PREV_R2],T=u[A+s.PREV_G2],b=u[A+s.PREV_B2];var C=u[A],x=this.getCurvePercent(A/s.ENTRIES-1,1-(n-C)/(u[A+s.PREV_TIME]-C));p+=(u[A+s.R]-p)*x,m+=(u[A+s.G]-m)*x,v+=(u[A+s.B]-v)*x,g+=(u[A+s.A]-g)*x,y+=(u[A+s.R2]-y)*x,T+=(u[A+s.G2]-T)*x,b+=(u[A+s.B2]-b)*x}1==o?(l.color.set(p,m,v,g),l.darkColor.set(y,T,b,1)):(h=l.color,f=l.darkColor,c==e.setup&&(h.setFromColor(l.data.color),f.setFromColor(l.data.darkColor)),h.add((p-h.r)*o,(m-h.g)*o,(v-h.b)*o,(g-h.a)*o),f.add((y-f.r)*o,(T-f.g)*o,(b-f.b)*o,0))}}},s.ENTRIES=8,s.PREV_TIME=-8,s.PREV_R=-7,s.PREV_G=-6,s.PREV_B=-5,s.PREV_A=-4,s.PREV_R2=-3,s.PREV_G2=-2,s.PREV_B2=-1,s.R=1,s.G=2,s.B=3,s.A=4,s.R2=5,s.G2=6,s.B2=7,s})(s);t.TwoColorTimeline=f;var d=(function(){function a(e){this.frames=t.Utils.newFloatArray(e),this.attachmentNames=new Array(e)}return a.prototype.getPropertyId=function(){return(n.attachment<<24)+this.slotIndex},a.prototype.getFrameCount=function(){return this.frames.length},a.prototype.setFrame=function(t,e,i){this.frames[t]=e,this.attachmentNames[t]=i},a.prototype.apply=function(t,n,a,s,o,c,l){var u=t.slots[this.slotIndex];if(u.bone.active)if(l!=i.mixOut||c!=e.setup){var h=this.frames;if(a<h[0]){if(c==e.setup||c==e.first){var f=u.data.attachmentName;u.setAttachment(null==f?null:t.getAttachment(this.slotIndex,f))}}else{var d;d=a>=h[h.length-1]?h.length-1:r.binarySearch(h,a,1)-1;var _=this.attachmentNames[d];t.slots[this.slotIndex].setAttachment(null==_?null:t.getAttachment(this.slotIndex,_))}}else{var p=u.data.attachmentName;u.setAttachment(null==p?null:t.getAttachment(this.slotIndex,p))}},a})();t.AttachmentTimeline=d;var _=null,p=(function(i){function s(e){var n=i.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e),n.frameVertices=new Array(e),null==_&&(_=t.Utils.newFloatArray(64)),n}return a(s,i),s.prototype.getPropertyId=function(){return(n.deform<<27)+ +this.attachment.id+this.slotIndex},s.prototype.setFrame=function(t,e,i){this.frames[t]=e,this.frameVertices[t]=i},s.prototype.apply=function(i,n,a,s,o,c){var l=i.slots[this.slotIndex];if(l.bone.active){var u=l.getAttachment();if(u instanceof t.VertexAttachment&&u.deformAttachment==this.attachment){var h=l.deform;0==h.length&&(c=e.setup);var f=this.frameVertices,d=f[0].length,_=this.frames;if(a<_[0]){var p=u;switch(c){case e.setup:return void(h.length=0);case e.first:if(1==o){h.length=0;break}var m=t.Utils.setArraySize(h,d);if(null==p.bones)for(var v=p.vertices,g=0;g<d;g++)m[g]+=(v[g]-m[g])*o;else for(o=1-o,g=0;g<d;g++)m[g]*=o}}else{var y=t.Utils.setArraySize(h,d);if(a>=_[_.length-1]){var T=f[_.length-1];if(1==o)if(c==e.add)if(null==(p=u).bones){v=p.vertices;for(var b=0;b<d;b++)y[b]+=T[b]-v[b]}else for(var E=0;E<d;E++)y[E]+=T[E];else t.Utils.arrayCopy(T,0,y,0,d);else switch(c){case e.setup:var A=u;if(null==A.bones){v=A.vertices;for(var C=0;C<d;C++){var x=v[C];y[C]=x+(T[C]-x)*o}}else for(var S=0;S<d;S++)y[S]=T[S]*o;break;case e.first:case e.replace:for(var w=0;w<d;w++)y[w]+=(T[w]-y[w])*o;case e.add:if(null==(p=u).bones){v=p.vertices;for(var M=0;M<d;M++)y[M]+=(T[M]-v[M])*o}else for(var R=0;R<d;R++)y[R]+=T[R]*o}}else{var I=r.binarySearch(_,a),O=f[I-1],D=f[I],P=_[I],L=this.getCurvePercent(I-1,1-(a-P)/(_[I-1]-P));if(1==o)if(c==e.add)if(null==(p=u).bones){v=p.vertices;for(var N=0;N<d;N++){var F=O[N];y[N]+=F+(D[N]-F)*L-v[N]}}else for(var B=0;B<d;B++)F=O[B],y[B]+=F+(D[B]-F)*L;else for(var k=0;k<d;k++)F=O[k],y[k]=F+(D[k]-F)*L;else switch(c){case e.setup:var V=u;if(null==V.bones){v=V.vertices;for(var z=0;z<d;z++)F=O[z],x=v[z],y[z]=x+(F+(D[z]-F)*L-x)*o}else for(var U=0;U<d;U++)F=O[U],y[U]=(F+(D[U]-F)*L)*o;break;case e.first:case e.replace:for(var H=0;H<d;H++)F=O[H],y[H]+=(F+(D[H]-F)*L-y[H])*o;break;case e.add:if(null==(p=u).bones){v=p.vertices;for(var W=0;W<d;W++)F=O[W],y[W]+=(F+(D[W]-F)*L-v[W])*o}else for(var G=0;G<d;G++)F=O[G],y[G]+=(F+(D[G]-F)*L)*o}}}}}},s})(s);t.DeformTimeline=p;var m=(function(){function e(e){this.frames=t.Utils.newFloatArray(e),this.events=new Array(e)}return e.prototype.getPropertyId=function(){return n.event<<24},e.prototype.getFrameCount=function(){return this.frames.length},e.prototype.setFrame=function(t,e){this.frames[t]=e.time,this.events[t]=e},e.prototype.apply=function(t,e,i,n,a,s,o){if(null!=n){var c=this.frames,l=this.frames.length;if(e>i)this.apply(t,e,Number.MAX_VALUE,n,a,s,o),e=-1;else if(e>=c[l-1])return;if(!(i<c[0])){var u=0;if(e<c[0])u=0;else for(var h=c[u=r.binarySearch(c,e)];u>0&&c[u-1]==h;)u--;for(;u<l&&i>=c[u];u++)n.push(this.events[u])}}},e})();t.EventTimeline=m;var v=(function(){function a(e){this.frames=t.Utils.newFloatArray(e),this.drawOrders=new Array(e)}return a.prototype.getPropertyId=function(){return n.drawOrder<<24},a.prototype.getFrameCount=function(){return this.frames.length},a.prototype.setFrame=function(t,e,i){this.frames[t]=e,this.drawOrders[t]=i},a.prototype.apply=function(n,a,s,o,c,l,u){var h=n.drawOrder,f=n.slots;if(u!=i.mixOut||l!=e.setup){var d=this.frames;if(s<d[0])l!=e.setup&&l!=e.first||t.Utils.arrayCopy(n.slots,0,n.drawOrder,0,n.slots.length);else{var _;_=s>=d[d.length-1]?d.length-1:r.binarySearch(d,s)-1;var p=this.drawOrders[_];if(null==p)t.Utils.arrayCopy(f,0,h,0,f.length);else for(var m=0,v=p.length;m<v;m++)h[m]=f[p[m]]}}else t.Utils.arrayCopy(n.slots,0,n.drawOrder,0,n.slots.length)},a})();t.DrawOrderTimeline=v;var g=(function(s){function o(e){var i=s.call(this,e)||this;return i.frames=t.Utils.newFloatArray(e*o.ENTRIES),i}return a(o,s),o.prototype.getPropertyId=function(){return(n.ikConstraint<<24)+this.ikConstraintIndex},o.prototype.setFrame=function(t,e,i,n,r,a,s){t*=o.ENTRIES,this.frames[t]=e,this.frames[t+o.MIX]=i,this.frames[t+o.SOFTNESS]=n,this.frames[t+o.BEND_DIRECTION]=r,this.frames[t+o.COMPRESS]=a?1:0,this.frames[t+o.STRETCH]=s?1:0},o.prototype.apply=function(t,n,a,s,c,l,u){var h=this.frames,f=t.ikConstraints[this.ikConstraintIndex];if(f.active)if(a<h[0])switch(l){case e.setup:return f.mix=f.data.mix,f.softness=f.data.softness,f.bendDirection=f.data.bendDirection,f.compress=f.data.compress,void(f.stretch=f.data.stretch);case e.first:f.mix+=(f.data.mix-f.mix)*c,f.softness+=(f.data.softness-f.softness)*c,f.bendDirection=f.data.bendDirection,f.compress=f.data.compress,f.stretch=f.data.stretch}else if(a>=h[h.length-o.ENTRIES])l==e.setup?(f.mix=f.data.mix+(h[h.length+o.PREV_MIX]-f.data.mix)*c,f.softness=f.data.softness+(h[h.length+o.PREV_SOFTNESS]-f.data.softness)*c,u==i.mixOut?(f.bendDirection=f.data.bendDirection,f.compress=f.data.compress,f.stretch=f.data.stretch):(f.bendDirection=h[h.length+o.PREV_BEND_DIRECTION],f.compress=0!=h[h.length+o.PREV_COMPRESS],f.stretch=0!=h[h.length+o.PREV_STRETCH])):(f.mix+=(h[h.length+o.PREV_MIX]-f.mix)*c,f.softness+=(h[h.length+o.PREV_SOFTNESS]-f.softness)*c,u==i.mixIn&&(f.bendDirection=h[h.length+o.PREV_BEND_DIRECTION],f.compress=0!=h[h.length+o.PREV_COMPRESS],f.stretch=0!=h[h.length+o.PREV_STRETCH]));else{var d=r.binarySearch(h,a,o.ENTRIES),_=h[d+o.PREV_MIX],p=h[d+o.PREV_SOFTNESS],m=h[d],v=this.getCurvePercent(d/o.ENTRIES-1,1-(a-m)/(h[d+o.PREV_TIME]-m));l==e.setup?(f.mix=f.data.mix+(_+(h[d+o.MIX]-_)*v-f.data.mix)*c,f.softness=f.data.softness+(p+(h[d+o.SOFTNESS]-p)*v-f.data.softness)*c,u==i.mixOut?(f.bendDirection=f.data.bendDirection,f.compress=f.data.compress,f.stretch=f.data.stretch):(f.bendDirection=h[d+o.PREV_BEND_DIRECTION],f.compress=0!=h[d+o.PREV_COMPRESS],f.stretch=0!=h[d+o.PREV_STRETCH])):(f.mix+=(_+(h[d+o.MIX]-_)*v-f.mix)*c,f.softness+=(p+(h[d+o.SOFTNESS]-p)*v-f.softness)*c,u==i.mixIn&&(f.bendDirection=h[d+o.PREV_BEND_DIRECTION],f.compress=0!=h[d+o.PREV_COMPRESS],f.stretch=0!=h[d+o.PREV_STRETCH]))}},o.ENTRIES=6,o.PREV_TIME=-6,o.PREV_MIX=-5,o.PREV_SOFTNESS=-4,o.PREV_BEND_DIRECTION=-3,o.PREV_COMPRESS=-2,o.PREV_STRETCH=-1,o.MIX=1,o.SOFTNESS=2,o.BEND_DIRECTION=3,o.COMPRESS=4,o.STRETCH=5,o})(s);t.IkConstraintTimeline=g;var y=(function(i){function s(e){var n=i.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*s.ENTRIES),n}return a(s,i),s.prototype.getPropertyId=function(){return(n.transformConstraint<<24)+this.transformConstraintIndex},s.prototype.setFrame=function(t,e,i,n,r,a){t*=s.ENTRIES,this.frames[t]=e,this.frames[t+s.ROTATE]=i,this.frames[t+s.TRANSLATE]=n,this.frames[t+s.SCALE]=r,this.frames[t+s.SHEAR]=a},s.prototype.apply=function(t,i,n,a,o,c){var l=this.frames,u=t.transformConstraints[this.transformConstraintIndex];if(u.active)if(n<l[0]){var h=u.data;switch(c){case e.setup:return u.rotateMix=h.rotateMix,u.translateMix=h.translateMix,u.scaleMix=h.scaleMix,void(u.shearMix=h.shearMix);case e.first:u.rotateMix+=(h.rotateMix-u.rotateMix)*o,u.translateMix+=(h.translateMix-u.translateMix)*o,u.scaleMix+=(h.scaleMix-u.scaleMix)*o,u.shearMix+=(h.shearMix-u.shearMix)*o}}else{var f=0,d=0,_=0,p=0;if(n>=l[l.length-s.ENTRIES]){var m=l.length;f=l[m+s.PREV_ROTATE],d=l[m+s.PREV_TRANSLATE],_=l[m+s.PREV_SCALE],p=l[m+s.PREV_SHEAR]}else{var v=r.binarySearch(l,n,s.ENTRIES);f=l[v+s.PREV_ROTATE],d=l[v+s.PREV_TRANSLATE],_=l[v+s.PREV_SCALE],p=l[v+s.PREV_SHEAR];var g=l[v],y=this.getCurvePercent(v/s.ENTRIES-1,1-(n-g)/(l[v+s.PREV_TIME]-g));f+=(l[v+s.ROTATE]-f)*y,d+=(l[v+s.TRANSLATE]-d)*y,_+=(l[v+s.SCALE]-_)*y,p+=(l[v+s.SHEAR]-p)*y}c==e.setup?(h=u.data,u.rotateMix=h.rotateMix+(f-h.rotateMix)*o,u.translateMix=h.translateMix+(d-h.translateMix)*o,u.scaleMix=h.scaleMix+(_-h.scaleMix)*o,u.shearMix=h.shearMix+(p-h.shearMix)*o):(u.rotateMix+=(f-u.rotateMix)*o,u.translateMix+=(d-u.translateMix)*o,u.scaleMix+=(_-u.scaleMix)*o,u.shearMix+=(p-u.shearMix)*o)}},s.ENTRIES=5,s.PREV_TIME=-5,s.PREV_ROTATE=-4,s.PREV_TRANSLATE=-3,s.PREV_SCALE=-2,s.PREV_SHEAR=-1,s.ROTATE=1,s.TRANSLATE=2,s.SCALE=3,s.SHEAR=4,s})(s);t.TransformConstraintTimeline=y;var T=(function(i){function s(e){var n=i.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*s.ENTRIES),n}return a(s,i),s.prototype.getPropertyId=function(){return(n.pathConstraintPosition<<24)+this.pathConstraintIndex},s.prototype.setFrame=function(t,e,i){t*=s.ENTRIES,this.frames[t]=e,this.frames[t+s.VALUE]=i},s.prototype.apply=function(t,i,n,a,o,c){var l=this.frames,u=t.pathConstraints[this.pathConstraintIndex];if(u.active)if(n<l[0])switch(c){case e.setup:return void(u.position=u.data.position);case e.first:u.position+=(u.data.position-u.position)*o}else{var h=0;if(n>=l[l.length-s.ENTRIES])h=l[l.length+s.PREV_VALUE];else{var f=r.binarySearch(l,n,s.ENTRIES);h=l[f+s.PREV_VALUE];var d=l[f],_=this.getCurvePercent(f/s.ENTRIES-1,1-(n-d)/(l[f+s.PREV_TIME]-d));h+=(l[f+s.VALUE]-h)*_}c==e.setup?u.position=u.data.position+(h-u.data.position)*o:u.position+=(h-u.position)*o}},s.ENTRIES=2,s.PREV_TIME=-2,s.PREV_VALUE=-1,s.VALUE=1,s})(s);t.PathConstraintPositionTimeline=T;var b=(function(t){function i(e){return t.call(this,e)||this}return a(i,t),i.prototype.getPropertyId=function(){return(n.pathConstraintSpacing<<24)+this.pathConstraintIndex},i.prototype.apply=function(t,n,a,s,o,c){var l=this.frames,u=t.pathConstraints[this.pathConstraintIndex];if(u.active)if(a<l[0])switch(c){case e.setup:return void(u.spacing=u.data.spacing);case e.first:u.spacing+=(u.data.spacing-u.spacing)*o}else{var h=0;if(a>=l[l.length-i.ENTRIES])h=l[l.length+i.PREV_VALUE];else{var f=r.binarySearch(l,a,i.ENTRIES);h=l[f+i.PREV_VALUE];var d=l[f],_=this.getCurvePercent(f/i.ENTRIES-1,1-(a-d)/(l[f+i.PREV_TIME]-d));h+=(l[f+i.VALUE]-h)*_}c==e.setup?u.spacing=u.data.spacing+(h-u.data.spacing)*o:u.spacing+=(h-u.spacing)*o}},i})(T);t.PathConstraintSpacingTimeline=b;var E=(function(i){function s(e){var n=i.call(this,e)||this;return n.frames=t.Utils.newFloatArray(e*s.ENTRIES),n}return a(s,i),s.prototype.getPropertyId=function(){return(n.pathConstraintMix<<24)+this.pathConstraintIndex},s.prototype.setFrame=function(t,e,i,n){t*=s.ENTRIES,this.frames[t]=e,this.frames[t+s.ROTATE]=i,this.frames[t+s.TRANSLATE]=n},s.prototype.apply=function(t,i,n,a,o,c){var l=this.frames,u=t.pathConstraints[this.pathConstraintIndex];if(u.active)if(n<l[0])switch(c){case e.setup:return u.rotateMix=u.data.rotateMix,void(u.translateMix=u.data.translateMix);case e.first:u.rotateMix+=(u.data.rotateMix-u.rotateMix)*o,u.translateMix+=(u.data.translateMix-u.translateMix)*o}else{var h=0,f=0;if(n>=l[l.length-s.ENTRIES])h=l[l.length+s.PREV_ROTATE],f=l[l.length+s.PREV_TRANSLATE];else{var d=r.binarySearch(l,n,s.ENTRIES);h=l[d+s.PREV_ROTATE],f=l[d+s.PREV_TRANSLATE];var _=l[d],p=this.getCurvePercent(d/s.ENTRIES-1,1-(n-_)/(l[d+s.PREV_TIME]-_));h+=(l[d+s.ROTATE]-h)*p,f+=(l[d+s.TRANSLATE]-f)*p}c==e.setup?(u.rotateMix=u.data.rotateMix+(h-u.data.rotateMix)*o,u.translateMix=u.data.translateMix+(f-u.data.translateMix)*o):(u.rotateMix+=(h-u.rotateMix)*o,u.translateMix+=(f-u.translateMix)*o)}},s.ENTRIES=3,s.PREV_TIME=-3,s.PREV_ROTATE=-2,s.PREV_TRANSLATE=-1,s.ROTATE=1,s.TRANSLATE=2,s})(s);t.PathConstraintMixTimeline=E})(r||(r={})),(function(t){var e=(function(){function e(e){this.tracks=new Array,this.timeScale=1,this.events=new Array,this.listeners=new Array,this.queue=new r(this),this.propertyIDs=new t.IntSet,this.animationsChanged=!1,this.trackEntryPool=new t.Pool(function(){return new i}),this.data=e}return e.prototype.update=function(t){t*=this.timeScale;for(var e=this.tracks,i=0,n=e.length;i<n;i++){var r=e[i];if(null!=r){r.animationLast=r.nextAnimationLast,r.trackLast=r.nextTrackLast;var a=t*r.timeScale;if(r.delay>0){if(r.delay-=a,r.delay>0)continue;a=-r.delay,r.delay=0}var s=r.next;if(null!=s){var o=r.trackLast-s.delay;if(o>=0){for(s.delay=0,s.trackTime+=0==r.timeScale?0:(o/r.timeScale+t)*s.timeScale,r.trackTime+=a,this.setCurrent(i,s,!0);null!=s.mixingFrom;)s.mixTime+=t,s=s.mixingFrom;continue}}else if(r.trackLast>=r.trackEnd&&null==r.mixingFrom){e[i]=null,this.queue.end(r),this.disposeNext(r);continue}if(null!=r.mixingFrom&&this.updateMixingFrom(r,t)){var c=r.mixingFrom;for(r.mixingFrom=null,null!=c&&(c.mixingTo=null);null!=c;)this.queue.end(c),c=c.mixingFrom}r.trackTime+=a}}this.queue.drain()},e.prototype.updateMixingFrom=function(t,e){var i=t.mixingFrom;if(null==i)return!0;var n=this.updateMixingFrom(i,e);return i.animationLast=i.nextAnimationLast,i.trackLast=i.nextTrackLast,t.mixTime>0&&t.mixTime>=t.mixDuration?(0!=i.totalAlpha&&0!=t.mixDuration||(t.mixingFrom=i.mixingFrom,null!=i.mixingFrom&&(i.mixingFrom.mixingTo=t),t.interruptAlpha=i.interruptAlpha,this.queue.end(i)),n):(i.trackTime+=e*i.timeScale,t.mixTime+=e,!1)},e.prototype.apply=function(i){if(null==i)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();for(var n=this.events,r=this.tracks,a=!1,s=0,o=r.length;s<o;s++){var c=r[s];if(!(null==c||c.delay>0)){a=!0;var l=0==s?t.MixBlend.first:c.mixBlend,u=c.alpha;null!=c.mixingFrom?u*=this.applyMixingFrom(c,i,l):c.trackTime>=c.trackEnd&&null==c.next&&(u=0);var h=c.animationLast,f=c.getAnimationTime(),d=c.animation.timelines.length,_=c.animation.timelines;if(0==s&&1==u||l==t.MixBlend.add)for(var p=0;p<d;p++)t.Utils.webkit602BugfixHelper(u,l),_[p].apply(i,h,f,n,u,l,t.MixDirection.mixIn);else{var m=c.timelineMode,v=0==c.timelinesRotation.length;v&&t.Utils.setArraySize(c.timelinesRotation,d<<1,null);var g=c.timelinesRotation;for(p=0;p<d;p++){var y=_[p],T=(m[p]&e.NOT_LAST-1)==e.SUBSEQUENT?l:t.MixBlend.setup;y instanceof t.RotateTimeline?this.applyRotateTimeline(y,i,f,u,T,g,p<<1,v):(t.Utils.webkit602BugfixHelper(u,l),y.apply(i,h,f,n,u,T,t.MixDirection.mixIn))}}this.queueEvents(c,f),n.length=0,c.nextAnimationLast=f,c.nextTrackLast=c.trackTime}}return this.queue.drain(),a},e.prototype.applyMixingFrom=function(i,n,r){var a=i.mixingFrom;null!=a.mixingFrom&&this.applyMixingFrom(a,n,r);var s=0;0==i.mixDuration?(s=1,r==t.MixBlend.first&&(r=t.MixBlend.setup)):((s=i.mixTime/i.mixDuration)>1&&(s=1),r!=t.MixBlend.first&&(r=a.mixBlend));var o=s<a.eventThreshold?this.events:null,c=s<a.attachmentThreshold,l=s<a.drawOrderThreshold,u=a.animationLast,h=a.getAnimationTime(),f=a.animation.timelines.length,d=a.animation.timelines,_=a.alpha*i.interruptAlpha,p=_*(1-s);if(r==t.MixBlend.add)for(var m=0;m<f;m++)d[m].apply(n,u,h,o,p,r,t.MixDirection.mixOut);else{var v=a.timelineMode,g=a.timelineHoldMix,y=0==a.timelinesRotation.length;y&&t.Utils.setArraySize(a.timelinesRotation,f<<1,null);var T=a.timelinesRotation;for(a.totalAlpha=0,m=0;m<f;m++){var b=d[m],E=t.MixDirection.mixOut,A=void 0,C=0;switch(v[m]&e.NOT_LAST-1){case e.SUBSEQUENT:if(A=r,!c&&b instanceof t.AttachmentTimeline){if((v[m]&e.NOT_LAST)==e.NOT_LAST)continue;A=t.MixBlend.setup}if(!l&&b instanceof t.DrawOrderTimeline)continue;C=p;break;case e.FIRST:A=t.MixBlend.setup,C=p;break;case e.HOLD:A=t.MixBlend.setup,C=_;break;default:A=t.MixBlend.setup;var x=g[m];C=_*Math.max(0,1-x.mixTime/x.mixDuration)}a.totalAlpha+=C,b instanceof t.RotateTimeline?this.applyRotateTimeline(b,n,h,C,A,T,m<<1,y):(t.Utils.webkit602BugfixHelper(C,r),A==t.MixBlend.setup&&(b instanceof t.AttachmentTimeline?(c||(v[m]&e.NOT_LAST)==e.NOT_LAST)&&(E=t.MixDirection.mixIn):b instanceof t.DrawOrderTimeline&&l&&(E=t.MixDirection.mixIn)),b.apply(n,u,h,o,C,A,E))}}return i.mixDuration>0&&this.queueEvents(a,h),this.events.length=0,a.nextAnimationLast=h,a.nextTrackLast=a.trackTime,s},e.prototype.applyRotateTimeline=function(e,i,n,r,a,s,o,c){if(c&&(s[o]=0),1!=r){var l=e,u=l.frames,h=i.bones[l.boneIndex];if(h.active){var f=0,d=0;if(n<u[0])switch(a){case t.MixBlend.setup:h.rotation=h.data.rotation;default:return;case t.MixBlend.first:f=h.rotation,d=h.data.rotation}else if(f=a==t.MixBlend.setup?h.data.rotation:h.rotation,n>=u[u.length-t.RotateTimeline.ENTRIES])d=h.data.rotation+u[u.length+t.RotateTimeline.PREV_ROTATION];else{var _=t.Animation.binarySearch(u,n,t.RotateTimeline.ENTRIES),p=u[_+t.RotateTimeline.PREV_ROTATION],m=u[_],v=l.getCurvePercent((_>>1)-1,1-(n-m)/(u[_+t.RotateTimeline.PREV_TIME]-m));d=u[_+t.RotateTimeline.ROTATION]-p,d=p+(d-=360*(16384-(16384.499999999996-d/360|0)))*v+h.data.rotation,d-=360*(16384-(16384.499999999996-d/360|0))}var g=0,y=d-f;if(0==(y-=360*(16384-(16384.499999999996-y/360|0))))g=s[o];else{var T=0,b=0;c?(T=0,b=y):(T=s[o],b=s[o+1]);var E=y>0,A=T>=0;t.MathUtils.signum(b)!=t.MathUtils.signum(y)&&Math.abs(b)<=90&&(Math.abs(T)>180&&(T+=360*t.MathUtils.signum(T)),A=E),g=y+T-T%360,A!=E&&(g+=360*t.MathUtils.signum(T)),s[o]=g}s[o+1]=y,f+=g*r,h.rotation=f-360*(16384-(16384.499999999996-f/360|0))}}else e.apply(i,0,n,null,1,a,t.MixDirection.mixIn)},e.prototype.queueEvents=function(t,e){for(var i=t.animationStart,n=t.animationEnd,r=n-i,a=t.trackLast%r,s=this.events,o=0,c=s.length;o<c;o++){var l=s[o];if(l.time<a)break;l.time>n||this.queue.event(t,l)}for((t.loop?0==r||a>t.trackTime%r:e>=n&&t.animationLast<n)&&this.queue.complete(t);o<c;o++)s[o].time<i||this.queue.event(t,s[o])},e.prototype.clearTracks=function(){var t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var e=0,i=this.tracks.length;e<i;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()},e.prototype.clearTrack=function(t){if(!(t>=this.tracks.length)){var e=this.tracks[t];if(null!=e){this.queue.end(e),this.disposeNext(e);for(var i=e;;){var n=i.mixingFrom;if(null==n)break;this.queue.end(n),i.mixingFrom=null,i.mixingTo=null,i=n}this.tracks[e.trackIndex]=null,this.queue.drain()}}},e.prototype.setCurrent=function(t,e,i){var n=this.expandToIndex(t);this.tracks[t]=e,null!=n&&(i&&this.queue.interrupt(n),e.mixingFrom=n,n.mixingTo=e,e.mixTime=0,null!=n.mixingFrom&&n.mixDuration>0&&(e.interruptAlpha*=Math.min(1,n.mixTime/n.mixDuration)),n.timelinesRotation.length=0),this.queue.start(e)},e.prototype.setAnimation=function(t,e,i){var n=this.data.skeletonData.findAnimation(e);if(null==n)throw new Error("Animation not found: "+e);return this.setAnimationWith(t,n,i)},e.prototype.setAnimationWith=function(t,e,i){if(null==e)throw new Error("animation cannot be null.");var n=!0,r=this.expandToIndex(t);null!=r&&(-1==r.nextTrackLast?(this.tracks[t]=r.mixingFrom,this.queue.interrupt(r),this.queue.end(r),this.disposeNext(r),r=r.mixingFrom,n=!1):this.disposeNext(r));var a=this.trackEntry(t,e,i,r);return this.setCurrent(t,a,n),this.queue.drain(),a},e.prototype.addAnimation=function(t,e,i,n){var r=this.data.skeletonData.findAnimation(e);if(null==r)throw new Error("Animation not found: "+e);return this.addAnimationWith(t,r,i,n)},e.prototype.addAnimationWith=function(t,e,i,n){if(null==e)throw new Error("animation cannot be null.");var r=this.expandToIndex(t);if(null!=r)for(;null!=r.next;)r=r.next;var a=this.trackEntry(t,e,i,r);if(null==r)this.setCurrent(t,a,!0),this.queue.drain();else if(r.next=a,n<=0){var s=r.animationEnd-r.animationStart;0!=s?(r.loop?n+=s*(1+(r.trackTime/s|0)):n+=Math.max(s,r.trackTime),n-=this.data.getMix(r.animation,e)):n=r.trackTime}return a.delay=n,a},e.prototype.setEmptyAnimation=function(t,i){var n=this.setAnimationWith(t,e.emptyAnimation,!1);return n.mixDuration=i,n.trackEnd=i,n},e.prototype.addEmptyAnimation=function(t,i,n){n<=0&&(n-=i);var r=this.addAnimationWith(t,e.emptyAnimation,!1,n);return r.mixDuration=i,r.trackEnd=i,r},e.prototype.setEmptyAnimations=function(t){var e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var i=0,n=this.tracks.length;i<n;i++){var r=this.tracks[i];null!=r&&this.setEmptyAnimation(r.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()},e.prototype.expandToIndex=function(e){return e<this.tracks.length?this.tracks[e]:(t.Utils.ensureArrayCapacity(this.tracks,e+1,null),this.tracks.length=e+1,null)},e.prototype.trackEntry=function(t,e,i,n){var r=this.trackEntryPool.obtain();return r.trackIndex=t,r.animation=e,r.loop=i,r.holdPrevious=!1,r.eventThreshold=0,r.attachmentThreshold=0,r.drawOrderThreshold=0,r.animationStart=0,r.animationEnd=e.duration,r.animationLast=-1,r.nextAnimationLast=-1,r.delay=0,r.trackTime=0,r.trackLast=-1,r.nextTrackLast=-1,r.trackEnd=Number.MAX_VALUE,r.timeScale=1,r.alpha=1,r.interruptAlpha=1,r.mixTime=0,r.mixDuration=null==n?0:this.data.getMix(n.animation,e),r},e.prototype.disposeNext=function(t){for(var e=t.next;null!=e;)this.queue.dispose(e),e=e.next;t.next=null},e.prototype._animationsChanged=function(){this.animationsChanged=!1,this.propertyIDs.clear();for(var e=0,i=this.tracks.length;e<i;e++)if(null!=(n=this.tracks[e])){for(;null!=n.mixingFrom;)n=n.mixingFrom;do{null!=n.mixingFrom&&n.mixBlend==t.MixBlend.add||this.computeHold(n),n=n.mixingTo}while(null!=n)}for(this.propertyIDs.clear(),e=this.tracks.length-1;e>=0;e--)for(var n=this.tracks[e];null!=n;)this.computeNotLast(n),n=n.mixingFrom},e.prototype.computeHold=function(i){var n=i.mixingTo,r=i.animation.timelines,a=i.animation.timelines.length,s=t.Utils.setArraySize(i.timelineMode,a);i.timelineHoldMix.length=0;var o=t.Utils.setArraySize(i.timelineHoldMix,a),c=this.propertyIDs;if(null!=n&&n.holdPrevious)for(var l=0;l<a;l++)c.add(r[l].getPropertyId()),s[l]=e.HOLD;else t:for(l=0;l<a;l++){var u=r[l],h=u.getPropertyId();if(c.add(h))if(null==n||u instanceof t.AttachmentTimeline||u instanceof t.DrawOrderTimeline||u instanceof t.EventTimeline||!n.animation.hasTimeline(h))s[l]=e.FIRST;else{for(var f=n.mixingTo;null!=f;f=f.mixingTo)if(!f.animation.hasTimeline(h)){if(i.mixDuration>0){s[l]=e.HOLD_MIX,o[l]=f;continue t}break}s[l]=e.HOLD}else s[l]=e.SUBSEQUENT}},e.prototype.computeNotLast=function(i){for(var n=i.animation.timelines,r=i.animation.timelines.length,a=i.timelineMode,s=this.propertyIDs,o=0;o<r;o++)if(n[o]instanceof t.AttachmentTimeline){var c=n[o];s.add(c.slotIndex)||(a[o]|=e.NOT_LAST)}},e.prototype.getCurrent=function(t){return t>=this.tracks.length?null:this.tracks[t]},e.prototype.addListener=function(t){if(null==t)throw new Error("listener cannot be null.");this.listeners.push(t)},e.prototype.removeListener=function(t){var e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)},e.prototype.clearListeners=function(){this.listeners.length=0},e.prototype.clearListenerNotifications=function(){this.queue.clear()},e.emptyAnimation=new t.Animation("<empty>",[],0),e.SUBSEQUENT=0,e.FIRST=1,e.HOLD=2,e.HOLD_MIX=3,e.NOT_LAST=4,e})();t.AnimationState=e;var i=(function(){function e(){this.mixBlend=t.MixBlend.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}return e.prototype.reset=function(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0},e.prototype.getAnimationTime=function(){if(this.loop){var t=this.animationEnd-this.animationStart;return 0==t?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)},e.prototype.setAnimationLast=function(t){this.animationLast=t,this.nextAnimationLast=t},e.prototype.isComplete=function(){return this.trackTime>=this.animationEnd-this.animationStart},e.prototype.resetRotationDirections=function(){this.timelinesRotation.length=0},e})();t.TrackEntry=i;var n,r=(function(){function t(t){this.objects=[],this.drainDisabled=!1,this.animState=t}return t.prototype.start=function(t){this.objects.push(n.start),this.objects.push(t),this.animState.animationsChanged=!0},t.prototype.interrupt=function(t){this.objects.push(n.interrupt),this.objects.push(t)},t.prototype.end=function(t){this.objects.push(n.end),this.objects.push(t),this.animState.animationsChanged=!0},t.prototype.dispose=function(t){this.objects.push(n.dispose),this.objects.push(t)},t.prototype.complete=function(t){this.objects.push(n.complete),this.objects.push(t)},t.prototype.event=function(t,e){this.objects.push(n.event),this.objects.push(t),this.objects.push(e)},t.prototype.drain=function(){if(!this.drainDisabled){this.drainDisabled=!0;for(var t=this.objects,e=this.animState.listeners,i=0;i<t.length;i+=2){var r=t[i],a=t[i+1];switch(r){case n.start:null!=a.listener&&a.listener.start&&a.listener.start(a);for(var s=0;s<e.length;s++)e[s].start&&e[s].start(a);break;case n.interrupt:for(null!=a.listener&&a.listener.interrupt&&a.listener.interrupt(a),s=0;s<e.length;s++)e[s].interrupt&&e[s].interrupt(a);break;case n.end:for(null!=a.listener&&a.listener.end&&a.listener.end(a),s=0;s<e.length;s++)e[s].end&&e[s].end(a);case n.dispose:for(null!=a.listener&&a.listener.dispose&&a.listener.dispose(a),s=0;s<e.length;s++)e[s].dispose&&e[s].dispose(a);this.animState.trackEntryPool.free(a);break;case n.complete:for(null!=a.listener&&a.listener.complete&&a.listener.complete(a),s=0;s<e.length;s++)e[s].complete&&e[s].complete(a);break;case n.event:var o=t[2+i++];for(null!=a.listener&&a.listener.event&&a.listener.event(a,o),s=0;s<e.length;s++)e[s].event&&e[s].event(a,o)}}this.clear(),this.drainDisabled=!1}},t.prototype.clear=function(){this.objects.length=0},t})();t.EventQueue=r,(function(t){t[t.start=0]="start",t[t.interrupt=1]="interrupt",t[t.end=2]="end",t[t.dispose=3]="dispose",t[t.complete=4]="complete",t[t.event=5]="event"})(n=t.EventType||(t.EventType={}));var a=(function(){function t(){}return t.prototype.start=function(){},t.prototype.interrupt=function(){},t.prototype.end=function(){},t.prototype.dispose=function(){},t.prototype.complete=function(){},t.prototype.event=function(){},t})();t.AnimationStateAdapter=a})(r||(r={})),(function(t){var e=(function(){function t(t){if(this.animationToMixTime={},this.defaultMix=0,null==t)throw new Error("skeletonData cannot be null.");this.skeletonData=t}return t.prototype.setMix=function(t,e,i){var n=this.skeletonData.findAnimation(t);if(null==n)throw new Error("Animation not found: "+t);var r=this.skeletonData.findAnimation(e);if(null==r)throw new Error("Animation not found: "+e);this.setMixWith(n,r,i)},t.prototype.setMixWith=function(t,e,i){if(null==t)throw new Error("from cannot be null.");if(null==e)throw new Error("to cannot be null.");var n=t.name+"."+e.name;this.animationToMixTime[n]=i},t.prototype.getMix=function(t,e){var i=t.name+"."+e.name,n=this.animationToMixTime[i];return void 0===n?this.defaultMix:n},t})();t.AnimationStateData=e})(r||(r={})),(function(t){var e=(function(){function e(t,e){void 0===e&&(e=""),this.assets={},this.errors={},this.toLoad=0,this.loaded=0,this.textureLoader=t,this.pathPrefix=e}return e.downloadText=function(t,e,i){var n=new XMLHttpRequest;n.open("GET",t,!0),n.onload=function(){200==n.status?e(n.responseText):i(n.status,n.responseText)},n.onerror=function(){i(n.status,n.responseText)},n.send()},e.downloadBinary=function(t,e,i){var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status?e(new Uint8Array(n.response)):i(n.status,n.responseText)},n.onerror=function(){i(n.status,n.responseText)},n.send()},e.prototype.loadBinary=function(t,i,n){var r=this;void 0===i&&(i=null),void 0===n&&(n=null),t=this.pathPrefix+t,this.toLoad++,e.downloadBinary(t,(function(e){r.assets[t]=e,i&&i(t,e),r.toLoad--,r.loaded++}),(function(e,i){r.errors[t]="Couldn't load binary "+t+": status "+status+", "+i,n&&n(t,"Couldn't load binary "+t+": status "+status+", "+i),r.toLoad--,r.loaded++}))},e.prototype.loadText=function(t,i,n){var r=this;void 0===i&&(i=null),void 0===n&&(n=null),t=this.pathPrefix+t,this.toLoad++,e.downloadText(t,(function(e){r.assets[t]=e,i&&i(t,e),r.toLoad--,r.loaded++}),(function(e,i){r.errors[t]="Couldn't load text "+t+": status "+status+", "+i,n&&n(t,"Couldn't load text "+t+": status "+status+", "+i),r.toLoad--,r.loaded++}))},e.prototype.loadTexture=function(t,e,i){var n=this;void 0===e&&(e=null),void 0===i&&(i=null),t=this.pathPrefix+t,this.toLoad++;var r=new Image;r.crossOrigin="anonymous",r.onload=function(){var i=n.textureLoader(r);n.assets[t]=i,n.toLoad--,n.loaded++,e&&e(t,r)},r.onerror=function(){n.errors[t]="Couldn't load image "+t,n.toLoad--,n.loaded++,i&&i(t,"Couldn't load image "+t)},r.src=t},e.prototype.loadTextureData=function(t,e,i,n){var r=this;void 0===i&&(i=null),void 0===n&&(n=null),t=this.pathPrefix+t,this.toLoad++;var a=new Image;a.onload=function(){var e=r.textureLoader(a);r.assets[t]=e,r.toLoad--,r.loaded++,i&&i(t,a)},a.onerror=function(){r.errors[t]="Couldn't load image "+t,r.toLoad--,r.loaded++,n&&n(t,"Couldn't load image "+t)},a.src=e},e.prototype.loadTextureAtlas=function(i,n,r){var a=this;void 0===n&&(n=null),void 0===r&&(r=null);var s=i.lastIndexOf("/")>=0?i.substring(0,i.lastIndexOf("/")):"";i=this.pathPrefix+i,this.toLoad++,e.downloadText(i,(function(e){var o={count:0},c=new Array;try{new t.TextureAtlas(e,function(e){c.push(s+"/"+e);var i=document.createElement("img");return i.width=16,i.height=16,new t.FakeTexture(i)})}catch(d){var l=d;return a.errors[i]="Couldn't load texture atlas "+i+": "+l.message,r&&r(i,"Couldn't load texture atlas "+i+": "+l.message),a.toLoad--,void a.loaded++}for(var u=function(l){var u=!1;a.loadTexture(l,(function(l){if(o.count++,o.count==c.length)if(u)a.errors[i]="Couldn't load texture atlas page "+l+"} of atlas "+i,r&&r(i,"Couldn't load texture atlas page "+l+" of atlas "+i),a.toLoad--,a.loaded++;else try{var h=new t.TextureAtlas(e,function(t){return a.get(s+"/"+t)});a.assets[i]=h,n&&n(i,h),a.toLoad--,a.loaded++}catch(d){var f=d;a.errors[i]="Couldn't load texture atlas "+i+": "+f.message,r&&r(i,"Couldn't load texture atlas "+i+": "+f.message),a.toLoad--,a.loaded++}}),(function(t){u=!0,o.count++,o.count==c.length&&(a.errors[i]="Couldn't load texture atlas page "+t+"} of atlas "+i,r&&r(i,"Couldn't load texture atlas page "+t+" of atlas "+i),a.toLoad--,a.loaded++)}))},h=0,f=c;h<f.length;h++)u(f[h])}),(function(t,e){a.errors[i]="Couldn't load texture atlas "+i+": status "+status+", "+e,r&&r(i,"Couldn't load texture atlas "+i+": status "+status+", "+e),a.toLoad--,a.loaded++}))},e.prototype.get=function(t){return t=this.pathPrefix+t,this.assets[t]},e.prototype.remove=function(t){t=this.pathPrefix+t;var e=this.assets[t];e.dispose&&e.dispose(),this.assets[t]=null},e.prototype.removeAll=function(){for(var t in this.assets){var e=this.assets[t];e.dispose&&e.dispose()}this.assets={}},e.prototype.isLoadingComplete=function(){return 0==this.toLoad},e.prototype.getToLoad=function(){return this.toLoad},e.prototype.getLoaded=function(){return this.loaded},e.prototype.dispose=function(){this.removeAll()},e.prototype.hasErrors=function(){return Object.keys(this.errors).length>0},e.prototype.getErrors=function(){return this.errors},e})();t.AssetManager=e})(r||(r={})),(function(t){var e=(function(){function e(t){this.atlas=t}return e.prototype.newRegionAttachment=function(e,i,n){var r=this.atlas.findRegion(n);if(null==r)return null;r.renderObject=r;var a=new t.RegionAttachment(i);return a.setRegion(r),a},e.prototype.newMeshAttachment=function(e,i,n){var r=this.atlas.findRegion(n);if(null==r)return null;r.renderObject=r;var a=new t.MeshAttachment(i);return a.region=r,a},e.prototype.newBoundingBoxAttachment=function(e,i){return new t.BoundingBoxAttachment(i)},e.prototype.newPathAttachment=function(e,i){return new t.PathAttachment(i)},e.prototype.newPointAttachment=function(e,i){return new t.PointAttachment(i)},e.prototype.newClippingAttachment=function(e,i){return new t.ClippingAttachment(i)},e})();t.AtlasAttachmentLoader=e})(r||(r={})),(function(t){(function(t){t[t.Normal=0]="Normal",t[t.Additive=1]="Additive",t[t.Multiply=2]="Multiply",t[t.Screen=3]="Screen"})(t.BlendMode||(t.BlendMode={}))})(r||(r={})),(function(t){var e=(function(){function e(t,e,i){if(this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.a=0,this.b=0,this.c=0,this.d=0,this.worldY=0,this.worldX=0,this.sorted=!1,this.active=!1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.skeleton=e,this.parent=i,this.setToSetupPose()}return e.prototype.isActive=function(){return this.active},e.prototype.update=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},e.prototype.updateWorldTransform=function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)},e.prototype.updateWorldTransformWith=function(e,i,n,r,a,s,o){this.ax=e,this.ay=i,this.arotation=n,this.ascaleX=r,this.ascaleY=a,this.ashearX=s,this.ashearY=o,this.appliedValid=!0;var c=this.parent;if(null==c){var l=this.skeleton,u=n+90+o,h=l.scaleX,f=l.scaleY;return this.a=t.MathUtils.cosDeg(n+s)*r*h,this.b=t.MathUtils.cosDeg(u)*a*h,this.c=t.MathUtils.sinDeg(n+s)*r*f,this.d=t.MathUtils.sinDeg(u)*a*f,this.worldX=e*h+l.x,void(this.worldY=i*f+l.y)}var d=c.a,_=c.b,p=c.c,m=c.d;switch(this.worldX=d*e+_*i+c.worldX,this.worldY=p*e+m*i+c.worldY,this.data.transformMode){case t.TransformMode.Normal:u=n+90+o;var v=t.MathUtils.cosDeg(n+s)*r,g=t.MathUtils.cosDeg(u)*a,y=t.MathUtils.sinDeg(n+s)*r,T=t.MathUtils.sinDeg(u)*a;return this.a=d*v+_*y,this.b=d*g+_*T,this.c=p*v+m*y,void(this.d=p*g+m*T);case t.TransformMode.OnlyTranslation:u=n+90+o,this.a=t.MathUtils.cosDeg(n+s)*r,this.b=t.MathUtils.cosDeg(u)*a,this.c=t.MathUtils.sinDeg(n+s)*r,this.d=t.MathUtils.sinDeg(u)*a;break;case t.TransformMode.NoRotationOrReflection:var b=0;(C=d*d+p*p)>1e-4?(_=p*(C=Math.abs(d*m-_*p)/C),m=d*C,b=Math.atan2(p,d)*t.MathUtils.radDeg):(d=0,p=0,b=90-Math.atan2(m,_)*t.MathUtils.radDeg);var E=n+s-b,A=n+o-b+90;v=t.MathUtils.cosDeg(E)*r,g=t.MathUtils.cosDeg(A)*a,y=t.MathUtils.sinDeg(E)*r,T=t.MathUtils.sinDeg(A)*a,this.a=d*v-_*y,this.b=d*g-_*T,this.c=p*v+m*y,this.d=p*g+m*T;break;case t.TransformMode.NoScale:case t.TransformMode.NoScaleOrReflection:var C,x=t.MathUtils.cosDeg(n),S=t.MathUtils.sinDeg(n),w=(d*x+_*S)/this.skeleton.scaleX,M=(p*x+m*S)/this.skeleton.scaleY;(C=Math.sqrt(w*w+M*M))>1e-5&&(C=1/C),w*=C,M*=C,C=Math.sqrt(w*w+M*M),this.data.transformMode==t.TransformMode.NoScale&&d*m-_*p<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(C=-C);var R=Math.PI/2+Math.atan2(M,w),I=Math.cos(R)*C,O=Math.sin(R)*C;v=t.MathUtils.cosDeg(s)*r,g=t.MathUtils.cosDeg(90+o)*a,y=t.MathUtils.sinDeg(s)*r,T=t.MathUtils.sinDeg(90+o)*a,this.a=w*v+I*y,this.b=w*g+I*T,this.c=M*v+O*y,this.d=M*g+O*T}this.a*=this.skeleton.scaleX,this.b*=this.skeleton.scaleX,this.c*=this.skeleton.scaleY,this.d*=this.skeleton.scaleY},e.prototype.setToSetupPose=function(){var t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY},e.prototype.getWorldRotationX=function(){return Math.atan2(this.c,this.a)*t.MathUtils.radDeg},e.prototype.getWorldRotationY=function(){return Math.atan2(this.d,this.b)*t.MathUtils.radDeg},e.prototype.getWorldScaleX=function(){return Math.sqrt(this.a*this.a+this.c*this.c)},e.prototype.getWorldScaleY=function(){return Math.sqrt(this.b*this.b+this.d*this.d)},e.prototype.updateAppliedTransform=function(){this.appliedValid=!0;var e=this.parent;if(null==e)return this.ax=this.worldX,this.ay=this.worldY,this.arotation=Math.atan2(this.c,this.a)*t.MathUtils.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,void(this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*t.MathUtils.radDeg);var i=e.a,n=e.b,r=e.c,a=e.d,s=1/(i*a-n*r),o=this.worldX-e.worldX,c=this.worldY-e.worldY;this.ax=o*a*s-c*n*s,this.ay=c*i*s-o*r*s;var l=s*a,u=s*i,h=s*n,f=s*r,d=l*this.a-h*this.c,_=l*this.b-h*this.d,p=u*this.c-f*this.a,m=u*this.d-f*this.b;if(this.ashearX=0,this.ascaleX=Math.sqrt(d*d+p*p),this.ascaleX>1e-4){var v=d*m-_*p;this.ascaleY=v/this.ascaleX,this.ashearY=Math.atan2(d*_+p*m,v)*t.MathUtils.radDeg,this.arotation=Math.atan2(p,d)*t.MathUtils.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(_*_+m*m),this.ashearY=0,this.arotation=90-Math.atan2(m,_)*t.MathUtils.radDeg},e.prototype.worldToLocal=function(t){var e=this.a,i=this.b,n=this.c,r=this.d,a=1/(e*r-i*n),s=t.x-this.worldX,o=t.y-this.worldY;return t.x=s*r*a-o*i*a,t.y=o*e*a-s*n*a,t},e.prototype.localToWorld=function(t){var e=t.x,i=t.y;return t.x=e*this.a+i*this.b+this.worldX,t.y=e*this.c+i*this.d+this.worldY,t},e.prototype.worldToLocalRotation=function(e){var i=t.MathUtils.sinDeg(e),n=t.MathUtils.cosDeg(e);return Math.atan2(this.a*i-this.c*n,this.d*n-this.b*i)*t.MathUtils.radDeg+this.rotation-this.shearX},e.prototype.localToWorldRotation=function(e){e-=this.rotation-this.shearX;var i=t.MathUtils.sinDeg(e),n=t.MathUtils.cosDeg(e);return Math.atan2(n*this.c+i*this.d,n*this.a+i*this.b)*t.MathUtils.radDeg},e.prototype.rotateWorld=function(e){var i=this.a,n=this.b,r=this.c,a=this.d,s=t.MathUtils.cosDeg(e),o=t.MathUtils.sinDeg(e);this.a=s*i-o*r,this.b=s*n-o*a,this.c=o*i+s*r,this.d=o*n+s*a,this.appliedValid=!1},e})();t.Bone=e})(r||(r={})),(function(t){var e;t.BoneData=function(i,n,r){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=e.Normal,this.skinRequired=!1,this.color=new t.Color,i<0)throw new Error("index must be >= 0.");if(null==n)throw new Error("name cannot be null.");this.index=i,this.name=n,this.parent=r},(function(t){t[t.Normal=0]="Normal",t[t.OnlyTranslation=1]="OnlyTranslation",t[t.NoRotationOrReflection=2]="NoRotationOrReflection",t[t.NoScale=3]="NoScale",t[t.NoScaleOrReflection=4]="NoScaleOrReflection"})(e=t.TransformMode||(t.TransformMode={}))})(r||(r={})),(function(t){t.ConstraintData=function(t,e,i){this.name=t,this.order=e,this.skinRequired=i}})(r||(r={})),(function(t){t.Event=function(t,e){if(null==e)throw new Error("data cannot be null.");this.time=t,this.data=e}})(r||(r={})),(function(t){t.EventData=function(t){this.name=t}})(r||(r={})),(function(t){var e=(function(){function e(t,e){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.mix=t.mix,this.softness=t.softness,this.bendDirection=t.bendDirection,this.compress=t.compress,this.stretch=t.stretch,this.bones=new Array;for(var i=0;i<t.bones.length;i++)this.bones.push(e.findBone(t.bones[i].name));this.target=e.findBone(t.target.name)}return e.prototype.isActive=function(){return this.active},e.prototype.apply=function(){this.update()},e.prototype.update=function(){var t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.softness,this.mix)}},e.prototype.apply1=function(e,i,n,r,a,s,o){e.appliedValid||e.updateAppliedTransform();var c=e.parent,l=1/(c.a*c.d-c.b*c.c),u=i-c.worldX,h=n-c.worldY,f=(u*c.d-h*c.b)*l-e.ax,d=(h*c.a-u*c.c)*l-e.ay,_=Math.atan2(d,f)*t.MathUtils.radDeg-e.ashearX-e.arotation;e.ascaleX<0&&(_+=180),_>180?_-=360:_<-180&&(_+=360);var p=e.ascaleX,m=e.ascaleY;if(r||a){var v=e.data.length*p,g=Math.sqrt(f*f+d*d);if(r&&g<v||a&&g>v&&v>1e-4){var y=(g/v-1)*o+1;p*=y,s&&(m*=y)}}e.updateWorldTransformWith(e.ax,e.ay,e.arotation+_*o,p,m,e.ashearX,e.ashearY)},e.prototype.apply2=function(e,i,n,r,a,s,o,c){if(0!=c){e.appliedValid||e.updateAppliedTransform(),i.appliedValid||i.updateAppliedTransform();var l=e.ax,u=e.ay,h=e.ascaleX,f=h,d=e.ascaleY,_=i.ascaleX,p=0,m=0,v=0;h<0?(h=-h,p=180,v=-1):(p=0,v=1),d<0&&(d=-d,v=-v),_<0?(_=-_,m=180):m=0;var g=i.ax,y=0,T=0,b=0,E=e.a,A=e.b,C=e.c,x=e.d,S=Math.abs(h-d)<=1e-4;S?(T=E*g+A*(y=i.ay)+e.worldX,b=C*g+x*y+e.worldY):(y=0,T=E*g+e.worldX,b=C*g+e.worldY);var w=e.parent;E=w.a,A=w.b,C=w.c;var M,R,I=1/(E*(x=w.d)-A*C),O=T-w.worldX,D=b-w.worldY,P=(O*x-D*A)*I-l,L=(D*E-O*C)*I-u,N=Math.sqrt(P*P+L*L),F=i.data.length*_;if(N<1e-4)return this.apply1(e,n,r,!1,s,!1,c),void i.updateWorldTransformWith(g,y,0,i.ascaleX,i.ascaleY,i.ashearX,i.ashearY);var B=((O=n-w.worldX)*x-(D=r-w.worldY)*A)*I-l,k=(D*E-O*C)*I-u,V=B*B+k*k;if(0!=o){o*=h*(_+1)/2;var z=Math.sqrt(V),U=z-N-F*h+o;if(U>0){var H=Math.min(1,U/(2*o))-1;V=(B-=(H=(U-o*(1-H*H))/z)*B)*B+(k-=H*k)*k}}t:if(S){var W=(V-N*N-(F*=h)*F)/(2*N*F);W<-1?W=-1:W>1&&(W=1,s&&(f*=(Math.sqrt(V)/(N+F)-1)*c+1)),R=Math.acos(W)*a,E=N+F*W,A=F*Math.sin(R),M=Math.atan2(k*E-B*A,B*E+k*A)}else{var G=(E=h*F)*E,j=(A=d*F)*A,Y=Math.atan2(k,B),X=-2*j*N,q=j-G;if((x=X*X-4*q*(C=j*N*N+G*V-G*j))>=0){var Z=Math.sqrt(x);X<0&&(Z=-Z);var K=(Z=-(X+Z)/2)/q,Q=C/Z,J=Math.abs(K)<Math.abs(Q)?K:Q;if(J*J<=V){D=Math.sqrt(V-J*J)*a,M=Y-Math.atan2(D,J),R=Math.atan2(D/d,(J-N)/h);break t}}var $=t.MathUtils.PI,tt=N-E,et=tt*tt,it=0,nt=0,rt=N+E,at=rt*rt,st=0;(C=-E*N/(G-j))>=-1&&C<=1&&(C=Math.acos(C),(x=(O=E*Math.cos(C)+N)*O+(D=A*Math.sin(C))*D)<et&&($=C,et=x,tt=O,it=D),x>at&&(nt=C,at=x,rt=O,st=D)),V<=(et+at)/2?(M=Y-Math.atan2(it*a,tt),R=$*a):(M=Y-Math.atan2(st*a,rt),R=nt*a)}var ot=Math.atan2(y,g)*v,ct=e.arotation;(M=(M-ot)*t.MathUtils.radDeg+p-ct)>180?M-=360:M<-180&&(M+=360),e.updateWorldTransformWith(l,u,ct+M*c,f,e.ascaleY,0,0),ct=i.arotation,(R=((R+ot)*t.MathUtils.radDeg-i.ashearX)*v+m-ct)>180?R-=360:R<-180&&(R+=360),i.updateWorldTransformWith(g,y,ct+R*c,i.ascaleX,i.ascaleY,i.ashearX,i.ashearY)}else i.updateWorldTransform()},e})();t.IkConstraint=e})(r||(r={})),(function(t){var e=(function(t){function e(e){var i=t.call(this,e,0,!1)||this;return i.bones=new Array,i.bendDirection=1,i.compress=!1,i.stretch=!1,i.uniform=!1,i.mix=1,i.softness=0,i}return a(e,t),e})(t.ConstraintData);t.IkConstraintData=e})(r||(r={})),(function(t){var e=(function(){function e(t,e){if(this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,null==t)throw new Error("data cannot be null.");if(null==e)throw new Error("skeleton cannot be null.");this.data=t,this.bones=new Array;for(var i=0,n=t.bones.length;i<n;i++)this.bones.push(e.findBone(t.bones[i].name));this.target=e.findSlot(t.target.name),this.position=t.position,this.spacing=t.spacing,this.rotateMix=t.rotateMix,this.translateMix=t.translateMix}return e.prototype.isActive=function(){return this.active},e.prototype.apply=function(){this.update()},e.prototype.update=function(){var i=this.target.getAttachment();if(i instanceof t.PathAttachment){var n=this.rotateMix,r=this.translateMix,a=n>0;if(r>0||a){var s=this.data,o=s.spacingMode==t.SpacingMode.Percent,c=s.rotateMode,l=c==t.RotateMode.Tangent,u=c==t.RotateMode.ChainScale,h=this.bones.length,f=l?h:h+1,d=this.bones,_=t.Utils.setArraySize(this.spaces,f),p=null,m=this.spacing;if(u||!o){u&&(p=t.Utils.setArraySize(this.lengths,h));for(var v=s.spacingMode==t.SpacingMode.Length,g=0,y=f-1;g<y;){var T=(O=d[g]).data.length;if(T<e.epsilon)u&&(p[g]=0),_[++g]=0;else if(o){if(u){var b=T*O.a,E=T*O.c,A=Math.sqrt(b*b+E*E);p[g]=A}_[++g]=m}else{b=T*O.a,E=T*O.c;var C=Math.sqrt(b*b+E*E);u&&(p[g]=C),_[++g]=(v?T+m:m)*C/T}}}else for(g=1;g<f;g++)_[g]=m;var x=this.computeWorldPositions(i,f,l,s.positionMode==t.PositionMode.Percent,o),S=x[0],w=x[1],M=s.offsetRotation,R=!1;0==M?R=c==t.RotateMode.Chain:(R=!1,M*=(I=this.target.bone).a*I.d-I.b*I.c>0?t.MathUtils.degRad:-t.MathUtils.degRad),g=0;for(var I=3;g<h;g++,I+=3){var O;(O=d[g]).worldX+=(S-O.worldX)*r,O.worldY+=(w-O.worldY)*r;var D=(b=x[I])-S,P=(E=x[I+1])-w;if(u){var L=p[g];if(0!=L){var N=(Math.sqrt(D*D+P*P)/L-1)*n+1;O.a*=N,O.c*=N}}if(S=b,w=E,a){var F=O.a,B=O.b,k=O.c,V=O.d,z=0,U=0,H=0;if(z=l?x[I-1]:0==_[g+1]?x[I+2]:Math.atan2(P,D),z-=Math.atan2(k,F),R){U=Math.cos(z),H=Math.sin(z);var W=O.data.length;S+=(W*(U*F-H*k)-D)*n,w+=(W*(H*F+U*k)-P)*n}else z+=M;z>t.MathUtils.PI?z-=t.MathUtils.PI2:z<-t.MathUtils.PI&&(z+=t.MathUtils.PI2),z*=n,U=Math.cos(z),H=Math.sin(z),O.a=U*F-H*k,O.b=U*B-H*V,O.c=H*F+U*k,O.d=H*B+U*V}O.appliedValid=!1}}}},e.prototype.computeWorldPositions=function(i,n,r,a,s){var o=this.target,c=this.position,l=this.spaces,u=t.Utils.setArraySize(this.positions,3*n+2),h=null,f=i.closed,d=i.worldVerticesLength,_=d/6,p=e.NONE;if(!i.constantSpeed){var m=i.lengths,v=m[_-=f?1:2];if(a&&(c*=v),s)for(var g=1;g<n;g++)l[g]*=v;h=t.Utils.setArraySize(this.world,8),g=0;for(var y=0,T=0;g<n;g++,y+=3){var b=c+=j=l[g];if(f)(b%=v)<0&&(b+=v),T=0;else{if(b<0){p!=e.BEFORE&&(p=e.BEFORE,i.computeWorldVertices(o,2,4,h,0,2)),this.addBeforePosition(b,h,0,u,y);continue}if(b>v){p!=e.AFTER&&(p=e.AFTER,i.computeWorldVertices(o,d-6,4,h,0,2)),this.addAfterPosition(b-v,h,0,u,y);continue}}for(;;T++){var E=m[T];if(!(b>E)){0==T?b/=E:b=(b-(Z=m[T-1]))/(E-Z);break}}T!=p&&(p=T,f&&T==_?(i.computeWorldVertices(o,d-4,4,h,0,2),i.computeWorldVertices(o,0,4,h,4,2)):i.computeWorldVertices(o,6*T+2,8,h,0,2)),this.addCurvePosition(b,h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],u,y,r||g>0&&0==j)}return u}f?(d+=2,h=t.Utils.setArraySize(this.world,d),i.computeWorldVertices(o,2,d-4,h,0,2),i.computeWorldVertices(o,0,2,h,d-4,2),h[d-2]=h[0],h[d-1]=h[1]):(_--,d-=4,h=t.Utils.setArraySize(this.world,d),i.computeWorldVertices(o,2,d,h,0,2));for(var A=t.Utils.setArraySize(this.curves,_),C=0,x=h[0],S=h[1],w=0,M=0,R=0,I=0,O=0,D=0,P=0,L=0,N=0,F=0,B=0,k=0,V=0,z=0,U=(g=0,2);g<_;g++,U+=6)w=h[U],M=h[U+1],R=h[U+2],I=h[U+3],B=2*(P=.1875*(x-2*w+R))+(N=.09375*(3*(w-R)-x+(O=h[U+4]))),k=2*(L=.1875*(S-2*M+I))+(F=.09375*(3*(M-I)-S+(D=h[U+5]))),V=.75*(w-x)+P+.16666667*N,z=.75*(M-S)+L+.16666667*F,C+=Math.sqrt(V*V+z*z),V+=B,z+=k,B+=N,k+=F,C+=Math.sqrt(V*V+z*z),V+=B,z+=k,C+=Math.sqrt(V*V+z*z),V+=B+N,z+=k+F,C+=Math.sqrt(V*V+z*z),A[g]=C,x=O,S=D;if(c*=a?C:C/i.lengths[_-1],s)for(g=1;g<n;g++)l[g]*=C;for(var H=this.segments,W=0,G=(g=0,y=0,T=0,0);g<n;g++,y+=3){var j;if(b=c+=j=l[g],f)(b%=C)<0&&(b+=C),T=0;else{if(b<0){this.addBeforePosition(b,h,0,u,y);continue}if(b>C){this.addAfterPosition(b-C,h,d-4,u,y);continue}}for(;;T++){var Y=A[T];if(!(b>Y)){0==T?b/=Y:b=(b-(Z=A[T-1]))/(Y-Z);break}}if(T!=p){p=T;var X=6*T;for(x=h[X],S=h[X+1],w=h[X+2],M=h[X+3],R=h[X+4],I=h[X+5],B=2*(P=.03*(x-2*w+R))+(N=.006*(3*(w-R)-x+(O=h[X+6]))),k=2*(L=.03*(S-2*M+I))+(F=.006*(3*(M-I)-S+(D=h[X+7]))),V=.3*(w-x)+P+.16666667*N,z=.3*(M-S)+L+.16666667*F,W=Math.sqrt(V*V+z*z),H[0]=W,X=1;X<8;X++)V+=B,z+=k,B+=N,k+=F,W+=Math.sqrt(V*V+z*z),H[X]=W;V+=B,z+=k,W+=Math.sqrt(V*V+z*z),H[8]=W,V+=B+N,z+=k+F,W+=Math.sqrt(V*V+z*z),H[9]=W,G=0}for(b*=W;;G++){var q=H[G];if(!(b>q)){var Z;0==G?b/=q:b=G+(b-(Z=H[G-1]))/(q-Z);break}}this.addCurvePosition(.1*b,x,S,w,M,R,I,O,D,u,y,r||g>0&&0==j)}return u},e.prototype.addBeforePosition=function(t,e,i,n,r){var a=e[i],s=e[i+1],o=e[i+2]-a,c=e[i+3]-s,l=Math.atan2(c,o);n[r]=a+t*Math.cos(l),n[r+1]=s+t*Math.sin(l),n[r+2]=l},e.prototype.addAfterPosition=function(t,e,i,n,r){var a=e[i+2],s=e[i+3],o=a-e[i],c=s-e[i+1],l=Math.atan2(c,o);n[r]=a+t*Math.cos(l),n[r+1]=s+t*Math.sin(l),n[r+2]=l},e.prototype.addCurvePosition=function(t,e,i,n,r,a,s,o,c,l,u,h){if(0==t||isNaN(t))return l[u]=e,l[u+1]=i,void(l[u+2]=Math.atan2(r-i,n-e));var f=t*t,d=f*t,_=1-t,p=_*_,m=p*_,v=_*t,g=3*v,y=_*g,T=g*t,b=e*m+n*y+a*T+o*d,E=i*m+r*y+s*T+c*d;l[u]=b,l[u+1]=E,h&&(l[u+2]=t<.001?Math.atan2(r-i,n-e):Math.atan2(E-(i*p+r*v*2+s*f),b-(e*p+n*v*2+a*f)))},e.NONE=-1,e.BEFORE=-2,e.AFTER=-3,e.epsilon=1e-5,e})();t.PathConstraint=e})(r||(r={})),(function(t){var e=(function(t){function e(e){var i=t.call(this,e,0,!1)||this;return i.bones=new Array,i}return a(e,t),e})(t.ConstraintData);t.PathConstraintData=e,(function(t){t[t.Fixed=0]="Fixed",t[t.Percent=1]="Percent"})(t.PositionMode||(t.PositionMode={})),(function(t){t[t.Length=0]="Length",t[t.Fixed=1]="Fixed",t[t.Percent=2]="Percent"})(t.SpacingMode||(t.SpacingMode={})),(function(t){t[t.Tangent=0]="Tangent",t[t.Chain=1]="Chain",t[t.ChainScale=2]="ChainScale"})(t.RotateMode||(t.RotateMode={}))})(r||(r={})),(function(t){var e=(function(){function t(t){this.toLoad=new Array,this.assets={},this.clientId=t}return t.prototype.loaded=function(){var t=0;for(var e in this.assets)t++;return t},t})(),i=(function(){function t(t){void 0===t&&(t=""),this.clientAssets={},this.queuedAssets={},this.rawAssets={},this.errors={},this.pathPrefix=t}return t.prototype.queueAsset=function(t,i,n){var r=this.clientAssets[t];return null==r&&(r=new e(t),this.clientAssets[t]=r),null!==i&&(r.textureLoader=i),r.toLoad.push(n),this.queuedAssets[n]!==n&&(this.queuedAssets[n]=n,!0)},t.prototype.loadText=function(t,e){var i=this;if(e=this.pathPrefix+e,this.queueAsset(t,null,e)){var n=new XMLHttpRequest;n.onreadystatechange=function(){n.readyState==XMLHttpRequest.DONE&&(n.status>=200&&n.status<300?i.rawAssets[e]=n.responseText:i.errors[e]="Couldn't load text "+e+": status "+n.status+", "+n.responseText)},n.open("GET",e,!0),n.send()}},t.prototype.loadJson=function(t,e){var i=this;if(e=this.pathPrefix+e,this.queueAsset(t,null,e)){var n=new XMLHttpRequest;n.onreadystatechange=function(){n.readyState==XMLHttpRequest.DONE&&(n.status>=200&&n.status<300?i.rawAssets[e]=JSON.parse(n.responseText):i.errors[e]="Couldn't load text "+e+": status "+n.status+", "+n.responseText)},n.open("GET",e,!0),n.send()}},t.prototype.loadTexture=function(t,e,i){var n=this;if(i=this.pathPrefix+i,this.queueAsset(t,e,i)){var r=new Image;r.src=i,r.crossOrigin="anonymous",r.onload=function(){n.rawAssets[i]=r},r.onerror=function(){n.errors[i]="Couldn't load image "+i}}},t.prototype.get=function(t,e){e=this.pathPrefix+e;var i=this.clientAssets[t];return null==i||i.assets[e]},t.prototype.updateClientAssets=function(t){for(var e=0;e<t.toLoad.length;e++){var i=t.toLoad[e];if(null==t.assets[i]){var n=this.rawAssets[i];if(null==n)continue;n instanceof HTMLImageElement?t.assets[i]=t.textureLoader(n):t.assets[i]=n}}},t.prototype.isLoadingComplete=function(t){var e=this.clientAssets[t];return null==e||(this.updateClientAssets(e),e.toLoad.length==e.loaded())},t.prototype.dispose=function(){},t.prototype.hasErrors=function(){return Object.keys(this.errors).length>0},t.prototype.getErrors=function(){return this.errors},t})();t.SharedAssetManager=i})(r||(r={})),(function(t){var e=(function(){function e(e){if(this._updateCache=new Array,this.updateCacheReset=new Array,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,null==e)throw new Error("data cannot be null.");this.data=e,this.bones=new Array;for(var i=0;i<e.bones.length;i++){var n=e.bones[i],r=void 0;if(null==n.parent)r=new t.Bone(n,this,null);else{var a=this.bones[n.parent.index];r=new t.Bone(n,this,a),a.children.push(r)}this.bones.push(r)}for(this.slots=new Array,this.drawOrder=new Array,i=0;i<e.slots.length;i++){var s=e.slots[i],o=(r=this.bones[s.boneData.index],new t.Slot(s,r));this.slots.push(o),this.drawOrder.push(o)}for(this.ikConstraints=new Array,i=0;i<e.ikConstraints.length;i++){var c=e.ikConstraints[i];this.ikConstraints.push(new t.IkConstraint(c,this))}for(this.transformConstraints=new Array,i=0;i<e.transformConstraints.length;i++){var l=e.transformConstraints[i];this.transformConstraints.push(new t.TransformConstraint(l,this))}for(this.pathConstraints=new Array,i=0;i<e.pathConstraints.length;i++){var u=e.pathConstraints[i];this.pathConstraints.push(new t.PathConstraint(u,this))}this.color=new t.Color(1,1,1,1),this.updateCache()}return e.prototype.updateCache=function(){this._updateCache.length=0,this.updateCacheReset.length=0;for(var t=this.bones,e=0,i=t.length;e<i;e++)(r=t[e]).sorted=r.data.skinRequired,r.active=!r.sorted;if(null!=this.skin){var n=this.skin.bones;for(e=0,i=this.skin.bones.length;e<i;e++){var r=this.bones[n[e].index];do{r.sorted=!1,r.active=!0,r=r.parent}while(null!=r)}}var a=this.ikConstraints,s=this.transformConstraints,o=this.pathConstraints,c=a.length,l=s.length,u=o.length,h=c+l+u;t:for(e=0;e<h;e++){for(var f=0;f<c;f++)if((d=a[f]).data.order==e){this.sortIkConstraint(d);continue t}for(f=0;f<l;f++)if((d=s[f]).data.order==e){this.sortTransformConstraint(d);continue t}for(f=0;f<u;f++){var d;if((d=o[f]).data.order==e){this.sortPathConstraint(d);continue t}}}for(e=0,i=t.length;e<i;e++)this.sortBone(t[e])},e.prototype.sortIkConstraint=function(e){if(e.active=e.target.isActive()&&(!e.data.skinRequired||null!=this.skin&&t.Utils.contains(this.skin.constraints,e.data,!0)),e.active){var i=e.target;this.sortBone(i);var n=e.bones,r=n[0];if(this.sortBone(r),n.length>1){var a=n[n.length-1];this._updateCache.indexOf(a)>-1||this.updateCacheReset.push(a)}this._updateCache.push(e),this.sortReset(r.children),n[n.length-1].sorted=!0}},e.prototype.sortPathConstraint=function(e){if(e.active=e.target.bone.isActive()&&(!e.data.skinRequired||null!=this.skin&&t.Utils.contains(this.skin.constraints,e.data,!0)),e.active){var i=e.target,n=i.data.index,r=i.bone;null!=this.skin&&this.sortPathConstraintAttachment(this.skin,n,r),null!=this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,n,r);for(var a=0,s=this.data.skins.length;a<s;a++)this.sortPathConstraintAttachment(this.data.skins[a],n,r);var o=i.getAttachment();o instanceof t.PathAttachment&&this.sortPathConstraintAttachmentWith(o,r);var c=e.bones,l=c.length;for(a=0;a<l;a++)this.sortBone(c[a]);for(this._updateCache.push(e),a=0;a<l;a++)this.sortReset(c[a].children);for(a=0;a<l;a++)c[a].sorted=!0}},e.prototype.sortTransformConstraint=function(e){if(e.active=e.target.isActive()&&(!e.data.skinRequired||null!=this.skin&&t.Utils.contains(this.skin.constraints,e.data,!0)),e.active){this.sortBone(e.target);var i=e.bones,n=i.length;if(e.data.local)for(var r=0;r<n;r++){var a=i[r];this.sortBone(a.parent),this._updateCache.indexOf(a)>-1||this.updateCacheReset.push(a)}else for(r=0;r<n;r++)this.sortBone(i[r]);this._updateCache.push(e);for(var s=0;s<n;s++)this.sortReset(i[s].children);for(s=0;s<n;s++)i[s].sorted=!0}},e.prototype.sortPathConstraintAttachment=function(t,e,i){var n=t.attachments[e];if(n)for(var r in n)this.sortPathConstraintAttachmentWith(n[r],i)},e.prototype.sortPathConstraintAttachmentWith=function(e,i){if(e instanceof t.PathAttachment){var n=e.bones;if(null==n)this.sortBone(i);else for(var r=this.bones,a=0;a<n.length;)for(var s=n[a++],o=a+s;a<o;a++){var c=n[a];this.sortBone(r[c])}}},e.prototype.sortBone=function(t){if(!t.sorted){var e=t.parent;null!=e&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}},e.prototype.sortReset=function(t){for(var e=0,i=t.length;e<i;e++){var n=t[e];n.active&&(n.sorted&&this.sortReset(n.children),n.sorted=!1)}},e.prototype.updateWorldTransform=function(){for(var t=this.updateCacheReset,e=0,i=t.length;e<i;e++){var n=t[e];n.ax=n.x,n.ay=n.y,n.arotation=n.rotation,n.ascaleX=n.scaleX,n.ascaleY=n.scaleY,n.ashearX=n.shearX,n.ashearY=n.shearY,n.appliedValid=!0}var r=this._updateCache;for(e=0,i=r.length;e<i;e++)r[e].update()},e.prototype.setToSetupPose=function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()},e.prototype.setBonesToSetupPose=function(){for(var t=this.bones,e=0,i=t.length;e<i;e++)t[e].setToSetupPose();var n=this.ikConstraints;for(e=0,i=n.length;e<i;e++)(o=n[e]).mix=o.data.mix,o.softness=o.data.softness,o.bendDirection=o.data.bendDirection,o.compress=o.data.compress,o.stretch=o.data.stretch;var r=this.transformConstraints;for(e=0,i=r.length;e<i;e++){var a=(o=r[e]).data;o.rotateMix=a.rotateMix,o.translateMix=a.translateMix,o.scaleMix=a.scaleMix,o.shearMix=a.shearMix}var s=this.pathConstraints;for(e=0,i=s.length;e<i;e++){var o;a=(o=s[e]).data,o.position=a.position,o.spacing=a.spacing,o.rotateMix=a.rotateMix,o.translateMix=a.translateMix}},e.prototype.setSlotsToSetupPose=function(){var e=this.slots;t.Utils.arrayCopy(e,0,this.drawOrder,0,e.length);for(var i=0,n=e.length;i<n;i++)e[i].setToSetupPose()},e.prototype.getRootBone=function(){return 0==this.bones.length?null:this.bones[0]},e.prototype.findBone=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,i=0,n=e.length;i<n;i++){var r=e[i];if(r.data.name==t)return r}return null},e.prototype.findBoneIndex=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,i=0,n=e.length;i<n;i++)if(e[i].data.name==t)return i;return-1},e.prototype.findSlot=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,i=0,n=e.length;i<n;i++){var r=e[i];if(r.data.name==t)return r}return null},e.prototype.findSlotIndex=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,i=0,n=e.length;i<n;i++)if(e[i].data.name==t)return i;return-1},e.prototype.setSkinByName=function(t){var e=this.data.findSkin(t);if(null==e)throw new Error("Skin not found: "+t);this.setSkin(e)},e.prototype.setSkin=function(t){if(t!=this.skin){if(null!=t)if(null!=this.skin)t.attachAll(this,this.skin);else for(var e=this.slots,i=0,n=e.length;i<n;i++){var r=e[i],a=r.data.attachmentName;if(null!=a){var s=t.getAttachment(i,a);null!=s&&r.setAttachment(s)}}this.skin=t,this.updateCache()}},e.prototype.getAttachmentByName=function(t,e){return this.getAttachment(this.data.findSlotIndex(t),e)},e.prototype.getAttachment=function(t,e){if(null==e)throw new Error("attachmentName cannot be null.");if(null!=this.skin){var i=this.skin.getAttachment(t,e);if(null!=i)return i}return null!=this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null},e.prototype.setAttachment=function(t,e){if(null==t)throw new Error("slotName cannot be null.");for(var i=this.slots,n=0,r=i.length;n<r;n++){var a=i[n];if(a.data.name==t){var s=null;if(null!=e&&null==(s=this.getAttachment(n,e)))throw new Error("Attachment not found: "+e+", for slot: "+t);return void a.setAttachment(s)}}throw new Error("Slot not found: "+t)},e.prototype.findIkConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,i=0,n=e.length;i<n;i++){var r=e[i];if(r.data.name==t)return r}return null},e.prototype.findTransformConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,i=0,n=e.length;i<n;i++){var r=e[i];if(r.data.name==t)return r}return null},e.prototype.findPathConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,i=0,n=e.length;i<n;i++){var r=e[i];if(r.data.name==t)return r}return null},e.prototype.getBounds=function(e,i,n){if(void 0===n&&(n=new Array(2)),null==e)throw new Error("offset cannot be null.");if(null==i)throw new Error("size cannot be null.");for(var r=this.drawOrder,a=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,c=Number.NEGATIVE_INFINITY,l=0,u=r.length;l<u;l++){var h=r[l];if(h.bone.active){var f=0,d=null,_=h.getAttachment();if(_ instanceof t.RegionAttachment)f=8,d=t.Utils.setArraySize(n,f,0),_.computeWorldVertices(h.bone,d,0,2);else if(_ instanceof t.MeshAttachment){var p=_;f=p.worldVerticesLength,d=t.Utils.setArraySize(n,f,0),p.computeWorldVertices(h,0,f,d,0,2)}if(null!=d)for(var m=0,v=d.length;m<v;m+=2){var g=d[m],y=d[m+1];a=Math.min(a,g),s=Math.min(s,y),o=Math.max(o,g),c=Math.max(c,y)}}}e.set(a,s),i.set(o-a,c-s)},e.prototype.update=function(t){this.time+=t},e})();t.Skeleton=e})(r||(r={})),(function(t){var e=(function(){function e(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}return e.prototype.readSkeletonData=function(n){var r=this.scale,a=new t.SkeletonData;a.name="";var s=new i(n);a.hash=s.readString(),a.version=s.readString(),a.x=s.readFloat(),a.y=s.readFloat(),a.width=s.readFloat(),a.height=s.readFloat();var o=s.readBoolean();o&&(a.fps=s.readFloat(),a.imagesPath=s.readString(),a.audioPath=s.readString());var c=0;c=s.readInt(!0);for(var l=0;l<c;l++)s.strings.push(s.readString());for(c=s.readInt(!0),l=0;l<c;l++){var u=s.readString(),h=0==l?null:a.bones[s.readInt(!0)];(_=new t.BoneData(l,u,h)).rotation=s.readFloat(),_.x=s.readFloat()*r,_.y=s.readFloat()*r,_.scaleX=s.readFloat(),_.scaleY=s.readFloat(),_.shearX=s.readFloat(),_.shearY=s.readFloat(),_.length=s.readFloat()*r,_.transformMode=e.TransformModeValues[s.readInt(!0)],_.skinRequired=s.readBoolean(),o&&t.Color.rgba8888ToColor(_.color,s.readInt32()),a.bones.push(_)}for(c=s.readInt(!0),l=0;l<c;l++){var f=s.readString(),d=a.bones[s.readInt(!0)],_=new t.SlotData(l,f,d);t.Color.rgba8888ToColor(_.color,s.readInt32());var p=s.readInt32();-1!=p&&t.Color.rgb888ToColor(_.darkColor=new t.Color,p),_.attachmentName=s.readStringRef(),_.blendMode=e.BlendModeValues[s.readInt(!0)],a.slots.push(_)}c=s.readInt(!0),l=0;for(var m=void 0;l<c;l++){(_=new t.IkConstraintData(s.readString())).order=s.readInt(!0),_.skinRequired=s.readBoolean(),m=s.readInt(!0);for(var v=0;v<m;v++)_.bones.push(a.bones[s.readInt(!0)]);_.target=a.bones[s.readInt(!0)],_.mix=s.readFloat(),_.softness=s.readFloat()*r,_.bendDirection=s.readByte(),_.compress=s.readBoolean(),_.stretch=s.readBoolean(),_.uniform=s.readBoolean(),a.ikConstraints.push(_)}for(c=s.readInt(!0),l=0,m=void 0;l<c;l++){for((_=new t.TransformConstraintData(s.readString())).order=s.readInt(!0),_.skinRequired=s.readBoolean(),m=s.readInt(!0),v=0;v<m;v++)_.bones.push(a.bones[s.readInt(!0)]);_.target=a.bones[s.readInt(!0)],_.local=s.readBoolean(),_.relative=s.readBoolean(),_.offsetRotation=s.readFloat(),_.offsetX=s.readFloat()*r,_.offsetY=s.readFloat()*r,_.offsetScaleX=s.readFloat(),_.offsetScaleY=s.readFloat(),_.offsetShearY=s.readFloat(),_.rotateMix=s.readFloat(),_.translateMix=s.readFloat(),_.scaleMix=s.readFloat(),_.shearMix=s.readFloat(),a.transformConstraints.push(_)}for(c=s.readInt(!0),l=0,m=void 0;l<c;l++){for((_=new t.PathConstraintData(s.readString())).order=s.readInt(!0),_.skinRequired=s.readBoolean(),m=s.readInt(!0),v=0;v<m;v++)_.bones.push(a.bones[s.readInt(!0)]);_.target=a.slots[s.readInt(!0)],_.positionMode=e.PositionModeValues[s.readInt(!0)],_.spacingMode=e.SpacingModeValues[s.readInt(!0)],_.rotateMode=e.RotateModeValues[s.readInt(!0)],_.offsetRotation=s.readFloat(),_.position=s.readFloat(),_.positionMode==t.PositionMode.Fixed&&(_.position*=r),_.spacing=s.readFloat(),_.spacingMode!=t.SpacingMode.Length&&_.spacingMode!=t.SpacingMode.Fixed||(_.spacing*=r),_.rotateMix=s.readFloat(),_.translateMix=s.readFloat(),a.pathConstraints.push(_)}var g=this.readSkin(s,a,!0,o);for(null!=g&&(a.defaultSkin=g,a.skins.push(g)),l=a.skins.length,t.Utils.setArraySize(a.skins,c=l+s.readInt(!0));l<c;l++)a.skins[l]=this.readSkin(s,a,!1,o);for(c=this.linkedMeshes.length,l=0;l<c;l++){var y=this.linkedMeshes[l],T=null==y.skin?a.defaultSkin:a.findSkin(y.skin);if(null==T)throw new Error("Skin not found: "+y.skin);var b=T.getAttachment(y.slotIndex,y.parent);if(null==b)throw new Error("Parent mesh not found: "+y.parent);y.mesh.deformAttachment=y.inheritDeform?b:y.mesh,y.mesh.setParentMesh(b),y.mesh.updateUVs()}for(this.linkedMeshes.length=0,c=s.readInt(!0),l=0;l<c;l++)(_=new t.EventData(s.readStringRef())).intValue=s.readInt(!1),_.floatValue=s.readFloat(),_.stringValue=s.readString(),_.audioPath=s.readString(),null!=_.audioPath&&(_.volume=s.readFloat(),_.balance=s.readFloat()),a.events.push(_);for(c=s.readInt(!0),l=0;l<c;l++)a.animations.push(this.readAnimation(s,s.readString(),a));return a},e.prototype.readSkin=function(e,i,n,r){var a=null,s=0;if(n){if(0==(s=e.readInt(!0)))return null;a=new t.Skin("default")}else{(a=new t.Skin(e.readStringRef())).bones.length=e.readInt(!0);for(var o=0,c=a.bones.length;o<c;o++)a.bones[o]=i.bones[e.readInt(!0)];for(o=0,c=e.readInt(!0);o<c;o++)a.constraints.push(i.ikConstraints[e.readInt(!0)]);for(o=0,c=e.readInt(!0);o<c;o++)a.constraints.push(i.transformConstraints[e.readInt(!0)]);for(o=0,c=e.readInt(!0);o<c;o++)a.constraints.push(i.pathConstraints[e.readInt(!0)]);s=e.readInt(!0)}for(o=0;o<s;o++)for(var l=e.readInt(!0),u=0,h=e.readInt(!0);u<h;u++){var f=e.readStringRef(),d=this.readAttachment(e,i,a,l,f,r);null!=d&&a.setAttachment(l,f,d)}return a},e.prototype.readAttachment=function(i,r,a,s,o,c){var l=this.scale,u=i.readStringRef();null==u&&(u=o);var h=i.readByte();switch(e.AttachmentTypeValues[h]){case t.AttachmentType.Region:var f=i.readStringRef(),d=i.readFloat(),_=i.readFloat(),p=i.readFloat(),m=i.readFloat(),v=i.readFloat(),g=i.readFloat(),y=i.readFloat(),T=i.readInt32();null==f&&(f=u);var b=this.attachmentLoader.newRegionAttachment(a,u,f);return null==b?null:(b.path=f,b.x=_*l,b.y=p*l,b.scaleX=m,b.scaleY=v,b.rotation=d,b.width=g*l,b.height=y*l,t.Color.rgba8888ToColor(b.color,T),b.updateOffset(),b);case t.AttachmentType.BoundingBox:var E=i.readInt(!0),A=this.readVertices(i,E),C=(T=c?i.readInt32():0,this.attachmentLoader.newBoundingBoxAttachment(a,u));return null==C?null:(C.worldVerticesLength=E<<1,C.vertices=A.vertices,C.bones=A.bones,c&&t.Color.rgba8888ToColor(C.color,T),C);case t.AttachmentType.Mesh:f=i.readStringRef(),T=i.readInt32(),E=i.readInt(!0);var x=this.readFloatArray(i,E<<1,1),S=this.readShortArray(i),w=(A=this.readVertices(i,E),i.readInt(!0)),M=null;return g=0,y=0,c&&(M=this.readShortArray(i),g=i.readFloat(),y=i.readFloat()),null==f&&(f=u),null==(R=this.attachmentLoader.newMeshAttachment(a,u,f))?null:(R.path=f,t.Color.rgba8888ToColor(R.color,T),R.bones=A.bones,R.vertices=A.vertices,R.worldVerticesLength=E<<1,R.triangles=S,R.regionUVs=x,R.updateUVs(),R.hullLength=w<<1,c&&(R.edges=M,R.width=g*l,R.height=y*l),R);case t.AttachmentType.LinkedMesh:f=i.readStringRef(),T=i.readInt32();var R,I=i.readStringRef(),O=i.readStringRef(),D=i.readBoolean();return g=0,y=0,c&&(g=i.readFloat(),y=i.readFloat()),null==f&&(f=u),null==(R=this.attachmentLoader.newMeshAttachment(a,u,f))?null:(R.path=f,t.Color.rgba8888ToColor(R.color,T),c&&(R.width=g*l,R.height=y*l),this.linkedMeshes.push(new n(R,I,s,O,D)),R);case t.AttachmentType.Path:for(var P=i.readBoolean(),L=i.readBoolean(),N=(E=i.readInt(!0),A=this.readVertices(i,E),t.Utils.newArray(E/3,0)),F=0,B=N.length;F<B;F++)N[F]=i.readFloat()*l;return T=c?i.readInt32():0,null==(f=this.attachmentLoader.newPathAttachment(a,u))?null:(f.closed=P,f.constantSpeed=L,f.worldVerticesLength=E<<1,f.vertices=A.vertices,f.bones=A.bones,f.lengths=N,c&&t.Color.rgba8888ToColor(f.color,T),f);case t.AttachmentType.Point:d=i.readFloat(),_=i.readFloat(),p=i.readFloat(),T=c?i.readInt32():0;var k=this.attachmentLoader.newPointAttachment(a,u);return null==k?null:(k.x=_*l,k.y=p*l,k.rotation=d,c&&t.Color.rgba8888ToColor(k.color,T),k);case t.AttachmentType.Clipping:var V=i.readInt(!0),z=(E=i.readInt(!0),A=this.readVertices(i,E),T=c?i.readInt32():0,this.attachmentLoader.newClippingAttachment(a,u));return null==z?null:(z.endSlot=r.slots[V],z.worldVerticesLength=E<<1,z.vertices=A.vertices,z.bones=A.bones,c&&t.Color.rgba8888ToColor(z.color,T),z)}return null},e.prototype.readVertices=function(e,i){var n=i<<1,a=new r,s=this.scale;if(!e.readBoolean())return a.vertices=this.readFloatArray(e,n,s),a;for(var o=new Array,c=new Array,l=0;l<i;l++){var u=e.readInt(!0);c.push(u);for(var h=0;h<u;h++)c.push(e.readInt(!0)),o.push(e.readFloat()*s),o.push(e.readFloat()*s),o.push(e.readFloat())}return a.vertices=t.Utils.toFloatArray(o),a.bones=c,a},e.prototype.readFloatArray=function(t,e,i){var n=new Array(e);if(1==i)for(var r=0;r<e;r++)n[r]=t.readFloat();else for(r=0;r<e;r++)n[r]=t.readFloat()*i;return n},e.prototype.readShortArray=function(t){for(var e=t.readInt(!0),i=new Array(e),n=0;n<e;n++)i[n]=t.readShort();return i},e.prototype.readAnimation=function(i,n,r){for(var a=new Array,s=this.scale,o=0,c=new t.Color,l=new t.Color,u=0,h=i.readInt(!0);u<h;u++)for(var f=i.readInt(!0),d=0,_=i.readInt(!0);d<_;d++){var p=i.readByte(),m=i.readInt(!0);switch(p){case e.SLOT_ATTACHMENT:(T=new t.AttachmentTimeline(m)).slotIndex=f;for(var v=0;v<m;v++)T.setFrame(v,i.readFloat(),i.readStringRef());a.push(T),o=Math.max(o,T.frames[m-1]);break;case e.SLOT_COLOR:for((T=new t.ColorTimeline(m)).slotIndex=f,v=0;v<m;v++){var g=i.readFloat();t.Color.rgba8888ToColor(c,i.readInt32()),T.setFrame(v,g,c.r,c.g,c.b,c.a),v<m-1&&this.readCurve(i,v,T)}a.push(T),o=Math.max(o,T.frames[(m-1)*t.ColorTimeline.ENTRIES]);break;case e.SLOT_TWO_COLOR:for((T=new t.TwoColorTimeline(m)).slotIndex=f,v=0;v<m;v++)g=i.readFloat(),t.Color.rgba8888ToColor(c,i.readInt32()),t.Color.rgb888ToColor(l,i.readInt32()),T.setFrame(v,g,c.r,c.g,c.b,c.a,l.r,l.g,l.b),v<m-1&&this.readCurve(i,v,T);a.push(T),o=Math.max(o,T.frames[(m-1)*t.TwoColorTimeline.ENTRIES])}}for(u=0,h=i.readInt(!0);u<h;u++){var y=i.readInt(!0);for(d=0,_=i.readInt(!0);d<_;d++)switch(p=i.readByte(),m=i.readInt(!0),p){case e.BONE_ROTATE:for((T=new t.RotateTimeline(m)).boneIndex=y,v=0;v<m;v++)T.setFrame(v,i.readFloat(),i.readFloat()),v<m-1&&this.readCurve(i,v,T);a.push(T),o=Math.max(o,T.frames[(m-1)*t.RotateTimeline.ENTRIES]);break;case e.BONE_TRANSLATE:case e.BONE_SCALE:case e.BONE_SHEAR:var T=void 0,b=1;for(p==e.BONE_SCALE?T=new t.ScaleTimeline(m):p==e.BONE_SHEAR?T=new t.ShearTimeline(m):(T=new t.TranslateTimeline(m),b=s),T.boneIndex=y,v=0;v<m;v++)T.setFrame(v,i.readFloat(),i.readFloat()*b,i.readFloat()*b),v<m-1&&this.readCurve(i,v,T);a.push(T),o=Math.max(o,T.frames[(m-1)*t.TranslateTimeline.ENTRIES])}}for(u=0,h=i.readInt(!0);u<h;u++){var E=i.readInt(!0);for(m=i.readInt(!0),(T=new t.IkConstraintTimeline(m)).ikConstraintIndex=E,v=0;v<m;v++)T.setFrame(v,i.readFloat(),i.readFloat(),i.readFloat()*s,i.readByte(),i.readBoolean(),i.readBoolean()),v<m-1&&this.readCurve(i,v,T);a.push(T),o=Math.max(o,T.frames[(m-1)*t.IkConstraintTimeline.ENTRIES])}for(u=0,h=i.readInt(!0);u<h;u++){for(E=i.readInt(!0),m=i.readInt(!0),(T=new t.TransformConstraintTimeline(m)).transformConstraintIndex=E,v=0;v<m;v++)T.setFrame(v,i.readFloat(),i.readFloat(),i.readFloat(),i.readFloat(),i.readFloat()),v<m-1&&this.readCurve(i,v,T);a.push(T),o=Math.max(o,T.frames[(m-1)*t.TransformConstraintTimeline.ENTRIES])}for(u=0,h=i.readInt(!0);u<h;u++){E=i.readInt(!0);var A=r.pathConstraints[E];for(d=0,_=i.readInt(!0);d<_;d++)switch(p=i.readByte(),m=i.readInt(!0),p){case e.PATH_POSITION:case e.PATH_SPACING:for(T=void 0,b=1,p==e.PATH_SPACING?(T=new t.PathConstraintSpacingTimeline(m),A.spacingMode!=t.SpacingMode.Length&&A.spacingMode!=t.SpacingMode.Fixed||(b=s)):(T=new t.PathConstraintPositionTimeline(m),A.positionMode==t.PositionMode.Fixed&&(b=s)),T.pathConstraintIndex=E,v=0;v<m;v++)T.setFrame(v,i.readFloat(),i.readFloat()*b),v<m-1&&this.readCurve(i,v,T);a.push(T),o=Math.max(o,T.frames[(m-1)*t.PathConstraintPositionTimeline.ENTRIES]);break;case e.PATH_MIX:for((T=new t.PathConstraintMixTimeline(m)).pathConstraintIndex=E,v=0;v<m;v++)T.setFrame(v,i.readFloat(),i.readFloat(),i.readFloat()),v<m-1&&this.readCurve(i,v,T);a.push(T),o=Math.max(o,T.frames[(m-1)*t.PathConstraintMixTimeline.ENTRIES])}}for(u=0,h=i.readInt(!0);u<h;u++){var C=r.skins[i.readInt(!0)];for(d=0,_=i.readInt(!0);d<_;d++){f=i.readInt(!0);for(var x=0,S=i.readInt(!0);x<S;x++){var w=C.getAttachment(f,i.readStringRef()),M=null!=w.bones,R=w.vertices,I=M?R.length/3*2:R.length;for(m=i.readInt(!0),(T=new t.DeformTimeline(m)).slotIndex=f,T.attachment=w,v=0;v<m;v++){g=i.readFloat();var O=void 0,D=i.readInt(!0);if(0==D)O=M?t.Utils.newFloatArray(I):R;else{O=t.Utils.newFloatArray(I);var P=i.readInt(!0);if(D+=P,1==s)for(var L=P;L<D;L++)O[L]=i.readFloat();else for(L=P;L<D;L++)O[L]=i.readFloat()*s;if(!M){L=0;for(var N=O.length;L<N;L++)O[L]+=R[L]}}T.setFrame(v,g,O),v<m-1&&this.readCurve(i,v,T)}a.push(T),o=Math.max(o,T.frames[m-1])}}}var F=i.readInt(!0);if(F>0){T=new t.DrawOrderTimeline(F);var B=r.slots.length;for(u=0;u<F;u++){g=i.readFloat();var k=i.readInt(!0),V=t.Utils.newArray(B,0);for(d=B-1;d>=0;d--)V[d]=-1;var z=t.Utils.newArray(B-k,0),U=0,H=0;for(d=0;d<k;d++){for(f=i.readInt(!0);U!=f;)z[H++]=U++;V[U+i.readInt(!0)]=U++}for(;U<B;)z[H++]=U++;for(d=B-1;d>=0;d--)-1==V[d]&&(V[d]=z[--H]);T.setFrame(u,g,V)}a.push(T),o=Math.max(o,T.frames[F-1])}var W=i.readInt(!0);if(W>0){for(T=new t.EventTimeline(W),u=0;u<W;u++){g=i.readFloat();var G=r.events[i.readInt(!0)],j=new t.Event(g,G);j.intValue=i.readInt(!1),j.floatValue=i.readFloat(),j.stringValue=i.readBoolean()?i.readString():G.stringValue,null!=j.data.audioPath&&(j.volume=i.readFloat(),j.balance=i.readFloat()),T.setFrame(u,j)}a.push(T),o=Math.max(o,T.frames[W-1])}return new t.Animation(n,a,o)},e.prototype.readCurve=function(t,i,n){switch(t.readByte()){case e.CURVE_STEPPED:n.setStepped(i);break;case e.CURVE_BEZIER:this.setCurve(n,i,t.readFloat(),t.readFloat(),t.readFloat(),t.readFloat())}},e.prototype.setCurve=function(t,e,i,n,r,a){t.setCurve(e,i,n,r,a)},e.AttachmentTypeValues=[0,1,2,3,4,5,6],e.TransformModeValues=[t.TransformMode.Normal,t.TransformMode.OnlyTranslation,t.TransformMode.NoRotationOrReflection,t.TransformMode.NoScale,t.TransformMode.NoScaleOrReflection],e.PositionModeValues=[t.PositionMode.Fixed,t.PositionMode.Percent],e.SpacingModeValues=[t.SpacingMode.Length,t.SpacingMode.Fixed,t.SpacingMode.Percent],e.RotateModeValues=[t.RotateMode.Tangent,t.RotateMode.Chain,t.RotateMode.ChainScale],e.BlendModeValues=[t.BlendMode.Normal,t.BlendMode.Additive,t.BlendMode.Multiply,t.BlendMode.Screen],e.BONE_ROTATE=0,e.BONE_TRANSLATE=1,e.BONE_SCALE=2,e.BONE_SHEAR=3,e.SLOT_ATTACHMENT=0,e.SLOT_COLOR=1,e.SLOT_TWO_COLOR=2,e.PATH_POSITION=0,e.PATH_SPACING=1,e.PATH_MIX=2,e.CURVE_LINEAR=0,e.CURVE_STEPPED=1,e.CURVE_BEZIER=2,e})();t.SkeletonBinary=e;var i=(function(){function t(t,e,i,n){void 0===e&&(e=new Array),void 0===i&&(i=0),void 0===n&&(n=new DataView(t.buffer)),this.strings=e,this.index=i,this.buffer=n}return t.prototype.readByte=function(){return this.buffer.getInt8(this.index++)},t.prototype.readShort=function(){var t=this.buffer.getInt16(this.index);return this.index+=2,t},t.prototype.readInt32=function(){var t=this.buffer.getInt32(this.index);return this.index+=4,t},t.prototype.readInt=function(t){var e=this.readByte(),i=127&e;return 0!=(128&e)&&(i|=(127&(e=this.readByte()))<<7,0!=(128&e)&&(i|=(127&(e=this.readByte()))<<14,0!=(128&e)&&(i|=(127&(e=this.readByte()))<<21,0!=(128&e)&&(i|=(127&(e=this.readByte()))<<28)))),t?i:i>>>1^-(1&i)},t.prototype.readStringRef=function(){var t=this.readInt(!0);return 0==t?null:this.strings[t-1]},t.prototype.readString=function(){var t=this.readInt(!0);switch(t){case 0:return null;case 1:return""}t--;for(var e="",i=0;i<t;){var n=this.readByte();switch(n>>4){case 12:case 13:e+=String.fromCharCode((31&n)<<6|63&this.readByte()),i+=2;break;case 14:e+=String.fromCharCode((15&n)<<12|(63&this.readByte())<<6|63&this.readByte()),i+=3;break;default:e+=String.fromCharCode(n),i++}}return e},t.prototype.readFloat=function(){var t=this.buffer.getFloat32(this.index);return this.index+=4,t},t.prototype.readBoolean=function(){return 0!=this.readByte()},t})(),n=function(t,e,i,n,r){this.mesh=t,this.skin=e,this.slotIndex=i,this.parent=n,this.inheritDeform=r},r=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.bones=t,this.vertices=e}})(r||(r={})),(function(t){var e=(function(){function e(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.boundingBoxes=new Array,this.polygons=new Array,this.polygonPool=new t.Pool(function(){return t.Utils.newFloatArray(16)})}return e.prototype.update=function(e,i){if(null==e)throw new Error("skeleton cannot be null.");var n=this.boundingBoxes,r=this.polygons,a=this.polygonPool,s=e.slots,o=s.length;n.length=0,a.freeAll(r),r.length=0;for(var c=0;c<o;c++){var l=s[c];if(l.bone.active){var u=l.getAttachment();if(u instanceof t.BoundingBoxAttachment){var h=u;n.push(h);var f=a.obtain();f.length!=h.worldVerticesLength&&(f=t.Utils.newFloatArray(h.worldVerticesLength)),r.push(f),h.computeWorldVertices(l,0,h.worldVerticesLength,f,0,2)}}}i?this.aabbCompute():(this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY)},e.prototype.aabbCompute=function(){for(var t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,n=Number.NEGATIVE_INFINITY,r=this.polygons,a=0,s=r.length;a<s;a++)for(var o=r[a],c=o,l=0,u=o.length;l<u;l+=2){var h=c[l],f=c[l+1];t=Math.min(t,h),e=Math.min(e,f),i=Math.max(i,h),n=Math.max(n,f)}this.minX=t,this.minY=e,this.maxX=i,this.maxY=n},e.prototype.aabbContainsPoint=function(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY},e.prototype.aabbIntersectsSegment=function(t,e,i,n){var r=this.minX,a=this.minY,s=this.maxX,o=this.maxY;if(t<=r&&i<=r||e<=a&&n<=a||t>=s&&i>=s||e>=o&&n>=o)return!1;var c=(n-e)/(i-t),l=c*(r-t)+e;if(l>a&&l<o)return!0;if((l=c*(s-t)+e)>a&&l<o)return!0;var u=(a-e)/c+t;return u>r&&u<s||(u=(o-e)/c+t)>r&&u<s},e.prototype.aabbIntersectsSkeleton=function(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY},e.prototype.containsPoint=function(t,e){for(var i=this.polygons,n=0,r=i.length;n<r;n++)if(this.containsPointPolygon(i[n],t,e))return this.boundingBoxes[n];return null},e.prototype.containsPointPolygon=function(t,e,i){for(var n=t,r=t.length,a=r-2,s=!1,o=0;o<r;o+=2){var c=n[o+1],l=n[a+1];if(c<i&&l>=i||l<i&&c>=i){var u=n[o];u+(i-c)/(l-c)*(n[a]-u)<e&&(s=!s)}a=o}return s},e.prototype.intersectsSegment=function(t,e,i,n){for(var r=this.polygons,a=0,s=r.length;a<s;a++)if(this.intersectsSegmentPolygon(r[a],t,e,i,n))return this.boundingBoxes[a];return null},e.prototype.intersectsSegmentPolygon=function(t,e,i,n,r){for(var a=t,s=t.length,o=e-n,c=i-r,l=e*r-i*n,u=a[s-2],h=a[s-1],f=0;f<s;f+=2){var d=a[f],_=a[f+1],p=u*_-h*d,m=u-d,v=h-_,g=o*v-c*m,y=(l*m-o*p)/g;if((y>=u&&y<=d||y>=d&&y<=u)&&(y>=e&&y<=n||y>=n&&y<=e)){var T=(l*v-c*p)/g;if((T>=h&&T<=_||T>=_&&T<=h)&&(T>=i&&T<=r||T>=r&&T<=i))return!0}u=d,h=_}return!1},e.prototype.getPolygon=function(t){if(null==t)throw new Error("boundingBox cannot be null.");var e=this.boundingBoxes.indexOf(t);return-1==e?null:this.polygons[e]},e.prototype.getWidth=function(){return this.maxX-this.minX},e.prototype.getHeight=function(){return this.maxY-this.minY},e})();t.SkeletonBounds=e})(r||(r={})),(function(t){var e=(function(){function e(){this.triangulator=new t.Triangulator,this.clippingPolygon=new Array,this.clipOutput=new Array,this.clippedVertices=new Array,this.clippedTriangles=new Array,this.scratch=new Array}return e.prototype.clipStart=function(i,n){if(null!=this.clipAttachment)return 0;this.clipAttachment=n;var r=n.worldVerticesLength,a=t.Utils.setArraySize(this.clippingPolygon,r);n.computeWorldVertices(i,0,r,a,0,2);var s=this.clippingPolygon;e.makeClockwise(s);for(var o=this.clippingPolygons=this.triangulator.decompose(s,this.triangulator.triangulate(s)),c=0,l=o.length;c<l;c++){var u=o[c];e.makeClockwise(u),u.push(u[0]),u.push(u[1])}return o.length},e.prototype.clipEndWithSlot=function(t){null!=this.clipAttachment&&this.clipAttachment.endSlot==t.data&&this.clipEnd()},e.prototype.clipEnd=function(){null!=this.clipAttachment&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)},e.prototype.isClipping=function(){return null!=this.clipAttachment},e.prototype.clipTriangles=function(e,i,n,r,a,s,o,c,l,u,h,f){var d=this.clipOutput,_=this.clippedVertices,p=this.clippedTriangles,m=this.clippingPolygons,v=this.clippingPolygons.length,g=c?12:8,y=0;u=u||0,h=h||0,f=f||0,_.length=0,p.length=0;t:for(var T=u,b=u+r;T<b;T+=3){var E=n[T]*l,A=E+h,C=E+f,x=e[A],S=e[A+1],w=a[C],M=a[C+1];C=(E=n[T+1]*l)+f;var R=e[A=E+h],I=e[A+1],O=a[C],D=a[C+1];C=(E=n[T+2]*l)+f;for(var P=e[A=E+h],L=e[A+1],N=a[C],F=a[C+1],B=0;B<v;B++){var k=_.length;if(!this.clip(x,S,R,I,P,L,m[B],d)){(X=t.Utils.setArraySize(_,k+3*g))[k]=x,X[k+1]=S,X[k+2]=s.r,X[k+3]=s.g,X[k+4]=s.b,X[k+5]=s.a,c?(X[k+6]=w,X[k+7]=M,X[k+8]=o.r,X[k+9]=o.g,X[k+10]=o.b,X[k+11]=o.a,X[k+12]=R,X[k+13]=I,X[k+14]=s.r,X[k+15]=s.g,X[k+16]=s.b,X[k+17]=s.a,X[k+18]=O,X[k+19]=D,X[k+20]=o.r,X[k+21]=o.g,X[k+22]=o.b,X[k+23]=o.a,X[k+24]=P,X[k+25]=L,X[k+26]=s.r,X[k+27]=s.g,X[k+28]=s.b,X[k+29]=s.a,X[k+30]=N,X[k+31]=F,X[k+32]=o.r,X[k+33]=o.g,X[k+34]=o.b,X[k+35]=o.a):(X[k+6]=w,X[k+7]=M,X[k+8]=R,X[k+9]=I,X[k+10]=s.r,X[k+11]=s.g,X[k+12]=s.b,X[k+13]=s.a,X[k+14]=O,X[k+15]=D,X[k+16]=P,X[k+17]=L,X[k+18]=s.r,X[k+19]=s.g,X[k+20]=s.b,X[k+21]=s.a,X[k+22]=N,X[k+23]=F),k=p.length,(it=t.Utils.setArraySize(p,k+3))[k]=y,it[k+1]=y+1,it[k+2]=y+2,y+=3;continue t}var V=d.length;if(0!=V){for(var z=I-L,U=P-R,H=x-P,W=L-S,G=1/(z*H+U*(S-L)),j=V>>1,Y=this.clipOutput,X=t.Utils.setArraySize(_,k+j*g),q=0;q<V;q+=2){var Z=Y[q],K=Y[q+1];X[k]=Z,X[k+1]=K,X[k+2]=s.r,X[k+3]=s.g,X[k+4]=s.b,X[k+5]=s.a;var Q=Z-P,J=K-L,$=(z*Q+U*J)*G,tt=(W*Q+H*J)*G,et=1-$-tt;X[k+6]=w*$+O*tt+N*et,X[k+7]=M*$+D*tt+F*et,c&&(X[k+8]=o.r,X[k+9]=o.g,X[k+10]=o.b,X[k+11]=o.a),k+=g}k=p.length;var it=t.Utils.setArraySize(p,k+3*(j-2));for(j--,q=1;q<j;q++)it[k]=y,it[k+1]=y+q,it[k+2]=y+q+1,k+=3;y+=j+1}}}},e.prototype.clip=function(t,e,i,n,r,a,s,o){var c=o,l=!1,u=null;s.length%4>=2?(u=o,o=this.scratch):u=this.scratch,u.length=0,u.push(t),u.push(e),u.push(i),u.push(n),u.push(r),u.push(a),u.push(t),u.push(e),o.length=0;for(var h=s,f=s.length-4,d=0;;d+=2){for(var _=h[d],p=h[d+1],m=h[d+2],v=h[d+3],g=_-m,y=p-v,T=u,b=u.length-2,E=o.length,A=0;A<b;A+=2){var C=T[A],x=T[A+1],S=T[A+2],w=T[A+3],M=g*(w-v)-y*(S-m)>0;if(g*(x-v)-y*(C-m)>0){if(M){o.push(S),o.push(w);continue}var R=(O=w-x)*(m-_)-(D=S-C)*(v-p);if(Math.abs(R)>1e-6){var I=(D*(p-x)-O*(_-C))/R;o.push(_+(m-_)*I),o.push(p+(v-p)*I)}else o.push(_),o.push(p)}else if(M){var O,D;R=(O=w-x)*(m-_)-(D=S-C)*(v-p),Math.abs(R)>1e-6?(I=(D*(p-x)-O*(_-C))/R,o.push(_+(m-_)*I),o.push(p+(v-p)*I)):(o.push(_),o.push(p)),o.push(S),o.push(w)}l=!0}if(E==o.length)return c.length=0,!0;if(o.push(o[0]),o.push(o[1]),d==f)break;var P=o;(o=u).length=0,u=P}if(c!=o){c.length=0,d=0;for(var L=o.length-2;d<L;d++)c[d]=o[d]}else c.length=c.length-2;return l},e.makeClockwise=function(t){for(var e=t,i=t.length,n=e[i-2]*e[1]-e[0]*e[i-1],r=0,a=0,s=0,o=0,c=i-3;o<c;o+=2)r=e[o],a=e[o+1],s=e[o+2],n+=r*e[o+3]-s*a;if(!(n<0)){o=0;var l=i-2;for(c=i>>1;o<c;o+=2){var u=e[o],h=e[o+1],f=l-o;e[o]=e[f],e[o+1]=e[f+1],e[f]=u,e[f+1]=h}}},e})();t.SkeletonClipping=e})(r||(r={})),(function(t){var e=(function(){function t(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}return t.prototype.findBone=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,i=0,n=e.length;i<n;i++){var r=e[i];if(r.name==t)return r}return null},t.prototype.findBoneIndex=function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,i=0,n=e.length;i<n;i++)if(e[i].name==t)return i;return-1},t.prototype.findSlot=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,i=0,n=e.length;i<n;i++){var r=e[i];if(r.name==t)return r}return null},t.prototype.findSlotIndex=function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,i=0,n=e.length;i<n;i++)if(e[i].name==t)return i;return-1},t.prototype.findSkin=function(t){if(null==t)throw new Error("skinName cannot be null.");for(var e=this.skins,i=0,n=e.length;i<n;i++){var r=e[i];if(r.name==t)return r}return null},t.prototype.findEvent=function(t){if(null==t)throw new Error("eventDataName cannot be null.");for(var e=this.events,i=0,n=e.length;i<n;i++){var r=e[i];if(r.name==t)return r}return null},t.prototype.findAnimation=function(t){if(null==t)throw new Error("animationName cannot be null.");for(var e=this.animations,i=0,n=e.length;i<n;i++){var r=e[i];if(r.name==t)return r}return null},t.prototype.findIkConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,i=0,n=e.length;i<n;i++){var r=e[i];if(r.name==t)return r}return null},t.prototype.findTransformConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,i=0,n=e.length;i<n;i++){var r=e[i];if(r.name==t)return r}return null},t.prototype.findPathConstraint=function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,i=0,n=e.length;i<n;i++){var r=e[i];if(r.name==t)return r}return null},t.prototype.findPathConstraintIndex=function(t){if(null==t)throw new Error("pathConstraintName cannot be null.");for(var e=this.pathConstraints,i=0,n=e.length;i<n;i++)if(e[i].name==t)return i;return-1},t})();t.SkeletonData=e})(r||(r={})),(function(t){var e=(function(){function e(t){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=t}return e.prototype.readSkeletonData=function(i){var n=this.scale,r=new t.SkeletonData,a="string"==typeof i?JSON.parse(i):i,s=a.skeleton;if(null!=s&&(r.hash=s.hash,r.version=s.spine,r.x=s.x,r.y=s.y,r.width=s.width,r.height=s.height,r.fps=s.fps,r.imagesPath=s.images),a.bones)for(var o=0;o<a.bones.length;o++){var c=a.bones[o],l=null,u=this.getValue(c,"parent",null);if(null!=u&&null==(l=r.findBone(u)))throw new Error("Parent bone not found: "+u);(_=new t.BoneData(r.bones.length,c.name,l)).length=this.getValue(c,"length",0)*n,_.x=this.getValue(c,"x",0)*n,_.y=this.getValue(c,"y",0)*n,_.rotation=this.getValue(c,"rotation",0),_.scaleX=this.getValue(c,"scaleX",1),_.scaleY=this.getValue(c,"scaleY",1),_.shearX=this.getValue(c,"shearX",0),_.shearY=this.getValue(c,"shearY",0),_.transformMode=e.transformModeFromString(this.getValue(c,"transform","normal")),_.skinRequired=this.getValue(c,"skin",!1),r.bones.push(_)}if(a.slots)for(o=0;o<a.slots.length;o++){var h=(R=a.slots[o]).name,f=R.bone,d=r.findBone(f);if(null==d)throw new Error("Slot bone not found: "+f);var _=new t.SlotData(r.slots.length,h,d),p=this.getValue(R,"color",null);null!=p&&_.color.setFromString(p);var m=this.getValue(R,"dark",null);null!=m&&(_.darkColor=new t.Color(1,1,1,1),_.darkColor.setFromString(m)),_.attachmentName=this.getValue(R,"attachment",null),_.blendMode=e.blendModeFromString(this.getValue(R,"blend","normal")),r.slots.push(_)}if(a.ik)for(o=0;o<a.ik.length;o++){var v=a.ik[o];(_=new t.IkConstraintData(v.name)).order=this.getValue(v,"order",0),_.skinRequired=this.getValue(v,"skin",!1);for(var g=0;g<v.bones.length;g++){if(f=v.bones[g],null==(S=r.findBone(f)))throw new Error("IK bone not found: "+f);_.bones.push(S)}var y=v.target;if(_.target=r.findBone(y),null==_.target)throw new Error("IK target bone not found: "+y);_.mix=this.getValue(v,"mix",1),_.softness=this.getValue(v,"softness",0)*n,_.bendDirection=this.getValue(v,"bendPositive",!0)?1:-1,_.compress=this.getValue(v,"compress",!1),_.stretch=this.getValue(v,"stretch",!1),_.uniform=this.getValue(v,"uniform",!1),r.ikConstraints.push(_)}if(a.transform)for(o=0;o<a.transform.length;o++){for(v=a.transform[o],(_=new t.TransformConstraintData(v.name)).order=this.getValue(v,"order",0),_.skinRequired=this.getValue(v,"skin",!1),g=0;g<v.bones.length;g++){if(f=v.bones[g],null==(S=r.findBone(f)))throw new Error("Transform constraint bone not found: "+f);_.bones.push(S)}if(y=v.target,_.target=r.findBone(y),null==_.target)throw new Error("Transform constraint target bone not found: "+y);_.local=this.getValue(v,"local",!1),_.relative=this.getValue(v,"relative",!1),_.offsetRotation=this.getValue(v,"rotation",0),_.offsetX=this.getValue(v,"x",0)*n,_.offsetY=this.getValue(v,"y",0)*n,_.offsetScaleX=this.getValue(v,"scaleX",0),_.offsetScaleY=this.getValue(v,"scaleY",0),_.offsetShearY=this.getValue(v,"shearY",0),_.rotateMix=this.getValue(v,"rotateMix",1),_.translateMix=this.getValue(v,"translateMix",1),_.scaleMix=this.getValue(v,"scaleMix",1),_.shearMix=this.getValue(v,"shearMix",1),r.transformConstraints.push(_)}if(a.path)for(o=0;o<a.path.length;o++){for(v=a.path[o],(_=new t.PathConstraintData(v.name)).order=this.getValue(v,"order",0),_.skinRequired=this.getValue(v,"skin",!1),g=0;g<v.bones.length;g++){if(f=v.bones[g],null==(S=r.findBone(f)))throw new Error("Transform constraint bone not found: "+f);_.bones.push(S)}if(y=v.target,_.target=r.findSlot(y),null==_.target)throw new Error("Path target slot not found: "+y);_.positionMode=e.positionModeFromString(this.getValue(v,"positionMode","percent")),_.spacingMode=e.spacingModeFromString(this.getValue(v,"spacingMode","length")),_.rotateMode=e.rotateModeFromString(this.getValue(v,"rotateMode","tangent")),_.offsetRotation=this.getValue(v,"rotation",0),_.position=this.getValue(v,"position",0),_.positionMode==t.PositionMode.Fixed&&(_.position*=n),_.spacing=this.getValue(v,"spacing",0),_.spacingMode!=t.SpacingMode.Length&&_.spacingMode!=t.SpacingMode.Fixed||(_.spacing*=n),_.rotateMix=this.getValue(v,"rotateMix",1),_.translateMix=this.getValue(v,"translateMix",1),r.pathConstraints.push(_)}if(a.skins){var T=a.skins;if(!(T instanceof Array)){var b=[];for(var E in T)b.push({name:E,attachments:T[E]});T=b}for(o=0;o<T.length;o++){var A=T[o],C=new t.Skin(A.name);if(A.bones)for(var x=0;x<A.bones.length;x++){var S;if(null==(S=r.findBone(A.bones[x])))throw new Error("Skin bone not found: "+A.bones[o]);C.bones.push(S)}if(A.ik)for(x=0;x<A.ik.length;x++){if(null==(w=r.findIkConstraint(A.ik[x])))throw new Error("Skin IK constraint not found: "+A.ik[o]);C.constraints.push(w)}if(A.transform)for(x=0;x<A.transform.length;x++){if(null==(w=r.findTransformConstraint(A.transform[x])))throw new Error("Skin transform constraint not found: "+A.transform[o]);C.constraints.push(w)}if(A.path)for(x=0;x<A.path.length;x++){var w;if(null==(w=r.findPathConstraint(A.path[x])))throw new Error("Skin path constraint not found: "+A.path[o]);C.constraints.push(w)}for(var h in A.attachments){var M=r.findSlot(h);if(null==M)throw new Error("Slot not found: "+h);var R=A.attachments[h];for(var I in R){var O=this.readAttachment(R[I],C,M.index,I,r);null!=O&&C.setAttachment(M.index,I,O)}}r.skins.push(C),"default"==C.name&&(r.defaultSkin=C)}}o=0;for(var D=this.linkedMeshes.length;o<D;o++){var P=this.linkedMeshes[o];if(null==(C=null==P.skin?r.defaultSkin:r.findSkin(P.skin)))throw new Error("Skin not found: "+P.skin);var L=C.getAttachment(P.slotIndex,P.parent);if(null==L)throw new Error("Parent mesh not found: "+P.parent);P.mesh.deformAttachment=P.inheritDeform?L:P.mesh,P.mesh.setParentMesh(L),P.mesh.updateUVs()}if(this.linkedMeshes.length=0,a.events)for(var N in a.events){var F=a.events[N];(_=new t.EventData(N)).intValue=this.getValue(F,"int",0),_.floatValue=this.getValue(F,"float",0),_.stringValue=this.getValue(F,"string",""),_.audioPath=this.getValue(F,"audio",null),null!=_.audioPath&&(_.volume=this.getValue(F,"volume",1),_.balance=this.getValue(F,"balance",0)),r.events.push(_)}if(a.animations)for(var B in a.animations){var k=a.animations[B];this.readAnimation(k,B,r)}return r},e.prototype.readAttachment=function(e,n,r,a,s){var o=this.scale;switch(a=this.getValue(e,"name",a),this.getValue(e,"type","region")){case"region":var c=this.getValue(e,"path",a),l=this.attachmentLoader.newRegionAttachment(n,a,c);return null==l?null:(l.path=c,l.x=this.getValue(e,"x",0)*o,l.y=this.getValue(e,"y",0)*o,l.scaleX=this.getValue(e,"scaleX",1),l.scaleY=this.getValue(e,"scaleY",1),l.rotation=this.getValue(e,"rotation",0),l.width=e.width*o,l.height=e.height*o,null!=(y=this.getValue(e,"color",null))&&l.color.setFromString(y),l.updateOffset(),l);case"boundingbox":var u=this.attachmentLoader.newBoundingBoxAttachment(n,a);return null==u?null:(this.readVertices(e,u,e.vertexCount<<1),null!=(y=this.getValue(e,"color",null))&&u.color.setFromString(y),u);case"mesh":case"linkedmesh":c=this.getValue(e,"path",a);var h=this.attachmentLoader.newMeshAttachment(n,a,c);if(null==h)return null;h.path=c,null!=(y=this.getValue(e,"color",null))&&h.color.setFromString(y),h.width=this.getValue(e,"width",0)*o,h.height=this.getValue(e,"height",0)*o;var f=this.getValue(e,"parent",null);if(null!=f)return this.linkedMeshes.push(new i(h,this.getValue(e,"skin",null),r,f,this.getValue(e,"deform",!0))),h;var d=e.uvs;return this.readVertices(e,h,d.length),h.triangles=e.triangles,h.regionUVs=d,h.updateUVs(),h.edges=this.getValue(e,"edges",null),h.hullLength=2*this.getValue(e,"hull",0),h;case"path":if(null==(c=this.attachmentLoader.newPathAttachment(n,a)))return null;c.closed=this.getValue(e,"closed",!1),c.constantSpeed=this.getValue(e,"constantSpeed",!0);var _=e.vertexCount;this.readVertices(e,c,_<<1);for(var p=t.Utils.newArray(_/3,0),m=0;m<e.lengths.length;m++)p[m]=e.lengths[m]*o;return c.lengths=p,null!=(y=this.getValue(e,"color",null))&&c.color.setFromString(y),c;case"point":var v=this.attachmentLoader.newPointAttachment(n,a);return null==v?null:(v.x=this.getValue(e,"x",0)*o,v.y=this.getValue(e,"y",0)*o,v.rotation=this.getValue(e,"rotation",0),null!=(y=this.getValue(e,"color",null))&&v.color.setFromString(y),v);case"clipping":var g=this.attachmentLoader.newClippingAttachment(n,a);if(null==g)return null;var y,T=this.getValue(e,"end",null);if(null!=T){var b=s.findSlot(T);if(null==b)throw new Error("Clipping end slot not found: "+T);g.endSlot=b}return _=e.vertexCount,this.readVertices(e,g,_<<1),null!=(y=this.getValue(e,"color",null))&&g.color.setFromString(y),g}return null},e.prototype.readVertices=function(e,i,n){var r=this.scale;i.worldVerticesLength=n;var a=e.vertices;if(n!=a.length){var s=new Array,o=new Array;for(h=0,f=a.length;h<f;){var c=a[h++];o.push(c);for(var l=h+4*c;h<l;h+=4)o.push(a[h]),s.push(a[h+1]*r),s.push(a[h+2]*r),s.push(a[h+3])}i.bones=o,i.vertices=t.Utils.toFloatArray(s)}else{var u=t.Utils.toFloatArray(a);if(1!=r)for(var h=0,f=a.length;h<f;h++)u[h]*=r;i.vertices=u}},e.prototype.readAnimation=function(e,i,n){var r=this.scale,a=new Array,s=0;if(e.slots)for(var o in e.slots){var c=e.slots[o];if(-1==(Q=n.findSlotIndex(o)))throw new Error("Slot not found: "+o);for(var l in c){var u=c[l];if("attachment"==l){(T=new t.AttachmentTimeline(u.length)).slotIndex=Q;for(var h=0,f=0;f<u.length;f++){var d=u[f];T.setFrame(h++,this.getValue(d,"time",0),d.name)}a.push(T),s=Math.max(s,T.frames[T.getFrameCount()-1])}else if("color"==l){for((T=new t.ColorTimeline(u.length)).slotIndex=Q,h=0,f=0;f<u.length;f++){d=u[f];var _=new t.Color;_.setFromString(d.color),T.setFrame(h,this.getValue(d,"time",0),_.r,_.g,_.b,_.a),this.readCurve(d,T,h),h++}a.push(T),s=Math.max(s,T.frames[(T.getFrameCount()-1)*t.ColorTimeline.ENTRIES])}else{if("twoColor"!=l)throw new Error("Invalid timeline type for a slot: "+l+" ("+o+")");for((T=new t.TwoColorTimeline(u.length)).slotIndex=Q,h=0,f=0;f<u.length;f++){d=u[f];var p=new t.Color,m=new t.Color;p.setFromString(d.light),m.setFromString(d.dark),T.setFrame(h,this.getValue(d,"time",0),p.r,p.g,p.b,p.a,m.r,m.g,m.b),this.readCurve(d,T,h),h++}a.push(T),s=Math.max(s,T.frames[(T.getFrameCount()-1)*t.TwoColorTimeline.ENTRIES])}}}if(e.bones)for(var v in e.bones){var g=e.bones[v],y=n.findBoneIndex(v);if(-1==y)throw new Error("Bone not found: "+v);for(var l in g)if(u=g[l],"rotate"===l){for((T=new t.RotateTimeline(u.length)).boneIndex=y,h=0,f=0;f<u.length;f++)d=u[f],T.setFrame(h,this.getValue(d,"time",0),this.getValue(d,"angle",0)),this.readCurve(d,T,h),h++;a.push(T),s=Math.max(s,T.frames[(T.getFrameCount()-1)*t.RotateTimeline.ENTRIES])}else{if("translate"!==l&&"scale"!==l&&"shear"!==l)throw new Error("Invalid timeline type for a bone: "+l+" ("+v+")");var T=null,b=1,E=0;for("scale"===l?(T=new t.ScaleTimeline(u.length),E=1):"shear"===l?T=new t.ShearTimeline(u.length):(T=new t.TranslateTimeline(u.length),b=r),T.boneIndex=y,h=0,f=0;f<u.length;f++){d=u[f];var A=this.getValue(d,"x",E),C=this.getValue(d,"y",E);T.setFrame(h,this.getValue(d,"time",0),A*b,C*b),this.readCurve(d,T,h),h++}a.push(T),s=Math.max(s,T.frames[(T.getFrameCount()-1)*t.TranslateTimeline.ENTRIES])}}if(e.ik)for(var x in e.ik){var S=e.ik[x],w=n.findIkConstraint(x);for((T=new t.IkConstraintTimeline(S.length)).ikConstraintIndex=n.ikConstraints.indexOf(w),h=0,f=0;f<S.length;f++)d=S[f],T.setFrame(h,this.getValue(d,"time",0),this.getValue(d,"mix",1),this.getValue(d,"softness",0)*r,this.getValue(d,"bendPositive",!0)?1:-1,this.getValue(d,"compress",!1),this.getValue(d,"stretch",!1)),this.readCurve(d,T,h),h++;a.push(T),s=Math.max(s,T.frames[(T.getFrameCount()-1)*t.IkConstraintTimeline.ENTRIES])}if(e.transform)for(var x in e.transform){for(S=e.transform[x],w=n.findTransformConstraint(x),(T=new t.TransformConstraintTimeline(S.length)).transformConstraintIndex=n.transformConstraints.indexOf(w),h=0,f=0;f<S.length;f++)d=S[f],T.setFrame(h,this.getValue(d,"time",0),this.getValue(d,"rotateMix",1),this.getValue(d,"translateMix",1),this.getValue(d,"scaleMix",1),this.getValue(d,"shearMix",1)),this.readCurve(d,T,h),h++;a.push(T),s=Math.max(s,T.frames[(T.getFrameCount()-1)*t.TransformConstraintTimeline.ENTRIES])}var M=e.path||e.paths;if(M)for(var x in M){S=M[x];var R=n.findPathConstraintIndex(x);if(-1==R)throw new Error("Path constraint not found: "+x);var I=n.pathConstraints[R];for(var l in S)if(u=S[l],"position"===l||"spacing"===l){for(T=null,b=1,"spacing"===l?(T=new t.PathConstraintSpacingTimeline(u.length),I.spacingMode!=t.SpacingMode.Length&&I.spacingMode!=t.SpacingMode.Fixed||(b=r)):(T=new t.PathConstraintPositionTimeline(u.length),I.positionMode==t.PositionMode.Fixed&&(b=r)),T.pathConstraintIndex=R,h=0,f=0;f<u.length;f++)d=u[f],T.setFrame(h,this.getValue(d,"time",0),this.getValue(d,l,0)*b),this.readCurve(d,T,h),h++;a.push(T),s=Math.max(s,T.frames[(T.getFrameCount()-1)*t.PathConstraintPositionTimeline.ENTRIES])}else if("mix"===l){for((T=new t.PathConstraintMixTimeline(u.length)).pathConstraintIndex=R,h=0,f=0;f<u.length;f++)d=u[f],T.setFrame(h,this.getValue(d,"time",0),this.getValue(d,"rotateMix",1),this.getValue(d,"translateMix",1)),this.readCurve(d,T,h),h++;a.push(T),s=Math.max(s,T.frames[(T.getFrameCount()-1)*t.PathConstraintMixTimeline.ENTRIES])}}if(e.deform)for(var O in e.deform){var D=e.deform[O],P=n.findSkin(O);if(null==P)throw new Error("Skin not found: "+O);for(var o in D){if(c=D[o],-1==(Q=n.findSlotIndex(o)))throw new Error("Slot not found: "+c.name);for(var l in c){u=c[l];var L=P.getAttachment(Q,l);if(null!=L){var N=null!=L.bones,F=L.vertices,B=N?F.length/3*2:F.length;(T=new t.DeformTimeline(u.length)).slotIndex=Q,T.attachment=L,h=0;for(var k=0;k<u.length;k++){d=u[k];var V=void 0,z=this.getValue(d,"vertices",null);if(null==z)V=N?t.Utils.newFloatArray(B):F;else{V=t.Utils.newFloatArray(B);var U=this.getValue(d,"offset",0);if(t.Utils.arrayCopy(z,0,V,U,z.length),1!=r)for(var H=(f=U)+z.length;f<H;f++)V[f]*=r;if(!N)for(f=0;f<B;f++)V[f]+=F[f]}T.setFrame(h,this.getValue(d,"time",0),V),this.readCurve(d,T,h),h++}a.push(T),s=Math.max(s,T.frames[T.getFrameCount()-1])}}}}var W=e.drawOrder;if(null==W&&(W=e.draworder),null!=W){T=new t.DrawOrderTimeline(W.length);var G=n.slots.length;for(h=0,k=0;k<W.length;k++){var j=W[k],Y=null,X=this.getValue(j,"offsets",null);if(null!=X){Y=t.Utils.newArray(G,-1);var q=t.Utils.newArray(G-X.length,0),Z=0,K=0;for(f=0;f<X.length;f++){var Q,J=X[f];if(-1==(Q=n.findSlotIndex(J.slot)))throw new Error("Slot not found: "+J.slot);for(;Z!=Q;)q[K++]=Z++;Y[Z+J.offset]=Z++}for(;Z<G;)q[K++]=Z++;for(f=G-1;f>=0;f--)-1==Y[f]&&(Y[f]=q[--K])}T.setFrame(h++,this.getValue(j,"time",0),Y)}a.push(T),s=Math.max(s,T.frames[T.getFrameCount()-1])}if(e.events){for(T=new t.EventTimeline(e.events.length),h=0,f=0;f<e.events.length;f++){var $=e.events[f],tt=n.findEvent($.name);if(null==tt)throw new Error("Event not found: "+$.name);var et=new t.Event(t.Utils.toSinglePrecision(this.getValue($,"time",0)),tt);et.intValue=this.getValue($,"int",tt.intValue),et.floatValue=this.getValue($,"float",tt.floatValue),et.stringValue=this.getValue($,"string",tt.stringValue),null!=et.data.audioPath&&(et.volume=this.getValue($,"volume",1),et.balance=this.getValue($,"balance",0)),T.setFrame(h++,et)}a.push(T),s=Math.max(s,T.frames[T.getFrameCount()-1])}if(isNaN(s))throw new Error("Error while parsing animation, duration is NaN");n.animations.push(new t.Animation(i,a,s))},e.prototype.readCurve=function(t,e,i){var n=t.curve;n&&("stepped"==n?e.setStepped(i):"[object Array]"===Object.prototype.toString.call(n)?e.setCurve(i,n[0],n[1],n[2],n[3]):e.setCurve(i,n,this.getValue(t,"c2",0),this.getValue(t,"c3",1),this.getValue(t,"c4",1)))},e.prototype.getValue=function(t,e,i){return void 0!==t[e]?t[e]:i},e.blendModeFromString=function(e){if("normal"==(e=e.toLowerCase()))return t.BlendMode.Normal;if("additive"==e)return t.BlendMode.Additive;if("multiply"==e)return t.BlendMode.Multiply;if("screen"==e)return t.BlendMode.Screen;throw new Error("Unknown blend mode: "+e)},e.positionModeFromString=function(e){if("fixed"==(e=e.toLowerCase()))return t.PositionMode.Fixed;if("percent"==e)return t.PositionMode.Percent;throw new Error("Unknown position mode: "+e)},e.spacingModeFromString=function(e){if("length"==(e=e.toLowerCase()))return t.SpacingMode.Length;if("fixed"==e)return t.SpacingMode.Fixed;if("percent"==e)return t.SpacingMode.Percent;throw new Error("Unknown position mode: "+e)},e.rotateModeFromString=function(e){if("tangent"==(e=e.toLowerCase()))return t.RotateMode.Tangent;if("chain"==e)return t.RotateMode.Chain;if("chainscale"==e)return t.RotateMode.ChainScale;throw new Error("Unknown rotate mode: "+e)},e.transformModeFromString=function(e){if("normal"==(e=e.toLowerCase()))return t.TransformMode.Normal;if("onlytranslation"==e)return t.TransformMode.OnlyTranslation;if("norotationorreflection"==e)return t.TransformMode.NoRotationOrReflection;if("noscale"==e)return t.TransformMode.NoScale;if("noscaleorreflection"==e)return t.TransformMode.NoScaleOrReflection;throw new Error("Unknown transform mode: "+e)},e})();t.SkeletonJson=e;var i=function(t,e,i,n,r){this.mesh=t,this.skin=e,this.slotIndex=i,this.parent=n,this.inheritDeform=r}})(r||(r={})),(function(t){var e=function(t,e,i){this.slotIndex=t,this.name=e,this.attachment=i};t.SkinEntry=e;var i=(function(){function i(t){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,null==t)throw new Error("name cannot be null.");this.name=t}return i.prototype.setAttachment=function(t,e,i){if(null==i)throw new Error("attachment cannot be null.");var n=this.attachments;t>=n.length&&(n.length=t+1),n[t]||(n[t]={}),n[t][e]=i},i.prototype.addSkin=function(t){for(var e=0;e<t.bones.length;e++){for(var i=t.bones[e],n=!1,r=0;r<this.bones.length;r++)if(this.bones[r]==i){n=!0;break}n||this.bones.push(i)}for(e=0;e<t.constraints.length;e++){var a=t.constraints[e];for(n=!1,r=0;r<this.constraints.length;r++)if(this.constraints[r]==a){n=!0;break}n||this.constraints.push(a)}var s=t.getAttachments();for(e=0;e<s.length;e++){var o=s[e];this.setAttachment(o.slotIndex,o.name,o.attachment)}},i.prototype.copySkin=function(e){for(var i=0;i<e.bones.length;i++){for(var n=e.bones[i],r=!1,a=0;a<this.bones.length;a++)if(this.bones[a]==n){r=!0;break}r||this.bones.push(n)}for(i=0;i<e.constraints.length;i++){var s=e.constraints[i];for(r=!1,a=0;a<this.constraints.length;a++)if(this.constraints[a]==s){r=!0;break}r||this.constraints.push(s)}var o=e.getAttachments();for(i=0;i<o.length;i++){var c=o[i];null!=c.attachment&&(c.attachment instanceof t.MeshAttachment?(c.attachment=c.attachment.newLinkedMesh(),this.setAttachment(c.slotIndex,c.name,c.attachment)):(c.attachment=c.attachment.copy(),this.setAttachment(c.slotIndex,c.name,c.attachment)))}},i.prototype.getAttachment=function(t,e){var i=this.attachments[t];return i?i[e]:null},i.prototype.removeAttachment=function(t,e){var i=this.attachments[t];i&&(i[e]=null)},i.prototype.getAttachments=function(){for(var t=new Array,i=0;i<this.attachments.length;i++){var n=this.attachments[i];if(n)for(var r in n){var a=n[r];a&&t.push(new e(i,r,a))}}return t},i.prototype.getAttachmentsForSlot=function(t,i){var n=this.attachments[t];if(n)for(var r in n){var a=n[r];a&&i.push(new e(t,r,a))}},i.prototype.clear=function(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0},i.prototype.attachAll=function(t,e){for(var i=0,n=0;n<t.slots.length;n++){var r=t.slots[n],a=r.getAttachment();if(a&&i<e.attachments.length){var s=e.attachments[i];for(var o in s)if(a==s[o]){var c=this.getAttachment(i,o);null!=c&&r.setAttachment(c);break}}i++}},i})();t.Skin=i})(r||(r={})),(function(t){var e=(function(){function e(e,i){if(this.deform=new Array,null==e)throw new Error("data cannot be null.");if(null==i)throw new Error("bone cannot be null.");this.data=e,this.bone=i,this.color=new t.Color,this.darkColor=null==e.darkColor?null:new t.Color,this.setToSetupPose()}return e.prototype.getSkeleton=function(){return this.bone.skeleton},e.prototype.getAttachment=function(){return this.attachment},e.prototype.setAttachment=function(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.deform.length=0)},e.prototype.setAttachmentTime=function(t){this.attachmentTime=this.bone.skeleton.time-t},e.prototype.getAttachmentTime=function(){return this.bone.skeleton.time-this.attachmentTime},e.prototype.setToSetupPose=function(){this.color.setFromColor(this.data.color),null!=this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),null==this.data.attachmentName?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))},e})();t.Slot=e})(r||(r={})),(function(t){t.SlotData=function(e,i,n){if(this.color=new t.Color(1,1,1,1),e<0)throw new Error("index must be >= 0.");if(null==i)throw new Error("name cannot be null.");if(null==n)throw new Error("boneData cannot be null.");this.index=e,this.name=i,this.boneData=n}})(r||(r={})),(function(t){var e,i,n=(function(){function t(t){this._image=t}return t.prototype.getImage=function(){return this._image},t.filterFromString=function(t){switch(t.toLowerCase()){case"nearest":return e.Nearest;case"linear":return e.Linear;case"mipmap":return e.MipMap;case"mipmapnearestnearest":return e.MipMapNearestNearest;case"mipmaplinearnearest":return e.MipMapLinearNearest;case"mipmapnearestlinear":return e.MipMapNearestLinear;case"mipmaplinearlinear":return e.MipMapLinearLinear;default:throw new Error("Unknown texture filter "+t)}},t.wrapFromString=function(t){switch(t.toLowerCase()){case"mirroredtepeat":return i.MirroredRepeat;case"clamptoedge":return i.ClampToEdge;case"repeat":return i.Repeat;default:throw new Error("Unknown texture wrap "+t)}},t})();t.Texture=n,(function(t){t[t.Nearest=9728]="Nearest",t[t.Linear=9729]="Linear",t[t.MipMap=9987]="MipMap",t[t.MipMapNearestNearest=9984]="MipMapNearestNearest",t[t.MipMapLinearNearest=9985]="MipMapLinearNearest",t[t.MipMapNearestLinear=9986]="MipMapNearestLinear",t[t.MipMapLinearLinear=9987]="MipMapLinearLinear"})(e=t.TextureFilter||(t.TextureFilter={})),(function(t){t[t.MirroredRepeat=33648]="MirroredRepeat",t[t.ClampToEdge=33071]="ClampToEdge",t[t.Repeat=10497]="Repeat"})(i=t.TextureWrap||(t.TextureWrap={}));t.TextureRegion=function(){this.u=0,this.v=0,this.u2=0,this.v2=0,this.width=0,this.height=0,this.rotate=!1,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0};var r=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.setFilters=function(){},e.prototype.setWraps=function(){},e.prototype.dispose=function(){},e})(n);t.FakeTexture=r})(r||(r={})),(function(t){var e=(function(){function e(t,e){this.pages=new Array,this.regions=new Array,this.load(t,e)}return e.prototype.load=function(e,a){if(null==a)throw new Error("textureLoader cannot be null.");for(var s=new i(e),o=new Array(4),c=null;;){var l=s.readLine();if(null==l)break;if(0==(l=l.trim()).length)c=null;else if(c){var u=new r;u.name=l,u.page=c;var h=s.readValue();"true"==h.toLocaleLowerCase()?u.degrees=90:"false"==h.toLocaleLowerCase()?u.degrees=0:u.degrees=parseFloat(h),u.rotate=90==u.degrees,s.readTuple(o);var f=parseInt(o[0]),d=parseInt(o[1]);s.readTuple(o);var _=parseInt(o[0]),p=parseInt(o[1]);u.u=f/c.width,u.v=d/c.height,u.rotate?(u.u2=(f+p)/c.width,u.v2=(d+_)/c.height):(u.u2=(f+_)/c.width,u.v2=(d+p)/c.height),u.x=f,u.y=d,u.width=Math.abs(_),u.height=Math.abs(p),4==s.readTuple(o)&&4==s.readTuple(o)&&s.readTuple(o),u.originalWidth=parseInt(o[0]),u.originalHeight=parseInt(o[1]),s.readTuple(o),u.offsetX=parseInt(o[0]),u.offsetY=parseInt(o[1]),u.index=parseInt(s.readValue()),u.texture=c.texture,this.regions.push(u)}else{(c=new n).name=l,2==s.readTuple(o)&&(c.width=parseInt(o[0]),c.height=parseInt(o[1]),s.readTuple(o)),s.readTuple(o),c.minFilter=t.Texture.filterFromString(o[0]),c.magFilter=t.Texture.filterFromString(o[1]);var m=s.readValue();c.uWrap=t.TextureWrap.ClampToEdge,c.vWrap=t.TextureWrap.ClampToEdge,"x"==m?c.uWrap=t.TextureWrap.Repeat:"y"==m?c.vWrap=t.TextureWrap.Repeat:"xy"==m&&(c.uWrap=c.vWrap=t.TextureWrap.Repeat),c.texture=a(l),c.texture.setFilters(c.minFilter,c.magFilter),c.texture.setWraps(c.uWrap,c.vWrap),c.width=c.texture.getImage().width,c.height=c.texture.getImage().height,this.pages.push(c)}}},e.prototype.findRegion=function(t){for(var e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return null},e.prototype.dispose=function(){for(var t=0;t<this.pages.length;t++)this.pages[t].texture.dispose()},e})();t.TextureAtlas=e;var i=(function(){function t(t){this.index=0,this.lines=t.split(/\r\n|\r|\n/)}return t.prototype.readLine=function(){return this.index>=this.lines.length?null:this.lines[this.index++]},t.prototype.readValue=function(){var t=this.readLine(),e=t.indexOf(":");if(-1==e)throw new Error("Invalid line: "+t);return t.substring(e+1).trim()},t.prototype.readTuple=function(t){var e=this.readLine(),i=e.indexOf(":");if(-1==i)throw new Error("Invalid line: "+e);for(var n=0,r=i+1;n<3;n++){var a=e.indexOf(",",r);if(-1==a)break;t[n]=e.substr(r,a-r).trim(),r=a+1}return t[n]=e.substring(r).trim(),n+1},t})(),n=function(){};t.TextureAtlasPage=n;var r=(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e})(t.TextureRegion);t.TextureAtlasRegion=r})(r||(r={})),(function(t){var e=(function(){function e(e,i){if(this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new t.Vector2,this.active=!1,null==e)throw new Error("data cannot be null.");if(null==i)throw new Error("skeleton cannot be null.");this.data=e,this.rotateMix=e.rotateMix,this.translateMix=e.translateMix,this.scaleMix=e.scaleMix,this.shearMix=e.shearMix,this.bones=new Array;for(var n=0;n<e.bones.length;n++)this.bones.push(i.findBone(e.bones[n].name));this.target=i.findBone(e.target.name)}return e.prototype.isActive=function(){return this.active},e.prototype.apply=function(){this.update()},e.prototype.update=function(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()},e.prototype.applyAbsoluteWorld=function(){for(var e=this.rotateMix,i=this.translateMix,n=this.scaleMix,r=this.shearMix,a=this.target,s=a.a,o=a.b,c=a.c,l=a.d,u=s*l-o*c>0?t.MathUtils.degRad:-t.MathUtils.degRad,h=this.data.offsetRotation*u,f=this.data.offsetShearY*u,d=this.bones,_=0,p=d.length;_<p;_++){var m=d[_],v=!1;if(0!=e){var g=m.a,y=m.b,T=m.c,b=m.d;(w=Math.atan2(c,s)-Math.atan2(T,g)+h)>t.MathUtils.PI?w-=t.MathUtils.PI2:w<-t.MathUtils.PI&&(w+=t.MathUtils.PI2),w*=e;var E=Math.cos(w),A=Math.sin(w);m.a=E*g-A*T,m.b=E*y-A*b,m.c=A*g+E*T,m.d=A*y+E*b,v=!0}if(0!=i){var C=this.temp;a.localToWorld(C.set(this.data.offsetX,this.data.offsetY)),m.worldX+=(C.x-m.worldX)*i,m.worldY+=(C.y-m.worldY)*i,v=!0}if(n>0){var x=Math.sqrt(m.a*m.a+m.c*m.c),S=Math.sqrt(s*s+c*c);x>1e-5&&(x=(x+(S-x+this.data.offsetScaleX)*n)/x),m.a*=x,m.c*=x,x=Math.sqrt(m.b*m.b+m.d*m.d),S=Math.sqrt(o*o+l*l),x>1e-5&&(x=(x+(S-x+this.data.offsetScaleY)*n)/x),m.b*=x,m.d*=x,v=!0}if(r>0){y=m.b,b=m.d;var w,M=Math.atan2(b,y);(w=Math.atan2(l,o)-Math.atan2(c,s)-(M-Math.atan2(m.c,m.a)))>t.MathUtils.PI?w-=t.MathUtils.PI2:w<-t.MathUtils.PI&&(w+=t.MathUtils.PI2),w=M+(w+f)*r,x=Math.sqrt(y*y+b*b),m.b=Math.cos(w)*x,m.d=Math.sin(w)*x,v=!0}v&&(m.appliedValid=!1)}},e.prototype.applyRelativeWorld=function(){for(var e=this.rotateMix,i=this.translateMix,n=this.scaleMix,r=this.shearMix,a=this.target,s=a.a,o=a.b,c=a.c,l=a.d,u=s*l-o*c>0?t.MathUtils.degRad:-t.MathUtils.degRad,h=this.data.offsetRotation*u,f=this.data.offsetShearY*u,d=this.bones,_=0,p=d.length;_<p;_++){var m,v=d[_],g=!1;if(0!=e){var y=v.a,T=v.b,b=v.c,E=v.d;(m=Math.atan2(c,s)+h)>t.MathUtils.PI?m-=t.MathUtils.PI2:m<-t.MathUtils.PI&&(m+=t.MathUtils.PI2),m*=e;var A=Math.cos(m),C=Math.sin(m);v.a=A*y-C*b,v.b=A*T-C*E,v.c=C*y+A*b,v.d=C*T+A*E,g=!0}if(0!=i){var x=this.temp;a.localToWorld(x.set(this.data.offsetX,this.data.offsetY)),v.worldX+=x.x*i,v.worldY+=x.y*i,g=!0}if(n>0){var S=(Math.sqrt(s*s+c*c)-1+this.data.offsetScaleX)*n+1;v.a*=S,v.c*=S,S=(Math.sqrt(o*o+l*l)-1+this.data.offsetScaleY)*n+1,v.b*=S,v.d*=S,g=!0}if(r>0)(m=Math.atan2(l,o)-Math.atan2(c,s))>t.MathUtils.PI?m-=t.MathUtils.PI2:m<-t.MathUtils.PI&&(m+=t.MathUtils.PI2),T=v.b,E=v.d,m=Math.atan2(E,T)+(m-t.MathUtils.PI/2+f)*r,S=Math.sqrt(T*T+E*E),v.b=Math.cos(m)*S,v.d=Math.sin(m)*S,g=!0;g&&(v.appliedValid=!1)}},e.prototype.applyAbsoluteLocal=function(){var t=this.rotateMix,e=this.translateMix,i=this.scaleMix,n=this.shearMix,r=this.target;r.appliedValid||r.updateAppliedTransform();for(var a=this.bones,s=0,o=a.length;s<o;s++){var c=a[s];c.appliedValid||c.updateAppliedTransform();var l=c.arotation;if(0!=t){var u=r.arotation-l+this.data.offsetRotation;l+=(u-=360*(16384-(16384.499999999996-u/360|0)))*t}var h=c.ax,f=c.ay;0!=e&&(h+=(r.ax-h+this.data.offsetX)*e,f+=(r.ay-f+this.data.offsetY)*e);var d=c.ascaleX,_=c.ascaleY;0!=i&&(d>1e-5&&(d=(d+(r.ascaleX-d+this.data.offsetScaleX)*i)/d),_>1e-5&&(_=(_+(r.ascaleY-_+this.data.offsetScaleY)*i)/_));var p=c.ashearY;0!=n&&(u=r.ashearY-p+this.data.offsetShearY,u-=360*(16384-(16384.499999999996-u/360|0)),c.shearY+=u*n),c.updateWorldTransformWith(h,f,l,d,_,c.ashearX,p)}},e.prototype.applyRelativeLocal=function(){var t=this.rotateMix,e=this.translateMix,i=this.scaleMix,n=this.shearMix,r=this.target;r.appliedValid||r.updateAppliedTransform();for(var a=this.bones,s=0,o=a.length;s<o;s++){var c=a[s];c.appliedValid||c.updateAppliedTransform();var l=c.arotation;0!=t&&(l+=(r.arotation+this.data.offsetRotation)*t);var u=c.ax,h=c.ay;0!=e&&(u+=(r.ax+this.data.offsetX)*e,h+=(r.ay+this.data.offsetY)*e);var f=c.ascaleX,d=c.ascaleY;0!=i&&(f>1e-5&&(f*=(r.ascaleX-1+this.data.offsetScaleX)*i+1),d>1e-5&&(d*=(r.ascaleY-1+this.data.offsetScaleY)*i+1));var _=c.ashearY;0!=n&&(_+=(r.ashearY+this.data.offsetShearY)*n),c.updateWorldTransformWith(u,h,l,f,d,c.ashearX,_)}},e})();t.TransformConstraint=e})(r||(r={})),(function(t){var e=(function(t){function e(e){var i=t.call(this,e,0,!1)||this;return i.bones=new Array,i.rotateMix=0,i.translateMix=0,i.scaleMix=0,i.shearMix=0,i.offsetRotation=0,i.offsetX=0,i.offsetY=0,i.offsetScaleX=0,i.offsetScaleY=0,i.offsetShearY=0,i.relative=!1,i.local=!1,i}return a(e,t),e})(t.ConstraintData);t.TransformConstraintData=e})(r||(r={})),(function(t){var e=(function(){function e(){this.convexPolygons=new Array,this.convexPolygonsIndices=new Array,this.indicesArray=new Array,this.isConcaveArray=new Array,this.triangles=new Array,this.polygonPool=new t.Pool(function(){return new Array}),this.polygonIndicesPool=new t.Pool(function(){return new Array})}return e.prototype.triangulate=function(t){var i=t,n=t.length>>1,r=this.indicesArray;r.length=0;for(var a=0;a<n;a++)r[a]=a;var s=this.isConcaveArray;s.length=0,a=0;for(var o=n;a<o;++a)s[a]=e.isConcave(a,n,i,r);var c=this.triangles;for(c.length=0;n>3;){for(var l=n-1,u=(a=0,1);;){t:if(!s[a]){for(var h=r[l]<<1,f=r[a]<<1,d=r[u]<<1,_=i[h],p=i[h+1],m=i[f],v=i[f+1],g=i[d],y=i[d+1],T=(u+1)%n;T!=l;T=(T+1)%n)if(s[T]){var b=r[T]<<1,E=i[b],A=i[b+1];if(e.positiveArea(g,y,_,p,E,A)&&e.positiveArea(_,p,m,v,E,A)&&e.positiveArea(m,v,g,y,E,A))break t}break}if(0==u){do{if(!s[a])break;a--}while(a>0);break}l=a,a=u,u=(u+1)%n}c.push(r[(n+a-1)%n]),c.push(r[a]),c.push(r[(a+1)%n]),r.splice(a,1),s.splice(a,1);var C=(--n+a-1)%n,x=a==n?0:a;s[C]=e.isConcave(C,n,i,r),s[x]=e.isConcave(x,n,i,r)}return 3==n&&(c.push(r[2]),c.push(r[0]),c.push(r[1])),c},e.prototype.decompose=function(t,i){var n=t,r=this.convexPolygons;this.polygonPool.freeAll(r),r.length=0;var a=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(a),a.length=0;var s=this.polygonIndicesPool.obtain();s.length=0;var o=this.polygonPool.obtain();o.length=0;for(var c=-1,l=0,u=0,h=i.length;u<h;u+=3){var f=i[u]<<1,d=i[u+1]<<1,_=i[u+2]<<1,p=n[f],m=n[f+1],v=n[d],g=n[d+1],y=n[_],T=n[_+1],b=!1;if(c==f){var E=o.length-4,A=e.winding(o[E],o[E+1],o[E+2],o[E+3],y,T),C=e.winding(y,T,o[0],o[1],o[2],o[3]);A==l&&C==l&&(o.push(y),o.push(T),s.push(_),b=!0)}b||(o.length>0?(r.push(o),a.push(s)):(this.polygonPool.free(o),this.polygonIndicesPool.free(s)),(o=this.polygonPool.obtain()).length=0,o.push(p),o.push(m),o.push(v),o.push(g),o.push(y),o.push(T),(s=this.polygonIndicesPool.obtain()).length=0,s.push(f),s.push(d),s.push(_),l=e.winding(p,m,v,g,y,T),c=f)}for(o.length>0&&(r.push(o),a.push(s)),u=0,h=r.length;u<h;u++)if(0!=(s=a[u]).length)for(var x=s[0],S=s[s.length-1],w=(o=r[u])[E=o.length-4],M=o[E+1],R=o[E+2],I=o[E+3],O=o[0],D=o[1],P=o[2],L=o[3],N=e.winding(w,M,R,I,O,D),F=0;F<h;F++)if(F!=u){var B=a[F];if(3==B.length){var k=B[0],V=B[1],z=B[2],U=r[F];y=U[U.length-2],T=U[U.length-1],k==x&&V==S&&(A=e.winding(w,M,R,I,y,T),C=e.winding(y,T,O,D,P,L),A==N&&C==N&&(U.length=0,B.length=0,o.push(y),o.push(T),s.push(z),w=R,M=I,R=y,I=T,F=0))}}for(u=r.length-1;u>=0;u--)0==(o=r[u]).length&&(r.splice(u,1),this.polygonPool.free(o),s=a[u],a.splice(u,1),this.polygonIndicesPool.free(s));return r},e.isConcave=function(t,e,i,n){var r=n[(e+t-1)%e]<<1,a=n[t]<<1,s=n[(t+1)%e]<<1;return!this.positiveArea(i[r],i[r+1],i[a],i[a+1],i[s],i[s+1])},e.positiveArea=function(t,e,i,n,r,a){return t*(a-n)+i*(e-a)+r*(n-e)>=0},e.winding=function(t,e,i,n,r,a){var s=i-t,o=n-e;return r*o-a*s+s*e-t*o>=0?1:-1},e})();t.Triangulator=e})(r||(r={})),(function(t){var e=(function(){function t(){this.array=new Array}return t.prototype.add=function(t){var e=this.contains(t);return this.array[0|t]=0|t,!e},t.prototype.contains=function(t){return null!=this.array[0|t]},t.prototype.remove=function(t){this.array[0|t]=void 0},t.prototype.clear=function(){this.array.length=0},t})();t.IntSet=e;var i=(function(){function t(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.r=t,this.g=e,this.b=i,this.a=n}return t.prototype.set=function(t,e,i,n){return this.r=t,this.g=e,this.b=i,this.a=n,this.clamp(),this},t.prototype.setFromColor=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this},t.prototype.setFromString=function(t){return t="#"==t.charAt(0)?t.substr(1):t,this.r=parseInt(t.substr(0,2),16)/255,this.g=parseInt(t.substr(2,2),16)/255,this.b=parseInt(t.substr(4,2),16)/255,this.a=(8!=t.length?255:parseInt(t.substr(6,2),16))/255,this},t.prototype.add=function(t,e,i,n){return this.r+=t,this.g+=e,this.b+=i,this.a+=n,this.clamp(),this},t.prototype.clamp=function(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this},t.rgba8888ToColor=function(t,e){t.r=((4278190080&e)>>>24)/255,t.g=((16711680&e)>>>16)/255,t.b=((65280&e)>>>8)/255,t.a=(255&e)/255},t.rgb888ToColor=function(t,e){t.r=((16711680&e)>>>16)/255,t.g=((65280&e)>>>8)/255,t.b=(255&e)/255},t.WHITE=new t(1,1,1,1),t.RED=new t(1,0,0,1),t.GREEN=new t(0,1,0,1),t.BLUE=new t(0,0,1,1),t.MAGENTA=new t(1,0,1,1),t})();t.Color=i;var n=(function(){function t(){}return t.clamp=function(t,e,i){return t<e?e:t>i?i:t},t.cosDeg=function(e){return Math.cos(e*t.degRad)},t.sinDeg=function(e){return Math.sin(e*t.degRad)},t.signum=function(t){return t>0?1:t<0?-1:0},t.toInt=function(t){return t>0?Math.floor(t):Math.ceil(t)},t.cbrt=function(t){var e=Math.pow(Math.abs(t),1/3);return t<0?-e:e},t.randomTriangular=function(e,i){return t.randomTriangularWith(e,i,.5*(e+i))},t.randomTriangularWith=function(t,e,i){var n=Math.random(),r=e-t;return n<=(i-t)/r?t+Math.sqrt(n*r*(i-t)):e-Math.sqrt((1-n)*r*(e-i))},t.PI=3.1415927,t.PI2=2*t.PI,t.radiansToDegrees=180/t.PI,t.radDeg=t.radiansToDegrees,t.degreesToRadians=t.PI/180,t.degRad=t.degreesToRadians,t})();t.MathUtils=n;var r=(function(){function t(){}return t.prototype.apply=function(t,e,i){return t+(e-t)*this.applyInternal(i)},t})();t.Interpolation=r;var s=(function(t){function e(e){var i=t.call(this)||this;return i.power=2,i.power=e,i}return a(e,t),e.prototype.applyInternal=function(t){return t<=.5?Math.pow(2*t,this.power)/2:Math.pow(2*(t-1),this.power)/(this.power%2==0?-2:2)+1},e})(r);t.Pow=s;var o=(function(t){function e(e){return t.call(this,e)||this}return a(e,t),e.prototype.applyInternal=function(t){return Math.pow(t-1,this.power)*(this.power%2==0?-1:1)+1},e})(s);t.PowOut=o;var c=(function(){function t(){}return t.arrayCopy=function(t,e,i,n,r){for(var a=e,s=n;a<e+r;a++,s++)i[s]=t[a]},t.setArraySize=function(t,e,i){void 0===i&&(i=0);var n=t.length;if(n==e)return t;if(t.length=e,n<e)for(var r=n;r<e;r++)t[r]=i;return t},t.ensureArrayCapacity=function(e,i,n){return void 0===n&&(n=0),e.length>=i?e:t.setArraySize(e,i,n)},t.newArray=function(t,e){for(var i=new Array(t),n=0;n<t;n++)i[n]=e;return i},t.newFloatArray=function(e){if(t.SUPPORTS_TYPED_ARRAYS)return new Float32Array(e);for(var i=new Array(e),n=0;n<i.length;n++)i[n]=0;return i},t.newShortArray=function(e){if(t.SUPPORTS_TYPED_ARRAYS)return new Int16Array(e);for(var i=new Array(e),n=0;n<i.length;n++)i[n]=0;return i},t.toFloatArray=function(e){return t.SUPPORTS_TYPED_ARRAYS?new Float32Array(e):e},t.toSinglePrecision=function(e){return t.SUPPORTS_TYPED_ARRAYS?Math.fround(e):e},t.webkit602BugfixHelper=function(){},t.contains=function(t,e,i){void 0===i&&(i=!0);for(var n=0;n<t.length;n++)if(t[n]==e)return!0;return!1},t.SUPPORTS_TYPED_ARRAYS="undefined"!=typeof Float32Array,t})();t.Utils=c;var l=(function(){function t(){}return t.logBones=function(t){for(var e=0;e<t.bones.length;e++){var i=t.bones[e];console.log(i.data.name+", "+i.a+", "+i.b+", "+i.c+", "+i.d+", "+i.worldX+", "+i.worldY)}},t})();t.DebugUtils=l;var u=(function(){function t(t){this.items=new Array,this.instantiator=t}return t.prototype.obtain=function(){return this.items.length>0?this.items.pop():this.instantiator()},t.prototype.free=function(t){t.reset&&t.reset(),this.items.push(t)},t.prototype.freeAll=function(t){for(var e=0;e<t.length;e++)t[e].reset&&t[e].reset(),this.items[e]=t[e]},t.prototype.clear=function(){this.items.length=0},t})();t.Pool=u;var h=(function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.set=function(t,e){return this.x=t,this.y=e,this},t.prototype.length=function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)},t.prototype.normalize=function(){var t=this.length();return 0!=t&&(this.x/=t,this.y/=t),this},t})();t.Vector2=h;var f=(function(){function t(){this.maxDelta=.064,this.framesPerSecond=0,this.delta=0,this.totalTime=0,this.lastTime=Date.now()/1e3,this.frameCount=0,this.frameTime=0}return t.prototype.update=function(){var t=Date.now()/1e3;this.delta=t-this.lastTime,this.frameTime+=this.delta,this.totalTime+=this.delta,this.delta>this.maxDelta&&(this.delta=this.maxDelta),this.lastTime=t,this.frameCount++,this.frameTime>1&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameTime=0,this.frameCount=0)},t})();t.TimeKeeper=f;var d=(function(){function t(t){void 0===t&&(t=32),this.addedValues=0,this.lastValue=0,this.mean=0,this.dirty=!0,this.values=new Array(t)}return t.prototype.hasEnoughData=function(){return this.addedValues>=this.values.length},t.prototype.addValue=function(t){this.addedValues<this.values.length&&this.addedValues++,this.values[this.lastValue++]=t,this.lastValue>this.values.length-1&&(this.lastValue=0),this.dirty=!0},t.prototype.getMean=function(){if(this.hasEnoughData()){if(this.dirty){for(var t=0,e=0;e<this.values.length;e++)t+=this.values[e];this.mean=t/this.values.length,this.dirty=!1}return this.mean}return 0},t})();t.WindowedMean=d})(r||(r={})),Math.fround||(Math.fround=(n=new Float32Array(1),function(t){return n[0]=t,n[0]})),(function(t){var e=function(t){if(null==t)throw new Error("name cannot be null.");this.name=t};t.Attachment=e;var i=(function(e){function i(t){var n=e.call(this,t)||this;return n.id=(65535&i.nextID++)<<11,n.worldVerticesLength=0,n.deformAttachment=n,n}return a(i,e),i.prototype.computeWorldVertices=function(t,e,i,n,r,a){i=r+(i>>1)*a;var s=t.bone.skeleton,o=t.deform,c=this.vertices,l=this.bones;if(null!=l){for(var u=0,h=0,f=0;f<e;f+=2)u+=(m=l[u])+1,h+=m;var d=s.bones;if(0==o.length)for(M=r,C=3*h;M<i;M+=a){var _=0,p=0,m=l[u++];for(m+=u;u<m;u++,C+=3){T=d[l[u]],R=c[C],I=c[C+1];var v=c[C+2];_+=(R*T.a+I*T.b+T.worldX)*v,p+=(R*T.c+I*T.d+T.worldY)*v}n[M]=_,n[M+1]=p}else for(var g=o,y=(M=r,C=3*h,h<<1);M<i;M+=a){for(_=0,p=0,m=l[u++],m+=u;u<m;u++,C+=3,y+=2)T=d[l[u]],R=c[C]+g[y],I=c[C+1]+g[y+1],v=c[C+2],_+=(R*T.a+I*T.b+T.worldX)*v,p+=(R*T.c+I*T.d+T.worldY)*v;n[M]=_,n[M+1]=p}}else{o.length>0&&(c=o);for(var T,b=(T=t.bone).worldX,E=T.worldY,A=T.a,C=T.b,x=T.c,S=T.d,w=e,M=r;M<i;w+=2,M+=a){var R=c[w],I=c[w+1];n[M]=R*A+I*C+b,n[M+1]=R*x+I*S+E}}},i.prototype.copyTo=function(e){null!=this.bones?(e.bones=new Array(this.bones.length),t.Utils.arrayCopy(this.bones,0,e.bones,0,this.bones.length)):e.bones=null,null!=this.vertices?(e.vertices=t.Utils.newFloatArray(this.vertices.length),t.Utils.arrayCopy(this.vertices,0,e.vertices,0,this.vertices.length)):e.vertices=null,e.worldVerticesLength=this.worldVerticesLength,e.deformAttachment=this.deformAttachment},i.nextID=0,i})(e);t.VertexAttachment=i})(r||(r={})),(function(t){(function(t){t[t.Region=0]="Region",t[t.BoundingBox=1]="BoundingBox",t[t.Mesh=2]="Mesh",t[t.LinkedMesh=3]="LinkedMesh",t[t.Path=4]="Path",t[t.Point=5]="Point",t[t.Clipping=6]="Clipping"})(t.AttachmentType||(t.AttachmentType={}))})(r||(r={})),(function(t){var e=(function(e){function i(i){var n=e.call(this,i)||this;return n.color=new t.Color(1,1,1,1),n}return a(i,e),i.prototype.copy=function(){var t=new i(name);return this.copyTo(t),t.color.setFromColor(this.color),t},i})(t.VertexAttachment);t.BoundingBoxAttachment=e})(r||(r={})),(function(t){var e=(function(e){function i(i){var n=e.call(this,i)||this;return n.color=new t.Color(.2275,.2275,.8078,1),n}return a(i,e),i.prototype.copy=function(){var t=new i(name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t},i})(t.VertexAttachment);t.ClippingAttachment=e})(r||(r={})),(function(t){var e=(function(e){function i(i){var n=e.call(this,i)||this;return n.color=new t.Color(1,1,1,1),n.tempColor=new t.Color(0,0,0,0),n}return a(i,e),i.prototype.updateUVs=function(){var e=this.regionUVs;null!=this.uvs&&this.uvs.length==e.length||(this.uvs=t.Utils.newFloatArray(e.length));var i=this.uvs,n=this.uvs.length,r=this.region.u,a=this.region.v,s=0,o=0;if(this.region instanceof t.TextureAtlasRegion){var c=this.region,l=c.texture.getImage().width,u=c.texture.getImage().height;switch(c.degrees){case 90:r-=(c.originalHeight-c.offsetY-c.height)/l,a-=(c.originalWidth-c.offsetX-c.width)/u,s=c.originalHeight/l,o=c.originalWidth/u;for(var h=0;h<n;h+=2)i[h]=r+e[h+1]*s,i[h+1]=a+(1-e[h])*o;return;case 180:for(r-=(c.originalWidth-c.offsetX-c.width)/l,a-=c.offsetY/u,s=c.originalWidth/l,o=c.originalHeight/u,h=0;h<n;h+=2)i[h]=r+(1-e[h])*s,i[h+1]=a+(1-e[h+1])*o;return;case 270:for(r-=c.offsetY/l,a-=c.offsetX/u,s=c.originalHeight/l,o=c.originalWidth/u,h=0;h<n;h+=2)i[h]=r+(1-e[h+1])*s,i[h+1]=a+e[h]*o;return}r-=c.offsetX/l,a-=(c.originalHeight-c.offsetY-c.height)/u,s=c.originalWidth/l,o=c.originalHeight/u}else null==this.region?(r=a=0,s=o=1):(s=this.region.u2-r,o=this.region.v2-a);for(h=0;h<n;h+=2)i[h]=r+e[h]*s,i[h+1]=a+e[h+1]*o},i.prototype.getParentMesh=function(){return this.parentMesh},i.prototype.setParentMesh=function(t){this.parentMesh=t,null!=t&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)},i.prototype.copy=function(){if(null!=this.parentMesh)return this.newLinkedMesh();var e=new i(this.name);return e.region=this.region,e.path=this.path,e.color.setFromColor(this.color),this.copyTo(e),e.regionUVs=new Array(this.regionUVs.length),t.Utils.arrayCopy(this.regionUVs,0,e.regionUVs,0,this.regionUVs.length),e.uvs=new Array(this.uvs.length),t.Utils.arrayCopy(this.uvs,0,e.uvs,0,this.uvs.length),e.triangles=new Array(this.triangles.length),t.Utils.arrayCopy(this.triangles,0,e.triangles,0,this.triangles.length),e.hullLength=this.hullLength,null!=this.edges&&(e.edges=new Array(this.edges.length),t.Utils.arrayCopy(this.edges,0,e.edges,0,this.edges.length)),e.width=this.width,e.height=this.height,e},i.prototype.newLinkedMesh=function(){var t=new i(this.name);return t.region=this.region,t.path=this.path,t.color.setFromColor(this.color),t.deformAttachment=this.deformAttachment,t.setParentMesh(null!=this.parentMesh?this.parentMesh:this),t.updateUVs(),t},i})(t.VertexAttachment);t.MeshAttachment=e})(r||(r={})),(function(t){var e=(function(e){function i(i){var n=e.call(this,i)||this;return n.closed=!1,n.constantSpeed=!1,n.color=new t.Color(1,1,1,1),n}return a(i,e),i.prototype.copy=function(){var e=new i(name);return this.copyTo(e),e.lengths=new Array(this.lengths.length),t.Utils.arrayCopy(this.lengths,0,e.lengths,0,this.lengths.length),e.closed=closed,e.constantSpeed=this.constantSpeed,e.color.setFromColor(this.color),e},i})(t.VertexAttachment);t.PathAttachment=e})(r||(r={})),(function(t){var e=(function(e){function i(i){var n=e.call(this,i)||this;return n.color=new t.Color(.38,.94,0,1),n}return a(i,e),i.prototype.computeWorldPosition=function(t,e){return e.x=this.x*t.a+this.y*t.b+t.worldX,e.y=this.x*t.c+this.y*t.d+t.worldY,e},i.prototype.computeWorldRotation=function(e){var i=t.MathUtils.cosDeg(this.rotation),n=t.MathUtils.sinDeg(this.rotation),r=i*e.a+n*e.b,a=i*e.c+n*e.d;return Math.atan2(a,r)*t.MathUtils.radDeg},i.prototype.copy=function(){var t=new i(name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t},i})(t.VertexAttachment);t.PointAttachment=e})(r||(r={})),(function(t){var e=(function(e){function i(i){var n=e.call(this,i)||this;return n.x=0,n.y=0,n.scaleX=1,n.scaleY=1,n.rotation=0,n.width=0,n.height=0,n.color=new t.Color(1,1,1,1),n.offset=t.Utils.newFloatArray(8),n.uvs=t.Utils.newFloatArray(8),n.tempColor=new t.Color(1,1,1,1),n}return a(i,e),i.prototype.updateOffset=function(){var t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,n=-this.width/2*this.scaleX+this.region.offsetX*t,r=-this.height/2*this.scaleY+this.region.offsetY*e,a=n+this.region.width*t,s=r+this.region.height*e,o=this.rotation*Math.PI/180,c=Math.cos(o),l=Math.sin(o),u=n*c+this.x,h=n*l,f=r*c+this.y,d=r*l,_=a*c+this.x,p=a*l,m=s*c+this.y,v=s*l,g=this.offset;g[i.OX1]=u-d,g[i.OY1]=f+h,g[i.OX2]=u-v,g[i.OY2]=m+h,g[i.OX3]=_-v,g[i.OY3]=m+p,g[i.OX4]=_-d,g[i.OY4]=f+p},i.prototype.setRegion=function(t){this.region=t;var e=this.uvs;t.rotate?(e[2]=t.u,e[3]=t.v2,e[4]=t.u,e[5]=t.v,e[6]=t.u2,e[7]=t.v,e[0]=t.u2,e[1]=t.v2):(e[0]=t.u,e[1]=t.v2,e[2]=t.u,e[3]=t.v,e[4]=t.u2,e[5]=t.v,e[6]=t.u2,e[7]=t.v2)},i.prototype.computeWorldVertices=function(t,e,n,r){var a=this.offset,s=t.worldX,o=t.worldY,c=t.a,l=t.b,u=t.c,h=t.d,f=0,d=0;f=a[i.OX1],d=a[i.OY1],e[n]=f*c+d*l+s,e[n+1]=f*u+d*h+o,n+=r,f=a[i.OX2],d=a[i.OY2],e[n]=f*c+d*l+s,e[n+1]=f*u+d*h+o,n+=r,f=a[i.OX3],d=a[i.OY3],e[n]=f*c+d*l+s,e[n+1]=f*u+d*h+o,n+=r,f=a[i.OX4],d=a[i.OY4],e[n]=f*c+d*l+s,e[n+1]=f*u+d*h+o},i.prototype.copy=function(){var e=new i(name);return e.region=this.region,e.rendererObject=this.rendererObject,e.path=this.path,e.x=this.x,e.y=this.y,e.scaleX=this.scaleX,e.scaleY=this.scaleY,e.rotation=this.rotation,e.width=this.width,e.height=this.height,t.Utils.arrayCopy(this.uvs,0,e.uvs,0,8),t.Utils.arrayCopy(this.offset,0,e.offset,0,8),e.color.setFromColor(this.color),e},i.OX1=0,i.OY1=1,i.OX2=2,i.OY2=3,i.OX3=4,i.OY3=5,i.OX4=6,i.OY4=7,i.X1=0,i.Y1=1,i.C1R=2,i.C1G=3,i.C1B=4,i.C1A=5,i.U1=6,i.V1=7,i.X2=8,i.Y2=9,i.C2R=10,i.C2G=11,i.C2B=12,i.C2A=13,i.U2=14,i.V2=15,i.X3=16,i.Y3=17,i.C3R=18,i.C3G=19,i.C3B=20,i.C3A=21,i.U3=22,i.V3=23,i.X4=24,i.Y4=25,i.C4R=26,i.C4G=27,i.C4B=28,i.C4A=29,i.U4=30,i.V4=31,i})(t.Attachment);t.RegionAttachment=e})(r||(r={})),(function(t){var e=(function(){function e(t,e){this.jitterX=0,this.jitterY=0,this.jitterX=t,this.jitterY=e}return e.prototype.begin=function(){},e.prototype.transform=function(e){e.x+=t.MathUtils.randomTriangular(-this.jitterX,this.jitterY),e.y+=t.MathUtils.randomTriangular(-this.jitterX,this.jitterY)},e.prototype.end=function(){},e})();t.JitterEffect=e})(r||(r={})),(function(t){var e=(function(){function e(t,e){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=t,this.interpolation=e}return e.prototype.begin=function(t){this.worldX=t.x+this.centerX,this.worldY=t.y+this.centerY},e.prototype.transform=function(e){var i=this.angle*t.MathUtils.degreesToRadians,n=e.x-this.worldX,r=e.y-this.worldY,a=Math.sqrt(n*n+r*r);if(a<this.radius){var s=this.interpolation.apply(0,i,(this.radius-a)/this.radius),o=Math.cos(s),c=Math.sin(s);e.x=o*n-c*r+this.worldX,e.y=c*n+o*r+this.worldY}},e.prototype.end=function(){},e.interpolation=new t.PowOut(2),e})();t.SwirlEffect=e})(r||(r={})),e.exports=r}),{}],358:[(function(t,e){"use strict";var i,n,r,a,s,o,c=t("./track-entry-listeners"),l=t("./lib/spine"),u=[],h=[],f=0,d=0,_=0,p=null,m=null,v=0,g=0,y=0,T=0,b=null,E=null,A=0,C=0,x=new l.Color(1,1,1,1),S=new l.Color(1,1,1,1),w=[0,1,2,2,3,0],M=cc.Class({ctor:function(){this._privateMode=!1,this._inited=!1,this._invalid=!0,this._enableCacheAttachedInfo=!1,this.frames=[],this.totalTime=0,this._frameIdx=-1,this.isCompleted=!1,this._skeletonInfo=null,this._animationName=null,this._tempSegments=null,this._tempColors=null,this._tempBoneInfos=null},init:function(t,e){this._inited=!0,this._animationName=e,this._skeletonInfo=t},clear:function(){this._inited=!1;for(var t=0,e=this.frames.length;t<e;t++)this.frames[t].segments.length=0;this.invalidAllFrame()},bind:function(t){var e=function(t){t&&t.animation.name===this._animationName&&(this.isCompleted=!0)}.bind(this);t.complete=e},unbind:function(t){t.complete=null},begin:function(){if(this._invalid){var t=this._skeletonInfo,e=t.curAnimationCache;e&&e!==this&&(this._privateMode?e.invalidAllFrame():e.updateToFrame());var i=t.skeleton,n=t.listener,r=t.state,a=i.data.findAnimation(this._animationName);r.setAnimationWith(0,a,!1),this.bind(n),t.curAnimationCache=this,this._frameIdx=-1,this.isCompleted=!1,this.totalTime=0,this._invalid=!1}},end:function(){this._needToUpdate()||(this._skeletonInfo.curAnimationCache=null,this.frames.length=this._frameIdx+1,this.isCompleted=!0,this.unbind(this._skeletonInfo.listener))},_needToUpdate:function(t){return!this.isCompleted&&this.totalTime<30&&(null==t||this._frameIdx<t)},updateToFrame:function(t){if(this._inited&&(this.begin(),this._needToUpdate(t))){var e=this._skeletonInfo,i=e.skeleton,n=e.clipper,r=e.state;do{i.update(1/60),r.update(1/60),r.apply(i),i.updateWorldTransform(),this._frameIdx++,this._updateFrame(i,n,this._frameIdx),this.totalTime+=1/60}while(this._needToUpdate(t));this.end()}},isInited:function(){return this._inited},isInvalid:function(){return this._invalid},invalidAllFrame:function(){this.isCompleted=!1,this._invalid=!0},updateAllFrame:function(){this.invalidAllFrame(),this.updateToFrame()},enableCacheAttachedInfo:function(){this._enableCacheAttachedInfo||(this._enableCacheAttachedInfo=!0,this.invalidAllFrame())},_updateFrame:function(t,e,i){_=0,f=0,d=0,p=null,m=null,v=0,g=0,y=0,T=0,b=null,E=null,this.frames[i]=this.frames[i]||{segments:[],colors:[],boneInfos:[],vertices:null,uintVert:null,indices:null};var n=this.frames[i],r=this._tempSegments=n.segments,a=this._tempColors=n.colors,s=this._tempBoneInfos=n.boneInfos;this._traverseSkeleton(t,e),T>0&&(a[T-1].vfOffset=_),a.length=T,s.length=f;var o=y-1;if(o>=0)if(g>0){var c=r[o];c.indexCount=g,c.vfCount=6*v,c.vertexCount=v,r.length=y}else r.length=y-1;if(0!=r.length){var l=n.vertices,A=n.uintVert;(!l||l.length<_)&&(l=n.vertices=new Float32Array(_),A=n.uintVert=new Uint32Array(l.buffer));for(var C=0,x=0;C<_;)l[C++]=u[x++],l[C++]=u[x++],l[C++]=u[x++],l[C++]=u[x++],A[C++]=u[x++],A[C++]=u[x++];var S=n.indices;(!S||S.length<d)&&(S=n.indices=new Uint16Array(d));for(var w=0;w<d;w++)S[w]=h[w];n.vertices=l,n.uintVert=A,n.indices=S}},fillVertices:function(t,e,c,l,f){if(a=c.a*e.a*t.a*255,i=e.r*t.r*255,n=e.g*t.g*255,r=e.b*t.b*255,x.r=i*c.r,x.g=n*c.g,x.b=r*c.b,x.a=a,null==f.darkColor?S.set(0,0,0,1):(S.r=f.darkColor.r*i,S.g=f.darkColor.g*n,S.b=f.darkColor.b*r),S.a=0,s=(x.a<<24>>>0)+(x.b<<16)+(x.g<<8)+x.r,o=(S.a<<24>>>0)+(S.b<<16)+(S.g<<8)+S.r,b!==s||E!==o){var p=this._tempColors;b=s,E=o,T>0&&(p[T-1].vfOffset=_),p[T++]={fr:x.r,fg:x.g,fb:x.b,fa:x.a,dr:S.r,dg:S.g,db:S.b,da:S.a,vfOffset:0}}if(l.isClipping()){l.clipTriangles(u,A,h,C,u,x,S,!0,6,d,_,_+2);var m=l.clippedVertices,v=l.clippedTriangles;C=v.length,A=m.length/12*6;for(var g=0,y=d,w=v.length;g<w;)h[y++]=v[g++];for(var M=0,R=m.length,I=_;M<R;M+=12,I+=6)u[I]=m[M],u[I+1]=m[M+1],u[I+2]=m[M+6],u[I+3]=m[M+7],u[I+4]=s,u[I+5]=o}else for(var O=_,D=_+A;O<D;O+=6)u[O+4]=s,u[O+5]=o},_traverseSkeleton:function(t,e){var i,n,r,a,s,o,c,T,b,E,x,S,M=this._tempSegments,R=this._tempBoneInfos,I=t.color,O=t.bones;if(this._enableCacheAttachedInfo)for(var D=0,P=O.length;D<P;D++,f++){var L=O[D],N=R[f];N||(N=R[f]={}),N.a=L.a,N.b=L.b,N.c=L.c,N.d=L.d,N.worldX=L.worldX,N.worldY=L.worldY}for(var F=0,B=t.drawOrder.length;F<B;F++)if(S=t.drawOrder[F],A=0,C=0,i=S.getAttachment())if(o=i instanceof l.RegionAttachment,c=i instanceof l.MeshAttachment,i instanceof l.ClippingAttachment)e.clipStart(S,i);else if(o||c)if(T=i.region.texture._texture)if(x=S.data.blendMode,p===T.nativeUrl&&m===x||(p=T.nativeUrl,m=x,(b=y-1)>=0&&(g>0?((E=M[b]).indexCount=g,E.vertexCount=v,E.vfCount=6*v):y--),M[y]={tex:T,blendMode:x,indexCount:0,vertexCount:0,vfCount:0},y++,g=0,v=0),o?(s=w,A=24,C=6,i.computeWorldVertices(S.bone,u,_,6)):c&&(s=i.triangles,A=6*(i.worldVerticesLength>>1),C=s.length,i.computeWorldVertices(S,0,i.worldVerticesLength,u,_,6)),0!=A&&0!=C){for(var k=0,V=d,z=s.length;k<z;)h[V++]=s[k++];a=i.uvs;for(var U=_,H=_+A,W=0;U<H;U+=6,W+=2)u[U+2]=a[W],u[U+3]=a[W+1];if(n=i.color,r=S.color,this.fillVertices(I,n,r,e,S),C>0){for(var G=d,j=d+C;G<j;G++)h[G]+=v;d+=C,_+=A,g+=C,v+=A/6}e.clipEndWithSlot(S)}else e.clipEndWithSlot(S);else e.clipEndWithSlot(S);else e.clipEndWithSlot(S);else e.clipEndWithSlot(S);e.clipEnd()}}),R=cc.Class({ctor:function(){this._privateMode=!1,this._animationPool={},this._skeletonCache={}},enablePrivateMode:function(){this._privateMode=!0},clear:function(){this._animationPool={},this._skeletonCache={}},removeSkeleton:function(t){var e=this._skeletonCache[t];if(e){var i=e.animationsCache;for(var n in i){var r=i[n];r&&(this._animationPool[t+"#"+n]=r,r.clear())}delete this._skeletonCache[t]}},getSkeletonCache:function(t,e){var i=this._skeletonCache[t];if(!i){var n=new l.Skeleton(e),r=new l.SkeletonClipping,a=new l.AnimationStateData(n.data),s=new l.AnimationState(a),o=new c;s.addListener(o),this._skeletonCache[t]=i={skeleton:n,clipper:r,state:s,listener:o,animationsCache:{},curAnimationCache:null}}return i},getAnimationCache:function(t,e){var i=this._skeletonCache[t];return i?i.animationsCache[e]:null},invalidAnimationCache:function(t){var e=this._skeletonCache[t];if(e&&e.skeleton){var i=e.animationsCache;for(var n in i)i[n].invalidAllFrame()}},initAnimationCache:function(t,e){if(!e)return null;var i=this._skeletonCache[t],n=i&&i.skeleton;if(!n)return null;if(!n.data.findAnimation(e))return null;var r=i.animationsCache,a=r[e];if(!a){var s=t+"#"+e;(a=this._animationPool[s])?delete this._animationPool[s]:(a=new M)._privateMode=this._privateMode,a.init(i,e),r[e]=a}return a},updateAnimationCache:function(t,e){if(e){var i=this.initAnimationCache(t,e);if(!i)return null;i.updateAllFrame()}else{var n=this._skeletonCache[t];if(!n||!n.skeleton)return;var r=n.animationsCache;for(var a in r)r[a].updateAllFrame()}}});R.FrameTime=1/60,R.sharedCache=new R,e.exports=R}),{"./lib/spine":357,"./track-entry-listeners":362}],359:[(function(t,e){"use strict";var i=t("./skeleton-cache").sharedCache,n=cc.Class({name:"sp.SkeletonData",extends:cc.Asset,ctor:function(){this.reset()},properties:{_skeletonJson:null,skeletonJsonStr:{get:function(){return this._skeletonJson?JSON.stringify(this._skeletonJson):""}},skeletonJson:{get:function(){return this._skeletonJson},set:function(t){this.reset(),this._skeletonJson="string"==typeof t?JSON.parse(t):t,!this._uuid&&t.skeleton&&(this._uuid=t.skeleton.hash)}},_atlasText:"",atlasText:{get:function(){return this._atlasText},set:function(t){this._atlasText=t,this.reset()}},textures:{default:[],type:[cc.Texture2D]},textureNames:{default:[],type:[cc.String]},scale:1,_nativeAsset:{get:function(){return this._buffer},set:function(t){this._buffer=t.buffer||t,this.reset()},override:!0}},statics:{preventDeferredLoadDependents:!0},createNode:!1,reset:function(){this._skeletonCache=null,this._atlasCache=null},ensureTexturesLoaded:function(t,e){var i=this.textures,n=i.length;if(0!=n)for(var r=0,a=function(){++r>=n&&(t&&t.call(e,!0),t=null)},s=0;s<n;s++){var o=i[s];o.loaded?a():o.once("load",a)}else t.call(e,!1)},isTexturesLoaded:function(){for(var t=this.textures,e=t.length,i=0;i<e;i++)if(!t[i].loaded)return!1;return!0},getRuntimeData:function(t){if(this._skeletonCache)return this._skeletonCache;if(!(this.textures&&this.textures.length>0)&&this.textureNames&&this.textureNames.length>0)return t||cc.errorID(7507,this.name),null;var e=this._getAtlas(t);if(!e)return null;var i=new sp.spine.AtlasAttachmentLoader(e),n=null,r=null;return this.skeletonJson?(r=new sp.spine.SkeletonJson(i),n=this.skeletonJson):(r=new sp.spine.SkeletonBinary(i),n=new Uint8Array(this._nativeAsset)),r.scale=this.scale,this._skeletonCache=r.readSkeletonData(n),e.dispose(),this._skeletonCache},getSkinsEnum:!1,getAnimsEnum:!1,_getTexture:function(t){for(var e=this.textureNames,i=0;i<e.length;i++)if(e[i]===t){var n=this.textures[i],r=new sp.SkeletonTexture({width:n.width,height:n.height});return r.setRealTexture(n),r}return cc.errorID(7506,t),null},_getAtlas:function(t){return this._atlasCache?this._atlasCache:this.atlasText?this._atlasCache=new sp.spine.TextureAtlas(this.atlasText,this._getTexture.bind(this)):(t||cc.errorID(7508,this.name),null)},destroy:function(){i.removeSkeleton(this._uuid),this._super()}});sp.SkeletonData=e.exports=n}),{"./skeleton-cache":358}],360:[(function(){"use strict";sp.SkeletonTexture=cc.Class({name:"sp.SkeletonTexture",extends:sp.spine.Texture,_texture:null,_material:null,setRealTexture:function(t){this._texture=t},getRealTexture:function(){return this._texture},setFilters:function(t,e){this._texture&&this._texture.setFilters(t,e)},setWraps:function(t,e){this._texture&&this._texture.setWrapMode(t,e)},dispose:function(){}})}),{}],361:[(function(t,e,i){"use strict";i.__esModule=!0,i.default=void 0;var n,r,a,s,o,c,l,u,h,f,d,_,p,m,v,g,y,T,b=(n=t("../../cocos2d/core/renderer/assembler"))&&n.__esModule?n:{default:n},E=t("./Skeleton"),A=t("./lib/spine"),C=t("../../cocos2d/core/renderer/render-flow"),x=t("../../cocos2d/core/renderer/webgl/vertex-format"),S=x.vfmtPosUvColor,w=x.vfmtPosUvTwoColor,M=cc.gfx,R=0,I=[0,1,2,2,3,0],O=cc.color(0,0,255,255),D=cc.color(255,0,0,255),P=cc.color(0,255,0,255),L=cc.color(255,255,0,255),N=null,F=null,B=null,k=null;N=new A.Color(1,1,1,1),F=new A.Color(1,1,1,1),B=new A.Vector2,k=new A.Vector2;var V,z,U,H,W,G,j,Y,X,q,Z,K,Q,J,$,tt,et,it,nt,rt,at,st,ot,ct,lt,ut,ht,ft,dt,_t=0,pt=0,mt=0,vt=0,gt=0,yt=0,Tt=0;function bt(t,e){var i,n;switch(e){case A.BlendMode.Additive:i=r?cc.macro.ONE:cc.macro.SRC_ALPHA,n=cc.macro.ONE;break;case A.BlendMode.Multiply:i=cc.macro.DST_COLOR,n=cc.macro.ONE_MINUS_SRC_ALPHA;break;case A.BlendMode.Screen:i=cc.macro.ONE,n=cc.macro.ONE_MINUS_SRC_COLOR;break;case A.BlendMode.Normal:default:i=r?cc.macro.ONE:cc.macro.SRC_ALPHA,n=cc.macro.ONE_MINUS_SRC_ALPHA}var a=!ct.enableBatch,s=ct._materials[0];if(!s)return null;var o=t.getId()+i+n+c+a,l=ct._materialCache,u=l[o];return u||(l.baseMaterial?u=cc.MaterialVariant.create(s):(u=s,l.baseMaterial=s),u.define("CC_USE_MODEL",a),u.define("USE_TINT",c),u.setProperty("texture",t),u.setBlend(!0,M.BLEND_FUNC_ADD,i,n,M.BLEND_FUNC_ADD,i,n),l[o]=u),u}function Et(t){rt=t.fa*p,J=f*(a=r?rt/255:1),$=d*a,tt=_*a,et=t.fr*J,it=t.fg*$,nt=t.fb*tt,m=(rt<<24>>>0)+(nt<<16)+(it<<8)+et,at=t.dr*J,st=t.dg*$,ot=t.db*tt,v=((r?255:0)<<24>>>0)+(ot<<16)+(st<<8)+at}function At(t){return(t.a<<24>>>0)+(t.b<<16)+(t.g<<8)+t.r}var Ct=(function(t){var e,i;function n(){return t.apply(this,arguments)||this}i=t,(e=n).prototype=Object.create(i.prototype),e.prototype.constructor=e,e.__proto__=i;var b=n.prototype;return b.updateRenderData=function(t){if(!t.isAnimationCached()){var e=t._skeleton;e&&e.updateWorldTransform()}},b.fillVertices=function(t,e,i,n,s){var o,l=lt._vData,u=lt._iData,h=lt._uintVData;if(N.a=i.a*e.a*t.a*p*255,a=r?N.a:255,V=f*e.r*t.r*a,z=d*e.g*t.g*a,U=_*e.b*t.b*a,N.r=V*i.r,N.g=z*i.g,N.b=U*i.b,null==s.darkColor?F.set(0,0,0,1):(F.r=s.darkColor.r*V,F.g=s.darkColor.g*z,F.b=s.darkColor.b*U),F.a=r?255:0,n.isClipping()){var g=l.subarray(mt+2);n.clipTriangles(l.subarray(mt),_t,u.subarray(yt),gt,g,N,F,c,y);var b=new Float32Array(n.clippedVertices),E=n.clippedTriangles;if(gt=E.length,_t=b.length/T*y,o=lt.request(_t/y,gt),yt=o.indiceOffset,vt=o.vertexOffset,mt=o.byteOffset>>2,l=lt._vData,u=lt._iData,h=lt._uintVData,u.set(E,yt),dt)for(var A=0,C=b.length,x=mt;A<C;A+=T,x+=y)B.x=b[A],B.y=b[A+1],N.set(b[A+2],b[A+3],b[A+4],b[A+5]),k.x=b[A+6],k.y=b[A+7],c?F.set(b[A+8],b[A+9],b[A+10],b[A+11]):F.set(0,0,0,0),dt.transform(B,k,N,F),l[x]=B.x,l[x+1]=B.y,l[x+2]=k.x,l[x+3]=k.y,h[x+4]=At(N),c&&(h[x+5]=At(F));else for(var S=0,w=b.length,M=mt;S<w;S+=T,M+=y)l[M]=b[S],l[M+1]=b[S+1],l[M+2]=b[S+6],l[M+3]=b[S+7],m=(b[S+5]<<24>>>0)+(b[S+4]<<16)+(b[S+3]<<8)+b[S+2],h[M+4]=m,c&&(v=(b[S+11]<<24>>>0)+(b[S+10]<<16)+(b[S+9]<<8)+b[S+8],h[M+5]=v)}else if(dt)for(var R=mt,I=mt+_t;R<I;R+=y)B.x=l[R],B.y=l[R+1],k.x=l[R+2],k.y=l[R+3],dt.transform(B,k,N,F),l[R]=B.x,l[R+1]=B.y,l[R+2]=k.x,l[R+3]=k.y,h[R+4]=At(N),c&&(h[R+5]=At(F));else{m=At(N),v=At(F);for(var O=mt,D=mt+_t;O<D;O+=y)h[O+4]=m,c&&(h[O+5]=v)}},b.realTimeTraverse=function(t){var e,i,n,r,a,f,d,_,p,m,v,g,b=ct._skeleton,E=b.color,C=ct._debugRenderer,x=ct._clipper,S=null;s=ct._startSlotIndex,o=ct._endSlotIndex,H=!1,-1==s&&(H=!0),l=ct.debugSlots,u=ct.debugBones,h=ct.debugMesh,C&&(u||l||h)&&(C.clear(),C.lineWidth=2),T=c?12:8,_t=0,mt=0,vt=0,gt=0,yt=0;for(var w=0,M=b.drawOrder.length;w<M;w++)if(null!=(v=b.drawOrder[w]))if(s>=0&&s==v.data.index&&(H=!0),H)if(o>=0&&o==v.data.index&&(H=!1),_t=0,gt=0,n=v.getAttachment())if(_=n instanceof A.RegionAttachment,p=n instanceof A.MeshAttachment,n instanceof A.ClippingAttachment)x.clipStart(v,n);else if(_||p)if(S=bt(n.region.texture._texture,v.data.blendMode)){if((W||S.getHash()!==ut.material.getHash())&&(W=!1,ut._flush(),ut.node=ht,ut.material=S),_){if(d=I,_t=4*y,gt=6,m=lt.request(4,6),yt=m.indiceOffset,vt=m.vertexOffset,mt=m.byteOffset>>2,e=lt._vData,i=lt._iData,n.computeWorldVertices(v.bone,e,mt,y),C&&l){C.strokeColor=O,C.moveTo(e[mt],e[mt+1]);for(var R=mt+y,N=mt+_t;R<N;R+=y)C.lineTo(e[R],e[R+1]);C.close(),C.stroke()}}else if(p&&(d=n.triangles,_t=(n.worldVerticesLength>>1)*y,gt=d.length,m=lt.request(_t/y,gt),yt=m.indiceOffset,vt=m.vertexOffset,mt=m.byteOffset>>2,e=lt._vData,i=lt._iData,n.computeWorldVertices(v,0,n.worldVerticesLength,e,mt,y),C&&h)){C.strokeColor=L;for(var F=0,B=d.length;F<B;F+=3){var k=d[F]*y+mt,V=d[F+1]*y+mt,z=d[F+2]*y+mt;C.moveTo(e[k],e[k+1]),C.lineTo(e[V],e[V+1]),C.lineTo(e[z],e[z+1]),C.close(),C.stroke()}}if(0!=_t&&0!=gt){i.set(d,yt),f=n.uvs;for(var U=mt,J=mt+_t,$=0;U<J;U+=y,$+=2)e[U+2]=f[$],e[U+3]=f[$+1];if(r=n.color,a=v.color,this.fillVertices(E,r,a,x,v),e=lt._vData,i=lt._iData,gt>0){for(var tt=yt,et=yt+gt;tt<et;tt++)i[tt]+=vt;if(t){g=t.m,Y=g[0],X=g[4],q=g[12],Z=g[1],K=g[5],Q=g[13];for(var it=mt,nt=mt+_t;it<nt;it+=y)G=e[it],j=e[it+1],e[it]=G*Y+j*X+q,e[it+1]=G*Z+j*K+Q}lt.adjust(_t/y,gt)}x.clipEndWithSlot(v)}else x.clipEndWithSlot(v)}else x.clipEndWithSlot(v);else x.clipEndWithSlot(v);else x.clipEndWithSlot(v);else x.clipEndWithSlot(v);if(x.clipEnd(),C&&u){var rt;C.strokeColor=D,C.fillColor=O;for(var at=0,st=b.bones.length;at<st;at++){var ot=(rt=b.bones[at]).data.length*rt.a+rt.worldX,ft=rt.data.length*rt.c+rt.worldY;C.moveTo(rt.worldX,rt.worldY),C.lineTo(ot,ft),C.stroke(),C.circle(rt.worldX,rt.worldY,1.5*Math.PI),C.fill(),0===at&&(C.fillColor=P)}}},b.cacheTraverse=function(t){var e=ct._curFrame;if(e){var i=e.segments;if(0!=i.length){var n,r,a,s,o,c,l=e.vertices,u=e.indices,h=0,f=0,d=0;t&&(c=t.m,Y=c[0],Z=c[1],X=c[4],K=c[5],q=c[12],Q=c[13]);var _=16&R,p=_&&1===Y&&0===Z&&0===X&&1===K,g=0,y=e.colors,T=y[g++],b=T.vfOffset;Et(T);for(var E=0,A=i.length;E<A;E++){var C=i[E];if(s=bt(C.tex,C.blendMode)){(W||s.getHash()!==ut.material.getHash())&&(W=!1,ut._flush(),ut.node=ht,ut.material=s),pt=C.vertexCount,gt=C.indexCount,o=lt.request(pt,gt),yt=o.indiceOffset,vt=o.vertexOffset,Tt=o.byteOffset>>2,n=lt._vData,r=lt._iData,a=lt._uintVData;for(var x=yt,S=yt+gt;x<S;x++)r[x]=vt+u[f++];if(d=C.vfCount,n.set(l.subarray(h,h+d),Tt),h+=d,p)for(var w=Tt,M=Tt+d;w<M;w+=6)n[w]+=q,n[w+1]+=Q;else if(_)for(var I=Tt,O=Tt+d;I<O;I+=6)G=n[I],j=n[I+1],n[I]=G*Y+j*X+q,n[I+1]=G*Z+j*K+Q;if(lt.adjust(pt,gt),ft)for(var D=h-d,P=Tt+4,L=Tt+4+d;P<L;P+=6,D+=6)D>=b&&(Et(T=y[g++]),b=T.vfOffset),a[P]=m,a[P+1]=v}}}}},b.fillBuffers=function(t,e){var i=t.node;if(i._renderFlag|=C.FLAG_UPDATE_RENDER_DATA,t._skeleton){var n=i._color;f=n.r/255,d=n.g/255,_=n.b/255,p=n.a/255,c=t.useTint||t.isAnimationCached(),g=c?w:S,y=c?6:5,ht=t.node,lt=e.getBuffer("spine",g),ut=e,ct=t,W=!0,r=t.premultipliedAlpha,a=1,R=0,ft=!1,dt=t._effectDelegate&&t._effectDelegate._vertexEffect,(4294967295!==n._val||r)&&(ft=!0),c&&(R|=1);var s=void 0;ct.enableBatch&&(s=ht._worldMatrix,W=!1,R|=16),t.isAnimationCached()?this.cacheTraverse(s):(dt&&dt.begin(t._skeleton),this.realTimeTraverse(s),dt&&dt.end()),e.worldMatDirty++,t.attachUtil._syncAttachedNode(),ht=void 0,lt=void 0,ut=void 0,ct=void 0,dt=null}},b.postFillBuffers=function(t,e){e.worldMatDirty--},n})(b.default);i.default=Ct,b.default.register(E,Ct),e.exports=i.default}),{"../../cocos2d/core/renderer/assembler":222,"../../cocos2d/core/renderer/render-flow":226,"../../cocos2d/core/renderer/webgl/vertex-format":267,"./Skeleton":355,"./lib/spine":357}],362:[(function(t,e){"use strict";var i=function(){this.start=null,this.end=null,this.complete=null,this.event=null,this.interrupt=null,this.dispose=null};i.getListeners=function(t){return t.listener||(t.listener=new i),t.listener},e.exports=i}),{}],363:[(function(t,e){"use strict";var i=t("./lib/spine");sp.VertexEffectDelegate=cc.Class({name:"sp.VertexEffectDelegate",ctor:function(){this._vertexEffect=null,this._interpolation=null,this._effectType="none"},clear:function(){this._vertexEffect=null,this._interpolation=null,this._effectType="none"},initJitter:function(t,e){return this._effectType="jitter",this._vertexEffect=new i.JitterEffect(t,e),this._vertexEffect},initSwirlWithPow:function(t,e){return this._interpolation=new i.Pow(e),this._vertexEffect=new i.SwirlEffect(t,this._interpolation),this._vertexEffect},initSwirlWithPowOut:function(t,e){return this._interpolation=new i.PowOut(e),this._vertexEffect=new i.SwirlEffect(t,this._interpolation),this._vertexEffect},getJitterVertexEffect:function(){return this._vertexEffect},getSwirlVertexEffect:function(){return this._vertexEffect},getVertexEffect:function(){return this._vertexEffect},getEffectType:function(){return this._effectType}}),e.exports=sp.VertexEffectDelegate}),{"./lib/spine":357}],364:[(function(t,e){"use strict";var i="undefined"==typeof window?global:window;i.cc=i.cc||{},cc.internal=cc.internal||{},t("./predefine"),t("./polyfill/string"),t("./polyfill/misc"),t("./polyfill/array"),t("./polyfill/object"),t("./polyfill/array-buffer"),t("./polyfill/number"),t("./polyfill/typescript"),t("./cocos2d/core/predefine"),t("./cocos2d"),t("./extends"),e.exports=i.cc}),{"./cocos2d":306,"./cocos2d/core/predefine":218,"./extends":352,"./package":void 0,"./polyfill/array":366,"./polyfill/array-buffer":365,"./polyfill/misc":367,"./polyfill/number":368,"./polyfill/object":369,"./polyfill/string":370,"./polyfill/typescript":371,"./predefine":372}],365:[(function(){"use strict";if(!ArrayBuffer.isView){var t=Object.getPrototypeOf(Int8Array);ArrayBuffer.isView="function"==typeof t?function(e){return e instanceof t}:function(t){if("object"!=typeof t)return!1;var e=t.constructor;return e===Float64Array||e===Float32Array||e===Uint8Array||e===Uint32Array||e===Int8Array}}}),{}],366:[(function(){"use strict";Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)}),Array.prototype.find||(Array.prototype.find=function(t){for(var e=this.length,i=0;i<e;i++){var n=this[i];if(t.call(this,n,i,this))return n}}),Array.prototype.includes||(Array.prototype.includes=function(t){return-1!==this.indexOf(t)})}),{}],367:[(function(){"use strict";if(Math.sign||(Math.sign=function(t){return 0==(t=+t)||isNaN(t)?t:t>0?1:-1}),Math.log2||(Math.log2=function(t){return Math.log(t)*Math.LOG2E}),Number.isInteger||(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),!console.time){var t=window.performance||Date,e=Object.create(null);console.time=function(i){e[i]=t.now()},console.timeEnd=function(i){var n=e[i],r=t.now()-n;console.log(i+": "+r+"ms")}}}),{}],368:[(function(){"use strict";Number.parseFloat=Number.parseFloat||parseFloat,Number.parseInt=Number.parseInt||parseInt}),{}],369:[(function(){"use strict";Object.assign||(Object.assign=function(t,e){return cc.js.mixin(t,e)}),Object.getOwnPropertyDescriptors||(Object.getOwnPropertyDescriptors=function(t){var e={},i=Object.getOwnPropertyNames(t);Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(t)));for(var n=0;n<i.length;++n){var r=i[n];e[r]=Object.getOwnPropertyDescriptor(t,r)}return e})}),{}],370:[(function(){"use strict";String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return e=e||0,this.lastIndexOf(t,e)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(t,e){(void 0===e||e>this.length)&&(e=this.length),e-=t.length;var i=this.indexOf(t,e);return-1!==i&&i===e}),String.prototype.trimLeft||(String.prototype.trimLeft=function(){return this.replace(/^\s+/,"")})}),{}],371:[(function(){"use strict";var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};window.__extends=function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)},window.__assign=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},window.__rest=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(t,n[r])&&(i[n[r]]=t[n[r]])}return i},window.__decorate=function(t,e,i,n){var r,a=arguments.length,s=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var o=t.length-1;o>=0;o--)(r=t[o])&&(s=(a<3?r(s):a>3?r(e,i,s):r(e,i))||s);return a>3&&s&&Object.defineProperty(e,i,s),s},window.__param=function(t,e){return function(i,n){e(i,n,t)}},window.__metadata=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},window.__awaiter=function(t,e,i,n){return new(i||(i=Promise))(function(r,a){function s(t){try{c(n.next(t))}catch(e){a(e)}}function o(t){try{c(n.throw(t))}catch(e){a(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(s,o)}c((n=n.apply(t,e||[])).next())})},window.__generator=function(t,e){var i,n,r,a,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(t){return function(e){return c([t,e])}}function c(a){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(r=2&a[0]?n.return:a[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(r=(r=s.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(6===a[0]&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(o){a=[6,o],n=0}finally{i=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},window.__exportStar=function(t,e){for(var i in t)"default"===i||e.hasOwnProperty(i)||__createBinding(e,t,i)},window.__createBinding=Object.create?function(t,e,i,n){void 0===n&&(n=i),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[i]}})}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]},window.__values=function(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],n=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},window.__read=function(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,r,a=i.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(n=a.next()).done;)s.push(n.value)}catch(o){r={error:o}}finally{try{n&&!n.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}return s},window.__spread=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(__read(arguments[e]));return t},window.__spreadArrays=function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),r=0;for(e=0;e<i;e++)for(var a=arguments[e],s=0,o=a.length;s<o;s++,r++)n[r]=a[s];return n},window.__await=function(t){return this instanceof __await?(this.v=t,this):new __await(t)},window.__asyncGenerator=function(t,e,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,r=i.apply(t,e||[]),a=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(t){r[t]&&(n[t]=function(e){return new Promise(function(i,n){a.push([t,e,i,n])>1||o(t,e)})})}function o(t,e){try{(i=r[t](e)).value instanceof __await?Promise.resolve(i.value.v).then(c,l):u(a[0][2],i)}catch(n){u(a[0][3],n)}var i}function c(t){o("next",t)}function l(t){o("throw",t)}function u(t,e){t(e),a.shift(),a.length&&o(a[0][0],a[0][1])}},window.__asyncDelegator=function(t){var e,i;return e={},n("next"),n("throw",(function(t){throw t})),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,r){e[n]=t[n]?function(e){return(i=!i)?{value:__await(t[n](e)),done:"return"===n}:r?r(e):e}:r}},window.__asyncValues=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,i=t[Symbol.asyncIterator];return i?i.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(i){e[i]=t[i]&&function(e){return new Promise(function(n,a){r(n,a,(e=t[i](e)).done,e.value)})}}function r(t,e,i,n){Promise.resolve(n).then((function(e){t({value:e,done:i})}),e)}},window.__makeTemplateObject=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t};var e=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};window.__importStar=function(t){if(t&&t.__esModule)return t;var i={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&__createBinding(i,t,n);return e(i,t),i},window.__importDefault=function(t){return t&&t.__esModule?t:{default:t}},window.__classPrivateFieldGet=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},window.__classPrivateFieldSet=function(t,e,i){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,i),i}}),{}],372:[(function(){"use strict";var t="undefined"==typeof window?global:window;function e(e,i){void 0===t[e]&&Object.defineProperty(t,e,{get:function(){var t;return"CC_WECHATGAMESUB"===e?t="cc.sys.platform === cc.sys.WECHAT_GAME_SUB":"CC_WECHATGAME"===e?t="cc.sys.platform === cc.sys.WECHAT_GAME":"CC_QQPLAY"===e&&(t="cc.sys.platform === cc.sys.QQ_PLAY"),cc.warnID(1400,e,t),i}})}function i(e){return"object"==typeof t[e]}(function(e,i){void 0===t[e]&&(t[e]=i)})("CC_BUILD",!1),t.CC_BUILD=!0,t.CC_DEV=!1,t.CC_DEBUG=!1,t.CC_JSB=!1,t.CC_NATIVERENDERER=!1,t.CC_SUPPORT_JIT=!1,t.CC_PHYSICS_BUILTIN=!1,t.CC_PHYSICS_CANNON=!0,t.CC_EDITOR=!1,t.CC_PREVIEW=!1,t.CC_TEST=!1,t.CC_RUNTIME=!1,t.CC_JSB=!1;var n=!(!i("wx")||!wx.getSharedCanvas),r=!(!i("wx")||!wx.getSystemInfoSync&&!wx.getSharedCanvas),a=i("bk");e("CC_WECHATGAMESUB",n),e("CC_WECHATGAME",r),e("CC_QQPLAY",a),t.CocosEngine=cc.ENGINE_VERSION="2.4.3"}),{}]},{},[364]);
});
define("main.js", function(require, module, exports){


window.boot = function () {
  var settings = window._CCSettings;
  window._CCSettings = undefined;

  var onStart = function onStart() {
    cc.view.enableRetina(true);
    cc.view.resizeWithBrowserSize(true);
    var launchScene = settings.launchScene; // load scene

    cc.director.loadScene(launchScene, null, function () {
      console.log('Success to load scene: ' + launchScene);
    });
  };

  var isSubContext = cc.sys.platform === cc.sys.WECHAT_GAME_SUB;
  var option = {
    id: 'GameCanvas',
    debugMode: settings.debug ? cc.debug.DebugMode.INFO : cc.debug.DebugMode.ERROR,
    showFPS: !isSubContext && settings.debug,
    frameRate: 60,
    groupList: settings.groupList,
    collisionMatrix: settings.collisionMatrix
  };
  cc.assetManager.init({
    bundleVers: settings.bundleVers,
    subpackages: settings.subpackages,
    remoteBundles: settings.remoteBundles,
    server: settings.server,
    subContextRoot: settings.subContextRoot
  });
  var RESOURCES = cc.AssetManager.BuiltinBundleName.RESOURCES;
  var INTERNAL = cc.AssetManager.BuiltinBundleName.INTERNAL;
  var MAIN = cc.AssetManager.BuiltinBundleName.MAIN;
  var START_SCENE = cc.AssetManager.BuiltinBundleName.START_SCENE;
  var bundleRoot = [INTERNAL];
  settings.hasResourcesBundle && bundleRoot.push(RESOURCES);
  settings.hasStartSceneBundle && bundleRoot.push(MAIN);
  var count = 0;

  function cb(err) {
    if (err) return console.error(err.message, err.stack);
    count++;

    if (count === bundleRoot.length + 1) {
      // if there is start-scene bundle. should load start-scene bundle in the last stage
      // Otherwise the main bundle should be the last
      cc.assetManager.loadBundle(settings.hasStartSceneBundle ? START_SCENE : MAIN, function (err) {
        if (!err) cc.game.run(option, onStart);
      });
    }
  } // load plugins


  cc.assetManager.loadScript(settings.jsList.map(function (x) {
    return 'src/' + x;
  }), cb); // load bundles

  for (var i = 0; i < bundleRoot.length; i++) {
    cc.assetManager.loadBundle(bundleRoot[i], cb);
  }
};
});
define("physics-min.js", function(require, module, exports){
var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

(function t(e, i, o) {
  function n(s, a) {
    if (!i[s]) {
      if (!e[s]) {
        var l = "function" == typeof require && require;if (!a && l) return l(s, !0);if (r) return r(s, !0);var h = new Error("Cannot find module '" + s + "'");throw h.code = "MODULE_NOT_FOUND", h;
      }var c = i[s] = { exports: {} };e[s][0].call(c.exports, function (t) {
        return n(e[s][1][t] || t);
      }, c, c.exports, t, e, i, o);
    }return i[s].exports;
  }for (var r = "function" == typeof require && require, s = 0; s < o.length; s++) {
    n(o[s]);
  }return n;
})({ 1: [function (t, e, i) {
    "use strict";
    i.__esModule = !0, i.CannonRigidBody = void 0;var o,
        n = (o = t("../../../../../external/cannon/cannon")) && o.__esModule ? o : { default: o };function r(t, e) {
      for (var i = 0; i < e.length; i++) {
        var o = e[i];o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(t, o.key, o);
      }
    }var s = new n.default.Vec3(),
        a = new n.default.Vec3(),
        l = cc.Vec3,
        h = function () {
      function t() {
        this._isEnabled = !1;
      }var e,
          i,
          o = t.prototype;return o.__preload = function (t) {
        this._rigidBody = t, this._sharedBody = cc.director.getPhysics3DManager().physicsWorld.getSharedBody(this._rigidBody.node), this._sharedBody.reference = !0, this._sharedBody.wrappedBody = this;
      }, o.onLoad = function () {}, o.onEnable = function () {
        this._isEnabled = !0, this.mass = this._rigidBody.mass, this.allowSleep = this._rigidBody.allowSleep, this.linearDamping = this._rigidBody.linearDamping, this.angularDamping = this._rigidBody.angularDamping, this.useGravity = this._rigidBody.useGravity, this.isKinematic = this._rigidBody.isKinematic, this.fixedRotation = this._rigidBody.fixedRotation, this.linearFactor = this._rigidBody.linearFactor, this.angularFactor = this._rigidBody.angularFactor, this._sharedBody.enabled = !0;
      }, o.onDisable = function () {
        this._isEnabled = !1, this._sharedBody.enabled = !1;
      }, o.onDestroy = function () {
        this._sharedBody.reference = !1, this._rigidBody = null, this._sharedBody = null;
      }, o.wakeUp = function () {
        return this._sharedBody.body.wakeUp();
      }, o.sleep = function () {
        return this._sharedBody.body.sleep();
      }, o.getLinearVelocity = function (t) {
        return l.copy(t, this._sharedBody.body.velocity), t;
      }, o.setLinearVelocity = function (t) {
        var e = this._sharedBody.body;e.isSleeping() && e.wakeUp(), l.copy(e.velocity, t);
      }, o.getAngularVelocity = function (t) {
        return l.copy(t, this._sharedBody.body.angularVelocity), t;
      }, o.setAngularVelocity = function (t) {
        var e = this._sharedBody.body;e.isSleeping() && e.wakeUp(), l.copy(e.angularVelocity, t);
      }, o.applyForce = function (t, e) {
        null == e && (e = l.ZERO);var i = this._sharedBody.body;i.isSleeping() && i.wakeUp(), i.applyForce(l.copy(s, t), l.copy(a, e));
      }, o.applyImpulse = function (t, e) {
        null == e && (e = l.ZERO);var i = this._sharedBody.body;i.isSleeping() && i.wakeUp(), i.applyImpulse(l.copy(s, t), l.copy(a, e));
      }, o.applyLocalForce = function (t, e) {
        null == e && (e = l.ZERO);var i = this._sharedBody.body;i.isSleeping() && i.wakeUp(), i.applyLocalForce(l.copy(s, t), l.copy(a, e));
      }, o.applyLocalImpulse = function (t, e) {
        null == e && (e = l.ZERO);var i = this._sharedBody.body;i.isSleeping() && i.wakeUp(), i.applyLocalImpulse(l.copy(s, t), l.copy(a, e));
      }, o.applyTorque = function (t) {
        var e = this._sharedBody.body;e.isSleeping() && e.wakeUp(), e.torque.x += t.x, e.torque.y += t.y, e.torque.z += t.z;
      }, o.applyLocalTorque = function (t) {
        var e = this._sharedBody.body;e.isSleeping() && e.wakeUp(), l.copy(s, t), e.vectorToWorldFrame(s, s), e.torque.x += s.x, e.torque.y += s.y, e.torque.z += s.z;
      }, e = t, (i = [{ key: "isAwake", get: function get() {
          return this._sharedBody.body.isAwake();
        } }, { key: "isSleepy", get: function get() {
          return this._sharedBody.body.isSleepy();
        } }, { key: "isSleeping", get: function get() {
          return this._sharedBody.body.isSleeping();
        } }, { key: "allowSleep", set: function set(t) {
          var e = this._sharedBody.body;e.isSleeping() && e.wakeUp(), e.allowSleep = t;
        } }, { key: "mass", set: function set(t) {
          var e = this._sharedBody.body;e.mass = t, 0 == e.mass ? e.type = n.default.Body.STATIC : e.type = this._rigidBody.isKinematic ? n.default.Body.KINEMATIC : n.default.Body.DYNAMIC, e.updateMassProperties(), e.isSleeping() && e.wakeUp();
        } }, { key: "isKinematic", set: function set(t) {
          var e = this._sharedBody.body;0 == e.mass ? e.type = n.default.Body.STATIC : e.type = t ? n.default.Body.KINEMATIC : n.default.Body.DYNAMIC;
        } }, { key: "fixedRotation", set: function set(t) {
          var e = this._sharedBody.body;e.isSleeping() && e.wakeUp(), e.fixedRotation = t, e.updateMassProperties();
        } }, { key: "linearDamping", set: function set(t) {
          this._sharedBody.body.linearDamping = t;
        } }, { key: "angularDamping", set: function set(t) {
          this._sharedBody.body.angularDamping = t;
        } }, { key: "useGravity", set: function set(t) {
          var e = this._sharedBody.body;e.isSleeping() && e.wakeUp(), e.useGravity = t;
        } }, { key: "linearFactor", set: function set(t) {
          var e = this._sharedBody.body;e.isSleeping() && e.wakeUp(), l.copy(e.linearFactor, t);
        } }, { key: "angularFactor", set: function set(t) {
          var e = this._sharedBody.body;e.isSleeping() && e.wakeUp(), l.copy(e.angularFactor, t);
        } }, { key: "rigidBody", get: function get() {
          return this._rigidBody;
        } }, { key: "sharedBody", get: function get() {
          return this._sharedBody;
        } }, { key: "isEnabled", get: function get() {
          return this._isEnabled;
        } }]) && r(e.prototype, i), t;
    }();i.CannonRigidBody = h;
  }, { "../../../../../external/cannon/cannon": 24 }], 2: [function (t, e, i) {
    "use strict";
    i.__esModule = !0, i.CannonSharedBody = void 0;var o,
        n = (o = t("../../../../../external/cannon/cannon")) && o.__esModule ? o : { default: o },
        r = t("../framework/physics-enum"),
        s = t("../framework/util"),
        a = t("./cannon-util");function l(t, e) {
      for (var i = 0; i < e.length; i++) {
        var o = e[i];o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(t, o.key, o);
      }
    }var h = cc.Node._LocalDirtyFlag.PHYSICS_SCALE,
        c = cc.Quat,
        p = cc.Vec3,
        u = cc.js.array.fastRemoveAt,
        d = new p(),
        y = new c(),
        f = [],
        v = { type: "collision-enter", selfCollider: null, otherCollider: null, contacts: [] },
        m = function () {
      var t, e;function i(t, e) {
        this.node = void 0, this.wrappedWorld = void 0, this.body = new n.default.Body(), this.shapes = [], this.wrappedBody = null, this.index = -1, this.ref = 0, this.onCollidedListener = this.onCollided.bind(this), this.wrappedWorld = e, this.node = t, this.body.material = this.wrappedWorld.world.defaultMaterial, this.body.addEventListener("cc-collide", this.onCollidedListener), this._updateGroup(), this.node.on(cc.Node.EventType.GROUP_CHANGED, this._updateGroup, this);
      }i.getSharedBody = function (t, e) {
        var o = t._id;if (i.sharedBodiesMap.has(o)) return i.sharedBodiesMap.get(o);var n = new i(t, e);return i.sharedBodiesMap.set(t._id, n), n;
      }, t = i, (e = [{ key: "enabled", set: function set(t) {
          if (t) {
            if (this.index < 0) {
              this.index = this.wrappedWorld.bodies.length, this.wrappedWorld.addSharedBody(this);var e = this.node;this.body.aabbNeedsUpdate = !0, e.getWorldPosition(d), e.getWorldRotation(y);var i = this.body.position;i.x = parseFloat(d.x.toFixed(3)), i.y = parseFloat(d.y.toFixed(3)), i.z = parseFloat(d.z.toFixed(3));var o = this.body.quaternion;if (o.x = parseFloat(y.x.toFixed(12)), o.y = parseFloat(y.y.toFixed(12)), o.z = parseFloat(y.z.toFixed(12)), o.w = parseFloat(y.w.toFixed(12)), e._localMatDirty & h) {
                for (var n = e.__wscale, r = 0; r < this.shapes.length; r++) {
                  this.shapes[r].setScale(n);
                }(0, a.commitShapeUpdates)(this.body);
              }this.body.isSleeping() && this.body.wakeUp();
            }
          } else this.index >= 0 && (0 == this.shapes.length && null == this.wrappedBody || 0 == this.shapes.length && null != this.wrappedBody && !this.wrappedBody.rigidBody.enabledInHierarchy || 0 == this.shapes.length && null != this.wrappedBody && !this.wrappedBody.isEnabled) && (this.body.sleep(), this.index = -1, this.wrappedWorld.removeSharedBody(this));
        } }, { key: "reference", set: function set(t) {
          t ? this.ref++ : this.ref--, 0 == this.ref && this.destroy();
        } }]) && l(t.prototype, e);var o = i.prototype;return o._updateGroup = function () {
        (0, a.groupIndexToBitMask)(this.node.groupIndex, this.body);
      }, o.addShape = function (t) {
        if (this.shapes.indexOf(t) < 0) {
          var e = this.body.shapes.length;this.body.addShape(t.shape), this.shapes.push(t), t.setIndex(e);var i = this.body.shapeOffsets[e],
              o = this.body.shapeOrientations[e];t.setOffsetAndOrient(i, o);
        }
      }, o.removeShape = function (t) {
        var e = this.shapes.indexOf(t);e >= 0 && (u(this.shapes, e), this.body.removeShape(t.shape), t.setIndex(-1));
      }, o.syncSceneToPhysics = function (t) {
        void 0 === t && (t = !1);var e = this.node,
            i = (0, s.updateWorldTransform)(e, t);if (t || i) {
          if (this.body.aabbNeedsUpdate = !0, p.copy(this.body.position, e.__wpos), c.copy(this.body.quaternion, e.__wrot), e._localMatDirty & h) {
            for (var o = e.__wscale, n = 0; n < this.shapes.length; n++) {
              this.shapes[n].setScale(o);
            }(0, a.commitShapeUpdates)(this.body);
          }this.body.isSleeping() && this.body.wakeUp();
        }
      }, o.syncPhysicsToScene = function () {
        this.body.type == r.ERigidBodyType.STATIC || this.body.isSleeping() || (p.copy(d, this.body.position), c.copy(y, this.body.quaternion), (0, s.updateWorldRT)(this.node, d, y));
      }, o.destroy = function () {
        this.body.removeEventListener("cc-collide", this.onCollidedListener), this.node.off(cc.Node.EventType.GROUP_CHANGED, this._updateGroup, this), i.sharedBodiesMap.delete(this.node._id), delete n.default.World.idToBodyMap[this.body.id], this.node = null, this.wrappedWorld = null, this.body = null, this.shapes = null, this.onCollidedListener = null;
      }, o.onCollided = function (t) {
        v.type = t.event;var e = (0, s.getWrap)(t.selfShape),
            i = (0, s.getWrap)(t.otherShape);if (e) {
          v.selfCollider = e.collider, v.otherCollider = i ? i.collider : null;var o = 0;for (o = v.contacts.length; o--;) {
            f.push(v.contacts.pop());
          }for (o = 0; o < t.contacts.length; o++) {
            var n = t.contacts[o];if (f.length > 0) {
              var r = f.pop();p.copy(r.contactA, n.ri), p.copy(r.contactB, n.rj), p.copy(r.normal, n.ni), v.contacts.push(r);
            } else {
              var l = { contactA: p.copy(new p(), n.ri), contactB: p.copy(new p(), n.rj), normal: p.copy(new p(), n.ni) };v.contacts.push(l);
            }
          }for (o = 0; o < this.shapes.length; o++) {
            var h = this.shapes[o];v.type = a.deprecatedEventMap[v.type], h.collider.emit(v.type, v), v.type = t.event, h.collider.emit(v.type, v);
          }
        }
      }, i;
    }();i.CannonSharedBody = m, m.sharedBodiesMap = new Map();
  }, { "../../../../../external/cannon/cannon": 24, "../framework/physics-enum": 19, "../framework/util": 23, "./cannon-util": 3 }], 3: [function (t, e, i) {
    "use strict";
    i.__esModule = !0, i.groupIndexToBitMask = r, i.toCannonRaycastOptions = function (t, e) {
      t.checkCollisionResponse = !e.queryTrigger, r(e.groupIndex, t), t.skipBackFaces = !1;
    }, i.fillRaycastResult = function (t, e) {
      t._assign(n.copy(new n(), e.hitPointWorld), e.distance, (0, o.getWrap)(e.shape).collider);
    }, i.commitShapeUpdates = function (t) {
      t.aabbNeedsUpdate = !0, t.updateMassProperties(), t.updateBoundingRadius();
    }, i.deprecatedEventMap = void 0;var o = t("../framework/util"),
        n = cc.Vec3;function r(t, e) {
      var i = 1 << t,
          o = 0,
          n = cc.game.collisionMatrix[t];if (n) {
        for (var r = 0; r < n.length; r++) {
          n[r] && (o |= 1 << r);
        }e.collisionFilterGroup = i, e.collisionFilterMask = o;
      } else cc.error("cannon-utils: group is not exist", t);
    }i.deprecatedEventMap = { onCollisionEnter: "collision-enter", onCollisionStay: "collision-stay", onCollisionExit: "collision-exit", onTriggerEnter: "trigger-enter", onTriggerStay: "trigger-stay", onTriggerExit: "trigger-exit" };
  }, { "../framework/util": 23 }], 4: [function (t, e, i) {
    "use strict";
    i.__esModule = !0, i.CannonWorld = void 0;var o,
        n = (o = t("../../../../../external/cannon/cannon")) && o.__esModule ? o : { default: o },
        r = t("./cannon-util"),
        s = t("./shapes/cannon-shape"),
        a = t("./cannon-shared-body"),
        l = t("../framework/util");function h(t, e) {
      for (var i = 0; i < e.length; i++) {
        var o = e[i];o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(t, o.key, o);
      }
    }var c = cc.Vec3,
        p = cc.js.array.fastRemoveAt,
        u = function () {
      var t, e;function i() {
        this.bodies = [], this._world = void 0, this._raycastResult = new n.default.RaycastResult(), this._world = new n.default.World(), this._world.broadphase = new n.default.NaiveBroadphase(), this._world.addEventListener("postStep", this.onPostStep.bind(this));
      }t = i, (e = [{ key: "world", get: function get() {
          return this._world;
        } }, { key: "defaultMaterial", set: function set(t) {
          this._world.defaultMaterial.friction = t.friction, this._world.defaultMaterial.restitution = t.restitution, null != s.CannonShape.idToMaterial[t._uuid] && (s.CannonShape.idToMaterial[t._uuid] = this._world.defaultMaterial);
        } }, { key: "allowSleep", set: function set(t) {
          this._world.allowSleep = t;
        } }, { key: "gravity", set: function set(t) {
          c.copy(this._world.gravity, t);
        } }]) && h(t.prototype, e);var o = i.prototype;return o.onPostStep = function () {
        var t = cc.director.getPhysics3DManager();if (t.useFixedDigit) for (var e = t.fixDigits.position, i = t.fixDigits.rotation, o = this._world.bodies, r = 0; r < o.length; r++) {
          var s = o[r];if (s.type != n.default.Body.STATIC && !s.isSleeping()) {
            var a = s.position;a.x = parseFloat(a.x.toFixed(e)), a.y = parseFloat(a.y.toFixed(e)), a.z = parseFloat(a.z.toFixed(e));var l = s.quaternion;l.x = parseFloat(l.x.toFixed(i)), l.y = parseFloat(l.y.toFixed(i)), l.z = parseFloat(l.z.toFixed(i)), l.w = parseFloat(l.w.toFixed(i));var h = s.velocity;h.x = parseFloat(h.x.toFixed(e)), h.y = parseFloat(h.y.toFixed(e)), h.z = parseFloat(h.z.toFixed(e));var c = s.angularVelocity;c.x = parseFloat(c.x.toFixed(e)), c.y = parseFloat(c.y.toFixed(e)), c.z = parseFloat(c.z.toFixed(e));
          }
        }
      }, o.step = function (t, e, i) {
        this.syncSceneToPhysics(), this._world.step(t, e, i), this.syncPhysicsToScene(), this.emitEvents();
      }, o.syncSceneToPhysics = function () {
        (0, l.clearNodeTransformRecord)();for (var t = 0; t < this.bodies.length; t++) {
          this.bodies[t].syncSceneToPhysics();
        }(0, l.clearNodeTransformDirtyFlag)();
      }, o.syncPhysicsToScene = function () {
        for (var t = 0; t < this.bodies.length; t++) {
          this.bodies[t].syncPhysicsToScene();
        }
      }, o.emitEvents = function () {
        this._world.emitTriggeredEvents(), this._world.emitCollisionEvents();
      }, o.raycastClosest = function (t, e, i) {
        f(t, e.maxDistance), (0, r.toCannonRaycastOptions)(v, e);var o = this._world.raycastClosest(d, y, v, this._raycastResult);return o && (0, r.fillRaycastResult)(i, this._raycastResult), o;
      }, o.raycast = function (t, e, i, o) {
        return f(t, e.maxDistance), (0, r.toCannonRaycastOptions)(v, e), this._world.raycastAll(d, y, v, function (t) {
          var e = i.add();(0, r.fillRaycastResult)(e, t), o.push(e);
        });
      }, o.getSharedBody = function (t) {
        return a.CannonSharedBody.getSharedBody(t, this);
      }, o.addSharedBody = function (t) {
        this.bodies.indexOf(t) < 0 && (this.bodies.push(t), this._world.addBody(t.body));
      }, o.removeSharedBody = function (t) {
        var e = this.bodies.indexOf(t);e >= 0 && (p(this.bodies, e), this._world.remove(t.body));
      }, i;
    }();i.CannonWorld = u;var d = new n.default.Vec3(),
        y = new n.default.Vec3();function f(t, e) {
      c.copy(d, t.o), t.computeHit(y, e);
    }var v = { checkCollisionResponse: !1, collisionFilterGroup: -1, collisionFilterMask: -1, skipBackFaces: !1 };
  }, { "../../../../../external/cannon/cannon": 24, "../framework/util": 23, "./cannon-shared-body": 2, "./cannon-util": 3, "./shapes/cannon-shape": 7 }], 5: [function (t) {
    "use strict";
    var e = t("../framework/physics-selector"),
        i = t("./cannon-rigid-body"),
        o = t("./cannon-world"),
        n = t("./shapes/cannon-box-shape"),
        r = t("./shapes/cannon-sphere-shape");(0, e.instantiate)(n.CannonBoxShape, r.CannonSphereShape, i.CannonRigidBody, o.CannonWorld);
  }, { "../framework/physics-selector": 22, "./cannon-rigid-body": 1, "./cannon-world": 4, "./shapes/cannon-box-shape": 6, "./shapes/cannon-sphere-shape": 8 }], 6: [function (t, e, i) {
    "use strict";
    i.__esModule = !0, i.CannonBoxShape = void 0;var o,
        n = (o = t("../../../../../../external/cannon/cannon")) && o.__esModule ? o : { default: o },
        r = t("../cannon-util"),
        s = t("./cannon-shape");function a(t, e) {
      for (var i = 0; i < e.length; i++) {
        var o = e[i];o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(t, o.key, o);
      }
    }function l(t, e, i) {
      return e && a(t.prototype, e), i && a(t, i), t;
    }var h = cc.Vec3,
        c = new h(),
        p = function (t) {
      var e, i;function o(e) {
        var i;return (i = t.call(this) || this).halfExtent = new n.default.Vec3(), h.multiplyScalar(i.halfExtent, e, .5), i._shape = new n.default.Box(i.halfExtent.clone()), i;
      }i = t, (e = o).prototype = Object.create(i.prototype), e.prototype.constructor = e, e.__proto__ = i, l(o, [{ key: "boxCollider", get: function get() {
          return this.collider;
        } }, { key: "box", get: function get() {
          return this._shape;
        } }]);var s = o.prototype;return s.onLoad = function () {
        t.prototype.onLoad.call(this), this.size = this.boxCollider.size;
      }, s.setScale = function (e) {
        t.prototype.setScale.call(this, e), this.size = this.boxCollider.size;
      }, l(o, [{ key: "size", set: function set(t) {
          this.collider.node.getWorldScale(c), h.multiplyScalar(this.halfExtent, t, .5), h.multiply(this.box.halfExtents, this.halfExtent, c), this.box.updateConvexPolyhedronRepresentation(), -1 != this._index && (0, r.commitShapeUpdates)(this._body);
        } }]), o;
    }(s.CannonShape);i.CannonBoxShape = p;
  }, { "../../../../../../external/cannon/cannon": 24, "../cannon-util": 3, "./cannon-shape": 7 }], 7: [function (t, e, i) {
    "use strict";
    i.__esModule = !0, i.CannonShape = void 0;var o,
        n = (o = t("../../../../../../external/cannon/cannon")) && o.__esModule ? o : { default: o },
        r = t("../../framework/util"),
        s = t("../cannon-util");function a(t, e) {
      for (var i = 0; i < e.length; i++) {
        var o = e[i];o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(t, o.key, o);
      }
    }var l = { type: "trigger-enter", selfCollider: null, otherCollider: null },
        h = cc.Vec3,
        c = new h(),
        p = function () {
      function t() {
        this._offset = new n.default.Vec3(), this._orient = new n.default.Quaternion(), this._index = -1, this.onTriggerListener = this.onTrigger.bind(this);
      }var e,
          i,
          o = t.prototype;return o.__preload = function (t) {
        this._collider = t, (0, r.setWrap)(this._shape, this), this._shape.addEventListener("cc-trigger", this.onTriggerListener), this._sharedBody = cc.director.getPhysics3DManager().physicsWorld.getSharedBody(this._collider.node), this._sharedBody.reference = !0;
      }, o.onLoad = function () {
        this.center = this._collider.center, this.isTrigger = this._collider.isTrigger;
      }, o.onEnable = function () {
        this._sharedBody.addShape(this), this._sharedBody.enabled = !0;
      }, o.onDisable = function () {
        this._sharedBody.removeShape(this), this._sharedBody.enabled = !1;
      }, o.onDestroy = function () {
        this._sharedBody.reference = !1, this._shape.removeEventListener("cc-trigger", this.onTriggerListener), delete n.default.World.idToShapeMap[this._shape.id], this._sharedBody = null, (0, r.setWrap)(this._shape, null), this._offset = null, this._orient = null, this._shape = null, this._collider = null, this.onTriggerListener = null;
      }, o.setScale = function () {
        this._setCenter(this._collider.center);
      }, o.setIndex = function (t) {
        this._index = t;
      }, o.setOffsetAndOrient = function (t, e) {
        cc.Vec3.copy(t, this._offset), cc.Vec3.copy(e, this._orient), this._offset = t, this._orient = e;
      }, o._setCenter = function (t) {
        var e = this._offset;h.copy(e, t), this._collider.node.getWorldScale(c), h.multiply(e, e, c);
      }, o.onTrigger = function (t) {
        l.type = t.event;var e = (0, r.getWrap)(t.selfShape),
            i = (0, r.getWrap)(t.otherShape);e && (l.selfCollider = e.collider, l.otherCollider = i ? i.collider : null, l.type = s.deprecatedEventMap[l.type], this._collider.emit(l.type, l), l.type = t.event, this._collider.emit(l.type, l));
      }, e = t, (i = [{ key: "shape", get: function get() {
          return this._shape;
        } }, { key: "collider", get: function get() {
          return this._collider;
        } }, { key: "attachedRigidBody", get: function get() {
          return this._sharedBody.wrappedBody ? this._sharedBody.wrappedBody.rigidBody : null;
        } }, { key: "sharedBody", get: function get() {
          return this._sharedBody;
        } }, { key: "material", set: function set(e) {
          null == e ? this._shape.material = null : (null == t.idToMaterial[e._uuid] && (t.idToMaterial[e._uuid] = new n.default.Material(e._uuid)), this._shape.material = t.idToMaterial[e._uuid], this._shape.material.friction = e.friction, this._shape.material.restitution = e.restitution);
        } }, { key: "isTrigger", set: function set(t) {
          this._shape.collisionResponse = !t, this._index >= 0 && this._body.updateHasTrigger();
        } }, { key: "center", set: function set(t) {
          this._setCenter(t), this._index >= 0 && (0, s.commitShapeUpdates)(this._body);
        } }, { key: "_body", get: function get() {
          return this._sharedBody.body;
        } }]) && a(e.prototype, i), t;
    }();i.CannonShape = p, p.idToMaterial = {};
  }, { "../../../../../../external/cannon/cannon": 24, "../../framework/util": 23, "../cannon-util": 3 }], 8: [function (t, e, i) {
    "use strict";
    i.__esModule = !0, i.CannonSphereShape = void 0;var o,
        n = (o = t("../../../../../../external/cannon/cannon")) && o.__esModule ? o : { default: o },
        r = t("../cannon-util"),
        s = t("./cannon-shape");function a(t, e) {
      for (var i = 0; i < e.length; i++) {
        var o = e[i];o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(t, o.key, o);
      }
    }var l = new cc.Vec3(),
        h = function (t) {
      var e, i, o, s;function h(e) {
        var i;return (i = t.call(this) || this)._radius = void 0, i._radius = e, i._shape = new n.default.Sphere(i._radius), i;
      }i = t, (e = h).prototype = Object.create(i.prototype), e.prototype.constructor = e, e.__proto__ = i, o = h, (s = [{ key: "sphereCollider", get: function get() {
          return this.collider;
        } }, { key: "sphere", get: function get() {
          return this._shape;
        } }, { key: "radius", get: function get() {
          return this._radius;
        }, set: function set(t) {
          this.collider.node.getWorldScale(l);var e = l.maxAxis();this.sphere.radius = t * Math.abs(e), this.sphere.updateBoundingSphereRadius(), -1 != this._index && (0, r.commitShapeUpdates)(this._body);
        } }]) && a(o.prototype, s);var c = h.prototype;return c.onLoad = function () {
        t.prototype.onLoad.call(this), this.radius = this.sphereCollider.radius;
      }, c.setScale = function (e) {
        t.prototype.setScale.call(this, e), this.radius = this.sphereCollider.radius;
      }, h;
    }(s.CannonShape);i.CannonSphereShape = h;
  }, { "../../../../../../external/cannon/cannon": 24, "../cannon-util": 3, "./cannon-shape": 7 }], 9: [function (t) {
    "use strict";
    t("../cannon/instantiate");var e,
        i = (e = t("../../../../../external/cannon/cannon")) && e.__esModule ? e : { default: e };window && (window.CANNON = i.default);
  }, { "../../../../../external/cannon/cannon": 24, "../cannon/instantiate": 5 }], 10: [function (t, e, i) {
    "use strict";
    i.__esModule = !0;var o = t("../framework");Object.keys(o).forEach(function (t) {
      "default" !== t && "__esModule" !== t && (i[t] = o[t]);
    });
  }, { "../framework": 17 }], 11: [function (t, e, i) {
    "use strict";
    var o, n, r, s, a, l;function h(t, e, i, o) {
      i && Object.defineProperty(t, e, { enumerable: i.enumerable, configurable: i.configurable, writable: i.writable, value: i.initializer ? i.initializer.call(o) : void 0 });
    }function c(t) {
      if (void 0 === t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t;
    }function p(t, e) {
      for (var i = 0; i < e.length; i++) {
        var o = e[i];o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(t, o.key, o);
      }
    }function u(t, e, i, o, n) {
      var r = {};return Object.keys(o).forEach(function (t) {
        r[t] = o[t];
      }), r.enumerable = !!r.enumerable, r.configurable = !!r.configurable, ("value" in r || r.initializer) && (r.writable = !0), r = i.slice().reverse().reduce(function (i, o) {
        return o(t, e, i) || i;
      }, r), n && void 0 !== r.initializer && (r.value = r.initializer ? r.initializer.call(n) : void 0, r.initializer = void 0), void 0 === r.initializer && (Object.defineProperty(t, e, r), r = null), r;
    }i.__esModule = !0, i.PhysicsMaterial = void 0;var d = cc._decorator,
        y = d.ccclass,
        f = d.property,
        v = cc.js.array.fastRemove,
        m = cc.math.equals,
        g = y("cc.PhysicsMaterial")((l = a = function (t) {
      var e, i, o, n;function a() {
        var e;return h(e = t.call(this) || this, "_friction", r, c(e)), h(e, "_restitution", s, c(e)), cc.EventTarget.call(c(e)), a.allMaterials.push(c(e)), "" == e._uuid && (e._uuid = "pm_" + a._idCounter++), e;
      }i = t, (e = a).prototype = Object.create(i.prototype), e.prototype.constructor = e, e.__proto__ = i, o = a, (n = [{ key: "friction", get: function get() {
          return this._friction;
        }, set: function set(t) {
          m(this._friction, t) || (this._friction = t, this.emit("physics_material_update"));
        } }, { key: "restitution", get: function get() {
          return this._restitution;
        }, set: function set(t) {
          m(this._restitution, t) || (this._restitution = t, this.emit("physics_material_update"));
        } }]) && p(o.prototype, n);var l = a.prototype;return l.clone = function () {
        var t = new a();return t._friction = this._friction, t._restitution = this._restitution, t;
      }, l.destroy = function () {
        return !!t.prototype.destroy.call(this) && (v(a.allMaterials, this), !0);
      }, a;
    }(cc.Asset), a.allMaterials = [], a._idCounter = 0, r = u((n = l).prototype, "_friction", [f], { configurable: !0, enumerable: !0, writable: !0, initializer: function initializer() {
        return .1;
      } }), s = u(n.prototype, "_restitution", [f], { configurable: !0, enumerable: !0, writable: !0, initializer: function initializer() {
        return .1;
      } }), u(n.prototype, "friction", [f], Object.getOwnPropertyDescriptor(n.prototype, "friction"), n.prototype), u(n.prototype, "restitution", [f], Object.getOwnPropertyDescriptor(n.prototype, "restitution"), n.prototype), o = n)) || o;i.PhysicsMaterial = g, cc.js.mixin(g.prototype, cc.EventTarget.prototype), cc.PhysicsMaterial = g;
  }, {}], 12: [function (t, e, i) {
    "use strict";
    i.__esModule = !0, i.BoxCollider3D = void 0;var o,
        n,
        r,
        s,
        a,
        l,
        h,
        c = t("../../instance"),
        p = t("./collider-component");function u(t, e, i, o) {
      i && Object.defineProperty(t, e, { enumerable: i.enumerable, configurable: i.configurable, writable: i.writable, value: i.initializer ? i.initializer.call(o) : void 0 });
    }function d(t) {
      if (void 0 === t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t;
    }function y(t, e) {
      for (var i = 0; i < e.length; i++) {
        var o = e[i];o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(t, o.key, o);
      }
    }function f(t, e, i, o, n) {
      var r = {};return Object.keys(o).forEach(function (t) {
        r[t] = o[t];
      }), r.enumerable = !!r.enumerable, r.configurable = !!r.configurable, ("value" in r || r.initializer) && (r.writable = !0), r = i.slice().reverse().reduce(function (i, o) {
        return o(t, e, i) || i;
      }, r), n && void 0 !== r.initializer && (r.value = r.initializer ? r.initializer.call(n) : void 0, r.initializer = void 0), void 0 === r.initializer && (Object.defineProperty(t, e, r), r = null), r;
    }var v = cc._decorator,
        m = v.ccclass,
        g = v.executeInEditMode,
        w = v.executionOrder,
        b = v.menu,
        x = v.property,
        _ = cc.Vec3,
        B = (o = m("cc.BoxCollider3D"), n = w(98), r = b("i18n:MAIN_MENU.component.physics/Collider/Box 3D"), s = x({ type: cc.Vec3 }), o(a = n(a = r(a = g((f((l = function (t) {
      var e, i, o, n;function r() {
        var e;return u(e = t.call(this) || this, "_size", h, d(e)), e._shape = (0, c.createBoxShape)(e._size), e;
      }return i = t, (e = r).prototype = Object.create(i.prototype), e.prototype.constructor = e, e.__proto__ = i, o = r, (n = [{ key: "size", get: function get() {
          return this._size;
        }, set: function set(t) {
          _.copy(this._size, t), this.boxShape.size = this._size;
        } }, { key: "boxShape", get: function get() {
          return this._shape;
        } }]) && y(o.prototype, n), r;
    }(p.Collider3D)).prototype, "size", [s], Object.getOwnPropertyDescriptor(l.prototype, "size"), l.prototype), h = f(l.prototype, "_size", [x], { configurable: !0, enumerable: !0, writable: !0, initializer: function initializer() {
        return new _(1, 1, 1);
      } }), a = l)) || a) || a) || a) || a);i.BoxCollider3D = B;
  }, { "../../instance": 18, "./collider-component": 13 }], 13: [function (t, e, i) {
    "use strict";
    i.__esModule = !0, i.Collider3D = void 0;var o,
        n,
        r,
        s,
        a,
        l,
        h,
        c,
        p,
        u,
        d = t("../../assets/physics-material");function y(t, e, i, o) {
      i && Object.defineProperty(t, e, { enumerable: i.enumerable, configurable: i.configurable, writable: i.writable, value: i.initializer ? i.initializer.call(o) : void 0 });
    }function f(t) {
      if (void 0 === t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t;
    }function v(t, e) {
      for (var i = 0; i < e.length; i++) {
        var o = e[i];o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(t, o.key, o);
      }
    }function m(t, e, i, o, n) {
      var r = {};return Object.keys(o).forEach(function (t) {
        r[t] = o[t];
      }), r.enumerable = !!r.enumerable, r.configurable = !!r.configurable, ("value" in r || r.initializer) && (r.writable = !0), r = i.slice().reverse().reduce(function (i, o) {
        return o(t, e, i) || i;
      }, r), n && void 0 !== r.initializer && (r.value = r.initializer ? r.initializer.call(n) : void 0, r.initializer = void 0), void 0 === r.initializer && (Object.defineProperty(t, e, r), r = null), r;
    }var g = cc._decorator,
        w = g.ccclass,
        b = g.property,
        x = cc.Vec3,
        _ = (o = w("cc.Collider3D"), n = b({ type: d.PhysicsMaterial, displayName: "Material", displayOrder: -1 }), r = b({ displayOrder: 0 }), s = b({ type: cc.Vec3, displayOrder: 1 }), a = b({ type: d.PhysicsMaterial }), o((m((h = function (t) {
      var e, i, o, n;function r() {
        var e;return (e = t.call(this) || this)._isSharedMaterial = !0, y(e, "_material", c, f(e)), y(e, "_isTrigger", p, f(e)), y(e, "_center", u, f(e)), cc.EventTarget.call(f(e)), e;
      }i = t, (e = r).prototype = Object.create(i.prototype), e.prototype.constructor = e, e.__proto__ = i, o = r, (n = [{ key: "sharedMaterial", get: function get() {
          return this._material;
        }, set: function set(t) {
          this.material = t;
        } }, { key: "material", get: function get() {
          return this._isSharedMaterial && null != this._material && (this._material.off("physics_material_update", this._updateMaterial, this), this._material = this._material.clone(), this._material.on("physics_material_update", this._updateMaterial, this), this._isSharedMaterial = !1), this._material;
        }, set: function set(t) {
          null != t && null != this._material ? this._material._uuid != t._uuid && (this._material.off("physics_material_update", this._updateMaterial, this), t.on("physics_material_update", this._updateMaterial, this), this._isSharedMaterial = !1, this._material = t) : null != t && null == this._material ? (t.on("physics_material_update", this._updateMaterial, this), this._material = t) : null == t && null != this._material && (this._material.off("physics_material_update", this._updateMaterial, this), this._material = t), this._updateMaterial();
        } }, { key: "isTrigger", get: function get() {
          return this._isTrigger;
        }, set: function set(t) {
          this._isTrigger = t, this._shape.isTrigger = this._isTrigger;
        } }, { key: "center", get: function get() {
          return this._center;
        }, set: function set(t) {
          x.copy(this._center, t), this._shape.center = this._center;
        } }, { key: "attachedRigidbody", get: function get() {
          return this.shape.attachedRigidBody;
        } }, { key: "shape", get: function get() {
          return this._shape;
        } }, { key: "_assertOnload", get: function get() {
          var t = 0 == this._isOnLoadCalled;return t && cc.error("Physics Error: Please make sure that the node has been added to the scene"), !t;
        } }]) && v(o.prototype, n);var s = r.prototype;return s.on = function () {}, s.off = function () {}, s.once = function () {}, s.emit = function () {}, s.__preload = function () {
        this._shape.__preload(this);
      }, s.onLoad = function () {
        this.sharedMaterial = null == this._material ? cc.director.getPhysics3DManager().defaultMaterial : this._material, this._shape.onLoad();
      }, s.onEnable = function () {
        this._shape.onEnable();
      }, s.onDisable = function () {
        this._shape.onDisable();
      }, s.onDestroy = function () {
        this._material && this._material.off("physics_material_update", this._updateMaterial, this), this._shape.onDestroy();
      }, s._updateMaterial = function () {
        this._shape.material = this._material;
      }, r;
    }(cc.Component)).prototype, "sharedMaterial", [n], Object.getOwnPropertyDescriptor(h.prototype, "sharedMaterial"), h.prototype), m(h.prototype, "isTrigger", [r], Object.getOwnPropertyDescriptor(h.prototype, "isTrigger"), h.prototype), m(h.prototype, "center", [s], Object.getOwnPropertyDescriptor(h.prototype, "center"), h.prototype), c = m(h.prototype, "_material", [a], { configurable: !0, enumerable: !0, writable: !0, initializer: function initializer() {
        return null;
      } }), p = m(h.prototype, "_isTrigger", [b], { configurable: !0, enumerable: !0, writable: !0, initializer: function initializer() {
        return !1;
      } }), u = m(h.prototype, "_center", [b], { configurable: !0, enumerable: !0, writable: !0, initializer: function initializer() {
        return new x();
      } }), l = h)) || l);i.Collider3D = _, cc.js.mixin(_.prototype, cc.EventTarget.prototype);
  }, { "../../assets/physics-material": 11 }], 14: [function (t, e, i) {
    "use strict";
    i.__esModule = !0, i.SphereCollider3D = void 0;var o,
        n,
        r,
        s = t("../../instance"),
        a = t("./collider-component");function l(t, e, i, o) {
      i && Object.defineProperty(t, e, { enumerable: i.enumerable, configurable: i.configurable, writable: i.writable, value: i.initializer ? i.initializer.call(o) : void 0 });
    }function h(t) {
      if (void 0 === t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t;
    }function c(t, e) {
      for (var i = 0; i < e.length; i++) {
        var o = e[i];o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(t, o.key, o);
      }
    }function p(t, e, i, o, n) {
      var r = {};return Object.keys(o).forEach(function (t) {
        r[t] = o[t];
      }), r.enumerable = !!r.enumerable, r.configurable = !!r.configurable, ("value" in r || r.initializer) && (r.writable = !0), r = i.slice().reverse().reduce(function (i, o) {
        return o(t, e, i) || i;
      }, r), n && void 0 !== r.initializer && (r.value = r.initializer ? r.initializer.call(n) : void 0, r.initializer = void 0), void 0 === r.initializer && (Object.defineProperty(t, e, r), r = null), r;
    }var u = cc._decorator,
        d = u.ccclass,
        y = u.executeInEditMode,
        f = u.executionOrder,
        v = u.menu,
        m = u.property,
        g = d("cc.SphereCollider3D")(o = f(98)(o = v("i18n:MAIN_MENU.component.physics/Collider/Sphere 3D")(o = y((p((n = function (t) {
      var e, i, o, n;function a() {
        var e;return l(e = t.call(this) || this, "_radius", r, h(e)), e._shape = (0, s.createSphereShape)(e._radius), e;
      }return i = t, (e = a).prototype = Object.create(i.prototype), e.prototype.constructor = e, e.__proto__ = i, o = a, (n = [{ key: "radius", get: function get() {
          return this._radius;
        }, set: function set(t) {
          this._radius = t, this.sphereShape.radius = this._radius;
        } }, { key: "sphereShape", get: function get() {
          return this._shape;
        } }]) && c(o.prototype, n), a;
    }(a.Collider3D)).prototype, "radius", [m], Object.getOwnPropertyDescriptor(n.prototype, "radius"), n.prototype), r = p(n.prototype, "_radius", [m], { configurable: !0, enumerable: !0, writable: !0, initializer: function initializer() {
        return .5;
      } }), o = n)) || o) || o) || o) || o;i.SphereCollider3D = g;
  }, { "../../instance": 18, "./collider-component": 13 }], 15: [function (t, e, i) {
    "use strict";
    i.__esModule = !0, i.ConstantForce = void 0;var o,
        n,
        r,
        s,
        a,
        l,
        h,
        c,
        p,
        u,
        d,
        y,
        f,
        v,
        m,
        g = t("./rigid-body-component");function w(t, e, i, o) {
      i && Object.defineProperty(t, e, { enumerable: i.enumerable, configurable: i.configurable, writable: i.writable, value: i.initializer ? i.initializer.call(o) : void 0 });
    }function b(t, e) {
      for (var i = 0; i < e.length; i++) {
        var o = e[i];o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(t, o.key, o);
      }
    }function x(t) {
      if (void 0 === t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t;
    }function _(t, e, i, o, n) {
      var r = {};return Object.keys(o).forEach(function (t) {
        r[t] = o[t];
      }), r.enumerable = !!r.enumerable, r.configurable = !!r.configurable, ("value" in r || r.initializer) && (r.writable = !0), r = i.slice().reverse().reduce(function (i, o) {
        return o(t, e, i) || i;
      }, r), n && void 0 !== r.initializer && (r.value = r.initializer ? r.initializer.call(n) : void 0, r.initializer = void 0), void 0 === r.initializer && (Object.defineProperty(t, e, r), r = null), r;
    }var B = cc._decorator,
        S = B.ccclass,
        E = B.executeInEditMode,
        M = B.executionOrder,
        C = B.menu,
        A = B.property,
        z = B.requireComponent,
        F = B.disallowMultiple,
        T = cc.Vec3,
        R = (o = S("cc.ConstantForce"), n = M(98), r = z(g.RigidBody3D), s = C("i18n:MAIN_MENU.component.physics/Constant Force 3D"), a = A({ displayOrder: 0 }), l = A({ displayOrder: 1 }), h = A({ displayOrder: 2 }), c = A({ displayOrder: 3 }), o(p = n(p = r(p = s(p = F(p = E((m = function (t) {
      var e, i;function o() {
        for (var e, i = arguments.length, o = new Array(i), n = 0; n < i; n++) {
          o[n] = arguments[n];
        }return (e = t.call.apply(t, [this].concat(o)) || this)._rigidbody = null, w(e, "_force", d, x(e)), w(e, "_localForce", y, x(e)), w(e, "_torque", f, x(e)), w(e, "_localTorque", v, x(e)), e._mask = 0, e;
      }i = t, (e = o).prototype = Object.create(i.prototype), e.prototype.constructor = e, e.__proto__ = i;var n,
          r,
          s = o.prototype;return s.onLoad = function () {
        this._rigidbody = this.node.getComponent(g.RigidBody3D), this._maskUpdate(this._force, 1), this._maskUpdate(this._localForce, 2), this._maskUpdate(this._torque, 4), this._maskUpdate(this._localTorque, 8);
      }, s.lateUpdate = function () {
        null != this._rigidbody && 0 != this._mask && (1 & this._mask && this._rigidbody.applyForce(this._force), 2 & this._mask && this._rigidbody.applyLocalForce(this.localForce), 4 & this._mask && this._rigidbody.applyTorque(this._torque), 8 & this._mask && this._rigidbody.applyLocalTorque(this._localTorque));
      }, s._maskUpdate = function (t, e) {
        T.strictEquals(t, T.ZERO) ? this._mask &= ~e : this._mask |= e;
      }, n = o, (r = [{ key: "force", get: function get() {
          return this._force;
        }, set: function set(t) {
          T.copy(this._force, t), this._maskUpdate(this._force, 1);
        } }, { key: "localForce", get: function get() {
          return this._localForce;
        }, set: function set(t) {
          T.copy(this._localForce, t), this._maskUpdate(this.localForce, 2);
        } }, { key: "torque", get: function get() {
          return this._torque;
        }, set: function set(t) {
          T.copy(this._torque, t), this._maskUpdate(this._torque, 4);
        } }, { key: "localTorque", get: function get() {
          return this._localTorque;
        }, set: function set(t) {
          T.copy(this._localTorque, t), this._maskUpdate(this._localTorque, 8);
        } }]) && b(n.prototype, r), o;
    }(cc.Component), d = _((u = m).prototype, "_force", [A], { configurable: !0, enumerable: !0, writable: !0, initializer: function initializer() {
        return new T();
      } }), y = _(u.prototype, "_localForce", [A], { configurable: !0, enumerable: !0, writable: !0, initializer: function initializer() {
        return new T();
      } }), f = _(u.prototype, "_torque", [A], { configurable: !0, enumerable: !0, writable: !0, initializer: function initializer() {
        return new T();
      } }), v = _(u.prototype, "_localTorque", [A], { configurable: !0, enumerable: !0, writable: !0, initializer: function initializer() {
        return new T();
      } }), _(u.prototype, "force", [a], Object.getOwnPropertyDescriptor(u.prototype, "force"), u.prototype), _(u.prototype, "localForce", [l], Object.getOwnPropertyDescriptor(u.prototype, "localForce"), u.prototype), _(u.prototype, "torque", [h], Object.getOwnPropertyDescriptor(u.prototype, "torque"), u.prototype), _(u.prototype, "localTorque", [c], Object.getOwnPropertyDescriptor(u.prototype, "localTorque"), u.prototype), p = u)) || p) || p) || p) || p) || p) || p);i.ConstantForce = R;
  }, { "./rigid-body-component": 16 }], 16: [function (t, e, i) {
    "use strict";
    i.__esModule = !0, i.RigidBody3D = void 0;var o,
        n,
        r,
        s,
        a,
        l,
        h,
        c,
        p,
        u,
        d,
        y,
        f,
        v,
        m,
        g,
        w,
        b,
        x,
        _,
        B,
        S = t("../instance");function E(t, e, i, o) {
      i && Object.defineProperty(t, e, { enumerable: i.enumerable, configurable: i.configurable, writable: i.writable, value: i.initializer ? i.initializer.call(o) : void 0 });
    }function M(t) {
      if (void 0 === t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t;
    }function C(t, e) {
      for (var i = 0; i < e.length; i++) {
        var o = e[i];o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(t, o.key, o);
      }
    }function A(t, e, i, o, n) {
      var r = {};return Object.keys(o).forEach(function (t) {
        r[t] = o[t];
      }), r.enumerable = !!r.enumerable, r.configurable = !!r.configurable, ("value" in r || r.initializer) && (r.writable = !0), r = i.slice().reverse().reduce(function (i, o) {
        return o(t, e, i) || i;
      }, r), n && void 0 !== r.initializer && (r.value = r.initializer ? r.initializer.call(n) : void 0, r.initializer = void 0), void 0 === r.initializer && (Object.defineProperty(t, e, r), r = null), r;
    }var z = cc._decorator,
        F = z.ccclass,
        T = z.disallowMultiple,
        R = z.executeInEditMode,
        P = z.executionOrder,
        q = z.menu,
        I = z.property,
        V = cc.Vec3,
        O = (o = F("cc.RigidBody3D"), n = P(99), r = q("i18n:MAIN_MENU.component.physics/Rigid Body 3D"), s = I({ displayOrder: 0 }), a = I({ displayOrder: 1 }), l = I({ displayOrder: 2 }), h = I({ displayOrder: 3 }), c = I({ displayOrder: 4 }), p = I({ displayOrder: 5 }), u = I({ displayOrder: 6 }), d = I({ displayOrder: 7 }), o(y = n(y = r(y = R(y = T((A((f = function (t) {
      var e, i, o, n;function r() {
        var e;return (e = t.call(this) || this)._allowSleep = !0, E(e, "_mass", v, M(e)), E(e, "_linearDamping", m, M(e)), E(e, "_angularDamping", g, M(e)), E(e, "_fixedRotation", w, M(e)), E(e, "_isKinematic", b, M(e)), E(e, "_useGravity", x, M(e)), E(e, "_linearFactor", _, M(e)), E(e, "_angularFactor", B, M(e)), e._body = (0, S.createRigidBody)(), e;
      }i = t, (e = r).prototype = Object.create(i.prototype), e.prototype.constructor = e, e.__proto__ = i, o = r, (n = [{ key: "allowSleep", get: function get() {
          return this._allowSleep;
        }, set: function set(t) {
          this._allowSleep = t, this._body.allowSleep = t;
        } }, { key: "mass", get: function get() {
          return this._mass;
        }, set: function set(t) {
          this._mass = t, this._body.mass = t;
        } }, { key: "linearDamping", get: function get() {
          return this._linearDamping;
        }, set: function set(t) {
          this._linearDamping = t, this._body.linearDamping = t;
        } }, { key: "angularDamping", get: function get() {
          return this._angularDamping;
        }, set: function set(t) {
          this._angularDamping = t, this._body.angularDamping = t;
        } }, { key: "isKinematic", get: function get() {
          return this._isKinematic;
        }, set: function set(t) {
          this._isKinematic = t, this._body.isKinematic = t;
        } }, { key: "useGravity", get: function get() {
          return this._useGravity;
        }, set: function set(t) {
          this._useGravity = t, this._body.useGravity = t;
        } }, { key: "fixedRotation", get: function get() {
          return this._fixedRotation;
        }, set: function set(t) {
          this._fixedRotation = t, this._body.fixedRotation = t;
        } }, { key: "linearFactor", get: function get() {
          return this._linearFactor;
        }, set: function set(t) {
          V.copy(this._linearFactor, t), this._body.linearFactor = this._linearFactor;
        } }, { key: "angularFactor", get: function get() {
          return this._angularFactor;
        }, set: function set(t) {
          V.copy(this._angularFactor, t), this._body.angularFactor = this._angularFactor;
        } }, { key: "isAwake", get: function get() {
          return !!this._assertOnload && this._body.isAwake;
        } }, { key: "isSleepy", get: function get() {
          return !!this._assertOnload && this._body.isSleepy;
        } }, { key: "isSleeping", get: function get() {
          return !!this._assertOnload && this._body.isSleeping;
        } }, { key: "rigidBody", get: function get() {
          return this._body;
        } }, { key: "_assertOnload", get: function get() {
          var t = 0 == this._isOnLoadCalled;return t && cc.error("Physics Error: Please make sure that the node has been added to the scene"), !t;
        } }]) && C(o.prototype, n);var s = r.prototype;return s.__preload = function () {
        this._body.__preload(this);
      }, s.onEnable = function () {
        this._body.onEnable();
      }, s.onDisable = function () {
        this._body.onDisable();
      }, s.onDestroy = function () {
        this._body.onDestroy();
      }, s.applyForce = function (t, e) {
        this._assertOnload && this._body.applyForce(t, e);
      }, s.applyLocalForce = function (t, e) {
        this._assertOnload && this._body.applyLocalForce(t, e);
      }, s.applyImpulse = function (t, e) {
        this._assertOnload && this._body.applyImpulse(t, e);
      }, s.applyLocalImpulse = function (t, e) {
        this._assertOnload && this._body.applyLocalImpulse(t, e);
      }, s.applyTorque = function (t) {
        this._assertOnload && this._body.applyTorque(t);
      }, s.applyLocalTorque = function (t) {
        this._assertOnload && this._body.applyLocalTorque(t);
      }, s.wakeUp = function () {
        this._assertOnload && this._body.wakeUp();
      }, s.sleep = function () {
        this._assertOnload && this._body.sleep();
      }, s.getLinearVelocity = function (t) {
        this._assertOnload && this._body.getLinearVelocity(t);
      }, s.setLinearVelocity = function (t) {
        this._assertOnload && this._body.setLinearVelocity(t);
      }, s.getAngularVelocity = function (t) {
        this._assertOnload && this._body.getAngularVelocity(t);
      }, s.setAngularVelocity = function (t) {
        this._assertOnload && this._body.setAngularVelocity(t);
      }, r;
    }(cc.Component)).prototype, "mass", [s], Object.getOwnPropertyDescriptor(f.prototype, "mass"), f.prototype), A(f.prototype, "linearDamping", [a], Object.getOwnPropertyDescriptor(f.prototype, "linearDamping"), f.prototype), A(f.prototype, "angularDamping", [l], Object.getOwnPropertyDescriptor(f.prototype, "angularDamping"), f.prototype), A(f.prototype, "isKinematic", [h], Object.getOwnPropertyDescriptor(f.prototype, "isKinematic"), f.prototype), A(f.prototype, "useGravity", [c], Object.getOwnPropertyDescriptor(f.prototype, "useGravity"), f.prototype), A(f.prototype, "fixedRotation", [p], Object.getOwnPropertyDescriptor(f.prototype, "fixedRotation"), f.prototype), A(f.prototype, "linearFactor", [u], Object.getOwnPropertyDescriptor(f.prototype, "linearFactor"), f.prototype), A(f.prototype, "angularFactor", [d], Object.getOwnPropertyDescriptor(f.prototype, "angularFactor"), f.prototype), v = A(f.prototype, "_mass", [I], { configurable: !0, enumerable: !0, writable: !0, initializer: function initializer() {
        return 10;
      } }), m = A(f.prototype, "_linearDamping", [I], { configurable: !0, enumerable: !0, writable: !0, initializer: function initializer() {
        return .1;
      } }), g = A(f.prototype, "_angularDamping", [I], { configurable: !0, enumerable: !0, writable: !0, initializer: function initializer() {
        return .1;
      } }), w = A(f.prototype, "_fixedRotation", [I], { configurable: !0, enumerable: !0, writable: !0, initializer: function initializer() {
        return !1;
      } }), b = A(f.prototype, "_isKinematic", [I], { configurable: !0, enumerable: !0, writable: !0, initializer: function initializer() {
        return !1;
      } }), x = A(f.prototype, "_useGravity", [I], { configurable: !0, enumerable: !0, writable: !0, initializer: function initializer() {
        return !0;
      } }), _ = A(f.prototype, "_linearFactor", [I], { configurable: !0, enumerable: !0, writable: !0, initializer: function initializer() {
        return new V(1, 1, 1);
      } }), B = A(f.prototype, "_angularFactor", [I], { configurable: !0, enumerable: !0, writable: !0, initializer: function initializer() {
        return new V(1, 1, 1);
      } }), y = f)) || y) || y) || y) || y) || y);i.RigidBody3D = O;
  }, { "../instance": 18 }], 17: [function (t, e, i) {
    "use strict";
    i.__esModule = !0;var o = t("./physics-manager");i.Physics3DManager = o.Physics3DManager;var n = t("./physics-ray-result");i.PhysicsRayResult = n.PhysicsRayResult;var r = t("./components/collider/box-collider-component");i.BoxCollider3D = r.BoxCollider3D;var s = t("./components/collider/collider-component");i.Collider3D = s.Collider3D;var a = t("./components/collider/sphere-collider-component");i.SphereCollider3D = a.SphereCollider3D;var l = t("./components/rigid-body-component");i.RigidBody3D = l.RigidBody3D;var h = t("./components/constant-force"),
        c = t("./assets/physics-material");i.PhysicsMaterial = c.PhysicsMaterial, cc.Physics3DManager = o.Physics3DManager, cc.Collider3D = s.Collider3D, cc.BoxCollider3D = r.BoxCollider3D, cc.SphereCollider3D = a.SphereCollider3D, cc.RigidBody3D = l.RigidBody3D, cc.PhysicsRayResult = n.PhysicsRayResult, cc.ConstantForce = h.ConstantForce;
  }, { "./assets/physics-material": 11, "./components/collider/box-collider-component": 12, "./components/collider/collider-component": 13, "./components/collider/sphere-collider-component": 14, "./components/constant-force": 15, "./components/rigid-body-component": 16, "./physics-manager": 20, "./physics-ray-result": 21 }], 18: [function (t, e, i) {
    "use strict";
    i.__esModule = !0, i.createPhysicsWorld = function () {
      return new o.PhysicsWorld();
    }, i.createRigidBody = function () {
      return new o.RigidBody();
    }, i.createBoxShape = function (t) {
      return new o.BoxShape(t);
    }, i.createSphereShape = function (t) {
      return new o.SphereShape(t);
    };var o = t("./physics-selector");
  }, { "./physics-selector": 22 }], 19: [function (t, e, i) {
    "use strict";
    var o;i.__esModule = !0, i.ERigidBodyType = void 0, i.ERigidBodyType = o, function (t) {
      t[t.DYNAMIC = 1] = "DYNAMIC", t[t.STATIC = 2] = "STATIC", t[t.KINEMATIC = 4] = "KINEMATIC";
    }(o || (i.ERigidBodyType = o = {}));
  }, {}], 20: [function (t, e, i) {
    "use strict";
    i.__esModule = !0, i.Physics3DManager = void 0;var o,
        n,
        r,
        s,
        a,
        l,
        h,
        c,
        p = t("./instance"),
        u = t("./assets/physics-material"),
        d = t("./physics-ray-result");function y(t, e, i, o) {
      i && Object.defineProperty(t, e, { enumerable: i.enumerable, configurable: i.configurable, writable: i.writable, value: i.initializer ? i.initializer.call(o) : void 0 });
    }function f(t, e) {
      for (var i = 0; i < e.length; i++) {
        var o = e[i];o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(t, o.key, o);
      }
    }function v(t, e, i, o, n) {
      var r = {};return Object.keys(o).forEach(function (t) {
        r[t] = o[t];
      }), r.enumerable = !!r.enumerable, r.configurable = !!r.configurable, ("value" in r || r.initializer) && (r.writable = !0), r = i.slice().reverse().reduce(function (i, o) {
        return o(t, e, i) || i;
      }, r), n && void 0 !== r.initializer && (r.value = r.initializer ? r.initializer.call(n) : void 0, r.initializer = void 0), void 0 === r.initializer && (Object.defineProperty(t, e, r), r = null), r;
    }var m = cc._decorator,
        g = m.property,
        w = (0, m.ccclass)("cc.Physics3DManager")((r = v((n = function () {
      var t, e;function i() {
        this.physicsWorld = void 0, this.raycastClosestResult = new d.PhysicsRayResult(), this.raycastResults = [], y(this, "_enabled", r, this), y(this, "_allowSleep", s, this), y(this, "_gravity", a, this), y(this, "_maxSubStep", l, this), y(this, "_fixedTime", h, this), y(this, "_useFixedTime", c, this), this.useAccumulator = !1, this._accumulator = 0, this.useFixedDigit = !1, this.useInternalTime = !1, this.fixDigits = { position: 5, rotation: 12, timeNow: 3 }, this._deltaTime = 0, this._lastTime = 0, this._material = null, this.raycastOptions = { groupIndex: -1, queryTrigger: !0, maxDistance: 1 / 0 }, this.raycastResultPool = new cc.RecyclePool(function () {
          return new d.PhysicsRayResult();
        }, 1), cc.director._scheduler && cc.director._scheduler.enableForTarget(this), this.physicsWorld = (0, p.createPhysicsWorld)(), this._lastTime = performance.now(), this.gravity = this._gravity, this.allowSleep = this._allowSleep, this._material = new u.PhysicsMaterial(), this._material.friction = .1, this._material.restitution = .1, this._material.on("physics_material_update", this._updateMaterial, this), this.physicsWorld.defaultMaterial = this._material;
      }t = i, (e = [{ key: "enabled", get: function get() {
          return this._enabled;
        }, set: function set(t) {
          this._enabled = t;
        } }, { key: "allowSleep", get: function get() {
          return this._allowSleep;
        }, set: function set(t) {
          this._allowSleep = t, this.physicsWorld.allowSleep = this._allowSleep;
        } }, { key: "maxSubStep", get: function get() {
          return this._maxSubStep;
        }, set: function set(t) {
          this._maxSubStep = t;
        } }, { key: "deltaTime", get: function get() {
          return this._fixedTime;
        }, set: function set(t) {
          this._fixedTime = t;
        } }, { key: "useFixedTime", get: function get() {
          return this._useFixedTime;
        }, set: function set(t) {
          this._useFixedTime = t;
        } }, { key: "gravity", get: function get() {
          return this._gravity;
        }, set: function set(t) {
          this._gravity.set(t), this.physicsWorld.gravity = t;
        } }, { key: "defaultMaterial", get: function get() {
          return this._material;
        } }]) && f(t.prototype, e);var o = i.prototype;return o.update = function (t) {
        if (this._enabled) {
          if (this.useInternalTime) {
            var e = parseFloat(performance.now().toFixed(this.fixDigits.timeNow));this._deltaTime = e > this._lastTime ? (e - this._lastTime) / 1e3 : 0, this._lastTime = e;
          } else this._deltaTime = t;if (cc.director.emit(cc.Director.EVENT_BEFORE_PHYSICS), this._useFixedTime) this.physicsWorld.step(this._fixedTime);else if (this.useAccumulator) {
            var i = 0;for (this._accumulator += this._deltaTime; i < this._maxSubStep && this._accumulator > this._fixedTime;) {
              this.physicsWorld.step(this._fixedTime), this._accumulator -= this._fixedTime, i++;
            }
          } else this.physicsWorld.step(this._fixedTime, this._deltaTime, this._maxSubStep);cc.director.emit(cc.Director.EVENT_AFTER_PHYSICS);
        }
      }, o.raycast = function (t, e, i, o) {
        if (void 0 === e && (e = 0), void 0 === i && (i = 1 / 0), void 0 === o && (o = !0), this.raycastResultPool.reset(), this.raycastResults.length = 0, "string" == typeof e) {
          var n = cc.game.groupList.indexOf(e);-1 == n && (n = 0), this.raycastOptions.groupIndex = n;
        } else this.raycastOptions.groupIndex = e;return this.raycastOptions.maxDistance = i, this.raycastOptions.queryTrigger = o, this.physicsWorld.raycast(t, this.raycastOptions, this.raycastResultPool, this.raycastResults) ? this.raycastResults : null;
      }, o.raycastClosest = function (t, e, i, o) {
        if (void 0 === e && (e = 0), void 0 === i && (i = 1 / 0), void 0 === o && (o = !0), "string" == typeof e) {
          var n = cc.game.groupList.indexOf(e);-1 == n && (n = 0), this.raycastOptions.groupIndex = n;
        } else this.raycastOptions.groupIndex = e;return this.raycastOptions.maxDistance = i, this.raycastOptions.queryTrigger = o, this.physicsWorld.raycastClosest(t, this.raycastOptions, this.raycastClosestResult) ? this.raycastClosestResult : null;
      }, o._updateMaterial = function () {
        this.physicsWorld.defaultMaterial = this._material;
      }, i;
    }()).prototype, "_enabled", [g], { configurable: !0, enumerable: !0, writable: !0, initializer: function initializer() {
        return !1;
      } }), s = v(n.prototype, "_allowSleep", [g], { configurable: !0, enumerable: !0, writable: !0, initializer: function initializer() {
        return !0;
      } }), a = v(n.prototype, "_gravity", [g], { configurable: !0, enumerable: !0, writable: !0, initializer: function initializer() {
        return new cc.Vec3(0, -10, 0);
      } }), l = v(n.prototype, "_maxSubStep", [g], { configurable: !0, enumerable: !0, writable: !0, initializer: function initializer() {
        return 1;
      } }), h = v(n.prototype, "_fixedTime", [g], { configurable: !0, enumerable: !0, writable: !0, initializer: function initializer() {
        return 1 / 60;
      } }), c = v(n.prototype, "_useFixedTime", [g], { configurable: !0, enumerable: !0, writable: !0, initializer: function initializer() {
        return !0;
      } }), o = n)) || o;i.Physics3DManager = w;
  }, { "./assets/physics-material": 11, "./instance": 18, "./physics-ray-result": 21 }], 21: [function (t, e, i) {
    "use strict";
    function o(t, e) {
      for (var i = 0; i < e.length; i++) {
        var o = e[i];o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(t, o.key, o);
      }
    }i.__esModule = !0, i.PhysicsRayResult = void 0;var n = cc.Vec3,
        r = function () {
      function t() {
        this._hitPoint = new n(), this._distance = 0, this._collidier = null;
      }var e,
          i,
          r = t.prototype;return r._assign = function (t, e, i) {
        n.copy(this._hitPoint, t), this._distance = e, this._collidier = i;
      }, r.clone = function () {
        var e = new t();return n.copy(e._hitPoint, this._hitPoint), e._distance = this._distance, e._collidier = this._collidier, e;
      }, e = t, (i = [{ key: "hitPoint", get: function get() {
          return this._hitPoint;
        } }, { key: "distance", get: function get() {
          return this._distance;
        } }, { key: "collider", get: function get() {
          return this._collidier;
        } }]) && o(e.prototype, i), t;
    }();i.PhysicsRayResult = r;
  }, {}], 22: [function (t, e, i) {
    "use strict";
    var o, n, r, s;i.__esModule = !0, i.instantiate = function (t, e, a, l) {
      i.BoxShape = o = t, i.SphereShape = n = e, i.RigidBody = r = a, i.PhysicsWorld = s = l;
    }, i.PhysicsWorld = i.RigidBody = i.SphereShape = i.BoxShape = void 0, i.BoxShape = o, i.SphereShape = n, i.RigidBody = r, i.PhysicsWorld = s;
  }, {}], 23: [function (t, e, i) {
    "use strict";
    i.__esModule = !0, i.stringfyVec3 = function (t) {
      return "(x: " + t.x + ", y: " + t.y + ", z: " + t.z + ")";
    }, i.stringfyQuat = function (t) {
      return "(x: " + t.x + ", y: " + t.y + ", z: " + t.z + ", w: " + t.w + ")";
    }, i.setWrap = function (t, e) {
      t.__cc_wrapper__ = e;
    }, i.getWrap = function (t) {
      return t.__cc_wrapper__;
    }, i.clearNodeTransformDirtyFlag = function () {
      for (var t in b) {
        var e = b[t];e._localMatDirty &= ~r, e._localMatDirty & s || (e._worldMatDirty = !1, e._renderFlag &= ~a);
      }b = {}, d.length = 0;
    }, i.clearNodeTransformRecord = function () {
      b = {}, d.length = 0;
    }, i.updateWorldTransform = x, i.updateWorldRT = function (t, e, i) {
      var o = t.parent;o ? (x(o, !0), c.transformMat4(y, e, h.invert(w, o._worldMatrix)), p.multiply(g, p.conjugate(g, o.__wrot), i), t.setPosition(y), t.setRotation(g)) : (t.setPosition(e), t.setRotation(i));
    };var o = cc.Node._LocalDirtyFlag,
        n = o.PHYSICS_TRS,
        r = o.ALL_TRS,
        s = o.SKEW,
        a = cc.RenderFlow.FLAG_TRANSFORM,
        l = cc.Mat3,
        h = cc.Mat4,
        c = cc.Vec3,
        p = cc.Quat,
        u = cc.Trs,
        d = [],
        y = cc.v3(),
        f = cc.quat(),
        v = new l(),
        m = v.m,
        g = cc.quat(),
        w = cc.mat4(),
        b = {};function x(t, e) {
      void 0 === e && (e = !1);for (var i, o, r, s, a, w, x, _, B = t, S = 0, E = !1, M = 0; B;) {
        if (!e && b[B._id]) {
          M |= B._localMatDirty & n, E = E || !!M;break;
        }d[S++] = B, B._localMatDirty & n && (E = !0), B = B._parent;
      }if (!E) return !1;for (d.length = S; S;) {
        i = d[--S], !e && (b[i._id] = i), o = i._worldMatrix, a = i._matrix, s = i._trs, w = i.__wpos = i.__wpos || cc.v3(), x = i.__wrot = i.__wrot || cc.quat(), _ = i.__wscale = i.__wscale || cc.v3(), i._localMatDirty & n && u.toMat4(a, s), i._localMatDirty |= M, (M |= i._localMatDirty & n) & n ? (B ? (r = B._worldMatrix, u.toPosition(y, s), c.transformMat4(w, y, r), h.multiply(o, r, a), u.toRotation(f, s), p.multiply(x, B.__wrot, f), l.fromQuat(v, p.conjugate(g, x)), l.multiplyMat4(v, v, o), _.x = m[0], _.y = m[4], _.z = m[8]) : (u.toPosition(w, s), u.toRotation(x, s), u.toScale(_, s), h.copy(o, a)), B = i) : B = i;
      }return !0;
    }
  }, {}], 24: [function (t, e, i) {
    (function (o) {
      "use strict";
      !function (t) {
        if ("object" == (typeof i === "undefined" ? "undefined" : _typeof(i)) && void 0 !== e) e.exports = t();else if ("function" == typeof define && define.amd) define([], t);else {
          var n;"undefined" != typeof window ? n = window : void 0 !== o ? n = o : "undefined" != typeof self && (n = self), n.CANNON = t();
        }
      }(function () {
        return function e(i, o, n) {
          function r(a, l) {
            if (!o[a]) {
              if (!i[a]) {
                var h = "function" == typeof t && t;if (!l && h) return h(a, !0);if (s) return s(a, !0);throw new Error("Cannot find module '" + a + "'");
              }var c = o[a] = { exports: {} };i[a][0].call(c.exports, function (t) {
                return r(i[a][1][t] || t);
              }, c, c.exports, e, i, o, n);
            }return o[a].exports;
          }for (var s = "function" == typeof t && t, a = 0; a < n.length; a++) {
            r(n[a]);
          }return r;
        }({ 1: [function (t, e) {
            e.exports = { name: "@cocos/cannon", version: "1.1.1-exp.3", description: "A lightweight 3D physics engine written in JavaScript.", homepage: "https://github.com/cocos-creator/cannon.js", author: "Stefan Hedman <schteppe@gmail.com> (http://steffe.se), JayceLai", keywords: ["cannon.js", "cocos", "creator", "physics", "engine", "3d"], scripts: { build: "grunt && npm run preprocess && grunt addLicense && grunt addDate", preprocess: "node node_modules/uglify-js/bin/uglifyjs build/cannon.js -o build/cannon.min.js -c -m" }, main: "./build/cannon.min.js", engines: { node: "*" }, repository: { type: "git", url: "https://github.com/cocos-creator/cannon.js.git" }, bugs: { url: "https://github.com/cocos-creator/cannon.js/issues" }, licenses: [{ type: "MIT" }], devDependencies: { jshint: "latest", "uglify-js": "latest", nodeunit: "^0.9.0", grunt: "~0.4.0", "grunt-contrib-jshint": "~0.1.1", "grunt-contrib-nodeunit": "^0.4.1", "grunt-contrib-concat": "~0.1.3", "grunt-contrib-uglify": "^0.5.1", "grunt-browserify": "^2.1.4", "grunt-contrib-yuidoc": "^0.5.2", browserify: "*" }, dependencies: {} };
          }, {}], 2: [function (t, e) {
            e.exports = { version: t("../package.json").version, AABB: t("./collision/AABB"), ArrayCollisionMatrix: t("./collision/ArrayCollisionMatrix"), Body: t("./objects/Body"), Box: t("./shapes/Box"), Broadphase: t("./collision/Broadphase"), Constraint: t("./constraints/Constraint"), ContactEquation: t("./equations/ContactEquation"), Narrowphase: t("./world/Narrowphase"), ConeTwistConstraint: t("./constraints/ConeTwistConstraint"), ContactMaterial: t("./material/ContactMaterial"), ConvexPolyhedron: t("./shapes/ConvexPolyhedron"), Cylinder: t("./shapes/Cylinder"), DistanceConstraint: t("./constraints/DistanceConstraint"), Equation: t("./equations/Equation"), EventTarget: t("./utils/EventTarget"), FrictionEquation: t("./equations/FrictionEquation"), GSSolver: t("./solver/GSSolver"), GridBroadphase: t("./collision/GridBroadphase"), Heightfield: t("./shapes/Heightfield"), HingeConstraint: t("./constraints/HingeConstraint"), LockConstraint: t("./constraints/LockConstraint"), Mat3: t("./math/Mat3"), Material: t("./material/Material"), NaiveBroadphase: t("./collision/NaiveBroadphase"), ObjectCollisionMatrix: t("./collision/ObjectCollisionMatrix"), Pool: t("./utils/Pool"), Particle: t("./shapes/Particle"), Plane: t("./shapes/Plane"), PointToPointConstraint: t("./constraints/PointToPointConstraint"), Quaternion: t("./math/Quaternion"), Ray: t("./collision/Ray"), RaycastVehicle: t("./objects/RaycastVehicle"), RaycastResult: t("./collision/RaycastResult"), RigidVehicle: t("./objects/RigidVehicle"), RotationalEquation: t("./equations/RotationalEquation"), RotationalMotorEquation: t("./equations/RotationalMotorEquation"), SAPBroadphase: t("./collision/SAPBroadphase"), SPHSystem: t("./objects/SPHSystem"), Shape: t("./shapes/Shape"), Solver: t("./solver/Solver"), Sphere: t("./shapes/Sphere"), SplitSolver: t("./solver/SplitSolver"), Spring: t("./objects/Spring"), Transform: t("./math/Transform"), Trimesh: t("./shapes/Trimesh"), Vec3: t("./math/Vec3"), Vec3Pool: t("./utils/Vec3Pool"), World: t("./world/World"), Octree: t("./utils/Octree"), CMath: t("./math/CMath") };
          }, { "../package.json": 1, "./collision/AABB": 3, "./collision/ArrayCollisionMatrix": 4, "./collision/Broadphase": 5, "./collision/GridBroadphase": 6, "./collision/NaiveBroadphase": 7, "./collision/ObjectCollisionMatrix": 8, "./collision/Ray": 10, "./collision/RaycastResult": 11, "./collision/SAPBroadphase": 12, "./constraints/ConeTwistConstraint": 13, "./constraints/Constraint": 14, "./constraints/DistanceConstraint": 15, "./constraints/HingeConstraint": 16, "./constraints/LockConstraint": 17, "./constraints/PointToPointConstraint": 18, "./equations/ContactEquation": 20, "./equations/Equation": 21, "./equations/FrictionEquation": 22, "./equations/RotationalEquation": 23, "./equations/RotationalMotorEquation": 24, "./material/ContactMaterial": 25, "./material/Material": 26, "./math/CMath": 27, "./math/Mat3": 29, "./math/Quaternion": 30, "./math/Transform": 31, "./math/Vec3": 32, "./objects/Body": 33, "./objects/RaycastVehicle": 34, "./objects/RigidVehicle": 35, "./objects/SPHSystem": 36, "./objects/Spring": 37, "./shapes/Box": 39, "./shapes/ConvexPolyhedron": 40, "./shapes/Cylinder": 41, "./shapes/Heightfield": 42, "./shapes/Particle": 43, "./shapes/Plane": 44, "./shapes/Shape": 45, "./shapes/Sphere": 46, "./shapes/Trimesh": 47, "./solver/GSSolver": 48, "./solver/Solver": 49, "./solver/SplitSolver": 50, "./utils/EventTarget": 51, "./utils/Octree": 52, "./utils/Pool": 53, "./utils/Vec3Pool": 56, "./world/Narrowphase": 57, "./world/World": 58 }], 3: [function (t, e) {
            var i = t("../math/Vec3");function o(t) {
              t = t || {}, this.lowerBound = new i(), t.lowerBound && this.lowerBound.copy(t.lowerBound), this.upperBound = new i(), t.upperBound && this.upperBound.copy(t.upperBound);
            }t("../utils/Utils"), e.exports = o;var n = new i();o.prototype.setFromPoints = function (t, e, i, o) {
              var r = this.lowerBound,
                  s = this.upperBound,
                  a = i;r.copy(t[0]), a && a.vmult(r, r), s.copy(r);for (var l = 1; l < t.length; l++) {
                var h = t[l];a && (a.vmult(h, n), h = n), h.x > s.x && (s.x = h.x), h.x < r.x && (r.x = h.x), h.y > s.y && (s.y = h.y), h.y < r.y && (r.y = h.y), h.z > s.z && (s.z = h.z), h.z < r.z && (r.z = h.z);
              }return e && (e.vadd(r, r), e.vadd(s, s)), o && (r.x -= o, r.y -= o, r.z -= o, s.x += o, s.y += o, s.z += o), this;
            }, o.prototype.copy = function (t) {
              return this.lowerBound.copy(t.lowerBound), this.upperBound.copy(t.upperBound), this;
            }, o.prototype.clone = function () {
              return new o().copy(this);
            }, o.prototype.extend = function (t) {
              this.lowerBound.x = Math.min(this.lowerBound.x, t.lowerBound.x), this.upperBound.x = Math.max(this.upperBound.x, t.upperBound.x), this.lowerBound.y = Math.min(this.lowerBound.y, t.lowerBound.y), this.upperBound.y = Math.max(this.upperBound.y, t.upperBound.y), this.lowerBound.z = Math.min(this.lowerBound.z, t.lowerBound.z), this.upperBound.z = Math.max(this.upperBound.z, t.upperBound.z);
            }, o.prototype.overlaps = function (t) {
              var e = this.lowerBound,
                  i = this.upperBound,
                  o = t.lowerBound,
                  n = t.upperBound,
                  r = o.x <= i.x && i.x <= n.x || e.x <= n.x && n.x <= i.x,
                  s = o.y <= i.y && i.y <= n.y || e.y <= n.y && n.y <= i.y,
                  a = o.z <= i.z && i.z <= n.z || e.z <= n.z && n.z <= i.z;return r && s && a;
            }, o.prototype.volume = function () {
              var t = this.lowerBound,
                  e = this.upperBound;return (e.x - t.x) * (e.y - t.y) * (e.z - t.z);
            }, o.prototype.contains = function (t) {
              var e = this.lowerBound,
                  i = this.upperBound,
                  o = t.lowerBound,
                  n = t.upperBound;return e.x <= o.x && i.x >= n.x && e.y <= o.y && i.y >= n.y && e.z <= o.z && i.z >= n.z;
            }, o.prototype.getCorners = function (t, e, i, o, n, r, s, a) {
              var l = this.lowerBound,
                  h = this.upperBound;t.copy(l), e.set(h.x, l.y, l.z), i.set(h.x, h.y, l.z), o.set(l.x, h.y, h.z), n.set(h.x, l.y, h.z), r.set(l.x, h.y, l.z), s.set(l.x, l.y, h.z), a.copy(h);
            };var r = [new i(), new i(), new i(), new i(), new i(), new i(), new i(), new i()];o.prototype.toLocalFrame = function (t, e) {
              var i = r,
                  o = i[0],
                  n = i[1],
                  s = i[2],
                  a = i[3],
                  l = i[4],
                  h = i[5],
                  c = i[6],
                  p = i[7];this.getCorners(o, n, s, a, l, h, c, p);for (var u = 0; 8 !== u; u++) {
                var d = i[u];t.pointToLocal(d, d);
              }return e.setFromPoints(i);
            }, o.prototype.toWorldFrame = function (t, e) {
              var i = r,
                  o = i[0],
                  n = i[1],
                  s = i[2],
                  a = i[3],
                  l = i[4],
                  h = i[5],
                  c = i[6],
                  p = i[7];this.getCorners(o, n, s, a, l, h, c, p);for (var u = 0; 8 !== u; u++) {
                var d = i[u];t.pointToWorld(d, d);
              }return e.setFromPoints(i);
            }, o.prototype.overlapsRay = function (t) {
              var e = 1 / t._direction.x,
                  i = 1 / t._direction.y,
                  o = 1 / t._direction.z,
                  n = (this.lowerBound.x - t.from.x) * e,
                  r = (this.upperBound.x - t.from.x) * e,
                  s = (this.lowerBound.y - t.from.y) * i,
                  a = (this.upperBound.y - t.from.y) * i,
                  l = (this.lowerBound.z - t.from.z) * o,
                  h = (this.upperBound.z - t.from.z) * o,
                  c = Math.max(Math.max(Math.min(n, r), Math.min(s, a)), Math.min(l, h)),
                  p = Math.min(Math.min(Math.max(n, r), Math.max(s, a)), Math.max(l, h));return !(p < 0 || c > p);
            };
          }, { "../math/Vec3": 32, "../utils/Utils": 55 }], 4: [function (t, e) {
            function i() {
              this.matrix = [];
            }e.exports = i, i.prototype.get = function (t, e) {
              if (t = t.index, (e = e.index) > t) {
                var i = e;e = t, t = i;
              }return this.matrix[(t * (t + 1) >> 1) + e - 1];
            }, i.prototype.set = function (t, e, i) {
              if (t = t.index, (e = e.index) > t) {
                var o = e;e = t, t = o;
              }this.matrix[(t * (t + 1) >> 1) + e - 1] = i ? 1 : 0;
            }, i.prototype.reset = function () {
              for (var t = 0, e = this.matrix.length; t !== e; t++) {
                this.matrix[t] = 0;
              }
            }, i.prototype.setNumObjects = function (t) {
              this.matrix.length = t * (t - 1) >> 1;
            };
          }, {}], 5: [function (t, e) {
            var i = t("../objects/Body"),
                o = t("../math/Vec3"),
                n = t("../math/Quaternion");function r() {
              this.world = null, this.useBoundingBoxes = !1, this.dirty = !0;
            }t("../shapes/Shape"), t("../shapes/Plane"), e.exports = r, r.prototype.collisionPairs = function () {
              throw new Error("collisionPairs not implemented for this BroadPhase class!");
            }, r.prototype.needBroadphaseCollision = function (t, e) {
              return 0 != (t.collisionFilterGroup & e.collisionFilterMask) && 0 != (e.collisionFilterGroup & t.collisionFilterMask) && (!(!t.hasTrigger && !e.hasTrigger) || 0 == (t.type & i.STATIC) && t.sleepState !== i.SLEEPING || 0 == (e.type & i.STATIC) && e.sleepState !== i.SLEEPING);
            }, r.prototype.intersectionTest = function (t, e, i, o) {
              this.useBoundingBoxes ? this.doBoundingBoxBroadphase(t, e, i, o) : this.doBoundingSphereBroadphase(t, e, i, o);
            };var s = new o();new o(), new n(), new o(), r.prototype.doBoundingSphereBroadphase = function (t, e, i, o) {
              var n = s;e.position.vsub(t.position, n);var r = Math.pow(t.boundingRadius + e.boundingRadius, 2);n.norm2() < r && (i.push(t), o.push(e));
            }, r.prototype.doBoundingBoxBroadphase = function (t, e, i, o) {
              t.aabbNeedsUpdate && t.computeAABB(), e.aabbNeedsUpdate && e.computeAABB(), t.aabb.overlaps(e.aabb) && (i.push(t), o.push(e));
            };var a = { keys: [] },
                l = [],
                h = [];r.prototype.makePairsUnique = function (t, e) {
              for (var i = a, o = l, n = h, r = t.length, s = 0; s !== r; s++) {
                o[s] = t[s], n[s] = e[s];
              }for (t.length = 0, e.length = 0, s = 0; s !== r; s++) {
                var c = o[s].id,
                    p = n[s].id;i[u = c < p ? c + "," + p : p + "," + c] = s, i.keys.push(u);
              }for (s = 0; s !== i.keys.length; s++) {
                var u = i.keys.pop(),
                    d = i[u];t.push(o[d]), e.push(n[d]), delete i[u];
              }
            }, r.prototype.setWorld = function () {};var c = new o();r.boundingSphereCheck = function (t, e) {
              var i = c;return t.position.vsub(e.position, i), Math.pow(t.shape.boundingSphereRadius + e.shape.boundingSphereRadius, 2) > i.norm2();
            }, r.prototype.aabbQuery = function () {
              return console.warn(".aabbQuery is not implemented in this Broadphase subclass."), [];
            };
          }, { "../math/Quaternion": 30, "../math/Vec3": 32, "../objects/Body": 33, "../shapes/Plane": 44, "../shapes/Shape": 45 }], 6: [function (t, e) {
            e.exports = r;var i = t("./Broadphase"),
                o = t("../math/Vec3"),
                n = t("../shapes/Shape");function r(t, e, n, r, s) {
              i.apply(this), this.nx = n || 10, this.ny = r || 10, this.nz = s || 10, this.aabbMin = t || new o(100, 100, 100), this.aabbMax = e || new o(-100, -100, -100);var a = this.nx * this.ny * this.nz;if (a <= 0) throw "GridBroadphase: Each dimension's n must be >0";this.bins = [], this.binLengths = [], this.bins.length = a, this.binLengths.length = a;for (var l = 0; l < a; l++) {
                this.bins[l] = [], this.binLengths[l] = 0;
              }
            }r.prototype = new i(), r.prototype.constructor = r;var s = new o();new o(), r.prototype.collisionPairs = function (t, e, i) {
              for (var o = t.numObjects(), r = t.bodies, a = this.aabbMax, l = this.aabbMin, h = this.nx, c = this.ny, p = this.nz, u = c * p, d = p, y = 1, f = a.x, v = a.y, m = a.z, g = l.x, w = l.y, b = l.z, x = h / (f - g), _ = c / (v - w), B = p / (m - b), S = (f - g) / h, E = (v - w) / c, M = (m - b) / p, C = .5 * Math.sqrt(S * S + E * E + M * M), A = n.types, z = A.SPHERE, F = A.PLANE, T = (A.BOX, A.COMPOUND, A.CONVEXPOLYHEDRON, this.bins), R = this.binLengths, P = this.bins.length, q = 0; q !== P; q++) {
                R[q] = 0;
              }var I = Math.ceil;function V(t, e, i, o, n, r, s) {
                var a = (t - g) * x | 0,
                    l = (e - w) * _ | 0,
                    f = (i - b) * B | 0,
                    v = I((o - g) * x),
                    m = I((n - w) * _),
                    S = I((r - b) * B);a < 0 ? a = 0 : a >= h && (a = h - 1), l < 0 ? l = 0 : l >= c && (l = c - 1), f < 0 ? f = 0 : f >= p && (f = p - 1), v < 0 ? v = 0 : v >= h && (v = h - 1), m < 0 ? m = 0 : m >= c && (m = c - 1), S < 0 ? S = 0 : S >= p && (S = p - 1), l *= d, f *= y, v *= u, m *= d, S *= y;for (var E = a *= u; E <= v; E += u) {
                  for (var M = l; M <= m; M += d) {
                    for (var C = f; C <= S; C += y) {
                      var A = E + M + C;T[A][R[A]++] = s;
                    }
                  }
                }
              }for (l = Math.min, a = Math.max, q = 0; q !== o; q++) {
                var O = (it = r[q]).shape;switch (O.type) {case z:
                    var k = it.position.x,
                        N = it.position.y,
                        j = it.position.z,
                        L = O.radius;V(k - L, N - L, j - L, k + L, N + L, j + L, it);break;case F:
                    O.worldNormalNeedsUpdate && O.computeWorldNormal(it.quaternion);var W = O.worldNormal,
                        D = g + .5 * S - it.position.x,
                        U = w + .5 * E - it.position.y,
                        G = b + .5 * M - it.position.z,
                        H = s;H.set(D, U, G);for (var K = 0, Q = 0; K !== h; K++, Q += u, H.y = U, H.x += S) {
                      for (var X = 0, Y = 0; X !== c; X++, Y += d, H.z = G, H.y += E) {
                        for (var Z = 0, J = 0; Z !== p; Z++, J += y, H.z += M) {
                          if (H.dot(W) < C) {
                            var $ = Q + Y + J;T[$][R[$]++] = it;
                          }
                        }
                      }
                    }break;default:
                    it.aabbNeedsUpdate && it.computeAABB(), V(it.aabb.lowerBound.x, it.aabb.lowerBound.y, it.aabb.lowerBound.z, it.aabb.upperBound.x, it.aabb.upperBound.y, it.aabb.upperBound.z, it);}
              }for (q = 0; q !== P; q++) {
                var tt = R[q];if (tt > 1) {
                  var et = T[q];for (K = 0; K !== tt; K++) {
                    var it = et[K];for (X = 0; X !== K; X++) {
                      var ot = et[X];this.needBroadphaseCollision(it, ot) && this.intersectionTest(it, ot, e, i);
                    }
                  }
                }
              }this.makePairsUnique(e, i);
            };
          }, { "../math/Vec3": 32, "../shapes/Shape": 45, "./Broadphase": 5 }], 7: [function (t, e) {
            e.exports = n;var i = t("./Broadphase"),
                o = t("./AABB");function n() {
              i.apply(this);
            }n.prototype = new i(), n.prototype.constructor = n, n.prototype.collisionPairs = function (t, e, i) {
              var o,
                  n,
                  r,
                  s,
                  a = t.bodies,
                  l = a.length;for (o = 0; o !== l; o++) {
                for (n = 0; n !== o; n++) {
                  r = a[o], s = a[n], this.needBroadphaseCollision(r, s) && this.intersectionTest(r, s, e, i);
                }
              }
            }, new o(), n.prototype.aabbQuery = function (t, e, i) {
              i = i || [];for (var o = 0; o < t.bodies.length; o++) {
                var n = t.bodies[o];n.aabbNeedsUpdate && n.computeAABB(), n.aabb.overlaps(e) && i.push(n);
              }return i;
            };
          }, { "./AABB": 3, "./Broadphase": 5 }], 8: [function (t, e) {
            function i() {
              this.matrix = {};
            }e.exports = i, i.prototype.get = function (t, e) {
              if (t = t.id, (e = e.id) > t) {
                var i = e;e = t, t = i;
              }return t + "-" + e in this.matrix;
            }, i.prototype.set = function (t, e, i) {
              if (t = t.id, (e = e.id) > t) {
                var o = e;e = t, t = o;
              }i ? this.matrix[t + "-" + e] = !0 : delete this.matrix[t + "-" + e];
            }, i.prototype.reset = function () {
              this.matrix = {};
            }, i.prototype.setNumObjects = function () {};
          }, {}], 9: [function (t, e) {
            function i() {
              this.current = [], this.previous = [];
            }function o(t, e) {
              t.push((4294901760 & e) >> 16, 65535 & e);
            }e.exports = i, i.prototype.getKey = function (t, e) {
              if (e < t) {
                var i = e;e = t, t = i;
              }return t << 16 | e;
            }, i.prototype.set = function (t, e) {
              for (var i = this.getKey(t, e), o = this.current, n = 0; i > o[n];) {
                n++;
              }if (i !== o[n]) {
                for (e = o.length - 1; e >= n; e--) {
                  o[e + 1] = o[e];
                }o[n] = i;
              }
            }, i.prototype.tick = function () {
              var t = this.current;this.current = this.previous, this.previous = t, this.current.length = 0;
            }, i.prototype.getDiff = function (t, e) {
              for (var i = this.current, n = this.previous, r = i.length, s = n.length, a = 0, l = 0; l < r; l++) {
                for (var h = i[l]; h > n[a];) {
                  a++;
                }h === n[a] || o(t, h);
              }for (a = 0, l = 0; l < s; l++) {
                for (var c = n[l]; c > i[a];) {
                  a++;
                }i[a] === c || o(e, c);
              }
            };
          }, {}], 10: [function (t, e) {
            e.exports = l;var i = t("../math/Vec3"),
                o = t("../math/Quaternion"),
                n = t("../math/Transform"),
                r = (t("../shapes/ConvexPolyhedron"), t("../shapes/Box"), t("../collision/RaycastResult")),
                s = t("../shapes/Shape"),
                a = t("../collision/AABB");function l(t, e) {
              this.from = t ? t.clone() : new i(), this.to = e ? e.clone() : new i(), this._direction = new i(), this.precision = 1e-4, this.checkCollisionResponse = !0, this.skipBackfaces = !1, this.collisionFilterMask = -1, this.collisionFilterGroup = -1, this.mode = l.ANY, this.result = new r(), this.hasHit = !1, this.callback = function () {};
            }l.prototype.constructor = l, l.CLOSEST = 1, l.ANY = 2, l.ALL = 4;var h = new a(),
                c = [];l.prototype.intersectWorld = function (t, e) {
              return this.mode = e.mode || l.ANY, this.result = e.result || new r(), this.skipBackfaces = !!e.skipBackfaces, this.checkCollisionResponse = !!e.checkCollisionResponse, this.collisionFilterMask = void 0 !== e.collisionFilterMask ? e.collisionFilterMask : -1, this.collisionFilterGroup = void 0 !== e.collisionFilterGroup ? e.collisionFilterGroup : -1, e.from && this.from.copy(e.from), e.to && this.to.copy(e.to), this.callback = e.callback || function () {}, this.hasHit = !1, this.result.reset(), this._updateDirection(), this.getAABB(h), c.length = 0, t.broadphase.aabbQuery(t, h, c), this.intersectBodies(c), this.hasHit;
            };var p = new i(),
                u = new i();function d(t, e, i, o) {
              o.vsub(e, V), i.vsub(e, p), t.vsub(e, u);var n,
                  r,
                  s = V.dot(V),
                  a = V.dot(p),
                  l = V.dot(u),
                  h = p.dot(p),
                  c = p.dot(u);return (n = h * l - a * c) >= 0 && (r = s * c - a * l) >= 0 && n + r < s * h - a * a;
            }l.pointInTriangle = d;var y = new i(),
                f = new o();l.prototype.intersectBody = function (t, e) {
              e && (this.result = e, this._updateDirection());var i = this.checkCollisionResponse;if ((!i || t.collisionResponse) && 0 != (this.collisionFilterGroup & t.collisionFilterMask) && 0 != (t.collisionFilterGroup & this.collisionFilterMask)) for (var o = y, n = f, r = 0, s = t.shapes.length; r < s; r++) {
                var a = t.shapes[r];if ((!i || a.collisionResponse) && (t.quaternion.mult(t.shapeOrientations[r], n), t.quaternion.vmult(t.shapeOffsets[r], o), o.vadd(t.position, o), this.intersectShape(a, n, o, t), this.result._shouldStop)) break;
              }
            }, l.prototype.intersectBodies = function (t, e) {
              e && (this.result = e, this._updateDirection());for (var i = 0, o = t.length; !this.result._shouldStop && i < o; i++) {
                this.intersectBody(t[i]);
              }
            }, l.prototype._updateDirection = function () {
              this.to.vsub(this.from, this._direction), this._direction.normalize();
            }, l.prototype.intersectShape = function (t, e, i, o) {
              if (!(k(this.from, this._direction, i) > t.boundingSphereRadius)) {
                var n = this[t.type];n && n.call(this, t, e, i, o, t);
              }
            }, new i(), new i();var v = new i(),
                m = new i(),
                g = new i(),
                w = new i();new i(), new r(), l.prototype.intersectBox = function (t, e, i, o, n) {
              return this.intersectConvex(t.convexPolyhedronRepresentation, e, i, o, n);
            }, l.prototype[s.types.BOX] = l.prototype.intersectBox, l.prototype.intersectPlane = function (t, e, o, n, r) {
              var s = this.from,
                  a = this.to,
                  l = this._direction,
                  h = new i(0, 0, 1);e.vmult(h, h);var c = new i();s.vsub(o, c);var p = c.dot(h);if (a.vsub(o, c), !(p * c.dot(h) > 0 || s.distanceTo(a) < p)) {
                var u = h.dot(l);if (!(Math.abs(u) < this.precision)) {
                  var d = new i(),
                      y = new i(),
                      f = new i();s.vsub(o, d);var v = -h.dot(d) / u;l.scale(v, y), s.vadd(y, f), this.reportIntersection(h, f, r, n, -1);
                }
              }
            }, l.prototype[s.types.PLANE] = l.prototype.intersectPlane, l.prototype.getAABB = function (t) {
              var e = this.to,
                  i = this.from;t.lowerBound.x = Math.min(e.x, i.x), t.lowerBound.y = Math.min(e.y, i.y), t.lowerBound.z = Math.min(e.z, i.z), t.upperBound.x = Math.max(e.x, i.x), t.upperBound.y = Math.max(e.y, i.y), t.upperBound.z = Math.max(e.z, i.z);
            };var b = { faceList: [0] },
                x = new i(),
                _ = new l(),
                B = [];l.prototype.intersectHeightfield = function (t, e, i, o, r) {
              t.data, t.elementSize;var s = _;s.from.copy(this.from), s.to.copy(this.to), n.pointToLocalFrame(i, e, s.from, s.from), n.pointToLocalFrame(i, e, s.to, s.to), s._updateDirection();var l,
                  h,
                  c,
                  p,
                  u = B;l = h = 0, c = p = t.data.length - 1;var d = new a();s.getAABB(d), t.getIndexOfPosition(d.lowerBound.x, d.lowerBound.y, u, !0), l = Math.max(l, u[0]), h = Math.max(h, u[1]), t.getIndexOfPosition(d.upperBound.x, d.upperBound.y, u, !0), c = Math.min(c, u[0] + 1), p = Math.min(p, u[1] + 1);for (var y = l; y < c; y++) {
                for (var f = h; f < p; f++) {
                  if (this.result._shouldStop) return;if (t.getAabbAtIndex(y, f, d), d.overlapsRay(s)) {
                    if (t.getConvexTrianglePillar(y, f, !1), n.pointToWorldFrame(i, e, t.pillarOffset, x), this.intersectConvex(t.pillarConvex, e, x, o, r, b), this.result._shouldStop) return;t.getConvexTrianglePillar(y, f, !0), n.pointToWorldFrame(i, e, t.pillarOffset, x), this.intersectConvex(t.pillarConvex, e, x, o, r, b);
                  }
                }
              }
            }, l.prototype[s.types.HEIGHTFIELD] = l.prototype.intersectHeightfield;var S = new i(),
                E = new i();l.prototype.intersectSphere = function (t, e, i, o, n) {
              var r = this.from,
                  s = this.to,
                  a = t.radius,
                  l = Math.pow(s.x - r.x, 2) + Math.pow(s.y - r.y, 2) + Math.pow(s.z - r.z, 2),
                  h = 2 * ((s.x - r.x) * (r.x - i.x) + (s.y - r.y) * (r.y - i.y) + (s.z - r.z) * (r.z - i.z)),
                  c = Math.pow(r.x - i.x, 2) + Math.pow(r.y - i.y, 2) + Math.pow(r.z - i.z, 2) - Math.pow(a, 2),
                  p = Math.pow(h, 2) - 4 * l * c,
                  u = S,
                  d = E;if (!(p < 0)) if (0 === p) r.lerp(s, p, u), u.vsub(i, d), d.normalize(), this.reportIntersection(d, u, n, o, -1);else {
                var y = (-h - Math.sqrt(p)) / (2 * l),
                    f = (-h + Math.sqrt(p)) / (2 * l);if (y >= 0 && y <= 1 && (r.lerp(s, y, u), u.vsub(i, d), d.normalize(), this.reportIntersection(d, u, n, o, -1)), this.result._shouldStop) return;f >= 0 && f <= 1 && (r.lerp(s, f, u), u.vsub(i, d), d.normalize(), this.reportIntersection(d, u, n, o, -1));
              }
            }, l.prototype[s.types.SPHERE] = l.prototype.intersectSphere;var M = new i(),
                C = (new i(), new i(), new i());l.prototype.intersectConvex = function (t, e, i, o, n, r) {
              for (var s = M, a = C, l = r && r.faceList || null, h = t.faces, c = t.vertices, p = t.faceNormals, u = this._direction, y = this.from, f = this.to, b = y.distanceTo(f), x = l ? l.length : h.length, _ = this.result, B = 0; !_._shouldStop && B < x; B++) {
                var S = l ? l[B] : B,
                    E = h[S],
                    A = p[S],
                    z = e,
                    F = i;a.copy(c[E[0]]), z.vmult(a, a), a.vadd(F, a), a.vsub(y, a), z.vmult(A, s);var T = u.dot(s);if (!(Math.abs(T) < this.precision)) {
                  var R = s.dot(a) / T;if (!(R < 0)) {
                    u.mult(R, v), v.vadd(y, v), m.copy(c[E[0]]), z.vmult(m, m), F.vadd(m, m);for (var P = 1; !_._shouldStop && P < E.length - 1; P++) {
                      g.copy(c[E[P]]), w.copy(c[E[P + 1]]), z.vmult(g, g), z.vmult(w, w), F.vadd(g, g), F.vadd(w, w);var q = v.distanceTo(y);!d(v, m, g, w) && !d(v, g, m, w) || q > b || this.reportIntersection(s, v, n, o, S);
                    }
                  }
                }
              }
            }, l.prototype[s.types.CONVEXPOLYHEDRON] = l.prototype.intersectConvex;var A = new i(),
                z = new i(),
                F = new i(),
                T = new i(),
                R = new i(),
                P = new i(),
                q = (new a(), []),
                I = new n();l.prototype.intersectTrimesh = function (t, e, i, o, r, s) {
              var a = A,
                  l = q,
                  h = I,
                  c = C,
                  p = z,
                  u = F,
                  y = T,
                  f = P,
                  b = R,
                  x = (s && s.faceList, t.indices),
                  _ = (t.vertices, t.faceNormals, this.from),
                  B = this.to,
                  S = this._direction;h.position.copy(i), h.quaternion.copy(e), n.vectorToLocalFrame(i, e, S, p), n.pointToLocalFrame(i, e, _, u), n.pointToLocalFrame(i, e, B, y), y.x *= t.scale.x, y.y *= t.scale.y, y.z *= t.scale.z, u.x *= t.scale.x, u.y *= t.scale.y, u.z *= t.scale.z, y.vsub(u, p), p.normalize();var E = u.distanceSquared(y);t.tree.rayQuery(this, h, l);for (var M = 0, V = l.length; !this.result._shouldStop && M !== V; M++) {
                var O = l[M];t.getNormal(O, a), t.getVertex(x[3 * O], m), m.vsub(u, c);var k = p.dot(a),
                    N = a.dot(c) / k;if (!(N < 0)) {
                  p.scale(N, v), v.vadd(u, v), t.getVertex(x[3 * O + 1], g), t.getVertex(x[3 * O + 2], w);var j = v.distanceSquared(u);!d(v, g, m, w) && !d(v, m, g, w) || j > E || (n.vectorToWorldFrame(e, a, b), n.pointToWorldFrame(i, e, v, f), this.reportIntersection(b, f, r, o, O));
                }
              }l.length = 0;
            }, l.prototype[s.types.TRIMESH] = l.prototype.intersectTrimesh, l.prototype.reportIntersection = function (t, e, i, o, n) {
              var r = this.from,
                  s = this.to,
                  a = r.distanceTo(e),
                  h = this.result;if (!(this.skipBackfaces && t.dot(this._direction) > 0)) switch (h.hitFaceIndex = void 0 !== n ? n : -1, this.mode) {case l.ALL:
                  this.hasHit = !0, h.set(r, s, t, e, i, o, a), h.hasHit = !0, this.callback(h);break;case l.CLOSEST:
                  (a < h.distance || !h.hasHit) && (this.hasHit = !0, h.hasHit = !0, h.set(r, s, t, e, i, o, a));break;case l.ANY:
                  this.hasHit = !0, h.hasHit = !0, h.set(r, s, t, e, i, o, a), h._shouldStop = !0;}
            };var V = new i(),
                O = new i();function k(t, e, i) {
              i.vsub(t, V);var o = V.dot(e);return e.mult(o, O), O.vadd(t, O), i.distanceTo(O);
            }
          }, { "../collision/AABB": 3, "../collision/RaycastResult": 11, "../math/Quaternion": 30, "../math/Transform": 31, "../math/Vec3": 32, "../shapes/Box": 39, "../shapes/ConvexPolyhedron": 40, "../shapes/Shape": 45 }], 11: [function (t, e) {
            var i = t("../math/Vec3");function o() {
              this.rayFromWorld = new i(), this.rayToWorld = new i(), this.hitNormalWorld = new i(), this.hitPointWorld = new i(), this.hasHit = !1, this.shape = null, this.body = null, this.hitFaceIndex = -1, this.distance = -1, this._shouldStop = !1;
            }e.exports = o, o.prototype.reset = function () {
              this.rayFromWorld.setZero(), this.rayToWorld.setZero(), this.hitNormalWorld.setZero(), this.hitPointWorld.setZero(), this.hasHit = !1, this.shape = null, this.body = null, this.hitFaceIndex = -1, this.distance = -1, this._shouldStop = !1;
            }, o.prototype.abort = function () {
              this._shouldStop = !0;
            }, o.prototype.set = function (t, e, i, o, n, r, s) {
              this.rayFromWorld.copy(t), this.rayToWorld.copy(e), this.hitNormalWorld.copy(i), this.hitPointWorld.copy(o), this.shape = n, this.body = r, this.distance = s;
            };
          }, { "../math/Vec3": 32 }], 12: [function (t, e) {
            t("../shapes/Shape");var i = t("../collision/Broadphase");function o(t) {
              i.apply(this), this.axisList = [], this.world = null, this.axisIndex = 0;var e = this.axisList;this._addBodyHandler = function (t) {
                e.push(t.body);
              }, this._removeBodyHandler = function (t) {
                var i = e.indexOf(t.body);-1 !== i && e.splice(i, 1);
              }, t && this.setWorld(t);
            }e.exports = o, o.prototype = new i(), o.prototype.setWorld = function (t) {
              this.axisList.length = 0;for (var e = 0; e < t.bodies.length; e++) {
                this.axisList.push(t.bodies[e]);
              }t.removeEventListener("addBody", this._addBodyHandler), t.removeEventListener("removeBody", this._removeBodyHandler), t.addEventListener("addBody", this._addBodyHandler), t.addEventListener("removeBody", this._removeBodyHandler), this.world = t, this.dirty = !0;
            }, o.insertionSortX = function (t) {
              for (var e = 1, i = t.length; e < i; e++) {
                for (var o = t[e], n = e - 1; n >= 0 && !(t[n].aabb.lowerBound.x <= o.aabb.lowerBound.x); n--) {
                  t[n + 1] = t[n];
                }t[n + 1] = o;
              }return t;
            }, o.insertionSortY = function (t) {
              for (var e = 1, i = t.length; e < i; e++) {
                for (var o = t[e], n = e - 1; n >= 0 && !(t[n].aabb.lowerBound.y <= o.aabb.lowerBound.y); n--) {
                  t[n + 1] = t[n];
                }t[n + 1] = o;
              }return t;
            }, o.insertionSortZ = function (t) {
              for (var e = 1, i = t.length; e < i; e++) {
                for (var o = t[e], n = e - 1; n >= 0 && !(t[n].aabb.lowerBound.z <= o.aabb.lowerBound.z); n--) {
                  t[n + 1] = t[n];
                }t[n + 1] = o;
              }return t;
            }, o.prototype.collisionPairs = function (t, e, i) {
              var n,
                  r,
                  s = this.axisList,
                  a = s.length,
                  l = this.axisIndex;for (this.dirty && (this.sortList(), this.dirty = !1), n = 0; n !== a; n++) {
                var h = s[n];for (r = n + 1; r < a; r++) {
                  var c = s[r];if (this.needBroadphaseCollision(h, c)) {
                    if (!o.checkBounds(h, c, l)) break;this.intersectionTest(h, c, e, i);
                  }
                }
              }
            }, o.prototype.sortList = function () {
              for (var t = this.axisList, e = this.axisIndex, i = t.length, n = 0; n !== i; n++) {
                var r = t[n];r.aabbNeedsUpdate && r.computeAABB();
              }0 === e ? o.insertionSortX(t) : 1 === e ? o.insertionSortY(t) : 2 === e && o.insertionSortZ(t);
            }, o.checkBounds = function (t, e, i) {
              var o, n;0 === i ? (o = t.position.x, n = e.position.x) : 1 === i ? (o = t.position.y, n = e.position.y) : 2 === i && (o = t.position.z, n = e.position.z);var r = t.boundingRadius;return n - e.boundingRadius < o + r;
            }, o.prototype.autoDetectAxis = function () {
              for (var t = 0, e = 0, i = 0, o = 0, n = 0, r = 0, s = this.axisList, a = s.length, l = 1 / a, h = 0; h !== a; h++) {
                var c = s[h],
                    p = c.position.x;t += p, e += p * p;var u = c.position.y;i += u, o += u * u;var d = c.position.z;n += d, r += d * d;
              }var y = e - t * t * l,
                  f = o - i * i * l,
                  v = r - n * n * l;this.axisIndex = y > f ? y > v ? 0 : 2 : f > v ? 1 : 2;
            }, o.prototype.aabbQuery = function (t, e, i) {
              i = i || [], this.dirty && (this.sortList(), this.dirty = !1);var o = this.axisIndex,
                  n = "x";1 === o && (n = "y"), 2 === o && (n = "z");for (var r = this.axisList, s = (e.lowerBound[n], e.upperBound[n], 0); s < r.length; s++) {
                var a = r[s];a.aabbNeedsUpdate && a.computeAABB(), a.aabb.overlaps(e) && i.push(a);
              }return i;
            };
          }, { "../collision/Broadphase": 5, "../shapes/Shape": 45 }], 13: [function (t, e) {
            e.exports = s, t("./Constraint");var i = t("./PointToPointConstraint"),
                o = t("../equations/ConeEquation"),
                n = t("../equations/RotationalEquation"),
                r = (t("../equations/ContactEquation"), t("../math/Vec3"));function s(t, e, s) {
              var a = void 0 !== (s = s || {}).maxForce ? s.maxForce : 1e6,
                  l = s.pivotA ? s.pivotA.clone() : new r(),
                  h = s.pivotB ? s.pivotB.clone() : new r();this.axisA = s.axisA ? s.axisA.clone() : new r(), this.axisB = s.axisB ? s.axisB.clone() : new r(), i.call(this, t, l, e, h, a), this.collideConnected = !!s.collideConnected, this.angle = void 0 !== s.angle ? s.angle : 0;var c = this.coneEquation = new o(t, e, s),
                  p = this.twistEquation = new n(t, e, s);this.twistAngle = void 0 !== s.twistAngle ? s.twistAngle : 0, c.maxForce = 0, c.minForce = -a, p.maxForce = 0, p.minForce = -a, this.equations.push(c, p);
            }s.prototype = new i(), s.constructor = s, new r(), new r(), s.prototype.update = function () {
              var t = this.bodyA,
                  e = this.bodyB,
                  o = this.coneEquation,
                  n = this.twistEquation;i.prototype.update.call(this), t.vectorToWorldFrame(this.axisA, o.axisA), e.vectorToWorldFrame(this.axisB, o.axisB), this.axisA.tangents(n.axisA, n.axisA), t.vectorToWorldFrame(n.axisA, n.axisA), this.axisB.tangents(n.axisB, n.axisB), e.vectorToWorldFrame(n.axisB, n.axisB), o.angle = this.angle, n.maxAngle = this.twistAngle;
            };
          }, { "../equations/ConeEquation": 19, "../equations/ContactEquation": 20, "../equations/RotationalEquation": 23, "../math/Vec3": 32, "./Constraint": 14, "./PointToPointConstraint": 18 }], 14: [function (t, e) {
            e.exports = o;var i = t("../utils/Utils");function o(t, e, n) {
              n = i.defaults(n, { collideConnected: !0, wakeUpBodies: !0 }), this.equations = [], this.bodyA = t, this.bodyB = e, this.id = o.idCounter++, this.collideConnected = n.collideConnected, n.wakeUpBodies && (t && t.wakeUp(), e && e.wakeUp());
            }o.prototype.update = function () {
              throw new Error("method update() not implmemented in this Constraint subclass!");
            }, o.prototype.enable = function () {
              for (var t = this.equations, e = 0; e < t.length; e++) {
                t[e].enabled = !0;
              }
            }, o.prototype.disable = function () {
              for (var t = this.equations, e = 0; e < t.length; e++) {
                t[e].enabled = !1;
              }
            }, o.idCounter = 0;
          }, { "../utils/Utils": 55 }], 15: [function (t, e) {
            e.exports = n;var i = t("./Constraint"),
                o = t("../equations/ContactEquation");function n(t, e, n, r) {
              i.call(this, t, e), void 0 === n && (n = t.position.distanceTo(e.position)), void 0 === r && (r = 1e6), this.distance = n;var s = this.distanceEquation = new o(t, e);this.equations.push(s), s.minForce = -r, s.maxForce = r;
            }n.prototype = new i(), n.prototype.update = function () {
              var t = this.bodyA,
                  e = this.bodyB,
                  i = this.distanceEquation,
                  o = .5 * this.distance,
                  n = i.ni;e.position.vsub(t.position, n), n.normalize(), n.mult(o, i.ri), n.mult(-o, i.rj);
            };
          }, { "../equations/ContactEquation": 20, "./Constraint": 14 }], 16: [function (t, e) {
            e.exports = s, t("./Constraint");var i = t("./PointToPointConstraint"),
                o = t("../equations/RotationalEquation"),
                n = t("../equations/RotationalMotorEquation"),
                r = (t("../equations/ContactEquation"), t("../math/Vec3"));function s(t, e, s) {
              var a = void 0 !== (s = s || {}).maxForce ? s.maxForce : 1e6,
                  l = s.pivotA ? s.pivotA.clone() : new r(),
                  h = s.pivotB ? s.pivotB.clone() : new r();i.call(this, t, l, e, h, a), (this.axisA = s.axisA ? s.axisA.clone() : new r(1, 0, 0)).normalize(), (this.axisB = s.axisB ? s.axisB.clone() : new r(1, 0, 0)).normalize();var c = this.rotationalEquation1 = new o(t, e, s),
                  p = this.rotationalEquation2 = new o(t, e, s),
                  u = this.motorEquation = new n(t, e, a);u.enabled = !1, this.equations.push(c, p, u);
            }s.prototype = new i(), s.constructor = s, s.prototype.enableMotor = function () {
              this.motorEquation.enabled = !0;
            }, s.prototype.disableMotor = function () {
              this.motorEquation.enabled = !1;
            }, s.prototype.setMotorSpeed = function (t) {
              this.motorEquation.targetVelocity = t;
            }, s.prototype.setMotorMaxForce = function (t) {
              this.motorEquation.maxForce = t, this.motorEquation.minForce = -t;
            };var a = new r(),
                l = new r();s.prototype.update = function () {
              var t = this.bodyA,
                  e = this.bodyB,
                  o = this.motorEquation,
                  n = this.rotationalEquation1,
                  r = this.rotationalEquation2,
                  s = a,
                  h = l,
                  c = this.axisA,
                  p = this.axisB;i.prototype.update.call(this), t.quaternion.vmult(c, s), e.quaternion.vmult(p, h), s.tangents(n.axisA, r.axisA), n.axisB.copy(h), r.axisB.copy(h), this.motorEquation.enabled && (t.quaternion.vmult(this.axisA, o.axisA), e.quaternion.vmult(this.axisB, o.axisB));
            };
          }, { "../equations/ContactEquation": 20, "../equations/RotationalEquation": 23, "../equations/RotationalMotorEquation": 24, "../math/Vec3": 32, "./Constraint": 14, "./PointToPointConstraint": 18 }], 17: [function (t, e) {
            e.exports = r, t("./Constraint");var i = t("./PointToPointConstraint"),
                o = t("../equations/RotationalEquation"),
                n = (t("../equations/RotationalMotorEquation"), t("../equations/ContactEquation"), t("../math/Vec3"));function r(t, e, r) {
              var s = void 0 !== (r = r || {}).maxForce ? r.maxForce : 1e6,
                  a = new n(),
                  l = new n(),
                  h = new n();t.position.vadd(e.position, h), h.scale(.5, h), e.pointToLocalFrame(h, l), t.pointToLocalFrame(h, a), i.call(this, t, a, e, l, s), this.xA = t.vectorToLocalFrame(n.UNIT_X), this.xB = e.vectorToLocalFrame(n.UNIT_X), this.yA = t.vectorToLocalFrame(n.UNIT_Y), this.yB = e.vectorToLocalFrame(n.UNIT_Y), this.zA = t.vectorToLocalFrame(n.UNIT_Z), this.zB = e.vectorToLocalFrame(n.UNIT_Z);var c = this.rotationalEquation1 = new o(t, e, r),
                  p = this.rotationalEquation2 = new o(t, e, r),
                  u = this.rotationalEquation3 = new o(t, e, r);this.equations.push(c, p, u);
            }r.prototype = new i(), r.constructor = r, new n(), new n(), r.prototype.update = function () {
              var t = this.bodyA,
                  e = this.bodyB,
                  o = (this.motorEquation, this.rotationalEquation1),
                  n = this.rotationalEquation2,
                  r = this.rotationalEquation3;i.prototype.update.call(this), t.vectorToWorldFrame(this.xA, o.axisA), e.vectorToWorldFrame(this.yB, o.axisB), t.vectorToWorldFrame(this.yA, n.axisA), e.vectorToWorldFrame(this.zB, n.axisB), t.vectorToWorldFrame(this.zA, r.axisA), e.vectorToWorldFrame(this.xB, r.axisB);
            };
          }, { "../equations/ContactEquation": 20, "../equations/RotationalEquation": 23, "../equations/RotationalMotorEquation": 24, "../math/Vec3": 32, "./Constraint": 14, "./PointToPointConstraint": 18 }], 18: [function (t, e) {
            e.exports = r;var i = t("./Constraint"),
                o = t("../equations/ContactEquation"),
                n = t("../math/Vec3");function r(t, e, r, s, a) {
              i.call(this, t, r), a = void 0 !== a ? a : 1e6, this.pivotA = e ? e.clone() : new n(), this.pivotB = s ? s.clone() : new n();var l = this.equationX = new o(t, r),
                  h = this.equationY = new o(t, r),
                  c = this.equationZ = new o(t, r);this.equations.push(l, h, c), l.minForce = h.minForce = c.minForce = -a, l.maxForce = h.maxForce = c.maxForce = a, l.ni.set(1, 0, 0), h.ni.set(0, 1, 0), c.ni.set(0, 0, 1);
            }r.prototype = new i(), r.prototype.update = function () {
              var t = this.bodyA,
                  e = this.bodyB,
                  i = this.equationX,
                  o = this.equationY,
                  n = this.equationZ;t.quaternion.vmult(this.pivotA, i.ri), e.quaternion.vmult(this.pivotB, i.rj), o.ri.copy(i.ri), o.rj.copy(i.rj), n.ri.copy(i.ri), n.rj.copy(i.rj);
            };
          }, { "../equations/ContactEquation": 20, "../math/Vec3": 32, "./Constraint": 14 }], 19: [function (t, e) {
            e.exports = r;var i = t("../math/Vec3"),
                o = (t("../math/Mat3"), t("./Equation")),
                n = t("../math/CMath");function r(t, e, n) {
              var r = void 0 !== (n = n || {}).maxForce ? n.maxForce : 1e6;o.call(this, t, e, -r, r), this.axisA = n.axisA ? n.axisA.clone() : new i(1, 0, 0), this.axisB = n.axisB ? n.axisB.clone() : new i(0, 1, 0), this.angle = void 0 !== n.angle ? n.angle : 0;
            }r.prototype = new o(), r.prototype.constructor = r;var s = new i(),
                a = new i();r.prototype.computeB = function (t) {
              var e = this.a,
                  i = this.b,
                  o = this.axisA,
                  r = this.axisB,
                  l = s,
                  h = a,
                  c = this.jacobianElementA,
                  p = this.jacobianElementB;return o.cross(r, l), r.cross(o, h), c.rotational.copy(h), p.rotational.copy(l), -(n.cos(this.angle) - o.dot(r)) * e - this.computeGW() * i - t * this.computeGiMf();
            };
          }, { "../math/CMath": 27, "../math/Mat3": 29, "../math/Vec3": 32, "./Equation": 21 }], 20: [function (t, e) {
            e.exports = n;var i = t("./Equation"),
                o = t("../math/Vec3");function n(t, e, n) {
              n = void 0 !== n ? n : 1e6, i.call(this, t, e, 0, n), this.si = null, this.sj = null, this.restitution = 0, this.ri = new o(), this.rj = new o(), this.ni = new o();
            }t("../math/Mat3"), n.prototype = new i(), n.prototype.constructor = n;var r = new o(),
                s = new o(),
                a = new o();n.prototype.computeB = function (t) {
              var e = this.a,
                  i = this.b,
                  o = this.bi,
                  n = this.bj,
                  l = this.ri,
                  h = this.rj,
                  c = r,
                  p = s,
                  u = o.velocity,
                  d = o.angularVelocity,
                  y = (o.force, o.torque, n.velocity),
                  f = n.angularVelocity,
                  v = (n.force, n.torque, a),
                  m = this.jacobianElementA,
                  g = this.jacobianElementB,
                  w = this.ni;l.cross(w, c), h.cross(w, p), w.negate(m.spatial), c.negate(m.rotational), g.spatial.copy(w), g.rotational.copy(p), v.copy(n.position), v.vadd(h, v), v.vsub(o.position, v), v.vsub(l, v);var b = w.dot(v),
                  x = this.restitution + 1;return -b * e - (x * y.dot(w) - x * u.dot(w) + f.dot(p) - d.dot(c)) * i - t * this.computeGiMf();
            };var l = new o(),
                h = new o(),
                c = new o(),
                p = new o(),
                u = new o();n.prototype.getImpactVelocityAlongNormal = function () {
              var t = l,
                  e = h,
                  i = c,
                  o = p,
                  n = u;return this.bi.position.vadd(this.ri, i), this.bj.position.vadd(this.rj, o), this.bi.getVelocityAtWorldPoint(i, t), this.bj.getVelocityAtWorldPoint(o, e), t.vsub(e, n), this.ni.dot(n);
            };
          }, { "../math/Mat3": 29, "../math/Vec3": 32, "./Equation": 21 }], 21: [function (t, e) {
            e.exports = n;var i = t("../math/JacobianElement"),
                o = t("../math/Vec3");function n(t, e, o, r) {
              this.id = n.id++, this.minForce = void 0 === o ? -1e6 : o, this.maxForce = void 0 === r ? 1e6 : r, this.bi = t, this.bj = e, this.a = 0, this.b = 0, this.eps = 0, this.jacobianElementA = new i(), this.jacobianElementB = new i(), this.enabled = !0, this.multiplier = 0, this.setSpookParams(1e7, 4, 1 / 60);
            }n.prototype.constructor = n, n.id = 0, n.prototype.setSpookParams = function (t, e, i) {
              var o = e,
                  n = t,
                  r = i;this.a = 4 / (r * (1 + 4 * o)), this.b = 4 * o / (1 + 4 * o), this.eps = 4 / (r * r * n * (1 + 4 * o));
            }, n.prototype.computeB = function (t, e, i) {
              var o = this.computeGW();return -this.computeGq() * t - o * e - this.computeGiMf() * i;
            }, n.prototype.computeGq = function () {
              var t = this.jacobianElementA,
                  e = this.jacobianElementB,
                  i = this.bi,
                  o = this.bj,
                  n = i.position,
                  r = o.position;return t.spatial.dot(n) + e.spatial.dot(r);
            }, new o(), n.prototype.computeGW = function () {
              var t = this.jacobianElementA,
                  e = this.jacobianElementB,
                  i = this.bi,
                  o = this.bj,
                  n = i.velocity,
                  r = o.velocity,
                  s = i.angularVelocity,
                  a = o.angularVelocity;return t.multiplyVectors(n, s) + e.multiplyVectors(r, a);
            }, n.prototype.computeGWlambda = function () {
              var t = this.jacobianElementA,
                  e = this.jacobianElementB,
                  i = this.bi,
                  o = this.bj,
                  n = i.vlambda,
                  r = o.vlambda,
                  s = i.wlambda,
                  a = o.wlambda;return t.multiplyVectors(n, s) + e.multiplyVectors(r, a);
            };var r = new o(),
                s = new o(),
                a = new o(),
                l = new o();n.prototype.computeGiMf = function () {
              var t = this.jacobianElementA,
                  e = this.jacobianElementB,
                  i = this.bi,
                  o = this.bj,
                  n = i.force,
                  h = i.torque,
                  c = o.force,
                  p = o.torque,
                  u = i.invMassSolve,
                  d = o.invMassSolve;return n.scale(u, r), c.scale(d, s), i.invInertiaWorldSolve.vmult(h, a), o.invInertiaWorldSolve.vmult(p, l), t.multiplyVectors(r, a) + e.multiplyVectors(s, l);
            };var h = new o();n.prototype.computeGiMGt = function () {
              var t = this.jacobianElementA,
                  e = this.jacobianElementB,
                  i = this.bi,
                  o = this.bj,
                  n = i.invMassSolve,
                  r = o.invMassSolve,
                  s = i.invInertiaWorldSolve,
                  a = o.invInertiaWorldSolve,
                  l = n + r;return s.vmult(t.rotational, h), l += h.dot(t.rotational), a.vmult(e.rotational, h), l + h.dot(e.rotational);
            };var c = new o();new o(), new o(), new o(), new o(), new o(), n.prototype.addToWlambda = function (t) {
              var e = this.jacobianElementA,
                  i = this.jacobianElementB,
                  o = this.bi,
                  n = this.bj,
                  r = c;o.vlambda.addScaledVector(o.invMassSolve * t, e.spatial, o.vlambda), n.vlambda.addScaledVector(n.invMassSolve * t, i.spatial, n.vlambda), o.invInertiaWorldSolve.vmult(e.rotational, r), o.wlambda.addScaledVector(t, r, o.wlambda), n.invInertiaWorldSolve.vmult(i.rotational, r), n.wlambda.addScaledVector(t, r, n.wlambda);
            }, n.prototype.computeC = function () {
              return this.computeGiMGt() + this.eps;
            };
          }, { "../math/JacobianElement": 28, "../math/Vec3": 32 }], 22: [function (t, e) {
            e.exports = n;var i = t("./Equation"),
                o = t("../math/Vec3");function n(t, e, n) {
              i.call(this, t, e, -n, n), this.ri = new o(), this.rj = new o(), this.t = new o();
            }t("../math/Mat3"), n.prototype = new i(), n.prototype.constructor = n;var r = new o(),
                s = new o();n.prototype.computeB = function (t) {
              this.a;var e = this.b,
                  i = (this.bi, this.bj, this.ri),
                  o = this.rj,
                  n = r,
                  a = s,
                  l = this.t;i.cross(l, n), o.cross(l, a);var h = this.jacobianElementA,
                  c = this.jacobianElementB;return l.negate(h.spatial), n.negate(h.rotational), c.spatial.copy(l), c.rotational.copy(a), -this.computeGW() * e - t * this.computeGiMf();
            };
          }, { "../math/Mat3": 29, "../math/Vec3": 32, "./Equation": 21 }], 23: [function (t, e) {
            e.exports = r;var i = t("../math/Vec3"),
                o = (t("../math/Mat3"), t("./Equation")),
                n = t("../math/CMath");function r(t, e, n) {
              var r = void 0 !== (n = n || {}).maxForce ? n.maxForce : 1e6;o.call(this, t, e, -r, r), this.axisA = n.axisA ? n.axisA.clone() : new i(1, 0, 0), this.axisB = n.axisB ? n.axisB.clone() : new i(0, 1, 0), this.maxAngle = Math.PI / 2;
            }r.prototype = new o(), r.prototype.constructor = r;var s = new i(),
                a = new i();r.prototype.computeB = function (t) {
              var e = this.a,
                  i = this.b,
                  o = this.axisA,
                  r = this.axisB,
                  l = s,
                  h = a,
                  c = this.jacobianElementA,
                  p = this.jacobianElementB;return o.cross(r, l), r.cross(o, h), c.rotational.copy(h), p.rotational.copy(l), -(n.cos(this.maxAngle) - o.dot(r)) * e - this.computeGW() * i - t * this.computeGiMf();
            };
          }, { "../math/CMath": 27, "../math/Mat3": 29, "../math/Vec3": 32, "./Equation": 21 }], 24: [function (t, e) {
            e.exports = n;var i = t("../math/Vec3"),
                o = (t("../math/Mat3"), t("./Equation"));function n(t, e, n) {
              n = void 0 !== n ? n : 1e6, o.call(this, t, e, -n, n), this.axisA = new i(), this.axisB = new i(), this.targetVelocity = 0;
            }n.prototype = new o(), n.prototype.constructor = n, n.prototype.computeB = function (t) {
              this.a;var e = this.b,
                  i = (this.bi, this.bj, this.axisA),
                  o = this.axisB,
                  n = this.jacobianElementA,
                  r = this.jacobianElementB;return n.rotational.copy(i), o.negate(r.rotational), -(this.computeGW() - this.targetVelocity) * e - t * this.computeGiMf();
            };
          }, { "../math/Mat3": 29, "../math/Vec3": 32, "./Equation": 21 }], 25: [function (t, e) {
            var i = t("../utils/Utils");function o(t, e, n) {
              n = i.defaults(n, { friction: .3, restitution: .3, contactEquationStiffness: 1e7, contactEquationRelaxation: 3, frictionEquationStiffness: 1e7, frictionEquationRelaxation: 3 }), this.id = o.idCounter++, this.materials = [t, e], this.friction = n.friction, this.restitution = n.restitution, this.contactEquationStiffness = n.contactEquationStiffness, this.contactEquationRelaxation = n.contactEquationRelaxation, this.frictionEquationStiffness = n.frictionEquationStiffness, this.frictionEquationRelaxation = n.frictionEquationRelaxation;
            }e.exports = o, o.idCounter = 0;
          }, { "../utils/Utils": 55 }], 26: [function (t, e) {
            function i(t) {
              var e = "";"string" == typeof (t = t || {}) ? (e = t, t = {}) : "object" == (typeof t === "undefined" ? "undefined" : _typeof(t)) && (e = ""), this.name = e, this.id = i.idCounter++, this.friction = void 0 !== t.friction ? t.friction : -1, this.restitution = void 0 !== t.restitution ? t.restitution : -1;
            }e.exports = i, i.idCounter = 0;
          }, {}], 27: [function (t, e) {
            var i = 180 / Math.PI;function o(t) {
              return t * i;
            }var n = {};function r(t) {
              if (n.digit != t) {
                for (var e = 1 / Math.pow(10, t), o = 0; o <= 90; o += e) {
                  n[o.toFixed(t)] = Math.sin(o / i);
                }n.digit = t;
              }
            }function s(t, e) {
              return t <= 90 ? n[t.toFixed(e)] : t <= 180 ? n[(t = 180 - t).toFixed(e)] : t <= 270 ? -n[(t -= 180).toFixed(e)] : -n[(t = 360 - t).toFixed(e)];
            }function a(t) {
              var e = o(t) % 360;return e < 0 && (e += 360), s(e, p._digit);
            }function l(t) {
              var e = (o(t) + 90) % 360;return e < 0 && (e += 360), s(e, p._digit);
            }function h(t) {
              return Math.sin(t).toFixed(p.digit);
            }function c(t) {
              return Math.cos(t).toFixed(p.digit);
            }var p = { sin: Math.sin, cos: Math.cos, atan2: Math.atan2 };p._sin = a, p._cos = l, p._sinArr = n, p._sin360 = s, p._sinNative = h, p._cosNative = c, p._radian2angle = o, p._calculateSinByDigit = r, p._digit = 1, Object.defineProperty(p, "digit", { get: function get() {
                return this._digit;
              }, set: function set(t) {
                this._digit = t, 1 == this._mode && r(t);
              } }), p._mode = 0, Object.defineProperty(p, "mode", { get: function get() {
                return this._mode;
              }, set: function set(t) {
                this._mode != t && (this._mode = t, 0 == t ? (p.sin = Math.sin, p.cos = Math.cos) : 1 == t ? (p.digit = p._digit, p.sin = a, p.cos = l) : 2 == t && (p.sin = h, p.cos = c));
              } }), e.exports = p;
          }, {}], 28: [function (t, e) {
            e.exports = o;var i = t("./Vec3");function o() {
              this.spatial = new i(), this.rotational = new i();
            }o.prototype.multiplyElement = function (t) {
              return t.spatial.dot(this.spatial) + t.rotational.dot(this.rotational);
            }, o.prototype.multiplyVectors = function (t, e) {
              return t.dot(this.spatial) + e.dot(this.rotational);
            };
          }, { "./Vec3": 32 }], 29: [function (t, e) {
            e.exports = o;var i = t("./Vec3");function o(t) {
              this.elements = t || [0, 0, 0, 0, 0, 0, 0, 0, 0];
            }o.prototype.identity = function () {
              var t = this.elements;t[0] = 1, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 1, t[5] = 0, t[6] = 0, t[7] = 0, t[8] = 1;
            }, o.prototype.setZero = function () {
              var t = this.elements;t[0] = 0, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[5] = 0, t[6] = 0, t[7] = 0, t[8] = 0;
            }, o.prototype.setTrace = function (t) {
              var e = this.elements;e[0] = t.x, e[4] = t.y, e[8] = t.z;
            }, o.prototype.getTrace = function (t) {
              t = t || new i();var e = this.elements;t.x = e[0], t.y = e[4], t.z = e[8];
            }, o.prototype.vmult = function (t, e) {
              e = e || new i();var o = this.elements,
                  n = t.x,
                  r = t.y,
                  s = t.z;return e.x = o[0] * n + o[1] * r + o[2] * s, e.y = o[3] * n + o[4] * r + o[5] * s, e.z = o[6] * n + o[7] * r + o[8] * s, e;
            }, o.prototype.smult = function (t) {
              for (var e = 0; e < this.elements.length; e++) {
                this.elements[e] *= t;
              }
            }, o.prototype.mmult = function (t, e) {
              for (var i = e || new o(), n = 0; n < 3; n++) {
                for (var r = 0; r < 3; r++) {
                  for (var s = 0, a = 0; a < 3; a++) {
                    s += t.elements[n + 3 * a] * this.elements[a + 3 * r];
                  }i.elements[n + 3 * r] = s;
                }
              }return i;
            }, o.prototype.scale = function (t, e) {
              e = e || new o();for (var i = this.elements, n = e.elements, r = 0; 3 !== r; r++) {
                n[3 * r + 0] = t.x * i[3 * r + 0], n[3 * r + 1] = t.y * i[3 * r + 1], n[3 * r + 2] = t.z * i[3 * r + 2];
              }return e;
            }, o.prototype.solve = function (t, e) {
              e = e || new i();for (var o, n = [], r = 0; r < 12; r++) {
                n.push(0);
              }for (r = 0; r < 3; r++) {
                for (o = 0; o < 3; o++) {
                  n[r + 4 * o] = this.elements[r + 3 * o];
                }
              }n[3] = t.x, n[7] = t.y, n[11] = t.z;var s,
                  a,
                  l = 3,
                  h = l;do {
                if (0 === n[(r = h - l) + 4 * r]) for (o = r + 1; o < h; o++) {
                  if (0 !== n[r + 4 * o]) {
                    s = 4;do {
                      n[(a = 4 - s) + 4 * r] += n[a + 4 * o];
                    } while (--s);break;
                  }
                }if (0 !== n[r + 4 * r]) for (o = r + 1; o < h; o++) {
                  var c = n[r + 4 * o] / n[r + 4 * r];s = 4;do {
                    n[(a = 4 - s) + 4 * o] = a <= r ? 0 : n[a + 4 * o] - n[a + 4 * r] * c;
                  } while (--s);
                }
              } while (--l);if (e.z = n[11] / n[10], e.y = (n[7] - n[6] * e.z) / n[5], e.x = (n[3] - n[2] * e.z - n[1] * e.y) / n[0], isNaN(e.x) || isNaN(e.y) || isNaN(e.z) || e.x === 1 / 0 || e.y === 1 / 0 || e.z === 1 / 0) throw "Could not solve equation! Got x=[" + e.toString() + "], b=[" + t.toString() + "], A=[" + this.toString() + "]";return e;
            }, o.prototype.e = function (t, e, i) {
              if (void 0 === i) return this.elements[e + 3 * t];this.elements[e + 3 * t] = i;
            }, o.prototype.copy = function (t) {
              for (var e = 0; e < t.elements.length; e++) {
                this.elements[e] = t.elements[e];
              }return this;
            }, o.prototype.toString = function () {
              for (var t = "", e = 0; e < 9; e++) {
                t += this.elements[e] + ",";
              }return t;
            }, o.prototype.reverse = function (t) {
              t = t || new o();for (var e, i = [], n = 0; n < 18; n++) {
                i.push(0);
              }for (n = 0; n < 3; n++) {
                for (e = 0; e < 3; e++) {
                  i[n + 6 * e] = this.elements[n + 3 * e];
                }
              }i[3] = 1, i[9] = 0, i[15] = 0, i[4] = 0, i[10] = 1, i[16] = 0, i[5] = 0, i[11] = 0, i[17] = 1;var r,
                  s,
                  a = 3,
                  l = a;do {
                if (0 === i[(n = l - a) + 6 * n]) for (e = n + 1; e < l; e++) {
                  if (0 !== i[n + 6 * e]) {
                    r = 6;do {
                      i[(s = 6 - r) + 6 * n] += i[s + 6 * e];
                    } while (--r);break;
                  }
                }if (0 !== i[n + 6 * n]) for (e = n + 1; e < l; e++) {
                  var h = i[n + 6 * e] / i[n + 6 * n];r = 6;do {
                    i[(s = 6 - r) + 6 * e] = s <= n ? 0 : i[s + 6 * e] - i[s + 6 * n] * h;
                  } while (--r);
                }
              } while (--a);n = 2;do {
                e = n - 1;do {
                  h = i[n + 6 * e] / i[n + 6 * n], r = 6;do {
                    i[(s = 6 - r) + 6 * e] = i[s + 6 * e] - i[s + 6 * n] * h;
                  } while (--r);
                } while (e--);
              } while (--n);n = 2;do {
                h = 1 / i[n + 6 * n], r = 6;do {
                  i[(s = 6 - r) + 6 * n] = i[s + 6 * n] * h;
                } while (--r);
              } while (n--);n = 2;do {
                e = 2;do {
                  if (s = i[3 + e + 6 * n], isNaN(s) || s === 1 / 0) throw "Could not reverse! A=[" + this.toString() + "]";t.e(n, e, s);
                } while (e--);
              } while (n--);return t;
            }, o.prototype.setRotationFromQuaternion = function (t) {
              var e = t.x,
                  i = t.y,
                  o = t.z,
                  n = t.w,
                  r = e + e,
                  s = i + i,
                  a = o + o,
                  l = e * r,
                  h = e * s,
                  c = e * a,
                  p = i * s,
                  u = i * a,
                  d = o * a,
                  y = n * r,
                  f = n * s,
                  v = n * a,
                  m = this.elements;return m[0] = 1 - (p + d), m[1] = h - v, m[2] = c + f, m[3] = h + v, m[4] = 1 - (l + d), m[5] = u - y, m[6] = c - f, m[7] = u + y, m[8] = 1 - (l + p), this;
            }, o.prototype.transpose = function (t) {
              for (var e = (t = t || new o()).elements, i = this.elements, n = 0; 3 !== n; n++) {
                for (var r = 0; 3 !== r; r++) {
                  e[3 * n + r] = i[3 * r + n];
                }
              }return t;
            };
          }, { "./Vec3": 32 }], 30: [function (t, e) {
            e.exports = n;var i = t("./Vec3"),
                o = t("./CMath");function n(t, e, i, o) {
              this.x = void 0 !== t ? t : 0, this.y = void 0 !== e ? e : 0, this.z = void 0 !== i ? i : 0, this.w = void 0 !== o ? o : 1;
            }n.prototype.set = function (t, e, i, o) {
              return this.x = t, this.y = e, this.z = i, this.w = o, this;
            }, n.prototype.toString = function () {
              return this.x + "," + this.y + "," + this.z + "," + this.w;
            }, n.prototype.toArray = function () {
              return [this.x, this.y, this.z, this.w];
            }, n.prototype.setFromAxisAngle = function (t, e) {
              var i = o.sin(.5 * e);return this.x = t.x * i, this.y = t.y * i, this.z = t.z * i, this.w = o.cos(.5 * e), this;
            }, n.prototype.toAxisAngle = function (t) {
              t = t || new i(), this.normalize();var e = 2 * Math.acos(this.w),
                  o = Math.sqrt(1 - this.w * this.w);return o < .001 ? (t.x = this.x, t.y = this.y, t.z = this.z) : (t.x = this.x / o, t.y = this.y / o, t.z = this.z / o), [t, e];
            };var r = new i(),
                s = new i();n.prototype.setFromVectors = function (t, e) {
              if (t.isAntiparallelTo(e)) {
                var i = r,
                    o = s;t.tangents(i, o), this.setFromAxisAngle(i, Math.PI);
              } else {
                var n = t.cross(e);this.x = n.x, this.y = n.y, this.z = n.z, this.w = Math.sqrt(Math.pow(t.norm(), 2) * Math.pow(e.norm(), 2)) + t.dot(e), this.normalize();
              }return this;
            }, new i(), new i(), new i(), n.prototype.mult = function (t, e) {
              e = e || new n();var i = this.x,
                  o = this.y,
                  r = this.z,
                  s = this.w,
                  a = t.x,
                  l = t.y,
                  h = t.z,
                  c = t.w;return e.x = i * c + s * a + o * h - r * l, e.y = o * c + s * l + r * a - i * h, e.z = r * c + s * h + i * l - o * a, e.w = s * c - i * a - o * l - r * h, e;
            }, n.prototype.inverse = function (t) {
              var e = this.x,
                  i = this.y,
                  o = this.z,
                  r = this.w;t = t || new n(), this.conjugate(t);var s = 1 / (e * e + i * i + o * o + r * r);return t.x *= s, t.y *= s, t.z *= s, t.w *= s, t;
            }, n.prototype.conjugate = function (t) {
              return (t = t || new n()).x = -this.x, t.y = -this.y, t.z = -this.z, t.w = this.w, t;
            }, n.prototype.normalize = function () {
              var t = Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w);return 0 === t ? (this.x = 0, this.y = 0, this.z = 0, this.w = 0) : (t = 1 / t, this.x *= t, this.y *= t, this.z *= t, this.w *= t), this;
            }, n.prototype.normalizeFast = function () {
              var t = (3 - (this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w)) / 2;return 0 === t ? (this.x = 0, this.y = 0, this.z = 0, this.w = 0) : (this.x *= t, this.y *= t, this.z *= t, this.w *= t), this;
            }, n.prototype.vmult = function (t, e) {
              e = e || new i();var o = t.x,
                  n = t.y,
                  r = t.z,
                  s = this.x,
                  a = this.y,
                  l = this.z,
                  h = this.w,
                  c = h * o + a * r - l * n,
                  p = h * n + l * o - s * r,
                  u = h * r + s * n - a * o,
                  d = -s * o - a * n - l * r;return e.x = c * h + d * -s + p * -l - u * -a, e.y = p * h + d * -a + u * -s - c * -l, e.z = u * h + d * -l + c * -a - p * -s, e;
            }, n.prototype.copy = function (t) {
              return this.x = t.x, this.y = t.y, this.z = t.z, this.w = t.w, this;
            }, n.prototype.toEuler = function (t, e) {
              var i, n, r;e = e || "YZX";var s = this.x,
                  a = this.y,
                  l = this.z,
                  h = this.w;switch (e) {case "YZX":
                  var c = s * a + l * h;if (c > .499 && (i = 2 * o.atan2(s, h), n = Math.PI / 2, r = 0), c < -.499 && (i = -2 * o.atan2(s, h), n = -Math.PI / 2, r = 0), isNaN(i)) {
                    var p = s * s,
                        u = a * a,
                        d = l * l;i = o.atan2(2 * a * h - 2 * s * l, 1 - 2 * u - 2 * d), n = Math.asin(2 * c), r = o.atan2(2 * s * h - 2 * a * l, 1 - 2 * p - 2 * d);
                  }break;default:
                  throw new Error("Euler order " + e + " not supported yet.");}t.y = i, t.z = n, t.x = r;
            }, n.prototype.setFromEuler = function (t, e, i, n) {
              n = n || "XYZ";var r = o.cos(t / 2),
                  s = o.cos(e / 2),
                  a = o.cos(i / 2),
                  l = o.sin(t / 2),
                  h = o.sin(e / 2),
                  c = o.sin(i / 2);return "XYZ" === n ? (this.x = l * s * a + r * h * c, this.y = r * h * a - l * s * c, this.z = r * s * c + l * h * a, this.w = r * s * a - l * h * c) : "YXZ" === n ? (this.x = l * s * a + r * h * c, this.y = r * h * a - l * s * c, this.z = r * s * c - l * h * a, this.w = r * s * a + l * h * c) : "ZXY" === n ? (this.x = l * s * a - r * h * c, this.y = r * h * a + l * s * c, this.z = r * s * c + l * h * a, this.w = r * s * a - l * h * c) : "ZYX" === n ? (this.x = l * s * a - r * h * c, this.y = r * h * a + l * s * c, this.z = r * s * c - l * h * a, this.w = r * s * a + l * h * c) : "YZX" === n ? (this.x = l * s * a + r * h * c, this.y = r * h * a + l * s * c, this.z = r * s * c - l * h * a, this.w = r * s * a - l * h * c) : "XZY" === n && (this.x = l * s * a - r * h * c, this.y = r * h * a - l * s * c, this.z = r * s * c + l * h * a, this.w = r * s * a + l * h * c), this;
            }, n.prototype.clone = function () {
              return new n(this.x, this.y, this.z, this.w);
            }, n.prototype.slerp = function (t, e, i) {
              i = i || new n();var r,
                  s,
                  a,
                  l,
                  h,
                  c = this.x,
                  p = this.y,
                  u = this.z,
                  d = this.w,
                  y = t.x,
                  f = t.y,
                  v = t.z,
                  m = t.w;return (s = c * y + p * f + u * v + d * m) < 0 && (s = -s, y = -y, f = -f, v = -v, m = -m), 1 - s > 1e-6 ? (r = Math.acos(s), a = o.sin(r), l = o.sin((1 - e) * r) / a, h = o.sin(e * r) / a) : (l = 1 - e, h = e), i.x = l * c + h * y, i.y = l * p + h * f, i.z = l * u + h * v, i.w = l * d + h * m, i;
            }, n.prototype.integrate = function (t, e, i, o) {
              o = o || new n();var r = t.x * i.x,
                  s = t.y * i.y,
                  a = t.z * i.z,
                  l = this.x,
                  h = this.y,
                  c = this.z,
                  p = this.w,
                  u = .5 * e;return o.x += u * (r * p + s * c - a * h), o.y += u * (s * p + a * l - r * c), o.z += u * (a * p + r * h - s * l), o.w += u * (-r * l - s * h - a * c), o;
            };
          }, { "./CMath": 27, "./Vec3": 32 }], 31: [function (t, e) {
            var i = t("./Vec3"),
                o = t("./Quaternion");function n(t) {
              t = t || {}, this.position = new i(), t.position && this.position.copy(t.position), this.quaternion = new o(), t.quaternion && this.quaternion.copy(t.quaternion);
            }e.exports = n;var r = new o();n.pointToLocalFrame = function (t, e, o, n) {
              return n = n || new i(), o.vsub(t, n), e.conjugate(r), r.vmult(n, n), n;
            }, n.prototype.pointToLocal = function (t, e) {
              return n.pointToLocalFrame(this.position, this.quaternion, t, e);
            }, n.pointToWorldFrame = function (t, e, o, n) {
              return n = n || new i(), e.vmult(o, n), n.vadd(t, n), n;
            }, n.prototype.pointToWorld = function (t, e) {
              return n.pointToWorldFrame(this.position, this.quaternion, t, e);
            }, n.prototype.vectorToWorldFrame = function (t, e) {
              return e = e || new i(), this.quaternion.vmult(t, e), e;
            }, n.vectorToWorldFrame = function (t, e, i) {
              return t.vmult(e, i), i;
            }, n.vectorToLocalFrame = function (t, e, o, n) {
              return n = n || new i(), e.w *= -1, e.vmult(o, n), e.w *= -1, n;
            };
          }, { "./Quaternion": 30, "./Vec3": 32 }], 32: [function (t, e) {
            e.exports = o;var i = t("./Mat3");function o(t, e, i) {
              this.x = t || 0, this.y = e || 0, this.z = i || 0;
            }o.ZERO = new o(0, 0, 0), o.UNIT_X = new o(1, 0, 0), o.UNIT_Y = new o(0, 1, 0), o.UNIT_Z = new o(0, 0, 1), o.prototype.cross = function (t, e) {
              var i = t.x,
                  n = t.y,
                  r = t.z,
                  s = this.x,
                  a = this.y,
                  l = this.z;return (e = e || new o()).x = a * r - l * n, e.y = l * i - s * r, e.z = s * n - a * i, e;
            }, o.prototype.set = function (t, e, i) {
              return this.x = t, this.y = e, this.z = i, this;
            }, o.prototype.setZero = function () {
              this.x = this.y = this.z = 0;
            }, o.prototype.vadd = function (t, e) {
              if (!e) return new o(this.x + t.x, this.y + t.y, this.z + t.z);e.x = t.x + this.x, e.y = t.y + this.y, e.z = t.z + this.z;
            }, o.prototype.vsub = function (t, e) {
              if (!e) return new o(this.x - t.x, this.y - t.y, this.z - t.z);e.x = this.x - t.x, e.y = this.y - t.y, e.z = this.z - t.z;
            }, o.prototype.crossmat = function () {
              return new i([0, -this.z, this.y, this.z, 0, -this.x, -this.y, this.x, 0]);
            }, o.prototype.normalize = function () {
              var t = this.x,
                  e = this.y,
                  i = this.z,
                  o = Math.sqrt(t * t + e * e + i * i);if (o > 0) {
                var n = 1 / o;this.x *= n, this.y *= n, this.z *= n;
              } else this.x = 0, this.y = 0, this.z = 0;return o;
            }, o.prototype.unit = function (t) {
              t = t || new o();var e = this.x,
                  i = this.y,
                  n = this.z,
                  r = Math.sqrt(e * e + i * i + n * n);return r > 0 ? (r = 1 / r, t.x = e * r, t.y = i * r, t.z = n * r) : (t.x = 1, t.y = 0, t.z = 0), t;
            }, o.prototype.norm = function () {
              var t = this.x,
                  e = this.y,
                  i = this.z;return Math.sqrt(t * t + e * e + i * i);
            }, o.prototype.length = o.prototype.norm, o.prototype.norm2 = function () {
              return this.dot(this);
            }, o.prototype.lengthSquared = o.prototype.norm2, o.prototype.distanceTo = function (t) {
              var e = this.x,
                  i = this.y,
                  o = this.z,
                  n = t.x,
                  r = t.y,
                  s = t.z;return Math.sqrt((n - e) * (n - e) + (r - i) * (r - i) + (s - o) * (s - o));
            }, o.prototype.distanceSquared = function (t) {
              var e = this.x,
                  i = this.y,
                  o = this.z,
                  n = t.x,
                  r = t.y,
                  s = t.z;return (n - e) * (n - e) + (r - i) * (r - i) + (s - o) * (s - o);
            }, o.prototype.mult = function (t, e) {
              e = e || new o();var i = this.x,
                  n = this.y,
                  r = this.z;return e.x = t * i, e.y = t * n, e.z = t * r, e;
            }, o.prototype.vmul = function (t, e) {
              return (e = e || new o()).x = t.x * this.x, e.y = t.y * this.y, e.z = t.z * this.z, e;
            }, o.prototype.scale = o.prototype.mult, o.prototype.addScaledVector = function (t, e, i) {
              return (i = i || new o()).x = this.x + t * e.x, i.y = this.y + t * e.y, i.z = this.z + t * e.z, i;
            }, o.prototype.dot = function (t) {
              return this.x * t.x + this.y * t.y + this.z * t.z;
            }, o.prototype.isZero = function () {
              return 0 === this.x && 0 === this.y && 0 === this.z;
            }, o.prototype.negate = function (t) {
              return (t = t || new o()).x = -this.x, t.y = -this.y, t.z = -this.z, t;
            };var n = new o(),
                r = new o();o.prototype.tangents = function (t, e) {
              var i = this.norm();if (i > 0) {
                var o = n,
                    s = 1 / i;o.set(this.x * s, this.y * s, this.z * s);var a = r;Math.abs(o.x) < .9 ? (a.set(1, 0, 0), o.cross(a, t)) : (a.set(0, 1, 0), o.cross(a, t)), o.cross(t, e);
              } else t.set(1, 0, 0), e.set(0, 1, 0);
            }, o.prototype.toString = function () {
              return this.x + "," + this.y + "," + this.z;
            }, o.prototype.toArray = function () {
              return [this.x, this.y, this.z];
            }, o.prototype.copy = function (t) {
              return this.x = t.x, this.y = t.y, this.z = t.z, this;
            }, o.prototype.lerp = function (t, e, i) {
              var o = this.x,
                  n = this.y,
                  r = this.z;i.x = o + (t.x - o) * e, i.y = n + (t.y - n) * e, i.z = r + (t.z - r) * e;
            }, o.prototype.almostEquals = function (t, e) {
              return void 0 === e && (e = 1e-6), !(Math.abs(this.x - t.x) > e || Math.abs(this.y - t.y) > e || Math.abs(this.z - t.z) > e);
            }, o.prototype.almostZero = function (t) {
              return void 0 === t && (t = 1e-6), !(Math.abs(this.x) > t || Math.abs(this.y) > t || Math.abs(this.z) > t);
            };var s = new o();o.prototype.isAntiparallelTo = function (t, e) {
              return this.negate(s), s.almostEquals(t, e);
            }, o.prototype.clone = function () {
              return new o(this.x, this.y, this.z);
            };
          }, { "./Mat3": 29 }], 33: [function (t, e) {
            e.exports = h;var i = t("../utils/EventTarget"),
                o = (t("../shapes/Shape"), t("../math/Vec3")),
                n = t("../math/Mat3"),
                r = t("../math/Quaternion"),
                s = (t("../material/Material"), t("../collision/AABB")),
                a = t("../shapes/Box"),
                l = t("../world/World");function h(t) {
              t = t || {}, i.apply(this), this.id = h.idCounter++, this.world = null, this.preStep = null, this.postStep = null, this.vlambda = new o(), this.collisionFilterGroup = "number" == typeof t.collisionFilterGroup ? t.collisionFilterGroup : 1, this.collisionFilterMask = "number" == typeof t.collisionFilterMask ? t.collisionFilterMask : -1, this.collisionResponse = !0, this.position = new o(), this.previousPosition = new o(), this.interpolatedPosition = new o(), this.initPosition = new o(), t.position && (this.position.copy(t.position), this.previousPosition.copy(t.position), this.interpolatedPosition.copy(t.position), this.initPosition.copy(t.position)), this.velocity = new o(), t.velocity && this.velocity.copy(t.velocity), this.initVelocity = new o(), this.force = new o();var e = "number" == typeof t.mass ? t.mass : 0;this.mass = e, this.invMass = e > 0 ? 1 / e : 0, this.material = t.material || null, this.linearDamping = "number" == typeof t.linearDamping ? t.linearDamping : .01, this.type = e <= 0 ? h.STATIC : h.DYNAMIC, _typeof(t.type) == _typeof(h.STATIC) && (this.type = t.type), this.allowSleep = void 0 === t.allowSleep || t.allowSleep, this.sleepState = 0, this.sleepSpeedLimit = void 0 !== t.sleepSpeedLimit ? t.sleepSpeedLimit : .1, this.sleepTimeLimit = void 0 !== t.sleepTimeLimit ? t.sleepTimeLimit : 1, this.timeLastSleepy = 0, this._wakeUpAfterNarrowphase = !1, this.torque = new o(), this.quaternion = new r(), this.initQuaternion = new r(), this.previousQuaternion = new r(), this.interpolatedQuaternion = new r(), t.quaternion && (this.quaternion.copy(t.quaternion), this.initQuaternion.copy(t.quaternion), this.previousQuaternion.copy(t.quaternion), this.interpolatedQuaternion.copy(t.quaternion)), this.angularVelocity = new o(), t.angularVelocity && this.angularVelocity.copy(t.angularVelocity), this.initAngularVelocity = new o(), this.shapes = [], this.shapeOffsets = [], this.shapeOrientations = [], this.inertia = new o(), this.invInertia = new o(), this.invInertiaWorld = new n(), this.invMassSolve = 0, this.invInertiaSolve = new o(), this.invInertiaWorldSolve = new n(), this.fixedRotation = void 0 !== t.fixedRotation && t.fixedRotation, this.useGravity = !0, this.angularDamping = void 0 !== t.angularDamping ? t.angularDamping : .01, this.linearFactor = new o(1, 1, 1), t.linearFactor && this.linearFactor.copy(t.linearFactor), this.angularFactor = new o(1, 1, 1), t.angularFactor && this.angularFactor.copy(t.angularFactor), this.aabb = new s(), this.aabbNeedsUpdate = !0, this.boundingRadius = 0, this.wlambda = new o(), t.shape && this.addShape(t.shape), this.hasTrigger = !0, this.updateMassProperties();
            }h.prototype = new i(), h.prototype.constructor = h, h.COLLIDE_EVENT_NAME = "collide", h.DYNAMIC = 1, h.STATIC = 2, h.KINEMATIC = 4, h.AWAKE = 0, h.SLEEPY = 1, h.SLEEPING = 2, h.idCounter = 0, h.wakeupEvent = { type: "wakeup" }, h.prototype.wakeUp = function () {
              l.SLEEPING = !1;var t = this.sleepState;this.sleepState = 0, this._wakeUpAfterNarrowphase = !1, t === h.SLEEPING && this.dispatchEvent(h.wakeupEvent);
            }, h.prototype.sleep = function () {
              this.sleepState = h.SLEEPING, this.velocity.set(0, 0, 0), this.angularVelocity.set(0, 0, 0), this._wakeUpAfterNarrowphase = !1;
            }, h.sleepyEvent = { type: "sleepy" }, h.sleepEvent = { type: "sleep" }, h.prototype.sleepTick = function (t) {
              if (this.allowSleep) {
                var e = this.sleepState,
                    i = this.velocity.norm2() + this.angularVelocity.norm2(),
                    o = Math.pow(this.sleepSpeedLimit, 2);e === h.AWAKE && i < o ? (this.sleepState = h.SLEEPY, this.timeLastSleepy = t, this.dispatchEvent(h.sleepyEvent)) : e === h.SLEEPY && i > o ? this.wakeUp() : e === h.SLEEPY && t - this.timeLastSleepy > this.sleepTimeLimit && (this.sleep(), this.dispatchEvent(h.sleepEvent));
              }
            }, h.prototype.updateSolveMassProperties = function () {
              this.sleepState === h.SLEEPING || this.type === h.KINEMATIC ? (this.invMassSolve = 0, this.invInertiaSolve.setZero(), this.invInertiaWorldSolve.setZero()) : (this.invMassSolve = this.invMass, this.invInertiaSolve.copy(this.invInertia), this.invInertiaWorldSolve.copy(this.invInertiaWorld));
            }, h.prototype.pointToLocalFrame = function (t, e) {
              return e = e || new o(), t.vsub(this.position, e), this.quaternion.conjugate().vmult(e, e), e;
            }, h.prototype.vectorToLocalFrame = function (t, e) {
              return e = e || new o(), this.quaternion.conjugate().vmult(t, e), e;
            }, h.prototype.pointToWorldFrame = function (t, e) {
              return e = e || new o(), this.quaternion.vmult(t, e), e.vadd(this.position, e), e;
            }, h.prototype.vectorToWorldFrame = function (t, e) {
              return e = e || new o(), this.quaternion.vmult(t, e), e;
            };var c = new o(),
                p = new r();h.prototype.addShape = function (t, e, i) {
              var n = new o(),
                  s = new r();return e && n.copy(e), i && s.copy(i), this.shapes.push(t), this.shapeOffsets.push(n), this.shapeOrientations.push(s), this.aabbNeedsUpdate = !0, this.updateMassProperties(), this.updateBoundingRadius(), this.updateHasTrigger(), l.idToShapeMap[t.id] = t, t.body = this, this;
            }, h.prototype.removeShape = function (t) {
              var e = this.shapes.indexOf(t);-1 !== e && (this.shapes.splice(e, 1), this.shapeOffsets.splice(e, 1), this.shapeOrientations.splice(e, 1), this.aabbNeedsUpdate = !0, this.updateMassProperties(), this.updateBoundingRadius(), this.updateHasTrigger());
            }, h.prototype.updateBoundingRadius = function () {
              for (var t = this.shapes, e = this.shapeOffsets, i = t.length, o = 0, n = 0; n !== i; n++) {
                var r = t[n];r.updateBoundingSphereRadius();var s = e[n].norm(),
                    a = r.boundingSphereRadius;s + a > o && (o = s + a);
              }this.boundingRadius = o;
            };var u = new s();h.prototype.computeAABB = function () {
              for (var t = this.shapes, e = this.shapeOffsets, i = this.shapeOrientations, o = t.length, n = c, r = p, s = this.quaternion, a = this.aabb, l = u, h = 0; h !== o; h++) {
                var d = t[h];s.vmult(e[h], n), n.vadd(this.position, n), i[h].mult(s, r), d.calculateWorldAABB(n, r, l.lowerBound, l.upperBound), 0 === h ? a.copy(l) : a.extend(l);
              }this.aabbNeedsUpdate = !1;
            };var d = new n(),
                y = new n();new n(), h.prototype.updateInertiaWorld = function (t) {
              var e = this.invInertia;if (e.x !== e.y || e.y !== e.z || t) {
                var i = d,
                    o = y;i.setRotationFromQuaternion(this.quaternion), i.transpose(o), i.scale(e, i), i.mmult(o, this.invInertiaWorld);
              }
            }, new o();var f = new o();h.prototype.applyForce = function (t, e) {
              if (this.type === h.DYNAMIC) {
                var i = f;e.cross(t, i), this.force.vadd(t, this.force), this.torque.vadd(i, this.torque);
              }
            };var v = new o(),
                m = new o();h.prototype.applyLocalForce = function (t, e) {
              if (this.type === h.DYNAMIC) {
                var i = v,
                    o = m;this.vectorToWorldFrame(t, i), this.vectorToWorldFrame(e, o), this.applyForce(i, o);
              }
            }, new o();var g = new o(),
                w = new o();h.prototype.applyImpulse = function (t, e) {
              if (this.type === h.DYNAMIC) {
                var i = e,
                    o = g;o.copy(t), o.mult(this.invMass, o), this.velocity.vadd(o, this.velocity);var n = w;i.cross(t, n), this.invInertiaWorld.vmult(n, n), this.angularVelocity.vadd(n, this.angularVelocity);
              }
            };var b = new o(),
                x = new o();h.prototype.applyLocalImpulse = function (t, e) {
              if (this.type === h.DYNAMIC) {
                var i = b,
                    o = x;this.vectorToWorldFrame(t, i), this.vectorToWorldFrame(e, o), this.applyImpulse(i, o);
              }
            };var _ = new o();h.prototype.updateMassProperties = function () {
              var t = _;this.invMass = this.mass > 0 ? 1 / this.mass : 0;var e = this.inertia,
                  i = this.fixedRotation;this.computeAABB(), t.set((this.aabb.upperBound.x - this.aabb.lowerBound.x) / 2, (this.aabb.upperBound.y - this.aabb.lowerBound.y) / 2, (this.aabb.upperBound.z - this.aabb.lowerBound.z) / 2), a.calculateInertia(t, this.mass, e), this.invInertia.set(e.x > 0 && !i ? 1 / e.x : 0, e.y > 0 && !i ? 1 / e.y : 0, e.z > 0 && !i ? 1 / e.z : 0), this.updateInertiaWorld(!0);
            }, h.prototype.getVelocityAtWorldPoint = function (t, e) {
              var i = new o();return t.vsub(this.position, i), this.angularVelocity.cross(i, e), this.velocity.vadd(e, e), e;
            }, new o(), new o(), new r(), new r(), h.prototype.integrate = function (t, e, i) {
              if (this.previousPosition.copy(this.position), this.previousQuaternion.copy(this.quaternion), (this.type === h.DYNAMIC || this.type === h.KINEMATIC) && this.sleepState !== h.SLEEPING) {
                var o = this.velocity,
                    n = this.angularVelocity,
                    r = this.position,
                    s = this.force,
                    a = this.torque,
                    l = this.quaternion,
                    c = this.invMass,
                    p = this.invInertiaWorld,
                    u = this.linearFactor,
                    d = c * t;o.x += s.x * d * u.x, o.y += s.y * d * u.y, o.z += s.z * d * u.z;var y = p.elements,
                    f = this.angularFactor,
                    v = a.x * f.x,
                    m = a.y * f.y,
                    g = a.z * f.z;n.x += t * (y[0] * v + y[1] * m + y[2] * g), n.y += t * (y[3] * v + y[4] * m + y[5] * g), n.z += t * (y[6] * v + y[7] * m + y[8] * g), r.x += o.x * t, r.y += o.y * t, r.z += o.z * t, l.integrate(this.angularVelocity, t, this.angularFactor, l), e && (i ? l.normalizeFast() : l.normalize()), this.aabbNeedsUpdate = !0, this.updateInertiaWorld();
              }
            }, h.prototype.isSleeping = function () {
              return this.sleepState === h.SLEEPING;
            }, h.prototype.isSleepy = function () {
              return this.sleepState === h.SLEEPY;
            }, h.prototype.isAwake = function () {
              return this.sleepState === h.AWAKE;
            }, h.prototype.updateHasTrigger = function () {
              for (var t = this.shapes.length; t-- && (this.hasTrigger = !this.shapes[t].collisionResponse, !this.hasTrigger);) {}
            };
          }, { "../collision/AABB": 3, "../material/Material": 26, "../math/Mat3": 29, "../math/Quaternion": 30, "../math/Vec3": 32, "../shapes/Box": 39, "../shapes/Shape": 45, "../utils/EventTarget": 51, "../world/World": 58 }], 34: [function (t, e) {
            t("./Body");var i = t("../math/Vec3"),
                o = t("../math/Quaternion"),
                n = (t("../collision/RaycastResult"), t("../collision/Ray")),
                r = t("../objects/WheelInfo");function s(t) {
              this.chassisBody = t.chassisBody, this.wheelInfos = [], this.sliding = !1, this.world = null, this.indexRightAxis = void 0 !== t.indexRightAxis ? t.indexRightAxis : 1, this.indexForwardAxis = void 0 !== t.indexForwardAxis ? t.indexForwardAxis : 0, this.indexUpAxis = void 0 !== t.indexUpAxis ? t.indexUpAxis : 2;
            }e.exports = s, new i(), new i(), new i();var a = new i(),
                l = new i(),
                h = new i();new n(), s.prototype.addWheel = function (t) {
              var e = new r(t = t || {}),
                  i = this.wheelInfos.length;return this.wheelInfos.push(e), i;
            }, s.prototype.setSteeringValue = function (t, e) {
              this.wheelInfos[e].steering = t;
            }, new i(), s.prototype.applyEngineForce = function (t, e) {
              this.wheelInfos[e].engineForce = t;
            }, s.prototype.setBrake = function (t, e) {
              this.wheelInfos[e].brake = t;
            }, s.prototype.addToWorld = function (t) {
              this.constraints, t.addBody(this.chassisBody);var e = this;this.preStepCallback = function () {
                e.updateVehicle(t.dt);
              }, t.addEventListener("preStep", this.preStepCallback), this.world = t;
            }, s.prototype.getVehicleAxisWorld = function (t, e) {
              e.set(0 === t ? 1 : 0, 1 === t ? 1 : 0, 2 === t ? 1 : 0), this.chassisBody.vectorToWorldFrame(e, e);
            }, s.prototype.updateVehicle = function (t) {
              for (var e = this.wheelInfos, o = e.length, n = this.chassisBody, r = 0; r < o; r++) {
                this.updateWheelTransform(r);
              }this.currentVehicleSpeedKmHour = 3.6 * n.velocity.norm();var s = new i();for (this.getVehicleAxisWorld(this.indexForwardAxis, s), s.dot(n.velocity) < 0 && (this.currentVehicleSpeedKmHour *= -1), r = 0; r < o; r++) {
                this.castRay(e[r]);
              }this.updateSuspension(t);var a = new i(),
                  l = new i();for (r = 0; r < o; r++) {
                var h = (d = e[r]).suspensionForce;h > d.maxSuspensionForce && (h = d.maxSuspensionForce), d.raycastResult.hitNormalWorld.scale(h * t, a), d.raycastResult.hitPointWorld.vsub(n.position, l), n.applyImpulse(a, l);
              }this.updateFriction(t);var c = new i(),
                  p = new i(),
                  u = new i();for (r = 0; r < o; r++) {
                var d = e[r];n.getVelocityAtWorldPoint(d.chassisConnectionPointWorld, u);var y = 1;switch (this.indexUpAxis) {case 1:
                    y = -1;}if (d.isInContact) {
                  this.getVehicleAxisWorld(this.indexForwardAxis, p);var f = p.dot(d.raycastResult.hitNormalWorld);d.raycastResult.hitNormalWorld.scale(f, c), p.vsub(c, p);var v = p.dot(u);d.deltaRotation = y * v * t / d.radius;
                }!d.sliding && d.isInContact || 0 === d.engineForce || !d.useCustomSlidingRotationalSpeed || (d.deltaRotation = (d.engineForce > 0 ? 1 : -1) * d.customSlidingRotationalSpeed * t), Math.abs(d.brake) > Math.abs(d.engineForce) && (d.deltaRotation = 0), d.rotation += d.deltaRotation, d.deltaRotation *= .99;
              }
            }, s.prototype.updateSuspension = function () {
              for (var t = this.chassisBody.mass, e = this.wheelInfos, i = e.length, o = 0; o < i; o++) {
                var n = e[o];if (n.isInContact) {
                  var r,
                      s = n.suspensionRestLength - n.suspensionLength;r = n.suspensionStiffness * s * n.clippedInvContactDotSuspension;var a = n.suspensionRelativeVelocity;r -= (a < 0 ? n.dampingCompression : n.dampingRelaxation) * a, n.suspensionForce = r * t, n.suspensionForce < 0 && (n.suspensionForce = 0);
                } else n.suspensionForce = 0;
              }
            }, s.prototype.removeFromWorld = function (t) {
              this.constraints, t.remove(this.chassisBody), t.removeEventListener("preStep", this.preStepCallback), this.world = null;
            };var c = new i(),
                p = new i();s.prototype.castRay = function (t) {
              var e = c,
                  o = p;this.updateWheelTransformWorld(t);var n = this.chassisBody,
                  r = -1,
                  s = t.suspensionRestLength + t.radius;t.directionWorld.scale(s, e);var a = t.chassisConnectionPointWorld;a.vadd(e, o);var l = t.raycastResult;l.reset();var h = n.collisionResponse;n.collisionResponse = !1, this.world.rayTest(a, o, l), n.collisionResponse = h;var u = l.body;if (t.raycastResult.groundObject = 0, u) {
                r = l.distance, t.raycastResult.hitNormalWorld = l.hitNormalWorld, t.isInContact = !0;var d = l.distance;t.suspensionLength = d - t.radius;var y = t.suspensionRestLength - t.maxSuspensionTravel,
                    f = t.suspensionRestLength + t.maxSuspensionTravel;t.suspensionLength < y && (t.suspensionLength = y), t.suspensionLength > f && (t.suspensionLength = f, t.raycastResult.reset());var v = t.raycastResult.hitNormalWorld.dot(t.directionWorld),
                    m = new i();n.getVelocityAtWorldPoint(t.raycastResult.hitPointWorld, m);var g = t.raycastResult.hitNormalWorld.dot(m);if (v >= -.1) t.suspensionRelativeVelocity = 0, t.clippedInvContactDotSuspension = 10;else {
                  var w = -1 / v;t.suspensionRelativeVelocity = g * w, t.clippedInvContactDotSuspension = w;
                }
              } else t.suspensionLength = t.suspensionRestLength + 0 * t.maxSuspensionTravel, t.suspensionRelativeVelocity = 0, t.directionWorld.scale(-1, t.raycastResult.hitNormalWorld), t.clippedInvContactDotSuspension = 1;return r;
            }, s.prototype.updateWheelTransformWorld = function (t) {
              t.isInContact = !1;var e = this.chassisBody;e.pointToWorldFrame(t.chassisConnectionPointLocal, t.chassisConnectionPointWorld), e.vectorToWorldFrame(t.directionLocal, t.directionWorld), e.vectorToWorldFrame(t.axleLocal, t.axleWorld);
            }, s.prototype.updateWheelTransform = function (t) {
              var e = a,
                  i = l,
                  n = h,
                  r = this.wheelInfos[t];this.updateWheelTransformWorld(r), r.directionLocal.scale(-1, e), i.copy(r.axleLocal), e.cross(i, n), n.normalize(), i.normalize();var s = r.steering,
                  c = new o();c.setFromAxisAngle(e, s);var p = new o();p.setFromAxisAngle(i, r.rotation);var u = r.worldTransform.quaternion;this.chassisBody.quaternion.mult(c, u), u.mult(p, u), u.normalize();var d = r.worldTransform.position;d.copy(r.directionWorld), d.scale(r.suspensionLength, d), d.vadd(r.chassisConnectionPointWorld, d);
            };var u = [new i(1, 0, 0), new i(0, 1, 0), new i(0, 0, 1)];s.prototype.getWheelTransformWorld = function (t) {
              return this.wheelInfos[t].worldTransform;
            };var d = new i(),
                y = [],
                f = [];s.prototype.updateFriction = function (t) {
              for (var e = d, o = this.wheelInfos, n = o.length, r = this.chassisBody, s = f, a = y, l = 0; l < n; l++) {
                v = (M = o[l]).raycastResult.body, M.sideImpulse = 0, M.forwardImpulse = 0, s[l] || (s[l] = new i()), a[l] || (a[l] = new i());
              }for (l = 0; l < n; l++) {
                if (v = (M = o[l]).raycastResult.body) {
                  var h = a[l];this.getWheelTransformWorld(l).vectorToWorldFrame(u[this.indexRightAxis], h);var c = M.raycastResult.hitNormalWorld,
                      p = h.dot(c);c.scale(p, e), h.vsub(e, h), h.normalize(), c.cross(h, s[l]), s[l].normalize(), M.sideImpulse = A(r, M.raycastResult.hitPointWorld, v, M.raycastResult.hitPointWorld, h), M.sideImpulse *= 1;
                }
              }for (this.sliding = !1, l = 0; l < n; l++) {
                var v = (M = o[l]).raycastResult.body,
                    m = 0;if (M.slipInfo = 1, v) {
                  var g = M.brake ? M.brake : 0;m = w(r, v, M.raycastResult.hitPointWorld, s[l], g);var b = g / (m += M.engineForce * t);M.slipInfo *= b;
                }if (M.forwardImpulse = 0, M.skidInfo = 1, v) {
                  M.skidInfo = 1;var x = M.suspensionForce * t * M.frictionSlip,
                      _ = x * x;M.forwardImpulse = m;var B = .5 * M.forwardImpulse,
                      S = 1 * M.sideImpulse,
                      E = B * B + S * S;M.sliding = !1, E > _ && (this.sliding = !0, M.sliding = !0, b = x / Math.sqrt(E), M.skidInfo *= b);
                }
              }if (this.sliding) for (l = 0; l < n; l++) {
                0 !== (M = o[l]).sideImpulse && M.skidInfo < 1 && (M.forwardImpulse *= M.skidInfo, M.sideImpulse *= M.skidInfo);
              }for (l = 0; l < n; l++) {
                var M = o[l],
                    C = new i();if (M.raycastResult.hitPointWorld.vsub(r.position, C), 0 !== M.forwardImpulse) {
                  var z = new i();s[l].scale(M.forwardImpulse, z), r.applyImpulse(z, C);
                }if (0 !== M.sideImpulse) {
                  v = M.raycastResult.body;var F = new i();M.raycastResult.hitPointWorld.vsub(v.position, F);var T = new i();a[l].scale(M.sideImpulse, T), r.vectorToLocalFrame(C, C), C["xyz"[this.indexUpAxis]] *= M.rollInfluence, r.vectorToWorldFrame(C, C), r.applyImpulse(T, C), T.scale(-1, T), v.applyImpulse(T, F);
                }
              }
            };var v = new i(),
                m = new i(),
                g = new i();function w(t, e, i, o, n) {
              var r = 0,
                  s = i,
                  a = v,
                  l = m,
                  h = g;return t.getVelocityAtWorldPoint(s, a), e.getVelocityAtWorldPoint(s, l), a.vsub(l, h), n < (r = -o.dot(h) * (1 / (S(t, i, o) + S(e, i, o)))) && (r = n), r < -n && (r = -n), r;
            }var b = new i(),
                x = new i(),
                _ = new i(),
                B = new i();function S(t, e, i) {
              var o = b,
                  n = x,
                  r = _,
                  s = B;return e.vsub(t.position, o), o.cross(i, n), t.invInertiaWorld.vmult(n, s), s.cross(o, r), t.invMass + i.dot(r);
            }var E = new i(),
                M = new i(),
                C = new i();function A(t, e, i, o, n) {
              if (n.norm2() > 1.1) return 0;var r = E,
                  s = M,
                  a = C;return t.getVelocityAtWorldPoint(e, r), i.getVelocityAtWorldPoint(o, s), r.vsub(s, a), -.2 * n.dot(a) * (1 / (t.invMass + i.invMass));
            }
          }, { "../collision/Ray": 10, "../collision/RaycastResult": 11, "../math/Quaternion": 30, "../math/Vec3": 32, "../objects/WheelInfo": 38, "./Body": 33 }], 35: [function (t, e) {
            var i = t("./Body"),
                o = t("../shapes/Sphere"),
                n = t("../shapes/Box"),
                r = t("../math/Vec3"),
                s = t("../constraints/HingeConstraint"),
                a = t("../math/CMath");function l(t) {
              if (this.wheelBodies = [], this.coordinateSystem = void 0 === t.coordinateSystem ? new r(1, 2, 3) : t.coordinateSystem.clone(), this.chassisBody = t.chassisBody, !this.chassisBody) {
                var e = new n(new r(5, 2, .5));this.chassisBody = new i(1, e);
              }this.constraints = [], this.wheelAxes = [], this.wheelForces = [];
            }e.exports = l, l.prototype.addWheel = function (t) {
              var e = (t = t || {}).body;e || (e = new i(1, new o(1.2))), this.wheelBodies.push(e), this.wheelForces.push(0), new r();var n = void 0 !== t.position ? t.position.clone() : new r(),
                  a = new r();this.chassisBody.pointToWorldFrame(n, a), e.position.set(a.x, a.y, a.z);var l = void 0 !== t.axis ? t.axis.clone() : new r(0, 1, 0);this.wheelAxes.push(l);var h = new s(this.chassisBody, e, { pivotA: n, axisA: l, pivotB: r.ZERO, axisB: l, collideConnected: !1 });return this.constraints.push(h), this.wheelBodies.length - 1;
            }, l.prototype.setSteeringValue = function (t, e) {
              var i = this.wheelAxes[e],
                  o = a.cos(t),
                  n = a.sin(t),
                  r = i.x,
                  s = i.y;this.constraints[e].axisA.set(o * r - n * s, n * r + o * s, 0);
            }, l.prototype.setMotorSpeed = function (t, e) {
              var i = this.constraints[e];i.enableMotor(), i.motorTargetVelocity = t;
            }, l.prototype.disableMotor = function (t) {
              this.constraints[t].disableMotor();
            };var h = new r();l.prototype.setWheelForce = function (t, e) {
              this.wheelForces[e] = t;
            }, l.prototype.applyWheelForce = function (t, e) {
              var i = this.wheelAxes[e],
                  o = this.wheelBodies[e],
                  n = o.torque;i.scale(t, h), o.vectorToWorldFrame(h, h), n.vadd(h, n);
            }, l.prototype.addToWorld = function (t) {
              for (var e = this.constraints, i = this.wheelBodies.concat([this.chassisBody]), o = 0; o < i.length; o++) {
                t.addBody(i[o]);
              }for (o = 0; o < e.length; o++) {
                t.addConstraint(e[o]);
              }t.addEventListener("preStep", this._update.bind(this));
            }, l.prototype._update = function () {
              for (var t = this.wheelForces, e = 0; e < t.length; e++) {
                this.applyWheelForce(t[e], e);
              }
            }, l.prototype.removeFromWorld = function (t) {
              for (var e = this.constraints, i = this.wheelBodies.concat([this.chassisBody]), o = 0; o < i.length; o++) {
                t.remove(i[o]);
              }for (o = 0; o < e.length; o++) {
                t.removeConstraint(e[o]);
              }
            };var c = new r();l.prototype.getWheelSpeed = function (t) {
              var e = this.wheelAxes[t],
                  i = this.wheelBodies[t].angularVelocity;return this.chassisBody.vectorToWorldFrame(e, c), i.dot(c);
            };
          }, { "../constraints/HingeConstraint": 16, "../math/CMath": 27, "../math/Vec3": 32, "../shapes/Box": 39, "../shapes/Sphere": 46, "./Body": 33 }], 36: [function (t, e) {
            e.exports = o, t("../shapes/Shape");var i = t("../math/Vec3");function o() {
              this.particles = [], this.density = 1, this.smoothingRadius = 1, this.speedOfSound = 1, this.viscosity = .01, this.eps = 1e-6, this.pressures = [], this.densities = [], this.neighbors = [];
            }t("../math/Quaternion"), t("../shapes/Particle"), t("../objects/Body"), t("../material/Material"), o.prototype.add = function (t) {
              this.particles.push(t), this.neighbors.length < this.particles.length && this.neighbors.push([]);
            }, o.prototype.remove = function (t) {
              var e = this.particles.indexOf(t);-1 !== e && (this.particles.splice(e, 1), this.neighbors.length > this.particles.length && this.neighbors.pop());
            };var n = new i();o.prototype.getNeighbors = function (t, e) {
              for (var i = this.particles.length, o = t.id, r = this.smoothingRadius * this.smoothingRadius, s = n, a = 0; a !== i; a++) {
                var l = this.particles[a];l.position.vsub(t.position, s), o !== l.id && s.norm2() < r && e.push(l);
              }
            };var r = new i(),
                s = new i(),
                a = new i(),
                l = new i(),
                h = new i(),
                c = new i();o.prototype.update = function () {
              for (var t = this.particles.length, e = r, i = this.speedOfSound, o = this.eps, n = 0; n !== t; n++) {
                var p = this.particles[n];(S = this.neighbors[n]).length = 0, this.getNeighbors(p, S), S.push(this.particles[n]);for (var u = S.length, d = 0, y = 0; y !== u; y++) {
                  p.position.vsub(S[y].position, e);var f = e.norm(),
                      v = this.w(f);d += S[y].mass * v;
                }this.densities[n] = d, this.pressures[n] = i * i * (this.densities[n] - this.density);
              }var m = s,
                  g = a,
                  w = l,
                  b = h,
                  x = c;for (n = 0; n !== t; n++) {
                var _,
                    B,
                    S,
                    E = this.particles[n];for (m.set(0, 0, 0), g.set(0, 0, 0), u = (S = this.neighbors[n]).length, y = 0; y !== u; y++) {
                  var M = S[y];E.position.vsub(M.position, b);var C = b.norm();_ = -M.mass * (this.pressures[n] / (this.densities[n] * this.densities[n] + o) + this.pressures[y] / (this.densities[y] * this.densities[y] + o)), this.gradw(b, w), w.mult(_, w), m.vadd(w, m), M.velocity.vsub(E.velocity, x), x.mult(1 / (1e-4 + this.densities[n] * this.densities[y]) * this.viscosity * M.mass, x), B = this.nablaw(C), x.mult(B, x), g.vadd(x, g);
                }g.mult(E.mass, g), m.mult(E.mass, m), E.force.vadd(g, E.force), E.force.vadd(m, E.force);
              }
            }, o.prototype.w = function (t) {
              var e = this.smoothingRadius;return 315 / (64 * Math.PI * Math.pow(e, 9)) * Math.pow(e * e - t * t, 3);
            }, o.prototype.gradw = function (t, e) {
              var i = t.norm(),
                  o = this.smoothingRadius;t.mult(945 / (32 * Math.PI * Math.pow(o, 9)) * Math.pow(o * o - i * i, 2), e);
            }, o.prototype.nablaw = function (t) {
              var e = this.smoothingRadius;return 945 / (32 * Math.PI * Math.pow(e, 9)) * (e * e - t * t) * (7 * t * t - 3 * e * e);
            };
          }, { "../material/Material": 26, "../math/Quaternion": 30, "../math/Vec3": 32, "../objects/Body": 33, "../shapes/Particle": 43, "../shapes/Shape": 45 }], 37: [function (t, e) {
            var i = t("../math/Vec3");function o(t, e, o) {
              o = o || {}, this.restLength = "number" == typeof o.restLength ? o.restLength : 1, this.stiffness = o.stiffness || 100, this.damping = o.damping || 1, this.bodyA = t, this.bodyB = e, this.localAnchorA = new i(), this.localAnchorB = new i(), o.localAnchorA && this.localAnchorA.copy(o.localAnchorA), o.localAnchorB && this.localAnchorB.copy(o.localAnchorB), o.worldAnchorA && this.setWorldAnchorA(o.worldAnchorA), o.worldAnchorB && this.setWorldAnchorB(o.worldAnchorB);
            }e.exports = o, o.prototype.setWorldAnchorA = function (t) {
              this.bodyA.pointToLocalFrame(t, this.localAnchorA);
            }, o.prototype.setWorldAnchorB = function (t) {
              this.bodyB.pointToLocalFrame(t, this.localAnchorB);
            }, o.prototype.getWorldAnchorA = function (t) {
              this.bodyA.pointToWorldFrame(this.localAnchorA, t);
            }, o.prototype.getWorldAnchorB = function (t) {
              this.bodyB.pointToWorldFrame(this.localAnchorB, t);
            };var n = new i(),
                r = new i(),
                s = new i(),
                a = new i(),
                l = new i(),
                h = new i(),
                c = new i(),
                p = new i(),
                u = new i(),
                d = new i(),
                y = new i();o.prototype.applyForce = function () {
              var t = this.stiffness,
                  e = this.damping,
                  i = this.restLength,
                  o = this.bodyA,
                  f = this.bodyB,
                  v = n,
                  m = r,
                  g = s,
                  w = a,
                  b = y,
                  x = l,
                  _ = h,
                  B = c,
                  S = p,
                  E = u,
                  M = d;this.getWorldAnchorA(x), this.getWorldAnchorB(_), x.vsub(o.position, B), _.vsub(f.position, S), _.vsub(x, v);var C = v.norm();m.copy(v), m.normalize(), f.velocity.vsub(o.velocity, g), f.angularVelocity.cross(S, b), g.vadd(b, g), o.angularVelocity.cross(B, b), g.vsub(b, g), m.mult(-t * (C - i) - e * g.dot(m), w), o.force.vsub(w, o.force), f.force.vadd(w, f.force), B.cross(w, E), S.cross(w, M), o.torque.vsub(E, o.torque), f.torque.vadd(M, f.torque);
            };
          }, { "../math/Vec3": 32 }], 38: [function (t, e) {
            var i = t("../math/Vec3"),
                o = t("../math/Transform"),
                n = t("../collision/RaycastResult"),
                r = t("../utils/Utils");function s(t) {
              t = r.defaults(t, { chassisConnectionPointLocal: new i(), chassisConnectionPointWorld: new i(), directionLocal: new i(), directionWorld: new i(), axleLocal: new i(), axleWorld: new i(), suspensionRestLength: 1, suspensionMaxLength: 2, radius: 1, suspensionStiffness: 100, dampingCompression: 10, dampingRelaxation: 10, frictionSlip: 1e4, steering: 0, rotation: 0, deltaRotation: 0, rollInfluence: .01, maxSuspensionForce: Number.MAX_VALUE, isFrontWheel: !0, clippedInvContactDotSuspension: 1, suspensionRelativeVelocity: 0, suspensionForce: 0, skidInfo: 0, suspensionLength: 0, maxSuspensionTravel: 1, useCustomSlidingRotationalSpeed: !1, customSlidingRotationalSpeed: -.1 }), this.maxSuspensionTravel = t.maxSuspensionTravel, this.customSlidingRotationalSpeed = t.customSlidingRotationalSpeed, this.useCustomSlidingRotationalSpeed = t.useCustomSlidingRotationalSpeed, this.sliding = !1, this.chassisConnectionPointLocal = t.chassisConnectionPointLocal.clone(), this.chassisConnectionPointWorld = t.chassisConnectionPointWorld.clone(), this.directionLocal = t.directionLocal.clone(), this.directionWorld = t.directionWorld.clone(), this.axleLocal = t.axleLocal.clone(), this.axleWorld = t.axleWorld.clone(), this.suspensionRestLength = t.suspensionRestLength, this.suspensionMaxLength = t.suspensionMaxLength, this.radius = t.radius, this.suspensionStiffness = t.suspensionStiffness, this.dampingCompression = t.dampingCompression, this.dampingRelaxation = t.dampingRelaxation, this.frictionSlip = t.frictionSlip, this.steering = 0, this.rotation = 0, this.deltaRotation = 0, this.rollInfluence = t.rollInfluence, this.maxSuspensionForce = t.maxSuspensionForce, this.engineForce = 0, this.brake = 0, this.isFrontWheel = t.isFrontWheel, this.clippedInvContactDotSuspension = 1, this.suspensionRelativeVelocity = 0, this.suspensionForce = 0, this.skidInfo = 0, this.suspensionLength = 0, this.sideImpulse = 0, this.forwardImpulse = 0, this.raycastResult = new n(), this.worldTransform = new o(), this.isInContact = !1;
            }e.exports = s;var a = new i(),
                l = new i();a = new i(), s.prototype.updateWheel = function (t) {
              var e = this.raycastResult;if (this.isInContact) {
                var i = e.hitNormalWorld.dot(e.directionWorld);e.hitPointWorld.vsub(t.position, l), t.getVelocityAtWorldPoint(l, a);var o = e.hitNormalWorld.dot(a);if (i >= -.1) this.suspensionRelativeVelocity = 0, this.clippedInvContactDotSuspension = 10;else {
                  var n = -1 / i;this.suspensionRelativeVelocity = o * n, this.clippedInvContactDotSuspension = n;
                }
              } else e.suspensionLength = this.suspensionRestLength, this.suspensionRelativeVelocity = 0, e.directionWorld.scale(-1, e.hitNormalWorld), this.clippedInvContactDotSuspension = 1;
            };
          }, { "../collision/RaycastResult": 11, "../math/Transform": 31, "../math/Vec3": 32, "../utils/Utils": 55 }], 39: [function (t, e) {
            e.exports = r;var i = t("./Shape"),
                o = t("../math/Vec3"),
                n = t("./ConvexPolyhedron");function r(t) {
              i.call(this, { type: i.types.BOX }), this.halfExtents = t, this.convexPolyhedronRepresentation = null, this.updateConvexPolyhedronRepresentation(), this.updateBoundingSphereRadius();
            }r.prototype = new i(), r.prototype.constructor = r, r.prototype.updateConvexPolyhedronRepresentation = function () {
              var t = this.halfExtents.x,
                  e = this.halfExtents.y,
                  i = this.halfExtents.z,
                  r = o,
                  s = [new r(-t, -e, -i), new r(t, -e, -i), new r(t, e, -i), new r(-t, e, -i), new r(-t, -e, i), new r(t, -e, i), new r(t, e, i), new r(-t, e, i)],
                  a = (new r(0, 0, 1), new r(0, 1, 0), new r(1, 0, 0), new n(s, [[3, 2, 1, 0], [4, 5, 6, 7], [5, 4, 0, 1], [2, 3, 7, 6], [0, 4, 7, 3], [1, 2, 6, 5]]));this.convexPolyhedronRepresentation = a, a.material = this.material;
            }, r.prototype.calculateLocalInertia = function (t, e) {
              return e = e || new o(), r.calculateInertia(this.halfExtents, t, e), e;
            }, r.calculateInertia = function (t, e, i) {
              var o = t;o.isZero() ? (i.x = 2 / 12 * e, i.y = 2 / 12 * e, i.z = 2 / 12 * e) : (i.x = 1 / 12 * e * (4 * o.y * o.y + 4 * o.z * o.z), i.y = 1 / 12 * e * (4 * o.x * o.x + 4 * o.z * o.z), i.z = 1 / 12 * e * (4 * o.y * o.y + 4 * o.x * o.x));
            }, r.prototype.getSideNormals = function (t, e) {
              var i = t,
                  o = this.halfExtents;if (i[0].set(o.x, 0, 0), i[1].set(0, o.y, 0), i[2].set(0, 0, o.z), i[3].set(-o.x, 0, 0), i[4].set(0, -o.y, 0), i[5].set(0, 0, -o.z), void 0 !== e) for (var n = 0; n !== i.length; n++) {
                e.vmult(i[n], i[n]);
              }return i;
            }, r.prototype.volume = function () {
              return 8 * this.halfExtents.x * this.halfExtents.y * this.halfExtents.z;
            }, r.prototype.updateBoundingSphereRadius = function () {
              this.boundingSphereRadius = this.halfExtents.norm();
            };var s = new o();new o(), r.prototype.forEachWorldCorner = function (t, e, i) {
              for (var o = this.halfExtents, n = [[o.x, o.y, o.z], [-o.x, o.y, o.z], [-o.x, -o.y, o.z], [-o.x, -o.y, -o.z], [o.x, -o.y, -o.z], [o.x, o.y, -o.z], [-o.x, o.y, -o.z], [o.x, -o.y, o.z]], r = 0; r < n.length; r++) {
                s.set(n[r][0], n[r][1], n[r][2]), e.vmult(s, s), t.vadd(s, s), i(s.x, s.y, s.z);
              }
            };var a = [new o(), new o(), new o(), new o(), new o(), new o(), new o(), new o()];r.prototype.calculateWorldAABB = function (t, e, i, o) {
              var n = this.halfExtents;a[0].set(n.x, n.y, n.z), a[1].set(-n.x, n.y, n.z), a[2].set(-n.x, -n.y, n.z), a[3].set(-n.x, -n.y, -n.z), a[4].set(n.x, -n.y, -n.z), a[5].set(n.x, n.y, -n.z), a[6].set(-n.x, n.y, -n.z), a[7].set(n.x, -n.y, n.z);var r = a[0];e.vmult(r, r), t.vadd(r, r), o.copy(r), i.copy(r);for (var s = 1; s < 8; s++) {
                r = a[s], e.vmult(r, r), t.vadd(r, r);var l = r.x,
                    h = r.y,
                    c = r.z;l > o.x && (o.x = l), h > o.y && (o.y = h), c > o.z && (o.z = c), l < i.x && (i.x = l), h < i.y && (i.y = h), c < i.z && (i.z = c);
              }
            };
          }, { "../math/Vec3": 32, "./ConvexPolyhedron": 40, "./Shape": 45 }], 40: [function (t, e) {
            e.exports = r;var i = t("./Shape"),
                o = t("../math/Vec3"),
                n = (t("../math/Quaternion"), t("../math/Transform"));function r(t, e, o) {
              i.call(this, { type: i.types.CONVEXPOLYHEDRON }), this.vertices = t || [], this.worldVertices = [], this.worldVerticesNeedsUpdate = !0, this.faces = e || [], this.faceNormals = [], this.computeNormals(), this.worldFaceNormalsNeedsUpdate = !0, this.worldFaceNormals = [], this.uniqueEdges = [], this.uniqueAxes = o ? o.slice() : null, this.computeEdges(), this.updateBoundingSphereRadius();
            }r.prototype = new i(), r.prototype.constructor = r;var s = new o();r.prototype.computeEdges = function () {
              var t = this.faces,
                  e = this.vertices,
                  i = (e.length, this.uniqueEdges);i.length = 0;for (var o = s, n = 0; n !== t.length; n++) {
                for (var r = t[n], a = r.length, l = 0; l !== a; l++) {
                  var h = (l + 1) % a;e[r[l]].vsub(e[r[h]], o), o.normalize();for (var c = !1, p = 0; p !== i.length; p++) {
                    if (i[p].almostEquals(o) || i[p].almostEquals(o)) {
                      c = !0;break;
                    }
                  }c || i.push(o.clone());
                }
              }
            }, r.prototype.computeNormals = function () {
              this.faceNormals.length = this.faces.length;for (var t = 0; t < this.faces.length; t++) {
                for (var e = 0; e < this.faces[t].length; e++) {
                  if (!this.vertices[this.faces[t][e]]) throw new Error("Vertex " + this.faces[t][e] + " not found!");
                }var i = this.faceNormals[t] || new o();this.getFaceNormal(t, i), i.negate(i), this.faceNormals[t] = i;var n = this.vertices[this.faces[t][0]];if (i.dot(n) < 0) for (console.error(".faceNormals[" + t + "] = Vec3(" + i.toString() + ") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule."), e = 0; e < this.faces[t].length; e++) {
                  console.warn(".vertices[" + this.faces[t][e] + "] = Vec3(" + this.vertices[this.faces[t][e]].toString() + ")");
                }
              }
            };var a = new o(),
                l = new o();r.computeNormal = function (t, e, i, o) {
              e.vsub(t, l), i.vsub(e, a), a.cross(l, o), o.isZero() || o.normalize();
            }, r.prototype.getFaceNormal = function (t, e) {
              var i = this.faces[t],
                  o = this.vertices[i[0]],
                  n = this.vertices[i[1]],
                  s = this.vertices[i[2]];return r.computeNormal(o, n, s, e);
            };var h = new o();r.prototype.clipAgainstHull = function (t, e, i, n, r, s, a, l, c) {
              for (var p = h, u = -1, d = -Number.MAX_VALUE, y = 0; y < i.faces.length; y++) {
                p.copy(i.faceNormals[y]), r.vmult(p, p);var f = p.dot(s);f > d && (d = f, u = y);
              }for (var v = [], m = i.faces[u], g = m.length, w = 0; w < g; w++) {
                var b = i.vertices[m[w]],
                    x = new o();x.copy(b), r.vmult(x, x), n.vadd(x, x), v.push(x);
              }u >= 0 && this.clipFaceAgainstHull(s, t, e, v, a, l, c);
            };var c = new o(),
                p = new o(),
                u = new o(),
                d = new o(),
                y = new o(),
                f = new o();r.prototype.findSeparatingAxis = function (t, e, i, o, n, r, s, a) {
              var l = c,
                  h = p,
                  v = u,
                  m = d,
                  g = y,
                  w = f,
                  b = Number.MAX_VALUE;if (this.uniqueAxes) for (_ = 0; _ !== this.uniqueAxes.length; _++) {
                if (i.vmult(this.uniqueAxes[_], l), !1 === (E = this.testSepAxis(l, t, e, i, o, n))) return !1;E < b && (b = E, r.copy(l));
              } else for (var x = s ? s.length : this.faces.length, _ = 0; _ < x; _++) {
                var B = s ? s[_] : _;if (l.copy(this.faceNormals[B]), i.vmult(l, l), !1 === (E = this.testSepAxis(l, t, e, i, o, n))) return !1;E < b && (b = E, r.copy(l));
              }if (t.uniqueAxes) for (_ = 0; _ !== t.uniqueAxes.length; _++) {
                if (n.vmult(t.uniqueAxes[_], h), !1 === (E = this.testSepAxis(h, t, e, i, o, n))) return !1;E < b && (b = E, r.copy(h));
              } else {
                var S = a ? a.length : t.faces.length;for (_ = 0; _ < S; _++) {
                  var E;if (B = a ? a[_] : _, h.copy(t.faceNormals[B]), n.vmult(h, h), !1 === (E = this.testSepAxis(h, t, e, i, o, n))) return !1;E < b && (b = E, r.copy(h));
                }
              }for (var M = 0; M !== this.uniqueEdges.length; M++) {
                i.vmult(this.uniqueEdges[M], m);for (var C = 0; C !== t.uniqueEdges.length; C++) {
                  if (n.vmult(t.uniqueEdges[C], g), m.cross(g, w), !w.almostZero()) {
                    w.normalize();var A = this.testSepAxis(w, t, e, i, o, n);if (!1 === A) return !1;A < b && (b = A, r.copy(w));
                  }
                }
              }return o.vsub(e, v), v.dot(r) > 0 && r.negate(r), !0;
            };var v = [],
                m = [];r.prototype.testSepAxis = function (t, e, i, o, n, s) {
              r.project(this, t, i, o, v), r.project(e, t, n, s, m);var a = v[0],
                  l = v[1],
                  h = m[0],
                  c = m[1];if (a < c || h < l) return !1;var p = a - c,
                  u = h - l;return p < u ? p : u;
            };var g = new o(),
                w = new o();r.prototype.calculateLocalInertia = function (t, e) {
              this.computeLocalAABB(g, w);var i = w.x - g.x,
                  o = w.y - g.y,
                  n = w.z - g.z;e.x = 1 / 12 * t * (4 * o * o + 4 * n * n), e.y = 1 / 12 * t * (4 * i * i + 4 * n * n), e.z = 1 / 12 * t * (4 * o * o + 4 * i * i);
            }, r.prototype.getPlaneConstantOfFace = function (t) {
              var e = this.faces[t],
                  i = this.faceNormals[t],
                  o = this.vertices[e[0]];return -i.dot(o);
            };var b = new o(),
                x = new o(),
                _ = new o(),
                B = new o(),
                S = new o(),
                E = new o(),
                M = new o(),
                C = new o();r.prototype.clipFaceAgainstHull = function (t, e, i, o, n, r, s) {
              for (var a = b, l = x, h = _, c = B, p = S, u = E, d = M, y = C, f = o, v = [], m = -1, g = Number.MAX_VALUE, w = 0; w < this.faces.length; w++) {
                a.copy(this.faceNormals[w]), i.vmult(a, a);var A = a.dot(t);A < g && (g = A, m = w);
              }if (!(m < 0)) {
                var z = this.faces[m];z.connectedFaces = [];for (var F = 0; F < this.faces.length; F++) {
                  for (var T = 0; T < this.faces[F].length; T++) {
                    -1 !== z.indexOf(this.faces[F][T]) && F !== m && -1 === z.connectedFaces.indexOf(F) && z.connectedFaces.push(F);
                  }
                }f.length;for (var R = z.length, P = 0; P < R; P++) {
                  var q = this.vertices[z[P]],
                      I = this.vertices[z[(P + 1) % R]];q.vsub(I, l), h.copy(l), i.vmult(h, h), e.vadd(h, h), c.copy(this.faceNormals[m]), i.vmult(c, c), e.vadd(c, c), h.cross(c, p), p.negate(p), u.copy(q), i.vmult(u, u), e.vadd(u, u), u.dot(p);var V = z.connectedFaces[P];d.copy(this.faceNormals[V]);var O = this.getPlaneConstantOfFace(V);y.copy(d), i.vmult(y, y);var k = O - y.dot(e);for (this.clipFaceAgainstPlane(f, v, y, k); f.length;) {
                    f.shift();
                  }for (; v.length;) {
                    f.push(v.shift());
                  }
                }for (d.copy(this.faceNormals[m]), O = this.getPlaneConstantOfFace(m), y.copy(d), i.vmult(y, y), k = O - y.dot(e), F = 0; F < f.length; F++) {
                  var N = y.dot(f[F]) + k;if (N <= n && (N = n), N <= r) {
                    var j = f[F];if (N <= 0) {
                      var L = { point: j, normal: y, depth: N };s.push(L);
                    }
                  }
                }
              }
            }, r.prototype.clipFaceAgainstPlane = function (t, e, i, n) {
              var r,
                  s,
                  a = t.length;if (a < 2) return e;var l = t[t.length - 1],
                  h = t[0];r = i.dot(l) + n;for (var c = 0; c < a; c++) {
                if (h = t[c], s = i.dot(h) + n, r < 0) {
                  if (s < 0) (p = new o()).copy(h), e.push(p);else {
                    var p = new o();l.lerp(h, r / (r - s), p), e.push(p);
                  }
                } else s < 0 && (p = new o(), l.lerp(h, r / (r - s), p), e.push(p), e.push(h));l = h, r = s;
              }return e;
            }, r.prototype.computeWorldVertices = function (t, e) {
              for (var i = this.vertices.length; this.worldVertices.length < i;) {
                this.worldVertices.push(new o());
              }for (var n = this.vertices, r = this.worldVertices, s = 0; s !== i; s++) {
                e.vmult(n[s], r[s]), t.vadd(r[s], r[s]);
              }this.worldVerticesNeedsUpdate = !1;
            }, new o(), r.prototype.computeLocalAABB = function (t, e) {
              var i = this.vertices.length,
                  o = this.vertices;t.set(Number.MAX_VALUE, Number.MAX_VALUE, Number.MAX_VALUE), e.set(-Number.MAX_VALUE, -Number.MAX_VALUE, -Number.MAX_VALUE);for (var n = 0; n < i; n++) {
                var r = o[n];r.x < t.x ? t.x = r.x : r.x > e.x && (e.x = r.x), r.y < t.y ? t.y = r.y : r.y > e.y && (e.y = r.y), r.z < t.z ? t.z = r.z : r.z > e.z && (e.z = r.z);
              }
            }, r.prototype.computeWorldFaceNormals = function (t) {
              for (var e = this.faceNormals.length; this.worldFaceNormals.length < e;) {
                this.worldFaceNormals.push(new o());
              }for (var i = this.faceNormals, n = this.worldFaceNormals, r = 0; r !== e; r++) {
                t.vmult(i[r], n[r]);
              }this.worldFaceNormalsNeedsUpdate = !1;
            }, r.prototype.updateBoundingSphereRadius = function () {
              for (var t = 0, e = this.vertices, i = 0, o = e.length; i !== o; i++) {
                var n = e[i].norm2();n > t && (t = n);
              }this.boundingSphereRadius = Math.sqrt(t);
            };var A = new o();r.prototype.calculateWorldAABB = function (t, e, i, o) {
              for (var n, r, s, a, l, h, c = this.vertices.length, p = this.vertices, u = 0; u < c; u++) {
                A.copy(p[u]), e.vmult(A, A), t.vadd(A, A);var d = A;(d.x < n || void 0 === n) && (n = d.x), (d.x > a || void 0 === a) && (a = d.x), (d.y < r || void 0 === r) && (r = d.y), (d.y > l || void 0 === l) && (l = d.y), (d.z < s || void 0 === s) && (s = d.z), (d.z > h || void 0 === h) && (h = d.z);
              }i.set(n, r, s), o.set(a, l, h);
            }, r.prototype.volume = function () {
              return 4 * Math.PI * this.boundingSphereRadius / 3;
            }, r.prototype.getAveragePointLocal = function (t) {
              t = t || new o();for (var e = this.vertices.length, i = this.vertices, n = 0; n < e; n++) {
                t.vadd(i[n], t);
              }return t.mult(1 / e, t), t;
            }, r.prototype.transformAllPoints = function (t, e) {
              var i = this.vertices.length,
                  o = this.vertices;if (e) {
                for (var n = 0; n < i; n++) {
                  var r = o[n];e.vmult(r, r);
                }for (n = 0; n < this.faceNormals.length; n++) {
                  r = this.faceNormals[n], e.vmult(r, r);
                }
              }if (t) for (n = 0; n < i; n++) {
                (r = o[n]).vadd(t, r);
              }
            };var z = new o(),
                F = new o(),
                T = new o();r.prototype.pointIsInside = function (t) {
              var e = this.vertices.length,
                  i = this.vertices,
                  o = this.faces,
                  n = this.faceNormals,
                  r = this.faces.length,
                  s = z;this.getAveragePointLocal(s);for (var a = 0; a < r; a++) {
                this.faces[a].length, e = n[a];var l = i[o[a][0]],
                    h = F;t.vsub(l, h);var c = e.dot(h),
                    p = T;s.vsub(l, p);var u = e.dot(p);if (c < 0 && u > 0 || c > 0 && u < 0) return !1;
              }return -1;
            }, new o();var R = new o(),
                P = new o();r.project = function (t, e, i, o, r) {
              var s = t.vertices.length,
                  a = R,
                  l = 0,
                  h = 0,
                  c = P,
                  p = t.vertices;c.setZero(), n.vectorToLocalFrame(i, o, e, a), n.pointToLocalFrame(i, o, c, c);var u = c.dot(a);h = l = p[0].dot(a);for (var d = 1; d < s; d++) {
                var y = p[d].dot(a);y > l && (l = y), y < h && (h = y);
              }if ((h -= u) > (l -= u)) {
                var f = h;h = l, l = f;
              }r[0] = l, r[1] = h;
            };
          }, { "../math/Quaternion": 30, "../math/Transform": 31, "../math/Vec3": 32, "./Shape": 45 }], 41: [function (t, e) {
            e.exports = r, t("./Shape");var i = t("../math/Vec3"),
                o = (t("../math/Quaternion"), t("./ConvexPolyhedron")),
                n = t("../math/CMath");function r(t, e, r, s, a) {
              if (a) {
                for (var l = s, h = n.cos, c = n.sin, p = r / 2, u = [], d = [], y = [0], f = [1], v = [], m = 2 * Math.PI / l, g = 0; g < l; g++) {
                  u.push(new i(t * h(m * g), p, t * c(m * g))), u.push(new i(t * h(m * g), -p, t * c(m * g))), g < l - 1 ? (d.push([2 * g + 2, 2 * g + 3, 2 * g + 1, 2 * g]), y.push(2 * g + 2), f.push(2 * g + 3)) : d.push([0, 1, 2 * g + 1, 2 * g]), (l % 2 == 1 || g < l / 2) && v.push(new i(h(m * (g + .5)), 0, c(m * (g + .5))));
                }d.push(f);var w = [];for (g = 0; g < y.length; g++) {
                  w.push(y[y.length - g - 1]);
                }return d.push(w), v.push(new i(0, 1, 0)), void o.call(this, u, d, v);
              }l = s;var b = [],
                  x = (v = [], []),
                  _ = [],
                  B = [];for (h = n.cos, c = n.sin, b.push(new i(e * h(0), e * c(0), .5 * -r)), _.push(0), b.push(new i(t * h(0), t * c(0), .5 * r)), B.push(1), g = 0; g < l; g++) {
                m = 2 * Math.PI / l * (g + 1);var S = 2 * Math.PI / l * (g + .5);g < l - 1 ? (b.push(new i(e * h(m), e * c(m), .5 * -r)), _.push(2 * g + 2), b.push(new i(t * h(m), t * c(m), .5 * r)), B.push(2 * g + 3), x.push([2 * g + 2, 2 * g + 3, 2 * g + 1, 2 * g])) : x.push([0, 1, 2 * g + 1, 2 * g]), (l % 2 == 1 || g < l / 2) && v.push(new i(h(S), c(S), 0));
              }for (x.push(B), v.push(new i(0, 0, 1)), w = [], g = 0; g < _.length; g++) {
                w.push(_[_.length - g - 1]);
              }x.push(w), o.call(this, b, x, v);
            }r.prototype = new o();
          }, { "../math/CMath": 27, "../math/Quaternion": 30, "../math/Vec3": 32, "./ConvexPolyhedron": 40, "./Shape": 45 }], 42: [function (t, e) {
            var i = t("./Shape"),
                o = t("./ConvexPolyhedron"),
                n = t("../math/Vec3"),
                r = t("../utils/Utils");function s(t, e) {
              e = r.defaults(e, { maxValue: null, minValue: null, elementSize: 1 }), this.data = t, this.maxValue = e.maxValue, this.minValue = e.minValue, this.elementSize = e.elementSize, null === e.minValue && this.updateMinValue(), null === e.maxValue && this.updateMaxValue(), this.cacheEnabled = !0, i.call(this, { type: i.types.HEIGHTFIELD }), this.pillarConvex = new o(), this.pillarOffset = new n(), this.updateBoundingSphereRadius(), this._cachedPillars = {};
            }e.exports = s, s.prototype = new i(), s.prototype.update = function () {
              this._cachedPillars = {};
            }, s.prototype.updateMinValue = function () {
              for (var t = this.data, e = t[0][0], i = 0; i !== t.length; i++) {
                for (var o = 0; o !== t[i].length; o++) {
                  var n = t[i][o];n < e && (e = n);
                }
              }this.minValue = e;
            }, s.prototype.updateMaxValue = function () {
              for (var t = this.data, e = t[0][0], i = 0; i !== t.length; i++) {
                for (var o = 0; o !== t[i].length; o++) {
                  var n = t[i][o];n > e && (e = n);
                }
              }this.maxValue = e;
            }, s.prototype.setHeightValueAtIndex = function (t, e, i) {
              this.data[t][e] = i, this.clearCachedConvexTrianglePillar(t, e, !1), t > 0 && (this.clearCachedConvexTrianglePillar(t - 1, e, !0), this.clearCachedConvexTrianglePillar(t - 1, e, !1)), e > 0 && (this.clearCachedConvexTrianglePillar(t, e - 1, !0), this.clearCachedConvexTrianglePillar(t, e - 1, !1)), e > 0 && t > 0 && this.clearCachedConvexTrianglePillar(t - 1, e - 1, !0);
            }, s.prototype.getRectMinMax = function (t, e, i, o, n) {
              n = n || [];for (var r = this.data, s = this.minValue, a = t; a <= i; a++) {
                for (var l = e; l <= o; l++) {
                  var h = r[a][l];h > s && (s = h);
                }
              }n[0] = this.minValue, n[1] = s;
            }, s.prototype.getIndexOfPosition = function (t, e, i, o) {
              var n = this.elementSize,
                  r = this.data,
                  s = Math.floor(t / n),
                  a = Math.floor(e / n);return i[0] = s, i[1] = a, o && (s < 0 && (s = 0), a < 0 && (a = 0), s >= r.length - 1 && (s = r.length - 1), a >= r[0].length - 1 && (a = r[0].length - 1)), !(s < 0 || a < 0 || s >= r.length - 1 || a >= r[0].length - 1);
            };var a = [],
                l = new n(),
                h = new n(),
                c = new n(),
                p = new n();s.prototype.getTriangleAt = function (t, e, i, o, n, r) {
              var s = a;this.getIndexOfPosition(t, e, s, i);var l = s[0],
                  h = s[1],
                  c = this.data;i && (l = Math.min(c.length - 2, Math.max(0, l)), h = Math.min(c[0].length - 2, Math.max(0, h)));var p = this.elementSize,
                  u = Math.pow(t / p - l, 2) + Math.pow(e / p - h, 2) > Math.pow(t / p - (l + 1), 2) + Math.pow(e / p - (h + 1), 2);return this.getTriangle(l, h, u, o, n, r), u;
            };var u = new n(),
                d = new n(),
                y = new n(),
                f = new n(),
                v = new n();function m(t, e, i, o, n, r, s, a, l) {
              l.x = ((r - a) * (t - s) + (s - n) * (e - a)) / ((r - a) * (i - s) + (s - n) * (o - a)), l.y = ((a - o) * (t - s) + (i - s) * (e - a)) / ((r - a) * (i - s) + (s - n) * (o - a)), l.z = 1 - l.x - l.y;
            }s.prototype.getNormalAt = function (t, e, i, o) {
              var n = u,
                  r = d,
                  s = y,
                  a = f,
                  l = v;this.getTriangleAt(t, e, i, n, r, s), r.vsub(n, a), s.vsub(n, l), a.cross(l, o), o.normalize();
            }, s.prototype.getAabbAtIndex = function (t, e, i) {
              var o = this.data,
                  n = this.elementSize;i.lowerBound.set(t * n, e * n, o[t][e]), i.upperBound.set((t + 1) * n, (e + 1) * n, o[t + 1][e + 1]);
            }, s.prototype.getHeightAt = function (t, e, i) {
              var o = this.data,
                  n = h,
                  r = c,
                  s = p,
                  u = a;this.getIndexOfPosition(t, e, u, i);var d = u[0],
                  y = u[1];i && (d = Math.min(o.length - 2, Math.max(0, d)), y = Math.min(o[0].length - 2, Math.max(0, y)));var f = this.getTriangleAt(t, e, i, n, r, s);m(t, e, n.x, n.y, r.x, r.y, s.x, s.y, l);var v = l;return f ? o[d + 1][y + 1] * v.x + o[d][y + 1] * v.y + o[d + 1][y] * v.z : o[d][y] * v.x + o[d + 1][y] * v.y + o[d][y + 1] * v.z;
            }, s.prototype.getCacheConvexTrianglePillarKey = function (t, e, i) {
              return t + "_" + e + "_" + (i ? 1 : 0);
            }, s.prototype.getCachedConvexTrianglePillar = function (t, e, i) {
              return this._cachedPillars[this.getCacheConvexTrianglePillarKey(t, e, i)];
            }, s.prototype.setCachedConvexTrianglePillar = function (t, e, i, o, n) {
              this._cachedPillars[this.getCacheConvexTrianglePillarKey(t, e, i)] = { convex: o, offset: n };
            }, s.prototype.clearCachedConvexTrianglePillar = function (t, e, i) {
              delete this._cachedPillars[this.getCacheConvexTrianglePillarKey(t, e, i)];
            }, s.prototype.getTriangle = function (t, e, i, o, n, r) {
              var s = this.data,
                  a = this.elementSize;i ? (o.set((t + 1) * a, (e + 1) * a, s[t + 1][e + 1]), n.set(t * a, (e + 1) * a, s[t][e + 1]), r.set((t + 1) * a, e * a, s[t + 1][e])) : (o.set(t * a, e * a, s[t][e]), n.set((t + 1) * a, e * a, s[t + 1][e]), r.set(t * a, (e + 1) * a, s[t][e + 1]));
            }, s.prototype.getConvexTrianglePillar = function (t, e, i) {
              var r = this.pillarConvex,
                  s = this.pillarOffset;if (this.cacheEnabled) {
                if (a = this.getCachedConvexTrianglePillar(t, e, i)) return this.pillarConvex = a.convex, void (this.pillarOffset = a.offset);r = new o(), s = new n(), this.pillarConvex = r, this.pillarOffset = s;
              }var a = this.data,
                  l = this.elementSize,
                  h = r.faces;r.vertices.length = 6;for (var c = 0; c < 6; c++) {
                r.vertices[c] || (r.vertices[c] = new n());
              }for (h.length = 5, c = 0; c < 5; c++) {
                h[c] || (h[c] = []);
              }var p = r.vertices,
                  u = (Math.min(a[t][e], a[t + 1][e], a[t][e + 1], a[t + 1][e + 1]) - this.minValue) / 2 + this.minValue;i ? (s.set((t + .75) * l, (e + .75) * l, u), p[0].set(.25 * l, .25 * l, a[t + 1][e + 1] - u), p[1].set(-.75 * l, .25 * l, a[t][e + 1] - u), p[2].set(.25 * l, -.75 * l, a[t + 1][e] - u), p[3].set(.25 * l, .25 * l, -u - 1), p[4].set(-.75 * l, .25 * l, -u - 1), p[5].set(.25 * l, -.75 * l, -u - 1), h[0][0] = 0, h[0][1] = 1, h[0][2] = 2, h[1][0] = 5, h[1][1] = 4, h[1][2] = 3, h[2][0] = 2, h[2][1] = 5, h[2][2] = 3, h[2][3] = 0, h[3][0] = 3, h[3][1] = 4, h[3][2] = 1, h[3][3] = 0, h[4][0] = 1, h[4][1] = 4, h[4][2] = 5, h[4][3] = 2) : (s.set((t + .25) * l, (e + .25) * l, u), p[0].set(-.25 * l, -.25 * l, a[t][e] - u), p[1].set(.75 * l, -.25 * l, a[t + 1][e] - u), p[2].set(-.25 * l, .75 * l, a[t][e + 1] - u), p[3].set(-.25 * l, -.25 * l, -u - 1), p[4].set(.75 * l, -.25 * l, -u - 1), p[5].set(-.25 * l, .75 * l, -u - 1), h[0][0] = 0, h[0][1] = 1, h[0][2] = 2, h[1][0] = 5, h[1][1] = 4, h[1][2] = 3, h[2][0] = 0, h[2][1] = 2, h[2][2] = 5, h[2][3] = 3, h[3][0] = 1, h[3][1] = 0, h[3][2] = 3, h[3][3] = 4, h[4][0] = 4, h[4][1] = 5, h[4][2] = 2, h[4][3] = 1), r.computeNormals(), r.computeEdges(), r.updateBoundingSphereRadius(), this.setCachedConvexTrianglePillar(t, e, i, r, s);
            }, s.prototype.calculateLocalInertia = function (t, e) {
              return (e = e || new n()).set(0, 0, 0), e;
            }, s.prototype.volume = function () {
              return Number.MAX_VALUE;
            }, s.prototype.calculateWorldAABB = function (t, e, i, o) {
              i.set(-Number.MAX_VALUE, -Number.MAX_VALUE, -Number.MAX_VALUE), o.set(Number.MAX_VALUE, Number.MAX_VALUE, Number.MAX_VALUE);
            }, s.prototype.updateBoundingSphereRadius = function () {
              var t = this.data,
                  e = this.elementSize;this.boundingSphereRadius = new n(t.length * e, t[0].length * e, Math.max(Math.abs(this.maxValue), Math.abs(this.minValue))).norm();
            }, s.prototype.setHeightsFromImage = function (t, e) {
              var i = document.createElement("canvas");i.width = t.width, i.height = t.height;var o = i.getContext("2d");o.drawImage(t, 0, 0);var n = o.getImageData(0, 0, t.width, t.height),
                  r = this.data;r.length = 0, this.elementSize = Math.abs(e.x) / n.width;for (var s = 0; s < n.height; s++) {
                for (var a = [], l = 0; l < n.width; l++) {
                  var h = (n.data[4 * (s * n.height + l)] + n.data[4 * (s * n.height + l) + 1] + n.data[4 * (s * n.height + l) + 2]) / 4 / 255 * e.z;e.x < 0 ? a.push(h) : a.unshift(h);
                }e.y < 0 ? r.unshift(a) : r.push(a);
              }this.updateMaxValue(), this.updateMinValue(), this.update();
            };
          }, { "../math/Vec3": 32, "../utils/Utils": 55, "./ConvexPolyhedron": 40, "./Shape": 45 }], 43: [function (t, e) {
            e.exports = n;var i = t("./Shape"),
                o = t("../math/Vec3");function n() {
              i.call(this, { type: i.types.PARTICLE });
            }n.prototype = new i(), n.prototype.constructor = n, n.prototype.calculateLocalInertia = function (t, e) {
              return (e = e || new o()).set(0, 0, 0), e;
            }, n.prototype.volume = function () {
              return 0;
            }, n.prototype.updateBoundingSphereRadius = function () {
              this.boundingSphereRadius = 0;
            }, n.prototype.calculateWorldAABB = function (t, e, i, o) {
              i.copy(t), o.copy(t);
            };
          }, { "../math/Vec3": 32, "./Shape": 45 }], 44: [function (t, e) {
            e.exports = n;var i = t("./Shape"),
                o = t("../math/Vec3");function n() {
              i.call(this, { type: i.types.PLANE }), this.worldNormal = new o(), this.worldNormalNeedsUpdate = !0, this.boundingSphereRadius = Number.MAX_VALUE;
            }n.prototype = new i(), n.prototype.constructor = n, n.prototype.computeWorldNormal = function (t) {
              var e = this.worldNormal;e.set(0, 0, 1), t.vmult(e, e), this.worldNormalNeedsUpdate = !1;
            }, n.prototype.calculateLocalInertia = function (t, e) {
              return e || new o();
            }, n.prototype.volume = function () {
              return Number.MAX_VALUE;
            };var r = new o();n.prototype.calculateWorldAABB = function (t, e, i, o) {
              r.set(0, 0, 1), e.vmult(r, r);var n = Number.MAX_VALUE;i.set(-n, -n, -n), o.set(n, n, n), 1 === r.x && (o.x = t.x), 1 === r.y && (o.y = t.y), 1 === r.z && (o.z = t.z), -1 === r.x && (i.x = t.x), -1 === r.y && (i.y = t.y), -1 === r.z && (i.z = t.z);
            }, n.prototype.updateBoundingSphereRadius = function () {
              this.boundingSphereRadius = Number.MAX_VALUE;
            };
          }, { "../math/Vec3": 32, "./Shape": 45 }], 45: [function (t, e) {
            e.exports = o;var i = t("../utils/EventTarget"),
                o = t("./Shape");function o(t) {
              t = t || {}, i.apply(this), this.id = o.idCounter++, this.type = t.type || 0, this.boundingSphereRadius = 0, this.collisionResponse = !t.collisionResponse || t.collisionResponse, this.collisionFilterGroup = void 0 !== t.collisionFilterGroup ? t.collisionFilterGroup : 1, this.collisionFilterMask = void 0 !== t.collisionFilterMask ? t.collisionFilterMask : -1, this.material = t.material ? t.material : null, this.body = null;
            }t("../math/Vec3"), t("../math/Quaternion"), t("../material/Material"), o.prototype = new i(), o.prototype.constructor = o, o.prototype.updateBoundingSphereRadius = function () {
              throw "computeBoundingSphereRadius() not implemented for shape type " + this.type;
            }, o.prototype.volume = function () {
              throw "volume() not implemented for shape type " + this.type;
            }, o.prototype.calculateLocalInertia = function () {
              throw "calculateLocalInertia() not implemented for shape type " + this.type;
            }, o.idCounter = 0, o.types = { SPHERE: 1, PLANE: 2, BOX: 4, COMPOUND: 8, CONVEXPOLYHEDRON: 16, HEIGHTFIELD: 32, PARTICLE: 64, CYLINDER: 128, TRIMESH: 256 };
          }, { "../material/Material": 26, "../math/Quaternion": 30, "../math/Vec3": 32, "../utils/EventTarget": 51, "./Shape": 45 }], 46: [function (t, e) {
            e.exports = n;var i = t("./Shape"),
                o = t("../math/Vec3");function n(t) {
              if (i.call(this, { type: i.types.SPHERE }), this.radius = void 0 !== t ? t : 1, this.radius < 0) throw new Error("The sphere radius cannot be negative.");this.updateBoundingSphereRadius();
            }n.prototype = new i(), n.prototype.constructor = n, n.prototype.calculateLocalInertia = function (t, e) {
              e = e || new o();var i = 2 * t * this.radius * this.radius / 5;return e.x = i, e.y = i, e.z = i, e;
            }, n.prototype.volume = function () {
              return 4 * Math.PI * this.radius / 3;
            }, n.prototype.updateBoundingSphereRadius = function () {
              this.boundingSphereRadius = this.radius;
            }, n.prototype.calculateWorldAABB = function (t, e, i, o) {
              for (var n = this.radius, r = ["x", "y", "z"], s = 0; s < r.length; s++) {
                var a = r[s];i[a] = t[a] - n, o[a] = t[a] + n;
              }
            };
          }, { "../math/Vec3": 32, "./Shape": 45 }], 47: [function (t, e) {
            e.exports = l;var i = t("./Shape"),
                o = t("../math/Vec3"),
                n = (t("../math/Quaternion"), t("../math/Transform")),
                r = t("../collision/AABB"),
                s = t("../utils/Octree"),
                a = t("../math/CMath");function l(t, e) {
              i.call(this, { type: i.types.TRIMESH }), this.vertices = new Float32Array(t), this.indices = new Int16Array(e), this.normals = new Float32Array(e.length), this.aabb = new r(), this.edges = null, this.scale = new o(1, 1, 1), this.tree = new s(), this.updateEdges(), this.updateNormals(), this.updateAABB(), this.updateBoundingSphereRadius(), this.updateTree();
            }l.prototype = new i(), l.prototype.constructor = l;var h = new o();l.prototype.updateTree = function () {
              var t = this.tree;t.reset(), t.aabb.copy(this.aabb);var e = this.scale;t.aabb.lowerBound.x *= 1 / e.x, t.aabb.lowerBound.y *= 1 / e.y, t.aabb.lowerBound.z *= 1 / e.z, t.aabb.upperBound.x *= 1 / e.x, t.aabb.upperBound.y *= 1 / e.y, t.aabb.upperBound.z *= 1 / e.z;for (var i = new r(), n = new o(), s = new o(), a = new o(), l = [n, s, a], h = 0; h < this.indices.length / 3; h++) {
                var c = 3 * h;this._getUnscaledVertex(this.indices[c], n), this._getUnscaledVertex(this.indices[c + 1], s), this._getUnscaledVertex(this.indices[c + 2], a), i.setFromPoints(l), t.insert(i, h);
              }t.removeEmptyNodes();
            };var c = new r();l.prototype.getTrianglesInAABB = function (t, e) {
              c.copy(t);var i = this.scale,
                  o = i.x,
                  n = i.y,
                  r = i.z,
                  s = c.lowerBound,
                  a = c.upperBound;return s.x /= o, s.y /= n, s.z /= r, a.x /= o, a.y /= n, a.z /= r, this.tree.aabbQuery(c, e);
            }, l.prototype.setScale = function (t) {
              var e = this.scale.x === this.scale.y === this.scale.z,
                  i = t.x === t.y === t.z;e && i || this.updateNormals(), this.scale.copy(t), this.updateAABB(), this.updateBoundingSphereRadius();
            }, l.prototype.updateNormals = function () {
              for (var t = h, e = this.normals, i = 0; i < this.indices.length / 3; i++) {
                var o = 3 * i,
                    n = this.indices[o],
                    r = this.indices[o + 1],
                    s = this.indices[o + 2];this.getVertex(n, f), this.getVertex(r, v), this.getVertex(s, m), l.computeNormal(v, f, m, t), e[o] = t.x, e[o + 1] = t.y, e[o + 2] = t.z;
              }
            }, l.prototype.updateEdges = function () {
              for (var t = {}, e = function e() {
                t[n < r ? n + "_" + r : r + "_" + n] = !0;
              }, i = 0; i < this.indices.length / 3; i++) {
                var o = 3 * i,
                    n = this.indices[o],
                    r = this.indices[o + 1];this.indices[o + 2], e(), e(), e();
              }var s = Object.keys(t);for (this.edges = new Int16Array(2 * s.length), i = 0; i < s.length; i++) {
                var a = s[i].split("_");this.edges[2 * i] = parseInt(a[0], 10), this.edges[2 * i + 1] = parseInt(a[1], 10);
              }
            }, l.prototype.getEdgeVertex = function (t, e, i) {
              var o = this.edges[2 * t + (e ? 1 : 0)];this.getVertex(o, i);
            };var p = new o(),
                u = new o();l.prototype.getEdgeVector = function (t, e) {
              var i = p,
                  o = u;this.getEdgeVertex(t, 0, i), this.getEdgeVertex(t, 1, o), o.vsub(i, e);
            };var d = new o(),
                y = new o();l.computeNormal = function (t, e, i, o) {
              e.vsub(t, y), i.vsub(e, d), d.cross(y, o), o.isZero() || o.normalize();
            };var f = new o(),
                v = new o(),
                m = new o();l.prototype.getVertex = function (t, e) {
              var i = this.scale;return this._getUnscaledVertex(t, e), e.x *= i.x, e.y *= i.y, e.z *= i.z, e;
            }, l.prototype._getUnscaledVertex = function (t, e) {
              var i = 3 * t,
                  o = this.vertices;return e.set(o[i], o[i + 1], o[i + 2]);
            }, l.prototype.getWorldVertex = function (t, e, i, o) {
              return this.getVertex(t, o), n.pointToWorldFrame(e, i, o, o), o;
            }, l.prototype.getTriangleVertices = function (t, e, i, o) {
              var n = 3 * t;this.getVertex(this.indices[n], e), this.getVertex(this.indices[n + 1], i), this.getVertex(this.indices[n + 2], o);
            }, l.prototype.getNormal = function (t, e) {
              var i = 3 * t;return e.set(this.normals[i], this.normals[i + 1], this.normals[i + 2]);
            };var g = new r();l.prototype.calculateLocalInertia = function (t, e) {
              this.computeLocalAABB(g);var i = g.upperBound.x - g.lowerBound.x,
                  o = g.upperBound.y - g.lowerBound.y,
                  n = g.upperBound.z - g.lowerBound.z;return e.set(1 / 12 * t * (4 * o * o + 4 * n * n), 1 / 12 * t * (4 * i * i + 4 * n * n), 1 / 12 * t * (4 * o * o + 4 * i * i));
            };var w = new o();l.prototype.computeLocalAABB = function (t) {
              var e = t.lowerBound,
                  i = t.upperBound,
                  o = this.vertices.length,
                  n = (this.vertices, w);this.getVertex(0, n), e.copy(n), i.copy(n);for (var r = 0; r !== o; r++) {
                this.getVertex(r, n), n.x < e.x ? e.x = n.x : n.x > i.x && (i.x = n.x), n.y < e.y ? e.y = n.y : n.y > i.y && (i.y = n.y), n.z < e.z ? e.z = n.z : n.z > i.z && (i.z = n.z);
              }
            }, l.prototype.updateAABB = function () {
              this.computeLocalAABB(this.aabb);
            }, l.prototype.updateBoundingSphereRadius = function () {
              for (var t = 0, e = this.vertices, i = new o(), n = 0, r = e.length / 3; n !== r; n++) {
                this.getVertex(n, i);var s = i.norm2();s > t && (t = s);
              }this.boundingSphereRadius = Math.sqrt(t);
            }, new o();var b = new n(),
                x = new r();l.prototype.calculateWorldAABB = function (t, e, i, o) {
              var n = b,
                  r = x;n.position = t, n.quaternion = e, this.aabb.toWorldFrame(n, r), i.copy(r.lowerBound), o.copy(r.upperBound);
            }, l.prototype.volume = function () {
              return 4 * Math.PI * this.boundingSphereRadius / 3;
            }, l.createTorus = function (t, e, i, o, n) {
              t = t || 1, e = e || .5, i = i || 8, o = o || 6, n = n || 2 * Math.PI;for (var r = [], s = [], h = 0; h <= i; h++) {
                for (var c = 0; c <= o; c++) {
                  var p = c / o * n,
                      u = h / i * Math.PI * 2,
                      d = (t + e * a.cos(u)) * a.cos(p),
                      y = (t + e * a.cos(u)) * a.sin(p),
                      f = e * a.sin(u);r.push(d, y, f);
                }
              }for (h = 1; h <= i; h++) {
                for (c = 1; c <= o; c++) {
                  var v = (o + 1) * h + c - 1,
                      m = (o + 1) * (h - 1) + c - 1,
                      g = (o + 1) * (h - 1) + c,
                      w = (o + 1) * h + c;s.push(v, m, w), s.push(m, g, w);
                }
              }return new l(r, s);
            };
          }, { "../collision/AABB": 3, "../math/CMath": 27, "../math/Quaternion": 30, "../math/Transform": 31, "../math/Vec3": 32, "../utils/Octree": 52, "./Shape": 45 }], 48: [function (t, e) {
            e.exports = o, t("../math/Vec3"), t("../math/Quaternion");var i = t("./Solver");function o() {
              i.call(this), this.iterations = 10, this.tolerance = 1e-7;
            }o.prototype = new i();var n = [],
                r = [],
                s = [];o.prototype.solve = function (t, e) {
              var i,
                  o,
                  a,
                  l,
                  h,
                  c = 0,
                  p = this.iterations,
                  u = this.tolerance * this.tolerance,
                  d = this.equations,
                  y = d.length,
                  f = e.bodies,
                  v = f.length,
                  m = t;if (0 !== y) for (var g = 0; g !== v; g++) {
                f[g].updateSolveMassProperties();
              }var w = r,
                  b = s,
                  x = n;for (w.length = y, b.length = y, x.length = y, g = 0; g !== y; g++) {
                var _ = d[g];x[g] = 0, b[g] = _.computeB(m), w[g] = 1 / _.computeC();
              }if (0 !== y) {
                for (g = 0; g !== v; g++) {
                  var B = (M = f[g]).vlambda,
                      S = M.wlambda;B.set(0, 0, 0), S.set(0, 0, 0);
                }for (c = 0; c !== p; c++) {
                  l = 0;for (var E = 0; E !== y; E++) {
                    _ = d[E], i = b[E], o = w[E], (h = x[E]) + (a = o * (i - _.computeGWlambda() - _.eps * h)) < _.minForce ? a = _.minForce - h : h + a > _.maxForce && (a = _.maxForce - h), x[E] += a, l += a > 0 ? a : -a, _.addToWlambda(a);
                  }if (l * l < u) break;
                }for (g = 0; g !== v; g++) {
                  var M,
                      C = (M = f[g]).velocity,
                      A = M.angularVelocity;M.vlambda.vmul(M.linearFactor, M.vlambda), C.vadd(M.vlambda, C), M.wlambda.vmul(M.angularFactor, M.wlambda), A.vadd(M.wlambda, A);
                }for (var z = d.length, F = 1 / m; z--;) {
                  d[z].multiplier = x[z] * F;
                }
              }return c;
            };
          }, { "../math/Quaternion": 30, "../math/Vec3": 32, "./Solver": 49 }], 49: [function (t, e) {
            function i() {
              this.equations = [];
            }e.exports = i, i.prototype.solve = function () {
              return 0;
            }, i.prototype.addEquation = function (t) {
              t.enabled && this.equations.push(t);
            }, i.prototype.removeEquation = function (t) {
              var e = this.equations,
                  i = e.indexOf(t);-1 !== i && e.splice(i, 1);
            }, i.prototype.removeAllEquations = function () {
              this.equations.length = 0;
            };
          }, {}], 50: [function (t, e) {
            e.exports = n, t("../math/Vec3"), t("../math/Quaternion");var i = t("./Solver"),
                o = t("../objects/Body");function n(t) {
              for (i.call(this), this.iterations = 10, this.tolerance = 1e-7, this.subsolver = t, this.nodes = [], this.nodePool = []; this.nodePool.length < 128;) {
                this.nodePool.push(this.createNode());
              }
            }n.prototype = new i();var r = [],
                s = [],
                a = { bodies: [] },
                l = o.STATIC;function h(t) {
              for (var e = t.length, i = 0; i !== e; i++) {
                var o = t[i];if (!(o.visited || o.body.type & l)) return o;
              }return !1;
            }var c = [];function p(t, e, i, o) {
              for (c.push(t), t.visited = !0, e(t, i, o); c.length;) {
                for (var n, r = c.pop(); n = h(r.children);) {
                  n.visited = !0, e(n, i, o), c.push(n);
                }
              }
            }function u(t, e, i) {
              e.push(t.body);for (var o = t.eqs.length, n = 0; n !== o; n++) {
                var r = t.eqs[n];-1 === i.indexOf(r) && i.push(r);
              }
            }function d(t, e) {
              return e.id - t.id;
            }n.prototype.createNode = function () {
              return { body: null, children: [], eqs: [], visited: !1 };
            }, n.prototype.solve = function (t, e) {
              for (var i = r, o = this.nodePool, n = e.bodies, l = this.equations, c = l.length, y = n.length, f = this.subsolver; o.length < y;) {
                o.push(this.createNode());
              }i.length = y;for (var v = 0; v < y; v++) {
                i[v] = o[v];
              }for (v = 0; v !== y; v++) {
                var m = i[v];m.body = n[v], m.children.length = 0, m.eqs.length = 0, m.visited = !1;
              }for (var g = 0; g !== c; g++) {
                var w = l[g],
                    b = (v = n.indexOf(w.bi), n.indexOf(w.bj)),
                    x = i[v],
                    _ = i[b];x.children.push(_), x.eqs.push(w), _.children.push(x), _.eqs.push(w);
              }var B,
                  S = 0,
                  E = s;f.tolerance = this.tolerance, f.iterations = this.iterations;for (var M = a; B = h(i);) {
                E.length = 0, M.bodies.length = 0, p(B, u, M.bodies, E);var C = E.length;for (E = E.sort(d), v = 0; v !== C; v++) {
                  f.addEquation(E[v]);
                }f.solve(t, M), f.removeAllEquations(), S++;
              }return S;
            };
          }, { "../math/Quaternion": 30, "../math/Vec3": 32, "../objects/Body": 33, "./Solver": 49 }], 51: [function (t, e) {
            var i = function i() {};e.exports = i, i.prototype = { constructor: i, addEventListener: function addEventListener(t, e) {
                void 0 === this._listeners && (this._listeners = {});var i = this._listeners;return void 0 === i[t] && (i[t] = []), -1 === i[t].indexOf(e) && i[t].push(e), this;
              }, hasEventListener: function hasEventListener(t, e) {
                if (void 0 === this._listeners) return !1;var i = this._listeners;return void 0 !== i[t] && -1 !== i[t].indexOf(e);
              }, hasAnyEventListener: function hasAnyEventListener(t) {
                return void 0 !== this._listeners && void 0 !== this._listeners[t];
              }, removeEventListener: function removeEventListener(t, e) {
                if (void 0 === this._listeners) return this;var i = this._listeners;if (void 0 === i[t]) return this;var o = i[t].indexOf(e);return -1 !== o && i[t].splice(o, 1), this;
              }, dispatchEvent: function dispatchEvent(t) {
                if (void 0 === this._listeners) return this;var e = this._listeners[t.type];if (void 0 !== e) {
                  t.target = this;for (var i = 0, o = e.length; i < o; i++) {
                    e[i].call(this, t);
                  }
                }return this;
              } };
          }, {}], 52: [function (t, e) {
            var i = t("../collision/AABB"),
                o = t("../math/Vec3");function n(t) {
              t = t || {}, this.root = t.root || null, this.aabb = t.aabb ? t.aabb.clone() : new i(), this.data = [], this.children = [];
            }function r(t, e) {
              (e = e || {}).root = null, e.aabb = t, n.call(this, e), this.maxDepth = void 0 !== e.maxDepth ? e.maxDepth : 8;
            }e.exports = r, r.prototype = new n(), n.prototype.reset = function () {
              this.children.length = this.data.length = 0;
            }, n.prototype.insert = function (t, e, i) {
              var o = this.data;if (i = i || 0, !this.aabb.contains(t)) return !1;var n = this.children;if (i < (this.maxDepth || this.root.maxDepth)) {
                var r = !1;n.length || (this.subdivide(), r = !0);for (var s = 0; 8 !== s; s++) {
                  if (n[s].insert(t, e, i + 1)) return !0;
                }r && (n.length = 0);
              }return o.push(e), !0;
            };var s = new o();n.prototype.subdivide = function () {
              var t = this.aabb,
                  e = t.lowerBound,
                  r = t.upperBound,
                  a = this.children;a.push(new n({ aabb: new i({ lowerBound: new o(0, 0, 0) }) }), new n({ aabb: new i({ lowerBound: new o(1, 0, 0) }) }), new n({ aabb: new i({ lowerBound: new o(1, 1, 0) }) }), new n({ aabb: new i({ lowerBound: new o(1, 1, 1) }) }), new n({ aabb: new i({ lowerBound: new o(0, 1, 1) }) }), new n({ aabb: new i({ lowerBound: new o(0, 0, 1) }) }), new n({ aabb: new i({ lowerBound: new o(1, 0, 1) }) }), new n({ aabb: new i({ lowerBound: new o(0, 1, 0) }) })), r.vsub(e, s), s.scale(.5, s);for (var l = this.root || this, h = 0; 8 !== h; h++) {
                var c = a[h];c.root = l;var p = c.aabb.lowerBound;p.x *= s.x, p.y *= s.y, p.z *= s.z, p.vadd(e, p), p.vadd(s, c.aabb.upperBound);
              }
            }, n.prototype.aabbQuery = function (t, e) {
              this.data, this.children;for (var i = [this]; i.length;) {
                var o = i.pop();o.aabb.overlaps(t) && Array.prototype.push.apply(e, o.data), Array.prototype.push.apply(i, o.children);
              }return e;
            };var a = new i();n.prototype.rayQuery = function (t, e, i) {
              return t.getAABB(a), a.toLocalFrame(e, a), this.aabbQuery(a, i), i;
            }, n.prototype.removeEmptyNodes = function () {
              for (var t = this.children.length - 1; t >= 0; t--) {
                this.children[t].removeEmptyNodes(), this.children[t].children.length || this.children[t].data.length || this.children.splice(t, 1);
              }
            };
          }, { "../collision/AABB": 3, "../math/Vec3": 32 }], 53: [function (t, e) {
            function i() {
              this.objects = [], this.type = Object;
            }e.exports = i, i.prototype.release = function () {
              for (var t = arguments.length, e = 0; e !== t; e++) {
                this.objects.push(arguments[e]);
              }return this;
            }, i.prototype.get = function () {
              return 0 === this.objects.length ? this.constructObject() : this.objects.pop();
            }, i.prototype.constructObject = function () {
              throw new Error("constructObject() not implemented in this Pool subclass yet!");
            }, i.prototype.resize = function (t) {
              for (var e = this.objects; e.length > t;) {
                e.pop();
              }for (; e.length < t;) {
                e.push(this.constructObject());
              }return this;
            };
          }, {}], 54: [function (t, e) {
            function i() {
              this.data = { keys: [] };
            }e.exports = i, i.prototype.get = function (t, e) {
              if (t > e) {
                var i = e;e = t, t = i;
              }return this.data[t + "-" + e];
            }, i.prototype.set = function (t, e, i) {
              if (t > e) {
                var o = e;e = t, t = o;
              }var n = t + "-" + e;return this.get(t, e) || this.data.keys.push(n), this.data[n] = i, this.data[n];
            }, i.prototype.del = function (t, e) {
              if (t > e) {
                var i = e;e = t, t = i;
              }var o = t + "-" + e,
                  n = this.data.keys.indexOf(o);return n >= 0 && (this.data.keys.splice(n, 1), delete this.data[o], !0);
            }, i.prototype.reset = function () {
              this.data = { keys: [] };
            }, i.prototype.getLength = function () {
              return this.data.keys.length;
            }, i.prototype.getKeyByIndex = function (t) {
              return this.data.keys[t];
            }, i.prototype.getDataByKey = function (t) {
              return this.data[t];
            };
          }, {}], 55: [function (t, e) {
            function i() {}e.exports = i, i.defaults = function (t, e) {
              for (var i in t = t || {}, e) {
                i in t || (t[i] = e[i]);
              }return t;
            };
          }, {}], 56: [function (t, e) {
            e.exports = n;var i = t("../math/Vec3"),
                o = t("./Pool");function n() {
              o.call(this), this.type = i;
            }n.prototype = new o(), n.prototype.constructObject = function () {
              return new i();
            };
          }, { "../math/Vec3": 32, "./Pool": 53 }], 57: [function (t, e) {
            e.exports = u;var i = t("../collision/AABB"),
                o = t("../objects/Body"),
                n = t("../shapes/Shape"),
                r = t("../collision/Ray"),
                s = t("../math/Vec3"),
                a = t("../math/Transform"),
                l = (t("../shapes/ConvexPolyhedron"), t("../math/Quaternion")),
                h = (t("../solver/Solver"), t("../utils/Vec3Pool")),
                c = t("../equations/ContactEquation"),
                p = t("../equations/FrictionEquation");function u(t) {
              this.contactPointPool = [], this.frictionEquationPool = [], this.result = [], this.frictionResult = [], this.v3pool = new h(), this.world = t, this.currentContactMaterial = null, this.enableFrictionReduction = !1;
            }u.prototype.createContactEquation = function (t, e, i, o, n, r) {
              var s;this.contactPointPool.length ? ((s = this.contactPointPool.pop()).bi = t, s.bj = e) : s = new c(t, e), s.enabled = t.collisionResponse && e.collisionResponse && i.collisionResponse && o.collisionResponse;var a = this.currentContactMaterial;s.restitution = a.restitution, s.setSpookParams(a.contactEquationStiffness, a.contactEquationRelaxation, this.world.dt);var l = i.material || t.material,
                  h = o.material || e.material;return l && h && l.restitution >= 0 && h.restitution >= 0 && (s.restitution = l.restitution * h.restitution), s.si = n || i, s.sj = r || o, s;
            }, u.prototype.createFrictionEquationsFromContact = function (t, e) {
              var i = t.bi,
                  o = t.bj,
                  n = t.si,
                  r = t.sj,
                  s = this.world,
                  a = this.currentContactMaterial,
                  l = a.friction,
                  h = n.material || i.material,
                  c = r.material || o.material;if (h && c && h.friction >= 0 && c.friction >= 0 && (l = h.friction * c.friction), l > 0) {
                var u = l * s.gravity.length(),
                    d = i.invMass + o.invMass;d > 0 && (d = 1 / d);var y = this.frictionEquationPool,
                    f = y.length ? y.pop() : new p(i, o, u * d),
                    v = y.length ? y.pop() : new p(i, o, u * d);return f.bi = v.bi = i, f.bj = v.bj = o, f.minForce = v.minForce = -u * d, f.maxForce = v.maxForce = u * d, f.ri.copy(t.ri), f.rj.copy(t.rj), v.ri.copy(t.ri), v.rj.copy(t.rj), t.ni.tangents(f.t, v.t), f.setSpookParams(a.frictionEquationStiffness, a.frictionEquationRelaxation, s.dt), v.setSpookParams(a.frictionEquationStiffness, a.frictionEquationRelaxation, s.dt), f.enabled = v.enabled = t.enabled, e.push(f, v), !0;
              }return !1;
            };var d = new s(),
                y = new s(),
                f = new s();u.prototype.createFrictionFromAverage = function (t) {
              var e = this.result[this.result.length - 1];if (this.createFrictionEquationsFromContact(e, this.frictionResult) && 1 !== t) {
                var i = this.frictionResult[this.frictionResult.length - 2],
                    o = this.frictionResult[this.frictionResult.length - 1];d.setZero(), y.setZero(), f.setZero();for (var n = e.bi, r = (e.bj, 0); r !== t; r++) {
                  (e = this.result[this.result.length - 1 - r]).bodyA !== n ? (d.vadd(e.ni, d), y.vadd(e.ri, y), f.vadd(e.rj, f)) : (d.vsub(e.ni, d), y.vadd(e.rj, y), f.vadd(e.ri, f));
                }var s = 1 / t;y.scale(s, i.ri), f.scale(s, i.rj), o.ri.copy(i.ri), o.rj.copy(i.rj), d.normalize(), d.tangents(i.t, o.t);
              }
            };var v = new s(),
                m = new s(),
                g = new l(),
                w = new l();u.prototype.getContacts = function (t, e, i, n, r, s, a) {
              this.contactPointPool = r, this.frictionEquationPool = a, this.result = n, this.frictionResult = s;for (var l = g, h = w, c = v, p = m, u = 0, d = t.length; u !== d; u++) {
                var y = t[u],
                    f = e[u],
                    b = null;y.material && f.material && (b = i.getContactMaterial(y.material, f.material) || null);for (var x = 0 == y.collisionResponse || 0 == f.collisionResponse || y.type & o.KINEMATIC && f.type & o.STATIC || y.type & o.STATIC && f.type & o.KINEMATIC || y.type & o.KINEMATIC && f.type & o.KINEMATIC, _ = 0; _ < y.shapes.length; _++) {
                  y.quaternion.mult(y.shapeOrientations[_], l), y.quaternion.vmult(y.shapeOffsets[_], c), c.vadd(y.position, c);for (var B = y.shapes[_], S = 0; S < f.shapes.length; S++) {
                    f.quaternion.mult(f.shapeOrientations[S], h), f.quaternion.vmult(f.shapeOffsets[S], p), p.vadd(f.position, p);var E = f.shapes[S];if (B.collisionFilterMask & E.collisionFilterGroup && E.collisionFilterMask & B.collisionFilterGroup && !(c.distanceTo(p) > B.boundingSphereRadius + E.boundingSphereRadius)) {
                      x |= 0 == B.collisionResponse || 0 == E.collisionResponse;var M = null;B.material && E.material && (M = i.getContactMaterial(B.material, E.material) || null), this.currentContactMaterial = M || b || i.defaultContactMaterial;var C = this[B.type | E.type];if (C && (B.type < E.type ? C.call(this, B, E, c, p, l, h, y, f, B, E, x) : C.call(this, E, B, p, c, h, l, f, y, B, E, x)) && x) {
                        i.shapeOverlapKeeper.set(B.id, E.id), i.bodyOverlapKeeper.set(y.id, f.id);var A = { si: B, sj: E };i.triggerDic.set(B.id, E.id, A), i.oldTriggerDic.set(B.id, E.id, A);
                      }
                    }
                  }
                }
              }
            }, u.prototype[n.types.BOX | n.types.BOX] = u.prototype.boxBox = function (t, e, i, o, n, r, s, a, l, h, c) {
              return t.convexPolyhedronRepresentation.material = t.material, e.convexPolyhedronRepresentation.material = e.material, t.convexPolyhedronRepresentation.collisionResponse = t.collisionResponse, e.convexPolyhedronRepresentation.collisionResponse = e.collisionResponse, this.convexConvex(t.convexPolyhedronRepresentation, e.convexPolyhedronRepresentation, i, o, n, r, s, a, t, e, c);
            }, u.prototype[n.types.BOX | n.types.CONVEXPOLYHEDRON] = u.prototype.boxConvex = function (t, e, i, o, n, r, s, a, l, h, c) {
              return t.convexPolyhedronRepresentation.material = t.material, t.convexPolyhedronRepresentation.collisionResponse = t.collisionResponse, this.convexConvex(t.convexPolyhedronRepresentation, e, i, o, n, r, s, a, t, e, c);
            }, u.prototype[n.types.BOX | n.types.PARTICLE] = u.prototype.boxParticle = function (t, e, i, o, n, r, s, a, l, h, c) {
              return t.convexPolyhedronRepresentation.material = t.material, t.convexPolyhedronRepresentation.collisionResponse = t.collisionResponse, this.convexParticle(t.convexPolyhedronRepresentation, e, i, o, n, r, s, a, t, e, c);
            }, u.prototype[n.types.SPHERE] = u.prototype.sphereSphere = function (t, e, i, o, n, r, s, a, l, h, c) {
              if (c) return i.distanceSquared(o) < Math.pow(t.radius + e.radius, 2);var p = this.createContactEquation(s, a, t, e, l, h);o.vsub(i, p.ni), p.ni.normalize(), p.ri.copy(p.ni), p.rj.copy(p.ni), p.ri.mult(t.radius, p.ri), p.rj.mult(-e.radius, p.rj), p.ri.vadd(i, p.ri), p.ri.vsub(s.position, p.ri), p.rj.vadd(o, p.rj), p.rj.vsub(a.position, p.rj), this.result.push(p), this.createFrictionEquationsFromContact(p, this.frictionResult);
            };var b = new s(),
                x = new s(),
                _ = new s();u.prototype[n.types.PLANE | n.types.TRIMESH] = u.prototype.planeTrimesh = function (t, e, i, o, n, r, l, h, c, p, u) {
              var d = new s(),
                  y = b;y.set(0, 0, 1), n.vmult(y, y);for (var f = 0; f < e.vertices.length / 3; f++) {
                e.getVertex(f, d);var v = new s();v.copy(d), a.pointToWorldFrame(o, r, v, d);var m = x;if (d.vsub(i, m), y.dot(m) <= 0) {
                  if (u) return !0;var g = this.createContactEquation(l, h, t, e, c, p);g.ni.copy(y);var w = _;y.scale(m.dot(y), w), d.vsub(w, w), g.ri.copy(w), g.ri.vsub(l.position, g.ri), g.rj.copy(d), g.rj.vsub(h.position, g.rj), this.result.push(g), this.createFrictionEquationsFromContact(g, this.frictionResult);
                }
              }
            };var B = new s(),
                S = new s(),
                E = (new s(), new s()),
                M = new s(),
                C = new s(),
                A = new s(),
                z = new s(),
                F = new s(),
                T = new s(),
                R = new s(),
                P = new s(),
                q = new s(),
                I = new s(),
                V = new i(),
                O = [];u.prototype[n.types.SPHERE | n.types.TRIMESH] = u.prototype.sphereTrimesh = function (t, e, i, o, n, s, l, h, c, p, u) {
              var d = C,
                  y = A,
                  f = z,
                  v = F,
                  m = T,
                  g = R,
                  w = V,
                  b = M,
                  x = S,
                  _ = O;a.pointToLocalFrame(o, s, i, m);var k = t.radius;w.lowerBound.set(m.x - k, m.y - k, m.z - k), w.upperBound.set(m.x + k, m.y + k, m.z + k), e.getTrianglesInAABB(w, _);for (var N = E, j = t.radius * t.radius, L = 0; L < _.length; L++) {
                for (var W = 0; W < 3; W++) {
                  if (e.getVertex(e.indices[3 * _[L] + W], N), N.vsub(m, x), x.norm2() <= j) {
                    if (b.copy(N), a.pointToWorldFrame(o, s, b, N), N.vsub(i, x), u) return !0;(G = this.createContactEquation(l, h, t, e, c, p)).ni.copy(x), G.ni.normalize(), G.ri.copy(G.ni), G.ri.scale(t.radius, G.ri), G.ri.vadd(i, G.ri), G.ri.vsub(l.position, G.ri), G.rj.copy(N), G.rj.vsub(h.position, G.rj), this.result.push(G), this.createFrictionEquationsFromContact(G, this.frictionResult);
                  }
                }
              }for (L = 0; L < _.length; L++) {
                for (W = 0; W < 3; W++) {
                  e.getVertex(e.indices[3 * _[L] + W], d), e.getVertex(e.indices[3 * _[L] + (W + 1) % 3], y), y.vsub(d, f), m.vsub(y, g);var D = g.dot(f);m.vsub(d, g);var U = g.dot(f);if (U > 0 && D < 0 && (m.vsub(d, g), v.copy(f), v.normalize(), U = g.dot(v), v.scale(U, g), g.vadd(d, g), (Z = g.distanceTo(m)) < t.radius)) {
                    if (u) return !0;var G = this.createContactEquation(l, h, t, e, c, p);g.vsub(m, G.ni), G.ni.normalize(), G.ni.scale(t.radius, G.ri), a.pointToWorldFrame(o, s, g, g), g.vsub(h.position, G.rj), a.vectorToWorldFrame(s, G.ni, G.ni), a.vectorToWorldFrame(s, G.ri, G.ri), this.result.push(G), this.createFrictionEquationsFromContact(G, this.frictionResult);
                  }
                }
              }for (var H = P, K = q, Q = I, X = B, Y = (L = 0, _.length); L !== Y; L++) {
                e.getTriangleVertices(_[L], H, K, Q), e.getNormal(_[L], X), m.vsub(H, g);var Z = g.dot(X);if (X.scale(Z, g), m.vsub(g, g), Z = g.distanceTo(m), r.pointInTriangle(g, H, K, Q) && Z < t.radius) {
                  if (u) return !0;G = this.createContactEquation(l, h, t, e, c, p), g.vsub(m, G.ni), G.ni.normalize(), G.ni.scale(t.radius, G.ri), a.pointToWorldFrame(o, s, g, g), g.vsub(h.position, G.rj), a.vectorToWorldFrame(s, G.ni, G.ni), a.vectorToWorldFrame(s, G.ri, G.ri), this.result.push(G), this.createFrictionEquationsFromContact(G, this.frictionResult);
                }
              }_.length = 0;
            };var k = new s(),
                N = new s(),
                j = new s(),
                L = new s(),
                W = new s();u.prototype[n.types.SPHERE | n.types.PLANE] = u.prototype.spherePlane = function (t, e, i, o, n, r, s, a, l, h, c) {
              if (j.set(0, 0, 1), r.vmult(j, j), j.negate(j), j.normalize(), j.mult(t.radius, L), i.vsub(o, k), j.mult(j.dot(k), N), k.vsub(N, W), -k.dot(j) <= t.radius) {
                if (c) return !0;var p = this.createContactEquation(s, a, t, e, l, h);p.ni.copy(j), p.ri.copy(L), p.rj.copy(W);var u = p.ri,
                    d = p.rj;u.vadd(i, u), u.vsub(s.position, u), d.vadd(o, d), d.vsub(a.position, d), this.result.push(p), this.createFrictionEquationsFromContact(p, this.frictionResult);
              }return !1;
            };var D = new s(),
                U = new s(),
                G = new s();function H(t, e, i) {
              for (var o = null, n = t.length, r = 0; r !== n; r++) {
                var s = t[r],
                    a = D;t[(r + 1) % n].vsub(s, a);var l = U;a.cross(e, l);var h = G;i.vsub(s, h);var c = l.dot(h);if (!(null === o || c > 0 && !0 === o || c <= 0 && !1 === o)) return !1;null === o && (o = c > 0);
              }return !0;
            }var K = new s(),
                Q = new s(),
                X = new s(),
                Y = new s(),
                Z = [new s(), new s(), new s(), new s(), new s(), new s()],
                J = new s(),
                $ = new s(),
                tt = new s(),
                et = new s();u.prototype[n.types.SPHERE | n.types.BOX] = u.prototype.sphereBox = function (t, e, i, o, n, r, s, a, l, h, c) {
              var p = this.v3pool,
                  u = Z;i.vsub(o, K), e.getSideNormals(u, r);for (var d = t.radius, y = !1, f = $, v = tt, m = et, g = null, w = 0, b = 0, x = 0, _ = null, B = 0, S = u.length; B !== S && !1 === y; B++) {
                var E = Q;E.copy(u[B]);var M = E.norm();E.normalize();var C = K.dot(E);if (C < M + d && C > 0) {
                  var A = X,
                      z = Y;A.copy(u[(B + 1) % 3]), z.copy(u[(B + 2) % 3]);var F = A.norm(),
                      T = z.norm();A.normalize(), z.normalize();var R = K.dot(A),
                      P = K.dot(z);if (R < F && R > -F && P < T && P > -T) {
                    var q = Math.abs(C - M - d);if ((null === _ || q < _) && (_ = q, b = R, x = P, g = M, f.copy(E), v.copy(A), m.copy(z), w++, c)) return !0;
                  }
                }
              }if (w) {
                y = !0;var I = this.createContactEquation(s, a, t, e, l, h);f.mult(-d, I.ri), I.ni.copy(f), I.ni.negate(I.ni), f.mult(g, f), v.mult(b, v), f.vadd(v, f), m.mult(x, m), f.vadd(m, I.rj), I.ri.vadd(i, I.ri), I.ri.vsub(s.position, I.ri), I.rj.vadd(o, I.rj), I.rj.vsub(a.position, I.rj), this.result.push(I), this.createFrictionEquationsFromContact(I, this.frictionResult);
              }for (var V = p.get(), O = J, k = 0; 2 !== k && !y; k++) {
                for (var N = 0; 2 !== N && !y; N++) {
                  for (var j = 0; 2 !== j && !y; j++) {
                    if (V.set(0, 0, 0), k ? V.vadd(u[0], V) : V.vsub(u[0], V), N ? V.vadd(u[1], V) : V.vsub(u[1], V), j ? V.vadd(u[2], V) : V.vsub(u[2], V), o.vadd(V, O), O.vsub(i, O), O.norm2() < d * d) {
                      if (c) return !0;y = !0, (I = this.createContactEquation(s, a, t, e, l, h)).ri.copy(O), I.ri.normalize(), I.ni.copy(I.ri), I.ri.mult(d, I.ri), I.rj.copy(V), I.ri.vadd(i, I.ri), I.ri.vsub(s.position, I.ri), I.rj.vadd(o, I.rj), I.rj.vsub(a.position, I.rj), this.result.push(I), this.createFrictionEquationsFromContact(I, this.frictionResult);
                    }
                  }
                }
              }p.release(V), V = null;var L = p.get(),
                  W = p.get(),
                  D = (I = p.get(), p.get()),
                  U = (q = p.get(), u.length);for (k = 0; k !== U && !y; k++) {
                for (N = 0; N !== U && !y; N++) {
                  if (k % 3 != N % 3) {
                    u[N].cross(u[k], L), L.normalize(), u[k].vadd(u[N], W), I.copy(i), I.vsub(W, I), I.vsub(o, I);var G = I.dot(L);for (L.mult(G, D), j = 0; j === k % 3 || j === N % 3;) {
                      j++;
                    }q.copy(i), q.vsub(D, q), q.vsub(W, q), q.vsub(o, q);var H = Math.abs(G),
                        it = q.norm();if (H < u[j].norm() && it < d) {
                      if (c) return !0;y = !0;var ot = this.createContactEquation(s, a, t, e, l, h);W.vadd(D, ot.rj), ot.rj.copy(ot.rj), q.negate(ot.ni), ot.ni.normalize(), ot.ri.copy(ot.rj), ot.ri.vadd(o, ot.ri), ot.ri.vsub(i, ot.ri), ot.ri.normalize(), ot.ri.mult(d, ot.ri), ot.ri.vadd(i, ot.ri), ot.ri.vsub(s.position, ot.ri), ot.rj.vadd(o, ot.rj), ot.rj.vsub(a.position, ot.rj), this.result.push(ot), this.createFrictionEquationsFromContact(ot, this.frictionResult);
                    }
                  }
                }
              }p.release(L, W, I, D, q);
            };var it = new s(),
                ot = new s(),
                nt = new s(),
                rt = new s(),
                st = new s(),
                at = new s(),
                lt = new s(),
                ht = new s(),
                ct = new s(),
                pt = new s();u.prototype[n.types.SPHERE | n.types.CONVEXPOLYHEDRON] = u.prototype.sphereConvex = function (t, e, i, o, n, r, s, a, l, h, c) {
              var p = this.v3pool;i.vsub(o, it);for (var u = e.faceNormals, d = e.faces, y = e.vertices, f = t.radius, v = 0; v !== y.length; v++) {
                var m = y[v],
                    g = st;r.vmult(m, g), o.vadd(g, g);var w = rt;if (g.vsub(i, w), w.norm2() < f * f) return !!c || (b = !0, (q = this.createContactEquation(s, a, t, e, l, h)).ri.copy(w), q.ri.normalize(), q.ni.copy(q.ri), q.ri.mult(f, q.ri), g.vsub(o, q.rj), q.ri.vadd(i, q.ri), q.ri.vsub(s.position, q.ri), q.rj.vadd(o, q.rj), q.rj.vsub(a.position, q.rj), this.result.push(q), void this.createFrictionEquationsFromContact(q, this.frictionResult));
              }for (var b = !1, x = (v = 0, d.length); v !== x && !1 === b; v++) {
                var _ = u[v],
                    B = d[v],
                    S = at;r.vmult(_, S);var E = lt;r.vmult(y[B[0]], E), E.vadd(o, E);var M = ht;S.mult(-f, M), i.vadd(M, M);var C = ct;M.vsub(E, C);var A = C.dot(S),
                    z = pt;if (i.vsub(E, z), A < 0 && z.dot(S) > 0) {
                  for (var F = [], T = 0, R = B.length; T !== R; T++) {
                    var P = p.get();r.vmult(y[B[T]], P), o.vadd(P, P), F.push(P);
                  }if (H(F, S, i)) {
                    if (c) return !0;b = !0;var q = this.createContactEquation(s, a, t, e, l, h);S.mult(-f, q.ri), S.negate(q.ni);var I = p.get();S.mult(-A, I);var V = p.get();S.mult(-f, V), i.vsub(o, q.rj), q.rj.vadd(V, q.rj), q.rj.vadd(I, q.rj), q.rj.vadd(o, q.rj), q.rj.vsub(a.position, q.rj), q.ri.vadd(i, q.ri), q.ri.vsub(s.position, q.ri), p.release(I), p.release(V), this.result.push(q), this.createFrictionEquationsFromContact(q, this.frictionResult), T = 0;for (var O = F.length; T !== O; T++) {
                      p.release(F[T]);
                    }return;
                  }for (T = 0; T !== B.length; T++) {
                    var k = p.get(),
                        N = p.get();r.vmult(y[B[(T + 1) % B.length]], k), r.vmult(y[B[(T + 2) % B.length]], N), o.vadd(k, k), o.vadd(N, N);var j = ot;N.vsub(k, j);var L = nt;j.unit(L);var W = p.get(),
                        D = p.get();i.vsub(k, D);var U = D.dot(L);L.mult(U, W), W.vadd(k, W);var G = p.get();if (W.vsub(i, G), U > 0 && U * U < j.norm2() && G.norm2() < f * f) {
                      if (c) return !0;for (q = this.createContactEquation(s, a, t, e, l, h), W.vsub(o, q.rj), W.vsub(i, q.ni), q.ni.normalize(), q.ni.mult(f, q.ri), q.rj.vadd(o, q.rj), q.rj.vsub(a.position, q.rj), q.ri.vadd(i, q.ri), q.ri.vsub(s.position, q.ri), this.result.push(q), this.createFrictionEquationsFromContact(q, this.frictionResult), T = 0, O = F.length; T !== O; T++) {
                        p.release(F[T]);
                      }return p.release(k), p.release(N), p.release(W), p.release(G), void p.release(D);
                    }p.release(k), p.release(N), p.release(W), p.release(G), p.release(D);
                  }for (T = 0, O = F.length; T !== O; T++) {
                    p.release(F[T]);
                  }
                }
              }
            }, new s(), new s(), u.prototype[n.types.PLANE | n.types.BOX] = u.prototype.planeBox = function (t, e, i, o, n, r, s, a, l, h, c) {
              return e.convexPolyhedronRepresentation.material = e.material, e.convexPolyhedronRepresentation.collisionResponse = e.collisionResponse, e.convexPolyhedronRepresentation.id = e.id, this.planeConvex(t, e.convexPolyhedronRepresentation, i, o, n, r, s, a, t, e, c);
            };var ut = new s(),
                dt = new s(),
                yt = new s(),
                ft = new s();u.prototype[n.types.PLANE | n.types.CONVEXPOLYHEDRON] = u.prototype.planeConvex = function (t, e, i, o, n, r, s, a, l, h, c) {
              var p = ut,
                  u = dt;u.set(0, 0, 1), n.vmult(u, u);for (var d = 0, y = yt, f = 0; f !== e.vertices.length; f++) {
                if (p.copy(e.vertices[f]), r.vmult(p, p), o.vadd(p, p), p.vsub(i, y), u.dot(y) <= 0) {
                  if (c) return !0;var v = this.createContactEquation(s, a, t, e, l, h),
                      m = ft;u.mult(u.dot(y), m), p.vsub(m, m), m.vsub(i, v.ri), v.ni.copy(u), p.vsub(o, v.rj), v.ri.vadd(i, v.ri), v.ri.vsub(s.position, v.ri), v.rj.vadd(o, v.rj), v.rj.vsub(a.position, v.rj), this.result.push(v), d++, this.enableFrictionReduction || this.createFrictionEquationsFromContact(v, this.frictionResult);
                }
              }this.enableFrictionReduction && d && this.createFrictionFromAverage(d);
            };var vt = new s(),
                mt = new s();u.prototype[n.types.CONVEXPOLYHEDRON] = u.prototype.convexConvex = function (t, e, i, o, n, r, s, a, l, h, c, p, u) {
              var d = vt;if (!(i.distanceTo(o) > t.boundingSphereRadius + e.boundingSphereRadius) && t.findSeparatingAxis(e, i, n, o, r, d, p, u)) {
                var y = [],
                    f = mt;t.clipAgainstHull(i, n, e, o, r, d, -100, 100, y);for (var v = 0, m = 0; m !== y.length; m++) {
                  if (c) return !0;var g = this.createContactEquation(s, a, t, e, l, h),
                      w = g.ri,
                      b = g.rj;d.negate(g.ni), y[m].normal.negate(f), f.mult(y[m].depth, f), y[m].point.vadd(f, w), b.copy(y[m].point), w.vsub(i, w), b.vsub(o, b), w.vadd(i, w), w.vsub(s.position, w), b.vadd(o, b), b.vsub(a.position, b), this.result.push(g), v++, this.enableFrictionReduction || this.createFrictionEquationsFromContact(g, this.frictionResult);
                }this.enableFrictionReduction && v && this.createFrictionFromAverage(v);
              }
            };var gt = new s(),
                wt = new s(),
                bt = new s();u.prototype[n.types.PLANE | n.types.PARTICLE] = u.prototype.planeParticle = function (t, e, i, o, n, r, s, a, l, h, c) {
              var p = gt;p.set(0, 0, 1), s.quaternion.vmult(p, p);var u = wt;if (o.vsub(s.position, u), p.dot(u) <= 0) {
                if (c) return !0;var d = this.createContactEquation(a, s, e, t, l, h);d.ni.copy(p), d.ni.negate(d.ni), d.ri.set(0, 0, 0);var y = bt;p.mult(p.dot(o), y), o.vsub(y, y), d.rj.copy(y), this.result.push(d), this.createFrictionEquationsFromContact(d, this.frictionResult);
              }
            };var xt = new s();u.prototype[n.types.PARTICLE | n.types.SPHERE] = u.prototype.sphereParticle = function (t, e, i, o, n, r, s, a, l, h, c) {
              var p = xt;if (p.set(0, 0, 1), o.vsub(i, p), p.norm2() <= t.radius * t.radius) {
                if (c) return !0;var u = this.createContactEquation(a, s, e, t, l, h);p.normalize(), u.rj.copy(p), u.rj.mult(t.radius, u.rj), u.ni.copy(p), u.ni.negate(u.ni), u.ri.set(0, 0, 0), this.result.push(u), this.createFrictionEquationsFromContact(u, this.frictionResult);
              }
            };var _t = new l(),
                Bt = new s(),
                St = (new s(), new s()),
                Et = new s(),
                Mt = new s();u.prototype[n.types.PARTICLE | n.types.CONVEXPOLYHEDRON] = u.prototype.convexParticle = function (t, e, i, o, n, r, s, a, l, h, c) {
              var p = -1,
                  u = St,
                  d = Mt,
                  y = null,
                  f = Bt;if (f.copy(o), f.vsub(i, f), n.conjugate(_t), _t.vmult(f, f), t.pointIsInside(f)) {
                t.worldVerticesNeedsUpdate && t.computeWorldVertices(i, n), t.worldFaceNormalsNeedsUpdate && t.computeWorldFaceNormals(n);for (var v = 0, m = t.faces.length; v !== m; v++) {
                  var g = [t.worldVertices[t.faces[v][0]]],
                      w = t.worldFaceNormals[v];o.vsub(g[0], Et);var b = -w.dot(Et);if (null === y || Math.abs(b) < Math.abs(y)) {
                    if (c) return !0;y = b, p = v, u.copy(w);
                  }
                }if (-1 !== p) {
                  var x = this.createContactEquation(a, s, e, t, l, h);u.mult(y, d), d.vadd(o, d), d.vsub(i, d), x.rj.copy(d), u.negate(x.ni), x.ri.set(0, 0, 0);var _ = x.ri,
                      B = x.rj;_.vadd(o, _), _.vsub(a.position, _), B.vadd(i, B), B.vsub(s.position, B), this.result.push(x), this.createFrictionEquationsFromContact(x, this.frictionResult);
                } else console.warn("Point found inside convex, but did not find penetrating face!");
              }
            }, u.prototype[n.types.BOX | n.types.HEIGHTFIELD] = u.prototype.boxHeightfield = function (t, e, i, o, n, r, s, a, l, h, c) {
              return t.convexPolyhedronRepresentation.material = t.material, t.convexPolyhedronRepresentation.collisionResponse = t.collisionResponse, this.convexHeightfield(t.convexPolyhedronRepresentation, e, i, o, n, r, s, a, t, e, c);
            };var Ct = new s(),
                At = new s(),
                zt = [0];u.prototype[n.types.CONVEXPOLYHEDRON | n.types.HEIGHTFIELD] = u.prototype.convexHeightfield = function (t, e, i, o, n, r, s, l, h, c, p) {
              var u = e.data,
                  d = e.elementSize,
                  y = t.boundingSphereRadius,
                  f = At,
                  v = zt,
                  m = Ct;a.pointToLocalFrame(o, r, i, m);var g = Math.floor((m.x - y) / d) - 1,
                  w = Math.ceil((m.x + y) / d) + 1,
                  b = Math.floor((m.y - y) / d) - 1,
                  x = Math.ceil((m.y + y) / d) + 1;if (!(w < 0 || x < 0 || g > u.length || b > u[0].length)) {
                g < 0 && (g = 0), w < 0 && (w = 0), b < 0 && (b = 0), x < 0 && (x = 0), g >= u.length && (g = u.length - 1), w >= u.length && (w = u.length - 1), x >= u[0].length && (x = u[0].length - 1), b >= u[0].length && (b = u[0].length - 1);var _ = [];e.getRectMinMax(g, b, w, x, _);var B = _[0],
                    S = _[1];if (!(m.z - y > S || m.z + y < B)) for (var E = g; E < w; E++) {
                  for (var M = b; M < x; M++) {
                    var C = !1;if (e.getConvexTrianglePillar(E, M, !1), a.pointToWorldFrame(o, r, e.pillarOffset, f), i.distanceTo(f) < e.pillarConvex.boundingSphereRadius + t.boundingSphereRadius && (C = this.convexConvex(t, e.pillarConvex, i, f, n, r, s, l, h, c, p, v, null)), p && C) return !0;if (e.getConvexTrianglePillar(E, M, !0), a.pointToWorldFrame(o, r, e.pillarOffset, f), i.distanceTo(f) < e.pillarConvex.boundingSphereRadius + t.boundingSphereRadius && (C = this.convexConvex(t, e.pillarConvex, i, f, n, r, s, l, h, c, p, v, null)), p && C) return !0;
                  }
                }
              }
            };var Ft = new s(),
                Tt = new s();u.prototype[n.types.SPHERE | n.types.HEIGHTFIELD] = u.prototype.sphereHeightfield = function (t, e, i, o, n, r, s, l, h, c, p) {
              var u = e.data,
                  d = t.radius,
                  y = e.elementSize,
                  f = Tt,
                  v = Ft;a.pointToLocalFrame(o, r, i, v);var m = Math.floor((v.x - d) / y) - 1,
                  g = Math.ceil((v.x + d) / y) + 1,
                  w = Math.floor((v.y - d) / y) - 1,
                  b = Math.ceil((v.y + d) / y) + 1;if (!(g < 0 || b < 0 || m > u.length || w > u[0].length)) {
                m < 0 && (m = 0), g < 0 && (g = 0), w < 0 && (w = 0), b < 0 && (b = 0), m >= u.length && (m = u.length - 1), g >= u.length && (g = u.length - 1), b >= u[0].length && (b = u[0].length - 1), w >= u[0].length && (w = u[0].length - 1);var x = [];e.getRectMinMax(m, w, g, b, x);var _ = x[0],
                    B = x[1];if (!(v.z - d > B || v.z + d < _)) for (var S = this.result, E = m; E < g; E++) {
                  for (var M = w; M < b; M++) {
                    var C = S.length,
                        A = !1;if (e.getConvexTrianglePillar(E, M, !1), a.pointToWorldFrame(o, r, e.pillarOffset, f), i.distanceTo(f) < e.pillarConvex.boundingSphereRadius + t.boundingSphereRadius && (A = this.sphereConvex(t, e.pillarConvex, i, f, n, r, s, l, t, e, p)), p && A) return !0;if (e.getConvexTrianglePillar(E, M, !0), a.pointToWorldFrame(o, r, e.pillarOffset, f), i.distanceTo(f) < e.pillarConvex.boundingSphereRadius + t.boundingSphereRadius && (A = this.sphereConvex(t, e.pillarConvex, i, f, n, r, s, l, t, e, p)), p && A) return !0;if (S.length - C > 2) return;
                  }
                }
              }
            };
          }, { "../collision/AABB": 3, "../collision/Ray": 10, "../equations/ContactEquation": 20, "../equations/FrictionEquation": 22, "../math/Quaternion": 30, "../math/Transform": 31, "../math/Vec3": 32, "../objects/Body": 33, "../shapes/ConvexPolyhedron": 40, "../shapes/Shape": 45, "../solver/Solver": 49, "../utils/Vec3Pool": 56 }], 58: [function (t, e) {
            e.exports = g, t("../shapes/Shape");var i = t("../math/Vec3"),
                o = t("../math/Quaternion"),
                n = t("../solver/GSSolver"),
                r = (t("../equations/ContactEquation"), t("../equations/FrictionEquation"), t("./Narrowphase")),
                s = t("../utils/EventTarget"),
                a = t("../collision/ArrayCollisionMatrix"),
                l = t("../collision/ObjectCollisionMatrix"),
                h = t("../collision/OverlapKeeper"),
                c = t("../material/Material"),
                p = t("../material/ContactMaterial"),
                u = t("../objects/Body"),
                d = t("../utils/TupleDictionary"),
                y = t("../collision/RaycastResult"),
                f = t("../collision/AABB"),
                v = t("../collision/Ray"),
                m = t("../collision/NaiveBroadphase");function g(t) {
              t = t || {}, s.apply(this), this.dt = -1, this.allowSleep = !!t.allowSleep, this.contacts = [], this.frictionEquations = [], this.quatNormalizeSkip = void 0 !== t.quatNormalizeSkip ? t.quatNormalizeSkip : 0, this.quatNormalizeFast = void 0 !== t.quatNormalizeFast && t.quatNormalizeFast, this.time = 0, this.timeFixed = 0, this.stepnumber = 0, this.default_dt = 1 / 60, this.nextId = 0, this.gravity = new i(), t.gravity && this.gravity.copy(t.gravity), this.broadphase = void 0 !== t.broadphase ? t.broadphase : new m(), this.bodies = [], this.solver = void 0 !== t.solver ? t.solver : new n(), this.constraints = [], this.narrowphase = new r(this), this.collisionMatrix = new a(), this.collisionMatrixPrevious = new a(), this.bodyOverlapKeeper = new h(), this.shapeOverlapKeeper = new h(), this.materials = [], this.contactmaterials = [], this.contactMaterialTable = new d(), this.defaultMaterial = new c("default"), this.defaultContactMaterial = new p(this.defaultMaterial, this.defaultMaterial, { friction: .3, restitution: 0 }), this.doProfiling = !1, this.profile = { solve: 0, makeContactConstraints: 0, broadphase: 0, integrate: 0, narrowphase: 0 }, this.accumulator = 0, this.subsystems = [], this.addBodyEvent = { type: "addBody", body: null }, this.removeBodyEvent = { type: "removeBody", body: null }, this.idToBodyMap = {}, this.broadphase.setWorld(this), this.substeps = 0, this.cm = new l(), this.tm = new l(), this.triggerDic = new d(), this.oldTriggerDic = new d(), this.contactsDic = new d(), this.oldContactsDic = new d();
            }g.idToBodyMap = {}, g.idToShapeMap = {}, g.prototype = new s(), new f();var w = new v();if (g.prototype.getContactMaterial = function (t, e) {
              return this.contactMaterialTable.get(t.id, e.id);
            }, g.prototype.numObjects = function () {
              return this.bodies.length;
            }, g.prototype.collisionMatrixTick = function () {
              var t = this.collisionMatrixPrevious;this.collisionMatrixPrevious = this.collisionMatrix, this.collisionMatrix = t, this.collisionMatrix.reset(), this.bodyOverlapKeeper.tick(), this.shapeOverlapKeeper.tick();
            }, g.prototype.add = g.prototype.addBody = function (t) {
              g.SLEEPING = !1, -1 === this.bodies.indexOf(t) && (t.index = this.bodies.length, this.bodies.push(t), t.world = this, t.initPosition.copy(t.position), t.initVelocity.copy(t.velocity), t.timeLastSleepy = this.time, t instanceof u && (t.initAngularVelocity.copy(t.angularVelocity), t.initQuaternion.copy(t.quaternion)), this.collisionMatrix.setNumObjects(this.bodies.length), this.addBodyEvent.body = t, this.cm.setNumObjects(this.bodies.length), g.idToBodyMap[t.id] = t, this.dispatchEvent(this.addBodyEvent));
            }, g.prototype.addConstraint = function (t) {
              g.SLEEPING = !1, this.constraints.push(t);
            }, g.prototype.removeConstraint = function (t) {
              g.SLEEPING = !1;var e = this.constraints.indexOf(t);-1 !== e && this.constraints.splice(e, 1);
            }, g.prototype.rayTest = function (t, e, i) {
              i instanceof y ? this.raycastClosest(t, e, { skipBackfaces: !0 }, i) : this.raycastAll(t, e, { skipBackfaces: !0 }, i);
            }, g.prototype.raycastAll = function (t, e, i, o) {
              return i.mode = v.ALL, i.from = t, i.to = e, i.callback = o, w.intersectWorld(this, i);
            }, g.prototype.raycastAny = function (t, e, i, o) {
              return i.mode = v.ANY, i.from = t, i.to = e, i.result = o, w.intersectWorld(this, i);
            }, g.prototype.raycastClosest = function (t, e, i, o) {
              return i.mode = v.CLOSEST, i.from = t, i.to = e, i.result = o, w.intersectWorld(this, i);
            }, g.prototype.remove = function (t) {
              g.SLEEPING = !1, t.world = null;var e = this.bodies.length - 1,
                  i = this.bodies,
                  o = i.indexOf(t);if (-1 !== o) {
                i.splice(o, 1);for (var n = 0; n !== i.length; n++) {
                  i[n].index = n;
                }this.collisionMatrix.setNumObjects(e), this.removeBodyEvent.body = t, delete g.idToBodyMap[t.id], this.cm.setNumObjects(e), this.dispatchEvent(this.removeBodyEvent);
              }
            }, g.prototype.removeBody = g.prototype.remove, g.prototype.getBodyById = function (t) {
              return g.idToBodyMap[t];
            }, g.prototype.getShapeById = function (t) {
              return g.idToShapeMap[t];
            }, g.prototype.addMaterial = function (t) {
              this.materials.push(t);
            }, g.prototype.addContactMaterial = function (t) {
              this.contactmaterials.push(t), this.contactMaterialTable.set(t.materials[0].id, t.materials[1].id, t);
            }, "undefined" == typeof performance && (performance = {}), !performance.now) {
              var b = Date.now();performance.timing && performance.timing.navigationStart && (b = performance.timing.navigationStart), performance.now = function () {
                return Date.now() - b;
              };
            }new i(), g.prototype.step = function (t, e, i) {
              if (i = i || 10, 0 === (e = e || 0)) this.internalStep(t), this.time += t, this.substeps = 1;else {
                for (this.accumulator += e, this.substeps = 0; this.accumulator >= t && this.substeps < i;) {
                  this.internalStep(t), this.accumulator -= t, this.substeps++;
                }for (var o = this.accumulator % t / t, n = 0; n !== this.bodies.length; n++) {
                  var r = this.bodies[n];r.previousPosition.lerp(r.position, o, r.interpolatedPosition), r.previousQuaternion.slerp(r.quaternion, o, r.interpolatedQuaternion), r.previousQuaternion.normalize();
                }this.time += e;
              }
            };var x,
                _,
                B,
                S,
                E,
                M,
                C = { type: "postStep" },
                A = { type: "preStep" },
                z = { type: "collide", body: null, contact: null },
                F = [],
                T = [],
                R = [],
                P = [];new i(), new i(), new i(), new i(), new i(), new i(), new i(), new i(), new i(), new o(), new o(), new o(), new i(), g.prototype.internalStep = function (t) {
              this.dt = t;var e,
                  i = this.contacts,
                  o = R,
                  n = P,
                  r = this.numObjects(),
                  s = this.bodies,
                  a = this.solver,
                  l = this.gravity,
                  h = this.doProfiling,
                  c = this.profile,
                  p = u.DYNAMIC,
                  d = this.constraints,
                  y = T,
                  f = (l.norm(), l.x),
                  v = l.y,
                  m = l.z,
                  w = 0;for (h && (e = performance.now()), w = 0; w !== r; w++) {
                if ((O = s[w]).useGravity && O.type === p) {
                  var b = O.force,
                      x = O.mass;b.x += x * f, b.y += x * v, b.z += x * m;
                }
              }w = 0;for (var _ = this.subsystems.length; w !== _; w++) {
                this.subsystems[w].update();
              }h && (e = performance.now()), o.length = 0, n.length = 0, this.broadphase.collisionPairs(this, o, n), h && (c.broadphase = performance.now() - e);var B = d.length;for (w = 0; w !== B; w++) {
                if (!(L = d[w]).collideConnected) for (var S = o.length - 1; S >= 0; S -= 1) {
                  (L.bodyA === o[S] && L.bodyB === n[S] || L.bodyB === o[S] && L.bodyA === n[S]) && (o.splice(S, 1), n.splice(S, 1));
                }
              }this.collisionMatrixTick(), h && (e = performance.now());var E = F,
                  M = i.length;for (w = 0; w !== M; w++) {
                E.push(i[w]);
              }i.length = 0;var q = this.frictionEquations.length;for (w = 0; w !== q; w++) {
                y.push(this.frictionEquations[w]);
              }if (this.frictionEquations.length = 0, this.narrowphase.getContacts(o, n, this, i, E, this.frictionEquations, y), 0 != i.length || !g.SLEEPING) {
                for (h && (c.narrowphase = performance.now() - e), h && (e = performance.now()), w = 0; w < this.frictionEquations.length; w++) {
                  a.addEquation(this.frictionEquations[w]);
                }for (var I = i.length, V = 0; V !== I; V++) {
                  var O = (L = i[V]).bi,
                      k = L.bj,
                      N = L.si,
                      j = L.sj;N.material && j.material ? N.material.restitution >= 0 && j.material.restitution >= 0 && (L.restitution = N.material.restitution * j.material.restitution) : O.material && k.material && O.material.restitution >= 0 && k.material.restitution >= 0 && (L.restitution = O.material.restitution * k.material.restitution), a.addEquation(L), O.allowSleep && O.type === u.DYNAMIC && O.sleepState === u.SLEEPING && k.sleepState === u.AWAKE && k.type !== u.STATIC && k.velocity.norm2() + k.angularVelocity.norm2() >= 2 * Math.pow(k.sleepSpeedLimit, 2) && (O._wakeUpAfterNarrowphase = !0), k.allowSleep && k.type === u.DYNAMIC && k.sleepState === u.SLEEPING && O.sleepState === u.AWAKE && O.type !== u.STATIC && O.velocity.norm2() + O.angularVelocity.norm2() >= 2 * Math.pow(O.sleepSpeedLimit, 2) && (k._wakeUpAfterNarrowphase = !0), this.collisionMatrix.set(O, k, !0), this.collisionMatrixPrevious.get(O, k) || (z.body = k, z.contact = L, O.dispatchEvent(z), z.body = O, k.dispatchEvent(z)), this.bodyOverlapKeeper.set(O.id, k.id), this.shapeOverlapKeeper.set(N.id, j.id);
                }for (this.emitContactEvents(), h && (c.makeContactConstraints = performance.now() - e, e = performance.now()), w = 0; w !== r; w++) {
                  (O = s[w])._wakeUpAfterNarrowphase && (O.wakeUp(), O._wakeUpAfterNarrowphase = !1);
                }for (B = d.length, w = 0; w !== B; w++) {
                  var L;(L = d[w]).update(), S = 0;for (var W = L.equations.length; S !== W; S++) {
                    var D = L.equations[S];a.addEquation(D);
                  }
                }a.solve(t, this), h && (c.solve = performance.now() - e), a.removeAllEquations();var U = Math.pow;for (w = 0; w !== r; w++) {
                  if ((O = s[w]).type & p) {
                    var G = U(1 - O.linearDamping, t),
                        H = O.velocity;H.mult(G, H);var K = O.angularVelocity;if (K) {
                      var Q = U(1 - O.angularDamping, t);K.mult(Q, K);
                    }
                  }
                }for (this.dispatchEvent(A), w = 0; w !== r; w++) {
                  (O = s[w]).preStep && O.preStep.call(O);
                }h && (e = performance.now());var X = this.stepnumber % (this.quatNormalizeSkip + 1) == 0,
                    Y = this.quatNormalizeFast;for (w = 0; w !== r; w++) {
                  s[w].integrate(t, X, Y);
                }for (this.clearForces(), this.broadphase.dirty = !0, h && (c.integrate = performance.now() - e), this.time += t, this.timeFixed += t, this.stepnumber += 1, this.dispatchEvent(C), w = 0; w !== r; w++) {
                  var Z = (O = s[w]).postStep;Z && Z.call(O);
                }if (this.allowSleep) {
                  for (w = 0; w !== r; w++) {
                    s[w].sleepTick(this.time);
                  }for (g.SLEEPING = !0, w = 0; w !== r; w++) {
                    if ((O = s[w]).type != u.STATIC && !O.isSleeping()) {
                      g.SLEEPING = !1;break;
                    }
                  }
                } else g.SLEEPING = !1;
              }
            }, g.prototype.emitContactEvents = (x = [], _ = [], B = { type: "beginContact", bodyA: null, bodyB: null }, S = { type: "endContact", bodyA: null, bodyB: null }, E = { type: "beginShapeContact", bodyA: null, bodyB: null, shapeA: null, shapeB: null }, M = { type: "endShapeContact", bodyA: null, bodyB: null, shapeA: null, shapeB: null }, function () {
              var t = this.hasAnyEventListener("beginContact"),
                  e = this.hasAnyEventListener("endContact");if ((t || e) && this.bodyOverlapKeeper.getDiff(x, _), t) {
                for (var i = 0, o = x.length; i < o; i += 2) {
                  B.bodyA = this.getBodyById(x[i]), B.bodyB = this.getBodyById(x[i + 1]), this.dispatchEvent(B);
                }B.bodyA = B.bodyB = null;
              }if (e) {
                for (i = 0, o = _.length; i < o; i += 2) {
                  S.bodyA = this.getBodyById(_[i]), S.bodyB = this.getBodyById(_[i + 1]), this.dispatchEvent(S);
                }S.bodyA = S.bodyB = null;
              }x.length = _.length = 0;var n = this.hasAnyEventListener("beginShapeContact"),
                  r = this.hasAnyEventListener("endShapeContact");if ((n || r) && this.shapeOverlapKeeper.getDiff(x, _), n) {
                for (i = 0, o = x.length; i < o; i += 2) {
                  var s = this.getShapeById(x[i]),
                      a = this.getShapeById(x[i + 1]);E.shapeA = s, E.shapeB = a, E.bodyA = s.body, E.bodyB = a.body, this.dispatchEvent(E);
                }E.bodyA = E.bodyB = E.shapeA = E.shapeB = null;
              }if (r) {
                for (i = 0, o = _.length; i < o; i += 2) {
                  s = this.getShapeById(_[i]), a = this.getShapeById(_[i + 1]), M.shapeA = s, M.shapeB = a, M.bodyA = s.body, M.bodyB = a.body, this.dispatchEvent(M);
                }M.bodyA = M.bodyB = M.shapeA = M.shapeB = null;
              }
            }), g.prototype.clearForces = function () {
              for (var t = this.bodies, e = t.length, i = 0; i !== e; i++) {
                var o = t[i];o.force, o.torque, o.force.set(0, 0, 0), o.torque.set(0, 0, 0);
              }
            };var q = { type: "cc-trigger", event: "", selfBody: null, otherBody: null, selfShape: null, otherShape: null },
                I = { type: "cc-collide", event: "", body: null, selfShape: null, otherShape: null, contacts: null },
                V = [];g.prototype.emitTriggeredEvents = function () {
              if (0 != this.substeps) {
                for (var t, e, i = this.triggerDic.getLength(); i--;) {
                  if (t = this.triggerDic.getKeyByIndex(i), null != (e = this.triggerDic.getDataByKey(t))) {
                    var o = e.si,
                        n = e.sj;this.tm.get(o, n) ? q.event = "onTriggerStay" : (this.tm.set(o, n, !0), q.event = "onTriggerEnter"), q.selfShape = o, q.otherShape = n, q.selfBody = o.body, q.otherBody = n.body, o.dispatchEvent(q), q.selfShape = n, q.otherShape = o, q.selfBody = n.body, q.otherBody = o.body, n.dispatchEvent(q);
                  }
                }for (i = this.oldTriggerDic.getLength(); i > 0;) {
                  i--, t = this.oldTriggerDic.getKeyByIndex(i), null == this.triggerDic.getDataByKey(t) && null != (e = this.oldTriggerDic.getDataByKey(t)) && (o = e.si, n = e.sj, this.tm.set(o, n, !1), this.oldTriggerDic.del(o.id, n.id) && i--, q.event = "onTriggerExit", q.selfShape = o, q.otherShape = n, q.selfBody = o.body, q.otherBody = n.body, o.dispatchEvent(q), q.selfShape = n, q.otherShape = o, q.selfBody = n.body, q.otherBody = o.body, n.dispatchEvent(q));
                }this.triggerDic.reset();
              }
            }, g.prototype.emitCollisionEvents = function () {
              if (0 != this.substeps) {
                for (var t, e, i = this.contacts, o = this.contacts.length; o--;) {
                  var n = (c = i[o]).si,
                      r = c.sj,
                      s = this.contactsDic.get(n.id, r.id);null == s && (s = this.contactsDic.set(n.id, r.id, [])), s.push(c);
                }for (o = this.contactsDic.getLength(); o--;) {
                  if (t = this.contactsDic.getKeyByIndex(o), null != (e = this.contactsDic.getDataByKey(t))) {
                    n = e[0].si, r = e[0].sj;var a = n.body,
                        l = r.body;this.cm.get(a, l) ? I.event = "onCollisionStay" : (this.cm.set(a, l, !0), I.event = "onCollisionEnter"), I.bi = a, I.contact = e[0], I.contacts = e, I.body = l, I.selfShape = n, I.otherShape = r, a.dispatchEvent(I), I.body = a, I.selfShape = r, I.otherShape = n, l.dispatchEvent(I);
                  }
                }var h = V;for (o = h.length; o--;) {
                  var c;n = (c = h[o]).si, r = c.sj, null == this.oldContactsDic.get(n.id, r.id) && this.oldContactsDic.set(n.id, r.id, c);
                }for (o = this.oldContactsDic.getLength(); o--;) {
                  t = this.oldContactsDic.getKeyByIndex(o), null == this.contactsDic.getDataByKey(t) && (n = (e = this.oldContactsDic.getDataByKey(t)).si, r = e.sj, a = n.body, l = r.body, this.cm.get(a, l) && (a.isSleeping() && l.isSleeping() || (this.cm.set(a, l, !1), I.bi = a, I.contact = e, I.event = "onCollisionExit", I.body = l, I.selfShape = n, I.otherShape = r, I.contacts.length = 0, I.contacts.push(e), a.dispatchEvent(I), I.body = a, I.selfShape = r, I.otherShape = n, l.dispatchEvent(I))));
                }this.contactsDic.reset(), this.oldContactsDic.reset(), F = V, V = this.contacts.slice(), this.contacts.length = 0;
              }
            };
          }, { "../collision/AABB": 3, "../collision/ArrayCollisionMatrix": 4, "../collision/NaiveBroadphase": 7, "../collision/ObjectCollisionMatrix": 8, "../collision/OverlapKeeper": 9, "../collision/Ray": 10, "../collision/RaycastResult": 11, "../equations/ContactEquation": 20, "../equations/FrictionEquation": 22, "../material/ContactMaterial": 25, "../material/Material": 26, "../math/Quaternion": 30, "../math/Vec3": 32, "../objects/Body": 33, "../shapes/Shape": 45, "../solver/GSSolver": 48, "../utils/EventTarget": 51, "../utils/TupleDictionary": 54, "./Narrowphase": 57 }] }, {}, [2])(2);
      });
    }).call(this, "undefined" != typeof global ? global : "undefined" != typeof self ? self : "undefined" != typeof window ? window : {});
  }, {}] }, {}, [10, 9]);
});
define("src/assets/Script/Common/Libs/zlib/zlib.min.js", function(require, module, exports){
(function () {
  "use strict";
  function r(r) {
    throw r;
  }var t = void 0,
      e = !0,
      i = this;function n(r, e) {
    var n,
        s = r.split("."),
        a = i;!(s[0] in a) && a.execScript && a.execScript("var " + s[0]);for (; s.length && (n = s.shift());) {
      s.length || e === t ? a = a[n] ? a[n] : a[n] = {} : a[n] = e;
    }
  }var s = "undefined" != typeof Uint8Array && "undefined" != typeof Uint16Array && "undefined" != typeof Uint32Array && "undefined" != typeof DataView;function a(t, e) {
    this.index = "number" == typeof e ? e : 0, this.i = 0, this.buffer = t instanceof (s ? Uint8Array : Array) ? t : new (s ? Uint8Array : Array)(32768), 2 * this.buffer.length <= this.index && r(Error("invalid index")), this.buffer.length <= this.index && this.f();
  }a.prototype.f = function () {
    var r,
        t = this.buffer,
        e = t.length,
        i = new (s ? Uint8Array : Array)(e << 1);if (s) i.set(t);else for (r = 0; r < e; ++r) {
      i[r] = t[r];
    }return this.buffer = i;
  }, a.prototype.d = function (r, t, e) {
    var i,
        n = this.buffer,
        s = this.index,
        a = this.i,
        h = n[s];if (e && 1 < t && (r = 8 < t ? (l[255 & r] << 24 | l[r >>> 8 & 255] << 16 | l[r >>> 16 & 255] << 8 | l[r >>> 24 & 255]) >> 32 - t : l[r] >> 8 - t), 8 > t + a) h = h << t | r, a += t;else for (i = 0; i < t; ++i) {
      h = h << 1 | r >> t - i - 1 & 1, 8 == ++a && (a = 0, n[s++] = l[h], h = 0, s === n.length && (n = this.f()));
    }n[s] = h, this.buffer = n, this.i = a, this.index = s;
  }, a.prototype.finish = function () {
    var r,
        t = this.buffer,
        e = this.index;return 0 < this.i && (t[e] <<= 8 - this.i, t[e] = l[t[e]], e++), s ? r = t.subarray(0, e) : (t.length = e, r = t), r;
  };var h,
      f = new (s ? Uint8Array : Array)(256);for (h = 0; 256 > h; ++h) {
    for (var o = c = h, u = 7, c = c >>> 1; c; c >>>= 1) {
      o <<= 1, o |= 1 & c, --u;
    }f[h] = (o << u & 255) >>> 0;
  }var l = f;function b(r) {
    this.buffer = new (s ? Uint16Array : Array)(2 * r), this.length = 0;
  }function y(r) {
    var t,
        e,
        i,
        n,
        a,
        h,
        f,
        o,
        u,
        c,
        l = r.length,
        b = 0,
        y = Number.POSITIVE_INFINITY;for (o = 0; o < l; ++o) {
      r[o] > b && (b = r[o]), r[o] < y && (y = r[o]);
    }for (t = 1 << b, e = new (s ? Uint32Array : Array)(t), i = 1, n = 0, a = 2; i <= b;) {
      for (o = 0; o < l; ++o) {
        if (r[o] === i) {
          for (h = 0, f = n, u = 0; u < i; ++u) {
            h = h << 1 | 1 & f, f >>= 1;
          }for (c = i << 16 | o, u = h; u < t; u += a) {
            e[u] = c;
          }++n;
        }
      }++i, n <<= 1, a <<= 1;
    }return [e, b, y];
  }function p(r, t) {
    this.h = d, this.w = 0, this.input = s && r instanceof Array ? new Uint8Array(r) : r, this.b = 0, t && (t.lazy && (this.w = t.lazy), "number" == typeof t.compressionType && (this.h = t.compressionType), t.outputBuffer && (this.a = s && t.outputBuffer instanceof Array ? new Uint8Array(t.outputBuffer) : t.outputBuffer), "number" == typeof t.outputIndex && (this.b = t.outputIndex)), this.a || (this.a = new (s ? Uint8Array : Array)(32768));
  }b.prototype.getParent = function (r) {
    return 2 * ((r - 2) / 4 | 0);
  }, b.prototype.push = function (r, t) {
    var e,
        i,
        n,
        s = this.buffer;for (e = this.length, s[this.length++] = t, s[this.length++] = r; 0 < e && (i = this.getParent(e), s[e] > s[i]);) {
      n = s[e], s[e] = s[i], s[i] = n, n = s[e + 1], s[e + 1] = s[i + 1], s[i + 1] = n, e = i;
    }return this.length;
  }, b.prototype.pop = function () {
    var r,
        t,
        e,
        i,
        n,
        s = this.buffer;for (t = s[0], r = s[1], this.length -= 2, s[0] = s[this.length], s[1] = s[this.length + 1], n = 0; !((i = 2 * n + 2) >= this.length) && (i + 2 < this.length && s[i + 2] > s[i] && (i += 2), s[i] > s[n]);) {
      e = s[n], s[n] = s[i], s[i] = e, e = s[n + 1], s[n + 1] = s[i + 1], s[i + 1] = e, n = i;
    }return { index: r, value: t, length: this.length };
  };var g,
      d = 2,
      A = { NONE: 0, r: 1, k: d, O: 3 },
      v = [];for (g = 0; 288 > g; g++) {
    switch (e) {case 143 >= g:
        v.push([g + 48, 8]);break;case 255 >= g:
        v.push([g - 144 + 400, 9]);break;case 279 >= g:
        v.push([g - 256 + 0, 7]);break;case 287 >= g:
        v.push([g - 280 + 192, 8]);break;default:
        r("invalid literal: " + g);}
  }function k(r, t) {
    this.length = r, this.H = t;
  }p.prototype.j = function () {
    var i,
        n,
        h,
        f,
        o = this.input;switch (this.h) {case 0:
        for (h = 0, f = o.length; h < f;) {
          var u,
              c,
              l,
              b = n = s ? o.subarray(h, h + 65535) : o.slice(h, h + 65535),
              y = (h += n.length) === f,
              p = t,
              g = t,
              A = this.a,
              k = this.b;if (s) {
            for (A = new Uint8Array(this.a.buffer); A.length <= k + b.length + 5;) {
              A = new Uint8Array(A.length << 1);
            }A.set(this.a);
          }if (u = y ? 1 : 0, A[k++] = 0 | u, l = 65536 + ~(c = b.length) & 65535, A[k++] = 255 & c, A[k++] = c >>> 8 & 255, A[k++] = 255 & l, A[k++] = l >>> 8 & 255, s) A.set(b, k), k += b.length, A = A.subarray(0, k);else {
            for (p = 0, g = b.length; p < g; ++p) {
              A[k++] = b[p];
            }A.length = k;
          }this.b = k, this.a = A;
        }break;case 1:
        var w = new a(s ? new Uint8Array(this.a.buffer) : this.a, this.b);w.d(1, 1, e), w.d(1, 2, e);var U,
            E,
            N,
            T = m(this, o);for (U = 0, E = T.length; U < E; U++) {
          if (N = T[U], a.prototype.d.apply(w, v[N]), 256 < N) w.d(T[++U], T[++U], e), w.d(T[++U], 5), w.d(T[++U], T[++U], e);else if (256 === N) break;
        }this.a = w.finish(), this.b = this.a.length;break;case d:
        var z,
            B,
            D,
            O,
            j,
            C,
            S,
            Z,
            L,
            M,
            P,
            F,
            q,
            G,
            K,
            V = new a(s ? new Uint8Array(this.a.buffer) : this.a, this.b),
            Y = [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15],
            H = Array(19);for (z = d, V.d(1, 1, e), V.d(z, 2, e), B = m(this, o), S = I(C = x(this.M, 15)), L = I(Z = x(this.L, 7)), D = 286; 257 < D && 0 === C[D - 1]; D--) {}for (O = 30; 1 < O && 0 === Z[O - 1]; O--) {}var J,
            X,
            _,
            Q,
            R,
            W,
            $ = D,
            rr = O,
            tr = new (s ? Uint32Array : Array)($ + rr),
            er = new (s ? Uint32Array : Array)(316),
            ir = new (s ? Uint8Array : Array)(19);for (J = X = 0; J < $; J++) {
          tr[X++] = C[J];
        }for (J = 0; J < rr; J++) {
          tr[X++] = Z[J];
        }if (!s) for (J = 0, Q = ir.length; J < Q; ++J) {
          ir[J] = 0;
        }for (J = R = 0, Q = tr.length; J < Q; J += X) {
          for (X = 1; J + X < Q && tr[J + X] === tr[J]; ++X) {}if (_ = X, 0 === tr[J]) {
            if (3 > _) for (; 0 < _--;) {
              er[R++] = 0, ir[0]++;
            } else for (; 0 < _;) {
              (W = 138 > _ ? _ : 138) > _ - 3 && W < _ && (W = _ - 3), 10 >= W ? (er[R++] = 17, er[R++] = W - 3, ir[17]++) : (er[R++] = 18, er[R++] = W - 11, ir[18]++), _ -= W;
            }
          } else if (er[R++] = tr[J], ir[tr[J]]++, 3 > --_) for (; 0 < _--;) {
            er[R++] = tr[J], ir[tr[J]]++;
          } else for (; 0 < _;) {
            (W = 6 > _ ? _ : 6) > _ - 3 && W < _ && (W = _ - 3), er[R++] = 16, er[R++] = W - 3, ir[16]++, _ -= W;
          }
        }for (i = s ? er.subarray(0, R) : er.slice(0, R), M = x(ir, 7), G = 0; 19 > G; G++) {
          H[G] = M[Y[G]];
        }for (j = 19; 4 < j && 0 === H[j - 1]; j--) {}for (P = I(M), V.d(D - 257, 5, e), V.d(O - 1, 5, e), V.d(j - 4, 4, e), G = 0; G < j; G++) {
          V.d(H[G], 3, e);
        }for (G = 0, K = i.length; G < K; G++) {
          if (F = i[G], V.d(P[F], M[F], e), 16 <= F) {
            switch (G++, F) {case 16:
                q = 2;break;case 17:
                q = 3;break;case 18:
                q = 7;break;default:
                r("invalid code: " + F);}V.d(i[G], q, e);
          }
        }var nr,
            sr,
            ar,
            hr,
            fr,
            or,
            ur,
            cr,
            lr = [S, C],
            br = [L, Z];for (fr = lr[0], or = lr[1], ur = br[0], cr = br[1], nr = 0, sr = B.length; nr < sr; ++nr) {
          if (ar = B[nr], V.d(fr[ar], or[ar], e), 256 < ar) V.d(B[++nr], B[++nr], e), hr = B[++nr], V.d(ur[hr], cr[hr], e), V.d(B[++nr], B[++nr], e);else if (256 === ar) break;
        }this.a = V.finish(), this.b = this.a.length;break;default:
        r("invalid compression type");}return this.a;
  };var w = function () {
    function t(t) {
      switch (e) {case 3 === t:
          return [257, t - 3, 0];case 4 === t:
          return [258, t - 4, 0];case 5 === t:
          return [259, t - 5, 0];case 6 === t:
          return [260, t - 6, 0];case 7 === t:
          return [261, t - 7, 0];case 8 === t:
          return [262, t - 8, 0];case 9 === t:
          return [263, t - 9, 0];case 10 === t:
          return [264, t - 10, 0];case 12 >= t:
          return [265, t - 11, 1];case 14 >= t:
          return [266, t - 13, 1];case 16 >= t:
          return [267, t - 15, 1];case 18 >= t:
          return [268, t - 17, 1];case 22 >= t:
          return [269, t - 19, 2];case 26 >= t:
          return [270, t - 23, 2];case 30 >= t:
          return [271, t - 27, 2];case 34 >= t:
          return [272, t - 31, 2];case 42 >= t:
          return [273, t - 35, 3];case 50 >= t:
          return [274, t - 43, 3];case 58 >= t:
          return [275, t - 51, 3];case 66 >= t:
          return [276, t - 59, 3];case 82 >= t:
          return [277, t - 67, 4];case 98 >= t:
          return [278, t - 83, 4];case 114 >= t:
          return [279, t - 99, 4];case 130 >= t:
          return [280, t - 115, 4];case 162 >= t:
          return [281, t - 131, 5];case 194 >= t:
          return [282, t - 163, 5];case 226 >= t:
          return [283, t - 195, 5];case 257 >= t:
          return [284, t - 227, 5];case 258 === t:
          return [285, t - 258, 0];default:
          r("invalid length: " + t);}
    }var i,
        n,
        s = [];for (i = 3; 258 >= i; i++) {
      n = t(i), s[i] = n[2] << 24 | n[1] << 16 | n[0];
    }return s;
  }(),
      U = s ? new Uint32Array(w) : w;function m(i, n) {
    function a(t, i) {
      var n,
          s,
          a,
          h,
          f = t.H,
          o = [],
          u = 0;switch (n = U[t.length], o[u++] = 65535 & n, o[u++] = n >> 16 & 255, o[u++] = n >> 24, e) {case 1 === f:
          s = [0, f - 1, 0];break;case 2 === f:
          s = [1, f - 2, 0];break;case 3 === f:
          s = [2, f - 3, 0];break;case 4 === f:
          s = [3, f - 4, 0];break;case 6 >= f:
          s = [4, f - 5, 1];break;case 8 >= f:
          s = [5, f - 7, 1];break;case 12 >= f:
          s = [6, f - 9, 2];break;case 16 >= f:
          s = [7, f - 13, 2];break;case 24 >= f:
          s = [8, f - 17, 3];break;case 32 >= f:
          s = [9, f - 25, 3];break;case 48 >= f:
          s = [10, f - 33, 4];break;case 64 >= f:
          s = [11, f - 49, 4];break;case 96 >= f:
          s = [12, f - 65, 5];break;case 128 >= f:
          s = [13, f - 97, 5];break;case 192 >= f:
          s = [14, f - 129, 6];break;case 256 >= f:
          s = [15, f - 193, 6];break;case 384 >= f:
          s = [16, f - 257, 7];break;case 512 >= f:
          s = [17, f - 385, 7];break;case 768 >= f:
          s = [18, f - 513, 8];break;case 1024 >= f:
          s = [19, f - 769, 8];break;case 1536 >= f:
          s = [20, f - 1025, 9];break;case 2048 >= f:
          s = [21, f - 1537, 9];break;case 3072 >= f:
          s = [22, f - 2049, 10];break;case 4096 >= f:
          s = [23, f - 3073, 10];break;case 6144 >= f:
          s = [24, f - 4097, 11];break;case 8192 >= f:
          s = [25, f - 6145, 11];break;case 12288 >= f:
          s = [26, f - 8193, 12];break;case 16384 >= f:
          s = [27, f - 12289, 12];break;case 24576 >= f:
          s = [28, f - 16385, 13];break;case 32768 >= f:
          s = [29, f - 24577, 13];break;default:
          r("invalid distance");}for (n = s, o[u++] = n[0], o[u++] = n[1], o[u++] = n[2], a = 0, h = o.length; a < h; ++a) {
        d[A++] = o[a];
      }k[o[0]]++, w[o[3]]++, v = t.length + i - 1, y = null;
    }var h,
        f,
        o,
        u,
        c,
        l,
        b,
        y,
        p,
        g = {},
        d = s ? new Uint16Array(2 * n.length) : [],
        A = 0,
        v = 0,
        k = new (s ? Uint32Array : Array)(286),
        w = new (s ? Uint32Array : Array)(30),
        m = i.w;if (!s) {
      for (o = 0; 285 >= o;) {
        k[o++] = 0;
      }for (o = 0; 29 >= o;) {
        w[o++] = 0;
      }
    }for (k[256] = 1, h = 0, f = n.length; h < f; ++h) {
      for (o = c = 0, u = 3; o < u && h + o !== f; ++o) {
        c = c << 8 | n[h + o];
      }if (g[c] === t && (g[c] = []), l = g[c], !(0 < v--)) {
        for (; 0 < l.length && 32768 < h - l[0];) {
          l.shift();
        }if (h + 3 >= f) {
          for (y && a(y, -1), o = 0, u = f - h; o < u; ++o) {
            p = n[h + o], d[A++] = p, ++k[p];
          }break;
        }0 < l.length ? (b = E(n, h, l), y ? y.length < b.length ? (p = n[h - 1], d[A++] = p, ++k[p], a(b, 0)) : a(y, -1) : b.length < m ? y = b : a(b, 0)) : y ? a(y, -1) : (p = n[h], d[A++] = p, ++k[p]);
      }l.push(h);
    }return d[A++] = 256, k[256]++, i.M = k, i.L = w, s ? d.subarray(0, A) : d;
  }function E(r, t, e) {
    var i,
        n,
        s,
        a,
        h,
        f,
        o = 0,
        u = r.length;a = 0, f = e.length;r: for (; a < f; a++) {
      if (i = e[f - a - 1], s = 3, 3 < o) {
        for (h = o; 3 < h; h--) {
          if (r[i + h - 1] !== r[t + h - 1]) continue r;
        }s = o;
      }for (; 258 > s && t + s < u && r[i + s] === r[t + s];) {
        ++s;
      }if (s > o && (n = i, o = s), 258 === s) break;
    }return new k(o, t - n);
  }function x(r, t) {
    var e,
        i,
        n,
        a,
        h,
        f = r.length,
        o = new b(572),
        u = new (s ? Uint8Array : Array)(f);if (!s) for (a = 0; a < f; a++) {
      u[a] = 0;
    }for (a = 0; a < f; ++a) {
      0 < r[a] && o.push(a, r[a]);
    }if (e = Array(o.length / 2), i = new (s ? Uint32Array : Array)(o.length / 2), 1 === e.length) return u[o.pop().index] = 1, u;for (a = 0, h = o.length / 2; a < h; ++a) {
      e[a] = o.pop(), i[a] = e[a].value;
    }for (n = N(i, i.length, t), a = 0, h = e.length; a < h; ++a) {
      u[e[a].index] = n[a];
    }return u;
  }function N(r, t, e) {
    function i(r) {
      var e = y[r][p[r]];e === t ? (i(r + 1), i(r + 1)) : --l[e], ++p[r];
    }var n,
        a,
        h,
        f,
        o,
        u = new (s ? Uint16Array : Array)(e),
        c = new (s ? Uint8Array : Array)(e),
        l = new (s ? Uint8Array : Array)(t),
        b = Array(e),
        y = Array(e),
        p = Array(e),
        g = (1 << e) - t,
        d = 1 << e - 1;for (u[e - 1] = t, a = 0; a < e; ++a) {
      g < d ? c[a] = 0 : (c[a] = 1, g -= d), g <<= 1, u[e - 2 - a] = (u[e - 1 - a] / 2 | 0) + t;
    }for (u[0] = c[0], b[0] = Array(u[0]), y[0] = Array(u[0]), a = 1; a < e; ++a) {
      u[a] > 2 * u[a - 1] + c[a] && (u[a] = 2 * u[a - 1] + c[a]), b[a] = Array(u[a]), y[a] = Array(u[a]);
    }for (n = 0; n < t; ++n) {
      l[n] = e;
    }for (h = 0; h < u[e - 1]; ++h) {
      b[e - 1][h] = r[h], y[e - 1][h] = h;
    }for (n = 0; n < e; ++n) {
      p[n] = 0;
    }for (1 === c[e - 1] && (--l[0], ++p[e - 1]), a = e - 2; 0 <= a; --a) {
      for (f = n = 0, o = p[a + 1], h = 0; h < u[a]; h++) {
        (f = b[a + 1][o] + b[a + 1][o + 1]) > r[n] ? (b[a][h] = f, y[a][h] = t, o += 2) : (b[a][h] = r[n], y[a][h] = n, ++n);
      }p[a] = 0, 1 === c[a] && i(a);
    }return l;
  }function I(r) {
    var t,
        e,
        i,
        n,
        a = new (s ? Uint16Array : Array)(r.length),
        h = [],
        f = [],
        o = 0;for (t = 0, e = r.length; t < e; t++) {
      h[r[t]] = 1 + (0 | h[r[t]]);
    }for (t = 1, e = 16; t <= e; t++) {
      f[t] = o, o += 0 | h[t], o <<= 1;
    }for (t = 0, e = r.length; t < e; t++) {
      for (o = f[r[t]], f[r[t]] += 1, i = a[t] = 0, n = r[t]; i < n; i++) {
        a[t] = a[t] << 1 | 1 & o, o >>>= 1;
      }
    }return a;
  }function T(t, e) {
    switch (this.l = [], this.m = 32768, this.e = this.g = this.c = this.q = 0, this.input = s ? new Uint8Array(t) : t, this.s = !1, this.n = B, this.C = !1, !e && (e = {}) || (e.index && (this.c = e.index), e.bufferSize && (this.m = e.bufferSize), e.bufferType && (this.n = e.bufferType), e.resize && (this.C = e.resize)), this.n) {case z:
        this.b = 32768, this.a = new (s ? Uint8Array : Array)(32768 + this.m + 258);break;case B:
        this.b = 0, this.a = new (s ? Uint8Array : Array)(this.m), this.f = this.K, this.t = this.I, this.o = this.J;break;default:
        r(Error("invalid inflate mode"));}
  }var z = 0,
      B = 1,
      D = { F: z, D: B };T.prototype.p = function () {
    for (; !this.s;) {
      var i = Q(this, 3);switch (1 & i && (this.s = e), i >>>= 1) {case 0:
          var n = this.input,
              a = this.c,
              h = this.a,
              f = this.b,
              o = n.length,
              u = t,
              c = h.length,
              l = t;switch (this.e = this.g = 0, a + 1 >= o && r(Error("invalid uncompressed block header: LEN")), u = n[a++] | n[a++] << 8, a + 1 >= o && r(Error("invalid uncompressed block header: NLEN")), u === ~(n[a++] | n[a++] << 8) && r(Error("invalid uncompressed block header: length verify")), a + u > n.length && r(Error("input buffer is broken")), this.n) {case z:
              for (; f + u > h.length;) {
                if (u -= l = c - f, s) h.set(n.subarray(a, a + l), f), f += l, a += l;else for (; l--;) {
                  h[f++] = n[a++];
                }this.b = f, h = this.f(), f = this.b;
              }break;case B:
              for (; f + u > h.length;) {
                h = this.f({ v: 2 });
              }break;default:
              r(Error("invalid inflate mode"));}if (s) h.set(n.subarray(a, a + u), f), f += u, a += u;else for (; u--;) {
            h[f++] = n[a++];
          }this.c = a, this.b = f, this.a = h;break;case 1:
          this.o(J, _);break;case 2:
          W(this);break;default:
          r(Error("unknown BTYPE: " + i));}
    }return this.t();
  };var O,
      j,
      C = [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15],
      S = s ? new Uint16Array(C) : C,
      Z = [3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258, 258, 258],
      L = s ? new Uint16Array(Z) : Z,
      M = [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, 0, 0],
      P = s ? new Uint8Array(M) : M,
      F = [1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577],
      q = s ? new Uint16Array(F) : F,
      G = [0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13],
      K = s ? new Uint8Array(G) : G,
      V = new (s ? Uint8Array : Array)(288);for (O = 0, j = V.length; O < j; ++O) {
    V[O] = 143 >= O ? 8 : 255 >= O ? 9 : 279 >= O ? 7 : 8;
  }var Y,
      H,
      J = y(V),
      X = new (s ? Uint8Array : Array)(30);for (Y = 0, H = X.length; Y < H; ++Y) {
    X[Y] = 5;
  }var _ = y(X);function Q(t, e) {
    for (var i, n = t.g, s = t.e, a = t.input, h = t.c, f = a.length; s < e;) {
      h >= f && r(Error("input buffer is broken")), n |= a[h++] << s, s += 8;
    }return i = n & (1 << e) - 1, t.g = n >>> e, t.e = s - e, t.c = h, i;
  }function R(r, t) {
    for (var e, i, n = r.g, s = r.e, a = r.input, h = r.c, f = a.length, o = t[0], u = t[1]; s < u && !(h >= f);) {
      n |= a[h++] << s, s += 8;
    }return i = (e = o[n & (1 << u) - 1]) >>> 16, r.g = n >> i, r.e = s - i, r.c = h, 65535 & e;
  }function W(r) {
    function t(r, t, e) {
      var i,
          n,
          s,
          a = this.z;for (s = 0; s < r;) {
        switch (i = R(this, t), i) {case 16:
            for (n = 3 + Q(this, 2); n--;) {
              e[s++] = a;
            }break;case 17:
            for (n = 3 + Q(this, 3); n--;) {
              e[s++] = 0;
            }a = 0;break;case 18:
            for (n = 11 + Q(this, 7); n--;) {
              e[s++] = 0;
            }a = 0;break;default:
            a = e[s++] = i;}
      }return this.z = a, e;
    }var e,
        i,
        n,
        a,
        h = Q(r, 5) + 257,
        f = Q(r, 5) + 1,
        o = Q(r, 4) + 4,
        u = new (s ? Uint8Array : Array)(S.length);for (a = 0; a < o; ++a) {
      u[S[a]] = Q(r, 3);
    }if (!s) for (a = o, o = u.length; a < o; ++a) {
      u[S[a]] = 0;
    }e = y(u), i = new (s ? Uint8Array : Array)(h), n = new (s ? Uint8Array : Array)(f), r.z = 0, r.o(y(t.call(r, h, e, i)), y(t.call(r, f, e, n)));
  }function $(r) {
    if ("string" == typeof r) {
      var t,
          e,
          i = r.split("");for (t = 0, e = i.length; t < e; t++) {
        i[t] = (255 & i[t].charCodeAt(0)) >>> 0;
      }r = i;
    }for (var n, s = 1, a = 0, h = r.length, f = 0; 0 < h;) {
      h -= n = 1024 < h ? 1024 : h;do {
        a += s += r[f++];
      } while (--n);s %= 65521, a %= 65521;
    }return (a << 16 | s) >>> 0;
  }function rr(t, e) {
    var i, n;switch (this.input = t, this.c = 0, !e && (e = {}) || (e.index && (this.c = e.index), e.verify && (this.N = e.verify)), i = t[this.c++], n = t[this.c++], 15 & i) {case tr:
        this.method = tr;break;default:
        r(Error("unsupported compression method"));}0 != ((i << 8) + n) % 31 && r(Error("invalid fcheck flag:" + ((i << 8) + n) % 31)), 32 & n && r(Error("fdict flag is not supported")), this.B = new T(t, { index: this.c, bufferSize: e.bufferSize, bufferType: e.bufferType, resize: e.resize });
  }T.prototype.o = function (r, t) {
    var e = this.a,
        i = this.b;this.u = r;for (var n, s, a, h, f = e.length - 258; 256 !== (n = R(this, r));) {
      if (256 > n) i >= f && (this.b = i, e = this.f(), i = this.b), e[i++] = n;else for (h = L[s = n - 257], 0 < P[s] && (h += Q(this, P[s])), n = R(this, t), a = q[n], 0 < K[n] && (a += Q(this, K[n])), i >= f && (this.b = i, e = this.f(), i = this.b); h--;) {
        e[i] = e[i++ - a];
      }
    }for (; 8 <= this.e;) {
      this.e -= 8, this.c--;
    }this.b = i;
  }, T.prototype.J = function (r, t) {
    var e = this.a,
        i = this.b;this.u = r;for (var n, s, a, h, f = e.length; 256 !== (n = R(this, r));) {
      if (256 > n) i >= f && (f = (e = this.f()).length), e[i++] = n;else for (h = L[s = n - 257], 0 < P[s] && (h += Q(this, P[s])), n = R(this, t), a = q[n], 0 < K[n] && (a += Q(this, K[n])), i + h > f && (f = (e = this.f()).length); h--;) {
        e[i] = e[i++ - a];
      }
    }for (; 8 <= this.e;) {
      this.e -= 8, this.c--;
    }this.b = i;
  }, T.prototype.f = function () {
    var r,
        t,
        e = new (s ? Uint8Array : Array)(this.b - 32768),
        i = this.b - 32768,
        n = this.a;if (s) e.set(n.subarray(32768, e.length));else for (r = 0, t = e.length; r < t; ++r) {
      e[r] = n[r + 32768];
    }if (this.l.push(e), this.q += e.length, s) n.set(n.subarray(i, i + 32768));else for (r = 0; 32768 > r; ++r) {
      n[r] = n[i + r];
    }return this.b = 32768, n;
  }, T.prototype.K = function (r) {
    var t,
        e,
        i,
        n = this.input.length / this.c + 1 | 0,
        a = this.input,
        h = this.a;return r && ("number" == typeof r.v && (n = r.v), "number" == typeof r.G && (n += r.G)), e = 2 > n ? (i = (a.length - this.c) / this.u[2] / 2 * 258 | 0) < h.length ? h.length + i : h.length << 1 : h.length * n, s ? (t = new Uint8Array(e)).set(h) : t = h, this.a = t;
  }, T.prototype.t = function () {
    var r,
        t,
        e,
        i,
        n,
        a = 0,
        h = this.a,
        f = this.l,
        o = new (s ? Uint8Array : Array)(this.q + (this.b - 32768));if (0 === f.length) return s ? this.a.subarray(32768, this.b) : this.a.slice(32768, this.b);for (t = 0, e = f.length; t < e; ++t) {
      for (i = 0, n = (r = f[t]).length; i < n; ++i) {
        o[a++] = r[i];
      }
    }for (t = 32768, e = this.b; t < e; ++t) {
      o[a++] = h[t];
    }return this.l = [], this.buffer = o;
  }, T.prototype.I = function () {
    var r,
        t = this.b;return s ? this.C ? (r = new Uint8Array(t)).set(this.a.subarray(0, t)) : r = this.a.subarray(0, t) : (this.a.length > t && (this.a.length = t), r = this.a), this.buffer = r;
  }, rr.prototype.p = function () {
    var t,
        e = this.input;return t = this.B.p(), this.c = this.B.c, this.N && (e[this.c++] << 24 | e[this.c++] << 16 | e[this.c++] << 8 | e[this.c++]) >>> 0 !== $(t) && r(Error("invalid adler-32 checksum")), t;
  };var tr = 8;function er(r, t) {
    this.input = r, this.a = new (s ? Uint8Array : Array)(32768), this.h = ir.k;var e,
        i = {};for (e in !t && (t = {}) || "number" != typeof t.compressionType || (this.h = t.compressionType), t) {
      i[e] = t[e];
    }i.outputBuffer = this.a, this.A = new p(this.input, i);
  }var ir = A;function nr(r, t) {
    var e, i, s, a;if (Object.keys) e = Object.keys(t);else for (i in e = [], s = 0, t) {
      e[s++] = i;
    }for (s = 0, a = e.length; s < a; ++s) {
      n(r + "." + (i = e[s]), t[i]);
    }
  }er.prototype.j = function () {
    var t,
        e,
        i,
        n,
        a,
        h,
        f,
        o = 0;switch (f = this.a, t = tr) {case tr:
        e = Math.LOG2E * Math.log(32768) - 8;break;default:
        r(Error("invalid compression method"));}switch (i = e << 4 | t, f[o++] = i, t) {case tr:
        switch (this.h) {case ir.NONE:
            a = 0;break;case ir.r:
            a = 1;break;case ir.k:
            a = 2;break;default:
            r(Error("unsupported compression type"));}break;default:
        r(Error("invalid compression method"));}return n = a << 6 | 0, f[o++] = n | 31 - (256 * i + n) % 31, h = $(this.input), this.A.b = o, o = (f = this.A.j()).length, s && ((f = new Uint8Array(f.buffer)).length <= o + 4 && (this.a = new Uint8Array(f.length + 4), this.a.set(f), f = this.a), f = f.subarray(0, o + 4)), f[o++] = h >> 24 & 255, f[o++] = h >> 16 & 255, f[o++] = h >> 8 & 255, f[o++] = 255 & h, f;
  }, n("Zlib.Inflate", rr), n("Zlib.Inflate.prototype.decompress", rr.prototype.p), nr("Zlib.Inflate.BufferType", { ADAPTIVE: D.D, BLOCK: D.F }), n("Zlib.Deflate", er), n("Zlib.Deflate.compress", function (r, t) {
    return new er(r, t).j();
  }), n("Zlib.Deflate.prototype.compress", er.prototype.j), nr("Zlib.Deflate.CompressionType", { NONE: ir.NONE, FIXED: ir.r, DYNAMIC: ir.k });
}).call(window || undefined || global);
});
define("src/scripts/remote/index.js", function(require, module, exports){
(function r(e, n, t) {
  function i(u, f) {
    if (!n[u]) {
      if (!e[u]) {
        var _ = u.split("/");if (_ = _[_.length - 1], !e[_]) {
          var p = "function" == typeof __require && __require;if (!f && p) return p(_, !0);if (o) return o(_, !0);throw new Error("Cannot find module '" + u + "'");
        }u = _;
      }var a = n[u] = { exports: {} };e[u][0].call(a.exports, function (r) {
        return i(e[u][1][r] || r);
      }, a, a.exports, r, e, n, t);
    }return n[u].exports;
  }for (var o = "function" == typeof __require && __require, u = 0; u < t.length; u++) {
    i(t[u]);
  }return i;
})({}, {}, []);
});
define("src/scripts/resources/index.js", function(require, module, exports){
(function r(e, n, t) {
  function i(u, f) {
    if (!n[u]) {
      if (!e[u]) {
        var _ = u.split("/");if (_ = _[_.length - 1], !e[_]) {
          var p = "function" == typeof __require && __require;if (!f && p) return p(_, !0);if (o) return o(_, !0);throw new Error("Cannot find module '" + u + "'");
        }u = _;
      }var a = n[u] = { exports: {} };e[u][0].call(a.exports, function (r) {
        return i(e[u][1][r] || r);
      }, a, a.exports, r, e, n, t);
    }return n[u].exports;
  }for (var o = "function" == typeof __require && __require, u = 0; u < t.length; u++) {
    i(t[u]);
  }return i;
})({}, {}, []);
});
define("src/settings.js", function(require, module, exports){
window._CCSettings = { platform: "wechatgame", groupList: ["default", "actor", "planet", "starSky", "rank_g0_tb", "rank_g1_tb", "rank_tg"], collisionMatrix: [[false], [false, false, true], [false, true, false], [false, false, false, false], [false, false, false, false, false], [false, false, false, false, false, false], [false, false, false, false, false, false, false]], hasResourcesBundle: true, hasStartSceneBundle: false, remoteBundles: ["remote", "resources"], subpackages: [], launchScene: "db://assets/Scene/Main.fire", orientation: "portrait", server: "https://rane-cdn.jwetech.com/130/", jsList: ["assets/Script/Common/Libs/zlib/zlib.min.js"] };
});
define("utils/uma.min.js", function(require, module, exports){
var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

var e,
    t,
    n = "[UMENG] -- ",
    p = (t = !1, function () {
  null === e && (e = new i());return e;
});function i() {
  this.setDebug = function (e) {
    t = e;
  };this.d = function () {
    if (t) try {
      "string" == typeof arguments[0] && (arguments[0] = n + arguments[0]);console.debug.apply(console, arguments);
    } catch (e) {}
  };this.i = function () {
    try {
      if (t) try {
        "string" == typeof arguments[0] && (arguments[0] = n + arguments[0]);console.info.apply(console, arguments);
      } catch (e) {}
    } catch (e) {}
  };this.e = function () {
    if (t) try {
      "string" == typeof arguments[0] && (arguments[0] = n + arguments[0]);console.error.apply(console, arguments);
    } catch (e) {}
  };this.w = function () {
    if (t) try {
      "string" == typeof arguments[0] && (arguments[0] = n + arguments[0]);console.warn.apply(console, arguments);
    } catch (e) {}
  };this.v = function () {
    if (t) try {
      "string" == typeof arguments[0] && (arguments[0] = n + arguments[0]);console.log.apply(console, arguments);
    } catch (e) {}
  };this.t = function () {
    if (t) try {
      console.table.apply(console, arguments);
    } catch (e) {}
  };this.tip = function () {
    try {
      "string" == typeof arguments[0] && (arguments[0] = n + arguments[0]);console.log.apply(console, arguments);
    } catch (e) {}
  };this.tip_w = function (e) {
    try {
      console.log("%c " + n + e, "background:red; padding: 4px; padding-right: 8px; border-radius: 4px; color: #fff;");
    } catch (e) {}
  };this.err = function () {
    try {
      "string" == typeof arguments[0] && (arguments[0] = n + arguments[0]);console.error.apply(console, arguments);
    } catch (e) {}
  };
}var r,
    f = (r = e = null, function () {
  return r = r || new o();
});function o() {
  var n = {};this.useOpenid = function () {
    return !!n.useOpenid;
  };this.useSwanid = function () {
    return !!n.useSwanid;
  };this.autoGetOpenid = function () {
    return !!n.autoGetOpenid;
  };this.appKey = function () {
    return n.appKey;
  };this.uploadUserInfo = function () {
    return n.uploadUserInfo;
  };this.enableVerify = function () {
    return n.enableVerify;
  };this.set = function (e) {
    n = e;
  };this.get = function () {
    return n;
  };this.setItem = function (e, t) {
    n[e] = t;
  };this.getItem = function (e) {
    return n[e];
  };
}function s() {
  this.listeners = {};this.maxListener = 2;
}s.prototype.addListener = s.prototype.on = function (e, t) {
  var n = this.listeners;n[e] && n[e].length >= this.maxListener ? console.error("%d,", this.maxListener) : n[e] instanceof Array ? -1 === n[e].indexOf(t) && n[e].push(t) : n[e] = [].concat(t);
};s.prototype.emit = function (e) {
  var t = Array.prototype.slice.call(arguments);t.shift();var n = this.listeners;n[e] instanceof Array && n[e].forEach(function (e) {
    e.apply(null, t);
  });
};s.prototype.listeners = function (e) {
  return this.listeners[e];
};s.prototype.setMaxListeners = function (e) {
  this.maxListener = e;
};s.prototype.removeListener = function (e, t) {
  var n = this.listeners,
      i = (n[e] || []).indexOf(t);0 <= i && n[e].splice(i, 1);
};s.prototype.removeAllListener = function (e) {
  this.listeners[e] = [];
};s.prototype.once = function (n, i) {
  var r = this;this.on(n, function e() {
    var t = Array.prototype.slice.call(arguments);i.apply(null, t);r.removeListener(n, e);
  });
};var u = new s(),
    a = 0,
    c = 1,
    _d = function d(e, t) {
  return (_d = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (e, t) {
    e.__proto__ = t;
  } || function (e, t) {
    for (var n in t) {
      t.hasOwnProperty(n) && (e[n] = t[n]);
    }
  })(e, t);
};function l(e, t) {
  _d(e, t);function n() {
    this.constructor = e;
  }e.prototype = null === t ? Object.create(t) : (n.prototype = t.prototype, new n());
}var h = new (function (e) {
  l(t, e);function t() {
    return null !== e && e.apply(this, arguments) || this;
  }t.prototype.getSdkType = function () {
    return "qqgamemp";
  };t.prototype.getPlatform = function () {
    return "qq";
  };return t;
}(function () {
  function e() {}e.prototype.setStorage = function (e, t, n) {
    qq.setStorage({ key: e, data: t, success: function success() {
        "function" == typeof n && n(!0);
      }, fail: function fail() {
        "function" == typeof n && n(!1);
      } });
  };e.prototype.getStorage = function (t, n) {
    qq.getStorage({ key: t, success: function success(e) {
        "function" == typeof n && n(e.data);
      }, fail: function fail(e) {
        p().w(t + ": " + e.errMsg);"function" == typeof n && n();
      } });
  };e.prototype.removeStorage = function (e, t) {
    qq.removeStorage({ key: e, success: function success() {
        "function" == typeof t && t(!0);
      }, fail: function fail() {
        "function" == typeof t && t(!1);
      } });
  };e.prototype.getSystemInfo = function (o) {
    qq.getSystemInfo({ success: function success(e) {
        var t = { model: e.model, brand: e.brand, pixelRatio: e.pixelRatio, screenWidth: e.screenWidth, screenHeight: e.screenHeight, fontSizeSetting: e.fontSizeSetting, platform: e.platform, platformVersion: e.version, platformSDKVersion: e.SDKVersion, language: e.language, deviceName: e.model, resolution: "" },
            n = e.system.split(" ");if (Array.isArray(n)) {
          t.OS = n[0];t.OSVersion = n[1];
        }var i = Math.round(e.screenWidth * e.pixelRatio),
            r = Math.round(e.screenHeight * e.pixelRatio);t.resolution = r < i ? i + "*" + r : r + "*" + i;"function" == typeof o && o(t);
      }, fail: function fail() {
        "function" == typeof o && o();
      } });
  };e.prototype.getDeviceInfo = function (e) {
    "function" == typeof e && e("");
  };e.prototype.checkNetworkAvailable = function (t) {
    qq.getNetworkType({ success: function success(e) {
        "function" == typeof t && t(e && "none" !== e.networkType);
      }, fail: function fail() {
        "function" == typeof t && t(!1);
      } });
  };e.prototype.getNetworkInfo = function (t) {
    qq.getNetworkType({ success: function success(e) {
        "function" == typeof t && t({ networkAvailable: "none" !== e.networkType, networkType: e.networkType });
      }, fail: function fail() {
        "function" == typeof t && t();
      } });
  };e.prototype.getDeviceId = function (e) {
    e("");
  };e.prototype.getAdvertisingId = function (e) {
    "function" == typeof e && e("");
  };e.prototype.onNetworkStatusChange = function (t) {
    qq.onNetworkStatusChange(function (e) {
      "function" == typeof t && t(e.isConnected || !0);
    });
  };e.prototype.request = function (e) {
    var t = e.success,
        n = e.fail,
        i = !1,
        r = null;e.success = function (e) {
      if (!i) {
        r && clearTimeout(r);"function" == typeof t && t(e);
      }
    };e.fail = function () {
      if (!i) {
        r && clearTimeout(r);"function" == typeof n && n(!1);
      }
    };qq.request(e);r = setTimeout(function () {
      r && clearTimeout(r);i = !0;"function" == typeof n && n(i);
    }, e.timeout || 5e3);
  };e.prototype.getSdkType = function () {
    return "qqmp";
  };e.prototype.getPlatform = function () {
    return "qq";
  };e.prototype.connectSocket = function (e) {
    qq.connectSocket(e);
  };e.prototype.closeSocket = function (e) {
    qq.closeSocket(e);
  };e.prototype.sendSocketMessage = function (e) {
    qq.sendSocketMessage(e);
  };e.prototype.onSocketOpen = function (e) {
    qq.onSocketOpen(e);
  };e.prototype.onSocketClose = function (e) {
    qq.onSocketClose(e);
  };e.prototype.onSocketMessage = function (e) {
    qq.onSocketMessage(e);
  };e.prototype.onSocketError = function (e) {
    qq.onSocketError(e);
  };e.prototype.getClipboard = function (t) {
    try {
      qq.getClipboardData({ success: function success(e) {
          "function" == typeof t && t(e.data);
        }, fail: function fail() {
          "function" == typeof t && t("");
        } });
    } catch (e) {
      p.e("clipboard", e);
    }
  };e.prototype.showModal = function (e) {
    try {
      qq.showModal(e);
    } catch (e) {
      p.e("Modal", e);
    }
  };e.prototype.showToast = function (e) {
    try {
      qq.showToast(e);
    } catch (e) {
      p.e("showToast error", e);
    }
  };e.prototype.getUserInfo = function (n) {
    var t = { fail: function fail() {
        n && n();
      }, success: function success(e) {
        if (e && e.userInfo) {
          var t = e.userInfo;n && n({ avatar: t.avatarUrl, nickName: t.nickName, gender: t.gender, country: t.country, province: t.province, city: t.city, language: t.language });
        }
      } };try {
      qq.getSetting({ success: function success(e) {
          e.authSetting["scope.userInfo"] && qq.getUserInfo(t);
        }, fail: function fail() {
          n();
        } });
    } catch (e) {
      p.e("getUserInfo error", e);
    }
  };e.prototype.getAppInfoSync = function () {
    if (qq.getAccountInfoSync) {
      var e = qq.getAccountInfoSync(),
          t = e && e.miniProgram ? e.miniProgram : {};return { appId: t.appId, appEnv: t.envVersion, appVersion: t.version };
    }return {};
  };e.prototype.onShareAppMessage = function (e) {
    qq.onShareAppMessage(e);
  };e.prototype.shareAppMessage = function (e) {
    qq.shareAppMessage(e);
  };return e;
}()))(),
    g = { SESSION_INTERVAL: 3e4, LOG_URL: "https://umini.shujupie.com/qqm_logs", GET_OPENID_URL: "https://umini.shujupie.com/uminiprogram_logs/qq/getuut", USERINFO_URL: "https://umini.shujupie.com/uminiprogram_logs/comm/uif", DEVICE_INFO_KEY: "device_info", ADVERTISING_ID: "mobile_ad_id", ANDROID_ID: "android_id", CURRENT_SESSION: "current_session", SESSION_PAUSE_TIME: "session_pause_time", EVENT_SEND_DEFAULT_INTERVAL: 15e3, EVENT_LAST_SEND_TIME: "last_send_time", MAX_EVENTID_LENGTH: 128, MAX_PROPERTY_KEY_LENGTH: 256, MAX_PROPERTY_KEYS_COUNT: 100, REPORT_POLICY: "report_policy", REPORT_INTERVAL_TIME: "report_interval_time", REPORT_POLICY_START_SEND: "1", REPORT_POLICY_INTERVAL: "6", IMPRINT: "imprint", SEED_VERSION: "1.0.0", IMPL_VERSION: "2.4.6", ALIPAY_AVAILABLE_VERSION: "10.1.52", SHARE_PATH: "um_share_path", SHARES: "shares", REQUESTS: "requests", UUID: "um_uuid", UUID_SUFFIX: "ud", OPENID: "um_od", UNIONID: "um_unid", ALIPAYID: "um_alipayid", USERID: "um_userid", PROVIDER: "um_provider", SWANID: "um_swanid", ANONYMOUSID: "um_anonymousid", LAUNCH_OPTIONS: "LAUNCH_OPTIONS", UM_SSRC: "_um_ssrc", USER_INFO: "user_info", IS_ALIYUN: !1, ALIYUN_URL: "serverless.huoban.youmeng.network.forward" };var v,
    y,
    _ = { isNumber: function isNumber(e) {
    return !Number.isNaN(parseInt(e, 10));
  }, compareVersion: function compareVersion(e, t) {
    for (var n = String(e).split("."), i = String(t).split("."), r = 0; r < Math.max(n.length, i.length); r++) {
      var o = parseInt(n[r] || 0, 10),
          s = parseInt(i[r] || 0, 10);if (s < o) return 1;if (o < s) return -1;
    }return 0;
  }, getRandomStr: function getRandomStr(e) {
    for (var t = "", n = ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", "A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"], i = 0; i < Number(e); i++) {
      t += n[Math.round(Math.random() * (n.length - 1))];
    }return t;
  }, clone: function clone(e) {
    return JSON.parse(JSON.stringify(e));
  }, startsWith: function startsWith(e, t) {
    return !(!e || !t || 0 === t.length || t.length > e.length) && e.substr(0, t.length) === t;
  }, endsWith: function endsWith(e, t) {
    return !(!t || 0 === e.length || t.length > e.length) && e.substring(e.length - t.length) === t;
  }, assign: function assign(e) {
    if (null == e) throw new TypeError("Cannot convert undefined or null to object");for (var t = Object(e), n = 1; n < arguments.length; n++) {
      var i = arguments[n];if (i) for (var r in i) {
        Object.prototype.hasOwnProperty.call(i, r) && (t[r] = i[r]);
      }
    }return t;
  }, deepEqual: function e(t, n) {
    if (t === n) return !0;if (t && "object" == (typeof t === "undefined" ? "undefined" : _typeof(t)) && n && "object" == (typeof n === "undefined" ? "undefined" : _typeof(n))) {
      if (Object.keys(t).length !== Object.keys(n).length) return !1;for (var i in t) {
        if (Object.prototype.hasOwnProperty.call(n, i)) return !1;if (!e(t[i], n[i])) return !1;
      }return !0;
    }return !1;
  }, trimStart: function trimStart(e, t) {
    if (!e) return "";if ("string" == typeof t && t.length) {
      var n = new RegExp("^" + t + "*");e = e.replace(n, "");
    } else e = e.replace(/^s*/, "");return e;
  }, trimEnd: function trimEnd(e, t) {
    if (!e) return "";var n, i;if ("string" == typeof t && t.length) {
      n = new RegExp(t);i = e.length;for (; n.test(e.charAt(i));) {
        --i;
      }return e.slice(0, i + 1);
    }n = /s/;i = e.length - 1;for (; n.test(e.charAt(i));) {
      --i;
    }return e.slice(0, i + 1);
  } },
    m = function (e) {
  l(t, e);function t() {
    return null !== e && e.apply(this, arguments) || this;
  }t.prototype.getOpenIdAsync = function (t, n) {
    var i = this;qq.login({ success: function success(e) {
        e.code ? h.request({ url: g.GET_OPENID_URL, method: "GET", data: { key: t, code: e.code }, success: function success(e) {
            p().v(" request ss ", e);if (e && 200 === e.statusCode && e.data && e.data.data) {
              var t = e.data.data;i.setOpenid(t.oid);i.setUnionid(t.uid);return n && n(t);
            }n && n();
          }, fail: function fail(e) {
            p().v(" request failed...", e);n && n();
          } }) : n && n();
      }, fail: function fail() {
        n && n();
      } });
  };return t;
}(function (t) {
  l(e, t);function e() {
    var e = null !== t && t.apply(this, arguments) || this;e._openid = "";e._unionid = "";e._useOpenid = !1;return e;
  }e.prototype.initID = function (t) {
    var n = this;n._idType = n._useOpenid ? "openid" : "uuid";p().v("id type: ", n._idType);h.getStorage(g.UNIONID, function (e) {
      n._unionid = e;
    });this._useOpenid ? h.getStorage(g.OPENID, function (e) {
      n._openid = e;t && t();
    }) : t && t();
  };e.prototype.setUseOpenid = function (e) {
    this._useOpenid = e;
  };e.prototype.setOpenid = function (e) {
    if (!this._openid && e) {
      this._openid = e;h.setStorage(g.OPENID, e);
    }
  };e.prototype.setUnionid = function (e) {
    if (!this._unionid && e) {
      this._unionid = e;h.setStorage(g.UNIONID, e);
    }
  };e.prototype.getIdTracking = function () {
    var e = t.prototype.getIdTracking.call(this);this._openid && (e.openid = this._openid);this._unionid && (e.unionid = this._unionid);this._userid && (e.userid = this._userid);return e;
  };e.prototype.getId = function () {
    return this._useOpenid ? this._openid : this._uuid;
  };return e;
}(function () {
  function e() {
    this._uuid = "";this._userid = "";this._provider = "";this._idType = "";
  }e.prototype.createUUID = function () {
    return _.getRandomStr(10) + Date.now() + _.getRandomStr(7) + g.UUID_SUFFIX;
  };e.prototype.initUUID = function (t) {
    var n = this;h.getStorage(g.UUID, function (e) {
      if (e) n._uuid = e;else {
        n._uuid = n.createUUID();h.setStorage(g.UUID, n._uuid);
      }t && t(e);
    });
  };e.prototype.initUserid = function () {
    var t = this;h.getStorage(g.USERID, function (e) {
      if (!t._userid && e) {
        t._userid = e;p().v("userId is ", e);
      }
    });h.getStorage(g.PROVIDER, function (e) {
      if (!t._provider && e) {
        t._provider = e;p().v("provider is ", e);
      }
    });
  };e.prototype.init = function (e) {
    var t = this;t.initUUID(function () {
      t.initUserid();t.initID(e);
    });
  };e.prototype.setUserid = function (e, t) {
    if (!this._userid && e) {
      this._userid = e;this._provider = t;h.setStorage(g.USERID, e);h.setStorage(g.PROVIDER, t);
    }
  };e.prototype.getUserId = function () {
    return this._userid;
  };e.prototype.getProvider = function () {
    return this._provider;
  };e.prototype.getIdType = function () {
    return this._idType;
  };e.prototype.getIdTracking = function () {
    var e = {};this._uuid && (e.uuid = this._uuid);this._userid && (e.userid = this._userid);return e;
  };return e;
}())),
    S = function S() {
  return v = v || new m();
},
    I = function I() {
  return y = y || new E();
};function E() {
  var n = !1,
      i = null,
      r = [];this.addPageStart = function (e) {
    if (e && !n) {
      i = { ts: Date.now(), path: e, page_name: e };n = !0;
    }
  };this.addPageEnd = function (e) {
    if (n && e && i && e === i.page_name) {
      var t = Date.now() - i.ts;i.duration = Math.abs(t);r.push(i);i = null;n = !1;
    }
  };this.get = function () {
    return r;
  };this.getCurrentPage = function () {
    return i;
  };this.clear = function () {
    r.length = 0;
  };
}var O = {};function A() {
  return function (e) {
    var t = [];for (var n in e) {
      "_um_ssrc" !== n && "_um_sts" !== n && t.push(n + "=" + e[n]);
    }return t.join("&");
  }(O);
}var T,
    k,
    N,
    R = function R() {
  return T = T || new U();
};function U() {
  return { add: function add(e, t) {
      p().v("share origin: %o", e);var n = { title: e && e.title, path: e && e.path && e.path.split("?")[0], _um_sts: Date.now() };n.path && 1 < n.path.length && _.startsWith(n.path, "/") && (n.path = _.trimStart(n.path, "/"));var i = e.path || "",
          r = S().getId();if (r) {
        var o = N.split(","),
            s = (o = o.filter(function (e) {
          return 0 < e.length;
        })).indexOf(r);0 <= s && (o = o.slice(0, s));o.length < 3 && o.push(r);var u = o.join(",");-1 !== i.indexOf("?") ? i += "&_um_ssrc=" + u : i += "?_um_ssrc=" + u;var a = Date.now();i += "&_um_sts=" + a;if (t) {
          var c = A(),
              f = c ? c + "&_um_ssrc=" + u + "&_um_sts=" + a : "_um_ssrc=" + u + "&_um_sts=" + a;e.query = e.query ? e.query + "&_um_ssrc=" + u + "&_um_sts=" + a : f;
        } else e.path = i;n._um_ssrc = u;n._um_sts = a;
      }k.push(n);p().v("share: %o", e);return e;
    }, setShareSource: function setShareSource(e) {
      N = e;
    }, clear: function clear() {
      k.length = 0;
    }, get: function get() {
      return k;
    } };
}var q,
    w,
    P,
    L,
    D = { stringify: function stringify(e) {
    if (e) try {
      return JSON.stringify(e);
    } catch (e) {}return "";
  }, parse: function parse(e) {
    if (e) try {
      return JSON.parse(e);
    } catch (e) {}return null;
  }, parseToArray: function parseToArray(e) {
    if (e) try {
      return JSON.parse(e);
    } catch (e) {}return [];
  } },
    b = (L = !(k = []), function () {
  return q = q || new C();
});function C() {
  this.load = function (t) {
    if (P) {
      h.removeStorage(w);t();
    } else {
      w = "um_cache_" + f().appKey();h.getStorage(w, function (e) {
        P = D.parse(e) || {};L = !0;h.removeStorage(w);t();
      });
    }
  };this.save = function () {
    P && h.setStorage(w, D.stringify(P));
  };this.set = function (e, t) {
    P && (P[e] = t);
  };this.get = function (e) {
    return (P || {})[e];
  };this.remove = function (e) {
    P && P[e] && delete P[e];
  };this.getAll = function () {
    return P;
  };this.clear = function () {
    P = null;
  };this.has = function (e) {
    return !!this.get(e);
  };this.isLoaded = function () {
    return L;
  };
}var M,
    V,
    x,
    j,
    G = "ekvs",
    F = 1e4,
    K = (x = [], j = [], function () {
  return M = M || { addEvent: function addEvent(e) {
      if (V) {
        x.unshift(e);if (1 < x.length) {
          Y();x.length = 0;
        }
      } else {
        p().w("session id is null: ", V);j.unshift(e);
      }
    }, setSessionId: function setSessionId(e) {
      V = e;p().v("setSessionId: ", V);if (Array.isArray(j) && j.length && V) {
        for (var t = 0; t < j.length; t++) {
          this.addEvent(j[t]);
        }j.length = 0;
      }
    }, getEkvs: function getEkvs() {
      var e = b().get(G);x && x.length && (e = H(e, x));return e;
    }, clear: function clear() {
      b().remove(G);x.length = 0;
    } };
});function Y() {
  if (x.length) {
    var e = b().get(G);if (function (e) {
      var t = 0;for (var n in e) {
        Array.isArray(e[n]) && (t += e[n].length);
      }return t;
    }(e) + x.length <= F) {
      e = H(e, x);b().set(G, e);
    }
  }
}function H(e, t) {
  var n = (e = e || {})[V];Array.isArray(n) && n.length ? e[V] = n.concat(t) : e[V] = [].concat(t);return e;
}var X,
    z = "2g",
    W = "3g",
    J = "4g",
    Q = { HALF_SESSION: "half_session", CLOSE_SESSION: "close_session", EKV: "ekv", ENTER_PAGE: "enter_page", LEAVE_PAGE: "leave_page" },
    B = ["access", "access_subtype"],
    Z = { instance: function instance() {
    return X = X || $();
  } };function $() {
  var e = !1,
      o = {};function t(i) {
    var e = b().get(g.IMPRINT);e && (o.imprint = e);o.device_type = "Phone";o.sdk_version = g.IMPL_VERSION;o.appkey = f().appKey();h.getDeviceInfo(function (e) {
      o.device_info = e || "";
    });var t = h.getAppInfoSync();o.appid = t.appId;o.app_env = t.appEnv;o.app_version = t.appVersion;h.getSystemInfo(function (n) {
      h.getNetworkInfo(function (e) {
        var t = function (e, t) {
          var n = {},
              i = (t = t || {}).networkType;"none" === i && (i = "unknown");var r = e.model || "",
              o = e.platform || "",
              s = e.brand || "",
              u = s.toLowerCase();n.sdk_type = h.getSdkType();n.platform = h.getPlatform();n.platform_sdk_version = e.platformSDKVersion;n.platform_version = e.platformVersion;n.resolution = e.resolution;n.pixel_ratio = e.pixelRatio;n.os = o;n.font_size_setting = e.fontSizeSetting;n.device_model = r;n.device_brand = s;n.device_manufacturer = u;n.device_manuid = r;n.device_name = r;n.os_version = e.OSVersion;n.language = e.language;switch (i = i ? i.toLowerCase() : "") {case J:
              n.access_subtype = "LTE";n.access = "4G";break;case W:
              n.access_subtype = "CDMA";n.access = "3G";break;case z:
              n.access_subtype = "GRPS";n.access = "2G";break;default:
              n.access = i;delete n.access_subtype;}return n;
        }(n, e);_.assign(o, t);!function (e) {
          var t = [];if (e) {
            t.push({ name: "", value: o.platform });t.push({ name: "", value: o.platform_version });
          }t.push({ name: "", value: o.device_model });t.push({ name: "", value: o.device_brand });t.push({ name: "os", value: o.os_version });t.push({ name: "", value: o.access });t.push({ name: "", value: o.access_subtype });t.push({ name: "", value: o.resolution });t.push({ name: "pixelRatio", value: o.pixel_ratio });for (var n = "", i = 0; i < t.length; i++) {
            var r = t[i];n += r.name + ": " + r.value + "; ";
          }p().v(": ", n);
        }();i && i();
      });
    });
  }return { init: function init() {
      t(function () {
        e = !0;
      });
    }, isLoaded: function isLoaded() {
      return e;
    }, get: function get() {
      return o;
    }, getRealtimeFields: function getRealtimeFields() {
      var t = {};B.forEach(function (e) {
        t[e] = o[e];
      });return t;
    }, setIdTracking: function setIdTracking(e) {
      this.setItem("id_tracking", e);
    }, setIdType: function setIdType(e) {
      this.setItem("id_type", e);
    }, setAppVersion: function setAppVersion(e) {
      this.setItem("app_version", e);
    }, setSuperProperty: function setSuperProperty(e) {
      o.sp || (o.sp = {});o.sp.isv = e;
    }, getSuperProperty: function getSuperProperty() {
      return o && o.sp ? o.sp.isv : "";
    }, setItem: function setItem(e, t) {
      o[e] = t;
    }, getItem: function getItem(e) {
      return o[e];
    } };
}var ee,
    te,
    ne,
    ie = function ie() {
  return ee = ee || re();
};function re() {
  return { resume: function resume(e) {
      var t = !1;ne = ne || b().get(g.CURRENT_SESSION);var n = new Date();te = n.getTime();if (!ne || !ne.end_time || te - ne.end_time > g.SESSION_INTERVAL) {
        t = !0;!function (e) {
          try {
            var t = (ne || {}).options || {},
                n = _.assign({}, function (e) {
              var t = {};for (var n in e) {
                0 === n.indexOf("_um_") && (t[n] = e[n]);
              }p().v("query: ", e);p().v("_um_params: ", t);return t;
            }(e.query));n.path = e.path || t.path;n.scene = e.scene ? h.getPlatform() + "_" + e.scene : t.scene;var i = e.referrerInfo;i && (n.referrerAppId = i.appId);p().v("session options: ", n);var r = n[g.UM_SSRC];r && R().setShareSource(r);var o = Date.now();ne = { id: _.getRandomStr(10) + o, start_time: o, options: n };
          } catch (e) {
            p().e("session: ", e);
          }
        }(e);p().v("session(%s): ", ne.id, ne);
      } else p().v("session(%s): %s ", ne.id, n.toLocaleTimeString(), ne);return t;
    }, pause: function pause() {
      !function () {
        if (ne) {
          var e = new Date();ne.end_time = e.getTime();"number" != typeof ne.duration && (ne.duration = 0);ne.duration = ne.end_time - te;b().set(g.CURRENT_SESSION, ne);p().v("(%s): %s ", ne.id, e.toLocaleTimeString(), ne);
        }
      }();
    }, getCurrentSessionId: function getCurrentSessionId() {
      return (ne || {}).id;
    }, getCurrentSession: function getCurrentSession() {
      return ne;
    }, cloneCurrentSession: function cloneCurrentSession() {
      return _.clone(ne);
    } };
}function oe(e) {
  var t = null;switch (e) {case Q.HALF_SESSION:
      t = function () {
        var e = null,
            t = ie().cloneCurrentSession();t && (e = { header: { st: "1" }, analytics: { sessions: [t] } });return e;
      }();break;case Q.CLOSE_SESSION:
      t = function () {
        var e = null,
            t = {},
            n = ie().cloneCurrentSession();if (n) {
          var i = I().get(),
              r = R().get();Array.isArray(i) && i.length && (n.pages = _.clone(i));Array.isArray(r) && r.length && (n.shares = _.clone(r));I().clear();R().clear();t.sessions = [n];
        }var o = K().getEkvs();if (o) {
          t.ekvs = _.clone(o);K().clear();
        }(t.sessions || t.ekvs) && (e = { analytics: t });return e;
      }();break;case Q.EKV:
      t = function () {
        var e = null,
            t = K().getEkvs();if (t) {
          e = { analytics: { ekvs: _.clone(t) } };K().clear();
        }return e;
      }();}return t;
}var se = { sessions: "sn", ekvs: "e", active_user: "active_user" },
    ue = { sdk_type: "sdt", access: "ac", access_subtype: "acs", device_model: "dm", language: "lang", device_type: "dt", device_manufacturer: "dmf", device_name: "dn", platform_version: "pv", id_type: "it", font_size_setting: "fss", os_version: "ov", device_manuid: "did", platform_sdk_version: "psv", device_brand: "db", appkey: "ak", _id: "id", id_tracking: "itr", imprint: "imp", sdk_version: "sv", resolution: "rl", testToken: "ttn" },
    ae = { uuid: "ud", unionid: "und", openid: "od", anonymousid: "nd", alipay_id: "ad", device_id: "dd", userid: "puid" };function ce(e) {
  return { h: function (e, t) {
      var n = fe(e, t);e && e.id_tracking && (n[t.id_tracking || "id_tracking"] = fe(e.id_tracking, ae));return n;
    }(e.header, ue), a: function (e, t) {
      var n = {};if (e) for (var i in e) {
        e[i] && (n[t[i]] = e[i]);
      }return n;
    }(e.analytics, se) };
}function fe(e, t) {
  var n = {};for (var i in e) {
    t[i] ? n[t[i]] = e[i] : n[i] = e[i];
  }return n;
}var pe,
    de,
    le = "_UMTEST_",
    he = "TEST_TOKEN",
    ge = (pe = ne = te = ee = X = P = q = T = y = v = null, de = w = N = "", function () {
  return pe = pe || new ve();
});function ve() {
  this.init = function (i) {
    h.getClipboard(function (e) {
      de = b().get(he);try {
        if (e && _.startsWith(e, le) && e.split(le)[1]) {
          var t = e.split(le)[1],
              n = JSON.parse(t).token;if (n) {
            de = n;b().set(he, n);
          }
        }
      } catch (e) {
        p().v(e);
      }i(!!de);
    });
  };this.getToken = function () {
    return de;
  };this.clear = function () {
    de = "";b().remove(he);
  };
}function ye(e) {
  if (e.length < 2) {
    return (t = e.charCodeAt(0)) < 128 ? e : t < 2048 ? Te(192 | t >>> 6) + Te(128 | 63 & t) : Te(224 | t >>> 12 & 15) + Te(128 | t >>> 6 & 63) + Te(128 | 63 & t);
  }var t = 65536 + 1024 * (e.charCodeAt(0) - 55296) + (e.charCodeAt(1) - 56320);return Te(240 | t >>> 18 & 7) + Te(128 | t >>> 12 & 63) + Te(128 | t >>> 6 & 63) + Te(128 | 63 & t);
}function _e(e) {
  var t = [0, 2, 1][e.length % 3],
      n = e.charCodeAt(0) << 16 | (1 < e.length ? e.charCodeAt(1) : 0) << 8 | (2 < e.length ? e.charCodeAt(2) : 0);return [Oe.charAt(n >>> 18), Oe.charAt(n >>> 12 & 63), 2 <= t ? "=" : Oe.charAt(n >>> 6 & 63), 1 <= t ? "=" : Oe.charAt(63 & n)].join("");
}function me(e) {
  return e.replace(ke, ye).replace(/[\s\S]{1,3}/g, _e);
}function Se(e) {
  switch (e.length) {case 4:
      var t = ((7 & e.charCodeAt(0)) << 18 | (63 & e.charCodeAt(1)) << 12 | (63 & e.charCodeAt(2)) << 6 | 63 & e.charCodeAt(3)) - 65536;return Te(55296 + (t >>> 10)) + Te(56320 + (1023 & t));case 3:
      return Te((15 & e.charCodeAt(0)) << 12 | (63 & e.charCodeAt(1)) << 6 | 63 & e.charCodeAt(2));default:
      return Te((31 & e.charCodeAt(0)) << 6 | 63 & e.charCodeAt(1));}
}function Ie(e) {
  var t = e.length,
      n = t % 4,
      i = (0 < t ? Ae[e.charAt(0)] << 18 : 0) | (1 < t ? Ae[e.charAt(1)] << 12 : 0) | (2 < t ? Ae[e.charAt(2)] << 6 : 0) | (3 < t ? Ae[e.charAt(3)] : 0),
      r = [Te(i >>> 16), Te(i >>> 8 & 255), Te(255 & i)];r.length -= [0, 0, 2, 1][n];return r.join("");
}function Ee(e) {
  return e.replace(/[\s\S]{1,4}/g, Ie).replace(Ne, Se);
}var Oe = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",
    Ae = function (e) {
  for (var t = {}, n = 0, i = e.length; n < i; n++) {
    t[e.charAt(n)] = n;
  }return t;
}(Oe),
    Te = String.fromCharCode,
    ke = /[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,
    Ne = new RegExp(["[-][-]", "[-][-]{2}", "[-][-]{3}"].join("|"), "g"),
    Re = { encode: function encode(e, t) {
    return t ? me(String(e)).replace(/[+\/]/g, function (e) {
      return "+" == e ? "-" : "_";
    }).replace(/=/g, "") : me(String(e));
  }, decode: function decode(e) {
    return Ee(String(e).replace(/[-_]/g, function (e) {
      return "-" == e ? "+" : "/";
    }).replace(/[^A-Za-z0-9\+\/]/g, ""));
  } };var Ue = new function () {
  var t = {};this.set = function (e) {
    t = D.parse(Re.decode(e));
  };this.get = function () {
    return t;
  };this.getItem = function (e) {
    if (t) return t[e];
  };this.load = function () {
    t = b().get(g.IMPRINT);
  };this.save = function () {
    t && b().set(g.IMPRINT, t);
  };
}();function qe(n, i, r, e) {
  Z.instance().setIdType(S().getIdType());Z.instance().setIdTracking(S().getIdTracking());var t = S().getUserId();t && n.analytics && (n.analytics.active_user = { puid: t, provider: S().getProvider() });var o = _.clone(Z.instance().get());n.header = _.assign(o, n.header, { ts: Date.now(), testToken: ge().getToken(), traceId: _.getRandomStr(10) + Date.now() + _.getRandomStr(9) });var s,
      u = ce(n),
      a = D.stringify(u),
      c = { url: g.LOG_URL, method: "POST", data: Re.encode(a), success: function success(e) {
      var t = e.code || e.status || e.statusCode;if (200 === t || 413 === t) {
        p().i(": ", n, a);!function (e) {
          if (e) {
            Z.instance().setItem(g.IMPRINT, e);Ue.set(e);Ue.save();p().v("imprint: ", Ue.get());Ue.getItem("ttn_invalid") && ge().clear();
          }
        }((e.data || {}).imprint);"function" == typeof i && i(e);
      } else {
        p().w(": ", a);"function" == typeof r && r();
      }
    }, fail: function fail(e) {
      p().w(": ", a);"function" == typeof r && r();
    }, complete: function complete() {
      "function" == typeof e && e();
    } };h.request(_.assign(c, { header: { "Content-Type": s = h.getSdkType() + "/json", "Msg-Type": s } }));
}function we(e) {
  var t = e,
      n = [];this.enqueue = function (e) {
    "number" == typeof t && this.size() >= t && this.dequeue();n.push(e);
  };this.dequeue = function () {
    return n.shift();
  };this.front = function () {
    return n[0];
  };this.isEmpty = function () {
    return 0 === n.length;
  };this.clear = function () {
    n.length = 0;
  };this.size = function () {
    return n.length;
  };this.items = function () {
    return n;
  };this.print = function () {
    console.log(n.toString());
  };
}var Pe,
    Le,
    De,
    be,
    Ce = (Pe = null, Le = !1, De = [], be = new we(50), function () {
  return Pe = Pe || new xe();
});function Me(t) {
  var e = be.front();if (e) qe(e, function () {
    be.dequeue();Me(t);
  }, function () {
    var e = be.dequeue();e && !e.noCache && De.push(e);Me(t);
  });else {
    !function () {
      De.forEach(function (e) {
        be.enqueue(e);
      });De.length = 0;
    }();t();
  }
}function Ve(e) {
  if (S().getId()) {
    if (Le) p().i("");else {
      Le = !0;Me(function () {
        Le = !1;"function" == typeof e && e();
      });
    }
  } else {
    p().i("id");"function" == typeof e && e();
  }
}function xe() {
  this.send = function (e, t, n) {
    e ? this.add(e, t, function () {
      Ve(n);
    }) : Ve(n);
  };this.add = function (e, t, n) {
    !function e(t, n, i) {
      if (Z.instance().isLoaded()) {
        n = n || {};var r = oe(t);if (r) {
          var o = Z.instance().getRealtimeFields();r.header = _.assign({}, r.header, o);r.noCache = n.noCache;be.enqueue(r);
        }"function" == typeof i && i();
      } else setTimeout(function () {
        e(t, n, i);
      }, 100);
    }(e, t, n);
  };this.load = function () {
    var e = b().get(g.REQUESTS);e && e.length && e.forEach(function (e) {
      be.enqueue(e);
    });b().remove(g.REQUESTS);
  };this.save = function () {
    b().set(g.REQUESTS, _.clone(be.items()));be.clear();
  };
}var je,
    Ge = (je = null, function () {
  return je = je || new Fe();
});function Fe() {
  this.update = function () {
    h.getUserInfo(function (t) {
      if (t) {
        var e = b().get(g.USER_INFO);e && _.deepEqual(t, e) || function (t, n) {
          var e = f().appKey(),
              i = h.getSdkType(),
              r = S().getId(),
              o = S().getIdType();if (!(e && i && r && o)) return;var s = { ak: f().appKey(), sdt: h.getSdkType(), uin: t.nickName, uia: t.avatar, uig: t.gender, uit: t.country, uip: t.province, uic: t.city, uil: t.language, id: S().getId(), it: S().getIdType() },
              u = JSON.stringify(s);u = Re.encode(u);h.request({ url: g.USERINFO_URL, method: "POST", header: { "content-type": "application/x-www-form-urlencoded" }, data: "ui=" + u, success: function success(e) {
              p().v(": ", t);n && n(e && e.data && 200 === e.data.code);
            }, fail: function fail() {
              p().e(": ", t);n && n(!1);
            } });
        }(t, function (e) {
          e && b().set(g.USER_INFO, t);
        });
      }
    });
  };
}function Ke(e, t) {
  this.id = e;this.ts = Date.now();var n = typeof t === "undefined" ? "undefined" : _typeof(t);if ("string" == n && t) this[e] = t;else if ("object" == n) for (var i in t) {
    !{}.hasOwnProperty.call(t, i) || (this[i] = t[i]);
  }
}function Ye() {
  var a = !1,
      n = !1,
      c = 0;this.init = function (e) {
    p().v("sdk version: " + g.IMPL_VERSION);a ? p().v("Lib") : b().load(function () {
      p().v("cache: ", b().getAll());!function () {
        S().setUseOpenid && S().setUseOpenid(f().useOpenid());S().init(function () {
          Z.instance().init();p().v("Header");
        });
      }();a = !0;"function" == typeof e && e();p().tip("SDK");
    });
  };this.resume = function (e) {
    if (a && !n) {
      p().v("showOptions: ", e);var t = this;n = !0;f().enableVerify() ? ge().init(function () {
        t._resume(e);
      }) : t._resume(e);
    }
  };this._resume = function (e) {
    Ce().load();var t = ie().resume(e),
        n = ie().getCurrentSessionId();K().setSessionId(n);t && Ce().add(Q.HALF_SESSION, {}, function () {
      S().setUseOpenid && S().setUseOpenid(f().useOpenid());if (f().useOpenid() && f().autoGetOpenid() && !S().getId()) {
        p().v("get id async");!function t(n, i) {
          if (S().getId() || n <= 0) return;S().getOpenIdAsync(f().appKey(), function (e) {
            if (e) {
              p().v("id");Ce().send();
            } else {
              p().v("openid,,", n - 1);setTimeout(function () {
                t(n - 1, i);
              }, i);
            }
          });
        }(10, 3e3);
      } else {
        p().v("session auto send");Ce().send();
      }
    });
  };this.pause = function (e) {
    if (a) {
      n = !1;c = 0;ie().pause();f().uploadUserInfo() && Ge().update();Ce().send(Q.CLOSE_SESSION, {}, function () {
        Ce().save();b().save();p().v("cache save success");"function" == typeof e && e();
      });
    }
  };this.setOpenid = function (e) {
    p().v("setOpenId: %s", e);S().setOpenid(e);Ce().send();
  };this.setUnionid = function (e) {
    p().v("setUnionid: %s", e);S().setUnionid(e);
  };this.setUserid = function (e, t) {
    p().v("setUserid: %s", e, t);S().setUserid(e, t);
  };this.setAnonymousid = function (e) {
    p().v("setAnonymousId: %s", e);S().setAnonymousid(e);Ce().send();
  };this.setAppVersion = function (e) {
    e && "string" != typeof e ? p().w("setAppVersion") : Z.instance().setAppVersion(e);
  };this.setAlipayUserid = function (e) {
    if (e && "string" != typeof e) p().w("setAlipayUserid");else {
      p().v("setAlipayUserid: %s", e);S().setAlipayUserid(e);
    }
  };this.setSuperProperty = function (e) {
    if (e && "string" != typeof e) p().w("");else {
      var t = this;if (Z.instance().getSuperProperty() !== e) {
        Z.instance().setSuperProperty(e);t.pause(function () {
          t.resume();
        });
      }
    }
  };this.trackEvent = function (e, t) {
    if (a) {
      p().v("event: ", e, t);if (function (e, t) {
        if (e && "string" == typeof e) {
          var n = ["id", "ts", "du"],
              i = {};n.forEach(function (e) {
            i[e] = 1;
          });if (i[e]) p().e("eventId: " + n.join(","));else if (e.length > g.MAX_EVENTID_LENGTH) p().e("The maximum length of event id shall not exceed " + g.MAX_EVENTID_LENGTH);else {
            if (!t || "object" == (typeof t === "undefined" ? "undefined" : _typeof(t)) && !Array.isArray(t) || "string" == typeof t) {
              if ("object" == (typeof t === "undefined" ? "undefined" : _typeof(t))) {
                var r = 0;for (var o in t) {
                  if ({}.hasOwnProperty.call(t, o)) {
                    if (o.length > g.MAX_PROPERTY_KEY_LENGTH) {
                      p().e("The maximum length of property key shall not exceed " + g.MAX_PROPERTY_KEY_LENGTH);return;
                    }if (r >= g.MAX_PROPERTY_KEYS_COUNT) {
                      p().e("The maximum count of properties shall not exceed " + g.MAX_PROPERTY_KEYS_COUNT);return;
                    }if (i[o]) {
                      p().e("key: " + n.join(","));return;
                    }r += 1;
                  }
                }
              }return 1;
            }p().e("please check trackEvent properties. properties should be string or object(not include Array)");
          }
        } else p().e('please check trackEvent id. id should be "string" and not null');
      }(e, t)) {
        var n = new Ke(e, t);K().addEvent(n);var i = !!ge().getToken(),
            r = i ? 0 : g.EVENT_SEND_DEFAULT_INTERVAL,
            o = Date.now();if (s = o, u = r, "number" != typeof c || "number" != typeof u || c <= 0 || u < s - c) {
          c = o;Ce().send(Q.EKV, { noCache: i }, function () {});
        }
      }var s, u;
    }
  };this.trackShare = function (e) {
    if (a) {
      try {
        if (-1 < h.getSdkType().indexOf("game")) {
          e = R().add(e, !0);p().v("shareQuery: ", e);
        } else {
          e = R().add(e, !1);p().v("sharePath: ", e.path);
        }
      } catch (e) {
        p().v("shareAppMessage: ", e);
      }return e;
    }
  };this.trackPageStart = function (e) {
    a && I().addPageStart(e);
  };this.trackPageEnd = function (e) {
    a && I().addPageEnd(e);
  };this.onShareAppMessage = function (e) {
    var t = this;h.onShareAppMessage(function () {
      return t.trackShare(e());
    });
  };this.shareAppMessage = function (e) {
    this.trackShare(e);h.shareAppMessage(e);
  };
}var He = [];function Xe() {}Xe.prototype = { createMethod: function createMethod(e, t, n) {
    try {
      e[t] = n && n[t] ? function () {
        return n[t].apply(n, arguments);
      } : function () {
        He.push([t, [].slice.call(arguments)]);
      };
    } catch (e) {
      p().v("create method errror: ", e);
    }
  }, installApi: function installApi(e, t) {
    try {
      for (var n = "resume,pause,trackEvent,trackPageStart,trackPageEnd,trackShare,setUserid,setOpenid,setUnionid,onShareAppMessage,shareAppMessage".split(","), i = 0, r = n.length; i < r; i++) {
        this.createMethod(e, n[i], t);
      }if (t) for (i = 0, r = He.length; i < r; i++) {
        var o = He[i];try {
          t[o[0]].apply(t, o[1]);
        } catch (e) {
          p().v("impl[v[0]].apply error: ", o[0], e);
        }
      }
    } catch (e) {
      p().v("install api errror: ", e);
    }
  } };var ze = ["https://umini.shujupie.com", "https://ulogs.umeng.com"],
    We = 0;function Je(t, e) {
  if (t >= ze.length || e) {
    e && function () {
      var e = "https://umini.shujupie.com";g.LOG_URL = g.LOG_URL.replace(e, ze[We]);g.GET_OPENID_URL = g.GET_OPENID_URL.replace(e, ze[We]);g.USERINFO_URL = g.USERINFO_URL.replace(e, ze[We]);
    }();e && p().v("", ze[We]);e || p().tip_w("");
  } else h.request({ url: ze[t] + "/uminiprogram_logs/ckdh", success: function success(e) {
      200 === (e.code || e.status || e.statusCode) && e.data && 200 === e.data.code ? Je((We = t) + 1, !0) : Je(t + 1, !1);
    }, fail: function fail() {
      Je(t + 1, !1);
    } });
}({ init: function init(e) {
    setTimeout(function () {
      Je(0, !1);
    }, e);
  } }).init(3e3);var Qe = new Xe(),
    Be = { _inited: !1, init: function init(e) {
    if (this._inited) p().v("");else if (e) {
      if (e.appKey) {
        "boolean" != typeof e.useOpenid && (e.useOpenid = !0);f().set(e);p().setDebug(e.debug);this._inited = !0;var t = this;u.emit(a, e);try {
          var n = new Ye();p().v("Lib");n.init(function () {
            p().v("Lib");Qe.installApi(t, n);p().v("Lib");u.emit(c, e);
          });
        } catch (e) {
          p().w("Lib: " + e);
        }
      } else p().err("appkey");
    } else p().err("");
  } };try {
  Qe.installApi(Be, null);
} catch (e) {
  p().w("uma: ", e);
}qq.onShow(function (e) {
  p().v("game onShow: ", e);t = e.query, O = t;var t;Be.resume(e, !0);
});qq.onHide(function () {
  p().v("game onHide");Be.pause();
});var Ze = Be.init;Be.init = function (e) {
  if (e && e.useOpenid) {
    p().tip_w("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!");p().tip_w("openidsetOpenidopenidautoGetOpenidtruesecret");p().tip_w("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!");
  }Ze.call(Be, e);
};qq.uma = Be;module.exports = Be;
});
define("game.js", function(require, module, exports){
var _umaMin = require('./utils/uma.min.js');

var _umaMin2 = _interopRequireDefault(_umaMin);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

_umaMin2.default.init({
  appKey: '5f97ee1645b2b751a91d67a0',
  useOpenid: false, // default true
  autoGetOpenid: false,
  debug: true,
  uploadUserInfo: true // 
});

"use strict";

require('adapter-min.js');

__globalAdapter.init();

require('cocos/cocos2d-js-min.js');

require('physics-min.js');

__globalAdapter.adaptEngine();

require('./ccRequire');

require('./src/settings'); // Introduce Cocos Service here


require('./main'); // TODO: move to common
// Adjust devicePixelRatio


cc.view._maxPixelRatio = 4;

if (cc.sys.platform !== cc.sys.WECHAT_GAME_SUB) {
  // Release Image objects after uploaded gl texture
  cc.macro.CLEANUP_IMAGE_CACHE = true;
}

window.boot();
});  require("game.js");